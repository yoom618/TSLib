Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps36_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.701819896697998
Epoch: 1, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.481 Vali Acc: 0.802 Test Loss: 0.481 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 4.934089660644531
Epoch: 2, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.939 Vali Acc: 0.526 Test Loss: 0.939 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.58881139755249
Epoch: 3, Steps: 17 | Train Loss: 0.626 Vali Loss: 1.040 Vali Acc: 0.522 Test Loss: 1.040 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.079491853713989
Epoch: 4, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
Validation loss decreased (-0.802043 --> -0.883955).  Saving model ...
Epoch: 5 cost time: 4.983272314071655
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.480 Vali Acc: 0.823 Test Loss: 0.480 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.247028350830078
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.456 Vali Acc: 0.761 Test Loss: 0.456 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.896482467651367
Epoch: 7, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.389 Vali Acc: 0.843 Test Loss: 0.389 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.990542888641357
Epoch: 8, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.822060585021973
Epoch: 9, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.535 Vali Acc: 0.758 Test Loss: 0.535 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.65623664855957
Epoch: 10, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.606 Vali Acc: 0.747 Test Loss: 0.606 Test Acc: 0.747
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.178623914718628
Epoch: 11, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.434 Vali Acc: 0.870 Test Loss: 0.434 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.895195960998535
Epoch: 12, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.192 Vali Acc: 0.727 Test Loss: 1.192 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.690980434417725
Epoch: 13, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.426 Vali Acc: 0.887 Test Loss: 0.426 Test Acc: 0.887
Validation loss decreased (-0.883955 --> -0.887368).  Saving model ...
Epoch: 14 cost time: 3.6255064010620117
Epoch: 14, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.465 Vali Acc: 0.901 Test Loss: 0.465 Test Acc: 0.901
Validation loss decreased (-0.887368 --> -0.901019).  Saving model ...
Epoch: 15 cost time: 4.221981525421143
Epoch: 15, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.169349431991577
Epoch: 16, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.687 Vali Acc: 0.823 Test Loss: 0.687 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.2454633712768555
Epoch: 17, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.868 Vali Acc: 0.812 Test Loss: 0.868 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.267542362213135
Epoch: 18, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.786 Vali Acc: 0.860 Test Loss: 0.786 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.779837131500244
Epoch: 19, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.598 Vali Acc: 0.894 Test Loss: 0.598 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1362924575805664
Epoch: 20, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.651 Vali Acc: 0.884 Test Loss: 0.651 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1230006217956543
Epoch: 21, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.414 Vali Acc: 0.785 Test Loss: 1.414 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6149048805236816
Epoch: 22, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.654 Vali Acc: 0.887 Test Loss: 0.654 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.5387768745422363
Epoch: 23, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.824 Vali Acc: 0.867 Test Loss: 0.824 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.157748222351074
Epoch: 24, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.089 Vali Acc: 0.881 Test Loss: 1.089 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps36_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 44169218
model size : 183.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.588876724243164
Epoch: 1, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
Validation loss decreased (inf --> -0.870304).  Saving model ...
Epoch: 2 cost time: 3.015909194946289
Epoch: 2, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.414 Vali Acc: 0.857 Test Loss: 0.414 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3771536350250244
Epoch: 3, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.415 Vali Acc: 0.870 Test Loss: 0.415 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8569869995117188
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.431 Vali Acc: 0.816 Test Loss: 0.431 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8278603553771973
Epoch: 5, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.556 Vali Acc: 0.775 Test Loss: 0.556 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8443992137908936
Epoch: 6, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.659 Vali Acc: 0.628 Test Loss: 0.659 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.223034143447876
Epoch: 7, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.401 Vali Acc: 0.836 Test Loss: 0.401 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0027878284454346
Epoch: 8, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.555 Vali Acc: 0.754 Test Loss: 0.555 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1548285484313965
Epoch: 9, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.555 Vali Acc: 0.573 Test Loss: 1.555 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.720822811126709
Epoch: 10, Steps: 17 | Train Loss: 0.713 Vali Loss: 1.233 Vali Acc: 0.645 Test Loss: 1.233 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.5592873096466064
Epoch: 11, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.482 Vali Acc: 0.775 Test Loss: 0.482 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 44021762
model size : 182.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps36_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8881893157958984
Epoch: 1, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 2.5608673095703125
Epoch: 2, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
Validation loss decreased (-0.863477 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 1.6566894054412842
Epoch: 3, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5128653049468994
Epoch: 4, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.301 Vali Acc: 0.884 Test Loss: 0.301 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.750943183898926
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.390 Vali Acc: 0.874 Test Loss: 0.390 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0759944915771484
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.357 Vali Acc: 0.874 Test Loss: 0.357 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2443597316741943
Epoch: 7, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.421 Vali Acc: 0.816 Test Loss: 0.421 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3157999515533447
Epoch: 8, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.325 Vali Acc: 0.874 Test Loss: 0.325 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9393529891967773
Epoch: 9, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.699 Vali Acc: 0.713 Test Loss: 0.699 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.133845329284668
Epoch: 10, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.368 Vali Acc: 0.863 Test Loss: 0.368 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.143897771835327
Epoch: 11, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.291 Vali Acc: 0.891 Test Loss: 0.291 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.992396831512451
Epoch: 12, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.269 Vali Acc: 0.904 Test Loss: 0.269 Test Acc: 0.904
Validation loss decreased (-0.894194 --> -0.904434).  Saving model ...
Epoch: 13 cost time: 0.8498528003692627
Epoch: 13, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.508 Vali Acc: 0.829 Test Loss: 0.508 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.798553466796875
Epoch: 14, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7935962677001953
Epoch: 15, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.450 Vali Acc: 0.867 Test Loss: 0.450 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8044099807739258
Epoch: 16, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8626906871795654
Epoch: 17, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8102717399597168
Epoch: 18, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.518 Vali Acc: 0.823 Test Loss: 0.518 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8108572959899902
Epoch: 19, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.615 Vali Acc: 0.823 Test Loss: 0.615 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8024163246154785
Epoch: 20, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.588 Vali Acc: 0.860 Test Loss: 0.588 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7950677871704102
Epoch: 21, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8245782852172852
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.485 Vali Acc: 0.884 Test Loss: 0.485 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps36_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 43948034
model size : 182.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps38_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.744657039642334
Epoch: 1, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 1.6906511783599854
Epoch: 2, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.425 Vali Acc: 0.853 Test Loss: 0.425 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.341721296310425
Epoch: 3, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.579 Vali Acc: 0.635 Test Loss: 0.579 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5237295627593994
Epoch: 4, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.639 Vali Acc: 0.580 Test Loss: 0.639 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.543339490890503
Epoch: 5, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.322 Vali Acc: 0.884 Test Loss: 0.322 Test Acc: 0.884
Validation loss decreased (-0.877129 --> -0.883956).  Saving model ...
Epoch: 6 cost time: 3.5584311485290527
Epoch: 6, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.450 Vali Acc: 0.805 Test Loss: 0.450 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.412264823913574
Epoch: 7, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.292 Vali Acc: 0.881 Test Loss: 0.292 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1502299308776855
Epoch: 8, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.467 Vali Acc: 0.727 Test Loss: 0.467 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.069620370864868
Epoch: 9, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.587 Vali Acc: 0.700 Test Loss: 0.587 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4240198135375977
Epoch: 10, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7994754314422607
Epoch: 11, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.327 Vali Acc: 0.901 Test Loss: 0.327 Test Acc: 0.901
Validation loss decreased (-0.883956 --> -0.901021).  Saving model ...
Epoch: 12 cost time: 2.4573898315429688
Epoch: 12, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
Validation loss decreased (-0.901021 --> -0.914673).  Saving model ...
Epoch: 13 cost time: 2.48712420463562
Epoch: 13, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.457 Vali Acc: 0.840 Test Loss: 0.457 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.720592737197876
Epoch: 14, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.386 Vali Acc: 0.898 Test Loss: 0.386 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.652872323989868
Epoch: 15, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9634640216827393
Epoch: 16, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.507 Vali Acc: 0.860 Test Loss: 0.507 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.113739967346191
Epoch: 17, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.420 Vali Acc: 0.877 Test Loss: 0.420 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.0569751262664795
Epoch: 18, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.401 Vali Acc: 0.904 Test Loss: 0.401 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.494340181350708
Epoch: 19, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.009 Vali Acc: 0.730 Test Loss: 1.009 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9862582683563232
Epoch: 20, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.903 Vali Acc: 0.805 Test Loss: 0.903 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.181534290313721
Epoch: 21, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.720 Vali Acc: 0.843 Test Loss: 0.720 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.5407581329345703
Epoch: 22, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.761 Vali Acc: 0.829 Test Loss: 0.761 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps38_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 44166146
model size : 183.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.939957141876221
Epoch: 1, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.348 Vali Acc: 0.887 Test Loss: 0.348 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 3.066018581390381
Epoch: 2, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.479 Vali Acc: 0.768 Test Loss: 0.479 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5247507095336914
Epoch: 3, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.415 Vali Acc: 0.805 Test Loss: 0.415 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.073502779006958
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
Validation loss decreased (-0.887369 --> -0.890782).  Saving model ...
Epoch: 5 cost time: 2.2128355503082275
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.394 Vali Acc: 0.823 Test Loss: 0.394 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5725510120391846
Epoch: 6, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.314 Vali Acc: 0.874 Test Loss: 0.314 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.569577693939209
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.359 Vali Acc: 0.840 Test Loss: 0.359 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.019266128540039
Epoch: 8, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.386 Vali Acc: 0.836 Test Loss: 0.386 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1744961738586426
Epoch: 9, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.295 Vali Acc: 0.891 Test Loss: 0.295 Test Acc: 0.891
Validation loss decreased (-0.890782 --> -0.890782).  Saving model ...
Epoch: 10 cost time: 3.0866847038269043
Epoch: 10, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.411 Vali Acc: 0.881 Test Loss: 0.411 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.258571147918701
Epoch: 11, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3615591526031494
Epoch: 12, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.391 Vali Acc: 0.863 Test Loss: 0.391 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5848171710968018
Epoch: 13, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9756932258605957
Epoch: 14, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.971858263015747
Epoch: 15, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.697 Vali Acc: 0.754 Test Loss: 0.697 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.5699856281280518
Epoch: 16, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.882 Vali Acc: 0.785 Test Loss: 0.882 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.047492504119873
Epoch: 17, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.685 Vali Acc: 0.857 Test Loss: 0.685 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.533137321472168
Epoch: 18, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.426 Vali Acc: 0.898 Test Loss: 0.426 Test Acc: 0.898
Validation loss decreased (-0.890782 --> -0.897607).  Saving model ...
Epoch: 19 cost time: 3.389253616333008
Epoch: 19, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.509 Vali Acc: 0.894 Test Loss: 0.509 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6607308387756348
Epoch: 20, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.615 Vali Acc: 0.877 Test Loss: 0.615 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.796093702316284
Epoch: 21, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.558 Vali Acc: 0.891 Test Loss: 0.558 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7443387508392334
Epoch: 22, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.541 Vali Acc: 0.894 Test Loss: 0.541 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4275107383728027
Epoch: 23, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.518 Vali Acc: 0.887 Test Loss: 0.518 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.261443853378296
Epoch: 24, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.861 Vali Acc: 0.870 Test Loss: 0.861 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.72952938079834
Epoch: 25, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.278 Vali Acc: 0.829 Test Loss: 1.278 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.531280755996704
Epoch: 26, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.905 Vali Acc: 0.819 Test Loss: 0.905 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.34564208984375
Epoch: 27, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.118 Vali Acc: 0.768 Test Loss: 1.118 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.655010938644409
Epoch: 28, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.767 Vali Acc: 0.884 Test Loss: 0.767 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 44043266
model size : 182.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps38_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.989069938659668
Epoch: 1, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.377 Vali Acc: 0.853 Test Loss: 0.377 Test Acc: 0.853
Validation loss decreased (inf --> -0.853239).  Saving model ...
Epoch: 2 cost time: 1.8905584812164307
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.328 Vali Acc: 0.908 Test Loss: 0.328 Test Acc: 0.908
Validation loss decreased (-0.853239 --> -0.907847).  Saving model ...
Epoch: 3 cost time: 1.016448974609375
Epoch: 3, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.495 Vali Acc: 0.788 Test Loss: 0.495 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9682409763336182
Epoch: 4, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.314 Vali Acc: 0.887 Test Loss: 0.314 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6551501750946045
Epoch: 5, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3307595252990723
Epoch: 6, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.509 Vali Acc: 0.683 Test Loss: 0.509 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3745651245117188
Epoch: 7, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.383 Vali Acc: 0.853 Test Loss: 0.383 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3014612197875977
Epoch: 8, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.281 Vali Acc: 0.898 Test Loss: 0.281 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.003056049346924
Epoch: 9, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.322 Vali Acc: 0.881 Test Loss: 0.322 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.34421968460083
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.369586944580078
Epoch: 11, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5544724464416504
Epoch: 12, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.333 Vali Acc: 0.887 Test Loss: 0.333 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps38_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 43972610
model size : 182.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.215012311935425
Epoch: 1, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 3.36608624458313
Epoch: 2, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.634 Vali Acc: 0.655 Test Loss: 0.634 Test Acc: 0.655
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.365741491317749
Epoch: 3, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.558 Vali Acc: 0.758 Test Loss: 0.558 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1084816455841064
Epoch: 4, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.363 Vali Acc: 0.860 Test Loss: 0.363 Test Acc: 0.860
Validation loss decreased (-0.822521 --> -0.860065).  Saving model ...
Epoch: 5 cost time: 3.118394374847412
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.383 Vali Acc: 0.860 Test Loss: 0.383 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7204737663269043
Epoch: 6, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.788 Vali Acc: 0.553 Test Loss: 0.788 Test Acc: 0.553
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.125932455062866
Epoch: 7, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.534 Vali Acc: 0.689 Test Loss: 0.534 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.722841262817383
Epoch: 8, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.431 Vali Acc: 0.799 Test Loss: 0.431 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4953956604003906
Epoch: 9, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.648 Vali Acc: 0.751 Test Loss: 0.648 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.301516532897949
Epoch: 10, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.399 Vali Acc: 0.857 Test Loss: 0.399 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0535483360290527
Epoch: 11, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.886 Vali Acc: 0.642 Test Loss: 0.886 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.05919337272644
Epoch: 12, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.577 Vali Acc: 0.785 Test Loss: 0.577 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.381185054779053
Epoch: 13, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.404 Vali Acc: 0.898 Test Loss: 0.404 Test Acc: 0.898
Validation loss decreased (-0.860065 --> -0.897607).  Saving model ...
Epoch: 14 cost time: 3.770354986190796
Epoch: 14, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.712 Vali Acc: 0.771 Test Loss: 0.712 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.725204229354858
Epoch: 15, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.732 Vali Acc: 0.737 Test Loss: 0.732 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.706009149551392
Epoch: 16, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.605 Vali Acc: 0.863 Test Loss: 0.605 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.1501784324646
Epoch: 17, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.160 Vali Acc: 0.747 Test Loss: 1.160 Test Acc: 0.747
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.765704154968262
Epoch: 18, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.560 Vali Acc: 0.857 Test Loss: 0.560 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.534931182861328
Epoch: 19, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.000 Vali Acc: 0.724 Test Loss: 1.000 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.105208396911621
Epoch: 20, Steps: 17 | Train Loss: 0.240 Vali Loss: 1.101 Vali Acc: 0.785 Test Loss: 1.101 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8772153854370117
Epoch: 21, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.871 Vali Acc: 0.809 Test Loss: 0.871 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.243401050567627
Epoch: 22, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.245 Vali Acc: 0.785 Test Loss: 1.245 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.331544876098633
Epoch: 23, Steps: 17 | Train Loss: 0.326 Vali Loss: 1.548 Vali Acc: 0.659 Test Loss: 1.548 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 44179970
model size : 183.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.353138446807861
Epoch: 1, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
Validation loss decreased (inf --> -0.877130).  Saving model ...
Epoch: 2 cost time: 4.019951343536377
Epoch: 2, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.433 Vali Acc: 0.809 Test Loss: 0.433 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7380101680755615
Epoch: 3, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.338 Vali Acc: 0.874 Test Loss: 0.338 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9980766773223877
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.330 Vali Acc: 0.877 Test Loss: 0.330 Test Acc: 0.877
Validation loss decreased (-0.877130 --> -0.877130).  Saving model ...
Epoch: 5 cost time: 3.6272644996643066
Epoch: 5, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.315 Vali Acc: 0.877 Test Loss: 0.315 Test Acc: 0.877
Validation loss decreased (-0.877130 --> -0.877130).  Saving model ...
Epoch: 6 cost time: 2.2261786460876465
Epoch: 6, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.370 Vali Acc: 0.874 Test Loss: 0.370 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7180392742156982
Epoch: 7, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7636640071868896
Epoch: 8, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.285 Vali Acc: 0.894 Test Loss: 0.285 Test Acc: 0.894
Validation loss decreased (-0.877130 --> -0.894195).  Saving model ...
Epoch: 9 cost time: 1.789175033569336
Epoch: 9, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.334 Vali Acc: 0.901 Test Loss: 0.334 Test Acc: 0.901
Validation loss decreased (-0.894195 --> -0.901021).  Saving model ...
Epoch: 10 cost time: 3.4547371864318848
Epoch: 10, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.820 Vali Acc: 0.683 Test Loss: 0.820 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.035121440887451
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.717 Vali Acc: 0.765 Test Loss: 0.717 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1043803691864014
Epoch: 12, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.347 Vali Acc: 0.887 Test Loss: 0.347 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.104335069656372
Epoch: 13, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0959630012512207
Epoch: 14, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.591641902923584
Epoch: 15, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.630 Vali Acc: 0.778 Test Loss: 0.630 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2429301738739014
Epoch: 16, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.936 Vali Acc: 0.758 Test Loss: 0.936 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8941073417663574
Epoch: 17, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.716 Vali Acc: 0.730 Test Loss: 0.716 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8596882820129395
Epoch: 18, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.482 Vali Acc: 0.874 Test Loss: 0.482 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.830308198928833
Epoch: 19, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.767 Vali Acc: 0.805 Test Loss: 0.767 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 44047874
model size : 182.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7319235801696777
Epoch: 1, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.422 Vali Acc: 0.843 Test Loss: 0.422 Test Acc: 0.843
Validation loss decreased (inf --> -0.842999).  Saving model ...
Epoch: 2 cost time: 2.167107105255127
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
Validation loss decreased (-0.842999 --> -0.866890).  Saving model ...
Epoch: 3 cost time: 2.2075576782226562
Epoch: 3, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4401884078979492
Epoch: 4, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.311 Vali Acc: 0.877 Test Loss: 0.311 Test Acc: 0.877
Validation loss decreased (-0.866890 --> -0.877130).  Saving model ...
Epoch: 5 cost time: 1.7819411754608154
Epoch: 5, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.396 Vali Acc: 0.843 Test Loss: 0.396 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8284268379211426
Epoch: 6, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.476 Vali Acc: 0.795 Test Loss: 0.476 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5262839794158936
Epoch: 7, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.370 Vali Acc: 0.860 Test Loss: 0.370 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1104867458343506
Epoch: 8, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.297 Vali Acc: 0.901 Test Loss: 0.297 Test Acc: 0.901
Validation loss decreased (-0.877130 --> -0.901021).  Saving model ...
Epoch: 9 cost time: 2.184288501739502
Epoch: 9, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.372 Vali Acc: 0.853 Test Loss: 0.372 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9949488639831543
Epoch: 10, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.590 Vali Acc: 0.700 Test Loss: 0.590 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1265816688537598
Epoch: 11, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.384 Vali Acc: 0.836 Test Loss: 0.384 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2922632694244385
Epoch: 12, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.51533842086792
Epoch: 13, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2304916381835938
Epoch: 14, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.296 Vali Acc: 0.901 Test Loss: 0.296 Test Acc: 0.901
Validation loss decreased (-0.901021 --> -0.901021).  Saving model ...
Epoch: 15 cost time: 1.9145832061767578
Epoch: 15, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.360 Vali Acc: 0.908 Test Loss: 0.360 Test Acc: 0.908
Validation loss decreased (-0.901021 --> -0.907846).  Saving model ...
Epoch: 16 cost time: 1.6240057945251465
Epoch: 16, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
Validation loss decreased (-0.907846 --> -0.911260).  Saving model ...
Epoch: 17 cost time: 1.6610910892486572
Epoch: 17, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.632098913192749
Epoch: 18, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.320 Vali Acc: 0.915 Test Loss: 0.320 Test Acc: 0.915
Validation loss decreased (-0.911260 --> -0.914673).  Saving model ...
Epoch: 19 cost time: 2.5673179626464844
Epoch: 19, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.329 Vali Acc: 0.901 Test Loss: 0.329 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0989034175872803
Epoch: 20, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.372 Vali Acc: 0.898 Test Loss: 0.372 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.7842507362365723
Epoch: 21, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.384 Vali Acc: 0.894 Test Loss: 0.384 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.0106868743896484
Epoch: 22, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.891 Vali Acc: 0.737 Test Loss: 0.891 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0434906482696533
Epoch: 23, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.859 Vali Acc: 0.799 Test Loss: 0.859 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6192116737365723
Epoch: 24, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.517 Vali Acc: 0.867 Test Loss: 0.517 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7652790546417236
Epoch: 25, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.581 Vali Acc: 0.853 Test Loss: 0.581 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6900324821472168
Epoch: 26, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.598 Vali Acc: 0.829 Test Loss: 0.598 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.701972007751465
Epoch: 27, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.569 Vali Acc: 0.884 Test Loss: 0.569 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.4014506340026855
Epoch: 28, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.753 Vali Acc: 0.829 Test Loss: 0.753 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 43983362
model size : 182.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.003328800201416
Epoch: 1, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.362 Vali Acc: 0.877 Test Loss: 0.362 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 3.9124906063079834
Epoch: 2, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.617 Vali Acc: 0.689 Test Loss: 0.617 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7180471420288086
Epoch: 3, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.622 Vali Acc: 0.662 Test Loss: 0.622 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.565946340560913
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
Validation loss decreased (-0.877129 --> -0.883956).  Saving model ...
Epoch: 5 cost time: 3.6680846214294434
Epoch: 5, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
Validation loss decreased (-0.883956 --> -0.911260).  Saving model ...
Epoch: 6 cost time: 3.667057752609253
Epoch: 6, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.271 Vali Acc: 0.918 Test Loss: 0.271 Test Acc: 0.918
Validation loss decreased (-0.911260 --> -0.918086).  Saving model ...
Epoch: 7 cost time: 2.6080429553985596
Epoch: 7, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.338 Vali Acc: 0.881 Test Loss: 0.338 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8428964614868164
Epoch: 8, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.497 Vali Acc: 0.823 Test Loss: 0.497 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.901796579360962
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.435 Vali Acc: 0.823 Test Loss: 0.435 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8461105823516846
Epoch: 10, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.765 Vali Acc: 0.805 Test Loss: 0.765 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4333882331848145
Epoch: 11, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.379 Vali Acc: 0.881 Test Loss: 0.379 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2673757076263428
Epoch: 12, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.528 Vali Acc: 0.850 Test Loss: 0.528 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.6783230304718018
Epoch: 13, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9703989028930664
Epoch: 14, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.7670986652374268
Epoch: 15, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.610 Vali Acc: 0.823 Test Loss: 0.610 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.4210591316223145
Epoch: 16, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.951 Vali Acc: 0.792 Test Loss: 0.951 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 44183042
model size : 183.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.968329429626465
Epoch: 1, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.369 Vali Acc: 0.894 Test Loss: 0.369 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 3.1320855617523193
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.533 Vali Acc: 0.713 Test Loss: 0.533 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2616994380950928
Epoch: 3, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7515347003936768
Epoch: 4, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.365 Vali Acc: 0.843 Test Loss: 0.365 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0562047958374023
Epoch: 5, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.341 Vali Acc: 0.863 Test Loss: 0.341 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5369744300842285
Epoch: 6, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.791 Vali Acc: 0.635 Test Loss: 0.791 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8953378200531006
Epoch: 7, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.299 Vali Acc: 0.908 Test Loss: 0.299 Test Acc: 0.908
Validation loss decreased (-0.894194 --> -0.907847).  Saving model ...
Epoch: 8 cost time: 2.123873472213745
Epoch: 8, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
Validation loss decreased (-0.907847 --> -0.921499).  Saving model ...
Epoch: 9 cost time: 2.1383934020996094
Epoch: 9, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.363 Vali Acc: 0.843 Test Loss: 0.363 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.676271915435791
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.412898063659668
Epoch: 11, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.434 Vali Acc: 0.843 Test Loss: 0.434 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8738315105438232
Epoch: 12, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.344 Vali Acc: 0.908 Test Loss: 0.344 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.342536687850952
Epoch: 13, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.408 Vali Acc: 0.874 Test Loss: 0.408 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.213012933731079
Epoch: 14, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.492 Vali Acc: 0.737 Test Loss: 0.492 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2821848392486572
Epoch: 15, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.512 Vali Acc: 0.805 Test Loss: 0.512 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2130684852600098
Epoch: 16, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6001434326171875
Epoch: 17, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.491 Vali Acc: 0.823 Test Loss: 0.491 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.814610719680786
Epoch: 18, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.632 Vali Acc: 0.843 Test Loss: 0.632 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 44069378
model size : 182.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.260268211364746
Epoch: 1, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.463 Vali Acc: 0.863 Test Loss: 0.463 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 1.256988763809204
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.356 Vali Acc: 0.901 Test Loss: 0.356 Test Acc: 0.901
Validation loss decreased (-0.863477 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.5453171730041504
Epoch: 3, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.315 Vali Acc: 0.874 Test Loss: 0.315 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6286933422088623
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5221338272094727
Epoch: 5, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.348989725112915
Epoch: 6, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.421 Vali Acc: 0.751 Test Loss: 0.421 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.856175184249878
Epoch: 7, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.301 Vali Acc: 0.898 Test Loss: 0.301 Test Acc: 0.898
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5949344635009766
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.450 Vali Acc: 0.826 Test Loss: 0.450 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8313536643981934
Epoch: 9, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.344 Vali Acc: 0.867 Test Loss: 0.344 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.272061824798584
Epoch: 10, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.294 Vali Acc: 0.894 Test Loss: 0.294 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1935150623321533
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.901020 --> -0.921499).  Saving model ...
Epoch: 12 cost time: 2.433889627456665
Epoch: 12, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.324 Vali Acc: 0.898 Test Loss: 0.324 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.336862564086914
Epoch: 13, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5430078506469727
Epoch: 14, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.367272138595581
Epoch: 15, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.345 Vali Acc: 0.901 Test Loss: 0.345 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0076003074645996
Epoch: 16, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.362 Vali Acc: 0.911 Test Loss: 0.362 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.116269111633301
Epoch: 17, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.578209638595581
Epoch: 18, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.492 Vali Acc: 0.867 Test Loss: 0.492 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9316959381103516
Epoch: 19, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.443 Vali Acc: 0.891 Test Loss: 0.443 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7977020740509033
Epoch: 20, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.464 Vali Acc: 0.894 Test Loss: 0.464 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3953993320465088
Epoch: 21, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.523 Vali Acc: 0.881 Test Loss: 0.523 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 44007938
model size : 182.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps43_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.956212282180786
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
Validation loss decreased (inf --> -0.890782).  Saving model ...
Epoch: 2 cost time: 3.526573657989502
Epoch: 2, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.477 Vali Acc: 0.788 Test Loss: 0.477 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4966914653778076
Epoch: 3, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.464 Vali Acc: 0.812 Test Loss: 0.464 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2172458171844482
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.087658405303955
Epoch: 5, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.857 Vali Acc: 0.553 Test Loss: 0.857 Test Acc: 0.553
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1624391078948975
Epoch: 6, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.398 Vali Acc: 0.812 Test Loss: 0.398 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6707801818847656
Epoch: 7, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.703 Vali Acc: 0.618 Test Loss: 0.703 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.270048141479492
Epoch: 8, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.481 Vali Acc: 0.724 Test Loss: 0.481 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8049371242523193
Epoch: 9, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.420 Vali Acc: 0.840 Test Loss: 0.420 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6116225719451904
Epoch: 10, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
Validation loss decreased (-0.890782 --> -0.894195).  Saving model ...
Epoch: 11 cost time: 2.20768141746521
Epoch: 11, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.503 Vali Acc: 0.785 Test Loss: 0.503 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8942666053771973
Epoch: 12, Steps: 17 | Train Loss: 0.388 Vali Loss: 1.248 Vali Acc: 0.628 Test Loss: 1.248 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7002756595611572
Epoch: 13, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.557 Vali Acc: 0.846 Test Loss: 0.557 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.664884567260742
Epoch: 14, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.467 Vali Acc: 0.843 Test Loss: 0.467 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3214831352233887
Epoch: 15, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.890 Vali Acc: 0.686 Test Loss: 0.890 Test Acc: 0.686
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7207446098327637
Epoch: 16, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.750 Vali Acc: 0.676 Test Loss: 0.750 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.708888053894043
Epoch: 17, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.621 Vali Acc: 0.734 Test Loss: 1.621 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7943756580352783
Epoch: 18, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.942 Vali Acc: 0.785 Test Loss: 0.942 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7468433380126953
Epoch: 19, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.696 Vali Acc: 0.823 Test Loss: 0.696 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.952359676361084
Epoch: 20, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.669 Vali Acc: 0.846 Test Loss: 0.669 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps43_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 44210690
model size : 183.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps43_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0242624282836914
Epoch: 1, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
Validation loss decreased (inf --> -0.866890).  Saving model ...
Epoch: 2 cost time: 2.0951459407806396
Epoch: 2, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.379 Vali Acc: 0.891 Test Loss: 0.379 Test Acc: 0.891
Validation loss decreased (-0.866890 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 1.4477348327636719
Epoch: 3, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.374 Vali Acc: 0.863 Test Loss: 0.374 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.857804775238037
Epoch: 4, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.362 Vali Acc: 0.857 Test Loss: 0.362 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9224376678466797
Epoch: 5, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.387 Vali Acc: 0.846 Test Loss: 0.387 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.229304313659668
Epoch: 6, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
Validation loss decreased (-0.890781 --> -0.894195).  Saving model ...
Epoch: 7 cost time: 1.9344940185546875
Epoch: 7, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.233952283859253
Epoch: 8, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.103238105773926
Epoch: 9, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.378 Vali Acc: 0.846 Test Loss: 0.378 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.035094976425171
Epoch: 10, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.312 Vali Acc: 0.898 Test Loss: 0.312 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 11 cost time: 1.4389808177947998
Epoch: 11, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.613 Vali Acc: 0.689 Test Loss: 0.613 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.969484806060791
Epoch: 12, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.600 Vali Acc: 0.703 Test Loss: 0.600 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.336413860321045
Epoch: 13, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.066 Vali Acc: 0.631 Test Loss: 1.066 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.469764232635498
Epoch: 14, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.420 Vali Acc: 0.898 Test Loss: 0.420 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5853159427642822
Epoch: 15, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.452848196029663
Epoch: 16, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.488 Vali Acc: 0.867 Test Loss: 0.488 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6857919692993164
Epoch: 17, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
Validation loss decreased (-0.897608 --> -0.911259).  Saving model ...
Epoch: 18 cost time: 2.1031339168548584
Epoch: 18, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.436690330505371
Epoch: 19, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.862 Vali Acc: 0.829 Test Loss: 0.862 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.142193078994751
Epoch: 20, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.613 Vali Acc: 0.874 Test Loss: 0.613 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.502469778060913
Epoch: 21, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.589 Vali Acc: 0.898 Test Loss: 0.589 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2265381813049316
Epoch: 22, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.526 Vali Acc: 0.901 Test Loss: 0.526 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8684637546539307
Epoch: 23, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.701 Vali Acc: 0.898 Test Loss: 0.701 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5481863021850586
Epoch: 24, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.725 Vali Acc: 0.894 Test Loss: 0.725 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6405189037322998
Epoch: 25, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.487 Vali Acc: 0.686 Test Loss: 1.487 Test Acc: 0.686
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9039387702941895
Epoch: 26, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.830 Vali Acc: 0.840 Test Loss: 0.830 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7725768089294434
Epoch: 27, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.787 Vali Acc: 0.870 Test Loss: 0.787 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps43_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 44090882
model size : 182.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps43_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.866567850112915
Epoch: 1, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.403 Vali Acc: 0.898 Test Loss: 0.403 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.8042867183685303
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.380 Vali Acc: 0.904 Test Loss: 0.380 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.8341240882873535
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.384 Vali Acc: 0.881 Test Loss: 0.384 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5386631488800049
Epoch: 4, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.338 Vali Acc: 0.870 Test Loss: 0.338 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.430440902709961
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.314 Vali Acc: 0.863 Test Loss: 0.314 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.372215986251831
Epoch: 6, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.294 Vali Acc: 0.870 Test Loss: 0.294 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6425256729125977
Epoch: 7, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.343 Vali Acc: 0.887 Test Loss: 0.343 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3041892051696777
Epoch: 8, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.273 Vali Acc: 0.932 Test Loss: 0.273 Test Acc: 0.932
Validation loss decreased (-0.904433 --> -0.931738).  Saving model ...
Epoch: 9 cost time: 1.6006393432617188
Epoch: 9, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.258 Vali Acc: 0.894 Test Loss: 0.258 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5722217559814453
Epoch: 10, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.707 Vali Acc: 0.652 Test Loss: 0.707 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.817775011062622
Epoch: 11, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.357 Vali Acc: 0.850 Test Loss: 0.357 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.839508295059204
Epoch: 12, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.422 Vali Acc: 0.744 Test Loss: 0.422 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5551133155822754
Epoch: 13, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.704 Vali Acc: 0.683 Test Loss: 0.704 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6104824542999268
Epoch: 14, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.535 Vali Acc: 0.782 Test Loss: 0.535 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6668221950531006
Epoch: 15, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.293 Vali Acc: 0.898 Test Loss: 0.293 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6836299896240234
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.332 Vali Acc: 0.898 Test Loss: 0.332 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6906418800354004
Epoch: 17, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6778497695922852
Epoch: 18, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps43_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.931740614334471
model parameter : 44032514
model size : 182.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.453902006149292
Epoch: 1, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.380 Vali Acc: 0.863 Test Loss: 0.380 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 2.507699489593506
Epoch: 2, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
Validation loss decreased (-0.863477 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 2.0967226028442383
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.322 Vali Acc: 0.894 Test Loss: 0.322 Test Acc: 0.894
Validation loss decreased (-0.890781 --> -0.894195).  Saving model ...
Epoch: 4 cost time: 2.39056396484375
Epoch: 4, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.477 Vali Acc: 0.805 Test Loss: 0.477 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8710927963256836
Epoch: 5, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.390 Vali Acc: 0.840 Test Loss: 0.390 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6488637924194336
Epoch: 6, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0837528705596924
Epoch: 7, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.374 Vali Acc: 0.829 Test Loss: 0.374 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.758199453353882
Epoch: 8, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.276 Vali Acc: 0.904 Test Loss: 0.276 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904434).  Saving model ...
Epoch: 9 cost time: 3.1901164054870605
Epoch: 9, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.446 Vali Acc: 0.853 Test Loss: 0.446 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5923714637756348
Epoch: 10, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.021184206008911
Epoch: 11, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.498 Vali Acc: 0.826 Test Loss: 0.498 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.275658130645752
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.712 Vali Acc: 0.795 Test Loss: 0.712 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.897240161895752
Epoch: 13, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.228076457977295
Epoch: 14, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.638 Vali Acc: 0.792 Test Loss: 0.638 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3909757137298584
Epoch: 15, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.419 Vali Acc: 0.874 Test Loss: 0.419 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.805126905441284
Epoch: 16, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.626 Vali Acc: 0.843 Test Loss: 0.626 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2856862545013428
Epoch: 17, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.728 Vali Acc: 0.826 Test Loss: 0.728 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3503880500793457
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.491 Vali Acc: 0.894 Test Loss: 0.491 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 44216834
model size : 183.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4353320598602295
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.385 Vali Acc: 0.894 Test Loss: 0.385 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 1.819502830505371
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.445 Vali Acc: 0.782 Test Loss: 0.445 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7399697303771973
Epoch: 3, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6620936393737793
Epoch: 4, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.436 Vali Acc: 0.823 Test Loss: 0.436 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5403194427490234
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.286 Vali Acc: 0.901 Test Loss: 0.286 Test Acc: 0.901
Validation loss decreased (-0.894194 --> -0.901021).  Saving model ...
Epoch: 6 cost time: 1.7942094802856445
Epoch: 6, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
Validation loss decreased (-0.901021 --> -0.911260).  Saving model ...
Epoch: 7 cost time: 1.86362886428833
Epoch: 7, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.303 Vali Acc: 0.898 Test Loss: 0.303 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9169049263000488
Epoch: 8, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.299989938735962
Epoch: 9, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3610644340515137
Epoch: 10, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.295 Vali Acc: 0.891 Test Loss: 0.295 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8588125705718994
Epoch: 11, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.299 Vali Acc: 0.901 Test Loss: 0.299 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0035784244537354
Epoch: 12, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.847651720046997
Epoch: 13, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.724708080291748
Epoch: 14, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.465 Vali Acc: 0.881 Test Loss: 0.465 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2365429401397705
Epoch: 15, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.820 Vali Acc: 0.785 Test Loss: 0.820 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1854751110076904
Epoch: 16, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.685 Vali Acc: 0.840 Test Loss: 0.685 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 44115458
model size : 182.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5709283351898193
Epoch: 1, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.413 Vali Acc: 0.857 Test Loss: 0.413 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 1.25388503074646
Epoch: 2, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.349 Vali Acc: 0.904 Test Loss: 0.349 Test Acc: 0.904
Validation loss decreased (-0.856651 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.0876293182373047
Epoch: 3, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.364 Vali Acc: 0.874 Test Loss: 0.364 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.54805326461792
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.352 Vali Acc: 0.894 Test Loss: 0.352 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8980607986450195
Epoch: 5, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.295 Vali Acc: 0.901 Test Loss: 0.295 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.105177640914917
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.273 Vali Acc: 0.908 Test Loss: 0.273 Test Acc: 0.908
Validation loss decreased (-0.904433 --> -0.907847).  Saving model ...
Epoch: 7 cost time: 1.5810577869415283
Epoch: 7, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5594797134399414
Epoch: 8, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.295 Vali Acc: 0.898 Test Loss: 0.295 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2171576023101807
Epoch: 9, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.327 Vali Acc: 0.870 Test Loss: 0.327 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2455487251281738
Epoch: 10, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.356 Vali Acc: 0.860 Test Loss: 0.356 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1928980350494385
Epoch: 11, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.609 Vali Acc: 0.710 Test Loss: 0.609 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6986711025238037
Epoch: 12, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.379 Vali Acc: 0.881 Test Loss: 0.379 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8118853569030762
Epoch: 13, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.414 Vali Acc: 0.881 Test Loss: 0.414 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6028382778167725
Epoch: 14, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.497 Vali Acc: 0.775 Test Loss: 0.497 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.982780933380127
Epoch: 15, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8574767112731934
Epoch: 16, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.907847 --> -0.914673).  Saving model ...
Epoch: 17 cost time: 1.8962140083312988
Epoch: 17, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.419 Vali Acc: 0.894 Test Loss: 0.419 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8462531566619873
Epoch: 18, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.561 Vali Acc: 0.843 Test Loss: 0.561 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.017686128616333
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.450 Vali Acc: 0.904 Test Loss: 0.450 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6986660957336426
Epoch: 20, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.064173460006714
Epoch: 21, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.164 Vali Acc: 0.747 Test Loss: 1.164 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8308212757110596
Epoch: 22, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.623 Vali Acc: 0.840 Test Loss: 0.623 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4197454452514648
Epoch: 23, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.713 Vali Acc: 0.823 Test Loss: 0.713 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4854233264923096
Epoch: 24, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.677 Vali Acc: 0.843 Test Loss: 0.677 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.181478500366211
Epoch: 25, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.825 Vali Acc: 0.819 Test Loss: 0.825 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.582822322845459
Epoch: 26, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.743 Vali Acc: 0.874 Test Loss: 0.743 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 44057090
model size : 182.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7823703289031982
Epoch: 1, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.386 Vali Acc: 0.846 Test Loss: 0.386 Test Acc: 0.846
Validation loss decreased (inf --> -0.846413).  Saving model ...
Epoch: 2 cost time: 2.7194995880126953
Epoch: 2, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.399 Vali Acc: 0.853 Test Loss: 0.399 Test Acc: 0.853
Validation loss decreased (-0.846413 --> -0.853238).  Saving model ...
Epoch: 3 cost time: 2.8039491176605225
Epoch: 3, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
Validation loss decreased (-0.853238 --> -0.890782).  Saving model ...
Epoch: 4 cost time: 2.8423099517822266
Epoch: 4, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.545 Vali Acc: 0.614 Test Loss: 0.545 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.745879650115967
Epoch: 5, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.567 Vali Acc: 0.648 Test Loss: 0.567 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6778886318206787
Epoch: 6, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.574 Vali Acc: 0.782 Test Loss: 0.574 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7686948776245117
Epoch: 7, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.324 Vali Acc: 0.887 Test Loss: 0.324 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.159092903137207
Epoch: 8, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.532 Vali Acc: 0.792 Test Loss: 0.532 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8335251808166504
Epoch: 9, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.568 Vali Acc: 0.826 Test Loss: 0.568 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8269615173339844
Epoch: 10, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.591 Vali Acc: 0.676 Test Loss: 0.591 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.863820791244507
Epoch: 11, Steps: 17 | Train Loss: 0.476 Vali Loss: 1.019 Vali Acc: 0.594 Test Loss: 1.019 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.708158254623413
Epoch: 12, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.679 Vali Acc: 0.710 Test Loss: 0.679 Test Acc: 0.710
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7890350818634033
Epoch: 13, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.598 Vali Acc: 0.805 Test Loss: 0.598 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 44258306
model size : 183.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.425257682800293
Epoch: 1, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.356 Vali Acc: 0.881 Test Loss: 0.356 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 1.4321529865264893
Epoch: 2, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
Validation loss decreased (-0.880543 --> -0.883955).  Saving model ...
Epoch: 3 cost time: 1.4784095287322998
Epoch: 3, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.299 Vali Acc: 0.898 Test Loss: 0.299 Test Acc: 0.898
Validation loss decreased (-0.883955 --> -0.897608).  Saving model ...
Epoch: 4 cost time: 1.7276716232299805
Epoch: 4, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.459 Vali Acc: 0.741 Test Loss: 0.459 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.042797327041626
Epoch: 5, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.397 Vali Acc: 0.857 Test Loss: 0.397 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8660931587219238
Epoch: 6, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.356 Vali Acc: 0.853 Test Loss: 0.356 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6060371398925781
Epoch: 7, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.341 Vali Acc: 0.860 Test Loss: 0.341 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4137763977050781
Epoch: 8, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.458 Vali Acc: 0.805 Test Loss: 0.458 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3822360038757324
Epoch: 9, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.483 Vali Acc: 0.706 Test Loss: 0.483 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4656500816345215
Epoch: 10, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.265 Vali Acc: 0.908 Test Loss: 0.265 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907847).  Saving model ...
Epoch: 11 cost time: 1.4909534454345703
Epoch: 11, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.461 Vali Acc: 0.843 Test Loss: 0.461 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.085618734359741
Epoch: 12, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.363 Vali Acc: 0.874 Test Loss: 0.363 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.578322172164917
Epoch: 13, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.712 Vali Acc: 0.662 Test Loss: 0.712 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.153942823410034
Epoch: 14, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.513 Vali Acc: 0.860 Test Loss: 0.513 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2973487377166748
Epoch: 15, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.393 Vali Acc: 0.887 Test Loss: 0.393 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0296545028686523
Epoch: 16, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.432 Vali Acc: 0.898 Test Loss: 0.432 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.451591968536377
Epoch: 17, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.413 Vali Acc: 0.887 Test Loss: 0.413 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.158015012741089
Epoch: 18, Steps: 17 | Train Loss: 0.237 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3184726238250732
Epoch: 19, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.974 Vali Acc: 0.713 Test Loss: 0.974 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.09464693069458
Epoch: 20, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.726 Vali Acc: 0.829 Test Loss: 0.726 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 44150786
model size : 183.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.351484775543213
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.350 Vali Acc: 0.901 Test Loss: 0.350 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 1.7356414794921875
Epoch: 2, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.384 Vali Acc: 0.887 Test Loss: 0.384 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5583903789520264
Epoch: 3, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.64365816116333
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.333 Vali Acc: 0.881 Test Loss: 0.333 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6833345890045166
Epoch: 5, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.346 Vali Acc: 0.887 Test Loss: 0.346 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6945672035217285
Epoch: 6, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.340 Vali Acc: 0.860 Test Loss: 0.340 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.509617805480957
Epoch: 7, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.287 Vali Acc: 0.891 Test Loss: 0.287 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8678910732269287
Epoch: 8, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.901020 --> -0.911260).  Saving model ...
Epoch: 9 cost time: 1.9782235622406006
Epoch: 9, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
Validation loss decreased (-0.911260 --> -0.921499).  Saving model ...
Epoch: 10 cost time: 1.9806454181671143
Epoch: 10, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.096846342086792
Epoch: 11, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9482436180114746
Epoch: 12, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.337 Vali Acc: 0.887 Test Loss: 0.337 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5309629440307617
Epoch: 13, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.462 Vali Acc: 0.850 Test Loss: 0.462 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6163041591644287
Epoch: 14, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.428 Vali Acc: 0.829 Test Loss: 0.428 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6754608154296875
Epoch: 15, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.540 Vali Acc: 0.870 Test Loss: 0.540 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5749635696411133
Epoch: 16, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.95096755027771
Epoch: 17, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.564 Vali Acc: 0.812 Test Loss: 0.564 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9019379615783691
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.449 Vali Acc: 0.877 Test Loss: 0.449 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6911053657531738
Epoch: 19, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.468 Vali Acc: 0.836 Test Loss: 0.468 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 44095490
model size : 182.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.647028207778931
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.331 Vali Acc: 0.887 Test Loss: 0.331 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 2.5129997730255127
Epoch: 2, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.604 Vali Acc: 0.648 Test Loss: 0.604 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7991693019866943
Epoch: 3, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.423452377319336
Epoch: 4, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8136849403381348
Epoch: 5, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8187150955200195
Epoch: 6, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4054064750671387
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.335 Vali Acc: 0.874 Test Loss: 0.335 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0920917987823486
Epoch: 8, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.450 Vali Acc: 0.724 Test Loss: 0.450 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.017638921737671
Epoch: 9, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.498 Vali Acc: 0.744 Test Loss: 0.498 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.166015386581421
Epoch: 10, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.275 Vali Acc: 0.904 Test Loss: 0.275 Test Acc: 0.904
Validation loss decreased (-0.887369 --> -0.904434).  Saving model ...
Epoch: 11 cost time: 3.310478448867798
Epoch: 11, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.306 Vali Acc: 0.908 Test Loss: 0.306 Test Acc: 0.908
Validation loss decreased (-0.904434 --> -0.907847).  Saving model ...
Epoch: 12 cost time: 2.2308602333068848
Epoch: 12, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.361 Vali Acc: 0.833 Test Loss: 0.361 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7287955284118652
Epoch: 13, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.652 Vali Acc: 0.751 Test Loss: 0.652 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.309832811355591
Epoch: 14, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.378 Vali Acc: 0.874 Test Loss: 0.378 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6755189895629883
Epoch: 15, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.430 Vali Acc: 0.857 Test Loss: 0.430 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.062145233154297
Epoch: 16, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.450 Vali Acc: 0.857 Test Loss: 0.450 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2617785930633545
Epoch: 17, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.386 Vali Acc: 0.891 Test Loss: 0.386 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2982263565063477
Epoch: 18, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.726 Vali Acc: 0.826 Test Loss: 0.726 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2343480587005615
Epoch: 19, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.863 Vali Acc: 0.792 Test Loss: 0.863 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3333206176757812
Epoch: 20, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.070 Vali Acc: 0.823 Test Loss: 1.070 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.160433292388916
Epoch: 21, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.692 Vali Acc: 0.898 Test Loss: 0.692 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 44270594
model size : 183.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.282242774963379
Epoch: 1, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.405 Vali Acc: 0.846 Test Loss: 0.405 Test Acc: 0.846
Validation loss decreased (inf --> -0.846412).  Saving model ...
Epoch: 2 cost time: 1.8910892009735107
Epoch: 2, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.457 Vali Acc: 0.877 Test Loss: 0.457 Test Acc: 0.877
Validation loss decreased (-0.846412 --> -0.877129).  Saving model ...
Epoch: 3 cost time: 2.3360767364501953
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.358 Vali Acc: 0.901 Test Loss: 0.358 Test Acc: 0.901
Validation loss decreased (-0.877129 --> -0.901020).  Saving model ...
Epoch: 4 cost time: 2.100571632385254
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.502 Vali Acc: 0.601 Test Loss: 0.502 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1829817295074463
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.369 Vali Acc: 0.887 Test Loss: 0.369 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.546678066253662
Epoch: 6, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.281 Vali Acc: 0.901 Test Loss: 0.281 Test Acc: 0.901
Validation loss decreased (-0.901020 --> -0.901021).  Saving model ...
Epoch: 7 cost time: 1.6604077816009521
Epoch: 7, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.344 Vali Acc: 0.874 Test Loss: 0.344 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0959370136260986
Epoch: 8, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5092732906341553
Epoch: 9, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.381 Vali Acc: 0.836 Test Loss: 0.381 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8069615364074707
Epoch: 10, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.398 Vali Acc: 0.867 Test Loss: 0.398 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.578406810760498
Epoch: 11, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.307 Vali Acc: 0.904 Test Loss: 0.307 Test Acc: 0.904
Validation loss decreased (-0.901021 --> -0.904434).  Saving model ...
Epoch: 12 cost time: 2.775634288787842
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.775 Vali Acc: 0.618 Test Loss: 0.775 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8717796802520752
Epoch: 13, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.524176597595215
Epoch: 14, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.872 Vali Acc: 0.642 Test Loss: 0.872 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4924662113189697
Epoch: 15, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.725 Vali Acc: 0.648 Test Loss: 0.725 Test Acc: 0.648
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9831321239471436
Epoch: 16, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.560 Vali Acc: 0.863 Test Loss: 0.560 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.273573398590088
Epoch: 17, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8886938095092773
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.000840187072754
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.578 Vali Acc: 0.874 Test Loss: 0.578 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.741941213607788
Epoch: 20, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.675 Vali Acc: 0.730 Test Loss: 0.675 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.461646556854248
Epoch: 21, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.786 Vali Acc: 0.703 Test Loss: 0.786 Test Acc: 0.703
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 44172290
model size : 183.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.411888360977173
Epoch: 1, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.414 Vali Acc: 0.874 Test Loss: 0.414 Test Acc: 0.874
Validation loss decreased (inf --> -0.873716).  Saving model ...
Epoch: 2 cost time: 2.281593084335327
Epoch: 2, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.356 Vali Acc: 0.928 Test Loss: 0.356 Test Acc: 0.928
Validation loss decreased (-0.873716 --> -0.928324).  Saving model ...
Epoch: 3 cost time: 2.6596763134002686
Epoch: 3, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.360 Vali Acc: 0.904 Test Loss: 0.360 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.892383098602295
Epoch: 4, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.525611639022827
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.326 Vali Acc: 0.887 Test Loss: 0.326 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3146860599517822
Epoch: 6, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.407 Vali Acc: 0.843 Test Loss: 0.407 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5195276737213135
Epoch: 7, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.305 Vali Acc: 0.904 Test Loss: 0.305 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8565831184387207
Epoch: 8, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.293 Vali Acc: 0.884 Test Loss: 0.293 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6702229976654053
Epoch: 9, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.310 Vali Acc: 0.884 Test Loss: 0.310 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5870006084442139
Epoch: 10, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.459 Vali Acc: 0.826 Test Loss: 0.459 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.483566999435425
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.502 Vali Acc: 0.751 Test Loss: 0.502 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6998703479766846
Epoch: 12, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.520 Vali Acc: 0.840 Test Loss: 0.520 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9283276450511946
model parameter : 44120066
model size : 182.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.500708103179932
Epoch: 1, Steps: 17 | Train Loss: 0.687 Vali Loss: 0.331 Vali Acc: 0.898 Test Loss: 0.331 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 2.8598833084106445
Epoch: 2, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.609 Vali Acc: 0.608 Test Loss: 0.609 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.041341543197632
Epoch: 3, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5378146171569824
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.823735237121582
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.337 Vali Acc: 0.860 Test Loss: 0.337 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.718761682510376
Epoch: 6, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.353 Vali Acc: 0.870 Test Loss: 0.353 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.898806571960449
Epoch: 7, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.289 Vali Acc: 0.898 Test Loss: 0.289 Test Acc: 0.898
Validation loss decreased (-0.897608 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 3.8564717769622803
Epoch: 8, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.431 Vali Acc: 0.853 Test Loss: 0.431 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7251553535461426
Epoch: 9, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.403 Vali Acc: 0.840 Test Loss: 0.403 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9936392307281494
Epoch: 10, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.340 Vali Acc: 0.915 Test Loss: 0.340 Test Acc: 0.915
Validation loss decreased (-0.897608 --> -0.914672).  Saving model ...
Epoch: 11 cost time: 2.226684093475342
Epoch: 11, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.327 Vali Acc: 0.887 Test Loss: 0.327 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4939217567443848
Epoch: 12, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.889176845550537
Epoch: 13, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.972 Vali Acc: 0.782 Test Loss: 0.972 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.890552043914795
Epoch: 14, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.746 Vali Acc: 0.826 Test Loss: 0.746 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.245388984680176
Epoch: 15, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.063 Vali Acc: 0.785 Test Loss: 1.063 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.059264659881592
Epoch: 16, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.545 Vali Acc: 0.676 Test Loss: 1.545 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.736494541168213
Epoch: 17, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.951 Vali Acc: 0.727 Test Loss: 0.951 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.770125150680542
Epoch: 18, Steps: 17 | Train Loss: 0.299 Vali Loss: 1.244 Vali Acc: 0.727 Test Loss: 1.244 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6800408363342285
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.052 Vali Acc: 0.823 Test Loss: 1.052 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.5789666175842285
Epoch: 20, Steps: 17 | Train Loss: 0.414 Vali Loss: 1.738 Vali Acc: 0.614 Test Loss: 1.738 Test Acc: 0.614
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 44296706
model size : 183.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6783008575439453
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
Validation loss decreased (inf --> -0.890782).  Saving model ...
Epoch: 2 cost time: 1.9039175510406494
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.462 Vali Acc: 0.713 Test Loss: 0.462 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4208192825317383
Epoch: 3, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8750786781311035
Epoch: 4, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.352 Vali Acc: 0.863 Test Loss: 0.352 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.725193738937378
Epoch: 5, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.472 Vali Acc: 0.829 Test Loss: 0.472 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3085315227508545
Epoch: 6, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.464 Vali Acc: 0.853 Test Loss: 0.464 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6133170127868652
Epoch: 7, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.397 Vali Acc: 0.857 Test Loss: 0.397 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.050523281097412
Epoch: 8, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.515 Vali Acc: 0.795 Test Loss: 0.515 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.528357982635498
Epoch: 9, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.379 Vali Acc: 0.863 Test Loss: 0.379 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3700902462005615
Epoch: 10, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
Validation loss decreased (-0.890782 --> -0.894195).  Saving model ...
Epoch: 11 cost time: 2.3372879028320312
Epoch: 11, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.376 Vali Acc: 0.894 Test Loss: 0.376 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5710701942443848
Epoch: 12, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.328 Vali Acc: 0.887 Test Loss: 0.328 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1647534370422363
Epoch: 13, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.430 Vali Acc: 0.795 Test Loss: 0.430 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.003249168395996
Epoch: 14, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.430 Vali Acc: 0.891 Test Loss: 0.430 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2647666931152344
Epoch: 15, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.343 Vali Acc: 0.901 Test Loss: 0.343 Test Acc: 0.901
Validation loss decreased (-0.894195 --> -0.901020).  Saving model ...
Epoch: 16 cost time: 1.6877894401550293
Epoch: 16, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.425 Vali Acc: 0.891 Test Loss: 0.425 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.635178804397583
Epoch: 17, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.655 Vali Acc: 0.741 Test Loss: 0.655 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8862652778625488
Epoch: 18, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.441 Vali Acc: 0.853 Test Loss: 0.441 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8336918354034424
Epoch: 19, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.628 Vali Acc: 0.857 Test Loss: 0.628 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7435171604156494
Epoch: 20, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.437 Vali Acc: 0.887 Test Loss: 0.437 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4549853801727295
Epoch: 21, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.544 Vali Acc: 0.874 Test Loss: 0.544 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.221327066421509
Epoch: 22, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.621 Vali Acc: 0.860 Test Loss: 0.621 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9577763080596924
Epoch: 23, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.612 Vali Acc: 0.833 Test Loss: 0.612 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6169884204864502
Epoch: 24, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6395118236541748
Epoch: 25, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.558 Vali Acc: 0.863 Test Loss: 0.558 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 44207618
model size : 183.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.018080711364746
Epoch: 1, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.494 Vali Acc: 0.802 Test Loss: 0.494 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 0.9066228866577148
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.377 Vali Acc: 0.860 Test Loss: 0.377 Test Acc: 0.860
Validation loss decreased (-0.802043 --> -0.860064).  Saving model ...
Epoch: 3 cost time: 1.1037731170654297
Epoch: 3, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.381 Vali Acc: 0.891 Test Loss: 0.381 Test Acc: 0.891
Validation loss decreased (-0.860064 --> -0.890781).  Saving model ...
Epoch: 4 cost time: 1.067147970199585
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0609819889068604
Epoch: 5, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.461 Vali Acc: 0.782 Test Loss: 0.461 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4593493938446045
Epoch: 6, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.359 Vali Acc: 0.846 Test Loss: 0.359 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3697597980499268
Epoch: 7, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.386 Vali Acc: 0.826 Test Loss: 0.386 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4187016487121582
Epoch: 8, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.441 Vali Acc: 0.778 Test Loss: 0.441 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3700101375579834
Epoch: 9, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.396 Vali Acc: 0.843 Test Loss: 0.396 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.255204200744629
Epoch: 10, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.384 Vali Acc: 0.887 Test Loss: 0.384 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4027190208435059
Epoch: 11, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6182384490966797
Epoch: 12, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.451 Vali Acc: 0.843 Test Loss: 0.451 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0629756450653076
Epoch: 13, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.428 Vali Acc: 0.853 Test Loss: 0.428 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 44158466
model size : 183.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps56_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6743624210357666
Epoch: 1, Steps: 17 | Train Loss: 0.807 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 2.941425085067749
Epoch: 2, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.439 Vali Acc: 0.870 Test Loss: 0.439 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2423007488250732
Epoch: 3, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.461 Vali Acc: 0.771 Test Loss: 0.461 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.485062599182129
Epoch: 4, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.438 Vali Acc: 0.765 Test Loss: 0.438 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.006802558898926
Epoch: 5, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.294 Vali Acc: 0.908 Test Loss: 0.294 Test Acc: 0.908
Validation loss decreased (-0.877129 --> -0.907847).  Saving model ...
Epoch: 6 cost time: 1.418388843536377
Epoch: 6, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.505 Vali Acc: 0.799 Test Loss: 0.505 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7595388889312744
Epoch: 7, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.406 Vali Acc: 0.853 Test Loss: 0.406 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1143124103546143
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.408 Vali Acc: 0.901 Test Loss: 0.408 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.681220769882202
Epoch: 9, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.351 Vali Acc: 0.901 Test Loss: 0.351 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4902429580688477
Epoch: 10, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.544 Vali Acc: 0.840 Test Loss: 0.544 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3779051303863525
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.093 Vali Acc: 0.659 Test Loss: 1.093 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8864142894744873
Epoch: 12, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.485 Vali Acc: 0.887 Test Loss: 0.485 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.359013795852661
Epoch: 13, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.318 Vali Acc: 0.730 Test Loss: 1.318 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.558570146560669
Epoch: 14, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.854 Vali Acc: 0.683 Test Loss: 0.854 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9334094524383545
Epoch: 15, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.729 Vali Acc: 0.819 Test Loss: 0.729 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps56_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 44338178
model size : 183.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps56_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.099180221557617
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.325 Vali Acc: 0.908 Test Loss: 0.325 Test Acc: 0.908
Validation loss decreased (inf --> -0.907847).  Saving model ...
Epoch: 2 cost time: 1.5953576564788818
Epoch: 2, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.439 Vali Acc: 0.795 Test Loss: 0.439 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.805689811706543
Epoch: 3, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.346 Vali Acc: 0.904 Test Loss: 0.346 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7410376071929932
Epoch: 4, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.349 Vali Acc: 0.874 Test Loss: 0.349 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.604785442352295
Epoch: 5, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.332 Vali Acc: 0.867 Test Loss: 0.332 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5824894905090332
Epoch: 6, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.348 Vali Acc: 0.850 Test Loss: 0.348 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.427175521850586
Epoch: 7, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.355 Vali Acc: 0.853 Test Loss: 0.355 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8234882354736328
Epoch: 8, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.334 Vali Acc: 0.874 Test Loss: 0.334 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9918005466461182
Epoch: 9, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.643 Vali Acc: 0.666 Test Loss: 0.643 Test Acc: 0.666
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8472597599029541
Epoch: 10, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8656115531921387
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps56_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 44246018
model size : 183.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps56_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5252528190612793
Epoch: 1, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.418 Vali Acc: 0.898 Test Loss: 0.418 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.0845108032226562
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.332 Vali Acc: 0.908 Test Loss: 0.332 Test Acc: 0.908
Validation loss decreased (-0.897607 --> -0.907847).  Saving model ...
Epoch: 3 cost time: 1.4189307689666748
Epoch: 3, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.415 Vali Acc: 0.782 Test Loss: 0.415 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4088160991668701
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.269 Vali Acc: 0.894 Test Loss: 0.269 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0826640129089355
Epoch: 5, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.723902702331543
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.254 Vali Acc: 0.904 Test Loss: 0.254 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6450831890106201
Epoch: 7, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.288 Vali Acc: 0.901 Test Loss: 0.288 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3644890785217285
Epoch: 8, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.249 Vali Acc: 0.904 Test Loss: 0.249 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7190825939178467
Epoch: 9, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5985841751098633
Epoch: 10, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911260).  Saving model ...
Epoch: 11 cost time: 1.5460760593414307
Epoch: 11, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.432 Vali Acc: 0.840 Test Loss: 0.432 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7076566219329834
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2004363536834717
Epoch: 13, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.544 Vali Acc: 0.788 Test Loss: 0.544 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.139237642288208
Epoch: 14, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.400 Vali Acc: 0.843 Test Loss: 0.400 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8394434452056885
Epoch: 15, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.411 Vali Acc: 0.840 Test Loss: 0.411 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0125606060028076
Epoch: 16, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9380640983581543
Epoch: 17, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.737 Vali Acc: 0.771 Test Loss: 0.737 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5048608779907227
Epoch: 18, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.483 Vali Acc: 0.877 Test Loss: 0.483 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3348572254180908
Epoch: 19, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0425562858581543
Epoch: 20, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.454 Vali Acc: 0.870 Test Loss: 0.454 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps56_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 44199938
model size : 183.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.159374713897705
Epoch: 1, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
Validation loss decreased (inf --> -0.877130).  Saving model ...
Epoch: 2 cost time: 1.5790882110595703
Epoch: 2, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.424 Vali Acc: 0.860 Test Loss: 0.424 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5699183940887451
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.389 Vali Acc: 0.860 Test Loss: 0.389 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.454578161239624
Epoch: 4, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.453 Vali Acc: 0.795 Test Loss: 0.453 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0868701934814453
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.546 Vali Acc: 0.679 Test Loss: 0.546 Test Acc: 0.679
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0220913887023926
Epoch: 6, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.539 Vali Acc: 0.744 Test Loss: 0.539 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.149829864501953
Epoch: 7, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
Validation loss decreased (-0.877130 --> -0.894195).  Saving model ...
Epoch: 8 cost time: 2.126821517944336
Epoch: 8, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
Validation loss decreased (-0.894195 --> -0.921499).  Saving model ...
Epoch: 9 cost time: 2.4483144283294678
Epoch: 9, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.301 Vali Acc: 0.901 Test Loss: 0.301 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.380213737487793
Epoch: 10, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.321 Vali Acc: 0.887 Test Loss: 0.321 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5739059448242188
Epoch: 11, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.60905385017395
Epoch: 12, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.419 Vali Acc: 0.860 Test Loss: 0.419 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.437486410140991
Epoch: 13, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7456252574920654
Epoch: 14, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.338 Vali Acc: 0.894 Test Loss: 0.338 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0805118083953857
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.489 Vali Acc: 0.823 Test Loss: 0.489 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.391230821609497
Epoch: 16, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.431 Vali Acc: 0.881 Test Loss: 0.431 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7957894802093506
Epoch: 17, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5571024417877197
Epoch: 18, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.963 Vali Acc: 0.734 Test Loss: 0.963 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 44378114
model size : 183.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7556231021881104
Epoch: 1, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 1.6310086250305176
Epoch: 2, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.357 Vali Acc: 0.887 Test Loss: 0.357 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2906718254089355
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.386 Vali Acc: 0.857 Test Loss: 0.386 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.354745626449585
Epoch: 4, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.508 Vali Acc: 0.638 Test Loss: 0.508 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1529877185821533
Epoch: 5, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.303 Vali Acc: 0.887 Test Loss: 0.303 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9006376266479492
Epoch: 6, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
Validation loss decreased (-0.894195 --> -0.894195).  Saving model ...
Epoch: 7 cost time: 1.9630696773529053
Epoch: 7, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9150004386901855
Epoch: 8, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.325 Vali Acc: 0.881 Test Loss: 0.325 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.232146978378296
Epoch: 9, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.463 Vali Acc: 0.823 Test Loss: 0.463 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6999890804290771
Epoch: 10, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.481 Vali Acc: 0.823 Test Loss: 0.481 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3445215225219727
Epoch: 11, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.310 Vali Acc: 0.908 Test Loss: 0.310 Test Acc: 0.908
Validation loss decreased (-0.894195 --> -0.907847).  Saving model ...
Epoch: 12 cost time: 1.5920326709747314
Epoch: 12, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.365 Vali Acc: 0.857 Test Loss: 0.365 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.401298999786377
Epoch: 13, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.341 Vali Acc: 0.887 Test Loss: 0.341 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9371633529663086
Epoch: 14, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.373 Vali Acc: 0.860 Test Loss: 0.373 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.741713523864746
Epoch: 15, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.472 Vali Acc: 0.853 Test Loss: 0.472 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7017688751220703
Epoch: 16, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.394 Vali Acc: 0.881 Test Loss: 0.394 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3454513549804688
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.191610097885132
Epoch: 18, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.551 Vali Acc: 0.829 Test Loss: 0.551 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1316943168640137
Epoch: 19, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.490 Vali Acc: 0.884 Test Loss: 0.490 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.846635580062866
Epoch: 20, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.577 Vali Acc: 0.843 Test Loss: 0.577 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.198546886444092
Epoch: 21, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.458 Vali Acc: 0.884 Test Loss: 0.458 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 44292098
model size : 183.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8086276054382324
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 1.4243488311767578
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.356 Vali Acc: 0.891 Test Loss: 0.356 Test Acc: 0.891
Validation loss decreased (-0.883955 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 1.4428508281707764
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.414 Vali Acc: 0.846 Test Loss: 0.414 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4150352478027344
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.353 Vali Acc: 0.891 Test Loss: 0.353 Test Acc: 0.891
Validation loss decreased (-0.890781 --> -0.890781).  Saving model ...
Epoch: 5 cost time: 1.1502211093902588
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.100275993347168
Epoch: 6, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.388 Vali Acc: 0.853 Test Loss: 0.388 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9097592830657959
Epoch: 7, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.279 Vali Acc: 0.904 Test Loss: 0.279 Test Acc: 0.904
Validation loss decreased (-0.890781 --> -0.904434).  Saving model ...
Epoch: 8 cost time: 1.6968512535095215
Epoch: 8, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.337 Vali Acc: 0.829 Test Loss: 0.337 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3304879665374756
Epoch: 9, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.461 Vali Acc: 0.850 Test Loss: 0.461 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6188042163848877
Epoch: 10, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.299 Vali Acc: 0.908 Test Loss: 0.299 Test Acc: 0.908
Validation loss decreased (-0.904434 --> -0.907847).  Saving model ...
Epoch: 11 cost time: 1.3279545307159424
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.549 Vali Acc: 0.765 Test Loss: 0.549 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5277466773986816
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.333 Vali Acc: 0.898 Test Loss: 0.333 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4250059127807617
Epoch: 13, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.417 Vali Acc: 0.863 Test Loss: 0.417 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6403834819793701
Epoch: 14, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.478 Vali Acc: 0.782 Test Loss: 0.478 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4936797618865967
Epoch: 15, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.420 Vali Acc: 0.867 Test Loss: 0.420 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2285165786743164
Epoch: 16, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.484 Vali Acc: 0.863 Test Loss: 0.484 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.654813289642334
Epoch: 17, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.510 Vali Acc: 0.867 Test Loss: 0.510 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0501222610473633
Epoch: 18, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.731968879699707
Epoch: 19, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2118844985961914
Epoch: 20, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.758 Vali Acc: 0.809 Test Loss: 0.758 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 44249090
model size : 183.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9630556106567383
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 2.670435905456543
Epoch: 2, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.573 Vali Acc: 0.628 Test Loss: 0.573 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.148560047149658
Epoch: 3, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.432 Vali Acc: 0.840 Test Loss: 0.432 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.919769287109375
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.368 Vali Acc: 0.881 Test Loss: 0.368 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.66332745552063
Epoch: 5, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3147988319396973
Epoch: 6, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.421 Vali Acc: 0.778 Test Loss: 0.421 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4540324211120605
Epoch: 7, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.894194 --> -0.894195).  Saving model ...
Epoch: 8 cost time: 2.441952705383301
Epoch: 8, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.395 Vali Acc: 0.853 Test Loss: 0.395 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7238621711730957
Epoch: 9, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.279 Vali Acc: 0.908 Test Loss: 0.279 Test Acc: 0.908
Validation loss decreased (-0.894195 --> -0.907847).  Saving model ...
Epoch: 10 cost time: 2.2541065216064453
Epoch: 10, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.333 Vali Acc: 0.881 Test Loss: 0.333 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4035282135009766
Epoch: 11, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.587 Vali Acc: 0.829 Test Loss: 0.587 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.321674346923828
Epoch: 12, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.458 Vali Acc: 0.840 Test Loss: 0.458 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.435936689376831
Epoch: 13, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.133364677429199
Epoch: 14, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.338 Vali Acc: 0.891 Test Loss: 0.338 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6241705417633057
Epoch: 15, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.562 Vali Acc: 0.754 Test Loss: 0.562 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5632524490356445
Epoch: 16, Steps: 17 | Train Loss: 0.294 Vali Loss: 1.221 Vali Acc: 0.676 Test Loss: 1.221 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3895511627197266
Epoch: 17, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0546228885650635
Epoch: 18, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.433 Vali Acc: 0.915 Test Loss: 0.433 Test Acc: 0.915
Validation loss decreased (-0.907847 --> -0.914671).  Saving model ...
Epoch: 19 cost time: 1.7090065479278564
Epoch: 19, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
Validation loss decreased (-0.914671 --> -0.914672).  Saving model ...
Epoch: 20 cost time: 2.2154488563537598
Epoch: 20, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.405 Vali Acc: 0.908 Test Loss: 0.405 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8623592853546143
Epoch: 21, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.543 Vali Acc: 0.874 Test Loss: 0.543 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.088397264480591
Epoch: 22, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.608 Vali Acc: 0.877 Test Loss: 0.608 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1958673000335693
Epoch: 23, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.725 Vali Acc: 0.881 Test Loss: 0.725 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.889563798904419
Epoch: 24, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.777 Vali Acc: 0.881 Test Loss: 0.777 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.101781129837036
Epoch: 25, Steps: 17 | Train Loss: 0.192 Vali Loss: 1.064 Vali Acc: 0.840 Test Loss: 1.064 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8859612941741943
Epoch: 26, Steps: 17 | Train Loss: 0.301 Vali Loss: 1.041 Vali Acc: 0.840 Test Loss: 1.041 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.5708858966827393
Epoch: 27, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.751 Vali Acc: 0.863 Test Loss: 0.751 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5642287731170654
Epoch: 28, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.758 Vali Acc: 0.881 Test Loss: 0.758 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4800429344177246
Epoch: 29, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.822 Vali Acc: 0.887 Test Loss: 0.822 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 44424194
model size : 184.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.964850902557373
Epoch: 1, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.359 Vali Acc: 0.874 Test Loss: 0.359 Test Acc: 0.874
Validation loss decreased (inf --> -0.873717).  Saving model ...
Epoch: 2 cost time: 1.3813235759735107
Epoch: 2, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.486 Vali Acc: 0.795 Test Loss: 0.486 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3186304569244385
Epoch: 3, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0114822387695312
Epoch: 4, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.455 Vali Acc: 0.823 Test Loss: 0.455 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8245816230773926
Epoch: 5, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.417 Vali Acc: 0.850 Test Loss: 0.417 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.834831953048706
Epoch: 6, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9239399433135986
Epoch: 7, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7828333377838135
Epoch: 8, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.521 Vali Acc: 0.771 Test Loss: 0.521 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9203886985778809
Epoch: 9, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.335 Vali Acc: 0.881 Test Loss: 0.335 Test Acc: 0.881
Validation loss decreased (-0.873717 --> -0.880543).  Saving model ...
Epoch: 10 cost time: 2.5805559158325195
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.305 Vali Acc: 0.901 Test Loss: 0.305 Test Acc: 0.901
Validation loss decreased (-0.880543 --> -0.901021).  Saving model ...
Epoch: 11 cost time: 2.523035764694214
Epoch: 11, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.262 Vali Acc: 0.918 Test Loss: 0.262 Test Acc: 0.918
Validation loss decreased (-0.901021 --> -0.918086).  Saving model ...
Epoch: 12 cost time: 2.728989362716675
Epoch: 12, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.373 Vali Acc: 0.881 Test Loss: 0.373 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8147990703582764
Epoch: 13, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.383 Vali Acc: 0.881 Test Loss: 0.383 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.057809591293335
Epoch: 14, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.334 Vali Acc: 0.908 Test Loss: 0.334 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9028093814849854
Epoch: 15, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.346 Vali Acc: 0.901 Test Loss: 0.346 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5703797340393066
Epoch: 16, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.558 Vali Acc: 0.836 Test Loss: 0.558 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7142095565795898
Epoch: 17, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8421685695648193
Epoch: 18, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.455 Vali Acc: 0.867 Test Loss: 0.455 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3542366027832031
Epoch: 19, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.438 Vali Acc: 0.874 Test Loss: 0.438 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.377929925918579
Epoch: 20, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.136120080947876
Epoch: 21, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.864 Vali Acc: 0.863 Test Loss: 0.864 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 44344322
model size : 183.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.075786590576172
Epoch: 1, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.443 Vali Acc: 0.894 Test Loss: 0.443 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 1.5490262508392334
Epoch: 2, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.435 Vali Acc: 0.874 Test Loss: 0.435 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6196660995483398
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.388 Vali Acc: 0.877 Test Loss: 0.388 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7812342643737793
Epoch: 4, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.349 Vali Acc: 0.881 Test Loss: 0.349 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.502582311630249
Epoch: 5, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5217211246490479
Epoch: 6, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.270 Vali Acc: 0.901 Test Loss: 0.270 Test Acc: 0.901
Validation loss decreased (-0.894194 --> -0.901021).  Saving model ...
Epoch: 7 cost time: 1.3084592819213867
Epoch: 7, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.250 Vali Acc: 0.904 Test Loss: 0.250 Test Acc: 0.904
Validation loss decreased (-0.901021 --> -0.904434).  Saving model ...
Epoch: 8 cost time: 1.3408021926879883
Epoch: 8, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.478 Vali Acc: 0.737 Test Loss: 0.478 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6806824207305908
Epoch: 9, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.796 Vali Acc: 0.638 Test Loss: 0.796 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4709651470184326
Epoch: 10, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.303 Vali Acc: 0.898 Test Loss: 0.303 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1408228874206543
Epoch: 11, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3173346519470215
Epoch: 12, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.249 Vali Acc: 0.915 Test Loss: 0.249 Test Acc: 0.915
Validation loss decreased (-0.904434 --> -0.914673).  Saving model ...
Epoch: 13 cost time: 1.20957350730896
Epoch: 13, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.588 Vali Acc: 0.744 Test Loss: 0.588 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7737393379211426
Epoch: 14, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.386 Vali Acc: 0.863 Test Loss: 0.386 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.192681074142456
Epoch: 15, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7520947456359863
Epoch: 16, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6205108165740967
Epoch: 17, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.914673 --> -0.924912).  Saving model ...
Epoch: 18 cost time: 1.4284086227416992
Epoch: 18, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.310 Vali Acc: 0.901 Test Loss: 0.310 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7927372455596924
Epoch: 19, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.303290843963623
Epoch: 20, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.419081211090088
Epoch: 21, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5816998481750488
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.509 Vali Acc: 0.853 Test Loss: 0.509 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.324911117553711
Epoch: 23, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4007301330566406
Epoch: 24, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2282476425170898
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.557 Vali Acc: 0.860 Test Loss: 0.557 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.886786699295044
Epoch: 26, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.893 Vali Acc: 0.799 Test Loss: 0.893 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.087883472442627
Epoch: 27, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.642 Vali Acc: 0.874 Test Loss: 0.642 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9249146757679181
model parameter : 44304386
model size : 183.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps69_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9257469177246094
Epoch: 1, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.345 Vali Acc: 0.901 Test Loss: 0.345 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 2.6462202072143555
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.362 Vali Acc: 0.863 Test Loss: 0.362 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9266092777252197
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.442 Vali Acc: 0.805 Test Loss: 0.442 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.229306221008301
Epoch: 4, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.296 Vali Acc: 0.884 Test Loss: 0.296 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.045083522796631
Epoch: 5, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.460 Vali Acc: 0.741 Test Loss: 0.460 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7929258346557617
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6402950286865234
Epoch: 7, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.405 Vali Acc: 0.823 Test Loss: 0.405 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.752227544784546
Epoch: 8, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5899012088775635
Epoch: 9, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.353 Vali Acc: 0.863 Test Loss: 0.353 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1172680854797363
Epoch: 10, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.284 Vali Acc: 0.894 Test Loss: 0.284 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1997852325439453
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.447 Vali Acc: 0.823 Test Loss: 0.447 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps69_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 44471810
model size : 184.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps69_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.261507511138916
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 2.116696357727051
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.507 Vali Acc: 0.638 Test Loss: 0.507 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8243331909179688
Epoch: 3, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.411 Vali Acc: 0.826 Test Loss: 0.411 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.705815076828003
Epoch: 4, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.582 Vali Acc: 0.638 Test Loss: 0.582 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5268478393554688
Epoch: 5, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9355363845825195
Epoch: 6, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
Validation loss decreased (-0.894195 --> -0.894195).  Saving model ...
Epoch: 7 cost time: 1.7197775840759277
Epoch: 7, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
Validation loss decreased (-0.894195 --> -0.894195).  Saving model ...
Epoch: 8 cost time: 1.281346321105957
Epoch: 8, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2396700382232666
Epoch: 9, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.339 Vali Acc: 0.901 Test Loss: 0.339 Test Acc: 0.901
Validation loss decreased (-0.894195 --> -0.901020).  Saving model ...
Epoch: 10 cost time: 1.3814032077789307
Epoch: 10, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.291 Vali Acc: 0.918 Test Loss: 0.291 Test Acc: 0.918
Validation loss decreased (-0.901020 --> -0.918086).  Saving model ...
Epoch: 11 cost time: 1.7232587337493896
Epoch: 11, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.778205156326294
Epoch: 12, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.515 Vali Acc: 0.785 Test Loss: 0.515 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9932920932769775
Epoch: 13, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.792125940322876
Epoch: 14, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.655 Vali Acc: 0.802 Test Loss: 0.655 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8094062805175781
Epoch: 15, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.721 Vali Acc: 0.805 Test Loss: 0.721 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8116607666015625
Epoch: 16, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.394 Vali Acc: 0.898 Test Loss: 0.394 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4967968463897705
Epoch: 17, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.203348159790039
Epoch: 18, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.513 Vali Acc: 0.853 Test Loss: 0.513 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.74039888381958
Epoch: 19, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.622 Vali Acc: 0.846 Test Loss: 0.622 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.614739179611206
Epoch: 20, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.494 Vali Acc: 0.874 Test Loss: 0.494 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps69_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 44404226
model size : 184.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps69_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7065391540527344
Epoch: 1, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 1.5123112201690674
Epoch: 2, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.877129 --> -0.924911).  Saving model ...
Epoch: 3 cost time: 1.519223928451538
Epoch: 3, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.383 Vali Acc: 0.863 Test Loss: 0.383 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5119359493255615
Epoch: 4, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.377 Vali Acc: 0.863 Test Loss: 0.377 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2332992553710938
Epoch: 5, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.609 Vali Acc: 0.693 Test Loss: 0.609 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.539478063583374
Epoch: 6, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.252 Vali Acc: 0.915 Test Loss: 0.252 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.395819902420044
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.258 Vali Acc: 0.904 Test Loss: 0.258 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9448676109313965
Epoch: 8, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.472 Vali Acc: 0.823 Test Loss: 0.472 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4436290264129639
Epoch: 9, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.278 Vali Acc: 0.901 Test Loss: 0.278 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0589094161987305
Epoch: 10, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.270 Vali Acc: 0.898 Test Loss: 0.270 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5559895038604736
Epoch: 11, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.293 Vali Acc: 0.908 Test Loss: 0.293 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1333394050598145
Epoch: 12, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.322 Vali Acc: 0.884 Test Loss: 0.322 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps69_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9249146757679181
model parameter : 44367362
model size : 183.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.431509256362915
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.557 Vali Acc: 0.543 Test Loss: 0.557 Test Acc: 0.543
Validation loss decreased (inf --> -0.542657).  Saving model ...
Epoch: 2 cost time: 2.5470662117004395
Epoch: 2, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.407 Vali Acc: 0.898 Test Loss: 0.407 Test Acc: 0.898
Validation loss decreased (-0.542657 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 3.0652213096618652
Epoch: 3, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.388 Vali Acc: 0.881 Test Loss: 0.388 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.549051523208618
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.297 Vali Acc: 0.898 Test Loss: 0.297 Test Acc: 0.898
Validation loss decreased (-0.897607 --> -0.897608).  Saving model ...
Epoch: 5 cost time: 2.6351158618927
Epoch: 5, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2743008136749268
Epoch: 6, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
Validation loss decreased (-0.897608 --> -0.911259).  Saving model ...
Epoch: 7 cost time: 1.5401291847229004
Epoch: 7, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.444 Vali Acc: 0.778 Test Loss: 0.444 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4556801319122314
Epoch: 8, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.613 Vali Acc: 0.638 Test Loss: 0.613 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.385605812072754
Epoch: 9, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.468 Vali Acc: 0.799 Test Loss: 0.468 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.478177547454834
Epoch: 10, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.395 Vali Acc: 0.853 Test Loss: 0.395 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3503286838531494
Epoch: 11, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.822 Vali Acc: 0.563 Test Loss: 0.822 Test Acc: 0.563
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.477907657623291
Epoch: 12, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2684261798858643
Epoch: 13, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.603 Vali Acc: 0.761 Test Loss: 0.603 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.03232479095459
Epoch: 14, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0132386684417725
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7757720947265625
Epoch: 16, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 44548610
model size : 184.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.065274000167847
Epoch: 1, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.406 Vali Acc: 0.891 Test Loss: 0.406 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 1.8358607292175293
Epoch: 2, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.360 Vali Acc: 0.901 Test Loss: 0.360 Test Acc: 0.901
Validation loss decreased (-0.890781 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.4561707973480225
Epoch: 3, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.433 Vali Acc: 0.805 Test Loss: 0.433 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6551284790039062
Epoch: 4, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6526710987091064
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.281 Vali Acc: 0.898 Test Loss: 0.281 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.079272747039795
Epoch: 6, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.514 Vali Acc: 0.689 Test Loss: 0.514 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8286008834838867
Epoch: 7, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0921642780303955
Epoch: 8, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.307 Vali Acc: 0.884 Test Loss: 0.307 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.749997854232788
Epoch: 9, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.313 Vali Acc: 0.887 Test Loss: 0.313 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.677882194519043
Epoch: 10, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.844 Vali Acc: 0.730 Test Loss: 0.844 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5918378829956055
Epoch: 11, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.604 Vali Acc: 0.833 Test Loss: 0.604 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.336430549621582
Epoch: 12, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 44481026
model size : 184.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2067675590515137
Epoch: 1, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.432 Vali Acc: 0.904 Test Loss: 0.432 Test Acc: 0.904
Validation loss decreased (inf --> -0.904433).  Saving model ...
Epoch: 2 cost time: 1.1874747276306152
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.389 Vali Acc: 0.904 Test Loss: 0.389 Test Acc: 0.904
Validation loss decreased (-0.904433 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.623305320739746
Epoch: 3, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.904433 --> -0.921498).  Saving model ...
Epoch: 4 cost time: 1.7425212860107422
Epoch: 4, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.368 Vali Acc: 0.857 Test Loss: 0.368 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5675156116485596
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.350 Vali Acc: 0.860 Test Loss: 0.350 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.770850419998169
Epoch: 6, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.311 Vali Acc: 0.881 Test Loss: 0.311 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5133593082427979
Epoch: 7, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.500 Vali Acc: 0.717 Test Loss: 0.500 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2415242195129395
Epoch: 8, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.413 Vali Acc: 0.768 Test Loss: 0.413 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6830358505249023
Epoch: 9, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.385 Vali Acc: 0.860 Test Loss: 0.385 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6017005443572998
Epoch: 10, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.428 Vali Acc: 0.812 Test Loss: 0.428 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6237659454345703
Epoch: 11, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6266393661499023
Epoch: 12, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4717018604278564
Epoch: 13, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.328 Vali Acc: 0.901 Test Loss: 0.328 Test Acc: 0.901
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 44447234
model size : 184.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps82_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.80408787727356
Epoch: 1, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.363 Vali Acc: 0.860 Test Loss: 0.363 Test Acc: 0.860
Validation loss decreased (inf --> -0.860065).  Saving model ...
Epoch: 2 cost time: 2.0034427642822266
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.390 Vali Acc: 0.874 Test Loss: 0.390 Test Acc: 0.874
Validation loss decreased (-0.860065 --> -0.873716).  Saving model ...
Epoch: 3 cost time: 2.2954952716827393
Epoch: 3, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.28554105758667
Epoch: 4, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
Validation loss decreased (-0.873716 --> -0.883955).  Saving model ...
Epoch: 5 cost time: 2.40169358253479
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.562 Vali Acc: 0.734 Test Loss: 0.562 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.55786395072937
Epoch: 6, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.399 Vali Acc: 0.843 Test Loss: 0.399 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9698917865753174
Epoch: 7, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.767 Vali Acc: 0.590 Test Loss: 0.767 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6336560249328613
Epoch: 8, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3022072315216064
Epoch: 9, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.746 Vali Acc: 0.628 Test Loss: 0.746 Test Acc: 0.628
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.858656644821167
Epoch: 10, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.497 Vali Acc: 0.741 Test Loss: 0.497 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.692887306213379
Epoch: 11, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.442 Vali Acc: 0.826 Test Loss: 0.442 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.039398431777954
Epoch: 12, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.519 Vali Acc: 0.846 Test Loss: 0.519 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0120086669921875
Epoch: 13, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.593 Vali Acc: 0.823 Test Loss: 0.593 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8260679244995117
Epoch: 14, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps82_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 44630018
model size : 184.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps82_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.0297300815582275
Epoch: 1, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.8144407272338867
Epoch: 2, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.398 Vali Acc: 0.846 Test Loss: 0.398 Test Acc: 0.846
Validation loss decreased (-0.832760 --> -0.846412).  Saving model ...
Epoch: 3 cost time: 2.296590805053711
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.357 Vali Acc: 0.860 Test Loss: 0.357 Test Acc: 0.860
Validation loss decreased (-0.846412 --> -0.860065).  Saving model ...
Epoch: 4 cost time: 1.2317736148834229
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.486 Vali Acc: 0.795 Test Loss: 0.486 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.269813060760498
Epoch: 5, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.329 Vali Acc: 0.887 Test Loss: 0.329 Test Acc: 0.887
Validation loss decreased (-0.860065 --> -0.887369).  Saving model ...
Epoch: 6 cost time: 1.351048231124878
Epoch: 6, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.316 Vali Acc: 0.884 Test Loss: 0.316 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3592278957366943
Epoch: 7, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.424 Vali Acc: 0.758 Test Loss: 0.424 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8190176486968994
Epoch: 8, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.490 Vali Acc: 0.696 Test Loss: 0.490 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.407470703125
Epoch: 9, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.642 Vali Acc: 0.659 Test Loss: 0.642 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5510954856872559
Epoch: 10, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7500429153442383
Epoch: 11, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.368 Vali Acc: 0.881 Test Loss: 0.368 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8276522159576416
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.428 Vali Acc: 0.819 Test Loss: 0.428 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.062629461288452
Epoch: 13, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.459506034851074
Epoch: 14, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.649 Vali Acc: 0.802 Test Loss: 0.649 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7573721408843994
Epoch: 15, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.413 Vali Acc: 0.881 Test Loss: 0.413 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps82_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 44571650
model size : 184.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps82_str82_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8520374298095703
Epoch: 1, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 1.5355932712554932
Epoch: 2, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.359 Vali Acc: 0.887 Test Loss: 0.359 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.95166015625
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.423 Vali Acc: 0.867 Test Loss: 0.423 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6775546073913574
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.325 Vali Acc: 0.884 Test Loss: 0.325 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3326663970947266
Epoch: 5, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.429 Vali Acc: 0.795 Test Loss: 0.429 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0288550853729248
Epoch: 6, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.430 Vali Acc: 0.727 Test Loss: 0.430 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3298444747924805
Epoch: 7, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.266 Vali Acc: 0.908 Test Loss: 0.266 Test Acc: 0.908
Validation loss decreased (-0.890781 --> -0.907847).  Saving model ...
Epoch: 8 cost time: 1.3434035778045654
Epoch: 8, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.297 Vali Acc: 0.870 Test Loss: 0.297 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1246466636657715
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.348 Vali Acc: 0.823 Test Loss: 0.348 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2538785934448242
Epoch: 10, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.239 Vali Acc: 0.918 Test Loss: 0.239 Test Acc: 0.918
Validation loss decreased (-0.907847 --> -0.918086).  Saving model ...
Epoch: 11 cost time: 1.120913028717041
Epoch: 11, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.289 Vali Acc: 0.901 Test Loss: 0.289 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1672132015228271
Epoch: 12, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.978118896484375
Epoch: 13, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.298 Vali Acc: 0.898 Test Loss: 0.298 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2706644535064697
Epoch: 14, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1940670013427734
Epoch: 15, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.290 Vali Acc: 0.904 Test Loss: 0.290 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.212705135345459
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.339 Vali Acc: 0.901 Test Loss: 0.339 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2451415061950684
Epoch: 17, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5134320259094238
Epoch: 18, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.711 Vali Acc: 0.686 Test Loss: 0.711 Test Acc: 0.686
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4868760108947754
Epoch: 19, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5996487140655518
Epoch: 20, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.387 Vali Acc: 0.898 Test Loss: 0.387 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps82_str82_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 44540930
model size : 184.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps90_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6093058586120605
Epoch: 1, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
Validation loss decreased (inf --> -0.870304).  Saving model ...
Epoch: 2 cost time: 1.920973777770996
Epoch: 2, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.424 Vali Acc: 0.840 Test Loss: 0.424 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3444256782531738
Epoch: 3, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.474 Vali Acc: 0.683 Test Loss: 0.474 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0820467472076416
Epoch: 4, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2466483116149902
Epoch: 5, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.389 Vali Acc: 0.840 Test Loss: 0.389 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.065545082092285
Epoch: 6, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.301 Vali Acc: 0.908 Test Loss: 0.301 Test Acc: 0.908
Validation loss decreased (-0.870304 --> -0.907847).  Saving model ...
Epoch: 7 cost time: 2.735745906829834
Epoch: 7, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.305 Vali Acc: 0.901 Test Loss: 0.305 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6681275367736816
Epoch: 8, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.526 Vali Acc: 0.730 Test Loss: 0.526 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9308972358703613
Epoch: 9, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.412 Vali Acc: 0.778 Test Loss: 0.412 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.030669927597046
Epoch: 10, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.428 Vali Acc: 0.846 Test Loss: 0.428 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.015639543533325
Epoch: 11, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
Validation loss decreased (-0.907847 --> -0.914673).  Saving model ...
Epoch: 12 cost time: 1.8814470767974854
Epoch: 12, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.488 Vali Acc: 0.846 Test Loss: 0.488 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8171136379241943
Epoch: 13, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.588 Vali Acc: 0.846 Test Loss: 0.588 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.030282497406006
Epoch: 14, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7844126224517822
Epoch: 15, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.946 Vali Acc: 0.717 Test Loss: 0.946 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.077793598175049
Epoch: 16, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.814 Vali Acc: 0.652 Test Loss: 0.814 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3501617908477783
Epoch: 17, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.705 Vali Acc: 0.741 Test Loss: 0.705 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.922391653060913
Epoch: 18, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.294848918914795
Epoch: 19, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.613 Vali Acc: 0.853 Test Loss: 0.613 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.534745216369629
Epoch: 20, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.928 Vali Acc: 0.795 Test Loss: 0.928 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.297593355178833
Epoch: 21, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.977 Vali Acc: 0.819 Test Loss: 0.977 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps90_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 44731394
model size : 185.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.246107339859009
Epoch: 1, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.311 Vali Acc: 0.898 Test Loss: 0.311 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.6950995922088623
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.329 Vali Acc: 0.911 Test Loss: 0.329 Test Acc: 0.911
Validation loss decreased (-0.897608 --> -0.911260).  Saving model ...
Epoch: 3 cost time: 1.7055795192718506
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.54182767868042
Epoch: 4, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.378 Vali Acc: 0.887 Test Loss: 0.378 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2607803344726562
Epoch: 5, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.293 Vali Acc: 0.904 Test Loss: 0.293 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.375535249710083
Epoch: 6, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.366 Vali Acc: 0.867 Test Loss: 0.366 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6746716499328613
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.384 Vali Acc: 0.840 Test Loss: 0.384 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9820232391357422
Epoch: 8, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.560 Vali Acc: 0.734 Test Loss: 0.560 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.872185468673706
Epoch: 9, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.433 Vali Acc: 0.819 Test Loss: 0.433 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3824074268341064
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.485 Vali Acc: 0.823 Test Loss: 0.485 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7475719451904297
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.382 Vali Acc: 0.874 Test Loss: 0.382 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.550241708755493
Epoch: 12, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 44676098
model size : 185.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps90_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8125009536743164
Epoch: 1, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.370 Vali Acc: 0.867 Test Loss: 0.370 Test Acc: 0.867
Validation loss decreased (inf --> -0.866890).  Saving model ...
Epoch: 2 cost time: 0.8931927680969238
Epoch: 2, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.324 Vali Acc: 0.901 Test Loss: 0.324 Test Acc: 0.901
Validation loss decreased (-0.866890 --> -0.901021).  Saving model ...
Epoch: 3 cost time: 1.2991125583648682
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.375 Vali Acc: 0.894 Test Loss: 0.375 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9676668643951416
Epoch: 4, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9965581893920898
Epoch: 5, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.293 Vali Acc: 0.891 Test Loss: 0.293 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.508340835571289
Epoch: 6, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.331 Vali Acc: 0.860 Test Loss: 0.331 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5026836395263672
Epoch: 7, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.423 Vali Acc: 0.788 Test Loss: 0.423 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3233284950256348
Epoch: 8, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.301 Vali Acc: 0.877 Test Loss: 0.301 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4363481998443604
Epoch: 9, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.763521671295166
Epoch: 10, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3352701663970947
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.477 Vali Acc: 0.799 Test Loss: 0.477 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2308294773101807
Epoch: 12, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.400 Vali Acc: 0.860 Test Loss: 0.400 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps90_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 44648450
model size : 185.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.078259468078613
Epoch: 1, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.338 Vali Acc: 0.887 Test Loss: 0.338 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 2.7795002460479736
Epoch: 2, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.345 Vali Acc: 0.887 Test Loss: 0.345 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.345916748046875
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.447 Vali Acc: 0.720 Test Loss: 0.447 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9060688018798828
Epoch: 4, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.676 Vali Acc: 0.543 Test Loss: 0.676 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5387306213378906
Epoch: 5, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.601 Vali Acc: 0.618 Test Loss: 0.601 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.691420078277588
Epoch: 6, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.352 Vali Acc: 0.863 Test Loss: 0.352 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.679899215698242
Epoch: 7, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.432 Vali Acc: 0.846 Test Loss: 0.432 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.310271978378296
Epoch: 8, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.610 Vali Acc: 0.771 Test Loss: 0.610 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8899469375610352
Epoch: 9, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.418 Vali Acc: 0.853 Test Loss: 0.418 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0026357173919678
Epoch: 10, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4221417903900146
Epoch: 11, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.411 Vali Acc: 0.867 Test Loss: 0.411 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 44857346
model size : 185.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.657384157180786
Epoch: 1, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.347 Vali Acc: 0.898 Test Loss: 0.347 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 2.0830726623535156
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2183170318603516
Epoch: 3, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.380 Vali Acc: 0.863 Test Loss: 0.380 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.733550548553467
Epoch: 4, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7026865482330322
Epoch: 5, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.354 Vali Acc: 0.863 Test Loss: 0.354 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1352176666259766
Epoch: 6, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.401 Vali Acc: 0.846 Test Loss: 0.401 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2297122478485107
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.679 Vali Acc: 0.587 Test Loss: 0.679 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9625322818756104
Epoch: 8, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.326 Vali Acc: 0.904 Test Loss: 0.326 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904434).  Saving model ...
Epoch: 9 cost time: 1.641946792602539
Epoch: 9, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.479 Vali Acc: 0.741 Test Loss: 0.479 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7260611057281494
Epoch: 10, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.655 Vali Acc: 0.662 Test Loss: 0.655 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.066612482070923
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.776 Vali Acc: 0.645 Test Loss: 0.776 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8367242813110352
Epoch: 12, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2337441444396973
Epoch: 13, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.089547634124756
Epoch: 14, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.458 Vali Acc: 0.840 Test Loss: 0.458 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.031132459640503
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.596 Vali Acc: 0.805 Test Loss: 0.596 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5991597175598145
Epoch: 16, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.643 Vali Acc: 0.782 Test Loss: 0.643 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.993994951248169
Epoch: 17, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.852 Vali Acc: 0.696 Test Loss: 0.852 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.877103328704834
Epoch: 18, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.657 Vali Acc: 0.775 Test Loss: 0.657 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 44808194
model size : 185.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.031996250152588
Epoch: 1, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.347 Vali Acc: 0.881 Test Loss: 0.347 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 0.9666318893432617
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.334 Vali Acc: 0.904 Test Loss: 0.334 Test Acc: 0.904
Validation loss decreased (-0.880543 --> -0.904434).  Saving model ...
Epoch: 3 cost time: 1.231651782989502
Epoch: 3, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.313 Vali Acc: 0.898 Test Loss: 0.313 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2012324333190918
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.321 Vali Acc: 0.901 Test Loss: 0.321 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1500799655914307
Epoch: 5, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.299 Vali Acc: 0.881 Test Loss: 0.299 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5747778415679932
Epoch: 6, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.366 Vali Acc: 0.860 Test Loss: 0.366 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.40580153465271
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.390 Vali Acc: 0.829 Test Loss: 0.390 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1461317539215088
Epoch: 8, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.424 Vali Acc: 0.823 Test Loss: 0.424 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5282649993896484
Epoch: 9, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.545 Vali Acc: 0.734 Test Loss: 0.545 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.732919692993164
Epoch: 10, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.426 Vali Acc: 0.840 Test Loss: 0.426 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1288654804229736
Epoch: 11, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.411 Vali Acc: 0.857 Test Loss: 0.411 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5966904163360596
Epoch: 12, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.337 Vali Acc: 0.898 Test Loss: 0.337 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 44783618
model size : 185.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps112_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.693362236022949
Epoch: 1, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
Validation loss decreased (inf --> -0.877130).  Saving model ...
Epoch: 2 cost time: 2.5862693786621094
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.351 Vali Acc: 0.894 Test Loss: 0.351 Test Acc: 0.894
Validation loss decreased (-0.877130 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 1.872760534286499
Epoch: 3, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.414 Vali Acc: 0.843 Test Loss: 0.414 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0615618228912354
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.399 Vali Acc: 0.840 Test Loss: 0.399 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6605134010314941
Epoch: 5, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3241779804229736
Epoch: 6, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.290 Vali Acc: 0.904 Test Loss: 0.290 Test Acc: 0.904
Validation loss decreased (-0.894194 --> -0.904434).  Saving model ...
Epoch: 7 cost time: 1.493628740310669
Epoch: 7, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.904434 --> -0.921499).  Saving model ...
Epoch: 8 cost time: 1.5766167640686035
Epoch: 8, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.276 Vali Acc: 0.908 Test Loss: 0.276 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2701334953308105
Epoch: 9, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.284 Vali Acc: 0.908 Test Loss: 0.284 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.485642910003662
Epoch: 10, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.356 Vali Acc: 0.874 Test Loss: 0.356 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.912231206893921
Epoch: 11, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6503827571868896
Epoch: 12, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.389 Vali Acc: 0.863 Test Loss: 0.389 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.068211555480957
Epoch: 13, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.398 Vali Acc: 0.863 Test Loss: 0.398 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5767171382904053
Epoch: 14, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.438 Vali Acc: 0.863 Test Loss: 0.438 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7249879837036133
Epoch: 15, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.419 Vali Acc: 0.898 Test Loss: 0.419 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0861432552337646
Epoch: 16, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.048635244369507
Epoch: 17, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.838 Vali Acc: 0.730 Test Loss: 0.838 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps112_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 45014018
model size : 186.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps112_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8304519653320312
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 1.0726823806762695
Epoch: 2, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
Validation loss decreased (-0.877129 --> -0.883956).  Saving model ...
Epoch: 3 cost time: 1.0161681175231934
Epoch: 3, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.362 Vali Acc: 0.908 Test Loss: 0.362 Test Acc: 0.908
Validation loss decreased (-0.883956 --> -0.907846).  Saving model ...
Epoch: 4 cost time: 1.3061692714691162
Epoch: 4, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.077507495880127
Epoch: 5, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.281 Vali Acc: 0.901 Test Loss: 0.281 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.238511562347412
Epoch: 6, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.245 Vali Acc: 0.918 Test Loss: 0.245 Test Acc: 0.918
Validation loss decreased (-0.907846 --> -0.918086).  Saving model ...
Epoch: 7 cost time: 1.488049030303955
Epoch: 7, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3212568759918213
Epoch: 8, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.457 Vali Acc: 0.799 Test Loss: 0.457 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9803359508514404
Epoch: 9, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.350 Vali Acc: 0.860 Test Loss: 0.350 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.071918249130249
Epoch: 10, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.428 Vali Acc: 0.836 Test Loss: 0.428 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.154691457748413
Epoch: 11, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.436 Vali Acc: 0.768 Test Loss: 0.436 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1096742153167725
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.307 Vali Acc: 0.901 Test Loss: 0.307 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.025435209274292
Epoch: 13, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.392352819442749
Epoch: 14, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3872323036193848
Epoch: 15, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.631 Vali Acc: 0.706 Test Loss: 0.631 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0496137142181396
Epoch: 16, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.424 Vali Acc: 0.887 Test Loss: 0.424 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps112_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 44971010
model size : 186.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps112_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1208646297454834
Epoch: 1, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.408 Vali Acc: 0.887 Test Loss: 0.408 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 1.383481502532959
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.360 Vali Acc: 0.901 Test Loss: 0.360 Test Acc: 0.901
Validation loss decreased (-0.887368 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.37736177444458
Epoch: 3, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4949455261230469
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.351 Vali Acc: 0.887 Test Loss: 0.351 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1994762420654297
Epoch: 5, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9428343772888184
Epoch: 6, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.901020 --> -0.921499).  Saving model ...
Epoch: 7 cost time: 1.1208298206329346
Epoch: 7, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.281 Vali Acc: 0.898 Test Loss: 0.281 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9924776554107666
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.267 Vali Acc: 0.904 Test Loss: 0.267 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.959343671798706
Epoch: 9, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.518 Vali Acc: 0.805 Test Loss: 0.518 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1104464530944824
Epoch: 10, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.308 Vali Acc: 0.901 Test Loss: 0.308 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3914732933044434
Epoch: 11, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.664 Vali Acc: 0.758 Test Loss: 0.664 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1538498401641846
Epoch: 12, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.327 Vali Acc: 0.870 Test Loss: 0.327 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2982146739959717
Epoch: 13, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.310 Vali Acc: 0.884 Test Loss: 0.310 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1874098777770996
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.387 Vali Acc: 0.863 Test Loss: 0.387 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2468926906585693
Epoch: 15, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.431 Vali Acc: 0.857 Test Loss: 0.431 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2493417263031006
Epoch: 16, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.403 Vali Acc: 0.863 Test Loss: 0.403 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps112_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 44949506
model size : 186.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5672249794006348
Epoch: 1, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.343 Vali Acc: 0.901 Test Loss: 0.343 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 2.4556424617767334
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.368 Vali Acc: 0.881 Test Loss: 0.368 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.273069143295288
Epoch: 3, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7801780700683594
Epoch: 4, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.477 Vali Acc: 0.652 Test Loss: 0.477 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4901208877563477
Epoch: 5, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.318 Vali Acc: 0.881 Test Loss: 0.318 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5956947803497314
Epoch: 6, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.495 Vali Acc: 0.812 Test Loss: 0.495 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7409591674804688
Epoch: 7, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.323 Vali Acc: 0.901 Test Loss: 0.323 Test Acc: 0.901
Validation loss decreased (-0.901020 --> -0.901021).  Saving model ...
Epoch: 8 cost time: 1.6827104091644287
Epoch: 8, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.350 Vali Acc: 0.857 Test Loss: 0.350 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.648021936416626
Epoch: 9, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.620 Vali Acc: 0.676 Test Loss: 0.620 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4560599327087402
Epoch: 10, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.374 Vali Acc: 0.853 Test Loss: 0.374 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1665124893188477
Epoch: 11, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.505 Vali Acc: 0.788 Test Loss: 0.505 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.110504388809204
Epoch: 12, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.499 Vali Acc: 0.823 Test Loss: 0.499 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6816978454589844
Epoch: 13, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.471 Vali Acc: 0.829 Test Loss: 0.471 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.595022201538086
Epoch: 14, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.617 Vali Acc: 0.782 Test Loss: 0.617 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9446580410003662
Epoch: 15, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.491 Vali Acc: 0.877 Test Loss: 0.491 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9469797611236572
Epoch: 16, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.626 Vali Acc: 0.829 Test Loss: 0.626 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2415754795074463
Epoch: 17, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.410 Vali Acc: 0.867 Test Loss: 0.410 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 45222914
model size : 187.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7136902809143066
Epoch: 1, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.389 Vali Acc: 0.881 Test Loss: 0.389 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 1.2905945777893066
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
Validation loss decreased (-0.880542 --> -0.883955).  Saving model ...
Epoch: 3 cost time: 1.2609305381774902
Epoch: 3, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.423 Vali Acc: 0.874 Test Loss: 0.423 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6818318367004395
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.360 Vali Acc: 0.881 Test Loss: 0.360 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1256191730499268
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.330 Vali Acc: 0.887 Test Loss: 0.330 Test Acc: 0.887
Validation loss decreased (-0.883955 --> -0.887369).  Saving model ...
Epoch: 6 cost time: 1.9704976081848145
Epoch: 6, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.426 Vali Acc: 0.761 Test Loss: 0.426 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6007184982299805
Epoch: 7, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.308 Vali Acc: 0.901 Test Loss: 0.308 Test Acc: 0.901
Validation loss decreased (-0.887369 --> -0.901021).  Saving model ...
Epoch: 8 cost time: 1.6246647834777832
Epoch: 8, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.330 Vali Acc: 0.898 Test Loss: 0.330 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7673609256744385
Epoch: 9, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.300 Vali Acc: 0.874 Test Loss: 0.300 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8457512855529785
Epoch: 10, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.283 Vali Acc: 0.901 Test Loss: 0.283 Test Acc: 0.901
Validation loss decreased (-0.901021 --> -0.901021).  Saving model ...
Epoch: 11 cost time: 1.7680776119232178
Epoch: 11, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.399 Vali Acc: 0.840 Test Loss: 0.399 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8908631801605225
Epoch: 12, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.339972972869873
Epoch: 13, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.436 Vali Acc: 0.829 Test Loss: 0.436 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1407015323638916
Epoch: 14, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.600 Vali Acc: 0.795 Test Loss: 0.600 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3881986141204834
Epoch: 15, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.424 Vali Acc: 0.860 Test Loss: 0.424 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.540471076965332
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.376 Vali Acc: 0.860 Test Loss: 0.376 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2964229583740234
Epoch: 17, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.665557861328125
Epoch: 18, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.698 Vali Acc: 0.819 Test Loss: 0.698 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5198030471801758
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.539 Vali Acc: 0.846 Test Loss: 0.539 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2826590538024902
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.573 Vali Acc: 0.857 Test Loss: 0.573 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 45186050
model size : 187.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7542810440063477
Epoch: 1, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.435 Vali Acc: 0.884 Test Loss: 0.435 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 1.068392276763916
Epoch: 2, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.358 Vali Acc: 0.904 Test Loss: 0.358 Test Acc: 0.904
Validation loss decreased (-0.883955 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.1136517524719238
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.358 Vali Acc: 0.891 Test Loss: 0.358 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3223259449005127
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.313 Vali Acc: 0.901 Test Loss: 0.313 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1644880771636963
Epoch: 5, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.274 Vali Acc: 0.887 Test Loss: 0.274 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.093358039855957
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
Validation loss decreased (-0.904433 --> -0.911260).  Saving model ...
Epoch: 7 cost time: 1.2537589073181152
Epoch: 7, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9679830074310303
Epoch: 8, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.229 Vali Acc: 0.908 Test Loss: 0.229 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4222395420074463
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.282 Vali Acc: 0.870 Test Loss: 0.282 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0127854347229004
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.409 Vali Acc: 0.829 Test Loss: 0.409 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4539906978607178
Epoch: 11, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2639036178588867
Epoch: 12, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.497 Vali Acc: 0.771 Test Loss: 0.497 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2673218250274658
Epoch: 13, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.414 Vali Acc: 0.836 Test Loss: 0.414 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1291537284851074
Epoch: 14, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.361 Vali Acc: 0.894 Test Loss: 0.361 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2737140655517578
Epoch: 15, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.308 Vali Acc: 0.898 Test Loss: 0.308 Test Acc: 0.898
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2567226886749268
Epoch: 16, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.322 Vali Acc: 0.904 Test Loss: 0.322 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 45167618
model size : 186.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.125180006027222
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.327 Vali Acc: 0.898 Test Loss: 0.327 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.4913501739501953
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.355 Vali Acc: 0.901 Test Loss: 0.355 Test Acc: 0.901
Validation loss decreased (-0.897608 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.9153962135314941
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.401 Vali Acc: 0.894 Test Loss: 0.401 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.049844741821289
Epoch: 4, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0166442394256592
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.307 Vali Acc: 0.894 Test Loss: 0.307 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.066521406173706
Epoch: 6, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
Validation loss decreased (-0.901020 --> -0.914673).  Saving model ...
Epoch: 7 cost time: 0.9134571552276611
Epoch: 7, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.844390869140625
Epoch: 8, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9897589683532715
Epoch: 9, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.522 Vali Acc: 0.778 Test Loss: 0.522 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.169543981552124
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.449 Vali Acc: 0.850 Test Loss: 0.449 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1452925205230713
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.443 Vali Acc: 0.836 Test Loss: 0.443 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3289518356323242
Epoch: 12, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.394 Vali Acc: 0.874 Test Loss: 0.394 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2160427570343018
Epoch: 13, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.512 Vali Acc: 0.829 Test Loss: 0.512 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1604890823364258
Epoch: 14, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.33158540725708
Epoch: 15, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.473 Vali Acc: 0.863 Test Loss: 0.473 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0275702476501465
Epoch: 16, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 45511682
model size : 188.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1949052810668945
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 0.9870257377624512
Epoch: 2, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.404 Vali Acc: 0.863 Test Loss: 0.404 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0465898513793945
Epoch: 3, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.415 Vali Acc: 0.853 Test Loss: 0.415 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9590916633605957
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.354 Vali Acc: 0.874 Test Loss: 0.354 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9470219612121582
Epoch: 5, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.353 Vali Acc: 0.863 Test Loss: 0.353 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1019153594970703
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.416 Vali Acc: 0.853 Test Loss: 0.416 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0873439311981201
Epoch: 7, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.314 Vali Acc: 0.898 Test Loss: 0.314 Test Acc: 0.898
Validation loss decreased (-0.890781 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 1.8194727897644043
Epoch: 8, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.342 Vali Acc: 0.874 Test Loss: 0.342 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4563815593719482
Epoch: 9, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9564847946166992
Epoch: 10, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.660 Vali Acc: 0.710 Test Loss: 0.660 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.503878116607666
Epoch: 11, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.453 Vali Acc: 0.829 Test Loss: 0.453 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9948468208312988
Epoch: 12, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.815194845199585
Epoch: 13, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.293 Vali Acc: 0.918 Test Loss: 0.293 Test Acc: 0.918
Validation loss decreased (-0.897608 --> -0.918086).  Saving model ...
Epoch: 14 cost time: 1.0193359851837158
Epoch: 14, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.462 Vali Acc: 0.836 Test Loss: 0.462 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7391414642333984
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.408 Vali Acc: 0.867 Test Loss: 0.408 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4814472198486328
Epoch: 16, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.499 Vali Acc: 0.857 Test Loss: 0.499 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7385437488555908
Epoch: 17, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.410 Vali Acc: 0.891 Test Loss: 0.410 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.384920358657837
Epoch: 18, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.417 Vali Acc: 0.898 Test Loss: 0.417 Test Acc: 0.898
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.637267827987671
Epoch: 19, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.442 Vali Acc: 0.874 Test Loss: 0.442 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8538849353790283
Epoch: 20, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.609 Vali Acc: 0.857 Test Loss: 0.609 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6034698486328125
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.528 Vali Acc: 0.870 Test Loss: 0.528 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5502073764801025
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.603 Vali Acc: 0.870 Test Loss: 0.603 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.109865427017212
Epoch: 23, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.468 Vali Acc: 0.891 Test Loss: 0.468 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 45480962
model size : 188.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.679504871368408
Epoch: 1, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
Validation loss decreased (inf --> -0.883956).  Saving model ...
Epoch: 2 cost time: 1.1992175579071045
Epoch: 2, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.372 Vali Acc: 0.898 Test Loss: 0.372 Test Acc: 0.898
Validation loss decreased (-0.883956 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 1.1643857955932617
Epoch: 3, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.330 Vali Acc: 0.908 Test Loss: 0.330 Test Acc: 0.908
Validation loss decreased (-0.897607 --> -0.907847).  Saving model ...
Epoch: 4 cost time: 1.0126168727874756
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.332 Vali Acc: 0.887 Test Loss: 0.332 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.265902042388916
Epoch: 5, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.337 Vali Acc: 0.898 Test Loss: 0.337 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0232679843902588
Epoch: 6, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.470 Vali Acc: 0.795 Test Loss: 0.470 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1502923965454102
Epoch: 7, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.388 Vali Acc: 0.816 Test Loss: 0.388 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0522863864898682
Epoch: 8, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.316 Vali Acc: 0.867 Test Loss: 0.316 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0921673774719238
Epoch: 9, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.339 Vali Acc: 0.874 Test Loss: 0.339 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2934255599975586
Epoch: 10, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.302 Vali Acc: 0.898 Test Loss: 0.302 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1779184341430664
Epoch: 11, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.304 Vali Acc: 0.901 Test Loss: 0.304 Test Acc: 0.901
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1902766227722168
Epoch: 12, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.325 Vali Acc: 0.894 Test Loss: 0.325 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2156016826629639
Epoch: 13, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.451 Vali Acc: 0.846 Test Loss: 0.451 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 45465602
model size : 188.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps180_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1719372272491455
Epoch: 1, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.372 Vali Acc: 0.887 Test Loss: 0.372 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 1.4133315086364746
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.375 Vali Acc: 0.853 Test Loss: 0.375 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5157790184020996
Epoch: 3, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.395 Vali Acc: 0.881 Test Loss: 0.395 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4131770133972168
Epoch: 4, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.320 Vali Acc: 0.898 Test Loss: 0.320 Test Acc: 0.898
Validation loss decreased (-0.887368 --> -0.897608).  Saving model ...
Epoch: 5 cost time: 1.4599616527557373
Epoch: 5, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.394 Vali Acc: 0.863 Test Loss: 0.394 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1859815120697021
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.545 Vali Acc: 0.696 Test Loss: 0.545 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.258880376815796
Epoch: 7, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.414 Vali Acc: 0.836 Test Loss: 0.414 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3730413913726807
Epoch: 8, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.340 Vali Acc: 0.904 Test Loss: 0.340 Test Acc: 0.904
Validation loss decreased (-0.897608 --> -0.904433).  Saving model ...
Epoch: 9 cost time: 1.3797259330749512
Epoch: 9, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.440 Vali Acc: 0.823 Test Loss: 0.440 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6012866497039795
Epoch: 10, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.340 Vali Acc: 0.904 Test Loss: 0.340 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3550124168395996
Epoch: 11, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.553 Vali Acc: 0.802 Test Loss: 0.553 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.127756357192993
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.488 Vali Acc: 0.833 Test Loss: 0.488 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4017724990844727
Epoch: 13, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.502 Vali Acc: 0.829 Test Loss: 0.502 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9567413330078125
Epoch: 14, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6852805614471436
Epoch: 15, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.741 Vali Acc: 0.669 Test Loss: 0.741 Test Acc: 0.669
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2019989490509033
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.584 Vali Acc: 0.840 Test Loss: 0.584 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1993772983551025
Epoch: 17, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3695547580718994
Epoch: 18, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.754 Vali Acc: 0.795 Test Loss: 0.754 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps180_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 45914114
model size : 189.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5615081787109375
Epoch: 1, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 1.337965965270996
Epoch: 2, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
Validation loss decreased (-0.883955 --> -0.883956).  Saving model ...
Epoch: 3 cost time: 0.8834738731384277
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
Validation loss decreased (-0.883956 --> -0.883956).  Saving model ...
Epoch: 4 cost time: 1.8289766311645508
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.327 Vali Acc: 0.904 Test Loss: 0.327 Test Acc: 0.904
Validation loss decreased (-0.883956 --> -0.904434).  Saving model ...
Epoch: 5 cost time: 1.1667790412902832
Epoch: 5, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.331 Vali Acc: 0.881 Test Loss: 0.331 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9790244102478027
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.245 Vali Acc: 0.911 Test Loss: 0.245 Test Acc: 0.911
Validation loss decreased (-0.904434 --> -0.911260).  Saving model ...
Epoch: 7 cost time: 0.8276629447937012
Epoch: 7, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.251 Vali Acc: 0.904 Test Loss: 0.251 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.867516040802002
Epoch: 8, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.392 Vali Acc: 0.823 Test Loss: 0.392 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.419898509979248
Epoch: 9, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.493 Vali Acc: 0.805 Test Loss: 0.493 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2587742805480957
Epoch: 10, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.287 Vali Acc: 0.908 Test Loss: 0.287 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2588794231414795
Epoch: 11, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0908093452453613
Epoch: 12, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.589648723602295
Epoch: 13, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.524 Vali Acc: 0.833 Test Loss: 0.524 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0328071117401123
Epoch: 14, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4651081562042236
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.334 Vali Acc: 0.877 Test Loss: 0.334 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3205320835113525
Epoch: 16, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 45889538
model size : 189.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps180_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.718837261199951
Epoch: 1, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.396 Vali Acc: 0.894 Test Loss: 0.396 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 1.531270980834961
Epoch: 2, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.323 Vali Acc: 0.898 Test Loss: 0.323 Test Acc: 0.898
Validation loss decreased (-0.894194 --> -0.897608).  Saving model ...
Epoch: 3 cost time: 1.8313374519348145
Epoch: 3, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.407 Vali Acc: 0.860 Test Loss: 0.407 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0888335704803467
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.338 Vali Acc: 0.860 Test Loss: 0.338 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6335854530334473
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.297 Vali Acc: 0.884 Test Loss: 0.297 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7216224670410156
Epoch: 6, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.335 Vali Acc: 0.870 Test Loss: 0.335 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3535025119781494
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.325 Vali Acc: 0.874 Test Loss: 0.325 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3358166217803955
Epoch: 8, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0075619220733643
Epoch: 9, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.330 Vali Acc: 0.884 Test Loss: 0.330 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8913559913635254
Epoch: 10, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.346 Vali Acc: 0.881 Test Loss: 0.346 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5634009838104248
Epoch: 11, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.461 Vali Acc: 0.836 Test Loss: 0.461 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2289304733276367
Epoch: 12, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.460 Vali Acc: 0.836 Test Loss: 0.460 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el6_dm768_df768_ps180_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 45877250
model size : 189.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps36_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.461470603942871
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 2.1590797901153564
Epoch: 2, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.705 Vali Acc: 0.573 Test Loss: 0.705 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6333529949188232
Epoch: 3, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.788 Vali Acc: 0.580 Test Loss: 0.788 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.996943950653076
Epoch: 4, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
Validation loss decreased (-0.808869 --> -0.883956).  Saving model ...
Epoch: 5 cost time: 3.4703729152679443
Epoch: 5, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.538 Vali Acc: 0.782 Test Loss: 0.538 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0194220542907715
Epoch: 6, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.589 Vali Acc: 0.648 Test Loss: 0.589 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.100313425064087
Epoch: 7, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.508 Vali Acc: 0.833 Test Loss: 0.508 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.004281520843506
Epoch: 8, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.793 Vali Acc: 0.696 Test Loss: 0.793 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1023263931274414
Epoch: 9, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.408 Vali Acc: 0.840 Test Loss: 0.408 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.473116159439087
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2734463214874268
Epoch: 11, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.376 Vali Acc: 0.860 Test Loss: 0.376 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1966047286987305
Epoch: 12, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.506 Vali Acc: 0.836 Test Loss: 0.506 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2450690269470215
Epoch: 13, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.424 Vali Acc: 0.874 Test Loss: 0.424 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.193164110183716
Epoch: 14, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.583 Vali Acc: 0.799 Test Loss: 0.583 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps36_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 37081346
model size : 156.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.859480142593384
Epoch: 1, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.339 Vali Acc: 0.881 Test Loss: 0.339 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 1.243753433227539
Epoch: 2, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.431 Vali Acc: 0.836 Test Loss: 0.431 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5173168182373047
Epoch: 3, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.411 Vali Acc: 0.884 Test Loss: 0.411 Test Acc: 0.884
Validation loss decreased (-0.880543 --> -0.883955).  Saving model ...
Epoch: 4 cost time: 1.8813707828521729
Epoch: 4, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.602 Vali Acc: 0.584 Test Loss: 0.602 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4443538188934326
Epoch: 5, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.420 Vali Acc: 0.853 Test Loss: 0.420 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6574013233184814
Epoch: 6, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.339 Vali Acc: 0.881 Test Loss: 0.339 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.602818250656128
Epoch: 7, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.300 Vali Acc: 0.884 Test Loss: 0.300 Test Acc: 0.884
Validation loss decreased (-0.883955 --> -0.883956).  Saving model ...
Epoch: 8 cost time: 1.2572753429412842
Epoch: 8, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.293 Vali Acc: 0.908 Test Loss: 0.293 Test Acc: 0.908
Validation loss decreased (-0.883956 --> -0.907847).  Saving model ...
Epoch: 9 cost time: 1.5317695140838623
Epoch: 9, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.776 Vali Acc: 0.679 Test Loss: 0.776 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.640385627746582
Epoch: 10, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.957 Vali Acc: 0.628 Test Loss: 0.957 Test Acc: 0.628
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.282853126525879
Epoch: 11, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.464 Vali Acc: 0.788 Test Loss: 0.464 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0549700260162354
Epoch: 12, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.315 Vali Acc: 0.898 Test Loss: 0.315 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4437167644500732
Epoch: 13, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911260).  Saving model ...
Epoch: 14 cost time: 2.5357775688171387
Epoch: 14, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.423 Vali Acc: 0.843 Test Loss: 0.423 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.859351634979248
Epoch: 15, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.442 Vali Acc: 0.874 Test Loss: 0.442 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8106491565704346
Epoch: 16, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.429 Vali Acc: 0.860 Test Loss: 0.429 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6310572624206543
Epoch: 17, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.471 Vali Acc: 0.863 Test Loss: 0.471 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.553514003753662
Epoch: 18, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6715452671051025
Epoch: 19, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.665 Vali Acc: 0.771 Test Loss: 0.665 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6881487369537354
Epoch: 20, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.463 Vali Acc: 0.891 Test Loss: 0.463 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.103734254837036
Epoch: 21, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.576 Vali Acc: 0.857 Test Loss: 0.576 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7812538146972656
Epoch: 22, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.530 Vali Acc: 0.904 Test Loss: 0.530 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9562318325042725
Epoch: 23, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.496 Vali Acc: 0.887 Test Loss: 0.496 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 36933890
model size : 155.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps36_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8663382530212402
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.429 Vali Acc: 0.860 Test Loss: 0.429 Test Acc: 0.860
Validation loss decreased (inf --> -0.860064).  Saving model ...
Epoch: 2 cost time: 2.2039806842803955
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.413 Vali Acc: 0.826 Test Loss: 0.413 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5038440227508545
Epoch: 3, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.313 Vali Acc: 0.887 Test Loss: 0.313 Test Acc: 0.887
Validation loss decreased (-0.860064 --> -0.887369).  Saving model ...
Epoch: 4 cost time: 1.2693791389465332
Epoch: 4, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.281 Vali Acc: 0.884 Test Loss: 0.281 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7957944869995117
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.461 Vali Acc: 0.696 Test Loss: 0.461 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2886087894439697
Epoch: 6, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.396 Vali Acc: 0.782 Test Loss: 0.396 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2188763618469238
Epoch: 7, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.576 Vali Acc: 0.676 Test Loss: 0.576 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.125182867050171
Epoch: 8, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.345 Vali Acc: 0.870 Test Loss: 0.345 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0630247592926025
Epoch: 9, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.502 Vali Acc: 0.782 Test Loss: 0.502 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4262621402740479
Epoch: 10, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.340 Vali Acc: 0.884 Test Loss: 0.340 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5517699718475342
Epoch: 11, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.397 Vali Acc: 0.860 Test Loss: 0.397 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.472365140914917
Epoch: 12, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3515160083770752
Epoch: 13, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps36_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 36860162
model size : 155.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps38_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.669353485107422
Epoch: 1, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 2.1317784786224365
Epoch: 2, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.531 Vali Acc: 0.666 Test Loss: 0.531 Test Acc: 0.666
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2064223289489746
Epoch: 3, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.718 Vali Acc: 0.590 Test Loss: 0.718 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.895826816558838
Epoch: 4, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.459 Vali Acc: 0.829 Test Loss: 0.459 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3609957695007324
Epoch: 5, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.368 Vali Acc: 0.846 Test Loss: 0.368 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.280432939529419
Epoch: 6, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
Validation loss decreased (-0.883955 --> -0.904434).  Saving model ...
Epoch: 7 cost time: 2.2236409187316895
Epoch: 7, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.237 Vali Acc: 0.915 Test Loss: 0.237 Test Acc: 0.915
Validation loss decreased (-0.904434 --> -0.914673).  Saving model ...
Epoch: 8 cost time: 2.6198928356170654
Epoch: 8, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.470456600189209
Epoch: 9, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.639 Vali Acc: 0.693 Test Loss: 0.639 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.99057936668396
Epoch: 10, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.291165590286255
Epoch: 11, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.489 Vali Acc: 0.741 Test Loss: 0.489 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7387487888336182
Epoch: 12, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2311112880706787
Epoch: 13, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.690 Vali Acc: 0.768 Test Loss: 0.690 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0476582050323486
Epoch: 14, Steps: 17 | Train Loss: 0.333 Vali Loss: 2.365 Vali Acc: 0.495 Test Loss: 2.365 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.286517858505249
Epoch: 15, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.019 Vali Acc: 0.792 Test Loss: 1.019 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9719173908233643
Epoch: 16, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.720 Vali Acc: 0.833 Test Loss: 0.720 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9441585540771484
Epoch: 17, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.862 Vali Acc: 0.802 Test Loss: 0.862 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps38_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 37078274
model size : 156.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.020691871643066
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.322 Vali Acc: 0.901 Test Loss: 0.322 Test Acc: 0.901
Validation loss decreased (inf --> -0.901021).  Saving model ...
Epoch: 2 cost time: 2.1659321784973145
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.464 Vali Acc: 0.785 Test Loss: 0.464 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0279316902160645
Epoch: 3, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.397 Vali Acc: 0.819 Test Loss: 0.397 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7894086837768555
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.812185287475586
Epoch: 5, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1783835887908936
Epoch: 6, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7495851516723633
Epoch: 7, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.351 Vali Acc: 0.863 Test Loss: 0.351 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3603506088256836
Epoch: 8, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.333 Vali Acc: 0.898 Test Loss: 0.333 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8053650856018066
Epoch: 9, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.435 Vali Acc: 0.765 Test Loss: 0.435 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6693553924560547
Epoch: 10, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.363 Vali Acc: 0.857 Test Loss: 0.363 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0070719718933105
Epoch: 11, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.652 Vali Acc: 0.734 Test Loss: 0.652 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 36955394
model size : 155.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps38_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.6926355361938477
Epoch: 1, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.362 Vali Acc: 0.860 Test Loss: 0.362 Test Acc: 0.860
Validation loss decreased (inf --> -0.860065).  Saving model ...
Epoch: 2 cost time: 1.0171377658843994
Epoch: 2, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.342 Vali Acc: 0.908 Test Loss: 0.342 Test Acc: 0.908
Validation loss decreased (-0.860065 --> -0.907846).  Saving model ...
Epoch: 3 cost time: 1.074378252029419
Epoch: 3, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2380623817443848
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.305 Vali Acc: 0.887 Test Loss: 0.305 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.004396915435791
Epoch: 5, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.350 Vali Acc: 0.887 Test Loss: 0.350 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.497358798980713
Epoch: 6, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.273 Vali Acc: 0.891 Test Loss: 0.273 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7391293048858643
Epoch: 7, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.339 Vali Acc: 0.874 Test Loss: 0.339 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4528772830963135
Epoch: 8, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.249 Vali Acc: 0.898 Test Loss: 0.249 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5112450122833252
Epoch: 9, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.285 Vali Acc: 0.904 Test Loss: 0.285 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3999598026275635
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.578019618988037
Epoch: 11, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.430 Vali Acc: 0.819 Test Loss: 0.430 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3261172771453857
Epoch: 12, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.381 Vali Acc: 0.846 Test Loss: 0.381 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps38_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 36884738
model size : 155.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9496588706970215
Epoch: 1, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.385 Vali Acc: 0.853 Test Loss: 0.385 Test Acc: 0.853
Validation loss decreased (inf --> -0.853238).  Saving model ...
Epoch: 2 cost time: 2.285565137863159
Epoch: 2, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.410 Vali Acc: 0.840 Test Loss: 0.410 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5384061336517334
Epoch: 3, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.390 Vali Acc: 0.863 Test Loss: 0.390 Test Acc: 0.863
Validation loss decreased (-0.853238 --> -0.863477).  Saving model ...
Epoch: 4 cost time: 2.981760263442993
Epoch: 4, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.389 Vali Acc: 0.853 Test Loss: 0.389 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5192127227783203
Epoch: 5, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.360 Vali Acc: 0.874 Test Loss: 0.360 Test Acc: 0.874
Validation loss decreased (-0.863477 --> -0.873717).  Saving model ...
Epoch: 6 cost time: 2.130066394805908
Epoch: 6, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.299 Vali Acc: 0.894 Test Loss: 0.299 Test Acc: 0.894
Validation loss decreased (-0.873717 --> -0.894195).  Saving model ...
Epoch: 7 cost time: 2.702500104904175
Epoch: 7, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.372 Vali Acc: 0.836 Test Loss: 0.372 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2736356258392334
Epoch: 8, Steps: 17 | Train Loss: 0.705 Vali Loss: 1.275 Vali Acc: 0.563 Test Loss: 1.275 Test Acc: 0.563
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2231802940368652
Epoch: 9, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.404 Vali Acc: 0.850 Test Loss: 0.404 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2210161685943604
Epoch: 10, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.486 Vali Acc: 0.805 Test Loss: 0.486 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.425006151199341
Epoch: 11, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.753 Vali Acc: 0.669 Test Loss: 0.753 Test Acc: 0.669
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5696592330932617
Epoch: 12, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.366 Vali Acc: 0.898 Test Loss: 0.366 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897607).  Saving model ...
Epoch: 13 cost time: 2.898327589035034
Epoch: 13, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.514 Vali Acc: 0.778 Test Loss: 0.514 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5771031379699707
Epoch: 14, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.538 Vali Acc: 0.802 Test Loss: 0.538 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5448265075683594
Epoch: 15, Steps: 17 | Train Loss: 0.425 Vali Loss: 1.390 Vali Acc: 0.580 Test Loss: 1.390 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3722827434539795
Epoch: 16, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.860 Vali Acc: 0.638 Test Loss: 0.860 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.1444551944732666
Epoch: 17, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.296 Vali Acc: 0.765 Test Loss: 1.296 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2819039821624756
Epoch: 18, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.670 Vali Acc: 0.840 Test Loss: 0.670 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6541357040405273
Epoch: 19, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.826 Vali Acc: 0.826 Test Loss: 0.826 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.610294818878174
Epoch: 20, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4713006019592285
Epoch: 21, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.077 Vali Acc: 0.768 Test Loss: 1.077 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.445592164993286
Epoch: 22, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.642 Vali Acc: 0.836 Test Loss: 0.642 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37092098
model size : 156.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.4621429443359375
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.352 Vali Acc: 0.881 Test Loss: 0.352 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 2.6442110538482666
Epoch: 2, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.426 Vali Acc: 0.812 Test Loss: 0.426 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8697011470794678
Epoch: 3, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.351 Vali Acc: 0.870 Test Loss: 0.351 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7288951873779297
Epoch: 4, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.356 Vali Acc: 0.860 Test Loss: 0.356 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0357625484466553
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
Validation loss decreased (-0.880543 --> -0.894195).  Saving model ...
Epoch: 6 cost time: 1.79776930809021
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.305 Vali Acc: 0.904 Test Loss: 0.305 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904434).  Saving model ...
Epoch: 7 cost time: 1.898224115371704
Epoch: 7, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.310 Vali Acc: 0.898 Test Loss: 0.310 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.454702854156494
Epoch: 8, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.349 Vali Acc: 0.870 Test Loss: 0.349 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3193318843841553
Epoch: 9, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.421 Vali Acc: 0.754 Test Loss: 0.421 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2047770023345947
Epoch: 10, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.375 Vali Acc: 0.850 Test Loss: 0.375 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4497928619384766
Epoch: 11, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.729832410812378
Epoch: 12, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.360 Vali Acc: 0.867 Test Loss: 0.360 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8076376914978027
Epoch: 13, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.122091770172119
Epoch: 14, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.642 Vali Acc: 0.765 Test Loss: 0.642 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.507747173309326
Epoch: 15, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.770 Vali Acc: 0.758 Test Loss: 0.770 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.20863938331604
Epoch: 16, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.311 Vali Acc: 0.894 Test Loss: 0.311 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 36960002
model size : 155.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9973866939544678
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.420 Vali Acc: 0.857 Test Loss: 0.420 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 1.147862434387207
Epoch: 2, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.373 Vali Acc: 0.863 Test Loss: 0.373 Test Acc: 0.863
Validation loss decreased (-0.856651 --> -0.863478).  Saving model ...
Epoch: 3 cost time: 1.1697678565979004
Epoch: 3, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.439 Vali Acc: 0.816 Test Loss: 0.439 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.314453363418579
Epoch: 4, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
Validation loss decreased (-0.863478 --> -0.894195).  Saving model ...
Epoch: 5 cost time: 1.3428065776824951
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.341 Vali Acc: 0.881 Test Loss: 0.341 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6056859493255615
Epoch: 6, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.402 Vali Acc: 0.816 Test Loss: 0.402 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.527123212814331
Epoch: 7, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.327 Vali Acc: 0.881 Test Loss: 0.327 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5077555179595947
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.502351999282837
Epoch: 9, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4967074394226074
Epoch: 10, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.450 Vali Acc: 0.775 Test Loss: 0.450 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8200597763061523
Epoch: 11, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.329 Vali Acc: 0.898 Test Loss: 0.329 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 12 cost time: 1.8621330261230469
Epoch: 12, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.406 Vali Acc: 0.840 Test Loss: 0.406 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0356857776641846
Epoch: 13, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.283 Vali Acc: 0.915 Test Loss: 0.283 Test Acc: 0.915
Validation loss decreased (-0.897608 --> -0.914673).  Saving model ...
Epoch: 14 cost time: 1.3362841606140137
Epoch: 14, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.330 Vali Acc: 0.904 Test Loss: 0.330 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.566701889038086
Epoch: 15, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6124296188354492
Epoch: 16, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.426 Vali Acc: 0.860 Test Loss: 0.426 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5007660388946533
Epoch: 17, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.662 Vali Acc: 0.799 Test Loss: 0.662 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.012343168258667
Epoch: 18, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3691926002502441
Epoch: 19, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3221383094787598
Epoch: 20, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.521 Vali Acc: 0.874 Test Loss: 0.521 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.390960693359375
Epoch: 21, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.472 Vali Acc: 0.894 Test Loss: 0.472 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4778056144714355
Epoch: 22, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.033 Vali Acc: 0.754 Test Loss: 1.033 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.373051643371582
Epoch: 23, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.658 Vali Acc: 0.833 Test Loss: 0.658 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 36895490
model size : 155.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.414442300796509
Epoch: 1, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.347 Vali Acc: 0.898 Test Loss: 0.347 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 2.663524866104126
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.595 Vali Acc: 0.730 Test Loss: 0.595 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1964681148529053
Epoch: 3, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.640 Vali Acc: 0.659 Test Loss: 0.640 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5422980785369873
Epoch: 4, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.320 Vali Acc: 0.881 Test Loss: 0.320 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4943203926086426
Epoch: 5, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
Validation loss decreased (-0.897607 --> -0.914673).  Saving model ...
Epoch: 6 cost time: 2.158963680267334
Epoch: 6, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.496 Vali Acc: 0.706 Test Loss: 0.496 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.501507520675659
Epoch: 7, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.445586919784546
Epoch: 8, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.769 Vali Acc: 0.631 Test Loss: 0.769 Test Acc: 0.631
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0366761684417725
Epoch: 9, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.7522308826446533
Epoch: 10, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.280 Vali Acc: 0.918 Test Loss: 0.280 Test Acc: 0.918
Validation loss decreased (-0.914673 --> -0.918086).  Saving model ...
Epoch: 11 cost time: 2.019397735595703
Epoch: 11, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4664804935455322
Epoch: 12, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.388 Vali Acc: 0.863 Test Loss: 0.388 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.813194513320923
Epoch: 13, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.402 Vali Acc: 0.874 Test Loss: 0.402 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5321621894836426
Epoch: 14, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.631577968597412
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.604 Vali Acc: 0.819 Test Loss: 0.604 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.9466958045959473
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.811 Vali Acc: 0.819 Test Loss: 0.811 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.368096113204956
Epoch: 17, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.757 Vali Acc: 0.761 Test Loss: 0.757 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6849775314331055
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.842 Vali Acc: 0.836 Test Loss: 0.842 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.271300792694092
Epoch: 19, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5937702655792236
Epoch: 20, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 37095170
model size : 156.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.390887498855591
Epoch: 1, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.380 Vali Acc: 0.894 Test Loss: 0.380 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 2.252084493637085
Epoch: 2, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.545 Vali Acc: 0.662 Test Loss: 0.545 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8400752544403076
Epoch: 3, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.424 Vali Acc: 0.840 Test Loss: 0.424 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6273562908172607
Epoch: 4, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.356 Vali Acc: 0.846 Test Loss: 0.356 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6669812202453613
Epoch: 5, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
Validation loss decreased (-0.894194 --> -0.894195).  Saving model ...
Epoch: 6 cost time: 2.2392771244049072
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.345 Vali Acc: 0.860 Test Loss: 0.345 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5976569652557373
Epoch: 7, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.282 Vali Acc: 0.915 Test Loss: 0.282 Test Acc: 0.915
Validation loss decreased (-0.894195 --> -0.914673).  Saving model ...
Epoch: 8 cost time: 2.313652276992798
Epoch: 8, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.341 Vali Acc: 0.901 Test Loss: 0.341 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7665741443634033
Epoch: 9, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.339 Vali Acc: 0.874 Test Loss: 0.339 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8121123313903809
Epoch: 10, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.428 Vali Acc: 0.843 Test Loss: 0.428 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.977769374847412
Epoch: 11, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.381 Vali Acc: 0.918 Test Loss: 0.381 Test Acc: 0.918
Validation loss decreased (-0.914673 --> -0.918085).  Saving model ...
Epoch: 12 cost time: 1.7741448879241943
Epoch: 12, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.360 Vali Acc: 0.904 Test Loss: 0.360 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4686002731323242
Epoch: 13, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.555 Vali Acc: 0.799 Test Loss: 0.555 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5304763317108154
Epoch: 14, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.570 Vali Acc: 0.802 Test Loss: 0.570 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7879703044891357
Epoch: 15, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.701 Vali Acc: 0.802 Test Loss: 0.701 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3818426132202148
Epoch: 16, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0602498054504395
Epoch: 17, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.674 Vali Acc: 0.805 Test Loss: 0.674 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.036604881286621
Epoch: 18, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0853984355926514
Epoch: 19, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.669 Vali Acc: 0.884 Test Loss: 0.669 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6280970573425293
Epoch: 20, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0066275596618652
Epoch: 21, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 36981506
model size : 155.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8354127407073975
Epoch: 1, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.451 Vali Acc: 0.863 Test Loss: 0.451 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 1.3817386627197266
Epoch: 2, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
Validation loss decreased (-0.863477 --> -0.877129).  Saving model ...
Epoch: 3 cost time: 2.189664840698242
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.333 Vali Acc: 0.863 Test Loss: 0.333 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7270424365997314
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.368 Vali Acc: 0.853 Test Loss: 0.368 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4168288707733154
Epoch: 5, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.326 Vali Acc: 0.881 Test Loss: 0.326 Test Acc: 0.881
Validation loss decreased (-0.877129 --> -0.880543).  Saving model ...
Epoch: 6 cost time: 2.1061110496520996
Epoch: 6, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.417 Vali Acc: 0.788 Test Loss: 0.417 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1643686294555664
Epoch: 7, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.318 Vali Acc: 0.877 Test Loss: 0.318 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6120240688323975
Epoch: 8, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.369 Vali Acc: 0.857 Test Loss: 0.369 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.705183506011963
Epoch: 9, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.429 Vali Acc: 0.857 Test Loss: 0.429 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.632138967514038
Epoch: 10, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
Validation loss decreased (-0.880543 --> -0.890782).  Saving model ...
Epoch: 11 cost time: 2.138017177581787
Epoch: 11, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.451 Vali Acc: 0.816 Test Loss: 0.451 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5455236434936523
Epoch: 12, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.381 Vali Acc: 0.829 Test Loss: 0.381 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6350820064544678
Epoch: 13, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.386 Vali Acc: 0.863 Test Loss: 0.386 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2439022064208984
Epoch: 14, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5743687152862549
Epoch: 15, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.383 Vali Acc: 0.904 Test Loss: 0.383 Test Acc: 0.904
Validation loss decreased (-0.890782 --> -0.904433).  Saving model ...
Epoch: 16 cost time: 1.7924480438232422
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.438 Vali Acc: 0.867 Test Loss: 0.438 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.256098985671997
Epoch: 17, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0615637302398682
Epoch: 18, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.403 Vali Acc: 0.887 Test Loss: 0.403 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6529388427734375
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.485 Vali Acc: 0.867 Test Loss: 0.485 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4000890254974365
Epoch: 20, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.479 Vali Acc: 0.884 Test Loss: 0.479 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.705765724182129
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9107282161712646
Epoch: 22, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.498 Vali Acc: 0.881 Test Loss: 0.498 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8795130252838135
Epoch: 23, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.795 Vali Acc: 0.795 Test Loss: 0.795 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8085517883300781
Epoch: 24, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.542 Vali Acc: 0.881 Test Loss: 0.542 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1633694171905518
Epoch: 25, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.107 Vali Acc: 0.720 Test Loss: 1.107 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 36920066
model size : 155.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps43_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.283822059631348
Epoch: 1, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.317 Vali Acc: 0.884 Test Loss: 0.317 Test Acc: 0.884
Validation loss decreased (inf --> -0.883956).  Saving model ...
Epoch: 2 cost time: 3.365082263946533
Epoch: 2, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.559 Vali Acc: 0.652 Test Loss: 0.559 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1333987712860107
Epoch: 3, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.375 Vali Acc: 0.843 Test Loss: 0.375 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7625041007995605
Epoch: 4, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.398 Vali Acc: 0.887 Test Loss: 0.398 Test Acc: 0.887
Validation loss decreased (-0.883956 --> -0.887368).  Saving model ...
Epoch: 5 cost time: 3.4230165481567383
Epoch: 5, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.828 Vali Acc: 0.570 Test Loss: 0.828 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9915378093719482
Epoch: 6, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.425 Vali Acc: 0.812 Test Loss: 0.425 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.477351665496826
Epoch: 7, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.480 Vali Acc: 0.683 Test Loss: 0.480 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4197466373443604
Epoch: 8, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
Validation loss decreased (-0.887368 --> -0.914673).  Saving model ...
Epoch: 9 cost time: 2.795945167541504
Epoch: 9, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.129488468170166
Epoch: 10, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.326 Vali Acc: 0.901 Test Loss: 0.326 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5501832962036133
Epoch: 11, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.398 Vali Acc: 0.843 Test Loss: 0.398 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4568309783935547
Epoch: 12, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.339 Vali Acc: 0.904 Test Loss: 0.339 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6274847984313965
Epoch: 13, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.493 Vali Acc: 0.768 Test Loss: 0.493 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4665870666503906
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.692 Vali Acc: 0.836 Test Loss: 0.692 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.63284969329834
Epoch: 15, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.865 Vali Acc: 0.703 Test Loss: 0.865 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.634658098220825
Epoch: 16, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.722 Vali Acc: 0.727 Test Loss: 0.722 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4014928340911865
Epoch: 17, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.839 Vali Acc: 0.666 Test Loss: 0.839 Test Acc: 0.666
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5994348526000977
Epoch: 18, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.564 Vali Acc: 0.853 Test Loss: 0.564 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps43_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 37122818
model size : 156.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps43_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2314324378967285
Epoch: 1, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
Validation loss decreased (inf --> -0.866890).  Saving model ...
Epoch: 2 cost time: 1.6100387573242188
Epoch: 2, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.425 Vali Acc: 0.881 Test Loss: 0.425 Test Acc: 0.881
Validation loss decreased (-0.866890 --> -0.880542).  Saving model ...
Epoch: 3 cost time: 1.7213497161865234
Epoch: 3, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.880542 --> -0.883955).  Saving model ...
Epoch: 4 cost time: 2.0271408557891846
Epoch: 4, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
Validation loss decreased (-0.883955 --> -0.890781).  Saving model ...
Epoch: 5 cost time: 1.427168846130371
Epoch: 5, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.349 Vali Acc: 0.884 Test Loss: 0.349 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2281835079193115
Epoch: 6, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.350 Vali Acc: 0.857 Test Loss: 0.350 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.410430908203125
Epoch: 7, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.305 Vali Acc: 0.898 Test Loss: 0.305 Test Acc: 0.898
Validation loss decreased (-0.890781 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 2.1128785610198975
Epoch: 8, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.436 Vali Acc: 0.785 Test Loss: 0.436 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.153423309326172
Epoch: 9, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.295 Vali Acc: 0.898 Test Loss: 0.295 Test Acc: 0.898
Validation loss decreased (-0.897608 --> -0.897608).  Saving model ...
Epoch: 10 cost time: 2.2543725967407227
Epoch: 10, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.328 Vali Acc: 0.908 Test Loss: 0.328 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907847).  Saving model ...
Epoch: 11 cost time: 1.9313719272613525
Epoch: 11, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.645 Vali Acc: 0.696 Test Loss: 0.645 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8195090293884277
Epoch: 12, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.943 Vali Acc: 0.635 Test Loss: 0.943 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4675204753875732
Epoch: 13, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.144 Vali Acc: 0.642 Test Loss: 1.144 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4454548358917236
Epoch: 14, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.729 Vali Acc: 0.812 Test Loss: 0.729 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.648561954498291
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.852 Vali Acc: 0.826 Test Loss: 0.852 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.4529004096984863
Epoch: 16, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.657 Vali Acc: 0.857 Test Loss: 0.657 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4573349952697754
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.439 Vali Acc: 0.884 Test Loss: 0.439 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.061870574951172
Epoch: 18, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.686 Vali Acc: 0.843 Test Loss: 0.686 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1612963676452637
Epoch: 19, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.911 Vali Acc: 0.833 Test Loss: 0.911 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8816146850585938
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.525 Vali Acc: 0.857 Test Loss: 0.525 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps43_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 37003010
model size : 155.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps43_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.266096830368042
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.403 Vali Acc: 0.898 Test Loss: 0.403 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.831815242767334
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1891603469848633
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0195600986480713
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2708523273468018
Epoch: 5, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.318 Vali Acc: 0.863 Test Loss: 0.318 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.161074161529541
Epoch: 6, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.313 Vali Acc: 0.863 Test Loss: 0.313 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8682165145874023
Epoch: 7, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.363 Vali Acc: 0.840 Test Loss: 0.363 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.212010383605957
Epoch: 8, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.326 Vali Acc: 0.908 Test Loss: 0.326 Test Acc: 0.908
Validation loss decreased (-0.897607 --> -0.907847).  Saving model ...
Epoch: 9 cost time: 2.097445487976074
Epoch: 9, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.352 Vali Acc: 0.833 Test Loss: 0.352 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1323437690734863
Epoch: 10, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.459 Vali Acc: 0.795 Test Loss: 0.459 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9146099090576172
Epoch: 11, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.290 Vali Acc: 0.891 Test Loss: 0.290 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.356860876083374
Epoch: 12, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911260).  Saving model ...
Epoch: 13 cost time: 2.3480207920074463
Epoch: 13, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.512 Vali Acc: 0.744 Test Loss: 0.512 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3317875862121582
Epoch: 14, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.538 Vali Acc: 0.720 Test Loss: 0.538 Test Acc: 0.720
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5353879928588867
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.547 Vali Acc: 0.829 Test Loss: 0.547 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1821959018707275
Epoch: 16, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.471 Vali Acc: 0.857 Test Loss: 0.471 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8884484767913818
Epoch: 17, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.373 Vali Acc: 0.901 Test Loss: 0.373 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5377988815307617
Epoch: 18, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8190510272979736
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.390 Vali Acc: 0.904 Test Loss: 0.390 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.728130578994751
Epoch: 20, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.362 Vali Acc: 0.911 Test Loss: 0.362 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7428796291351318
Epoch: 21, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.544 Vali Acc: 0.874 Test Loss: 0.544 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4661903381347656
Epoch: 22, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.440 Vali Acc: 0.901 Test Loss: 0.440 Test Acc: 0.901
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps43_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 36944642
model size : 155.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9755802154541016
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.391 Vali Acc: 0.860 Test Loss: 0.391 Test Acc: 0.860
Validation loss decreased (inf --> -0.860064).  Saving model ...
Epoch: 2 cost time: 2.525689125061035
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
Validation loss decreased (-0.860064 --> -0.894195).  Saving model ...
Epoch: 3 cost time: 2.696420907974243
Epoch: 3, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.375 Vali Acc: 0.887 Test Loss: 0.375 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2848803997039795
Epoch: 4, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.574 Vali Acc: 0.645 Test Loss: 0.574 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1454737186431885
Epoch: 5, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.362 Vali Acc: 0.874 Test Loss: 0.362 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0471065044403076
Epoch: 6, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7670538425445557
Epoch: 7, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.566 Vali Acc: 0.785 Test Loss: 0.566 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8315236568450928
Epoch: 8, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.309 Vali Acc: 0.898 Test Loss: 0.309 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 9 cost time: 2.0326924324035645
Epoch: 9, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.347 Vali Acc: 0.887 Test Loss: 0.347 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.880289316177368
Epoch: 10, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.776 Vali Acc: 0.648 Test Loss: 0.776 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.51754093170166
Epoch: 11, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.405379056930542
Epoch: 12, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2182796001434326
Epoch: 13, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.483 Vali Acc: 0.840 Test Loss: 0.483 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.160391092300415
Epoch: 14, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6748740673065186
Epoch: 15, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.386 Vali Acc: 0.887 Test Loss: 0.386 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3779780864715576
Epoch: 16, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.604 Vali Acc: 0.788 Test Loss: 0.604 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9972095489501953
Epoch: 17, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.981 Vali Acc: 0.713 Test Loss: 0.981 Test Acc: 0.713
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.905627727508545
Epoch: 18, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.911 Vali Acc: 0.853 Test Loss: 0.911 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37128962
model size : 156.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.557015895843506
Epoch: 1, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.397 Vali Acc: 0.894 Test Loss: 0.397 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 2.4313480854034424
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.478 Vali Acc: 0.683 Test Loss: 0.478 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7944614887237549
Epoch: 3, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.332 Vali Acc: 0.887 Test Loss: 0.332 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8796861171722412
Epoch: 4, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.431 Vali Acc: 0.867 Test Loss: 0.431 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6993701457977295
Epoch: 5, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.328 Vali Acc: 0.874 Test Loss: 0.328 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2279610633850098
Epoch: 6, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.268 Vali Acc: 0.881 Test Loss: 0.268 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3860254287719727
Epoch: 7, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.233208417892456
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
Validation loss decreased (-0.894194 --> -0.894195).  Saving model ...
Epoch: 9 cost time: 1.576096773147583
Epoch: 9, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4350996017456055
Epoch: 10, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.410 Vali Acc: 0.843 Test Loss: 0.410 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6377537250518799
Epoch: 11, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.318 Vali Acc: 0.884 Test Loss: 0.318 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.569779396057129
Epoch: 12, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.301 Vali Acc: 0.870 Test Loss: 0.301 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6317899227142334
Epoch: 13, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.645 Vali Acc: 0.802 Test Loss: 0.645 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4953110218048096
Epoch: 14, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.537 Vali Acc: 0.836 Test Loss: 0.537 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5837202072143555
Epoch: 15, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.484 Vali Acc: 0.870 Test Loss: 0.484 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5300710201263428
Epoch: 16, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.531 Vali Acc: 0.863 Test Loss: 0.531 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7099874019622803
Epoch: 17, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.668 Vali Acc: 0.843 Test Loss: 0.668 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2050395011901855
Epoch: 18, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.457 Vali Acc: 0.891 Test Loss: 0.457 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 37027586
model size : 155.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2638821601867676
Epoch: 1, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.406 Vali Acc: 0.857 Test Loss: 0.406 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 1.7339470386505127
Epoch: 2, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.362 Vali Acc: 0.898 Test Loss: 0.362 Test Acc: 0.898
Validation loss decreased (-0.856651 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 1.3427836894989014
Epoch: 3, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.362 Vali Acc: 0.881 Test Loss: 0.362 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6365578174591064
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0197806358337402
Epoch: 5, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.360 Vali Acc: 0.853 Test Loss: 0.360 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.121598243713379
Epoch: 6, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.309 Vali Acc: 0.887 Test Loss: 0.309 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1614351272583008
Epoch: 7, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.389 Vali Acc: 0.840 Test Loss: 0.389 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5428752899169922
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.269 Vali Acc: 0.915 Test Loss: 0.269 Test Acc: 0.915
Validation loss decreased (-0.897607 --> -0.914673).  Saving model ...
Epoch: 9 cost time: 2.53122615814209
Epoch: 9, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.324 Vali Acc: 0.877 Test Loss: 0.324 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7391316890716553
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.684661865234375
Epoch: 11, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.464 Vali Acc: 0.823 Test Loss: 0.464 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8971531391143799
Epoch: 12, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1914803981781006
Epoch: 13, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.402 Vali Acc: 0.881 Test Loss: 0.402 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2256643772125244
Epoch: 14, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.420 Vali Acc: 0.918 Test Loss: 0.420 Test Acc: 0.918
Validation loss decreased (-0.914673 --> -0.918085).  Saving model ...
Epoch: 15 cost time: 2.0941193103790283
Epoch: 15, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.606 Vali Acc: 0.823 Test Loss: 0.606 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6233510971069336
Epoch: 16, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.476 Vali Acc: 0.874 Test Loss: 0.476 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.860429286956787
Epoch: 17, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.591 Vali Acc: 0.836 Test Loss: 0.591 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.901893138885498
Epoch: 18, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.728 Vali Acc: 0.853 Test Loss: 0.728 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7377872467041016
Epoch: 19, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.574 Vali Acc: 0.843 Test Loss: 0.574 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6035370826721191
Epoch: 20, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.519 Vali Acc: 0.881 Test Loss: 0.519 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9688243865966797
Epoch: 21, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.222 Vali Acc: 0.744 Test Loss: 1.222 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.6108462810516357
Epoch: 22, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.559 Vali Acc: 0.887 Test Loss: 0.559 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9387643337249756
Epoch: 23, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.680 Vali Acc: 0.884 Test Loss: 0.680 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2787132263183594
Epoch: 24, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.779 Vali Acc: 0.836 Test Loss: 0.779 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 36969218
model size : 155.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.132307052612305
Epoch: 1, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.389 Vali Acc: 0.846 Test Loss: 0.389 Test Acc: 0.846
Validation loss decreased (inf --> -0.846412).  Saving model ...
Epoch: 2 cost time: 2.01007342338562
Epoch: 2, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.425 Vali Acc: 0.863 Test Loss: 0.425 Test Acc: 0.863
Validation loss decreased (-0.846412 --> -0.863477).  Saving model ...
Epoch: 3 cost time: 2.09055495262146
Epoch: 3, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
Validation loss decreased (-0.863477 --> -0.877130).  Saving model ...
Epoch: 4 cost time: 2.6967341899871826
Epoch: 4, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.483 Vali Acc: 0.679 Test Loss: 0.483 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.199190616607666
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.501 Vali Acc: 0.689 Test Loss: 0.501 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9044713973999023
Epoch: 6, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.387 Vali Acc: 0.853 Test Loss: 0.387 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6999659538269043
Epoch: 7, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.401 Vali Acc: 0.843 Test Loss: 0.401 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8678905963897705
Epoch: 8, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
Validation loss decreased (-0.877130 --> -0.890782).  Saving model ...
Epoch: 9 cost time: 2.6934585571289062
Epoch: 9, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.447 Vali Acc: 0.898 Test Loss: 0.447 Test Acc: 0.898
Validation loss decreased (-0.890782 --> -0.897606).  Saving model ...
Epoch: 10 cost time: 2.8960981369018555
Epoch: 10, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.435 Vali Acc: 0.853 Test Loss: 0.435 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.022782564163208
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.585 Vali Acc: 0.799 Test Loss: 0.585 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.782155990600586
Epoch: 12, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.730 Vali Acc: 0.758 Test Loss: 0.730 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.489471912384033
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.472 Vali Acc: 0.874 Test Loss: 0.472 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.574061155319214
Epoch: 14, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.512 Vali Acc: 0.881 Test Loss: 0.512 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3965086936950684
Epoch: 15, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.650 Vali Acc: 0.802 Test Loss: 0.650 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3203108310699463
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.494 Vali Acc: 0.867 Test Loss: 0.494 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0897488594055176
Epoch: 17, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.762 Vali Acc: 0.809 Test Loss: 0.762 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.407052755355835
Epoch: 18, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.945 Vali Acc: 0.747 Test Loss: 0.945 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.138295888900757
Epoch: 19, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.899 Vali Acc: 0.826 Test Loss: 0.899 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37170434
model size : 156.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.417675495147705
Epoch: 1, Steps: 17 | Train Loss: 0.750 Vali Loss: 0.357 Vali Acc: 0.881 Test Loss: 0.357 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 1.7233202457427979
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.466 Vali Acc: 0.734 Test Loss: 0.466 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.636181116104126
Epoch: 3, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
Validation loss decreased (-0.880543 --> -0.894195).  Saving model ...
Epoch: 4 cost time: 1.6782193183898926
Epoch: 4, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.504 Vali Acc: 0.693 Test Loss: 0.504 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4381248950958252
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.418 Vali Acc: 0.843 Test Loss: 0.418 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4270594120025635
Epoch: 6, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.307450771331787
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4313836097717285
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.783 Vali Acc: 0.689 Test Loss: 0.783 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3789324760437012
Epoch: 9, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.911 Vali Acc: 0.570 Test Loss: 0.911 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.358928918838501
Epoch: 10, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.419 Vali Acc: 0.860 Test Loss: 0.419 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4114668369293213
Epoch: 11, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.393 Vali Acc: 0.857 Test Loss: 0.393 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8319125175476074
Epoch: 12, Steps: 17 | Train Loss: 0.302 Vali Loss: 1.046 Vali Acc: 0.628 Test Loss: 1.046 Test Acc: 0.628
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.088439702987671
Epoch: 13, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.391 Vali Acc: 0.884 Test Loss: 0.391 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 37062914
model size : 156.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.226701498031616
Epoch: 1, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.349 Vali Acc: 0.898 Test Loss: 0.349 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.5589096546173096
Epoch: 2, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.394 Vali Acc: 0.898 Test Loss: 0.394 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7255547046661377
Epoch: 3, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.485 Vali Acc: 0.802 Test Loss: 0.485 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.625929355621338
Epoch: 4, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1937966346740723
Epoch: 5, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.348 Vali Acc: 0.860 Test Loss: 0.348 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2763991355895996
Epoch: 6, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0819385051727295
Epoch: 7, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.298 Vali Acc: 0.887 Test Loss: 0.298 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5523781776428223
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.240 Vali Acc: 0.908 Test Loss: 0.240 Test Acc: 0.908
Validation loss decreased (-0.897607 --> -0.907847).  Saving model ...
Epoch: 9 cost time: 1.3293201923370361
Epoch: 9, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.262 Vali Acc: 0.898 Test Loss: 0.262 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8634729385375977
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.344 Vali Acc: 0.870 Test Loss: 0.344 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.838857650756836
Epoch: 11, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.313 Vali Acc: 0.891 Test Loss: 0.313 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0531642436981201
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.361 Vali Acc: 0.887 Test Loss: 0.361 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2337169647216797
Epoch: 13, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
Validation loss decreased (-0.907847 --> -0.914673).  Saving model ...
Epoch: 14 cost time: 2.283165693283081
Epoch: 14, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.326 Vali Acc: 0.867 Test Loss: 0.326 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5113914012908936
Epoch: 15, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.368 Vali Acc: 0.894 Test Loss: 0.368 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.327021837234497
Epoch: 16, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.324 Vali Acc: 0.887 Test Loss: 0.324 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.511300802230835
Epoch: 17, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.610 Vali Acc: 0.802 Test Loss: 0.610 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4352502822875977
Epoch: 18, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.608 Vali Acc: 0.778 Test Loss: 0.608 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2643117904663086
Epoch: 19, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2644543647766113
Epoch: 20, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.532 Vali Acc: 0.805 Test Loss: 0.532 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2971270084381104
Epoch: 21, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8590362071990967
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2970666885375977
Epoch: 23, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.521 Vali Acc: 0.863 Test Loss: 0.521 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 37007618
model size : 155.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.129390001296997
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.347 Vali Acc: 0.881 Test Loss: 0.347 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 2.3945131301879883
Epoch: 2, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.621 Vali Acc: 0.652 Test Loss: 0.621 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.013007164001465
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.382 Vali Acc: 0.887 Test Loss: 0.382 Test Acc: 0.887
Validation loss decreased (-0.880543 --> -0.887368).  Saving model ...
Epoch: 4 cost time: 2.721057891845703
Epoch: 4, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.324 Vali Acc: 0.894 Test Loss: 0.324 Test Acc: 0.894
Validation loss decreased (-0.887368 --> -0.894195).  Saving model ...
Epoch: 5 cost time: 2.4486207962036133
Epoch: 5, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.302 Vali Acc: 0.887 Test Loss: 0.302 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.748948097229004
Epoch: 6, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.376 Vali Acc: 0.846 Test Loss: 0.376 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.571321964263916
Epoch: 7, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.400 Vali Acc: 0.863 Test Loss: 0.400 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.629580020904541
Epoch: 8, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.595 Vali Acc: 0.782 Test Loss: 0.595 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2951548099517822
Epoch: 9, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.395 Vali Acc: 0.843 Test Loss: 0.395 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.708277940750122
Epoch: 10, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.575 Vali Acc: 0.799 Test Loss: 0.575 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9069795608520508
Epoch: 11, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.404 Vali Acc: 0.904 Test Loss: 0.404 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904433).  Saving model ...
Epoch: 12 cost time: 2.664339542388916
Epoch: 12, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.342 Vali Acc: 0.901 Test Loss: 0.342 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.149202585220337
Epoch: 13, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.462524890899658
Epoch: 14, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.858 Vali Acc: 0.782 Test Loss: 0.858 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.845956563949585
Epoch: 15, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.763 Vali Acc: 0.710 Test Loss: 0.763 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.722471237182617
Epoch: 16, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.936 Vali Acc: 0.717 Test Loss: 0.936 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3639442920684814
Epoch: 17, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.650 Vali Acc: 0.840 Test Loss: 0.650 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.32273268699646
Epoch: 18, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.631 Vali Acc: 0.894 Test Loss: 0.631 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.431926965713501
Epoch: 19, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.586 Vali Acc: 0.846 Test Loss: 0.586 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.656470537185669
Epoch: 20, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2027077674865723
Epoch: 21, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.663 Vali Acc: 0.863 Test Loss: 0.663 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 37182722
model size : 156.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.705981969833374
Epoch: 1, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.415 Vali Acc: 0.836 Test Loss: 0.415 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 1.6109857559204102
Epoch: 2, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
Validation loss decreased (-0.836173 --> -0.877129).  Saving model ...
Epoch: 3 cost time: 1.9408843517303467
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.384 Vali Acc: 0.904 Test Loss: 0.384 Test Acc: 0.904
Validation loss decreased (-0.877129 --> -0.904433).  Saving model ...
Epoch: 4 cost time: 1.9691147804260254
Epoch: 4, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.460 Vali Acc: 0.744 Test Loss: 0.460 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4020936489105225
Epoch: 5, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6990439891815186
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.384230613708496
Epoch: 7, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2173373699188232
Epoch: 8, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.533 Vali Acc: 0.778 Test Loss: 0.533 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6330089569091797
Epoch: 9, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.447185754776001
Epoch: 10, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.335 Vali Acc: 0.881 Test Loss: 0.335 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1584742069244385
Epoch: 11, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.274 Vali Acc: 0.904 Test Loss: 0.274 Test Acc: 0.904
Validation loss decreased (-0.904433 --> -0.904434).  Saving model ...
Epoch: 12 cost time: 2.3003077507019043
Epoch: 12, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.473 Vali Acc: 0.788 Test Loss: 0.473 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.755629539489746
Epoch: 13, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.419 Vali Acc: 0.853 Test Loss: 0.419 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.072150945663452
Epoch: 14, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.421 Vali Acc: 0.898 Test Loss: 0.421 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.42533802986145
Epoch: 15, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9149904251098633
Epoch: 16, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.694 Vali Acc: 0.795 Test Loss: 0.694 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1724727153778076
Epoch: 17, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.553 Vali Acc: 0.826 Test Loss: 0.553 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8060176372528076
Epoch: 18, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.270819902420044
Epoch: 19, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.404 Vali Acc: 0.867 Test Loss: 0.404 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1911656856536865
Epoch: 20, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7045433521270752
Epoch: 21, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.745 Vali Acc: 0.802 Test Loss: 0.745 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 37084418
model size : 156.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.777433156967163
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 2.1521780490875244
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.356 Vali Acc: 0.928 Test Loss: 0.356 Test Acc: 0.928
Validation loss decreased (-0.877129 --> -0.928324).  Saving model ...
Epoch: 3 cost time: 2.016810655593872
Epoch: 3, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.364 Vali Acc: 0.908 Test Loss: 0.364 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6711020469665527
Epoch: 4, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.354 Vali Acc: 0.874 Test Loss: 0.354 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4028284549713135
Epoch: 5, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.321 Vali Acc: 0.881 Test Loss: 0.321 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0486137866973877
Epoch: 6, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7135875225067139
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.317 Vali Acc: 0.877 Test Loss: 0.317 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.08882999420166
Epoch: 8, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.343 Vali Acc: 0.857 Test Loss: 0.343 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6036689281463623
Epoch: 9, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.363 Vali Acc: 0.853 Test Loss: 0.363 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7919301986694336
Epoch: 10, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.381 Vali Acc: 0.860 Test Loss: 0.381 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.62382173538208
Epoch: 11, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3168530464172363
Epoch: 12, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9283276450511946
model parameter : 37032194
model size : 155.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.86482572555542
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 1.866739273071289
Epoch: 2, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.693 Vali Acc: 0.532 Test Loss: 0.693 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.045620918273926
Epoch: 3, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.485 Vali Acc: 0.782 Test Loss: 0.485 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.199913740158081
Epoch: 4, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.371 Vali Acc: 0.843 Test Loss: 0.371 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7890584468841553
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.287 Vali Acc: 0.891 Test Loss: 0.287 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.739637851715088
Epoch: 6, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.451 Vali Acc: 0.792 Test Loss: 0.451 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2267847061157227
Epoch: 7, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.267 Vali Acc: 0.898 Test Loss: 0.267 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 2.0741631984710693
Epoch: 8, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1092755794525146
Epoch: 9, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.283 Vali Acc: 0.908 Test Loss: 0.283 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907847).  Saving model ...
Epoch: 10 cost time: 2.8078041076660156
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.282 Vali Acc: 0.904 Test Loss: 0.282 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.212268829345703
Epoch: 11, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.698 Vali Acc: 0.741 Test Loss: 0.698 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.433062791824341
Epoch: 12, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.400 Vali Acc: 0.901 Test Loss: 0.400 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.40712571144104
Epoch: 13, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9512732028961182
Epoch: 14, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.381 Vali Acc: 0.894 Test Loss: 0.381 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.142413377761841
Epoch: 15, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.814 Vali Acc: 0.724 Test Loss: 0.814 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9691660404205322
Epoch: 16, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0005645751953125
Epoch: 17, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.735 Vali Acc: 0.771 Test Loss: 0.735 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1598196029663086
Epoch: 18, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.710 Vali Acc: 0.812 Test Loss: 0.710 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8311288356781006
Epoch: 19, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.630 Vali Acc: 0.860 Test Loss: 0.630 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 37208834
model size : 156.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4471921920776367
Epoch: 1, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
Validation loss decreased (inf --> -0.890782).  Saving model ...
Epoch: 2 cost time: 1.6618735790252686
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.456 Vali Acc: 0.706 Test Loss: 0.456 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4426133632659912
Epoch: 3, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.144883632659912
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.363 Vali Acc: 0.860 Test Loss: 0.363 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.03680419921875
Epoch: 5, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.552 Vali Acc: 0.765 Test Loss: 0.552 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5607070922851562
Epoch: 6, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.426 Vali Acc: 0.860 Test Loss: 0.426 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.456521987915039
Epoch: 7, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.699329137802124
Epoch: 8, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.445 Vali Acc: 0.799 Test Loss: 0.445 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3673179149627686
Epoch: 9, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.378 Vali Acc: 0.881 Test Loss: 0.378 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6456940174102783
Epoch: 10, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.337 Vali Acc: 0.881 Test Loss: 0.337 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2460265159606934
Epoch: 11, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.336 Vali Acc: 0.891 Test Loss: 0.336 Test Acc: 0.891
Validation loss decreased (-0.890782 --> -0.890782).  Saving model ...
Epoch: 12 cost time: 2.259756326675415
Epoch: 12, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.409 Vali Acc: 0.853 Test Loss: 0.409 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7321422100067139
Epoch: 13, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.609 Vali Acc: 0.771 Test Loss: 0.609 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.310976028442383
Epoch: 14, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.451 Vali Acc: 0.877 Test Loss: 0.451 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.043375253677368
Epoch: 15, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.419 Vali Acc: 0.894 Test Loss: 0.419 Test Acc: 0.894
Validation loss decreased (-0.890782 --> -0.894194).  Saving model ...
Epoch: 16 cost time: 2.4635491371154785
Epoch: 16, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.587 Vali Acc: 0.853 Test Loss: 0.587 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7668075561523438
Epoch: 17, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.487 Vali Acc: 0.891 Test Loss: 0.487 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3569443225860596
Epoch: 18, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.951 Vali Acc: 0.713 Test Loss: 0.951 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.139625072479248
Epoch: 19, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.975 Vali Acc: 0.802 Test Loss: 0.975 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8550851345062256
Epoch: 20, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.518 Vali Acc: 0.874 Test Loss: 0.518 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.038335084915161
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.799 Vali Acc: 0.785 Test Loss: 0.799 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5451884269714355
Epoch: 22, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.582 Vali Acc: 0.829 Test Loss: 0.582 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9803271293640137
Epoch: 23, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3359277248382568
Epoch: 24, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.603 Vali Acc: 0.887 Test Loss: 0.603 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1543211936950684
Epoch: 25, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.753 Vali Acc: 0.857 Test Loss: 0.753 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 37119746
model size : 156.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7113022804260254
Epoch: 1, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.2095870971679688
Epoch: 2, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.389 Vali Acc: 0.863 Test Loss: 0.389 Test Acc: 0.863
Validation loss decreased (-0.829347 --> -0.863477).  Saving model ...
Epoch: 3 cost time: 1.375044345855713
Epoch: 3, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.352 Vali Acc: 0.884 Test Loss: 0.352 Test Acc: 0.884
Validation loss decreased (-0.863477 --> -0.883956).  Saving model ...
Epoch: 4 cost time: 1.424119234085083
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.304793119430542
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.337 Vali Acc: 0.870 Test Loss: 0.337 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.447798252105713
Epoch: 6, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2370972633361816
Epoch: 7, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.419968843460083
Epoch: 8, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
Validation loss decreased (-0.883956 --> -0.911260).  Saving model ...
Epoch: 9 cost time: 1.0991747379302979
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.368 Vali Acc: 0.833 Test Loss: 0.368 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1799352169036865
Epoch: 10, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.275 Vali Acc: 0.908 Test Loss: 0.275 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.238219976425171
Epoch: 11, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4584763050079346
Epoch: 12, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.511 Vali Acc: 0.840 Test Loss: 0.511 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.050736665725708
Epoch: 13, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.522 Vali Acc: 0.788 Test Loss: 0.522 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.231454610824585
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.543 Vali Acc: 0.840 Test Loss: 0.543 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7709712982177734
Epoch: 15, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9776370525360107
Epoch: 16, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.643 Vali Acc: 0.863 Test Loss: 0.643 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9302220344543457
Epoch: 17, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.691 Vali Acc: 0.826 Test Loss: 0.691 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7267146110534668
Epoch: 18, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.909 Vali Acc: 0.720 Test Loss: 0.909 Test Acc: 0.720
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 37070594
model size : 156.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps56_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2609617710113525
Epoch: 1, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.362 Vali Acc: 0.874 Test Loss: 0.362 Test Acc: 0.874
Validation loss decreased (inf --> -0.873717).  Saving model ...
Epoch: 2 cost time: 3.045323371887207
Epoch: 2, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.698530435562134
Epoch: 3, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.391 Vali Acc: 0.853 Test Loss: 0.391 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.871419906616211
Epoch: 4, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8883388042449951
Epoch: 5, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.378 Vali Acc: 0.874 Test Loss: 0.378 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.102224588394165
Epoch: 6, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.729 Vali Acc: 0.710 Test Loss: 0.729 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3224730491638184
Epoch: 7, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.333 Vali Acc: 0.874 Test Loss: 0.333 Test Acc: 0.874
Validation loss decreased (-0.873717 --> -0.873717).  Saving model ...
Epoch: 8 cost time: 3.3935587406158447
Epoch: 8, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.353 Vali Acc: 0.874 Test Loss: 0.353 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5072264671325684
Epoch: 9, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
Validation loss decreased (-0.873717 --> -0.877129).  Saving model ...
Epoch: 10 cost time: 1.7544701099395752
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.124 Vali Acc: 0.563 Test Loss: 1.124 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.279351234436035
Epoch: 11, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.567 Vali Acc: 0.802 Test Loss: 0.567 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0760443210601807
Epoch: 12, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.619 Vali Acc: 0.884 Test Loss: 0.619 Test Acc: 0.884
Validation loss decreased (-0.877129 --> -0.883953).  Saving model ...
Epoch: 13 cost time: 1.647463321685791
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.642 Vali Acc: 0.840 Test Loss: 0.642 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.513056993484497
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.907 Vali Acc: 0.710 Test Loss: 0.907 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.520538091659546
Epoch: 15, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.719 Vali Acc: 0.874 Test Loss: 0.719 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4714820384979248
Epoch: 16, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.800 Vali Acc: 0.877 Test Loss: 0.800 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.131471633911133
Epoch: 17, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.686 Vali Acc: 0.898 Test Loss: 0.686 Test Acc: 0.898
Validation loss decreased (-0.883953 --> -0.897604).  Saving model ...
Epoch: 18 cost time: 2.1696250438690186
Epoch: 18, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.526 Vali Acc: 0.894 Test Loss: 0.526 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9135425090789795
Epoch: 19, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.821 Vali Acc: 0.846 Test Loss: 0.821 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9026296138763428
Epoch: 20, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.928372383117676
Epoch: 21, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.040 Vali Acc: 0.843 Test Loss: 1.040 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8576586246490479
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 2.138 Vali Acc: 0.720 Test Loss: 2.138 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.0831429958343506
Epoch: 23, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.200 Vali Acc: 0.788 Test Loss: 1.200 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.503512144088745
Epoch: 24, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.618 Vali Acc: 0.799 Test Loss: 1.618 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.562624931335449
Epoch: 25, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.253 Vali Acc: 0.829 Test Loss: 1.253 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.21032452583313
Epoch: 26, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.022 Vali Acc: 0.857 Test Loss: 1.022 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.672304391860962
Epoch: 27, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.140 Vali Acc: 0.884 Test Loss: 1.140 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps56_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37250306
model size : 156.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps56_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2248542308807373
Epoch: 1, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.325 Vali Acc: 0.908 Test Loss: 0.325 Test Acc: 0.908
Validation loss decreased (inf --> -0.907847).  Saving model ...
Epoch: 2 cost time: 1.2670867443084717
Epoch: 2, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.443 Vali Acc: 0.823 Test Loss: 0.443 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1716763973236084
Epoch: 3, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1448044776916504
Epoch: 4, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.413 Vali Acc: 0.836 Test Loss: 0.413 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.950042963027954
Epoch: 5, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.373 Vali Acc: 0.846 Test Loss: 0.373 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5775811672210693
Epoch: 6, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.280 Vali Acc: 0.887 Test Loss: 0.280 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1622865200042725
Epoch: 7, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.273 Vali Acc: 0.904 Test Loss: 0.273 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6388051509857178
Epoch: 8, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.395 Vali Acc: 0.860 Test Loss: 0.395 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1594915390014648
Epoch: 9, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.443 Vali Acc: 0.805 Test Loss: 0.443 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3215789794921875
Epoch: 10, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911261).  Saving model ...
Epoch: 11 cost time: 1.5585520267486572
Epoch: 11, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.253 Vali Acc: 0.918 Test Loss: 0.253 Test Acc: 0.918
Validation loss decreased (-0.911261 --> -0.918086).  Saving model ...
Epoch: 12 cost time: 2.17344331741333
Epoch: 12, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.508 Vali Acc: 0.829 Test Loss: 0.508 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9071674346923828
Epoch: 13, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.332 Vali Acc: 0.898 Test Loss: 0.332 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.401601552963257
Epoch: 14, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.450 Vali Acc: 0.860 Test Loss: 0.450 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5512893199920654
Epoch: 15, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.365 Vali Acc: 0.887 Test Loss: 0.365 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8653545379638672
Epoch: 16, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.290 Vali Acc: 0.904 Test Loss: 0.290 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6401145458221436
Epoch: 17, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.284 Vali Acc: 0.904 Test Loss: 0.284 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9318439960479736
Epoch: 18, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.414 Vali Acc: 0.874 Test Loss: 0.414 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1708848476409912
Epoch: 19, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.538 Vali Acc: 0.887 Test Loss: 0.538 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.15395188331604
Epoch: 20, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.457087516784668
Epoch: 21, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.476 Vali Acc: 0.863 Test Loss: 0.476 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps56_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 37158146
model size : 156.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps56_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4820973873138428
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.410 Vali Acc: 0.904 Test Loss: 0.410 Test Acc: 0.904
Validation loss decreased (inf --> -0.904433).  Saving model ...
Epoch: 2 cost time: 2.010563373565674
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.339 Vali Acc: 0.901 Test Loss: 0.339 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.361933708190918
Epoch: 3, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.391 Vali Acc: 0.857 Test Loss: 0.391 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8984262943267822
Epoch: 4, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.291 Vali Acc: 0.881 Test Loss: 0.291 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1106641292572021
Epoch: 5, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.246563196182251
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.240 Vali Acc: 0.918 Test Loss: 0.240 Test Acc: 0.918
Validation loss decreased (-0.904433 --> -0.918086).  Saving model ...
Epoch: 7 cost time: 1.777787685394287
Epoch: 7, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.272 Vali Acc: 0.915 Test Loss: 0.272 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2865688800811768
Epoch: 8, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.257 Vali Acc: 0.891 Test Loss: 0.257 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3133602142333984
Epoch: 9, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.245 Vali Acc: 0.901 Test Loss: 0.245 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6603116989135742
Epoch: 10, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.244 Vali Acc: 0.904 Test Loss: 0.244 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3439855575561523
Epoch: 11, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.322 Vali Acc: 0.877 Test Loss: 0.322 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.001678228378296
Epoch: 12, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9602973461151123
Epoch: 13, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.477 Vali Acc: 0.823 Test Loss: 0.477 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9409723281860352
Epoch: 14, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.463 Vali Acc: 0.857 Test Loss: 0.463 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1432433128356934
Epoch: 15, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2410504817962646
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.478 Vali Acc: 0.857 Test Loss: 0.478 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps56_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 37112066
model size : 156.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.329007148742676
Epoch: 1, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.348 Vali Acc: 0.881 Test Loss: 0.348 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 2.378835439682007
Epoch: 2, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.375 Vali Acc: 0.884 Test Loss: 0.375 Test Acc: 0.884
Validation loss decreased (-0.880543 --> -0.883955).  Saving model ...
Epoch: 3 cost time: 1.630387783050537
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.426 Vali Acc: 0.843 Test Loss: 0.426 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.502265453338623
Epoch: 4, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.423 Vali Acc: 0.751 Test Loss: 0.423 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.865602731704712
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.598130464553833
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.401 Vali Acc: 0.816 Test Loss: 0.401 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9117069244384766
Epoch: 7, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.658 Vali Acc: 0.594 Test Loss: 0.658 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6327266693115234
Epoch: 8, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.292 Vali Acc: 0.908 Test Loss: 0.292 Test Acc: 0.908
Validation loss decreased (-0.883955 --> -0.907847).  Saving model ...
Epoch: 9 cost time: 1.9956388473510742
Epoch: 9, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.273 Vali Acc: 0.877 Test Loss: 0.273 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7024638652801514
Epoch: 10, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.330 Vali Acc: 0.860 Test Loss: 0.330 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.69740891456604
Epoch: 11, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.469 Vali Acc: 0.765 Test Loss: 0.469 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2456278800964355
Epoch: 12, Steps: 17 | Train Loss: 0.491 Vali Loss: 1.075 Vali Acc: 0.590 Test Loss: 1.075 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.649578332901001
Epoch: 13, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.037951707839966
Epoch: 14, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.393 Vali Acc: 0.887 Test Loss: 0.393 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5918757915496826
Epoch: 15, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.731 Vali Acc: 0.799 Test Loss: 0.731 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5328428745269775
Epoch: 16, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.835 Vali Acc: 0.775 Test Loss: 0.835 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7117083072662354
Epoch: 17, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.795 Vali Acc: 0.737 Test Loss: 0.795 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8669698238372803
Epoch: 18, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 37290242
model size : 156.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.920287609100342
Epoch: 1, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.330 Vali Acc: 0.908 Test Loss: 0.330 Test Acc: 0.908
Validation loss decreased (inf --> -0.907847).  Saving model ...
Epoch: 2 cost time: 1.5859050750732422
Epoch: 2, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.372 Vali Acc: 0.881 Test Loss: 0.372 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.196383237838745
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.398 Vali Acc: 0.846 Test Loss: 0.398 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5470426082611084
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.399 Vali Acc: 0.819 Test Loss: 0.399 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5164527893066406
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.298 Vali Acc: 0.891 Test Loss: 0.298 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.264542818069458
Epoch: 6, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.268 Vali Acc: 0.898 Test Loss: 0.268 Test Acc: 0.898
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.115859270095825
Epoch: 7, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.310 Vali Acc: 0.898 Test Loss: 0.310 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9977269172668457
Epoch: 8, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.467 Vali Acc: 0.713 Test Loss: 0.467 Test Acc: 0.713
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.424067258834839
Epoch: 9, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.335 Vali Acc: 0.863 Test Loss: 0.335 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1669435501098633
Epoch: 10, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0351181030273438
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 37204226
model size : 156.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.744126081466675
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.406 Vali Acc: 0.894 Test Loss: 0.406 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 0.9780097007751465
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.362 Vali Acc: 0.911 Test Loss: 0.362 Test Acc: 0.911
Validation loss decreased (-0.894194 --> -0.911259).  Saving model ...
Epoch: 3 cost time: 1.194737434387207
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.381 Vali Acc: 0.874 Test Loss: 0.381 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.332211971282959
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.351 Vali Acc: 0.898 Test Loss: 0.351 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.975508451461792
Epoch: 5, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.313 Vali Acc: 0.901 Test Loss: 0.313 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3059329986572266
Epoch: 6, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.413 Vali Acc: 0.775 Test Loss: 0.413 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3530173301696777
Epoch: 7, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.320 Vali Acc: 0.887 Test Loss: 0.320 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3054478168487549
Epoch: 8, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.350 Vali Acc: 0.877 Test Loss: 0.350 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3612024784088135
Epoch: 9, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.322 Vali Acc: 0.898 Test Loss: 0.322 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2397074699401855
Epoch: 10, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.369 Vali Acc: 0.877 Test Loss: 0.369 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3820796012878418
Epoch: 11, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.492 Vali Acc: 0.765 Test Loss: 0.492 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3338873386383057
Epoch: 12, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.481 Vali Acc: 0.836 Test Loss: 0.481 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 37161218
model size : 156.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.281480550765991
Epoch: 1, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 1.9508953094482422
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.486 Vali Acc: 0.672 Test Loss: 0.486 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7560076713562012
Epoch: 3, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
Validation loss decreased (-0.890781 --> -0.894194).  Saving model ...
Epoch: 4 cost time: 1.7635822296142578
Epoch: 4, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.413 Vali Acc: 0.853 Test Loss: 0.413 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.041844606399536
Epoch: 5, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.360 Vali Acc: 0.863 Test Loss: 0.360 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.363265037536621
Epoch: 6, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.475 Vali Acc: 0.805 Test Loss: 0.475 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8086590766906738
Epoch: 7, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.016247510910034
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9219818115234375
Epoch: 9, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.586 Vali Acc: 0.792 Test Loss: 0.586 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8874127864837646
Epoch: 10, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.520 Vali Acc: 0.826 Test Loss: 0.520 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.10870623588562
Epoch: 11, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9677422046661377
Epoch: 12, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.135039806365967
Epoch: 13, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.580 Vali Acc: 0.836 Test Loss: 0.580 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 37336322
model size : 157.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.257200002670288
Epoch: 1, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.357 Vali Acc: 0.877 Test Loss: 0.357 Test Acc: 0.877
Validation loss decreased (inf --> -0.877130).  Saving model ...
Epoch: 2 cost time: 2.1841862201690674
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.428 Vali Acc: 0.846 Test Loss: 0.428 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7615272998809814
Epoch: 3, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
Validation loss decreased (-0.877130 --> -0.883955).  Saving model ...
Epoch: 4 cost time: 2.3438992500305176
Epoch: 4, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.433 Vali Acc: 0.819 Test Loss: 0.433 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6994445323944092
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6332852840423584
Epoch: 6, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.420 Vali Acc: 0.843 Test Loss: 0.420 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9607086181640625
Epoch: 7, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.106884479522705
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.381 Vali Acc: 0.853 Test Loss: 0.381 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.535270929336548
Epoch: 9, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.331 Vali Acc: 0.887 Test Loss: 0.331 Test Acc: 0.887
Validation loss decreased (-0.883955 --> -0.887369).  Saving model ...
Epoch: 10 cost time: 2.4516217708587646
Epoch: 10, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.371 Vali Acc: 0.881 Test Loss: 0.371 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8522698879241943
Epoch: 11, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.368 Vali Acc: 0.881 Test Loss: 0.368 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9790592193603516
Epoch: 12, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5563695430755615
Epoch: 13, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
Validation loss decreased (-0.887369 --> -0.890781).  Saving model ...
Epoch: 14 cost time: 1.840930461883545
Epoch: 14, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4274039268493652
Epoch: 15, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.448 Vali Acc: 0.884 Test Loss: 0.448 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4476478099823
Epoch: 16, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.501 Vali Acc: 0.860 Test Loss: 0.501 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4032373428344727
Epoch: 17, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8209669589996338
Epoch: 18, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.678 Vali Acc: 0.703 Test Loss: 0.678 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5468549728393555
Epoch: 19, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.622 Vali Acc: 0.836 Test Loss: 0.622 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5129139423370361
Epoch: 20, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.667 Vali Acc: 0.846 Test Loss: 0.667 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2387666702270508
Epoch: 21, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.682 Vali Acc: 0.853 Test Loss: 0.682 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2970342636108398
Epoch: 22, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.162 Vali Acc: 0.785 Test Loss: 1.162 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1969780921936035
Epoch: 23, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.773 Vali Acc: 0.857 Test Loss: 0.773 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 37256450
model size : 156.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.014472723007202
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.437 Vali Acc: 0.898 Test Loss: 0.437 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.9962940216064453
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.413 Vali Acc: 0.881 Test Loss: 0.413 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8800806999206543
Epoch: 3, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6180739402770996
Epoch: 4, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.352 Vali Acc: 0.887 Test Loss: 0.352 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1588358879089355
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.320 Vali Acc: 0.870 Test Loss: 0.320 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7359898090362549
Epoch: 6, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.304 Vali Acc: 0.904 Test Loss: 0.304 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904434).  Saving model ...
Epoch: 7 cost time: 1.3498404026031494
Epoch: 7, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.904434 --> -0.911260).  Saving model ...
Epoch: 8 cost time: 1.9038140773773193
Epoch: 8, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8497889041900635
Epoch: 9, Steps: 17 | Train Loss: 0.353 Vali Loss: 1.027 Vali Acc: 0.539 Test Loss: 1.027 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7907862663269043
Epoch: 10, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.254 Vali Acc: 0.904 Test Loss: 0.254 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0898666381835938
Epoch: 11, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.316 Vali Acc: 0.884 Test Loss: 0.316 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9600098133087158
Epoch: 12, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.342 Vali Acc: 0.887 Test Loss: 0.342 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2969765663146973
Epoch: 13, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.600 Vali Acc: 0.775 Test Loss: 0.600 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1828551292419434
Epoch: 14, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.527 Vali Acc: 0.840 Test Loss: 0.527 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2982654571533203
Epoch: 15, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.435 Vali Acc: 0.857 Test Loss: 0.435 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8392233848571777
Epoch: 16, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5480904579162598
Epoch: 17, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
Validation loss decreased (-0.911260 --> -0.914673).  Saving model ...
Epoch: 18 cost time: 1.135746717453003
Epoch: 18, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5529651641845703
Epoch: 19, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.729 Vali Acc: 0.816 Test Loss: 0.729 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3022830486297607
Epoch: 20, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6202850341796875
Epoch: 21, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.414 Vali Acc: 0.901 Test Loss: 0.414 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.191544532775879
Epoch: 22, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3645210266113281
Epoch: 23, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.409 Vali Acc: 0.881 Test Loss: 0.409 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2298390865325928
Epoch: 24, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.510 Vali Acc: 0.881 Test Loss: 0.510 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0436582565307617
Epoch: 25, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.065382719039917
Epoch: 26, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5081613063812256
Epoch: 27, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.458 Vali Acc: 0.863 Test Loss: 0.458 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 37216514
model size : 156.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps69_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7459747791290283
Epoch: 1, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.333 Vali Acc: 0.901 Test Loss: 0.333 Test Acc: 0.901
Validation loss decreased (inf --> -0.901021).  Saving model ...
Epoch: 2 cost time: 2.877898931503296
Epoch: 2, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.354 Vali Acc: 0.904 Test Loss: 0.354 Test Acc: 0.904
Validation loss decreased (-0.901021 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.9319102764129639
Epoch: 3, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.312 Vali Acc: 0.891 Test Loss: 0.312 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.198293924331665
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.352 Vali Acc: 0.857 Test Loss: 0.352 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9132776260375977
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.596 Vali Acc: 0.625 Test Loss: 0.596 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.565277099609375
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.390 Vali Acc: 0.843 Test Loss: 0.390 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.356405735015869
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1877944469451904
Epoch: 8, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.325 Vali Acc: 0.874 Test Loss: 0.325 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.674103260040283
Epoch: 9, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.305 Vali Acc: 0.874 Test Loss: 0.305 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8908002376556396
Epoch: 10, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.336 Vali Acc: 0.863 Test Loss: 0.336 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2233896255493164
Epoch: 11, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.385 Vali Acc: 0.867 Test Loss: 0.385 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.399357318878174
Epoch: 12, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.643 Vali Acc: 0.792 Test Loss: 0.643 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps69_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 37383938
model size : 157.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps69_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1742823123931885
Epoch: 1, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.383 Vali Acc: 0.898 Test Loss: 0.383 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.4141504764556885
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.504 Vali Acc: 0.628 Test Loss: 0.504 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8223226070404053
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.454 Vali Acc: 0.713 Test Loss: 0.454 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3420441150665283
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.435 Vali Acc: 0.887 Test Loss: 0.435 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.089111089706421
Epoch: 5, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.313 Vali Acc: 0.904 Test Loss: 0.313 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904434).  Saving model ...
Epoch: 6 cost time: 1.6490507125854492
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.904434 --> -0.911260).  Saving model ...
Epoch: 7 cost time: 1.9308557510375977
Epoch: 7, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.306 Vali Acc: 0.884 Test Loss: 0.306 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1962900161743164
Epoch: 8, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.407 Vali Acc: 0.809 Test Loss: 0.407 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.520883321762085
Epoch: 9, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.289 Vali Acc: 0.898 Test Loss: 0.289 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.913848876953125
Epoch: 10, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.287 Vali Acc: 0.898 Test Loss: 0.287 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7692949771881104
Epoch: 11, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.677459955215454
Epoch: 12, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.543 Vali Acc: 0.720 Test Loss: 0.543 Test Acc: 0.720
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9682888984680176
Epoch: 13, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.374 Vali Acc: 0.860 Test Loss: 0.374 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1231939792633057
Epoch: 14, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.443 Vali Acc: 0.857 Test Loss: 0.443 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6176187992095947
Epoch: 15, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.588 Vali Acc: 0.826 Test Loss: 0.588 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.600795269012451
Epoch: 16, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.379 Vali Acc: 0.884 Test Loss: 0.379 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps69_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 37316354
model size : 157.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps69_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0855202674865723
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.386 Vali Acc: 0.884 Test Loss: 0.386 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 1.1411235332489014
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.883955 --> -0.924911).  Saving model ...
Epoch: 3 cost time: 1.4727771282196045
Epoch: 3, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.394 Vali Acc: 0.853 Test Loss: 0.394 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0844933986663818
Epoch: 4, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.370 Vali Acc: 0.857 Test Loss: 0.370 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.384986400604248
Epoch: 5, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.372 Vali Acc: 0.840 Test Loss: 0.372 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5320284366607666
Epoch: 6, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3924853801727295
Epoch: 7, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7475035190582275
Epoch: 8, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0156824588775635
Epoch: 9, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.406 Vali Acc: 0.846 Test Loss: 0.406 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7747433185577393
Epoch: 10, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.439 Vali Acc: 0.829 Test Loss: 0.439 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1708950996398926
Epoch: 11, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.306 Vali Acc: 0.898 Test Loss: 0.306 Test Acc: 0.898
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6397075653076172
Epoch: 12, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.341 Vali Acc: 0.887 Test Loss: 0.341 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps69_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9249146757679181
model parameter : 37279490
model size : 156.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6106526851654053
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.635 Vali Acc: 0.498 Test Loss: 0.635 Test Acc: 0.498
Validation loss decreased (inf --> -0.498287).  Saving model ...
Epoch: 2 cost time: 1.7825517654418945
Epoch: 2, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.388 Vali Acc: 0.898 Test Loss: 0.388 Test Acc: 0.898
Validation loss decreased (-0.498287 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 1.811215877532959
Epoch: 3, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.347 Vali Acc: 0.884 Test Loss: 0.347 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0128049850463867
Epoch: 4, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.324 Vali Acc: 0.881 Test Loss: 0.324 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7868359088897705
Epoch: 5, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.342048168182373
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.455 Vali Acc: 0.717 Test Loss: 0.455 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3837971687316895
Epoch: 7, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.413 Vali Acc: 0.819 Test Loss: 0.413 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9698736667633057
Epoch: 8, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.925 Vali Acc: 0.570 Test Loss: 0.925 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9415104389190674
Epoch: 9, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.676 Vali Acc: 0.788 Test Loss: 0.676 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8983628749847412
Epoch: 10, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.199371099472046
Epoch: 11, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3089935779571533
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37460738
model size : 157.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3383169174194336
Epoch: 1, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.399 Vali Acc: 0.887 Test Loss: 0.399 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 1.1128911972045898
Epoch: 2, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.374 Vali Acc: 0.887 Test Loss: 0.374 Test Acc: 0.887
Validation loss decreased (-0.887368 --> -0.887368).  Saving model ...
Epoch: 3 cost time: 1.288736343383789
Epoch: 3, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.525 Vali Acc: 0.751 Test Loss: 0.525 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.357714891433716
Epoch: 4, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
Validation loss decreased (-0.887368 --> -0.911260).  Saving model ...
Epoch: 5 cost time: 1.4100122451782227
Epoch: 5, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.911260 --> -0.911260).  Saving model ...
Epoch: 6 cost time: 2.735585927963257
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.492 Vali Acc: 0.652 Test Loss: 0.492 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5350654125213623
Epoch: 7, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.403 Vali Acc: 0.805 Test Loss: 0.403 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9523868560791016
Epoch: 8, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.380 Vali Acc: 0.819 Test Loss: 0.380 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.941457986831665
Epoch: 9, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.285 Vali Acc: 0.901 Test Loss: 0.285 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4672157764434814
Epoch: 10, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.324 Vali Acc: 0.887 Test Loss: 0.324 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.4077517986297607
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.348 Vali Acc: 0.887 Test Loss: 0.348 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7717671394348145
Epoch: 12, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.296 Vali Acc: 0.908 Test Loss: 0.296 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6792874336242676
Epoch: 13, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.311 Vali Acc: 0.887 Test Loss: 0.311 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5173170566558838
Epoch: 14, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.630 Vali Acc: 0.768 Test Loss: 0.630 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.676950216293335
Epoch: 15, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.494 Vali Acc: 0.826 Test Loss: 0.494 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 37393154
model size : 157.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3073818683624268
Epoch: 1, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 1.2021899223327637
Epoch: 2, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.381 Vali Acc: 0.908 Test Loss: 0.381 Test Acc: 0.908
Validation loss decreased (-0.877129 --> -0.907846).  Saving model ...
Epoch: 3 cost time: 1.0412192344665527
Epoch: 3, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
Validation loss decreased (-0.907846 --> -0.921498).  Saving model ...
Epoch: 4 cost time: 1.5217950344085693
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.401 Vali Acc: 0.809 Test Loss: 0.401 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3225724697113037
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5372560024261475
Epoch: 6, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.322 Vali Acc: 0.887 Test Loss: 0.322 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.309309959411621
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.428 Vali Acc: 0.758 Test Loss: 0.428 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6846978664398193
Epoch: 8, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.407 Vali Acc: 0.823 Test Loss: 0.407 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2675457000732422
Epoch: 9, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.427 Vali Acc: 0.846 Test Loss: 0.427 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0466151237487793
Epoch: 10, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.320 Vali Acc: 0.877 Test Loss: 0.320 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5579748153686523
Epoch: 11, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.307 Vali Acc: 0.904 Test Loss: 0.307 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2272288799285889
Epoch: 12, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.447 Vali Acc: 0.829 Test Loss: 0.447 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6417901515960693
Epoch: 13, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.336 Vali Acc: 0.877 Test Loss: 0.336 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 37359362
model size : 157.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps82_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.041884183883667
Epoch: 1, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.359 Vali Acc: 0.860 Test Loss: 0.359 Test Acc: 0.860
Validation loss decreased (inf --> -0.860065).  Saving model ...
Epoch: 2 cost time: 2.382336378097534
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.399 Vali Acc: 0.867 Test Loss: 0.399 Test Acc: 0.867
Validation loss decreased (-0.860065 --> -0.866890).  Saving model ...
Epoch: 3 cost time: 2.412243604660034
Epoch: 3, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.497 Vali Acc: 0.785 Test Loss: 0.497 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.778501033782959
Epoch: 4, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.387 Vali Acc: 0.887 Test Loss: 0.387 Test Acc: 0.887
Validation loss decreased (-0.866890 --> -0.887368).  Saving model ...
Epoch: 5 cost time: 1.7978668212890625
Epoch: 5, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.398 Vali Acc: 0.829 Test Loss: 0.398 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.343661069869995
Epoch: 6, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.669 Vali Acc: 0.614 Test Loss: 0.669 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.731973171234131
Epoch: 7, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7461345195770264
Epoch: 8, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.689 Vali Acc: 0.693 Test Loss: 0.689 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5749423503875732
Epoch: 9, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4698143005371094
Epoch: 10, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.338 Vali Acc: 0.901 Test Loss: 0.338 Test Acc: 0.901
Validation loss decreased (-0.887368 --> -0.901021).  Saving model ...
Epoch: 11 cost time: 1.6415002346038818
Epoch: 11, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.303 Vali Acc: 0.901 Test Loss: 0.303 Test Acc: 0.901
Validation loss decreased (-0.901021 --> -0.901021).  Saving model ...
Epoch: 12 cost time: 1.6633217334747314
Epoch: 12, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7925729751586914
Epoch: 13, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.432 Vali Acc: 0.833 Test Loss: 0.432 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7798001766204834
Epoch: 14, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.530 Vali Acc: 0.768 Test Loss: 0.530 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5494880676269531
Epoch: 15, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.703 Vali Acc: 0.710 Test Loss: 0.703 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4529101848602295
Epoch: 16, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5284912586212158
Epoch: 17, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.753 Vali Acc: 0.693 Test Loss: 0.753 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0405352115631104
Epoch: 18, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.607 Vali Acc: 0.836 Test Loss: 0.607 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.277911901473999
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.504 Vali Acc: 0.628 Test Loss: 1.504 Test Acc: 0.628
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2141807079315186
Epoch: 20, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.589 Vali Acc: 0.867 Test Loss: 0.589 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.652076482772827
Epoch: 21, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.805 Vali Acc: 0.799 Test Loss: 0.805 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps82_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 37542146
model size : 157.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps82_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.360311031341553
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.96250581741333
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
Validation loss decreased (-0.832760 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 1.7476532459259033
Epoch: 3, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.408 Vali Acc: 0.836 Test Loss: 0.408 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836173).  Saving model ...
Epoch: 4 cost time: 2.653273820877075
Epoch: 4, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.395 Vali Acc: 0.829 Test Loss: 0.395 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.906303882598877
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.368 Vali Acc: 0.863 Test Loss: 0.368 Test Acc: 0.863
Validation loss decreased (-0.836173 --> -0.863478).  Saving model ...
Epoch: 6 cost time: 2.2956600189208984
Epoch: 6, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.444 Vali Acc: 0.700 Test Loss: 0.444 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4696874618530273
Epoch: 7, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.344 Vali Acc: 0.874 Test Loss: 0.344 Test Acc: 0.874
Validation loss decreased (-0.863478 --> -0.873717).  Saving model ...
Epoch: 8 cost time: 1.5157451629638672
Epoch: 8, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.526 Vali Acc: 0.696 Test Loss: 0.526 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.123589038848877
Epoch: 9, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.462 Vali Acc: 0.805 Test Loss: 0.462 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.13734769821167
Epoch: 10, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.351 Vali Acc: 0.881 Test Loss: 0.351 Test Acc: 0.881
Validation loss decreased (-0.873717 --> -0.880543).  Saving model ...
Epoch: 11 cost time: 0.9359283447265625
Epoch: 11, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.350 Vali Acc: 0.887 Test Loss: 0.350 Test Acc: 0.887
Validation loss decreased (-0.880543 --> -0.887369).  Saving model ...
Epoch: 12 cost time: 1.953293800354004
Epoch: 12, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.358 Vali Acc: 0.884 Test Loss: 0.358 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5691108703613281
Epoch: 13, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.405 Vali Acc: 0.863 Test Loss: 0.405 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.470693588256836
Epoch: 14, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.603 Vali Acc: 0.799 Test Loss: 0.603 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4576046466827393
Epoch: 15, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.759 Vali Acc: 0.724 Test Loss: 0.759 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6558332443237305
Epoch: 16, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.534 Vali Acc: 0.823 Test Loss: 0.534 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3094539642333984
Epoch: 17, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3616883754730225
Epoch: 18, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.732 Vali Acc: 0.823 Test Loss: 0.732 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.919168472290039
Epoch: 19, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1823441982269287
Epoch: 20, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.010 Vali Acc: 0.706 Test Loss: 1.010 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7868084907531738
Epoch: 21, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.246 Vali Acc: 0.669 Test Loss: 1.246 Test Acc: 0.669
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps82_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 37483778
model size : 157.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps82_str82_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.67095685005188
Epoch: 1, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.368 Vali Acc: 0.898 Test Loss: 0.368 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.5210788249969482
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.363 Vali Acc: 0.863 Test Loss: 0.363 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9807848930358887
Epoch: 3, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.425 Vali Acc: 0.863 Test Loss: 0.425 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4398560523986816
Epoch: 4, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.341 Vali Acc: 0.874 Test Loss: 0.341 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3355052471160889
Epoch: 5, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.406 Vali Acc: 0.840 Test Loss: 0.406 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4829773902893066
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.402 Vali Acc: 0.799 Test Loss: 0.402 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3900775909423828
Epoch: 7, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.359 Vali Acc: 0.857 Test Loss: 0.359 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3140699863433838
Epoch: 8, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.315 Vali Acc: 0.877 Test Loss: 0.315 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9929499626159668
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
Validation loss decreased (-0.897607 --> -0.914673).  Saving model ...
Epoch: 10 cost time: 1.208225965499878
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9249413013458252
Epoch: 11, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9371469020843506
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0334200859069824
Epoch: 13, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.458 Vali Acc: 0.843 Test Loss: 0.458 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1432292461395264
Epoch: 14, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.375 Vali Acc: 0.887 Test Loss: 0.375 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8185460567474365
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.355 Vali Acc: 0.898 Test Loss: 0.355 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.170389175415039
Epoch: 16, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.566 Vali Acc: 0.802 Test Loss: 0.566 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9640698432922363
Epoch: 17, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.446 Vali Acc: 0.874 Test Loss: 0.446 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9867804050445557
Epoch: 18, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.658 Vali Acc: 0.778 Test Loss: 0.658 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8516192436218262
Epoch: 19, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.497 Vali Acc: 0.840 Test Loss: 0.497 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps82_str82_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 37453058
model size : 157.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps90_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9877054691314697
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
Validation loss decreased (inf --> -0.866891).  Saving model ...
Epoch: 2 cost time: 2.0191571712493896
Epoch: 2, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.399 Vali Acc: 0.898 Test Loss: 0.399 Test Acc: 0.898
Validation loss decreased (-0.866891 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 1.2983863353729248
Epoch: 3, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.457 Vali Acc: 0.843 Test Loss: 0.457 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6302695274353027
Epoch: 4, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.543 Vali Acc: 0.758 Test Loss: 0.543 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0944008827209473
Epoch: 5, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.392 Vali Acc: 0.840 Test Loss: 0.392 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5904412269592285
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.420 Vali Acc: 0.823 Test Loss: 0.420 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1206097602844238
Epoch: 7, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.509 Vali Acc: 0.761 Test Loss: 0.509 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2642488479614258
Epoch: 8, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.564 Vali Acc: 0.785 Test Loss: 0.564 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.353184461593628
Epoch: 9, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.461 Vali Acc: 0.768 Test Loss: 0.461 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9724016189575195
Epoch: 10, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.404 Vali Acc: 0.836 Test Loss: 0.404 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7432422637939453
Epoch: 11, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.349 Vali Acc: 0.881 Test Loss: 0.349 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9597554206848145
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.386 Vali Acc: 0.860 Test Loss: 0.386 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps90_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37643522
model size : 158.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0898118019104004
Epoch: 1, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.311 Vali Acc: 0.898 Test Loss: 0.311 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.919304609298706
Epoch: 2, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.340 Vali Acc: 0.904 Test Loss: 0.340 Test Acc: 0.904
Validation loss decreased (-0.897608 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 2.017774820327759
Epoch: 3, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2861042022705078
Epoch: 4, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0152018070220947
Epoch: 5, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.306 Vali Acc: 0.898 Test Loss: 0.306 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3103265762329102
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.312 Vali Acc: 0.898 Test Loss: 0.312 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0314769744873047
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.394 Vali Acc: 0.846 Test Loss: 0.394 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5543525218963623
Epoch: 8, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.624 Vali Acc: 0.730 Test Loss: 0.624 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.01608943939209
Epoch: 9, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.354 Vali Acc: 0.874 Test Loss: 0.354 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1465060710906982
Epoch: 10, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.559 Vali Acc: 0.703 Test Loss: 0.559 Test Acc: 0.703
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5314223766326904
Epoch: 11, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.617 Vali Acc: 0.785 Test Loss: 0.617 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4165163040161133
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.635 Vali Acc: 0.686 Test Loss: 0.635 Test Acc: 0.686
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 37588226
model size : 158.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps90_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.957491159439087
Epoch: 1, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 0.9348444938659668
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
Validation loss decreased (-0.883955 --> -0.904434).  Saving model ...
Epoch: 3 cost time: 0.9763238430023193
Epoch: 3, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.365 Vali Acc: 0.894 Test Loss: 0.365 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0554780960083008
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0962238311767578
Epoch: 5, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.304 Vali Acc: 0.870 Test Loss: 0.304 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0890254974365234
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.288 Vali Acc: 0.884 Test Loss: 0.288 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.020198106765747
Epoch: 7, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.422 Vali Acc: 0.826 Test Loss: 0.422 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.074671745300293
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0008044242858887
Epoch: 9, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.333 Vali Acc: 0.887 Test Loss: 0.333 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.019974946975708
Epoch: 10, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.444 Vali Acc: 0.816 Test Loss: 0.444 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9828948974609375
Epoch: 11, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.309 Vali Acc: 0.901 Test Loss: 0.309 Test Acc: 0.901
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.121657371520996
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.595 Vali Acc: 0.734 Test Loss: 0.595 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps90_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 37560578
model size : 157.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.128141403198242
Epoch: 1, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.328 Vali Acc: 0.891 Test Loss: 0.328 Test Acc: 0.891
Validation loss decreased (inf --> -0.890782).  Saving model ...
Epoch: 2 cost time: 1.3956859111785889
Epoch: 2, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.335 Vali Acc: 0.898 Test Loss: 0.335 Test Acc: 0.898
Validation loss decreased (-0.890782 --> -0.897608).  Saving model ...
Epoch: 3 cost time: 1.5518803596496582
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.501 Vali Acc: 0.648 Test Loss: 0.501 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5432765483856201
Epoch: 4, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.602 Vali Acc: 0.587 Test Loss: 0.602 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8133289813995361
Epoch: 5, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.576 Vali Acc: 0.597 Test Loss: 0.576 Test Acc: 0.597
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6945712566375732
Epoch: 6, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.119645595550537
Epoch: 7, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6618988513946533
Epoch: 8, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.537 Vali Acc: 0.662 Test Loss: 0.537 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3689563274383545
Epoch: 9, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5201561450958252
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6595563888549805
Epoch: 11, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.273 Vali Acc: 0.884 Test Loss: 0.273 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7392747402191162
Epoch: 12, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.378 Vali Acc: 0.877 Test Loss: 0.378 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37769474
model size : 158.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.491218090057373
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.348 Vali Acc: 0.898 Test Loss: 0.348 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 2.285646677017212
Epoch: 2, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.362 Vali Acc: 0.881 Test Loss: 0.362 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7386631965637207
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.352 Vali Acc: 0.887 Test Loss: 0.352 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.546231985092163
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.338 Vali Acc: 0.881 Test Loss: 0.338 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4113819599151611
Epoch: 5, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.334 Vali Acc: 0.860 Test Loss: 0.334 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3321123123168945
Epoch: 6, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.351 Vali Acc: 0.860 Test Loss: 0.351 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5138628482818604
Epoch: 7, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.489 Vali Acc: 0.819 Test Loss: 0.489 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3739261627197266
Epoch: 8, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.391 Vali Acc: 0.802 Test Loss: 0.391 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.821401596069336
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 1.000 Vali Acc: 0.597 Test Loss: 1.000 Test Acc: 0.597
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9294021129608154
Epoch: 10, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.642 Vali Acc: 0.676 Test Loss: 0.642 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.421489953994751
Epoch: 11, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.703 Vali Acc: 0.713 Test Loss: 0.703 Test Acc: 0.713
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 37720322
model size : 158.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1817872524261475
Epoch: 1, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
Validation loss decreased (inf --> -0.883956).  Saving model ...
Epoch: 2 cost time: 1.0665254592895508
Epoch: 2, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.345 Vali Acc: 0.904 Test Loss: 0.345 Test Acc: 0.904
Validation loss decreased (-0.883956 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.4159824848175049
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.341 Vali Acc: 0.884 Test Loss: 0.341 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0151281356811523
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.338 Vali Acc: 0.904 Test Loss: 0.338 Test Acc: 0.904
Validation loss decreased (-0.904433 --> -0.904433).  Saving model ...
Epoch: 5 cost time: 1.3277945518493652
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.319 Vali Acc: 0.881 Test Loss: 0.319 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0285215377807617
Epoch: 6, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3307204246520996
Epoch: 7, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.364 Vali Acc: 0.860 Test Loss: 0.364 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1511859893798828
Epoch: 8, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4324743747711182
Epoch: 9, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.496 Vali Acc: 0.765 Test Loss: 0.496 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.977393627166748
Epoch: 10, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.502 Vali Acc: 0.788 Test Loss: 0.502 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4810099601745605
Epoch: 11, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.408 Vali Acc: 0.860 Test Loss: 0.408 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0781662464141846
Epoch: 12, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.313 Vali Acc: 0.881 Test Loss: 0.313 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.339285135269165
Epoch: 13, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0083363056182861
Epoch: 14, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.364 Vali Acc: 0.898 Test Loss: 0.364 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 37695746
model size : 158.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps112_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.3220596313476562
Epoch: 1, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.352 Vali Acc: 0.881 Test Loss: 0.352 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 1.4907233715057373
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.344 Vali Acc: 0.901 Test Loss: 0.344 Test Acc: 0.901
Validation loss decreased (-0.880543 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 2.017540216445923
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.459 Vali Acc: 0.816 Test Loss: 0.459 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2631375789642334
Epoch: 4, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.419 Vali Acc: 0.829 Test Loss: 0.419 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5810794830322266
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.363 Vali Acc: 0.853 Test Loss: 0.363 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3311774730682373
Epoch: 6, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.347 Vali Acc: 0.887 Test Loss: 0.347 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7882294654846191
Epoch: 7, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.372 Vali Acc: 0.884 Test Loss: 0.372 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.674762487411499
Epoch: 8, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.345 Vali Acc: 0.857 Test Loss: 0.345 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4220125675201416
Epoch: 9, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.296 Vali Acc: 0.894 Test Loss: 0.296 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4728550910949707
Epoch: 10, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.378 Vali Acc: 0.887 Test Loss: 0.378 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7935807704925537
Epoch: 11, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.309 Vali Acc: 0.904 Test Loss: 0.309 Test Acc: 0.904
Validation loss decreased (-0.901020 --> -0.904434).  Saving model ...
Epoch: 12 cost time: 2.2315914630889893
Epoch: 12, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.506 Vali Acc: 0.737 Test Loss: 0.506 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3300626277923584
Epoch: 13, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.493 Vali Acc: 0.843 Test Loss: 0.493 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4090008735656738
Epoch: 14, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.657 Vali Acc: 0.768 Test Loss: 0.657 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2616081237792969
Epoch: 15, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.455 Vali Acc: 0.829 Test Loss: 0.455 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2884776592254639
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.507 Vali Acc: 0.853 Test Loss: 0.507 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.284949541091919
Epoch: 17, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.748 Vali Acc: 0.741 Test Loss: 0.748 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4001035690307617
Epoch: 18, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.609 Vali Acc: 0.846 Test Loss: 0.609 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.310844898223877
Epoch: 19, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.674 Vali Acc: 0.840 Test Loss: 0.674 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5566160678863525
Epoch: 20, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.664 Vali Acc: 0.870 Test Loss: 0.664 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1725189685821533
Epoch: 21, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.605 Vali Acc: 0.894 Test Loss: 0.605 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps112_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 37926146
model size : 159.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps112_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8945345878601074
Epoch: 1, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.408 Vali Acc: 0.881 Test Loss: 0.408 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 1.1963562965393066
Epoch: 2, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
Validation loss decreased (-0.880542 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 1.2764832973480225
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.376 Vali Acc: 0.922 Test Loss: 0.376 Test Acc: 0.922
Validation loss decreased (-0.890781 --> -0.921498).  Saving model ...
Epoch: 4 cost time: 1.0508902072906494
Epoch: 4, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.363 Vali Acc: 0.901 Test Loss: 0.363 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5992968082427979
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.302 Vali Acc: 0.901 Test Loss: 0.302 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0620007514953613
Epoch: 6, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9433038234710693
Epoch: 7, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.283 Vali Acc: 0.894 Test Loss: 0.283 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8864598274230957
Epoch: 8, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.371 Vali Acc: 0.863 Test Loss: 0.371 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.415644884109497
Epoch: 9, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0104918479919434
Epoch: 10, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9770324230194092
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.285 Vali Acc: 0.908 Test Loss: 0.285 Test Acc: 0.908
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0432896614074707
Epoch: 12, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.524961233139038
Epoch: 13, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.342 Vali Acc: 0.887 Test Loss: 0.342 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps112_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 37883138
model size : 159.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps112_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.732069969177246
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.402 Vali Acc: 0.887 Test Loss: 0.402 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 1.3945772647857666
Epoch: 2, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.357 Vali Acc: 0.915 Test Loss: 0.357 Test Acc: 0.915
Validation loss decreased (-0.887368 --> -0.914672).  Saving model ...
Epoch: 3 cost time: 1.0746209621429443
Epoch: 3, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.366 Vali Acc: 0.908 Test Loss: 0.366 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2961668968200684
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0589423179626465
Epoch: 5, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
Validation loss decreased (-0.914672 --> -0.921499).  Saving model ...
Epoch: 6 cost time: 0.8003098964691162
Epoch: 6, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.367 Vali Acc: 0.840 Test Loss: 0.367 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0593445301055908
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.237 Vali Acc: 0.904 Test Loss: 0.237 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9189925193786621
Epoch: 8, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.273 Vali Acc: 0.898 Test Loss: 0.273 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9352140426635742
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.524 Vali Acc: 0.758 Test Loss: 0.524 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.978388786315918
Epoch: 10, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.286 Vali Acc: 0.891 Test Loss: 0.286 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9871516227722168
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.446 Vali Acc: 0.823 Test Loss: 0.446 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0722272396087646
Epoch: 12, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0325770378112793
Epoch: 13, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8059759140014648
Epoch: 14, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.293 Vali Acc: 0.887 Test Loss: 0.293 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8672523498535156
Epoch: 15, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.370 Vali Acc: 0.887 Test Loss: 0.370 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps112_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 37861634
model size : 159.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4697136878967285
Epoch: 1, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.339 Vali Acc: 0.898 Test Loss: 0.339 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 2.0488924980163574
Epoch: 2, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4682831764221191
Epoch: 3, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.312 Vali Acc: 0.877 Test Loss: 0.312 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1196162700653076
Epoch: 4, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.118621826171875
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.329 Vali Acc: 0.867 Test Loss: 0.329 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6379590034484863
Epoch: 6, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.274 Vali Acc: 0.898 Test Loss: 0.274 Test Acc: 0.898
Validation loss decreased (-0.897608 --> -0.897608).  Saving model ...
Epoch: 7 cost time: 1.467780351638794
Epoch: 7, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.324 Vali Acc: 0.884 Test Loss: 0.324 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5031518936157227
Epoch: 8, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.540 Vali Acc: 0.741 Test Loss: 0.540 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.829719066619873
Epoch: 9, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.370 Vali Acc: 0.840 Test Loss: 0.370 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4548749923706055
Epoch: 10, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.343 Vali Acc: 0.887 Test Loss: 0.343 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4434449672698975
Epoch: 11, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.384 Vali Acc: 0.850 Test Loss: 0.384 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8762977123260498
Epoch: 12, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.439 Vali Acc: 0.836 Test Loss: 0.439 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8541488647460938
Epoch: 13, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.457 Vali Acc: 0.843 Test Loss: 0.457 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.53840708732605
Epoch: 14, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7539734840393066
Epoch: 15, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.495 Vali Acc: 0.829 Test Loss: 0.495 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.310462474822998
Epoch: 16, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.484 Vali Acc: 0.860 Test Loss: 0.484 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 38135042
model size : 160.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.577590227127075
Epoch: 1, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 1.030233383178711
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.346 Vali Acc: 0.898 Test Loss: 0.346 Test Acc: 0.898
Validation loss decreased (-0.877129 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 1.1461491584777832
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.379 Vali Acc: 0.884 Test Loss: 0.379 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0627937316894531
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0405032634735107
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.276 Vali Acc: 0.901 Test Loss: 0.276 Test Acc: 0.901
Validation loss decreased (-0.897607 --> -0.901021).  Saving model ...
Epoch: 6 cost time: 1.1532132625579834
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.373 Vali Acc: 0.843 Test Loss: 0.373 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9650650024414062
Epoch: 7, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.622 Vali Acc: 0.631 Test Loss: 0.622 Test Acc: 0.631
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.852130651473999
Epoch: 8, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.266 Vali Acc: 0.898 Test Loss: 0.266 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2523856163024902
Epoch: 9, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9961357116699219
Epoch: 10, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.391 Vali Acc: 0.843 Test Loss: 0.391 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.006864070892334
Epoch: 11, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0368213653564453
Epoch: 12, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.482 Vali Acc: 0.792 Test Loss: 0.482 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7147305011749268
Epoch: 13, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.939 Vali Acc: 0.594 Test Loss: 0.939 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9799792766571045
Epoch: 14, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.521 Vali Acc: 0.782 Test Loss: 0.521 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.555124044418335
Epoch: 15, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.329 Vali Acc: 0.901 Test Loss: 0.329 Test Acc: 0.901
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 38098178
model size : 160.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.607863426208496
Epoch: 1, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.431 Vali Acc: 0.881 Test Loss: 0.431 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 1.1292061805725098
Epoch: 2, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.377 Vali Acc: 0.891 Test Loss: 0.377 Test Acc: 0.891
Validation loss decreased (-0.880542 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 0.8830277919769287
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.341 Vali Acc: 0.901 Test Loss: 0.341 Test Acc: 0.901
Validation loss decreased (-0.890781 --> -0.901020).  Saving model ...
Epoch: 4 cost time: 1.2474374771118164
Epoch: 4, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.318 Vali Acc: 0.898 Test Loss: 0.318 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0020742416381836
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.202296495437622
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.279 Vali Acc: 0.901 Test Loss: 0.279 Test Acc: 0.901
Validation loss decreased (-0.901020 --> -0.901021).  Saving model ...
Epoch: 7 cost time: 0.934687614440918
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.495 Vali Acc: 0.795 Test Loss: 0.495 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8828425407409668
Epoch: 8, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.246 Vali Acc: 0.915 Test Loss: 0.246 Test Acc: 0.915
Validation loss decreased (-0.901021 --> -0.914673).  Saving model ...
Epoch: 9 cost time: 1.1635606288909912
Epoch: 9, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.322 Vali Acc: 0.881 Test Loss: 0.322 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9660115242004395
Epoch: 10, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.341 Vali Acc: 0.881 Test Loss: 0.341 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0386004447937012
Epoch: 11, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9639012813568115
Epoch: 12, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.475 Vali Acc: 0.846 Test Loss: 0.475 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8597080707550049
Epoch: 13, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.361 Vali Acc: 0.881 Test Loss: 0.361 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2000343799591064
Epoch: 14, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8585972785949707
Epoch: 15, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.454 Vali Acc: 0.836 Test Loss: 0.454 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9317715167999268
Epoch: 16, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9351003170013428
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.442 Vali Acc: 0.860 Test Loss: 0.442 Test Acc: 0.860
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.333132028579712
Epoch: 18, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.503 Vali Acc: 0.840 Test Loss: 0.503 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 38079746
model size : 159.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.133334159851074
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.323 Vali Acc: 0.898 Test Loss: 0.323 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.0163140296936035
Epoch: 2, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.351 Vali Acc: 0.904 Test Loss: 0.351 Test Acc: 0.904
Validation loss decreased (-0.897608 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.7014250755310059
Epoch: 3, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.429 Vali Acc: 0.840 Test Loss: 0.429 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.620110511779785
Epoch: 4, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.344 Vali Acc: 0.901 Test Loss: 0.344 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2862777709960938
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.398461103439331
Epoch: 6, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1321463584899902
Epoch: 7, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.138519525527954
Epoch: 8, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.446 Vali Acc: 0.836 Test Loss: 0.446 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.069456100463867
Epoch: 9, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.848 Vali Acc: 0.621 Test Loss: 0.848 Test Acc: 0.621
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.294140338897705
Epoch: 10, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3515241146087646
Epoch: 11, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.336 Vali Acc: 0.884 Test Loss: 0.336 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.374131441116333
Epoch: 12, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.378 Vali Acc: 0.898 Test Loss: 0.378 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 38423810
model size : 161.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.765277147293091
Epoch: 1, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.344 Vali Acc: 0.887 Test Loss: 0.344 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 1.0875887870788574
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8556547164916992
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.399 Vali Acc: 0.877 Test Loss: 0.399 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.982579231262207
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.335 Vali Acc: 0.877 Test Loss: 0.335 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.437331199645996
Epoch: 5, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
Validation loss decreased (-0.887369 --> -0.894195).  Saving model ...
Epoch: 6 cost time: 1.4936015605926514
Epoch: 6, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.402 Vali Acc: 0.857 Test Loss: 0.402 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3173232078552246
Epoch: 7, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.548835039138794
Epoch: 8, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.329 Vali Acc: 0.891 Test Loss: 0.329 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3606491088867188
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.573 Vali Acc: 0.788 Test Loss: 0.573 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6378390789031982
Epoch: 10, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.571 Vali Acc: 0.795 Test Loss: 0.571 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1902704238891602
Epoch: 11, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.432 Vali Acc: 0.860 Test Loss: 0.432 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4746472835540771
Epoch: 12, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.364 Vali Acc: 0.884 Test Loss: 0.364 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.141036033630371
Epoch: 13, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.381 Vali Acc: 0.884 Test Loss: 0.381 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8472602367401123
Epoch: 14, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.508 Vali Acc: 0.857 Test Loss: 0.508 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1682305335998535
Epoch: 15, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.341 Vali Acc: 0.904 Test Loss: 0.341 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904433).  Saving model ...
Epoch: 16 cost time: 1.248561143875122
Epoch: 16, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.726 Vali Acc: 0.809 Test Loss: 0.726 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.715724229812622
Epoch: 17, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3341758251190186
Epoch: 18, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.582 Vali Acc: 0.853 Test Loss: 0.582 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0963013172149658
Epoch: 19, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4362318515777588
Epoch: 20, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1513848304748535
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.612 Vali Acc: 0.829 Test Loss: 0.612 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4995498657226562
Epoch: 22, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.745 Vali Acc: 0.823 Test Loss: 0.745 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2785327434539795
Epoch: 23, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.515 Vali Acc: 0.877 Test Loss: 0.515 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7723207473754883
Epoch: 24, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.949 Vali Acc: 0.768 Test Loss: 0.949 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2414655685424805
Epoch: 25, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.694 Vali Acc: 0.857 Test Loss: 0.694 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 38393090
model size : 161.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0195510387420654
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.355 Vali Acc: 0.904 Test Loss: 0.355 Test Acc: 0.904
Validation loss decreased (inf --> -0.904433).  Saving model ...
Epoch: 2 cost time: 1.1852340698242188
Epoch: 2, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.355 Vali Acc: 0.911 Test Loss: 0.355 Test Acc: 0.911
Validation loss decreased (-0.904433 --> -0.911259).  Saving model ...
Epoch: 3 cost time: 0.9248113632202148
Epoch: 3, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.341 Vali Acc: 0.904 Test Loss: 0.341 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3560097217559814
Epoch: 4, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.293 Vali Acc: 0.898 Test Loss: 0.293 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.017669439315796
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.374 Vali Acc: 0.846 Test Loss: 0.374 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.097660779953003
Epoch: 6, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.309 Vali Acc: 0.898 Test Loss: 0.309 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9016890525817871
Epoch: 7, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.275 Vali Acc: 0.904 Test Loss: 0.275 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1271564960479736
Epoch: 8, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.301 Vali Acc: 0.904 Test Loss: 0.301 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0841927528381348
Epoch: 9, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.354 Vali Acc: 0.870 Test Loss: 0.354 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.068427562713623
Epoch: 10, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9208111763000488
Epoch: 11, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.335 Vali Acc: 0.887 Test Loss: 0.335 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9900040626525879
Epoch: 12, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.380 Vali Acc: 0.874 Test Loss: 0.380 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 38377730
model size : 161.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps180_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.050462245941162
Epoch: 1, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 2.266124963760376
Epoch: 2, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.371 Vali Acc: 0.860 Test Loss: 0.371 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4303648471832275
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.441 Vali Acc: 0.843 Test Loss: 0.441 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2082061767578125
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.331 Vali Acc: 0.877 Test Loss: 0.331 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0628833770751953
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.468 Vali Acc: 0.754 Test Loss: 0.468 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6329350471496582
Epoch: 6, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.536 Vali Acc: 0.768 Test Loss: 0.536 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2282483577728271
Epoch: 7, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.294 Vali Acc: 0.908 Test Loss: 0.294 Test Acc: 0.908
Validation loss decreased (-0.883955 --> -0.907847).  Saving model ...
Epoch: 8 cost time: 1.1579954624176025
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.334 Vali Acc: 0.898 Test Loss: 0.334 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2477145195007324
Epoch: 9, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.425 Vali Acc: 0.819 Test Loss: 0.425 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2399461269378662
Epoch: 10, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.406 Vali Acc: 0.874 Test Loss: 0.406 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.182485818862915
Epoch: 11, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8834331035614014
Epoch: 12, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.392 Vali Acc: 0.867 Test Loss: 0.392 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.617586612701416
Epoch: 13, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.423 Vali Acc: 0.850 Test Loss: 0.423 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.985368251800537
Epoch: 14, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.463 Vali Acc: 0.843 Test Loss: 0.463 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0976953506469727
Epoch: 15, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.382 Vali Acc: 0.874 Test Loss: 0.382 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.602269172668457
Epoch: 16, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8654913902282715
Epoch: 17, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps180_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 38826242
model size : 162.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.333423376083374
Epoch: 1, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.361 Vali Acc: 0.887 Test Loss: 0.361 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 1.2226486206054688
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.383 Vali Acc: 0.867 Test Loss: 0.383 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.586923360824585
Epoch: 3, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4837894439697266
Epoch: 4, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.363 Vali Acc: 0.840 Test Loss: 0.363 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3468947410583496
Epoch: 5, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.329 Vali Acc: 0.884 Test Loss: 0.329 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.981834888458252
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.301 Vali Acc: 0.877 Test Loss: 0.301 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3456978797912598
Epoch: 7, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.269 Vali Acc: 0.908 Test Loss: 0.269 Test Acc: 0.908
Validation loss decreased (-0.887368 --> -0.907847).  Saving model ...
Epoch: 8 cost time: 1.0873935222625732
Epoch: 8, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1889476776123047
Epoch: 9, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.398 Vali Acc: 0.843 Test Loss: 0.398 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.521009922027588
Epoch: 10, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911260).  Saving model ...
Epoch: 11 cost time: 1.5438544750213623
Epoch: 11, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.293205976486206
Epoch: 12, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0338709354400635
Epoch: 13, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4564666748046875
Epoch: 14, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.477 Vali Acc: 0.805 Test Loss: 0.477 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2927205562591553
Epoch: 15, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.320 Vali Acc: 0.901 Test Loss: 0.320 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.52009916305542
Epoch: 16, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.401 Vali Acc: 0.901 Test Loss: 0.401 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4205701351165771
Epoch: 17, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.458 Vali Acc: 0.867 Test Loss: 0.458 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6982264518737793
Epoch: 18, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.507 Vali Acc: 0.857 Test Loss: 0.507 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4175267219543457
Epoch: 19, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.463 Vali Acc: 0.887 Test Loss: 0.463 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5167286396026611
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.525 Vali Acc: 0.863 Test Loss: 0.525 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 38801666
model size : 162.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps180_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8605129718780518
Epoch: 1, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.399 Vali Acc: 0.898 Test Loss: 0.399 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.4421939849853516
Epoch: 2, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1022546291351318
Epoch: 3, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.410 Vali Acc: 0.823 Test Loss: 0.410 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1416454315185547
Epoch: 4, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.386 Vali Acc: 0.812 Test Loss: 0.386 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0051932334899902
Epoch: 5, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.235 Vali Acc: 0.918 Test Loss: 0.235 Test Acc: 0.918
Validation loss decreased (-0.897607 --> -0.918086).  Saving model ...
Epoch: 6 cost time: 1.0534038543701172
Epoch: 6, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.295 Vali Acc: 0.874 Test Loss: 0.295 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9366114139556885
Epoch: 7, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9349701404571533
Epoch: 8, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9799449443817139
Epoch: 9, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9160017967224121
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2739543914794922
Epoch: 11, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.493 Vali Acc: 0.840 Test Loss: 0.493 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3193066120147705
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1678037643432617
Epoch: 13, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.459 Vali Acc: 0.843 Test Loss: 0.459 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3039765357971191
Epoch: 14, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.365 Vali Acc: 0.908 Test Loss: 0.365 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3624920845031738
Epoch: 15, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.453 Vali Acc: 0.881 Test Loss: 0.453 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el5_dm768_df768_ps180_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 38789378
model size : 162.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps36_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7232656478881836
Epoch: 1, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.464 Vali Acc: 0.812 Test Loss: 0.464 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 3.0702390670776367
Epoch: 2, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.494 Vali Acc: 0.713 Test Loss: 0.494 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2980871200561523
Epoch: 3, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.403 Vali Acc: 0.857 Test Loss: 0.403 Test Acc: 0.857
Validation loss decreased (-0.812282 --> -0.856651).  Saving model ...
Epoch: 4 cost time: 2.6581366062164307
Epoch: 4, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.388 Vali Acc: 0.860 Test Loss: 0.388 Test Acc: 0.860
Validation loss decreased (-0.856651 --> -0.860064).  Saving model ...
Epoch: 5 cost time: 2.138608455657959
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
Validation loss decreased (-0.860064 --> -0.877129).  Saving model ...
Epoch: 6 cost time: 2.1782846450805664
Epoch: 6, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.533 Vali Acc: 0.785 Test Loss: 0.533 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.20097017288208
Epoch: 7, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.212998628616333
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.612 Vali Acc: 0.765 Test Loss: 0.612 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.204012155532837
Epoch: 9, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.378 Vali Acc: 0.887 Test Loss: 0.378 Test Acc: 0.887
Validation loss decreased (-0.877129 --> -0.887368).  Saving model ...
Epoch: 10 cost time: 2.988205909729004
Epoch: 10, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.235250234603882
Epoch: 11, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.630 Vali Acc: 0.778 Test Loss: 0.630 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2185797691345215
Epoch: 12, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
Validation loss decreased (-0.887368 --> -0.890781).  Saving model ...
Epoch: 13 cost time: 2.961780548095703
Epoch: 13, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.715 Vali Acc: 0.829 Test Loss: 0.715 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8625738620758057
Epoch: 14, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.774 Vali Acc: 0.853 Test Loss: 0.774 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3236823081970215
Epoch: 15, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.782 Vali Acc: 0.805 Test Loss: 0.782 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.547314167022705
Epoch: 16, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.638 Vali Acc: 0.843 Test Loss: 0.638 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.457235813140869
Epoch: 17, Steps: 17 | Train Loss: 0.307 Vali Loss: 1.764 Vali Acc: 0.662 Test Loss: 1.764 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4288992881774902
Epoch: 18, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.645 Vali Acc: 0.857 Test Loss: 0.645 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.149040460586548
Epoch: 19, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.260591745376587
Epoch: 20, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.687 Vali Acc: 0.857 Test Loss: 0.687 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.112452745437622
Epoch: 21, Steps: 17 | Train Loss: 0.239 Vali Loss: 1.407 Vali Acc: 0.805 Test Loss: 1.407 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1768391132354736
Epoch: 22, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.310 Vali Acc: 0.833 Test Loss: 1.310 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps36_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 29993474
model size : 129.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.15630316734314
Epoch: 1, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.333 Vali Acc: 0.881 Test Loss: 0.333 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 2.3821842670440674
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.525 Vali Acc: 0.703 Test Loss: 0.525 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.787139415740967
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.382 Vali Acc: 0.898 Test Loss: 0.382 Test Acc: 0.898
Validation loss decreased (-0.880543 --> -0.897607).  Saving model ...
Epoch: 4 cost time: 1.5549426078796387
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.353 Vali Acc: 0.857 Test Loss: 0.353 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3056678771972656
Epoch: 5, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.461 Vali Acc: 0.799 Test Loss: 0.461 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5354773998260498
Epoch: 6, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.622 Vali Acc: 0.717 Test Loss: 0.622 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.558582305908203
Epoch: 7, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.449 Vali Acc: 0.812 Test Loss: 0.449 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7408809661865234
Epoch: 8, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.472 Vali Acc: 0.727 Test Loss: 0.472 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.354262351989746
Epoch: 9, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.756 Vali Acc: 0.638 Test Loss: 0.756 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6729912757873535
Epoch: 10, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.553 Vali Acc: 0.703 Test Loss: 0.553 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.552480697631836
Epoch: 11, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.488 Vali Acc: 0.826 Test Loss: 0.488 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8416919708251953
Epoch: 12, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.430 Vali Acc: 0.809 Test Loss: 0.430 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3033294677734375
Epoch: 13, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.311 Vali Acc: 0.901 Test Loss: 0.311 Test Acc: 0.901
Validation loss decreased (-0.897607 --> -0.901021).  Saving model ...
Epoch: 14 cost time: 1.568347454071045
Epoch: 14, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.349 Vali Acc: 0.887 Test Loss: 0.349 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.064634084701538
Epoch: 15, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.376 Vali Acc: 0.901 Test Loss: 0.376 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8075776100158691
Epoch: 16, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.319 Vali Acc: 0.908 Test Loss: 0.319 Test Acc: 0.908
Validation loss decreased (-0.901021 --> -0.907847).  Saving model ...
Epoch: 17 cost time: 0.906635046005249
Epoch: 17, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.443 Vali Acc: 0.870 Test Loss: 0.443 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8722953796386719
Epoch: 18, Steps: 17 | Train Loss: 0.380 Vali Loss: 1.463 Vali Acc: 0.737 Test Loss: 1.463 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1464564800262451
Epoch: 19, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.556 Vali Acc: 0.874 Test Loss: 0.556 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.230396032333374
Epoch: 20, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.586 Vali Acc: 0.846 Test Loss: 0.586 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8328065872192383
Epoch: 21, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.501 Vali Acc: 0.877 Test Loss: 0.501 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7739784717559814
Epoch: 22, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.472 Vali Acc: 0.901 Test Loss: 0.472 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6258652210235596
Epoch: 23, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.580 Vali Acc: 0.877 Test Loss: 0.580 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9237165451049805
Epoch: 24, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.822 Vali Acc: 0.863 Test Loss: 0.822 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.785788059234619
Epoch: 25, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.125 Vali Acc: 0.785 Test Loss: 1.125 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.09100079536438
Epoch: 26, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.856 Vali Acc: 0.792 Test Loss: 0.856 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 29846018
model size : 128.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps36_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.346918821334839
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 1.4021553993225098
Epoch: 2, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.382 Vali Acc: 0.898 Test Loss: 0.382 Test Acc: 0.898
Validation loss decreased (-0.877129 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 2.0532586574554443
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.355 Vali Acc: 0.887 Test Loss: 0.355 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.578718662261963
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9742300510406494
Epoch: 5, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.664 Vali Acc: 0.611 Test Loss: 0.664 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4227757453918457
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.302 Vali Acc: 0.894 Test Loss: 0.302 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7938580513000488
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7086036205291748
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.416 Vali Acc: 0.819 Test Loss: 0.416 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6930909156799316
Epoch: 9, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.713 Vali Acc: 0.683 Test Loss: 0.713 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1119906902313232
Epoch: 10, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.273 Vali Acc: 0.901 Test Loss: 0.273 Test Acc: 0.901
Validation loss decreased (-0.897607 --> -0.901021).  Saving model ...
Epoch: 11 cost time: 1.2198927402496338
Epoch: 11, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.297 Vali Acc: 0.891 Test Loss: 0.297 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.090106725692749
Epoch: 12, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.294 Vali Acc: 0.898 Test Loss: 0.294 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0265820026397705
Epoch: 13, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.404 Vali Acc: 0.853 Test Loss: 0.404 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.162827968597412
Epoch: 14, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.305 Vali Acc: 0.894 Test Loss: 0.305 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1603071689605713
Epoch: 15, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
Validation loss decreased (-0.901021 --> -0.921499).  Saving model ...
Epoch: 16 cost time: 1.1573991775512695
Epoch: 16, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.353 Vali Acc: 0.881 Test Loss: 0.353 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2788481712341309
Epoch: 17, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.429 Vali Acc: 0.836 Test Loss: 0.429 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2802953720092773
Epoch: 18, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.485 Vali Acc: 0.863 Test Loss: 0.485 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2926273345947266
Epoch: 19, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.891 Vali Acc: 0.730 Test Loss: 0.891 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0492675304412842
Epoch: 20, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.396 Vali Acc: 0.713 Test Loss: 1.396 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.210991382598877
Epoch: 21, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.663 Vali Acc: 0.812 Test Loss: 0.663 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2488930225372314
Epoch: 22, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.429 Vali Acc: 0.881 Test Loss: 0.429 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8767361640930176
Epoch: 23, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4802143573760986
Epoch: 24, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.659 Vali Acc: 0.826 Test Loss: 0.659 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.06772780418396
Epoch: 25, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.701 Vali Acc: 0.802 Test Loss: 0.701 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps36_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 29772290
model size : 128.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps38_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.429016590118408
Epoch: 1, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.385 Vali Acc: 0.894 Test Loss: 0.385 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 1.6968259811401367
Epoch: 2, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.452 Vali Acc: 0.758 Test Loss: 0.452 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.920940637588501
Epoch: 3, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.655 Vali Acc: 0.614 Test Loss: 0.655 Test Acc: 0.614
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.044644594192505
Epoch: 4, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.355 Vali Acc: 0.850 Test Loss: 0.355 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.947331428527832
Epoch: 5, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.378 Vali Acc: 0.799 Test Loss: 0.378 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8574421405792236
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.95776629447937
Epoch: 7, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.244 Vali Acc: 0.918 Test Loss: 0.244 Test Acc: 0.918
Validation loss decreased (-0.894194 --> -0.918086).  Saving model ...
Epoch: 8 cost time: 2.0521340370178223
Epoch: 8, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.682 Vali Acc: 0.706 Test Loss: 0.682 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.597308874130249
Epoch: 9, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.69344425201416
Epoch: 10, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.328 Vali Acc: 0.904 Test Loss: 0.328 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8633573055267334
Epoch: 11, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.454 Vali Acc: 0.799 Test Loss: 0.454 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.278273582458496
Epoch: 12, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9942889213562012
Epoch: 13, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5705177783966064
Epoch: 14, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.565 Vali Acc: 0.799 Test Loss: 0.565 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9948110580444336
Epoch: 15, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.491 Vali Acc: 0.884 Test Loss: 0.491 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5905263423919678
Epoch: 16, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.998 Vali Acc: 0.809 Test Loss: 0.998 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.659963846206665
Epoch: 17, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.615 Vali Acc: 0.884 Test Loss: 0.615 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps38_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 29990402
model size : 129.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.96585750579834
Epoch: 1, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
Validation loss decreased (inf --> -0.890782).  Saving model ...
Epoch: 2 cost time: 1.0423438549041748
Epoch: 2, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.538 Vali Acc: 0.720 Test Loss: 0.538 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8709557056427002
Epoch: 3, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.428 Vali Acc: 0.802 Test Loss: 0.428 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3381524085998535
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.325 Vali Acc: 0.887 Test Loss: 0.325 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5559942722320557
Epoch: 5, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.307 Vali Acc: 0.877 Test Loss: 0.307 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9934852123260498
Epoch: 6, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.308 Vali Acc: 0.901 Test Loss: 0.308 Test Acc: 0.901
Validation loss decreased (-0.890782 --> -0.901021).  Saving model ...
Epoch: 7 cost time: 1.7587382793426514
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6436831951141357
Epoch: 8, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.551 Vali Acc: 0.700 Test Loss: 0.551 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9340720176696777
Epoch: 9, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.448 Vali Acc: 0.836 Test Loss: 0.448 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.507842779159546
Epoch: 10, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.491 Vali Acc: 0.823 Test Loss: 0.491 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6917319297790527
Epoch: 11, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.441 Vali Acc: 0.829 Test Loss: 0.441 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5799288749694824
Epoch: 12, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.318 Vali Acc: 0.898 Test Loss: 0.318 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.5425682067871094
Epoch: 13, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.575 Vali Acc: 0.843 Test Loss: 0.575 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8683726787567139
Epoch: 14, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.536928415298462
Epoch: 15, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.747 Vali Acc: 0.758 Test Loss: 0.747 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8950505256652832
Epoch: 16, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.675 Vali Acc: 0.853 Test Loss: 0.675 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 29867522
model size : 128.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps38_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5271387100219727
Epoch: 1, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.350 Vali Acc: 0.874 Test Loss: 0.350 Test Acc: 0.874
Validation loss decreased (inf --> -0.873717).  Saving model ...
Epoch: 2 cost time: 1.4547686576843262
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.327 Vali Acc: 0.915 Test Loss: 0.327 Test Acc: 0.915
Validation loss decreased (-0.873717 --> -0.914672).  Saving model ...
Epoch: 3 cost time: 1.9915030002593994
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.438 Vali Acc: 0.795 Test Loss: 0.438 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.598949909210205
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9643564224243164
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5873277187347412
Epoch: 6, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.261 Vali Acc: 0.904 Test Loss: 0.261 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2611889839172363
Epoch: 7, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.300 Vali Acc: 0.904 Test Loss: 0.300 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.494173526763916
Epoch: 8, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.246 Vali Acc: 0.908 Test Loss: 0.246 Test Acc: 0.908
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.312697172164917
Epoch: 9, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.2416810989379883
Epoch: 10, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.278 Vali Acc: 0.904 Test Loss: 0.278 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.968996524810791
Epoch: 11, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.450 Vali Acc: 0.782 Test Loss: 0.450 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2182207107543945
Epoch: 12, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.352 Vali Acc: 0.850 Test Loss: 0.352 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps38_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 29796866
model size : 128.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.6152584552764893
Epoch: 1, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.399 Vali Acc: 0.829 Test Loss: 0.399 Test Acc: 0.829
Validation loss decreased (inf --> -0.829348).  Saving model ...
Epoch: 2 cost time: 2.0353329181671143
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.446 Vali Acc: 0.805 Test Loss: 0.446 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.03782057762146
Epoch: 3, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.334 Vali Acc: 0.894 Test Loss: 0.334 Test Acc: 0.894
Validation loss decreased (-0.829348 --> -0.894195).  Saving model ...
Epoch: 4 cost time: 1.97306489944458
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.423 Vali Acc: 0.788 Test Loss: 0.423 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1059281826019287
Epoch: 5, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.426 Vali Acc: 0.816 Test Loss: 0.426 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6503541469573975
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.305 Vali Acc: 0.898 Test Loss: 0.305 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 7 cost time: 1.8708641529083252
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.776 Vali Acc: 0.717 Test Loss: 0.776 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5975189208984375
Epoch: 8, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.362 Vali Acc: 0.836 Test Loss: 0.362 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6730918884277344
Epoch: 9, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.417 Vali Acc: 0.823 Test Loss: 0.417 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3787403106689453
Epoch: 10, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.398 Vali Acc: 0.857 Test Loss: 0.398 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.186952590942383
Epoch: 11, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
Validation loss decreased (-0.897608 --> -0.911260).  Saving model ...
Epoch: 12 cost time: 1.2832801342010498
Epoch: 12, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.446 Vali Acc: 0.826 Test Loss: 0.446 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2892050743103027
Epoch: 13, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.11018967628479
Epoch: 14, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.547 Vali Acc: 0.823 Test Loss: 0.547 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2831776142120361
Epoch: 15, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.751 Vali Acc: 0.741 Test Loss: 0.751 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.858907699584961
Epoch: 16, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.667 Vali Acc: 0.853 Test Loss: 0.667 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1113483905792236
Epoch: 17, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9911479949951172
Epoch: 18, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.512 Vali Acc: 0.894 Test Loss: 0.512 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.823878526687622
Epoch: 19, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.703 Vali Acc: 0.826 Test Loss: 0.703 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8453845977783203
Epoch: 20, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.203 Vali Acc: 0.792 Test Loss: 1.203 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6467039585113525
Epoch: 21, Steps: 17 | Train Loss: 0.192 Vali Loss: 1.446 Vali Acc: 0.744 Test Loss: 1.446 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 30004226
model size : 129.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.261157989501953
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
Validation loss decreased (inf --> -0.877130).  Saving model ...
Epoch: 2 cost time: 2.0266966819763184
Epoch: 2, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.436 Vali Acc: 0.805 Test Loss: 0.436 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.597882032394409
Epoch: 3, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.339 Vali Acc: 0.884 Test Loss: 0.339 Test Acc: 0.884
Validation loss decreased (-0.877130 --> -0.883956).  Saving model ...
Epoch: 4 cost time: 1.6595618724822998
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8192288875579834
Epoch: 5, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.294 Vali Acc: 0.884 Test Loss: 0.294 Test Acc: 0.884
Validation loss decreased (-0.883956 --> -0.883956).  Saving model ...
Epoch: 6 cost time: 1.7977294921875
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.339 Vali Acc: 0.863 Test Loss: 0.339 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5992846488952637
Epoch: 7, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.456 Vali Acc: 0.795 Test Loss: 0.456 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2942845821380615
Epoch: 8, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.333 Vali Acc: 0.870 Test Loss: 0.333 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.220384120941162
Epoch: 9, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.818 Vali Acc: 0.703 Test Loss: 0.818 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9508001804351807
Epoch: 10, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.450 Vali Acc: 0.846 Test Loss: 0.450 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5077340602874756
Epoch: 11, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.669 Vali Acc: 0.785 Test Loss: 0.669 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0531961917877197
Epoch: 12, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.330 Vali Acc: 0.881 Test Loss: 0.330 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6327877044677734
Epoch: 13, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.411 Vali Acc: 0.860 Test Loss: 0.411 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2283077239990234
Epoch: 14, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.429 Vali Acc: 0.898 Test Loss: 0.429 Test Acc: 0.898
Validation loss decreased (-0.883956 --> -0.897607).  Saving model ...
Epoch: 15 cost time: 2.0419509410858154
Epoch: 15, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.648 Vali Acc: 0.840 Test Loss: 0.648 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6602208614349365
Epoch: 16, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.605 Vali Acc: 0.829 Test Loss: 0.605 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.566424608230591
Epoch: 17, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.281 Vali Acc: 0.734 Test Loss: 1.281 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7142210006713867
Epoch: 18, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.604 Vali Acc: 0.881 Test Loss: 0.604 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.482297420501709
Epoch: 19, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.693 Vali Acc: 0.867 Test Loss: 0.693 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6169705390930176
Epoch: 20, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.644 Vali Acc: 0.867 Test Loss: 0.644 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.476881980895996
Epoch: 21, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.624 Vali Acc: 0.874 Test Loss: 0.624 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7584407329559326
Epoch: 22, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.560 Vali Acc: 0.884 Test Loss: 0.560 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1721787452697754
Epoch: 23, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.192519187927246
Epoch: 24, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.154 Vali Acc: 0.788 Test Loss: 1.154 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 29872130
model size : 128.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4929065704345703
Epoch: 1, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.432 Vali Acc: 0.850 Test Loss: 0.432 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 1.9624361991882324
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.364 Vali Acc: 0.857 Test Loss: 0.364 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856652).  Saving model ...
Epoch: 3 cost time: 1.5583322048187256
Epoch: 3, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.499 Vali Acc: 0.792 Test Loss: 0.499 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.959181308746338
Epoch: 4, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.305 Vali Acc: 0.881 Test Loss: 0.305 Test Acc: 0.881
Validation loss decreased (-0.856652 --> -0.880543).  Saving model ...
Epoch: 5 cost time: 1.3488056659698486
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.285 Vali Acc: 0.901 Test Loss: 0.285 Test Acc: 0.901
Validation loss decreased (-0.880543 --> -0.901021).  Saving model ...
Epoch: 6 cost time: 1.354804515838623
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7165093421936035
Epoch: 7, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.382 Vali Acc: 0.819 Test Loss: 0.382 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.708364725112915
Epoch: 8, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.335 Vali Acc: 0.881 Test Loss: 0.335 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4970779418945312
Epoch: 9, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.434 Vali Acc: 0.836 Test Loss: 0.434 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7376422882080078
Epoch: 10, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.405 Vali Acc: 0.805 Test Loss: 0.405 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3740580081939697
Epoch: 11, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.420 Vali Acc: 0.816 Test Loss: 0.420 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0412163734436035
Epoch: 12, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.497 Vali Acc: 0.802 Test Loss: 0.497 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5320515632629395
Epoch: 13, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.324 Vali Acc: 0.898 Test Loss: 0.324 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2408928871154785
Epoch: 14, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.526 Vali Acc: 0.829 Test Loss: 0.526 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5423479080200195
Epoch: 15, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.479 Vali Acc: 0.805 Test Loss: 0.479 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 29807618
model size : 128.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.792099952697754
Epoch: 1, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.343 Vali Acc: 0.898 Test Loss: 0.343 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 2.0003201961517334
Epoch: 2, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.583 Vali Acc: 0.734 Test Loss: 0.583 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7224104404449463
Epoch: 3, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.622 Vali Acc: 0.638 Test Loss: 0.622 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5630478858947754
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.421 Vali Acc: 0.778 Test Loss: 0.421 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6855061054229736
Epoch: 5, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.364 Vali Acc: 0.887 Test Loss: 0.364 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6691341400146484
Epoch: 6, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.98689866065979
Epoch: 7, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.352 Vali Acc: 0.870 Test Loss: 0.352 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5123836994171143
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.404 Vali Acc: 0.829 Test Loss: 0.404 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8391690254211426
Epoch: 9, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.520 Vali Acc: 0.795 Test Loss: 0.520 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.506671667098999
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.327 Vali Acc: 0.901 Test Loss: 0.327 Test Acc: 0.901
Validation loss decreased (-0.897607 --> -0.901021).  Saving model ...
Epoch: 11 cost time: 2.0252673625946045
Epoch: 11, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.569 Vali Acc: 0.802 Test Loss: 0.569 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2189230918884277
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.472 Vali Acc: 0.860 Test Loss: 0.472 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6866955757141113
Epoch: 13, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.730 Vali Acc: 0.812 Test Loss: 0.730 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2044482231140137
Epoch: 14, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.506 Vali Acc: 0.860 Test Loss: 0.506 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.597349166870117
Epoch: 15, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.30556583404541
Epoch: 16, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.838 Vali Acc: 0.782 Test Loss: 0.838 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9279987812042236
Epoch: 17, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.768 Vali Acc: 0.812 Test Loss: 0.768 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6571681499481201
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.006612539291382
Epoch: 19, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.791 Vali Acc: 0.771 Test Loss: 0.791 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7622499465942383
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.429 Vali Acc: 0.747 Test Loss: 1.429 Test Acc: 0.747
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 30007298
model size : 129.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0530848503112793
Epoch: 1, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.358 Vali Acc: 0.894 Test Loss: 0.358 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 1.5216107368469238
Epoch: 2, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.469 Vali Acc: 0.823 Test Loss: 0.469 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9711039066314697
Epoch: 3, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.453 Vali Acc: 0.792 Test Loss: 0.453 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7089016437530518
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.392 Vali Acc: 0.823 Test Loss: 0.392 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6087255477905273
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.308 Vali Acc: 0.884 Test Loss: 0.308 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.926299810409546
Epoch: 6, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.487 Vali Acc: 0.775 Test Loss: 0.487 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8106017112731934
Epoch: 7, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.321 Vali Acc: 0.894 Test Loss: 0.321 Test Acc: 0.894
Validation loss decreased (-0.894194 --> -0.894195).  Saving model ...
Epoch: 8 cost time: 1.9421308040618896
Epoch: 8, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.261 Vali Acc: 0.891 Test Loss: 0.261 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.556502342224121
Epoch: 9, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.325 Vali Acc: 0.894 Test Loss: 0.325 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.237703800201416
Epoch: 10, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.350 Vali Acc: 0.863 Test Loss: 0.350 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3613131046295166
Epoch: 11, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.337 Vali Acc: 0.881 Test Loss: 0.337 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2847414016723633
Epoch: 12, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.362 Vali Acc: 0.904 Test Loss: 0.362 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904433).  Saving model ...
Epoch: 13 cost time: 1.3747749328613281
Epoch: 13, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5511672496795654
Epoch: 14, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.536 Vali Acc: 0.826 Test Loss: 0.536 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3095982074737549
Epoch: 15, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.840 Vali Acc: 0.785 Test Loss: 0.840 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6520836353302002
Epoch: 16, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.372 Vali Acc: 0.891 Test Loss: 0.372 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1264615058898926
Epoch: 17, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.529 Vali Acc: 0.836 Test Loss: 0.529 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6938257217407227
Epoch: 18, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.853 Vali Acc: 0.836 Test Loss: 0.853 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6912493705749512
Epoch: 19, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.576141595840454
Epoch: 20, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.609 Vali Acc: 0.867 Test Loss: 0.609 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6329710483551025
Epoch: 21, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.643 Vali Acc: 0.853 Test Loss: 0.643 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.505272388458252
Epoch: 22, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.017 Vali Acc: 0.843 Test Loss: 1.017 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 29893634
model size : 128.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5649917125701904
Epoch: 1, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.447 Vali Acc: 0.877 Test Loss: 0.447 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 0.934882402420044
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.358 Vali Acc: 0.898 Test Loss: 0.358 Test Acc: 0.898
Validation loss decreased (-0.877129 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 0.8598988056182861
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.354 Vali Acc: 0.850 Test Loss: 0.354 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0579936504364014
Epoch: 4, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.323 Vali Acc: 0.877 Test Loss: 0.323 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2934069633483887
Epoch: 5, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.325 Vali Acc: 0.877 Test Loss: 0.325 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9041404724121094
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.395 Vali Acc: 0.775 Test Loss: 0.395 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2690091133117676
Epoch: 7, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.718397855758667
Epoch: 8, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.558 Vali Acc: 0.765 Test Loss: 0.558 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0976276397705078
Epoch: 9, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.405 Vali Acc: 0.846 Test Loss: 0.405 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3372001647949219
Epoch: 10, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.304 Vali Acc: 0.863 Test Loss: 0.304 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.195112943649292
Epoch: 11, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.311 Vali Acc: 0.857 Test Loss: 0.311 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.525822401046753
Epoch: 12, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.319 Vali Acc: 0.874 Test Loss: 0.319 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 29832194
model size : 128.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps43_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8351335525512695
Epoch: 1, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.320 Vali Acc: 0.884 Test Loss: 0.320 Test Acc: 0.884
Validation loss decreased (inf --> -0.883956).  Saving model ...
Epoch: 2 cost time: 1.6343011856079102
Epoch: 2, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.475536823272705
Epoch: 3, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.515 Vali Acc: 0.788 Test Loss: 0.515 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0265116691589355
Epoch: 4, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
Validation loss decreased (-0.883956 --> -0.890782).  Saving model ...
Epoch: 5 cost time: 2.0136406421661377
Epoch: 5, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.864 Vali Acc: 0.543 Test Loss: 0.864 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.119704246520996
Epoch: 6, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.853130578994751
Epoch: 7, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7475597858428955
Epoch: 8, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.255 Vali Acc: 0.908 Test Loss: 0.255 Test Acc: 0.908
Validation loss decreased (-0.890782 --> -0.907847).  Saving model ...
Epoch: 9 cost time: 1.9262161254882812
Epoch: 9, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.364 Vali Acc: 0.853 Test Loss: 0.364 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7350282669067383
Epoch: 10, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.308 Vali Acc: 0.901 Test Loss: 0.308 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.734178066253662
Epoch: 11, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.486 Vali Acc: 0.792 Test Loss: 0.486 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7027363777160645
Epoch: 12, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.500 Vali Acc: 0.805 Test Loss: 0.500 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7280197143554688
Epoch: 13, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.575 Vali Acc: 0.758 Test Loss: 0.575 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5587401390075684
Epoch: 14, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.765 Vali Acc: 0.782 Test Loss: 0.765 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5089914798736572
Epoch: 15, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8199727535247803
Epoch: 16, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8711202144622803
Epoch: 17, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.486 Vali Acc: 0.795 Test Loss: 0.486 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.875253438949585
Epoch: 18, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.770 Vali Acc: 0.805 Test Loss: 0.770 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps43_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 30034946
model size : 129.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps43_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7217133045196533
Epoch: 1, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.387 Vali Acc: 0.863 Test Loss: 0.387 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 1.3542487621307373
Epoch: 2, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
Validation loss decreased (-0.863477 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 1.153212070465088
Epoch: 3, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.387 Vali Acc: 0.857 Test Loss: 0.387 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.517853021621704
Epoch: 4, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.374 Vali Acc: 0.860 Test Loss: 0.374 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2123818397521973
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.328 Vali Acc: 0.898 Test Loss: 0.328 Test Acc: 0.898
Validation loss decreased (-0.890781 --> -0.897608).  Saving model ...
Epoch: 6 cost time: 1.0459740161895752
Epoch: 6, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.369 Vali Acc: 0.853 Test Loss: 0.369 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4632470607757568
Epoch: 7, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.340 Vali Acc: 0.891 Test Loss: 0.340 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2137935161590576
Epoch: 8, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.415 Vali Acc: 0.863 Test Loss: 0.415 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1693370342254639
Epoch: 9, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.395 Vali Acc: 0.874 Test Loss: 0.395 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1878650188446045
Epoch: 10, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.417285680770874
Epoch: 11, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.442 Vali Acc: 0.887 Test Loss: 0.442 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.677107334136963
Epoch: 12, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1275653839111328
Epoch: 13, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.549 Vali Acc: 0.840 Test Loss: 0.549 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7343518733978271
Epoch: 14, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.603 Vali Acc: 0.846 Test Loss: 0.603 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6164801120758057
Epoch: 15, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.990 Vali Acc: 0.768 Test Loss: 0.990 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps43_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 29915138
model size : 128.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps43_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0205063819885254
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.389 Vali Acc: 0.894 Test Loss: 0.389 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 0.9882211685180664
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.386 Vali Acc: 0.901 Test Loss: 0.386 Test Acc: 0.901
Validation loss decreased (-0.894194 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.6190268993377686
Epoch: 3, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.389 Vali Acc: 0.898 Test Loss: 0.389 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2219994068145752
Epoch: 4, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3225009441375732
Epoch: 5, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.334 Vali Acc: 0.863 Test Loss: 0.334 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5230450630187988
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.312 Vali Acc: 0.870 Test Loss: 0.312 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6098828315734863
Epoch: 7, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2279787063598633
Epoch: 8, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
Validation loss decreased (-0.901020 --> -0.914673).  Saving model ...
Epoch: 9 cost time: 1.3682830333709717
Epoch: 9, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.274 Vali Acc: 0.887 Test Loss: 0.274 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2068796157836914
Epoch: 10, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9402902126312256
Epoch: 11, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1102375984191895
Epoch: 12, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.311 Vali Acc: 0.884 Test Loss: 0.311 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.750845193862915
Epoch: 13, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.678 Vali Acc: 0.696 Test Loss: 0.678 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8762986660003662
Epoch: 14, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.406 Vali Acc: 0.826 Test Loss: 0.406 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8648731708526611
Epoch: 15, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.326 Vali Acc: 0.894 Test Loss: 0.326 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9825453758239746
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.373 Vali Acc: 0.884 Test Loss: 0.373 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9722855091094971
Epoch: 17, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.341 Vali Acc: 0.898 Test Loss: 0.341 Test Acc: 0.898
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9489481449127197
Epoch: 18, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.530 Vali Acc: 0.778 Test Loss: 0.530 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps43_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 29856770
model size : 128.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.173846960067749
Epoch: 1, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.376 Vali Acc: 0.867 Test Loss: 0.376 Test Acc: 0.867
Validation loss decreased (inf --> -0.866890).  Saving model ...
Epoch: 2 cost time: 2.188591718673706
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.334 Vali Acc: 0.887 Test Loss: 0.334 Test Acc: 0.887
Validation loss decreased (-0.866890 --> -0.887369).  Saving model ...
Epoch: 3 cost time: 1.5124375820159912
Epoch: 3, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.361 Vali Acc: 0.887 Test Loss: 0.361 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.796210527420044
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.493 Vali Acc: 0.669 Test Loss: 0.493 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8455660343170166
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.342 Vali Acc: 0.867 Test Loss: 0.342 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4077086448669434
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7090167999267578
Epoch: 7, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4841256141662598
Epoch: 8, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.471 Vali Acc: 0.874 Test Loss: 0.471 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2960543632507324
Epoch: 9, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.328 Vali Acc: 0.863 Test Loss: 0.328 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9558167457580566
Epoch: 10, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.299 Vali Acc: 0.884 Test Loss: 0.299 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9879531860351562
Epoch: 11, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.531 Vali Acc: 0.853 Test Loss: 0.531 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.073103427886963
Epoch: 12, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.295 Vali Acc: 0.901 Test Loss: 0.295 Test Acc: 0.901
Validation loss decreased (-0.887369 --> -0.901021).  Saving model ...
Epoch: 13 cost time: 1.72086501121521
Epoch: 13, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.584 Vali Acc: 0.799 Test Loss: 0.584 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3532030582427979
Epoch: 14, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.10302734375
Epoch: 15, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.456815481185913
Epoch: 16, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0905439853668213
Epoch: 17, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.359 Vali Acc: 0.737 Test Loss: 1.359 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.807476282119751
Epoch: 18, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.869 Vali Acc: 0.761 Test Loss: 0.869 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.817894697189331
Epoch: 19, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6744577884674072
Epoch: 20, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.289 Vali Acc: 0.737 Test Loss: 1.289 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0386390686035156
Epoch: 21, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.099 Vali Acc: 0.802 Test Loss: 1.099 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7920515537261963
Epoch: 22, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.593 Vali Acc: 0.874 Test Loss: 0.593 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 30041090
model size : 129.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.65183687210083
Epoch: 1, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.383 Vali Acc: 0.891 Test Loss: 0.383 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 1.6863293647766113
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.461 Vali Acc: 0.744 Test Loss: 0.461 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3825101852416992
Epoch: 3, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.349 Vali Acc: 0.874 Test Loss: 0.349 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.828930377960205
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.498 Vali Acc: 0.843 Test Loss: 0.498 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.486133337020874
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.315 Vali Acc: 0.887 Test Loss: 0.315 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8777973651885986
Epoch: 6, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.270 Vali Acc: 0.884 Test Loss: 0.270 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4267878532409668
Epoch: 7, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.285 Vali Acc: 0.887 Test Loss: 0.285 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.534080982208252
Epoch: 8, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.296 Vali Acc: 0.904 Test Loss: 0.296 Test Acc: 0.904
Validation loss decreased (-0.890781 --> -0.904434).  Saving model ...
Epoch: 9 cost time: 1.3593533039093018
Epoch: 9, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.283 Vali Acc: 0.891 Test Loss: 0.283 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4145023822784424
Epoch: 10, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.714 Vali Acc: 0.788 Test Loss: 0.714 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.280522108078003
Epoch: 11, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.332 Vali Acc: 0.881 Test Loss: 0.332 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1816825866699219
Epoch: 12, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.396 Vali Acc: 0.874 Test Loss: 0.396 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2183678150177002
Epoch: 13, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0850508213043213
Epoch: 14, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.435 Vali Acc: 0.863 Test Loss: 0.435 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9463326930999756
Epoch: 15, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.454 Vali Acc: 0.867 Test Loss: 0.454 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.170236349105835
Epoch: 16, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.535 Vali Acc: 0.870 Test Loss: 0.535 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4944090843200684
Epoch: 17, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.701 Vali Acc: 0.826 Test Loss: 0.701 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3541228771209717
Epoch: 18, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.494 Vali Acc: 0.884 Test Loss: 0.494 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 29939714
model size : 128.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.4028053283691406
Epoch: 1, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.404 Vali Acc: 0.863 Test Loss: 0.404 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 0.9475152492523193
Epoch: 2, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
Validation loss decreased (-0.863477 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 1.1668450832366943
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5040862560272217
Epoch: 4, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.396 Vali Acc: 0.853 Test Loss: 0.396 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2020280361175537
Epoch: 5, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.309 Vali Acc: 0.874 Test Loss: 0.309 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2730047702789307
Epoch: 6, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.325 Vali Acc: 0.898 Test Loss: 0.325 Test Acc: 0.898
Validation loss decreased (-0.894194 --> -0.897608).  Saving model ...
Epoch: 7 cost time: 0.9892599582672119
Epoch: 7, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9099700450897217
Epoch: 8, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.298 Vali Acc: 0.901 Test Loss: 0.298 Test Acc: 0.901
Validation loss decreased (-0.897608 --> -0.901021).  Saving model ...
Epoch: 9 cost time: 0.9213542938232422
Epoch: 9, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.324 Vali Acc: 0.874 Test Loss: 0.324 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5699727535247803
Epoch: 10, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.307 Vali Acc: 0.898 Test Loss: 0.307 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1277596950531006
Epoch: 11, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.419 Vali Acc: 0.850 Test Loss: 0.419 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8825056552886963
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9918828010559082
Epoch: 13, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.334 Vali Acc: 0.901 Test Loss: 0.334 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.346390962600708
Epoch: 14, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.521 Vali Acc: 0.710 Test Loss: 0.521 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5611283779144287
Epoch: 15, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.518 Vali Acc: 0.840 Test Loss: 0.518 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1027939319610596
Epoch: 16, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.406 Vali Acc: 0.891 Test Loss: 0.406 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.266646146774292
Epoch: 17, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.749 Vali Acc: 0.792 Test Loss: 0.749 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8820793628692627
Epoch: 18, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.522 Vali Acc: 0.843 Test Loss: 0.522 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 29881346
model size : 128.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7560291290283203
Epoch: 1, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
Validation loss decreased (inf --> -0.836174).  Saving model ...
Epoch: 2 cost time: 2.0141689777374268
Epoch: 2, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.417 Vali Acc: 0.840 Test Loss: 0.417 Test Acc: 0.840
Validation loss decreased (-0.836174 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 1.7760536670684814
Epoch: 3, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.333 Vali Acc: 0.887 Test Loss: 0.333 Test Acc: 0.887
Validation loss decreased (-0.839586 --> -0.887369).  Saving model ...
Epoch: 4 cost time: 1.445155382156372
Epoch: 4, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.448 Vali Acc: 0.765 Test Loss: 0.448 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.900447130203247
Epoch: 5, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.481 Vali Acc: 0.713 Test Loss: 0.481 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.03206729888916
Epoch: 6, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.444 Vali Acc: 0.809 Test Loss: 0.444 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3839778900146484
Epoch: 7, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.400 Vali Acc: 0.870 Test Loss: 0.400 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.555851936340332
Epoch: 8, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.613 Vali Acc: 0.765 Test Loss: 0.613 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6754627227783203
Epoch: 9, Steps: 17 | Train Loss: 0.357 Vali Loss: 1.207 Vali Acc: 0.645 Test Loss: 1.207 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6060121059417725
Epoch: 10, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.750 Vali Acc: 0.638 Test Loss: 0.750 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5528783798217773
Epoch: 11, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.500 Vali Acc: 0.812 Test Loss: 0.500 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5276803970336914
Epoch: 12, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.736 Vali Acc: 0.782 Test Loss: 0.736 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1051409244537354
Epoch: 13, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.661 Vali Acc: 0.823 Test Loss: 0.661 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 30082562
model size : 129.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.4150588512420654
Epoch: 1, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.351 Vali Acc: 0.901 Test Loss: 0.351 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 1.15976881980896
Epoch: 2, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1797356605529785
Epoch: 3, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.320 Vali Acc: 0.891 Test Loss: 0.320 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1964638233184814
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.432 Vali Acc: 0.741 Test Loss: 0.432 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1451940536499023
Epoch: 5, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.330 Vali Acc: 0.870 Test Loss: 0.330 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6504223346710205
Epoch: 6, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.391 Vali Acc: 0.754 Test Loss: 0.391 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1444120407104492
Epoch: 7, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.292 Vali Acc: 0.884 Test Loss: 0.292 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2185418605804443
Epoch: 8, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.686 Vali Acc: 0.706 Test Loss: 0.686 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3432128429412842
Epoch: 9, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.447 Vali Acc: 0.747 Test Loss: 0.447 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4526822566986084
Epoch: 10, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.331 Vali Acc: 0.863 Test Loss: 0.331 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.235288381576538
Epoch: 11, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.288 Vali Acc: 0.884 Test Loss: 0.288 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 29975042
model size : 129.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.415088176727295
Epoch: 1, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.346 Vali Acc: 0.898 Test Loss: 0.346 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.415498971939087
Epoch: 2, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.367 Vali Acc: 0.904 Test Loss: 0.367 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.5922489166259766
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.415 Vali Acc: 0.853 Test Loss: 0.415 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1607251167297363
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.166165828704834
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.340 Vali Acc: 0.898 Test Loss: 0.340 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3344922065734863
Epoch: 6, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.280 Vali Acc: 0.891 Test Loss: 0.280 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.080169677734375
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.236 Vali Acc: 0.908 Test Loss: 0.236 Test Acc: 0.908
Validation loss decreased (-0.904433 --> -0.907847).  Saving model ...
Epoch: 8 cost time: 1.0854573249816895
Epoch: 8, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.280 Vali Acc: 0.904 Test Loss: 0.280 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0277938842773438
Epoch: 9, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
Validation loss decreased (-0.907847 --> -0.914673).  Saving model ...
Epoch: 10 cost time: 1.2656760215759277
Epoch: 10, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.370 Vali Acc: 0.867 Test Loss: 0.370 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.578324556350708
Epoch: 11, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.365 Vali Acc: 0.863 Test Loss: 0.365 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.479173183441162
Epoch: 12, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.346 Vali Acc: 0.881 Test Loss: 0.346 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6129894256591797
Epoch: 13, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.356 Vali Acc: 0.887 Test Loss: 0.356 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9639248847961426
Epoch: 14, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.408 Vali Acc: 0.863 Test Loss: 0.408 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9815411567687988
Epoch: 15, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8633406162261963
Epoch: 16, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2138488292694092
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.620 Vali Acc: 0.826 Test Loss: 0.620 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1262316703796387
Epoch: 18, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.558 Vali Acc: 0.795 Test Loss: 0.558 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0140933990478516
Epoch: 19, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 29919746
model size : 128.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2053818702697754
Epoch: 1, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.336 Vali Acc: 0.894 Test Loss: 0.336 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 2.053872585296631
Epoch: 2, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.643 Vali Acc: 0.669 Test Loss: 0.643 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5726206302642822
Epoch: 3, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.376 Vali Acc: 0.860 Test Loss: 0.376 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4212610721588135
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.354 Vali Acc: 0.860 Test Loss: 0.354 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.710850715637207
Epoch: 5, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.328 Vali Acc: 0.904 Test Loss: 0.328 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904434).  Saving model ...
Epoch: 6 cost time: 2.1484129428863525
Epoch: 6, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5872490406036377
Epoch: 7, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.303 Vali Acc: 0.898 Test Loss: 0.303 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8357443809509277
Epoch: 8, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.457 Vali Acc: 0.744 Test Loss: 0.457 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5308151245117188
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.422 Vali Acc: 0.734 Test Loss: 0.422 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8472838401794434
Epoch: 10, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.379 Vali Acc: 0.853 Test Loss: 0.379 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.71026611328125
Epoch: 11, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.345 Vali Acc: 0.894 Test Loss: 0.345 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7519936561584473
Epoch: 12, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.347 Vali Acc: 0.881 Test Loss: 0.347 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3858308792114258
Epoch: 13, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.434 Vali Acc: 0.853 Test Loss: 0.434 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.610419750213623
Epoch: 14, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.707 Vali Acc: 0.765 Test Loss: 0.707 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.734705924987793
Epoch: 15, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.528 Vali Acc: 0.819 Test Loss: 0.528 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 30094850
model size : 129.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.829373598098755
Epoch: 1, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.400 Vali Acc: 0.857 Test Loss: 0.400 Test Acc: 0.857
Validation loss decreased (inf --> -0.856651).  Saving model ...
Epoch: 2 cost time: 1.4977326393127441
Epoch: 2, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.433 Vali Acc: 0.881 Test Loss: 0.433 Test Acc: 0.881
Validation loss decreased (-0.856651 --> -0.880542).  Saving model ...
Epoch: 3 cost time: 1.3167307376861572
Epoch: 3, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.381 Vali Acc: 0.887 Test Loss: 0.381 Test Acc: 0.887
Validation loss decreased (-0.880542 --> -0.887368).  Saving model ...
Epoch: 4 cost time: 1.1975328922271729
Epoch: 4, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.323469877243042
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3083491325378418
Epoch: 6, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.353 Vali Acc: 0.863 Test Loss: 0.353 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5120620727539062
Epoch: 7, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.429 Vali Acc: 0.836 Test Loss: 0.429 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.360502004623413
Epoch: 8, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.343 Vali Acc: 0.877 Test Loss: 0.343 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4955127239227295
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.303 Vali Acc: 0.894 Test Loss: 0.303 Test Acc: 0.894
Validation loss decreased (-0.887368 --> -0.894195).  Saving model ...
Epoch: 10 cost time: 1.1263349056243896
Epoch: 10, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.356 Vali Acc: 0.904 Test Loss: 0.356 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904433).  Saving model ...
Epoch: 11 cost time: 1.4068982601165771
Epoch: 11, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.249 Vali Acc: 0.904 Test Loss: 0.249 Test Acc: 0.904
Validation loss decreased (-0.904433 --> -0.904434).  Saving model ...
Epoch: 12 cost time: 1.1114459037780762
Epoch: 12, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.584 Vali Acc: 0.792 Test Loss: 0.584 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.262040138244629
Epoch: 13, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.665 Vali Acc: 0.751 Test Loss: 0.665 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9662573337554932
Epoch: 14, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.475 Vali Acc: 0.816 Test Loss: 0.475 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6300685405731201
Epoch: 15, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.518 Vali Acc: 0.857 Test Loss: 0.518 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7731378078460693
Epoch: 16, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.727 Vali Acc: 0.812 Test Loss: 0.727 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6814696788787842
Epoch: 17, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5671658515930176
Epoch: 18, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.001 Vali Acc: 0.744 Test Loss: 1.001 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7064392566680908
Epoch: 19, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.983 Vali Acc: 0.785 Test Loss: 0.983 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3529455661773682
Epoch: 20, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.681 Vali Acc: 0.799 Test Loss: 0.681 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2167468070983887
Epoch: 21, Steps: 17 | Train Loss: 0.161 Vali Loss: 1.649 Vali Acc: 0.601 Test Loss: 1.649 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 29996546
model size : 129.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.2166635990142822
Epoch: 1, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.406 Vali Acc: 0.874 Test Loss: 0.406 Test Acc: 0.874
Validation loss decreased (inf --> -0.873716).  Saving model ...
Epoch: 2 cost time: 0.9482936859130859
Epoch: 2, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.873716 --> -0.924911).  Saving model ...
Epoch: 3 cost time: 1.390007495880127
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.364 Vali Acc: 0.901 Test Loss: 0.364 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0400588512420654
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.381312608718872
Epoch: 5, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.310 Vali Acc: 0.887 Test Loss: 0.310 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0834884643554688
Epoch: 6, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5661554336547852
Epoch: 7, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.268 Vali Acc: 0.898 Test Loss: 0.268 Test Acc: 0.898
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3680756092071533
Epoch: 8, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.294 Vali Acc: 0.887 Test Loss: 0.294 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7971665859222412
Epoch: 9, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.274 Vali Acc: 0.894 Test Loss: 0.274 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.653684139251709
Epoch: 10, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.299 Vali Acc: 0.874 Test Loss: 0.299 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7322659492492676
Epoch: 11, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.295 Vali Acc: 0.901 Test Loss: 0.295 Test Acc: 0.901
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8490116596221924
Epoch: 12, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.382 Vali Acc: 0.857 Test Loss: 0.382 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9249146757679181
model parameter : 29944322
model size : 128.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2398204803466797
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.340 Vali Acc: 0.898 Test Loss: 0.340 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.3938758373260498
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.694 Vali Acc: 0.560 Test Loss: 0.694 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2215149402618408
Epoch: 3, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.387 Vali Acc: 0.846 Test Loss: 0.387 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3964319229125977
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6153769493103027
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.786426305770874
Epoch: 6, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.336 Vali Acc: 0.857 Test Loss: 0.336 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2763328552246094
Epoch: 7, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.328 Vali Acc: 0.908 Test Loss: 0.328 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907847).  Saving model ...
Epoch: 8 cost time: 1.8883540630340576
Epoch: 8, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4178740978240967
Epoch: 9, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.402 Vali Acc: 0.867 Test Loss: 0.402 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6388905048370361
Epoch: 10, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.294 Vali Acc: 0.908 Test Loss: 0.294 Test Acc: 0.908
Validation loss decreased (-0.907847 --> -0.907847).  Saving model ...
Epoch: 11 cost time: 1.5858213901519775
Epoch: 11, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.463 Vali Acc: 0.836 Test Loss: 0.463 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0114641189575195
Epoch: 12, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.434 Vali Acc: 0.843 Test Loss: 0.434 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6986515522003174
Epoch: 13, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.786 Vali Acc: 0.805 Test Loss: 0.786 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2867202758789062
Epoch: 14, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.462 Vali Acc: 0.901 Test Loss: 0.462 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.789841890335083
Epoch: 15, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.452 Vali Acc: 0.860 Test Loss: 0.452 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3336679935455322
Epoch: 16, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.518 Vali Acc: 0.881 Test Loss: 0.518 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.740051031112671
Epoch: 17, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.526 Vali Acc: 0.898 Test Loss: 0.526 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5779638290405273
Epoch: 18, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.623 Vali Acc: 0.758 Test Loss: 0.623 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9671146869659424
Epoch: 19, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.758 Vali Acc: 0.846 Test Loss: 0.758 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6901090145111084
Epoch: 20, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 30120962
model size : 129.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7633087635040283
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.338 Vali Acc: 0.887 Test Loss: 0.338 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 1.4759924411773682
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.490 Vali Acc: 0.662 Test Loss: 0.490 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2814390659332275
Epoch: 3, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
Validation loss decreased (-0.887369 --> -0.890781).  Saving model ...
Epoch: 4 cost time: 1.3184130191802979
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.148026466369629
Epoch: 5, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.691 Vali Acc: 0.580 Test Loss: 0.691 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0039312839508057
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.313 Vali Acc: 0.898 Test Loss: 0.313 Test Acc: 0.898
Validation loss decreased (-0.890781 --> -0.897608).  Saving model ...
Epoch: 7 cost time: 1.1368379592895508
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.382 Vali Acc: 0.829 Test Loss: 0.382 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6703877449035645
Epoch: 8, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.426 Vali Acc: 0.812 Test Loss: 0.426 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6845297813415527
Epoch: 9, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.535 Vali Acc: 0.775 Test Loss: 0.535 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1111245155334473
Epoch: 10, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.320 Vali Acc: 0.904 Test Loss: 0.320 Test Acc: 0.904
Validation loss decreased (-0.897608 --> -0.904434).  Saving model ...
Epoch: 11 cost time: 1.7860288619995117
Epoch: 11, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.360 Vali Acc: 0.884 Test Loss: 0.360 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.098203182220459
Epoch: 12, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.371 Vali Acc: 0.894 Test Loss: 0.371 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6069798469543457
Epoch: 13, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.437 Vali Acc: 0.857 Test Loss: 0.437 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.208785057067871
Epoch: 14, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.411 Vali Acc: 0.874 Test Loss: 0.411 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.258859395980835
Epoch: 15, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.364 Vali Acc: 0.887 Test Loss: 0.364 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2282450199127197
Epoch: 16, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8060379028320312
Epoch: 17, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.419 Vali Acc: 0.874 Test Loss: 0.419 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8047752380371094
Epoch: 18, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.762 Vali Acc: 0.754 Test Loss: 0.762 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9855735301971436
Epoch: 19, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.763 Vali Acc: 0.792 Test Loss: 0.763 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6780226230621338
Epoch: 20, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.543 Vali Acc: 0.863 Test Loss: 0.543 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 30031874
model size : 129.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.118597984313965
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 1.3105525970458984
Epoch: 2, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.380 Vali Acc: 0.874 Test Loss: 0.380 Test Acc: 0.874
Validation loss decreased (-0.819108 --> -0.873716).  Saving model ...
Epoch: 3 cost time: 1.3135395050048828
Epoch: 3, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.361 Vali Acc: 0.898 Test Loss: 0.361 Test Acc: 0.898
Validation loss decreased (-0.873716 --> -0.897607).  Saving model ...
Epoch: 4 cost time: 1.5717456340789795
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.340 Vali Acc: 0.881 Test Loss: 0.340 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.178879737854004
Epoch: 5, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.117231845855713
Epoch: 6, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4467594623565674
Epoch: 7, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.329 Vali Acc: 0.887 Test Loss: 0.329 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.022127628326416
Epoch: 8, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.311 Vali Acc: 0.874 Test Loss: 0.311 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.963752031326294
Epoch: 9, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.474 Vali Acc: 0.785 Test Loss: 0.474 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8140418529510498
Epoch: 10, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.349 Vali Acc: 0.904 Test Loss: 0.349 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904433).  Saving model ...
Epoch: 11 cost time: 0.7796313762664795
Epoch: 11, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.491 Vali Acc: 0.846 Test Loss: 0.491 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3759851455688477
Epoch: 12, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.428 Vali Acc: 0.877 Test Loss: 0.428 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8274209499359131
Epoch: 13, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.519 Vali Acc: 0.823 Test Loss: 0.519 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5259654521942139
Epoch: 14, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.418 Vali Acc: 0.887 Test Loss: 0.418 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1954808235168457
Epoch: 15, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.465 Vali Acc: 0.887 Test Loss: 0.465 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1318204402923584
Epoch: 16, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.406 Vali Acc: 0.911 Test Loss: 0.406 Test Acc: 0.911
Validation loss decreased (-0.904433 --> -0.911259).  Saving model ...
Epoch: 17 cost time: 1.042520523071289
Epoch: 17, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.492 Vali Acc: 0.843 Test Loss: 0.492 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.155261754989624
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.835 Vali Acc: 0.802 Test Loss: 0.835 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.199641466140747
Epoch: 19, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.776 Vali Acc: 0.823 Test Loss: 0.776 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9486711025238037
Epoch: 20, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.635 Vali Acc: 0.840 Test Loss: 0.635 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0886991024017334
Epoch: 21, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.764 Vali Acc: 0.805 Test Loss: 0.764 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1863296031951904
Epoch: 22, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.846 Vali Acc: 0.819 Test Loss: 0.846 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0665361881256104
Epoch: 23, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.636 Vali Acc: 0.870 Test Loss: 0.636 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1941063404083252
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.821 Vali Acc: 0.850 Test Loss: 0.821 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.473367691040039
Epoch: 25, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.960 Vali Acc: 0.826 Test Loss: 0.960 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1897742748260498
Epoch: 26, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.878 Vali Acc: 0.850 Test Loss: 0.878 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 29982722
model size : 129.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps56_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.00083065032959
Epoch: 1, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.361 Vali Acc: 0.881 Test Loss: 0.361 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 2.35445237159729
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.426 Vali Acc: 0.874 Test Loss: 0.426 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.926814079284668
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.524 Vali Acc: 0.618 Test Loss: 0.524 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9023613929748535
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.481 Vali Acc: 0.792 Test Loss: 0.481 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0660457611083984
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0989837646484375
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.591 Vali Acc: 0.747 Test Loss: 0.591 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.582693099975586
Epoch: 7, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.439 Vali Acc: 0.782 Test Loss: 0.439 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.984084129333496
Epoch: 8, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.451 Vali Acc: 0.812 Test Loss: 0.451 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9708411693573
Epoch: 9, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.399 Vali Acc: 0.887 Test Loss: 0.399 Test Acc: 0.887
Validation loss decreased (-0.880542 --> -0.887368).  Saving model ...
Epoch: 10 cost time: 3.1867353916168213
Epoch: 10, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.496 Vali Acc: 0.840 Test Loss: 0.496 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.282456874847412
Epoch: 11, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.604 Vali Acc: 0.792 Test Loss: 0.604 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7273316383361816
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.532 Vali Acc: 0.898 Test Loss: 0.532 Test Acc: 0.898
Validation loss decreased (-0.887368 --> -0.897606).  Saving model ...
Epoch: 13 cost time: 2.464907646179199
Epoch: 13, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.646 Vali Acc: 0.826 Test Loss: 0.646 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.402785539627075
Epoch: 14, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.583 Vali Acc: 0.843 Test Loss: 0.583 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6892220973968506
Epoch: 15, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.714 Vali Acc: 0.843 Test Loss: 0.714 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5275120735168457
Epoch: 16, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.842 Vali Acc: 0.795 Test Loss: 0.842 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.534053087234497
Epoch: 17, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.567 Vali Acc: 0.881 Test Loss: 0.567 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3175625801086426
Epoch: 18, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.936 Vali Acc: 0.785 Test Loss: 0.936 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1977810859680176
Epoch: 19, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.479 Vali Acc: 0.706 Test Loss: 1.479 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4532499313354492
Epoch: 20, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.259 Vali Acc: 0.734 Test Loss: 1.259 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9474897384643555
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.158 Vali Acc: 0.765 Test Loss: 1.158 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2253177165985107
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.270 Vali Acc: 0.782 Test Loss: 1.270 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps56_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 30162434
model size : 129.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps56_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8495383262634277
Epoch: 1, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.340 Vali Acc: 0.908 Test Loss: 0.340 Test Acc: 0.908
Validation loss decreased (inf --> -0.907846).  Saving model ...
Epoch: 2 cost time: 1.4786274433135986
Epoch: 2, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5852134227752686
Epoch: 3, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.343 Vali Acc: 0.901 Test Loss: 0.343 Test Acc: 0.901
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0469534397125244
Epoch: 4, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.398 Vali Acc: 0.853 Test Loss: 0.398 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1253793239593506
Epoch: 5, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.367 Vali Acc: 0.857 Test Loss: 0.367 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0232574939727783
Epoch: 6, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.272 Vali Acc: 0.891 Test Loss: 0.272 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.972665548324585
Epoch: 7, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.268 Vali Acc: 0.898 Test Loss: 0.268 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3420495986938477
Epoch: 8, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.505 Vali Acc: 0.775 Test Loss: 0.505 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3360462188720703
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.661 Vali Acc: 0.696 Test Loss: 0.661 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3007023334503174
Epoch: 10, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.238 Vali Acc: 0.908 Test Loss: 0.238 Test Acc: 0.908
Validation loss decreased (-0.907846 --> -0.907847).  Saving model ...
Epoch: 11 cost time: 1.2060158252716064
Epoch: 11, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911260).  Saving model ...
Epoch: 12 cost time: 1.3829920291900635
Epoch: 12, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.376 Vali Acc: 0.846 Test Loss: 0.376 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3207948207855225
Epoch: 13, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.360377550125122
Epoch: 14, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.654 Vali Acc: 0.761 Test Loss: 0.654 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0711967945098877
Epoch: 15, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2405028343200684
Epoch: 16, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.289 Vali Acc: 0.908 Test Loss: 0.289 Test Acc: 0.908
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3328957557678223
Epoch: 17, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.450 Vali Acc: 0.860 Test Loss: 0.450 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2919025421142578
Epoch: 18, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.296396255493164
Epoch: 19, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.634 Vali Acc: 0.788 Test Loss: 0.634 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3092522621154785
Epoch: 20, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.601 Vali Acc: 0.823 Test Loss: 0.601 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1251707077026367
Epoch: 21, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps56_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 30070274
model size : 129.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps56_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0123565196990967
Epoch: 1, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.417 Vali Acc: 0.901 Test Loss: 0.417 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 1.114391803741455
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.347 Vali Acc: 0.901 Test Loss: 0.347 Test Acc: 0.901
Validation loss decreased (-0.901020 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.7912940979003906
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.405 Vali Acc: 0.870 Test Loss: 0.405 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4226481914520264
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.309 Vali Acc: 0.877 Test Loss: 0.309 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8731257915496826
Epoch: 5, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.380 Vali Acc: 0.860 Test Loss: 0.380 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1178269386291504
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
Validation loss decreased (-0.901020 --> -0.911260).  Saving model ...
Epoch: 7 cost time: 1.3602015972137451
Epoch: 7, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.321 Vali Acc: 0.867 Test Loss: 0.321 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3403103351593018
Epoch: 8, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.467 Vali Acc: 0.758 Test Loss: 0.467 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9746425151824951
Epoch: 9, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.61381196975708
Epoch: 10, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.299 Vali Acc: 0.887 Test Loss: 0.299 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3745405673980713
Epoch: 11, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.607 Vali Acc: 0.761 Test Loss: 0.607 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.234468936920166
Epoch: 12, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9032676219940186
Epoch: 13, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.577 Vali Acc: 0.805 Test Loss: 0.577 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3927257061004639
Epoch: 14, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.339 Vali Acc: 0.901 Test Loss: 0.339 Test Acc: 0.901
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6356801986694336
Epoch: 15, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.313622236251831
Epoch: 16, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.450 Vali Acc: 0.850 Test Loss: 0.450 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps56_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 30024194
model size : 129.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.137455224990845
Epoch: 1, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.353 Vali Acc: 0.874 Test Loss: 0.353 Test Acc: 0.874
Validation loss decreased (inf --> -0.873717).  Saving model ...
Epoch: 2 cost time: 2.4918746948242188
Epoch: 2, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.414 Vali Acc: 0.857 Test Loss: 0.414 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3061227798461914
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
Validation loss decreased (-0.873717 --> -0.877129).  Saving model ...
Epoch: 4 cost time: 2.4532275199890137
Epoch: 4, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.400 Vali Acc: 0.816 Test Loss: 0.400 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.778353214263916
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.420 Vali Acc: 0.812 Test Loss: 0.420 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9508252143859863
Epoch: 6, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.366 Vali Acc: 0.863 Test Loss: 0.366 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.481494426727295
Epoch: 7, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.322 Vali Acc: 0.881 Test Loss: 0.322 Test Acc: 0.881
Validation loss decreased (-0.877129 --> -0.880543).  Saving model ...
Epoch: 8 cost time: 1.7035987377166748
Epoch: 8, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7524070739746094
Epoch: 9, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
Validation loss decreased (-0.880543 --> -0.911260).  Saving model ...
Epoch: 10 cost time: 2.532961368560791
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.344 Vali Acc: 0.884 Test Loss: 0.344 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7704107761383057
Epoch: 11, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.808 Vali Acc: 0.700 Test Loss: 0.808 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.39040207862854
Epoch: 12, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.691 Vali Acc: 0.710 Test Loss: 0.691 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.254324436187744
Epoch: 13, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.467 Vali Acc: 0.823 Test Loss: 0.467 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.627640724182129
Epoch: 14, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.388 Vali Acc: 0.867 Test Loss: 0.388 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1189513206481934
Epoch: 15, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.570 Vali Acc: 0.799 Test Loss: 0.570 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.875020980834961
Epoch: 16, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.478 Vali Acc: 0.843 Test Loss: 0.478 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4044573307037354
Epoch: 17, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.732 Vali Acc: 0.782 Test Loss: 0.732 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3041248321533203
Epoch: 18, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2780423164367676
Epoch: 19, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.796 Vali Acc: 0.799 Test Loss: 0.796 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 30202370
model size : 129.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3920557498931885
Epoch: 1, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.330 Vali Acc: 0.904 Test Loss: 0.330 Test Acc: 0.904
Validation loss decreased (inf --> -0.904434).  Saving model ...
Epoch: 2 cost time: 1.1195178031921387
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.343 Vali Acc: 0.898 Test Loss: 0.343 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6329481601715088
Epoch: 3, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.402 Vali Acc: 0.853 Test Loss: 0.402 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2454307079315186
Epoch: 4, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.562 Vali Acc: 0.638 Test Loss: 0.562 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5944769382476807
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.129317283630371
Epoch: 6, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.253 Vali Acc: 0.901 Test Loss: 0.253 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0479254722595215
Epoch: 7, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3786065578460693
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5595214366912842
Epoch: 9, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.402 Vali Acc: 0.843 Test Loss: 0.402 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6062617301940918
Epoch: 10, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3149619102478027
Epoch: 11, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.356 Vali Acc: 0.894 Test Loss: 0.356 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 30116354
model size : 129.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.934650182723999
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.399 Vali Acc: 0.898 Test Loss: 0.399 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.054584264755249
Epoch: 2, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.372 Vali Acc: 0.904 Test Loss: 0.372 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.4232711791992188
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.493 Vali Acc: 0.802 Test Loss: 0.493 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.39286470413208
Epoch: 4, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.340 Vali Acc: 0.898 Test Loss: 0.340 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4775965213775635
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.359 Vali Acc: 0.877 Test Loss: 0.359 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8798394203186035
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9206552505493164
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1426434516906738
Epoch: 8, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.481 Vali Acc: 0.737 Test Loss: 0.481 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2793622016906738
Epoch: 9, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.389 Vali Acc: 0.857 Test Loss: 0.389 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1001012325286865
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.300 Vali Acc: 0.894 Test Loss: 0.300 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0571558475494385
Epoch: 11, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.263915777206421
Epoch: 12, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.663 Vali Acc: 0.788 Test Loss: 0.663 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 30073346
model size : 129.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8816330432891846
Epoch: 1, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.361 Vali Acc: 0.881 Test Loss: 0.361 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 1.424551248550415
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.469 Vali Acc: 0.696 Test Loss: 0.469 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0212130546569824
Epoch: 3, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.433 Vali Acc: 0.785 Test Loss: 0.433 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.547919273376465
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.394 Vali Acc: 0.853 Test Loss: 0.394 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7392442226409912
Epoch: 5, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.384 Vali Acc: 0.846 Test Loss: 0.384 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2991280555725098
Epoch: 6, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.290 Vali Acc: 0.901 Test Loss: 0.290 Test Acc: 0.901
Validation loss decreased (-0.880542 --> -0.901021).  Saving model ...
Epoch: 7 cost time: 2.4317479133605957
Epoch: 7, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.340 Vali Acc: 0.908 Test Loss: 0.340 Test Acc: 0.908
Validation loss decreased (-0.901021 --> -0.907846).  Saving model ...
Epoch: 8 cost time: 2.1422266960144043
Epoch: 8, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.315 Vali Acc: 0.884 Test Loss: 0.315 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4135398864746094
Epoch: 9, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.312 Vali Acc: 0.908 Test Loss: 0.312 Test Acc: 0.908
Validation loss decreased (-0.907846 --> -0.907847).  Saving model ...
Epoch: 10 cost time: 2.5164661407470703
Epoch: 10, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.381 Vali Acc: 0.857 Test Loss: 0.381 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1839993000030518
Epoch: 11, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.383662223815918
Epoch: 12, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.368 Vali Acc: 0.874 Test Loss: 0.368 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.298647165298462
Epoch: 13, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.598 Vali Acc: 0.836 Test Loss: 0.598 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3670213222503662
Epoch: 14, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.502 Vali Acc: 0.823 Test Loss: 0.502 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.272273063659668
Epoch: 15, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.455 Vali Acc: 0.826 Test Loss: 0.455 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.297624111175537
Epoch: 16, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.768 Vali Acc: 0.812 Test Loss: 0.768 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5357637405395508
Epoch: 17, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.598 Vali Acc: 0.833 Test Loss: 0.598 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.131469964981079
Epoch: 18, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.483 Vali Acc: 0.867 Test Loss: 0.483 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5894737243652344
Epoch: 19, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.733 Vali Acc: 0.795 Test Loss: 0.733 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 30248450
model size : 130.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.636852264404297
Epoch: 1, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.352 Vali Acc: 0.874 Test Loss: 0.352 Test Acc: 0.874
Validation loss decreased (inf --> -0.873717).  Saving model ...
Epoch: 2 cost time: 1.1740152835845947
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.452 Vali Acc: 0.836 Test Loss: 0.452 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3214237689971924
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.354 Vali Acc: 0.877 Test Loss: 0.354 Test Acc: 0.877
Validation loss decreased (-0.873717 --> -0.877130).  Saving model ...
Epoch: 4 cost time: 1.6056389808654785
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3795976638793945
Epoch: 5, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.402 Vali Acc: 0.860 Test Loss: 0.402 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.252227544784546
Epoch: 6, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.473 Vali Acc: 0.829 Test Loss: 0.473 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8235914707183838
Epoch: 7, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1748931407928467
Epoch: 8, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.675 Vali Acc: 0.747 Test Loss: 0.675 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.504248857498169
Epoch: 9, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.421 Vali Acc: 0.850 Test Loss: 0.421 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1453347206115723
Epoch: 10, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.691 Vali Acc: 0.782 Test Loss: 0.691 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7815761566162109
Epoch: 11, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.499 Vali Acc: 0.874 Test Loss: 0.499 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.452761173248291
Epoch: 12, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.736 Vali Acc: 0.765 Test Loss: 0.736 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3783564567565918
Epoch: 13, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.894 Vali Acc: 0.648 Test Loss: 0.894 Test Acc: 0.648
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 30168578
model size : 129.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3280692100524902
Epoch: 1, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.431 Vali Acc: 0.898 Test Loss: 0.431 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 0.9997525215148926
Epoch: 2, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.410 Vali Acc: 0.874 Test Loss: 0.410 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1404578685760498
Epoch: 3, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.357 Vali Acc: 0.901 Test Loss: 0.357 Test Acc: 0.901
Validation loss decreased (-0.897607 --> -0.901020).  Saving model ...
Epoch: 4 cost time: 1.0397238731384277
Epoch: 4, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.941279411315918
Epoch: 5, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.279 Vali Acc: 0.887 Test Loss: 0.279 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8557658195495605
Epoch: 6, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.291 Vali Acc: 0.887 Test Loss: 0.291 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6651408672332764
Epoch: 7, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.278 Vali Acc: 0.887 Test Loss: 0.278 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7489068508148193
Epoch: 8, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.319 Vali Acc: 0.887 Test Loss: 0.319 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7452971935272217
Epoch: 9, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.961 Vali Acc: 0.539 Test Loss: 0.961 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7605948448181152
Epoch: 10, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.265 Vali Acc: 0.891 Test Loss: 0.265 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9667572975158691
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.280 Vali Acc: 0.915 Test Loss: 0.280 Test Acc: 0.915
Validation loss decreased (-0.901020 --> -0.914673).  Saving model ...
Epoch: 12 cost time: 1.1690387725830078
Epoch: 12, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1641442775726318
Epoch: 13, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.419 Vali Acc: 0.836 Test Loss: 0.419 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.186152458190918
Epoch: 14, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.498 Vali Acc: 0.816 Test Loss: 0.498 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.239591360092163
Epoch: 15, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.308 Vali Acc: 0.877 Test Loss: 0.308 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8549318313598633
Epoch: 16, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.325 Vali Acc: 0.887 Test Loss: 0.325 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0329110622406006
Epoch: 17, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.324 Vali Acc: 0.887 Test Loss: 0.324 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9846291542053223
Epoch: 18, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.623 Vali Acc: 0.823 Test Loss: 0.623 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2198247909545898
Epoch: 19, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.808 Vali Acc: 0.792 Test Loss: 0.808 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4341425895690918
Epoch: 20, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.485 Vali Acc: 0.840 Test Loss: 0.485 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8793830871582031
Epoch: 21, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.389 Vali Acc: 0.894 Test Loss: 0.389 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 30128642
model size : 129.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps69_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5021510124206543
Epoch: 1, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
Validation loss decreased (inf --> -0.883956).  Saving model ...
Epoch: 2 cost time: 2.271333932876587
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1835615634918213
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.444 Vali Acc: 0.792 Test Loss: 0.444 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4342305660247803
Epoch: 4, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.355 Vali Acc: 0.840 Test Loss: 0.355 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2262728214263916
Epoch: 5, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.446 Vali Acc: 0.751 Test Loss: 0.446 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4612514972686768
Epoch: 6, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.332 Vali Acc: 0.874 Test Loss: 0.332 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3424842357635498
Epoch: 7, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.367 Vali Acc: 0.836 Test Loss: 0.367 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2463853359222412
Epoch: 8, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.314 Vali Acc: 0.881 Test Loss: 0.314 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2031807899475098
Epoch: 9, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.331 Vali Acc: 0.891 Test Loss: 0.331 Test Acc: 0.891
Validation loss decreased (-0.883956 --> -0.890782).  Saving model ...
Epoch: 10 cost time: 2.1320998668670654
Epoch: 10, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8274693489074707
Epoch: 11, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.347 Vali Acc: 0.894 Test Loss: 0.347 Test Acc: 0.894
Validation loss decreased (-0.890782 --> -0.894194).  Saving model ...
Epoch: 12 cost time: 2.118682622909546
Epoch: 12, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.564 Vali Acc: 0.758 Test Loss: 0.564 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6107456684112549
Epoch: 13, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.390 Vali Acc: 0.857 Test Loss: 0.390 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.687903881072998
Epoch: 14, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.520 Vali Acc: 0.727 Test Loss: 0.520 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.07836651802063
Epoch: 15, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5315656661987305
Epoch: 16, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.389 Vali Acc: 0.874 Test Loss: 0.389 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6367294788360596
Epoch: 17, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.441 Vali Acc: 0.901 Test Loss: 0.441 Test Acc: 0.901
Validation loss decreased (-0.894194 --> -0.901019).  Saving model ...
Epoch: 18 cost time: 1.7259418964385986
Epoch: 18, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.514 Vali Acc: 0.863 Test Loss: 0.514 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6411585807800293
Epoch: 19, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.438 Vali Acc: 0.870 Test Loss: 0.438 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.95416259765625
Epoch: 20, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4578709602355957
Epoch: 21, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.484 Vali Acc: 0.710 Test Loss: 1.484 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7136902809143066
Epoch: 22, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.541 Vali Acc: 0.870 Test Loss: 0.541 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7428603172302246
Epoch: 23, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.507 Vali Acc: 0.857 Test Loss: 0.507 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1183416843414307
Epoch: 24, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.630 Vali Acc: 0.846 Test Loss: 0.630 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.138777017593384
Epoch: 25, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.675 Vali Acc: 0.860 Test Loss: 0.675 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5124056339263916
Epoch: 26, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.600 Vali Acc: 0.884 Test Loss: 0.600 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5437326431274414
Epoch: 27, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.565 Vali Acc: 0.877 Test Loss: 0.565 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps69_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 30296066
model size : 130.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps69_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.836139678955078
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.340 Vali Acc: 0.894 Test Loss: 0.340 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 0.9686508178710938
Epoch: 2, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.509 Vali Acc: 0.625 Test Loss: 0.509 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.248034954071045
Epoch: 3, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.439 Vali Acc: 0.717 Test Loss: 0.439 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1816542148590088
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.318 Vali Acc: 0.901 Test Loss: 0.318 Test Acc: 0.901
Validation loss decreased (-0.894195 --> -0.901021).  Saving model ...
Epoch: 5 cost time: 1.1548588275909424
Epoch: 5, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.429 Vali Acc: 0.758 Test Loss: 0.429 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2113702297210693
Epoch: 6, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
Validation loss decreased (-0.901021 --> -0.914673).  Saving model ...
Epoch: 7 cost time: 1.3077161312103271
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.317 Vali Acc: 0.901 Test Loss: 0.317 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2897086143493652
Epoch: 8, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2443139553070068
Epoch: 9, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.476935625076294
Epoch: 10, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.779 Vali Acc: 0.590 Test Loss: 0.779 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5764460563659668
Epoch: 11, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.586 Vali Acc: 0.785 Test Loss: 0.586 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9486849308013916
Epoch: 12, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.428 Vali Acc: 0.802 Test Loss: 0.428 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4482097625732422
Epoch: 13, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.343268871307373
Epoch: 14, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5151939392089844
Epoch: 15, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.119 Vali Acc: 0.734 Test Loss: 1.119 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0169601440429688
Epoch: 16, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.640 Vali Acc: 0.819 Test Loss: 0.640 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps69_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 30228482
model size : 129.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps69_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.583158016204834
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.373 Vali Acc: 0.881 Test Loss: 0.373 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 1.375295639038086
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.465 Vali Acc: 0.696 Test Loss: 0.465 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1937377452850342
Epoch: 3, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.361 Vali Acc: 0.867 Test Loss: 0.361 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.027336835861206
Epoch: 4, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.345 Vali Acc: 0.887 Test Loss: 0.345 Test Acc: 0.887
Validation loss decreased (-0.880542 --> -0.887369).  Saving model ...
Epoch: 5 cost time: 0.9986875057220459
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9591245651245117
Epoch: 6, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
Validation loss decreased (-0.887369 --> -0.911260).  Saving model ...
Epoch: 7 cost time: 0.9718437194824219
Epoch: 7, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.299 Vali Acc: 0.904 Test Loss: 0.299 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.902484655380249
Epoch: 8, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.322 Vali Acc: 0.874 Test Loss: 0.322 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4134798049926758
Epoch: 9, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.409 Vali Acc: 0.860 Test Loss: 0.409 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1606595516204834
Epoch: 10, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.469 Vali Acc: 0.836 Test Loss: 0.469 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1459922790527344
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.349 Vali Acc: 0.887 Test Loss: 0.349 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9331541061401367
Epoch: 12, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.531 Vali Acc: 0.799 Test Loss: 0.531 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4577414989471436
Epoch: 13, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.523 Vali Acc: 0.819 Test Loss: 0.523 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3332509994506836
Epoch: 14, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.280 Vali Acc: 0.908 Test Loss: 0.280 Test Acc: 0.908
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6942951679229736
Epoch: 15, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.413 Vali Acc: 0.887 Test Loss: 0.413 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2794756889343262
Epoch: 16, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.410 Vali Acc: 0.857 Test Loss: 0.410 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps69_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 30191618
model size : 129.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7822468280792236
Epoch: 1, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.667 Vali Acc: 0.498 Test Loss: 0.667 Test Acc: 0.498
Validation loss decreased (inf --> -0.498287).  Saving model ...
Epoch: 2 cost time: 2.505448579788208
Epoch: 2, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.373 Vali Acc: 0.898 Test Loss: 0.373 Test Acc: 0.898
Validation loss decreased (-0.498287 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 2.0529348850250244
Epoch: 3, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.424 Vali Acc: 0.823 Test Loss: 0.424 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9850091934204102
Epoch: 4, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.309 Vali Acc: 0.904 Test Loss: 0.309 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904434).  Saving model ...
Epoch: 5 cost time: 2.0125207901000977
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.386 Vali Acc: 0.860 Test Loss: 0.386 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.663527488708496
Epoch: 6, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.354 Vali Acc: 0.887 Test Loss: 0.354 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.060915946960449
Epoch: 7, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.323 Vali Acc: 0.898 Test Loss: 0.323 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6769204139709473
Epoch: 8, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.447 Vali Acc: 0.795 Test Loss: 0.447 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.579099178314209
Epoch: 9, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.628 Vali Acc: 0.754 Test Loss: 0.628 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2853052616119385
Epoch: 10, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.345 Vali Acc: 0.867 Test Loss: 0.345 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0062081813812256
Epoch: 11, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.402 Vali Acc: 0.836 Test Loss: 0.402 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7627687454223633
Epoch: 12, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.532 Vali Acc: 0.867 Test Loss: 0.532 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4662840366363525
Epoch: 13, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.724 Vali Acc: 0.689 Test Loss: 0.724 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3199849128723145
Epoch: 14, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.615 Vali Acc: 0.816 Test Loss: 0.615 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 30372866
model size : 130.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.942549228668213
Epoch: 1, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.389 Vali Acc: 0.898 Test Loss: 0.389 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.1997644901275635
Epoch: 2, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.355 Vali Acc: 0.898 Test Loss: 0.355 Test Acc: 0.898
Validation loss decreased (-0.897607 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 1.184075117111206
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.573 Vali Acc: 0.720 Test Loss: 0.573 Test Acc: 0.720
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.007328987121582
Epoch: 4, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1236786842346191
Epoch: 5, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.267 Vali Acc: 0.898 Test Loss: 0.267 Test Acc: 0.898
Validation loss decreased (-0.897607 --> -0.897608).  Saving model ...
Epoch: 6 cost time: 1.2346525192260742
Epoch: 6, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.580 Vali Acc: 0.587 Test Loss: 0.580 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.209155797958374
Epoch: 7, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.447 Vali Acc: 0.706 Test Loss: 0.447 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.098397970199585
Epoch: 8, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.439 Vali Acc: 0.744 Test Loss: 0.439 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1618905067443848
Epoch: 9, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.332 Vali Acc: 0.857 Test Loss: 0.332 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9725799560546875
Epoch: 10, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.375 Vali Acc: 0.843 Test Loss: 0.375 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.195756435394287
Epoch: 11, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.378 Vali Acc: 0.881 Test Loss: 0.378 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.151693344116211
Epoch: 12, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
Validation loss decreased (-0.897608 --> -0.911260).  Saving model ...
Epoch: 13 cost time: 1.5720248222351074
Epoch: 13, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.433 Vali Acc: 0.867 Test Loss: 0.433 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2324886322021484
Epoch: 14, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0219035148620605
Epoch: 15, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.643 Vali Acc: 0.802 Test Loss: 0.643 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.802250623703003
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.630 Vali Acc: 0.843 Test Loss: 0.630 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5328166484832764
Epoch: 17, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.603 Vali Acc: 0.754 Test Loss: 0.603 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2117631435394287
Epoch: 18, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.750 Vali Acc: 0.754 Test Loss: 0.750 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3417823314666748
Epoch: 19, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2000346183776855
Epoch: 20, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.618 Vali Acc: 0.846 Test Loss: 0.618 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7691383361816406
Epoch: 21, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.633 Vali Acc: 0.863 Test Loss: 0.633 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1555769443511963
Epoch: 22, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.244 Vali Acc: 0.734 Test Loss: 1.244 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 30305282
model size : 130.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.102935314178467
Epoch: 1, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.428 Vali Acc: 0.898 Test Loss: 0.428 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 0.9837427139282227
Epoch: 2, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.366 Vali Acc: 0.904 Test Loss: 0.366 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.3108417987823486
Epoch: 3, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.336 Vali Acc: 0.918 Test Loss: 0.336 Test Acc: 0.918
Validation loss decreased (-0.904433 --> -0.918085).  Saving model ...
Epoch: 4 cost time: 1.4287018775939941
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.395 Vali Acc: 0.799 Test Loss: 0.395 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.985095739364624
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.348085880279541
Epoch: 6, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.317 Vali Acc: 0.881 Test Loss: 0.317 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0673561096191406
Epoch: 7, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.381 Vali Acc: 0.802 Test Loss: 0.381 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2152683734893799
Epoch: 8, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.411 Vali Acc: 0.826 Test Loss: 0.411 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1240131855010986
Epoch: 9, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.650 Vali Acc: 0.758 Test Loss: 0.650 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.337538480758667
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.556 Vali Acc: 0.700 Test Loss: 0.556 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1269006729125977
Epoch: 11, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.310 Vali Acc: 0.887 Test Loss: 0.310 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8899393081665039
Epoch: 12, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2618224620819092
Epoch: 13, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9180887372013652
model parameter : 30271490
model size : 130.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps82_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.0430848598480225
Epoch: 1, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.357 Vali Acc: 0.874 Test Loss: 0.357 Test Acc: 0.874
Validation loss decreased (inf --> -0.873717).  Saving model ...
Epoch: 2 cost time: 1.6761932373046875
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.384 Vali Acc: 0.881 Test Loss: 0.384 Test Acc: 0.881
Validation loss decreased (-0.873717 --> -0.880542).  Saving model ...
Epoch: 3 cost time: 2.0675580501556396
Epoch: 3, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.505 Vali Acc: 0.621 Test Loss: 0.505 Test Acc: 0.621
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4854755401611328
Epoch: 4, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.361 Vali Acc: 0.898 Test Loss: 0.361 Test Acc: 0.898
Validation loss decreased (-0.880542 --> -0.897607).  Saving model ...
Epoch: 5 cost time: 1.6397449970245361
Epoch: 5, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.477 Vali Acc: 0.795 Test Loss: 0.477 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7346031665802002
Epoch: 6, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.394 Vali Acc: 0.853 Test Loss: 0.394 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3870799541473389
Epoch: 7, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.427 Vali Acc: 0.836 Test Loss: 0.427 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8689420223236084
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0527799129486084
Epoch: 9, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.276 Vali Acc: 0.908 Test Loss: 0.276 Test Acc: 0.908
Validation loss decreased (-0.897607 --> -0.907847).  Saving model ...
Epoch: 10 cost time: 1.2334024906158447
Epoch: 10, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.296 Vali Acc: 0.901 Test Loss: 0.296 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1951324939727783
Epoch: 11, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.432 Vali Acc: 0.867 Test Loss: 0.432 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1575701236724854
Epoch: 12, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.551 Vali Acc: 0.836 Test Loss: 0.551 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.453817367553711
Epoch: 13, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.744 Vali Acc: 0.669 Test Loss: 0.744 Test Acc: 0.669
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1200730800628662
Epoch: 14, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.762 Vali Acc: 0.747 Test Loss: 0.762 Test Acc: 0.747
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9465672969818115
Epoch: 15, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.883 Vali Acc: 0.703 Test Loss: 0.883 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6250274181365967
Epoch: 16, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.749 Vali Acc: 0.819 Test Loss: 0.749 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3317983150482178
Epoch: 17, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.985 Vali Acc: 0.758 Test Loss: 0.985 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.687317132949829
Epoch: 18, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.188 Vali Acc: 0.761 Test Loss: 1.188 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.028289318084717
Epoch: 19, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.844 Vali Acc: 0.843 Test Loss: 0.844 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps82_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 30454274
model size : 130.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps82_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.683324098587036
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.408 Vali Acc: 0.829 Test Loss: 0.408 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.327364444732666
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.402 Vali Acc: 0.853 Test Loss: 0.402 Test Acc: 0.853
Validation loss decreased (-0.829347 --> -0.853238).  Saving model ...
Epoch: 3 cost time: 0.9708013534545898
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.367 Vali Acc: 0.860 Test Loss: 0.367 Test Acc: 0.860
Validation loss decreased (-0.853238 --> -0.860065).  Saving model ...
Epoch: 4 cost time: 1.1322543621063232
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.369 Vali Acc: 0.840 Test Loss: 0.369 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2123935222625732
Epoch: 5, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
Validation loss decreased (-0.860065 --> -0.866890).  Saving model ...
Epoch: 6 cost time: 1.058933973312378
Epoch: 6, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.301 Vali Acc: 0.904 Test Loss: 0.301 Test Acc: 0.904
Validation loss decreased (-0.866890 --> -0.904434).  Saving model ...
Epoch: 7 cost time: 1.1972298622131348
Epoch: 7, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.446 Vali Acc: 0.717 Test Loss: 0.446 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8709499835968018
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.535 Vali Acc: 0.686 Test Loss: 0.535 Test Acc: 0.686
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6488997936248779
Epoch: 9, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.513 Vali Acc: 0.805 Test Loss: 0.513 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8263089656829834
Epoch: 10, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.479 Vali Acc: 0.805 Test Loss: 0.479 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.930992603302002
Epoch: 11, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1025617122650146
Epoch: 12, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.517 Vali Acc: 0.857 Test Loss: 0.517 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9703233242034912
Epoch: 13, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.299 Vali Acc: 0.901 Test Loss: 0.299 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1027374267578125
Epoch: 14, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0904555320739746
Epoch: 15, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0521187782287598
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.395 Vali Acc: 0.874 Test Loss: 0.395 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps82_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 30395906
model size : 130.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps82_str82_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8356077671051025
Epoch: 1, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.364 Vali Acc: 0.891 Test Loss: 0.364 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 0.897775411605835
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.392 Vali Acc: 0.829 Test Loss: 0.392 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8697514533996582
Epoch: 3, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.442 Vali Acc: 0.863 Test Loss: 0.442 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2539863586425781
Epoch: 4, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.324 Vali Acc: 0.891 Test Loss: 0.324 Test Acc: 0.891
Validation loss decreased (-0.890781 --> -0.890782).  Saving model ...
Epoch: 5 cost time: 1.2497320175170898
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.383 Vali Acc: 0.874 Test Loss: 0.383 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9185163974761963
Epoch: 6, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.382 Vali Acc: 0.816 Test Loss: 0.382 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1721575260162354
Epoch: 7, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.295 Vali Acc: 0.894 Test Loss: 0.295 Test Acc: 0.894
Validation loss decreased (-0.890782 --> -0.894195).  Saving model ...
Epoch: 8 cost time: 0.7912132740020752
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.305 Vali Acc: 0.908 Test Loss: 0.305 Test Acc: 0.908
Validation loss decreased (-0.894195 --> -0.907847).  Saving model ...
Epoch: 9 cost time: 1.2003982067108154
Epoch: 9, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.367 Vali Acc: 0.853 Test Loss: 0.367 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.872647762298584
Epoch: 10, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911260).  Saving model ...
Epoch: 11 cost time: 1.2196855545043945
Epoch: 11, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.317 Vali Acc: 0.901 Test Loss: 0.317 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9584970474243164
Epoch: 12, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.330 Vali Acc: 0.887 Test Loss: 0.330 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9350638389587402
Epoch: 13, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.428 Vali Acc: 0.836 Test Loss: 0.428 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.028583288192749
Epoch: 14, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.794914722442627
Epoch: 15, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.316 Vali Acc: 0.901 Test Loss: 0.316 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8529031276702881
Epoch: 16, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.512 Vali Acc: 0.823 Test Loss: 0.512 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9406781196594238
Epoch: 17, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.379 Vali Acc: 0.891 Test Loss: 0.379 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0835957527160645
Epoch: 18, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2631402015686035
Epoch: 19, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.455 Vali Acc: 0.846 Test Loss: 0.455 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7836484909057617
Epoch: 20, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps82_str82_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 30365186
model size : 130.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps90_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7988715171813965
Epoch: 1, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.363 Vali Acc: 0.860 Test Loss: 0.363 Test Acc: 0.860
Validation loss decreased (inf --> -0.860065).  Saving model ...
Epoch: 2 cost time: 1.1784844398498535
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.391 Vali Acc: 0.904 Test Loss: 0.391 Test Acc: 0.904
Validation loss decreased (-0.860065 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.3589165210723877
Epoch: 3, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.528 Vali Acc: 0.614 Test Loss: 0.528 Test Acc: 0.614
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2892005443572998
Epoch: 4, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.578 Vali Acc: 0.700 Test Loss: 0.578 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.242283582687378
Epoch: 5, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.379 Vali Acc: 0.840 Test Loss: 0.379 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1201176643371582
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.298 Vali Acc: 0.908 Test Loss: 0.298 Test Acc: 0.908
Validation loss decreased (-0.904433 --> -0.907847).  Saving model ...
Epoch: 7 cost time: 1.058882474899292
Epoch: 7, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.315 Vali Acc: 0.904 Test Loss: 0.315 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1531696319580078
Epoch: 8, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.431 Vali Acc: 0.758 Test Loss: 0.431 Test Acc: 0.758
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0955312252044678
Epoch: 9, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.448 Vali Acc: 0.730 Test Loss: 0.448 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.234128475189209
Epoch: 10, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.374 Vali Acc: 0.867 Test Loss: 0.374 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.160292625427246
Epoch: 11, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.368781328201294
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.528 Vali Acc: 0.805 Test Loss: 0.528 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3972554206848145
Epoch: 13, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.462 Vali Acc: 0.867 Test Loss: 0.462 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.353386640548706
Epoch: 14, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.389 Vali Acc: 0.863 Test Loss: 0.389 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.344958782196045
Epoch: 15, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.683 Vali Acc: 0.846 Test Loss: 0.683 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4511361122131348
Epoch: 16, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.420 Vali Acc: 0.881 Test Loss: 0.420 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps90_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 30555650
model size : 131.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.338989496231079
Epoch: 1, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.308 Vali Acc: 0.898 Test Loss: 0.308 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.268979787826538
Epoch: 2, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.328 Vali Acc: 0.908 Test Loss: 0.328 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907847).  Saving model ...
Epoch: 3 cost time: 1.800905704498291
Epoch: 3, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.367 Vali Acc: 0.894 Test Loss: 0.367 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4304497241973877
Epoch: 4, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.378 Vali Acc: 0.881 Test Loss: 0.378 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0769596099853516
Epoch: 5, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3274269104003906
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.415 Vali Acc: 0.792 Test Loss: 0.415 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0212771892547607
Epoch: 7, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.374 Vali Acc: 0.860 Test Loss: 0.374 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3594372272491455
Epoch: 8, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.617 Vali Acc: 0.686 Test Loss: 0.617 Test Acc: 0.686
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5077855587005615
Epoch: 9, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.536 Vali Acc: 0.751 Test Loss: 0.536 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.427408218383789
Epoch: 10, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.624 Vali Acc: 0.689 Test Loss: 0.624 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9535737037658691
Epoch: 11, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.933443546295166
Epoch: 12, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 30500354
model size : 131.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps90_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7064735889434814
Epoch: 1, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
Validation loss decreased (inf --> -0.870304).  Saving model ...
Epoch: 2 cost time: 0.825354814529419
Epoch: 2, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.318 Vali Acc: 0.898 Test Loss: 0.318 Test Acc: 0.898
Validation loss decreased (-0.870304 --> -0.897608).  Saving model ...
Epoch: 3 cost time: 0.8244194984436035
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.383 Vali Acc: 0.884 Test Loss: 0.383 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.211219072341919
Epoch: 4, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.346 Vali Acc: 0.877 Test Loss: 0.346 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9592986106872559
Epoch: 5, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.269 Vali Acc: 0.898 Test Loss: 0.269 Test Acc: 0.898
Validation loss decreased (-0.897608 --> -0.897608).  Saving model ...
Epoch: 6 cost time: 1.014312982559204
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.383 Vali Acc: 0.836 Test Loss: 0.383 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7753887176513672
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.561 Vali Acc: 0.713 Test Loss: 0.561 Test Acc: 0.713
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.063474178314209
Epoch: 8, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9168241024017334
Epoch: 9, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7868242263793945
Epoch: 10, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.450 Vali Acc: 0.795 Test Loss: 0.450 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1236138343811035
Epoch: 11, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.452 Vali Acc: 0.799 Test Loss: 0.452 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9912056922912598
Epoch: 12, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9118568897247314
Epoch: 13, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.472 Vali Acc: 0.836 Test Loss: 0.472 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0681934356689453
Epoch: 14, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.542 Vali Acc: 0.751 Test Loss: 0.542 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7753429412841797
Epoch: 15, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.418 Vali Acc: 0.853 Test Loss: 0.418 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps90_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 30472706
model size : 130.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.683218479156494
Epoch: 1, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.339 Vali Acc: 0.894 Test Loss: 0.339 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 1.733633279800415
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.329 Vali Acc: 0.894 Test Loss: 0.329 Test Acc: 0.894
Validation loss decreased (-0.894195 --> -0.894195).  Saving model ...
Epoch: 3 cost time: 1.0910155773162842
Epoch: 3, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.462 Vali Acc: 0.700 Test Loss: 0.462 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7034661769866943
Epoch: 4, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.553 Vali Acc: 0.601 Test Loss: 0.553 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.244788408279419
Epoch: 5, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.573 Vali Acc: 0.662 Test Loss: 0.573 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2509374618530273
Epoch: 6, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.343 Vali Acc: 0.904 Test Loss: 0.343 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904433).  Saving model ...
Epoch: 7 cost time: 1.9138202667236328
Epoch: 7, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.362 Vali Acc: 0.850 Test Loss: 0.362 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3487083911895752
Epoch: 8, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.524 Vali Acc: 0.782 Test Loss: 0.524 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8386499881744385
Epoch: 9, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.244030237197876
Epoch: 10, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.361 Vali Acc: 0.891 Test Loss: 0.361 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.611602544784546
Epoch: 11, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6559336185455322
Epoch: 12, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.332 Vali Acc: 0.891 Test Loss: 0.332 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5072999000549316
Epoch: 13, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.937 Vali Acc: 0.485 Test Loss: 0.937 Test Acc: 0.485
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0464470386505127
Epoch: 14, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.442 Vali Acc: 0.836 Test Loss: 0.442 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.333022117614746
Epoch: 15, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.960498571395874
Epoch: 16, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.596 Vali Acc: 0.751 Test Loss: 0.596 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 30681602
model size : 131.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.330422878265381
Epoch: 1, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.349 Vali Acc: 0.908 Test Loss: 0.349 Test Acc: 0.908
Validation loss decreased (inf --> -0.907846).  Saving model ...
Epoch: 2 cost time: 1.0148968696594238
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8852567672729492
Epoch: 3, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8387415409088135
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.334 Vali Acc: 0.877 Test Loss: 0.334 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8747396469116211
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.328 Vali Acc: 0.874 Test Loss: 0.328 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2104053497314453
Epoch: 6, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.543 Vali Acc: 0.659 Test Loss: 0.543 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.242748498916626
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.475 Vali Acc: 0.771 Test Loss: 0.475 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1564643383026123
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.553 Vali Acc: 0.693 Test Loss: 0.553 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.204688310623169
Epoch: 9, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.419 Vali Acc: 0.836 Test Loss: 0.419 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4099760055541992
Epoch: 10, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.506 Vali Acc: 0.720 Test Loss: 0.506 Test Acc: 0.720
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4654369354248047
Epoch: 11, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.640 Vali Acc: 0.761 Test Loss: 0.640 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 30632450
model size : 131.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.569952964782715
Epoch: 1, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.343 Vali Acc: 0.884 Test Loss: 0.343 Test Acc: 0.884
Validation loss decreased (inf --> -0.883956).  Saving model ...
Epoch: 2 cost time: 0.8026607036590576
Epoch: 2, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.352 Vali Acc: 0.901 Test Loss: 0.352 Test Acc: 0.901
Validation loss decreased (-0.883956 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.0609784126281738
Epoch: 3, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.316 Vali Acc: 0.898 Test Loss: 0.316 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.391052007675171
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.327 Vali Acc: 0.887 Test Loss: 0.327 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9439499378204346
Epoch: 5, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.351 Vali Acc: 0.860 Test Loss: 0.351 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.178316593170166
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.328 Vali Acc: 0.870 Test Loss: 0.328 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0002827644348145
Epoch: 7, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.392 Vali Acc: 0.826 Test Loss: 0.392 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1785368919372559
Epoch: 8, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0381953716278076
Epoch: 9, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.358 Vali Acc: 0.881 Test Loss: 0.358 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.962054967880249
Epoch: 10, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.301 Vali Acc: 0.898 Test Loss: 0.301 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.938849925994873
Epoch: 11, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.690 Vali Acc: 0.648 Test Loss: 0.690 Test Acc: 0.648
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6992917060852051
Epoch: 12, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.363 Vali Acc: 0.887 Test Loss: 0.363 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 30607874
model size : 131.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps112_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7387757301330566
Epoch: 1, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.344 Vali Acc: 0.881 Test Loss: 0.344 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 1.099912405014038
Epoch: 2, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.34016752243042
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.377 Vali Acc: 0.843 Test Loss: 0.377 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2912888526916504
Epoch: 4, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.423 Vali Acc: 0.812 Test Loss: 0.423 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8884387016296387
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.376 Vali Acc: 0.843 Test Loss: 0.376 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.506897211074829
Epoch: 6, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.278 Vali Acc: 0.901 Test Loss: 0.278 Test Acc: 0.901
Validation loss decreased (-0.880543 --> -0.901021).  Saving model ...
Epoch: 7 cost time: 1.2465291023254395
Epoch: 7, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.283 Vali Acc: 0.901 Test Loss: 0.283 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8287169933319092
Epoch: 8, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.394 Vali Acc: 0.874 Test Loss: 0.394 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3092293739318848
Epoch: 9, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.374 Vali Acc: 0.863 Test Loss: 0.374 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1722750663757324
Epoch: 10, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.884 Vali Acc: 0.717 Test Loss: 0.884 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.049790620803833
Epoch: 11, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9075620174407959
Epoch: 12, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0606484413146973
Epoch: 13, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0907206535339355
Epoch: 14, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.503 Vali Acc: 0.840 Test Loss: 0.503 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0983505249023438
Epoch: 15, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.549 Vali Acc: 0.863 Test Loss: 0.549 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9271812438964844
Epoch: 16, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.723 Vali Acc: 0.843 Test Loss: 0.723 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps112_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 30838274
model size : 132.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps112_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.733227014541626
Epoch: 1, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.409 Vali Acc: 0.881 Test Loss: 0.409 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 0.9911773204803467
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.354 Vali Acc: 0.898 Test Loss: 0.354 Test Acc: 0.898
Validation loss decreased (-0.880542 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 0.8596816062927246
Epoch: 3, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.407 Vali Acc: 0.908 Test Loss: 0.407 Test Acc: 0.908
Validation loss decreased (-0.897607 --> -0.907846).  Saving model ...
Epoch: 4 cost time: 0.938770055770874
Epoch: 4, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.363 Vali Acc: 0.891 Test Loss: 0.363 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7952799797058105
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.269 Vali Acc: 0.908 Test Loss: 0.269 Test Acc: 0.908
Validation loss decreased (-0.907846 --> -0.907847).  Saving model ...
Epoch: 6 cost time: 1.2436244487762451
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
Validation loss decreased (-0.907847 --> -0.914673).  Saving model ...
Epoch: 7 cost time: 0.9130151271820068
Epoch: 7, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.394 Vali Acc: 0.857 Test Loss: 0.394 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1082763671875
Epoch: 8, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.344 Vali Acc: 0.874 Test Loss: 0.344 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7226879596710205
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.324 Vali Acc: 0.877 Test Loss: 0.324 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8983917236328125
Epoch: 10, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7522783279418945
Epoch: 11, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.393 Vali Acc: 0.860 Test Loss: 0.393 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7386400699615479
Epoch: 12, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.429 Vali Acc: 0.816 Test Loss: 0.429 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.754523515701294
Epoch: 13, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9392499923706055
Epoch: 14, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.545 Vali Acc: 0.758 Test Loss: 0.545 Test Acc: 0.758
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2663958072662354
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.696 Vali Acc: 0.754 Test Loss: 0.696 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7927727699279785
Epoch: 16, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.366 Vali Acc: 0.877 Test Loss: 0.366 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps112_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 30795266
model size : 132.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps112_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.0958313941955566
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.406 Vali Acc: 0.887 Test Loss: 0.406 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 1.081345558166504
Epoch: 2, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.385 Vali Acc: 0.894 Test Loss: 0.385 Test Acc: 0.894
Validation loss decreased (-0.887368 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 0.9570517539978027
Epoch: 3, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.348 Vali Acc: 0.915 Test Loss: 0.348 Test Acc: 0.915
Validation loss decreased (-0.894194 --> -0.914672).  Saving model ...
Epoch: 4 cost time: 0.8973102569580078
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.386 Vali Acc: 0.805 Test Loss: 0.386 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.002711296081543
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.298 Vali Acc: 0.904 Test Loss: 0.298 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.812483549118042
Epoch: 6, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.296 Vali Acc: 0.898 Test Loss: 0.296 Test Acc: 0.898
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0759449005126953
Epoch: 7, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.250 Vali Acc: 0.901 Test Loss: 0.250 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.770376443862915
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.362 Vali Acc: 0.860 Test Loss: 0.362 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0234489440917969
Epoch: 9, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.425 Vali Acc: 0.826 Test Loss: 0.425 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7749142646789551
Epoch: 10, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.273 Vali Acc: 0.901 Test Loss: 0.273 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.093618392944336
Epoch: 11, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.336 Vali Acc: 0.867 Test Loss: 0.336 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.150806188583374
Epoch: 12, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.279 Vali Acc: 0.904 Test Loss: 0.279 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8813138008117676
Epoch: 13, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.325 Vali Acc: 0.898 Test Loss: 0.325 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps112_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 30773762
model size : 132.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.277592658996582
Epoch: 1, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.337 Vali Acc: 0.908 Test Loss: 0.337 Test Acc: 0.908
Validation loss decreased (inf --> -0.907846).  Saving model ...
Epoch: 2 cost time: 0.9552876949310303
Epoch: 2, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.386 Vali Acc: 0.857 Test Loss: 0.386 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9891870021820068
Epoch: 3, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.301 Vali Acc: 0.887 Test Loss: 0.301 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5160305500030518
Epoch: 4, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.282 Vali Acc: 0.891 Test Loss: 0.282 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2879390716552734
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.808333158493042
Epoch: 6, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.335 Vali Acc: 0.863 Test Loss: 0.335 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5510292053222656
Epoch: 7, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.366 Vali Acc: 0.853 Test Loss: 0.366 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9746332168579102
Epoch: 8, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5004849433898926
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.457 Vali Acc: 0.799 Test Loss: 0.457 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0154836177825928
Epoch: 10, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.379 Vali Acc: 0.881 Test Loss: 0.379 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6096479892730713
Epoch: 11, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.534 Vali Acc: 0.823 Test Loss: 0.534 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 31047170
model size : 133.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.2177772521972656
Epoch: 1, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 1.1870307922363281
Epoch: 2, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0349805355072021
Epoch: 3, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.431 Vali Acc: 0.829 Test Loss: 0.431 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8698697090148926
Epoch: 4, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.378 Vali Acc: 0.894 Test Loss: 0.378 Test Acc: 0.894
Validation loss decreased (-0.890781 --> -0.894194).  Saving model ...
Epoch: 5 cost time: 1.2130482196807861
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9844765663146973
Epoch: 6, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.356 Vali Acc: 0.843 Test Loss: 0.356 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9856104850769043
Epoch: 7, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.593 Vali Acc: 0.676 Test Loss: 0.593 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9918112754821777
Epoch: 8, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.316 Vali Acc: 0.874 Test Loss: 0.316 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0708072185516357
Epoch: 9, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.319 Vali Acc: 0.894 Test Loss: 0.319 Test Acc: 0.894
Validation loss decreased (-0.894194 --> -0.894195).  Saving model ...
Epoch: 10 cost time: 0.7772860527038574
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9094669818878174
Epoch: 11, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.373 Vali Acc: 0.867 Test Loss: 0.373 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9955172538757324
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.396 Vali Acc: 0.887 Test Loss: 0.396 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9436452388763428
Epoch: 13, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.455 Vali Acc: 0.816 Test Loss: 0.455 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0567946434020996
Epoch: 14, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.399 Vali Acc: 0.853 Test Loss: 0.399 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9380755424499512
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
Validation loss decreased (-0.894195 --> -0.894195).  Saving model ...
Epoch: 16 cost time: 1.1700754165649414
Epoch: 16, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.350 Vali Acc: 0.898 Test Loss: 0.350 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897607).  Saving model ...
Epoch: 17 cost time: 0.9529304504394531
Epoch: 17, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.421 Vali Acc: 0.867 Test Loss: 0.421 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1607999801635742
Epoch: 18, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.603 Vali Acc: 0.846 Test Loss: 0.603 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9391498565673828
Epoch: 19, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8371293544769287
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.373 Vali Acc: 0.894 Test Loss: 0.373 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1249001026153564
Epoch: 21, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.455 Vali Acc: 0.857 Test Loss: 0.455 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9490401744842529
Epoch: 22, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.573 Vali Acc: 0.805 Test Loss: 0.573 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1859803199768066
Epoch: 23, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.498 Vali Acc: 0.860 Test Loss: 0.498 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.923213005065918
Epoch: 24, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.530 Vali Acc: 0.843 Test Loss: 0.530 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2059500217437744
Epoch: 25, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0583717823028564
Epoch: 26, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.616 Vali Acc: 0.840 Test Loss: 0.616 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 31010306
model size : 132.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.310164451599121
Epoch: 1, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 0.9812514781951904
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.377 Vali Acc: 0.894 Test Loss: 0.377 Test Acc: 0.894
Validation loss decreased (-0.883955 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 0.8923478126525879
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
Validation loss decreased (-0.894194 --> -0.914673).  Saving model ...
Epoch: 4 cost time: 1.1666460037231445
Epoch: 4, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.300 Vali Acc: 0.908 Test Loss: 0.300 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.960468053817749
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.250 Vali Acc: 0.894 Test Loss: 0.250 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9959578514099121
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.297 Vali Acc: 0.901 Test Loss: 0.297 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7694950103759766
Epoch: 7, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.299 Vali Acc: 0.891 Test Loss: 0.299 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7638266086578369
Epoch: 8, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8230133056640625
Epoch: 9, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.333 Vali Acc: 0.874 Test Loss: 0.333 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4366679191589355
Epoch: 10, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.304 Vali Acc: 0.891 Test Loss: 0.304 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2206404209136963
Epoch: 11, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9017565250396729
Epoch: 12, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8468348979949951
Epoch: 13, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.448 Vali Acc: 0.823 Test Loss: 0.448 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 30991874
model size : 132.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.816821575164795
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.320 Vali Acc: 0.894 Test Loss: 0.320 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 1.6146550178527832
Epoch: 2, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.341 Vali Acc: 0.901 Test Loss: 0.341 Test Acc: 0.901
Validation loss decreased (-0.894195 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.1773796081542969
Epoch: 3, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.427 Vali Acc: 0.877 Test Loss: 0.427 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0965819358825684
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3378753662109375
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0433168411254883
Epoch: 6, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.356 Vali Acc: 0.843 Test Loss: 0.356 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9582550525665283
Epoch: 7, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
Validation loss decreased (-0.901020 --> -0.904434).  Saving model ...
Epoch: 8 cost time: 1.0556292533874512
Epoch: 8, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.295 Vali Acc: 0.901 Test Loss: 0.295 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9884829521179199
Epoch: 9, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.855 Vali Acc: 0.608 Test Loss: 0.855 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.085608959197998
Epoch: 10, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.942720890045166
Epoch: 11, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.444 Vali Acc: 0.840 Test Loss: 0.444 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8095874786376953
Epoch: 12, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.503 Vali Acc: 0.778 Test Loss: 0.503 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7066211700439453
Epoch: 13, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.467 Vali Acc: 0.840 Test Loss: 0.467 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0333836078643799
Epoch: 14, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3262982368469238
Epoch: 15, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.640 Vali Acc: 0.826 Test Loss: 0.640 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4020705223083496
Epoch: 16, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.483 Vali Acc: 0.863 Test Loss: 0.483 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2531929016113281
Epoch: 17, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.718 Vali Acc: 0.765 Test Loss: 0.718 Test Acc: 0.765
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 31335938
model size : 134.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7060651779174805
Epoch: 1, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.337 Vali Acc: 0.894 Test Loss: 0.337 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 1.2106940746307373
Epoch: 2, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.411 Vali Acc: 0.857 Test Loss: 0.411 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9751527309417725
Epoch: 3, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1021628379821777
Epoch: 4, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9276473522186279
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.355 Vali Acc: 0.863 Test Loss: 0.355 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8086197376251221
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.429 Vali Acc: 0.846 Test Loss: 0.429 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2153294086456299
Epoch: 7, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.287 Vali Acc: 0.898 Test Loss: 0.287 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 0.9065170288085938
Epoch: 8, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.360 Vali Acc: 0.881 Test Loss: 0.360 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9898135662078857
Epoch: 9, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9504470825195312
Epoch: 10, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.528 Vali Acc: 0.771 Test Loss: 0.528 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1398911476135254
Epoch: 11, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.389 Vali Acc: 0.891 Test Loss: 0.389 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9812285900115967
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.383 Vali Acc: 0.881 Test Loss: 0.383 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9855480194091797
Epoch: 13, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.356 Vali Acc: 0.901 Test Loss: 0.356 Test Acc: 0.901
Validation loss decreased (-0.897608 --> -0.901020).  Saving model ...
Epoch: 14 cost time: 0.9228050708770752
Epoch: 14, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.431 Vali Acc: 0.863 Test Loss: 0.431 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1787917613983154
Epoch: 15, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0695178508758545
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.763 Vali Acc: 0.717 Test Loss: 0.763 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.124572515487671
Epoch: 17, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.454 Vali Acc: 0.850 Test Loss: 0.454 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8118228912353516
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.405 Vali Acc: 0.901 Test Loss: 0.405 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2882184982299805
Epoch: 19, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.451 Vali Acc: 0.857 Test Loss: 0.451 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.102952241897583
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9519057273864746
Epoch: 21, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.701 Vali Acc: 0.799 Test Loss: 0.701 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1221766471862793
Epoch: 22, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.830 Vali Acc: 0.799 Test Loss: 0.830 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2003636360168457
Epoch: 23, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.719 Vali Acc: 0.788 Test Loss: 0.719 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 31305218
model size : 134.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.52942156791687
Epoch: 1, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.370 Vali Acc: 0.887 Test Loss: 0.370 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 1.2106332778930664
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.382 Vali Acc: 0.901 Test Loss: 0.382 Test Acc: 0.901
Validation loss decreased (-0.887368 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.0650339126586914
Epoch: 3, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.346 Vali Acc: 0.915 Test Loss: 0.346 Test Acc: 0.915
Validation loss decreased (-0.901020 --> -0.914672).  Saving model ...
Epoch: 4 cost time: 1.1507842540740967
Epoch: 4, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.278 Vali Acc: 0.904 Test Loss: 0.278 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9314794540405273
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.091475248336792
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.377 Vali Acc: 0.860 Test Loss: 0.377 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8348050117492676
Epoch: 7, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7133162021636963
Epoch: 8, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.314 Vali Acc: 0.877 Test Loss: 0.314 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9415774345397949
Epoch: 9, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.307 Vali Acc: 0.881 Test Loss: 0.307 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.861924409866333
Epoch: 10, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.294 Vali Acc: 0.887 Test Loss: 0.294 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9698355197906494
Epoch: 11, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.351 Vali Acc: 0.884 Test Loss: 0.351 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7851927280426025
Epoch: 12, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.353 Vali Acc: 0.877 Test Loss: 0.353 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6968348026275635
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.415 Vali Acc: 0.857 Test Loss: 0.415 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 31289858
model size : 134.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps180_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.0496132373809814
Epoch: 1, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 0.7434952259063721
Epoch: 2, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.363 Vali Acc: 0.877 Test Loss: 0.363 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7415933609008789
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9904296398162842
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.307 Vali Acc: 0.908 Test Loss: 0.307 Test Acc: 0.908
Validation loss decreased (-0.890781 --> -0.907847).  Saving model ...
Epoch: 5 cost time: 1.186333179473877
Epoch: 5, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.452 Vali Acc: 0.795 Test Loss: 0.452 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2481698989868164
Epoch: 6, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.439 Vali Acc: 0.829 Test Loss: 0.439 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1199486255645752
Epoch: 7, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.339 Vali Acc: 0.860 Test Loss: 0.339 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2006652355194092
Epoch: 8, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.292 Vali Acc: 0.901 Test Loss: 0.292 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6546483039855957
Epoch: 9, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.335 Vali Acc: 0.874 Test Loss: 0.335 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3040685653686523
Epoch: 10, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.328 Vali Acc: 0.898 Test Loss: 0.328 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.592987298965454
Epoch: 11, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0685303211212158
Epoch: 12, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.382 Vali Acc: 0.857 Test Loss: 0.382 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0014760494232178
Epoch: 13, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.516 Vali Acc: 0.823 Test Loss: 0.516 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.859764575958252
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.464 Vali Acc: 0.857 Test Loss: 0.464 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps180_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 31738370
model size : 135.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.9911746978759766
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.357 Vali Acc: 0.887 Test Loss: 0.357 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 0.9732949733734131
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.406 Vali Acc: 0.860 Test Loss: 0.406 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2172787189483643
Epoch: 3, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.351 Vali Acc: 0.891 Test Loss: 0.351 Test Acc: 0.891
Validation loss decreased (-0.887368 --> -0.890781).  Saving model ...
Epoch: 4 cost time: 1.0085937976837158
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.372927188873291
Epoch: 5, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.271 Vali Acc: 0.904 Test Loss: 0.271 Test Acc: 0.904
Validation loss decreased (-0.890781 --> -0.904434).  Saving model ...
Epoch: 6 cost time: 1.2797284126281738
Epoch: 6, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.268 Vali Acc: 0.898 Test Loss: 0.268 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0705862045288086
Epoch: 7, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
Validation loss decreased (-0.904434 --> -0.931738).  Saving model ...
Epoch: 8 cost time: 0.8928604125976562
Epoch: 8, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.388 Vali Acc: 0.819 Test Loss: 0.388 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2514560222625732
Epoch: 9, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.316 Vali Acc: 0.881 Test Loss: 0.316 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8550868034362793
Epoch: 10, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.325 Vali Acc: 0.894 Test Loss: 0.325 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7698836326599121
Epoch: 11, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.295 Vali Acc: 0.898 Test Loss: 0.295 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7618224620819092
Epoch: 12, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1763429641723633
Epoch: 13, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.559 Vali Acc: 0.768 Test Loss: 0.559 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9455463886260986
Epoch: 14, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.369 Vali Acc: 0.860 Test Loss: 0.369 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2593958377838135
Epoch: 15, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9710173606872559
Epoch: 16, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.358 Vali Acc: 0.887 Test Loss: 0.358 Test Acc: 0.887
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1687510013580322
Epoch: 17, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.434 Vali Acc: 0.850 Test Loss: 0.434 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.931740614334471
model parameter : 31713794
model size : 135.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps180_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7200987339019775
Epoch: 1, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.399 Vali Acc: 0.898 Test Loss: 0.399 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 0.8226039409637451
Epoch: 2, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.318 Vali Acc: 0.894 Test Loss: 0.318 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1384062767028809
Epoch: 3, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.341 Vali Acc: 0.881 Test Loss: 0.341 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8973784446716309
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.371 Vali Acc: 0.816 Test Loss: 0.371 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2233350276947021
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.251 Vali Acc: 0.898 Test Loss: 0.251 Test Acc: 0.898
Validation loss decreased (-0.897607 --> -0.897608).  Saving model ...
Epoch: 6 cost time: 0.9585611820220947
Epoch: 6, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.342 Vali Acc: 0.853 Test Loss: 0.342 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9986555576324463
Epoch: 7, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.299 Vali Acc: 0.874 Test Loss: 0.299 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9813621044158936
Epoch: 8, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.298 Vali Acc: 0.901 Test Loss: 0.298 Test Acc: 0.901
Validation loss decreased (-0.897608 --> -0.901021).  Saving model ...
Epoch: 9 cost time: 0.9024174213409424
Epoch: 9, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.331 Vali Acc: 0.887 Test Loss: 0.331 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2403194904327393
Epoch: 10, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.320 Vali Acc: 0.898 Test Loss: 0.320 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.938164472579956
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2610650062561035
Epoch: 12, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.427 Vali Acc: 0.857 Test Loss: 0.427 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9728362560272217
Epoch: 13, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.423 Vali Acc: 0.860 Test Loss: 0.423 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1587157249450684
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9347891807556152
Epoch: 15, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.363 Vali Acc: 0.901 Test Loss: 0.363 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.849780797958374
Epoch: 16, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.459 Vali Acc: 0.867 Test Loss: 0.459 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1413745880126953
Epoch: 17, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.424 Vali Acc: 0.874 Test Loss: 0.424 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0674540996551514
Epoch: 18, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.374 Vali Acc: 0.898 Test Loss: 0.374 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el4_dm768_df768_ps180_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 31701506
model size : 135.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps36_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2917466163635254
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.459 Vali Acc: 0.809 Test Loss: 0.459 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 1.7528693675994873
Epoch: 2, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.319 Vali Acc: 0.898 Test Loss: 0.319 Test Acc: 0.898
Validation loss decreased (-0.808869 --> -0.897608).  Saving model ...
Epoch: 3 cost time: 2.044311285018921
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.584 Vali Acc: 0.689 Test Loss: 0.584 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.040841817855835
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.531 Vali Acc: 0.693 Test Loss: 0.531 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7639586925506592
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.424 Vali Acc: 0.816 Test Loss: 0.424 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8875267505645752
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.370 Vali Acc: 0.853 Test Loss: 0.370 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1077096462249756
Epoch: 7, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.302 Vali Acc: 0.904 Test Loss: 0.302 Test Acc: 0.904
Validation loss decreased (-0.897608 --> -0.904434).  Saving model ...
Epoch: 8 cost time: 1.5431556701660156
Epoch: 8, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3656580448150635
Epoch: 9, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.532 Vali Acc: 0.805 Test Loss: 0.532 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4896891117095947
Epoch: 10, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.523 Vali Acc: 0.747 Test Loss: 0.523 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4384815692901611
Epoch: 11, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.599 Vali Acc: 0.785 Test Loss: 0.599 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6044738292694092
Epoch: 12, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6166369915008545
Epoch: 13, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.520 Vali Acc: 0.843 Test Loss: 0.520 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.535304069519043
Epoch: 14, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7344629764556885
Epoch: 15, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7061619758605957
Epoch: 16, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.839 Vali Acc: 0.785 Test Loss: 0.839 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0714778900146484
Epoch: 17, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.883 Vali Acc: 0.795 Test Loss: 0.883 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps36_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 22905602
model size : 102.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3239128589630127
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.332 Vali Acc: 0.887 Test Loss: 0.332 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 0.9389772415161133
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.586 Vali Acc: 0.648 Test Loss: 0.586 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8630568981170654
Epoch: 3, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.332 Vali Acc: 0.877 Test Loss: 0.332 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3663158416748047
Epoch: 4, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.347 Vali Acc: 0.863 Test Loss: 0.347 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5169086456298828
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.548 Vali Acc: 0.758 Test Loss: 0.548 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4677484035491943
Epoch: 6, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.826 Vali Acc: 0.611 Test Loss: 0.826 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.168208122253418
Epoch: 7, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.509 Vali Acc: 0.771 Test Loss: 0.509 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7309176921844482
Epoch: 8, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.388 Vali Acc: 0.809 Test Loss: 0.388 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5341899394989014
Epoch: 9, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.561 Vali Acc: 0.553 Test Loss: 1.561 Test Acc: 0.553
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6687285900115967
Epoch: 10, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.749 Vali Acc: 0.730 Test Loss: 0.749 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8635046482086182
Epoch: 11, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.759 Vali Acc: 0.638 Test Loss: 0.759 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 22758146
model size : 101.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps36_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8764989376068115
Epoch: 1, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.416 Vali Acc: 0.870 Test Loss: 0.416 Test Acc: 0.870
Validation loss decreased (inf --> -0.870303).  Saving model ...
Epoch: 2 cost time: 1.1116132736206055
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
Validation loss decreased (-0.870303 --> -0.877129).  Saving model ...
Epoch: 3 cost time: 1.1439716815948486
Epoch: 3, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4518299102783203
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.297 Vali Acc: 0.881 Test Loss: 0.297 Test Acc: 0.881
Validation loss decreased (-0.877129 --> -0.880543).  Saving model ...
Epoch: 5 cost time: 1.4168939590454102
Epoch: 5, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.343 Vali Acc: 0.911 Test Loss: 0.343 Test Acc: 0.911
Validation loss decreased (-0.880543 --> -0.911259).  Saving model ...
Epoch: 6 cost time: 1.236485242843628
Epoch: 6, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.451 Vali Acc: 0.785 Test Loss: 0.451 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4060969352722168
Epoch: 7, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.312 Vali Acc: 0.881 Test Loss: 0.312 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.238110065460205
Epoch: 8, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.419 Vali Acc: 0.816 Test Loss: 0.419 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5317978858947754
Epoch: 9, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.496 Vali Acc: 0.802 Test Loss: 0.496 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3566219806671143
Epoch: 10, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.319 Vali Acc: 0.877 Test Loss: 0.319 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0168490409851074
Epoch: 11, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3373560905456543
Epoch: 12, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.404 Vali Acc: 0.860 Test Loss: 0.404 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3325181007385254
Epoch: 13, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.843 Vali Acc: 0.594 Test Loss: 0.843 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5613563060760498
Epoch: 14, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.636 Vali Acc: 0.805 Test Loss: 0.636 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1456551551818848
Epoch: 15, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.467 Vali Acc: 0.840 Test Loss: 0.467 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps36_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22684418
model size : 101.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps38_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.67270827293396
Epoch: 1, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.402 Vali Acc: 0.843 Test Loss: 0.402 Test Acc: 0.843
Validation loss decreased (inf --> -0.842999).  Saving model ...
Epoch: 2 cost time: 1.5471689701080322
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.424 Vali Acc: 0.863 Test Loss: 0.424 Test Acc: 0.863
Validation loss decreased (-0.842999 --> -0.863477).  Saving model ...
Epoch: 3 cost time: 1.5929839611053467
Epoch: 3, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.669 Vali Acc: 0.580 Test Loss: 0.669 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8184309005737305
Epoch: 4, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.312 Vali Acc: 0.894 Test Loss: 0.312 Test Acc: 0.894
Validation loss decreased (-0.863477 --> -0.894195).  Saving model ...
Epoch: 5 cost time: 2.010737419128418
Epoch: 5, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.565 Vali Acc: 0.679 Test Loss: 0.565 Test Acc: 0.679
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.663571834564209
Epoch: 6, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.641 Vali Acc: 0.727 Test Loss: 0.641 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8163669109344482
Epoch: 7, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.255 Vali Acc: 0.898 Test Loss: 0.255 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 1.5897648334503174
Epoch: 8, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.483 Vali Acc: 0.778 Test Loss: 0.483 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3636963367462158
Epoch: 9, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.355 Vali Acc: 0.908 Test Loss: 0.355 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907846).  Saving model ...
Epoch: 10 cost time: 1.6038930416107178
Epoch: 10, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.629 Vali Acc: 0.648 Test Loss: 0.629 Test Acc: 0.648
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4441416263580322
Epoch: 11, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.570 Vali Acc: 0.737 Test Loss: 0.570 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3782124519348145
Epoch: 12, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.634 Vali Acc: 0.761 Test Loss: 0.634 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.417717695236206
Epoch: 13, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.438 Vali Acc: 0.874 Test Loss: 0.438 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.234581708908081
Epoch: 14, Steps: 17 | Train Loss: 0.331 Vali Loss: 1.218 Vali Acc: 0.648 Test Loss: 1.218 Test Acc: 0.648
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.423753023147583
Epoch: 15, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.409 Vali Acc: 0.894 Test Loss: 0.409 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5637140274047852
Epoch: 16, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.956 Vali Acc: 0.809 Test Loss: 0.956 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6093270778656006
Epoch: 17, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7597911357879639
Epoch: 18, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.642 Vali Acc: 0.843 Test Loss: 0.642 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0904364585876465
Epoch: 19, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.841 Vali Acc: 0.826 Test Loss: 0.841 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps38_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 22902530
model size : 102.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.955193042755127
Epoch: 1, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.363 Vali Acc: 0.863 Test Loss: 0.363 Test Acc: 0.863
Validation loss decreased (inf --> -0.863478).  Saving model ...
Epoch: 2 cost time: 1.1139616966247559
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.449 Vali Acc: 0.785 Test Loss: 0.449 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0759944915771484
Epoch: 3, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.448 Vali Acc: 0.785 Test Loss: 0.448 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5773046016693115
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.314 Vali Acc: 0.881 Test Loss: 0.314 Test Acc: 0.881
Validation loss decreased (-0.863478 --> -0.880543).  Saving model ...
Epoch: 5 cost time: 1.2102727890014648
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.379 Vali Acc: 0.840 Test Loss: 0.379 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4647252559661865
Epoch: 6, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.349 Vali Acc: 0.853 Test Loss: 0.349 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.426224708557129
Epoch: 7, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1656794548034668
Epoch: 8, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.318 Vali Acc: 0.870 Test Loss: 0.318 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5268113613128662
Epoch: 9, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.406 Vali Acc: 0.799 Test Loss: 0.406 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.193385124206543
Epoch: 10, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4504563808441162
Epoch: 11, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.711 Vali Acc: 0.628 Test Loss: 0.711 Test Acc: 0.628
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.030846118927002
Epoch: 12, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.318 Vali Acc: 0.891 Test Loss: 0.318 Test Acc: 0.891
Validation loss decreased (-0.880543 --> -0.890782).  Saving model ...
Epoch: 13 cost time: 1.4167964458465576
Epoch: 13, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.424 Vali Acc: 0.877 Test Loss: 0.424 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8354249000549316
Epoch: 14, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.345 Vali Acc: 0.894 Test Loss: 0.345 Test Acc: 0.894
Validation loss decreased (-0.890782 --> -0.894194).  Saving model ...
Epoch: 15 cost time: 1.0507588386535645
Epoch: 15, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.342 Vali Acc: 0.901 Test Loss: 0.342 Test Acc: 0.901
Validation loss decreased (-0.894194 --> -0.901020).  Saving model ...
Epoch: 16 cost time: 1.1117932796478271
Epoch: 16, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.579 Vali Acc: 0.863 Test Loss: 0.579 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6050631999969482
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.602 Vali Acc: 0.877 Test Loss: 0.602 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.134021282196045
Epoch: 18, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
Validation loss decreased (-0.901020 --> -0.911258).  Saving model ...
Epoch: 19 cost time: 1.662668228149414
Epoch: 19, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.447 Vali Acc: 0.901 Test Loss: 0.447 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.350278615951538
Epoch: 20, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.531 Vali Acc: 0.898 Test Loss: 0.531 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.599039077758789
Epoch: 21, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.627 Vali Acc: 0.884 Test Loss: 0.627 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2079088687896729
Epoch: 22, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.695 Vali Acc: 0.891 Test Loss: 0.695 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1104793548583984
Epoch: 23, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.584 Vali Acc: 0.904 Test Loss: 0.584 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2385389804840088
Epoch: 24, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.556 Vali Acc: 0.894 Test Loss: 0.556 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3852722644805908
Epoch: 25, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.124 Vali Acc: 0.846 Test Loss: 1.124 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2290763854980469
Epoch: 26, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.945 Vali Acc: 0.870 Test Loss: 0.945 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4682581424713135
Epoch: 27, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.946 Vali Acc: 0.850 Test Loss: 0.946 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2707545757293701
Epoch: 28, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.119 Vali Acc: 0.853 Test Loss: 1.119 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22779650
model size : 101.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps38_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.436241865158081
Epoch: 1, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
Validation loss decreased (inf --> -0.866891).  Saving model ...
Epoch: 2 cost time: 0.918682336807251
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.366 Vali Acc: 0.908 Test Loss: 0.366 Test Acc: 0.908
Validation loss decreased (-0.866891 --> -0.907846).  Saving model ...
Epoch: 3 cost time: 1.023801565170288
Epoch: 3, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.407 Vali Acc: 0.853 Test Loss: 0.407 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3841633796691895
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.354 Vali Acc: 0.884 Test Loss: 0.354 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1290619373321533
Epoch: 5, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.317 Vali Acc: 0.881 Test Loss: 0.317 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3817088603973389
Epoch: 6, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.246 Vali Acc: 0.918 Test Loss: 0.246 Test Acc: 0.918
Validation loss decreased (-0.907846 --> -0.918086).  Saving model ...
Epoch: 7 cost time: 1.110673427581787
Epoch: 7, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.374 Vali Acc: 0.816 Test Loss: 0.374 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0896482467651367
Epoch: 8, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
Validation loss decreased (-0.918086 --> -0.928325).  Saving model ...
Epoch: 9 cost time: 0.9202408790588379
Epoch: 9, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.296 Vali Acc: 0.891 Test Loss: 0.296 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9150164127349854
Epoch: 10, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7434613704681396
Epoch: 11, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.434 Vali Acc: 0.829 Test Loss: 0.434 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8701534271240234
Epoch: 12, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9263439178466797
Epoch: 13, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8333232402801514
Epoch: 14, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.268 Vali Acc: 0.908 Test Loss: 0.268 Test Acc: 0.908
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9185335636138916
Epoch: 15, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.004190444946289
Epoch: 16, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8421673774719238
Epoch: 17, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.422 Vali Acc: 0.894 Test Loss: 0.422 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8424534797668457
Epoch: 18, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps38_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9283276450511946
model parameter : 22708994
model size : 101.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.277523994445801
Epoch: 1, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.443 Vali Acc: 0.836 Test Loss: 0.443 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 2.0901668071746826
Epoch: 2, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.364 Vali Acc: 0.853 Test Loss: 0.364 Test Acc: 0.853
Validation loss decreased (-0.836173 --> -0.853239).  Saving model ...
Epoch: 3 cost time: 1.5271496772766113
Epoch: 3, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.456 Vali Acc: 0.788 Test Loss: 0.456 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0511341094970703
Epoch: 4, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.300 Vali Acc: 0.887 Test Loss: 0.300 Test Acc: 0.887
Validation loss decreased (-0.853239 --> -0.887369).  Saving model ...
Epoch: 5 cost time: 1.4861531257629395
Epoch: 5, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.531 Vali Acc: 0.686 Test Loss: 0.531 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1840245723724365
Epoch: 6, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.700361728668213
Epoch: 7, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.417 Vali Acc: 0.823 Test Loss: 0.417 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.411024570465088
Epoch: 8, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.838 Vali Acc: 0.611 Test Loss: 0.838 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3614826202392578
Epoch: 9, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.320 Vali Acc: 0.881 Test Loss: 0.320 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1620452404022217
Epoch: 10, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.894 Vali Acc: 0.648 Test Loss: 0.894 Test Acc: 0.648
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.520632266998291
Epoch: 11, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.411 Vali Acc: 0.843 Test Loss: 0.411 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9724040031433105
Epoch: 12, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.296 Vali Acc: 0.898 Test Loss: 0.296 Test Acc: 0.898
Validation loss decreased (-0.887369 --> -0.897608).  Saving model ...
Epoch: 13 cost time: 1.8345754146575928
Epoch: 13, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.818 Vali Acc: 0.686 Test Loss: 0.818 Test Acc: 0.686
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6054694652557373
Epoch: 14, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7273037433624268
Epoch: 15, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.559 Vali Acc: 0.751 Test Loss: 0.559 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4224793910980225
Epoch: 16, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.205639600753784
Epoch: 17, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.388 Vali Acc: 0.881 Test Loss: 0.388 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5996613502502441
Epoch: 18, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.380 Vali Acc: 0.894 Test Loss: 0.380 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7707998752593994
Epoch: 19, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.597 Vali Acc: 0.829 Test Loss: 0.597 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5877165794372559
Epoch: 20, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.727 Vali Acc: 0.826 Test Loss: 0.727 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7762539386749268
Epoch: 21, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.923 Vali Acc: 0.805 Test Loss: 0.923 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6850712299346924
Epoch: 22, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.881 Vali Acc: 0.840 Test Loss: 0.881 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 22916354
model size : 102.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.4320833683013916
Epoch: 1, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.348 Vali Acc: 0.877 Test Loss: 0.348 Test Acc: 0.877
Validation loss decreased (inf --> -0.877130).  Saving model ...
Epoch: 2 cost time: 1.1287245750427246
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.510 Vali Acc: 0.744 Test Loss: 0.510 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8979475498199463
Epoch: 3, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.430 Vali Acc: 0.795 Test Loss: 0.430 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8365566730499268
Epoch: 4, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.372 Vali Acc: 0.881 Test Loss: 0.372 Test Acc: 0.881
Validation loss decreased (-0.877130 --> -0.880542).  Saving model ...
Epoch: 5 cost time: 1.3300020694732666
Epoch: 5, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.333 Vali Acc: 0.881 Test Loss: 0.333 Test Acc: 0.881
Validation loss decreased (-0.880542 --> -0.880543).  Saving model ...
Epoch: 6 cost time: 1.451667308807373
Epoch: 6, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.276 Vali Acc: 0.884 Test Loss: 0.276 Test Acc: 0.884
Validation loss decreased (-0.880543 --> -0.883956).  Saving model ...
Epoch: 7 cost time: 0.9598381519317627
Epoch: 7, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.435 Vali Acc: 0.747 Test Loss: 0.435 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0533132553100586
Epoch: 8, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.325 Vali Acc: 0.860 Test Loss: 0.325 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6495990753173828
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9882645606994629
Epoch: 10, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.458 Vali Acc: 0.829 Test Loss: 0.458 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4533796310424805
Epoch: 11, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.410 Vali Acc: 0.843 Test Loss: 0.410 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0511736869812012
Epoch: 12, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.360 Vali Acc: 0.850 Test Loss: 0.360 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9284138679504395
Epoch: 13, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.459 Vali Acc: 0.843 Test Loss: 0.459 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.718327283859253
Epoch: 14, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.352 Vali Acc: 0.898 Test Loss: 0.352 Test Acc: 0.898
Validation loss decreased (-0.883956 --> -0.897607).  Saving model ...
Epoch: 15 cost time: 1.4774317741394043
Epoch: 15, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.263 Vali Acc: 0.911 Test Loss: 0.263 Test Acc: 0.911
Validation loss decreased (-0.897607 --> -0.911260).  Saving model ...
Epoch: 16 cost time: 1.4624919891357422
Epoch: 16, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.346 Vali Acc: 0.898 Test Loss: 0.346 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0520970821380615
Epoch: 17, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.865 Vali Acc: 0.788 Test Loss: 0.865 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4745774269104004
Epoch: 18, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0444114208221436
Epoch: 19, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.513 Vali Acc: 0.863 Test Loss: 0.513 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.08018159866333
Epoch: 20, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.694 Vali Acc: 0.751 Test Loss: 0.694 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6115212440490723
Epoch: 21, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.496 Vali Acc: 0.894 Test Loss: 0.496 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1196916103363037
Epoch: 22, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.602 Vali Acc: 0.874 Test Loss: 0.602 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.467712163925171
Epoch: 23, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.084 Vali Acc: 0.788 Test Loss: 1.084 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9889218807220459
Epoch: 24, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.662 Vali Acc: 0.884 Test Loss: 0.662 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.939521074295044
Epoch: 25, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.737 Vali Acc: 0.863 Test Loss: 0.737 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22784258
model size : 101.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.299636125564575
Epoch: 1, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.428 Vali Acc: 0.850 Test Loss: 0.428 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 0.9205586910247803
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
Validation loss decreased (-0.849825 --> -0.866890).  Saving model ...
Epoch: 3 cost time: 0.8185617923736572
Epoch: 3, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.410 Vali Acc: 0.829 Test Loss: 0.410 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7838456630706787
Epoch: 4, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.280 Vali Acc: 0.891 Test Loss: 0.280 Test Acc: 0.891
Validation loss decreased (-0.866890 --> -0.890782).  Saving model ...
Epoch: 5 cost time: 0.7646136283874512
Epoch: 5, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9004509449005127
Epoch: 6, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7729835510253906
Epoch: 7, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.658 Vali Acc: 0.625 Test Loss: 0.658 Test Acc: 0.625
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.771031379699707
Epoch: 8, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.349 Vali Acc: 0.901 Test Loss: 0.349 Test Acc: 0.901
Validation loss decreased (-0.890782 --> -0.901020).  Saving model ...
Epoch: 9 cost time: 0.697016716003418
Epoch: 9, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8813350200653076
Epoch: 10, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.374 Vali Acc: 0.857 Test Loss: 0.374 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7754285335540771
Epoch: 11, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.322 Vali Acc: 0.887 Test Loss: 0.322 Test Acc: 0.887
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8646376132965088
Epoch: 12, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3095595836639404
Epoch: 13, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0244131088256836
Epoch: 14, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8202073574066162
Epoch: 15, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.426 Vali Acc: 0.843 Test Loss: 0.426 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.262845754623413
Epoch: 16, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.306 Vali Acc: 0.898 Test Loss: 0.306 Test Acc: 0.898
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9739043712615967
Epoch: 17, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8009774684906006
Epoch: 18, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 22719746
model size : 101.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps41_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2658984661102295
Epoch: 1, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.343 Vali Acc: 0.898 Test Loss: 0.343 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.5826454162597656
Epoch: 2, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.741 Vali Acc: 0.652 Test Loss: 0.741 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4045922756195068
Epoch: 3, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.798 Vali Acc: 0.625 Test Loss: 0.798 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7698631286621094
Epoch: 4, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.324 Vali Acc: 0.870 Test Loss: 0.324 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1858952045440674
Epoch: 5, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.298 Vali Acc: 0.884 Test Loss: 0.298 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7249400615692139
Epoch: 6, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.535 Vali Acc: 0.696 Test Loss: 0.535 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.398120403289795
Epoch: 7, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.433 Vali Acc: 0.819 Test Loss: 0.433 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.249197006225586
Epoch: 8, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.578 Vali Acc: 0.751 Test Loss: 0.578 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6128787994384766
Epoch: 9, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.529 Vali Acc: 0.785 Test Loss: 0.529 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7039902210235596
Epoch: 10, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.578 Vali Acc: 0.829 Test Loss: 0.578 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.492264986038208
Epoch: 11, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.480 Vali Acc: 0.836 Test Loss: 0.480 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps41_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 22919426
model size : 102.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5863654613494873
Epoch: 1, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.384 Vali Acc: 0.904 Test Loss: 0.384 Test Acc: 0.904
Validation loss decreased (inf --> -0.904433).  Saving model ...
Epoch: 2 cost time: 1.117825984954834
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.542 Vali Acc: 0.713 Test Loss: 0.542 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.939960241317749
Epoch: 3, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8718307018280029
Epoch: 4, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.419 Vali Acc: 0.819 Test Loss: 0.419 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1128439903259277
Epoch: 5, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.365 Vali Acc: 0.843 Test Loss: 0.365 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9229214191436768
Epoch: 6, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0262982845306396
Epoch: 7, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.256 Vali Acc: 0.904 Test Loss: 0.256 Test Acc: 0.904
Validation loss decreased (-0.904433 --> -0.904434).  Saving model ...
Epoch: 8 cost time: 1.435530185699463
Epoch: 8, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.297 Vali Acc: 0.881 Test Loss: 0.297 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0726518630981445
Epoch: 9, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4632010459899902
Epoch: 10, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.417 Vali Acc: 0.805 Test Loss: 0.417 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0349979400634766
Epoch: 11, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.399 Vali Acc: 0.829 Test Loss: 0.399 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5321521759033203
Epoch: 12, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.307 Vali Acc: 0.908 Test Loss: 0.307 Test Acc: 0.908
Validation loss decreased (-0.904434 --> -0.907847).  Saving model ...
Epoch: 13 cost time: 1.0229270458221436
Epoch: 13, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.908221960067749
Epoch: 14, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.424 Vali Acc: 0.867 Test Loss: 0.424 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6023600101470947
Epoch: 15, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.214 Vali Acc: 0.666 Test Loss: 1.214 Test Acc: 0.666
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1267385482788086
Epoch: 16, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.467 Vali Acc: 0.843 Test Loss: 0.467 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6592786312103271
Epoch: 17, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.534 Vali Acc: 0.788 Test Loss: 0.534 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.236274003982544
Epoch: 18, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.469 Vali Acc: 0.898 Test Loss: 0.469 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2460837364196777
Epoch: 19, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.391 Vali Acc: 0.898 Test Loss: 0.391 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0236289501190186
Epoch: 20, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1987309455871582
Epoch: 21, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.780 Vali Acc: 0.802 Test Loss: 0.780 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4750032424926758
Epoch: 22, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.490 Vali Acc: 0.754 Test Loss: 1.490 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 22805762
model size : 101.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps41_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.951176881790161
Epoch: 1, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.444 Vali Acc: 0.877 Test Loss: 0.444 Test Acc: 0.877
Validation loss decreased (inf --> -0.877129).  Saving model ...
Epoch: 2 cost time: 1.1026792526245117
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.379 Vali Acc: 0.874 Test Loss: 0.379 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3538546562194824
Epoch: 3, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.329 Vali Acc: 0.870 Test Loss: 0.329 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1303846836090088
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.381 Vali Acc: 0.836 Test Loss: 0.381 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.022728443145752
Epoch: 5, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.306 Vali Acc: 0.874 Test Loss: 0.306 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4679780006408691
Epoch: 6, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.931605339050293
Epoch: 7, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.308 Vali Acc: 0.898 Test Loss: 0.308 Test Acc: 0.898
Validation loss decreased (-0.877129 --> -0.897608).  Saving model ...
Epoch: 8 cost time: 0.9256761074066162
Epoch: 8, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.531 Vali Acc: 0.754 Test Loss: 0.531 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1934266090393066
Epoch: 9, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.294 Vali Acc: 0.874 Test Loss: 0.294 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7156193256378174
Epoch: 10, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.299 Vali Acc: 0.898 Test Loss: 0.299 Test Acc: 0.898
Validation loss decreased (-0.897608 --> -0.897608).  Saving model ...
Epoch: 11 cost time: 1.009734869003296
Epoch: 11, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.321 Vali Acc: 0.877 Test Loss: 0.321 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2394933700561523
Epoch: 12, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0732989311218262
Epoch: 13, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.406 Vali Acc: 0.836 Test Loss: 0.406 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4160747528076172
Epoch: 14, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.004333257675171
Epoch: 15, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.553 Vali Acc: 0.843 Test Loss: 0.553 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2637708187103271
Epoch: 16, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.454 Vali Acc: 0.853 Test Loss: 0.454 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9382765293121338
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.442 Vali Acc: 0.840 Test Loss: 0.442 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.425067663192749
Epoch: 18, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.862 Vali Acc: 0.788 Test Loss: 0.862 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1188015937805176
Epoch: 19, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.578 Vali Acc: 0.857 Test Loss: 0.578 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3207595348358154
Epoch: 20, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.582 Vali Acc: 0.867 Test Loss: 0.582 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps41_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 22744322
model size : 101.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps43_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2703919410705566
Epoch: 1, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
Validation loss decreased (inf --> -0.890782).  Saving model ...
Epoch: 2 cost time: 1.3536384105682373
Epoch: 2, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.467 Vali Acc: 0.843 Test Loss: 0.467 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2289371490478516
Epoch: 3, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.513 Vali Acc: 0.802 Test Loss: 0.513 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2825896739959717
Epoch: 4, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.464 Vali Acc: 0.737 Test Loss: 0.464 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.332622766494751
Epoch: 5, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.722 Vali Acc: 0.563 Test Loss: 0.722 Test Acc: 0.563
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3044602870941162
Epoch: 6, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.324 Vali Acc: 0.898 Test Loss: 0.324 Test Acc: 0.898
Validation loss decreased (-0.890782 --> -0.897608).  Saving model ...
Epoch: 7 cost time: 1.3555822372436523
Epoch: 7, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.535 Vali Acc: 0.727 Test Loss: 0.535 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.305959939956665
Epoch: 8, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.255 Vali Acc: 0.928 Test Loss: 0.255 Test Acc: 0.928
Validation loss decreased (-0.897608 --> -0.928325).  Saving model ...
Epoch: 9 cost time: 1.8334901332855225
Epoch: 9, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.664 Vali Acc: 0.727 Test Loss: 0.664 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.330733060836792
Epoch: 10, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.837 Vali Acc: 0.669 Test Loss: 0.837 Test Acc: 0.669
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7964427471160889
Epoch: 11, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.788 Vali Acc: 0.590 Test Loss: 0.788 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3375208377838135
Epoch: 12, Steps: 17 | Train Loss: 0.414 Vali Loss: 1.090 Vali Acc: 0.567 Test Loss: 1.090 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.204282283782959
Epoch: 13, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.939 Vali Acc: 0.597 Test Loss: 0.939 Test Acc: 0.597
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6481778621673584
Epoch: 14, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.480 Vali Acc: 0.809 Test Loss: 0.480 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.202789068222046
Epoch: 15, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.620 Vali Acc: 0.771 Test Loss: 0.620 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1610641479492188
Epoch: 16, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1660652160644531
Epoch: 17, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.942 Vali Acc: 0.751 Test Loss: 0.942 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1318001747131348
Epoch: 18, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.666 Vali Acc: 0.826 Test Loss: 0.666 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps43_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9283276450511946
model parameter : 22947074
model size : 102.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps43_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.2853567600250244
Epoch: 1, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
Validation loss decreased (inf --> -0.870304).  Saving model ...
Epoch: 2 cost time: 0.9230217933654785
Epoch: 2, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7812542915344238
Epoch: 3, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.444 Vali Acc: 0.812 Test Loss: 0.444 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8509182929992676
Epoch: 4, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.416 Vali Acc: 0.823 Test Loss: 0.416 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3149008750915527
Epoch: 5, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.351 Vali Acc: 0.881 Test Loss: 0.351 Test Acc: 0.881
Validation loss decreased (-0.870304 --> -0.880543).  Saving model ...
Epoch: 6 cost time: 0.9659585952758789
Epoch: 6, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.340 Vali Acc: 0.877 Test Loss: 0.340 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9596843719482422
Epoch: 7, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.391 Vali Acc: 0.881 Test Loss: 0.391 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.410707712173462
Epoch: 8, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.564 Vali Acc: 0.768 Test Loss: 0.564 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9224889278411865
Epoch: 9, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.472 Vali Acc: 0.782 Test Loss: 0.472 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.357992172241211
Epoch: 10, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.447 Vali Acc: 0.843 Test Loss: 0.447 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1675350666046143
Epoch: 11, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
Validation loss decreased (-0.880543 --> -0.911260).  Saving model ...
Epoch: 12 cost time: 1.1512119770050049
Epoch: 12, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.440 Vali Acc: 0.884 Test Loss: 0.440 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3336589336395264
Epoch: 13, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.868 Vali Acc: 0.689 Test Loss: 0.868 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8970558643341064
Epoch: 14, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.684 Vali Acc: 0.805 Test Loss: 0.684 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1993229389190674
Epoch: 15, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.991 Vali Acc: 0.782 Test Loss: 0.991 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7238223552703857
Epoch: 16, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.698 Vali Acc: 0.829 Test Loss: 0.698 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.473968267440796
Epoch: 17, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.435 Vali Acc: 0.891 Test Loss: 0.435 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9315335750579834
Epoch: 18, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.707 Vali Acc: 0.799 Test Loss: 0.707 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9150464534759521
Epoch: 19, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.962 Vali Acc: 0.812 Test Loss: 0.962 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4308078289031982
Epoch: 20, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.812 Vali Acc: 0.805 Test Loss: 0.812 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1478180885314941
Epoch: 21, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.640 Vali Acc: 0.887 Test Loss: 0.640 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps43_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22827266
model size : 101.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps43_str43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.335052967071533
Epoch: 1, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.406 Vali Acc: 0.874 Test Loss: 0.406 Test Acc: 0.874
Validation loss decreased (inf --> -0.873716).  Saving model ...
Epoch: 2 cost time: 0.776578426361084
Epoch: 2, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.416 Vali Acc: 0.901 Test Loss: 0.416 Test Acc: 0.901
Validation loss decreased (-0.873716 --> -0.901020).  Saving model ...
Epoch: 3 cost time: 1.1934096813201904
Epoch: 3, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.365 Vali Acc: 0.898 Test Loss: 0.365 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8404057025909424
Epoch: 4, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.335 Vali Acc: 0.877 Test Loss: 0.335 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3289391994476318
Epoch: 5, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.360 Vali Acc: 0.843 Test Loss: 0.360 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8784656524658203
Epoch: 6, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.488 Vali Acc: 0.771 Test Loss: 0.488 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1758363246917725
Epoch: 7, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1290361881256104
Epoch: 8, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.273 Vali Acc: 0.891 Test Loss: 0.273 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.307446002960205
Epoch: 9, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.300 Vali Acc: 0.884 Test Loss: 0.300 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7856118679046631
Epoch: 10, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.680 Vali Acc: 0.724 Test Loss: 0.680 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2021164894104004
Epoch: 11, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.275 Vali Acc: 0.891 Test Loss: 0.275 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9834904670715332
Epoch: 12, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.262 Vali Acc: 0.898 Test Loss: 0.262 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps43_str43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 22768898
model size : 101.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.828557252883911
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.372 Vali Acc: 0.863 Test Loss: 0.372 Test Acc: 0.863
Validation loss decreased (inf --> -0.863478).  Saving model ...
Epoch: 2 cost time: 1.0625574588775635
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.572 Vali Acc: 0.570 Test Loss: 0.572 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.505094289779663
Epoch: 3, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.403 Vali Acc: 0.874 Test Loss: 0.403 Test Acc: 0.874
Validation loss decreased (-0.863478 --> -0.873716).  Saving model ...
Epoch: 4 cost time: 1.1469740867614746
Epoch: 4, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.777 Vali Acc: 0.546 Test Loss: 0.777 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2022414207458496
Epoch: 5, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.283 Vali Acc: 0.891 Test Loss: 0.283 Test Acc: 0.891
Validation loss decreased (-0.873716 --> -0.890782).  Saving model ...
Epoch: 6 cost time: 1.4245729446411133
Epoch: 6, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.372 Vali Acc: 0.874 Test Loss: 0.372 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.29868483543396
Epoch: 7, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.326 Vali Acc: 0.870 Test Loss: 0.326 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3957087993621826
Epoch: 8, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.462409496307373
Epoch: 9, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
Validation loss decreased (-0.890782 --> -0.911260).  Saving model ...
Epoch: 10 cost time: 1.4365921020507812
Epoch: 10, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.330 Vali Acc: 0.857 Test Loss: 0.330 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0562193393707275
Epoch: 11, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.597 Vali Acc: 0.850 Test Loss: 0.597 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4315485954284668
Epoch: 12, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.407 Vali Acc: 0.816 Test Loss: 0.407 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.292612075805664
Epoch: 13, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.197 Vali Acc: 0.754 Test Loss: 1.197 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.300201654434204
Epoch: 14, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.918 Vali Acc: 0.805 Test Loss: 0.918 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1823146343231201
Epoch: 15, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.514 Vali Acc: 0.884 Test Loss: 0.514 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4752519130706787
Epoch: 16, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.545 Vali Acc: 0.860 Test Loss: 0.545 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.154965877532959
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.893 Vali Acc: 0.761 Test Loss: 0.893 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9906799793243408
Epoch: 18, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.797 Vali Acc: 0.782 Test Loss: 0.797 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5178577899932861
Epoch: 19, Steps: 17 | Train Loss: 0.163 Vali Loss: 1.219 Vali Acc: 0.741 Test Loss: 1.219 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22953218
model size : 102.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.602830410003662
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.403 Vali Acc: 0.887 Test Loss: 0.403 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 0.9476234912872314
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.516 Vali Acc: 0.611 Test Loss: 0.516 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5757451057434082
Epoch: 3, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.416 Vali Acc: 0.857 Test Loss: 0.416 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0121619701385498
Epoch: 4, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.421 Vali Acc: 0.853 Test Loss: 0.421 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5940074920654297
Epoch: 5, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.291 Vali Acc: 0.884 Test Loss: 0.291 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0281524658203125
Epoch: 6, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.265 Vali Acc: 0.898 Test Loss: 0.265 Test Acc: 0.898
Validation loss decreased (-0.887368 --> -0.897608).  Saving model ...
Epoch: 7 cost time: 0.8197300434112549
Epoch: 7, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
Validation loss decreased (-0.897608 --> -0.911260).  Saving model ...
Epoch: 8 cost time: 0.9892795085906982
Epoch: 8, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.598 Vali Acc: 0.642 Test Loss: 0.598 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5808229446411133
Epoch: 9, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.361 Vali Acc: 0.874 Test Loss: 0.361 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0836131572723389
Epoch: 10, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9476714134216309
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
Validation loss decreased (-0.911260 --> -0.911260).  Saving model ...
Epoch: 12 cost time: 1.0564348697662354
Epoch: 12, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.359 Vali Acc: 0.874 Test Loss: 0.359 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.579756498336792
Epoch: 13, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.623 Vali Acc: 0.846 Test Loss: 0.623 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0220422744750977
Epoch: 14, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.482 Vali Acc: 0.857 Test Loss: 0.482 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9099998474121094
Epoch: 15, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.082 Vali Acc: 0.754 Test Loss: 1.082 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.481032133102417
Epoch: 16, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.563 Vali Acc: 0.843 Test Loss: 0.563 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1172914505004883
Epoch: 17, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.485 Vali Acc: 0.846 Test Loss: 0.485 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5311214923858643
Epoch: 18, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.583 Vali Acc: 0.863 Test Loss: 0.583 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8652646541595459
Epoch: 19, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.549 Vali Acc: 0.891 Test Loss: 0.549 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1545193195343018
Epoch: 20, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.505 Vali Acc: 0.911 Test Loss: 0.505 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8663458824157715
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.555 Vali Acc: 0.891 Test Loss: 0.555 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22851842
model size : 101.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.4146716594696045
Epoch: 1, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
Validation loss decreased (inf --> -0.870303).  Saving model ...
Epoch: 2 cost time: 0.7957549095153809
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.384 Vali Acc: 0.904 Test Loss: 0.384 Test Acc: 0.904
Validation loss decreased (-0.870303 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 1.4273631572723389
Epoch: 3, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7302219867706299
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.356 Vali Acc: 0.908 Test Loss: 0.356 Test Acc: 0.908
Validation loss decreased (-0.904433 --> -0.907846).  Saving model ...
Epoch: 5 cost time: 1.3284053802490234
Epoch: 5, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.371 Vali Acc: 0.853 Test Loss: 0.371 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.856088399887085
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.279 Vali Acc: 0.904 Test Loss: 0.279 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2754380702972412
Epoch: 7, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.378 Vali Acc: 0.857 Test Loss: 0.378 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9295477867126465
Epoch: 8, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.257 Vali Acc: 0.904 Test Loss: 0.257 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8678238391876221
Epoch: 9, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.267 Vali Acc: 0.904 Test Loss: 0.267 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.857245683670044
Epoch: 10, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.293 Vali Acc: 0.887 Test Loss: 0.293 Test Acc: 0.887
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7817964553833008
Epoch: 11, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.351 Vali Acc: 0.843 Test Loss: 0.351 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8702714443206787
Epoch: 12, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7476763725280762
Epoch: 13, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
Validation loss decreased (-0.907846 --> -0.921499).  Saving model ...
Epoch: 14 cost time: 0.8289449214935303
Epoch: 14, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.344 Vali Acc: 0.908 Test Loss: 0.344 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8361227512359619
Epoch: 15, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.587 Vali Acc: 0.829 Test Loss: 0.587 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8903656005859375
Epoch: 16, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.471 Vali Acc: 0.884 Test Loss: 0.471 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7663085460662842
Epoch: 17, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.426 Vali Acc: 0.898 Test Loss: 0.426 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8622057437896729
Epoch: 18, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.508 Vali Acc: 0.867 Test Loss: 0.508 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8142485618591309
Epoch: 19, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.637 Vali Acc: 0.857 Test Loss: 0.637 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8001911640167236
Epoch: 20, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.516 Vali Acc: 0.877 Test Loss: 0.516 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7993810176849365
Epoch: 21, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.014 Vali Acc: 0.799 Test Loss: 1.014 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7405762672424316
Epoch: 22, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.543 Vali Acc: 0.877 Test Loss: 0.543 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.722386360168457
Epoch: 23, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.750 Vali Acc: 0.843 Test Loss: 0.750 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 22793474
model size : 101.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.6181256771087646
Epoch: 1, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.422 Vali Acc: 0.805 Test Loss: 0.422 Test Acc: 0.805
Validation loss decreased (inf --> -0.805457).  Saving model ...
Epoch: 2 cost time: 1.9812350273132324
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.464 Vali Acc: 0.768 Test Loss: 0.464 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5422439575195312
Epoch: 3, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.349 Vali Acc: 0.870 Test Loss: 0.349 Test Acc: 0.870
Validation loss decreased (-0.805457 --> -0.870304).  Saving model ...
Epoch: 4 cost time: 1.5065476894378662
Epoch: 4, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2745866775512695
Epoch: 5, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.511 Vali Acc: 0.662 Test Loss: 0.511 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6230437755584717
Epoch: 6, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.686 Vali Acc: 0.713 Test Loss: 0.686 Test Acc: 0.713
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7770171165466309
Epoch: 7, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.351 Vali Acc: 0.887 Test Loss: 0.351 Test Acc: 0.887
Validation loss decreased (-0.870304 --> -0.887369).  Saving model ...
Epoch: 8 cost time: 1.5826268196105957
Epoch: 8, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.604 Vali Acc: 0.734 Test Loss: 0.604 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9042651653289795
Epoch: 9, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.819 Vali Acc: 0.638 Test Loss: 0.819 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.620858907699585
Epoch: 10, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.565 Vali Acc: 0.689 Test Loss: 0.565 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3748631477355957
Epoch: 11, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.847 Vali Acc: 0.638 Test Loss: 0.847 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2127854824066162
Epoch: 12, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.447 Vali Acc: 0.809 Test Loss: 0.447 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9743003845214844
Epoch: 13, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.867 Vali Acc: 0.689 Test Loss: 0.867 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.429964542388916
Epoch: 14, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.972 Vali Acc: 0.747 Test Loss: 0.972 Test Acc: 0.747
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.148576259613037
Epoch: 15, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.535 Vali Acc: 0.836 Test Loss: 0.535 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8614089488983154
Epoch: 16, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.455 Vali Acc: 0.843 Test Loss: 0.455 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3386504650115967
Epoch: 17, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.566 Vali Acc: 0.846 Test Loss: 0.566 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 22994690
model size : 102.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7508559226989746
Epoch: 1, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.358 Vali Acc: 0.884 Test Loss: 0.358 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 1.0583012104034424
Epoch: 2, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9934971332550049
Epoch: 3, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.299 Vali Acc: 0.884 Test Loss: 0.299 Test Acc: 0.884
Validation loss decreased (-0.883955 --> -0.883956).  Saving model ...
Epoch: 4 cost time: 0.8073437213897705
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.372 Vali Acc: 0.877 Test Loss: 0.372 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3358144760131836
Epoch: 5, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.373 Vali Acc: 0.836 Test Loss: 0.373 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.104325532913208
Epoch: 6, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.501 Vali Acc: 0.775 Test Loss: 0.501 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.48246169090271
Epoch: 7, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.359 Vali Acc: 0.853 Test Loss: 0.359 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0157577991485596
Epoch: 8, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.461 Vali Acc: 0.843 Test Loss: 0.461 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9820647239685059
Epoch: 9, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.661 Vali Acc: 0.645 Test Loss: 0.661 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0630195140838623
Epoch: 10, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.348 Vali Acc: 0.898 Test Loss: 0.348 Test Acc: 0.898
Validation loss decreased (-0.883956 --> -0.897607).  Saving model ...
Epoch: 11 cost time: 1.3186969757080078
Epoch: 11, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.371 Vali Acc: 0.863 Test Loss: 0.371 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9893760681152344
Epoch: 12, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4867351055145264
Epoch: 13, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.439 Vali Acc: 0.863 Test Loss: 0.439 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2184109687805176
Epoch: 14, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.547 Vali Acc: 0.853 Test Loss: 0.547 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2530300617218018
Epoch: 15, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.607 Vali Acc: 0.836 Test Loss: 0.607 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0166850090026855
Epoch: 16, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.895 Vali Acc: 0.805 Test Loss: 0.895 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8788917064666748
Epoch: 17, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.976 Vali Acc: 0.805 Test Loss: 0.976 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0468835830688477
Epoch: 18, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.660 Vali Acc: 0.857 Test Loss: 0.660 Test Acc: 0.857
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1781485080718994
Epoch: 19, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.598 Vali Acc: 0.877 Test Loss: 0.598 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.037355899810791
Epoch: 20, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.993 Vali Acc: 0.775 Test Loss: 0.993 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 22887170
model size : 101.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.521393299102783
Epoch: 1, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.347 Vali Acc: 0.901 Test Loss: 0.347 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 0.7828183174133301
Epoch: 2, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.387 Vali Acc: 0.898 Test Loss: 0.387 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7375915050506592
Epoch: 3, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.422 Vali Acc: 0.840 Test Loss: 0.422 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8514821529388428
Epoch: 4, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3103282451629639
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.368 Vali Acc: 0.881 Test Loss: 0.368 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7970218658447266
Epoch: 6, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.357 Vali Acc: 0.826 Test Loss: 0.357 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2727093696594238
Epoch: 7, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.307 Vali Acc: 0.901 Test Loss: 0.307 Test Acc: 0.901
Validation loss decreased (-0.901020 --> -0.901021).  Saving model ...
Epoch: 8 cost time: 0.7832145690917969
Epoch: 8, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
Validation loss decreased (-0.901021 --> -0.911260).  Saving model ...
Epoch: 9 cost time: 0.8941900730133057
Epoch: 9, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.350 Vali Acc: 0.863 Test Loss: 0.350 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7771446704864502
Epoch: 10, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.243 Vali Acc: 0.908 Test Loss: 0.243 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.951045036315918
Epoch: 11, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.454 Vali Acc: 0.819 Test Loss: 0.454 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9674851894378662
Epoch: 12, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.284 Vali Acc: 0.898 Test Loss: 0.284 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0181825160980225
Epoch: 13, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.364 Vali Acc: 0.850 Test Loss: 0.364 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5712811946868896
Epoch: 14, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.466 Vali Acc: 0.836 Test Loss: 0.466 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0390105247497559
Epoch: 15, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.350 Vali Acc: 0.894 Test Loss: 0.350 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6066906452178955
Epoch: 16, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.468 Vali Acc: 0.846 Test Loss: 0.468 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6855475902557373
Epoch: 17, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.297 Vali Acc: 0.679 Test Loss: 1.297 Test Acc: 0.679
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6387965679168701
Epoch: 18, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.458 Vali Acc: 0.846 Test Loss: 0.458 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22831874
model size : 101.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.719665288925171
Epoch: 1, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.358 Vali Acc: 0.887 Test Loss: 0.358 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 0.9135172367095947
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.719 Vali Acc: 0.628 Test Loss: 0.719 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3521862030029297
Epoch: 3, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.352 Vali Acc: 0.881 Test Loss: 0.352 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.269160509109497
Epoch: 4, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.313 Vali Acc: 0.884 Test Loss: 0.313 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.273399829864502
Epoch: 5, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.318 Vali Acc: 0.887 Test Loss: 0.318 Test Acc: 0.887
Validation loss decreased (-0.887368 --> -0.887369).  Saving model ...
Epoch: 6 cost time: 1.256476640701294
Epoch: 6, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3131628036499023
Epoch: 7, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3572747707366943
Epoch: 8, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3578999042510986
Epoch: 9, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.239 Vali Acc: 0.625 Test Loss: 1.239 Test Acc: 0.625
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.757538080215454
Epoch: 10, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.726 Vali Acc: 0.778 Test Loss: 0.726 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.403367280960083
Epoch: 11, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.510 Vali Acc: 0.843 Test Loss: 0.510 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3471441268920898
Epoch: 12, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.416 Vali Acc: 0.853 Test Loss: 0.416 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4692299365997314
Epoch: 13, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.541 Vali Acc: 0.843 Test Loss: 0.541 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2722749710083008
Epoch: 14, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.759 Vali Acc: 0.812 Test Loss: 0.759 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.811279296875
Epoch: 15, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.529 Vali Acc: 0.836 Test Loss: 0.529 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8873720136518771
model parameter : 23006978
model size : 102.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.64031720161438
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.418 Vali Acc: 0.843 Test Loss: 0.418 Test Acc: 0.843
Validation loss decreased (inf --> -0.842999).  Saving model ...
Epoch: 2 cost time: 1.3193283081054688
Epoch: 2, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.479 Vali Acc: 0.860 Test Loss: 0.479 Test Acc: 0.860
Validation loss decreased (-0.842999 --> -0.860063).  Saving model ...
Epoch: 3 cost time: 0.928011417388916
Epoch: 3, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.362 Vali Acc: 0.881 Test Loss: 0.362 Test Acc: 0.881
Validation loss decreased (-0.860063 --> -0.880542).  Saving model ...
Epoch: 4 cost time: 1.1050491333007812
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.443 Vali Acc: 0.823 Test Loss: 0.443 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9753379821777344
Epoch: 5, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.428 Vali Acc: 0.805 Test Loss: 0.428 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.067748785018921
Epoch: 6, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.403 Vali Acc: 0.826 Test Loss: 0.403 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1129767894744873
Epoch: 7, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.509 Vali Acc: 0.799 Test Loss: 0.509 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9639246463775635
Epoch: 8, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.371 Vali Acc: 0.846 Test Loss: 0.371 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9240972995758057
Epoch: 9, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3564438819885254
Epoch: 10, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.427 Vali Acc: 0.809 Test Loss: 0.427 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8442018032073975
Epoch: 11, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
Validation loss decreased (-0.880542 --> -0.911260).  Saving model ...
Epoch: 12 cost time: 1.1533575057983398
Epoch: 12, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1499335765838623
Epoch: 13, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.444 Vali Acc: 0.778 Test Loss: 0.444 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0997321605682373
Epoch: 14, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0291519165039062
Epoch: 15, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.453 Vali Acc: 0.761 Test Loss: 0.453 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.111618995666504
Epoch: 16, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0849950313568115
Epoch: 17, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.427119493484497
Epoch: 18, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.809 Vali Acc: 0.754 Test Loss: 0.809 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1222081184387207
Epoch: 19, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.377 Vali Acc: 0.901 Test Loss: 0.377 Test Acc: 0.901
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9338254928588867
Epoch: 20, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.449 Vali Acc: 0.874 Test Loss: 0.449 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.819476842880249
Epoch: 21, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.810 Vali Acc: 0.768 Test Loss: 0.810 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22908674
model size : 102.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.378399133682251
Epoch: 1, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.429 Vali Acc: 0.860 Test Loss: 0.429 Test Acc: 0.860
Validation loss decreased (inf --> -0.860064).  Saving model ...
Epoch: 2 cost time: 1.1569466590881348
Epoch: 2, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
Validation loss decreased (-0.860064 --> -0.911259).  Saving model ...
Epoch: 3 cost time: 0.9750051498413086
Epoch: 3, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
Validation loss decreased (-0.911259 --> -0.911260).  Saving model ...
Epoch: 4 cost time: 1.2072889804840088
Epoch: 4, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6513254642486572
Epoch: 5, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.333 Vali Acc: 0.881 Test Loss: 0.333 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8432064056396484
Epoch: 6, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.431 Vali Acc: 0.836 Test Loss: 0.431 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9081296920776367
Epoch: 7, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.351 Vali Acc: 0.881 Test Loss: 0.351 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0529751777648926
Epoch: 8, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.328 Vali Acc: 0.874 Test Loss: 0.328 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9511017799377441
Epoch: 9, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.359 Vali Acc: 0.867 Test Loss: 0.359 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.169086217880249
Epoch: 10, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.275 Vali Acc: 0.901 Test Loss: 0.275 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9504539966583252
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.314 Vali Acc: 0.884 Test Loss: 0.314 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.211974859237671
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.289 Vali Acc: 0.894 Test Loss: 0.289 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9255044460296631
Epoch: 13, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.468 Vali Acc: 0.840 Test Loss: 0.468 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22856450
model size : 101.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.729599952697754
Epoch: 1, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.351 Vali Acc: 0.898 Test Loss: 0.351 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 1.190591812133789
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.608 Vali Acc: 0.601 Test Loss: 0.608 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1947481632232666
Epoch: 3, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.400 Vali Acc: 0.829 Test Loss: 0.400 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1958260536193848
Epoch: 4, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.133669137954712
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.279 Vali Acc: 0.904 Test Loss: 0.279 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904434).  Saving model ...
Epoch: 6 cost time: 1.1818509101867676
Epoch: 6, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.389 Vali Acc: 0.826 Test Loss: 0.389 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3708701133728027
Epoch: 7, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.454 Vali Acc: 0.792 Test Loss: 0.454 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2402267456054688
Epoch: 8, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.491 Vali Acc: 0.782 Test Loss: 0.491 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8709616661071777
Epoch: 9, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2116146087646484
Epoch: 10, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.164011001586914
Epoch: 11, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.385 Vali Acc: 0.881 Test Loss: 0.385 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7121696472167969
Epoch: 12, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.422 Vali Acc: 0.788 Test Loss: 0.422 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2367157936096191
Epoch: 13, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.764 Vali Acc: 0.751 Test Loss: 0.764 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.063584327697754
Epoch: 14, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.425 Vali Acc: 0.881 Test Loss: 0.425 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2785463333129883
Epoch: 15, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.556 Vali Acc: 0.782 Test Loss: 0.556 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 23033090
model size : 102.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.557436227798462
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.343 Vali Acc: 0.894 Test Loss: 0.343 Test Acc: 0.894
Validation loss decreased (inf --> -0.894195).  Saving model ...
Epoch: 2 cost time: 0.9578592777252197
Epoch: 2, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2874469757080078
Epoch: 3, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1093883514404297
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8073098659515381
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.567 Vali Acc: 0.628 Test Loss: 0.567 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6567871570587158
Epoch: 6, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.423 Vali Acc: 0.833 Test Loss: 0.423 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1628696918487549
Epoch: 7, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.382 Vali Acc: 0.846 Test Loss: 0.382 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9612042903900146
Epoch: 8, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.353 Vali Acc: 0.884 Test Loss: 0.353 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4239752292633057
Epoch: 9, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.474 Vali Acc: 0.710 Test Loss: 0.474 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0487651824951172
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904434).  Saving model ...
Epoch: 11 cost time: 1.0406486988067627
Epoch: 11, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.337 Vali Acc: 0.904 Test Loss: 0.337 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8607468605041504
Epoch: 12, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.398 Vali Acc: 0.887 Test Loss: 0.398 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0451202392578125
Epoch: 13, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.586 Vali Acc: 0.823 Test Loss: 0.586 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2666683197021484
Epoch: 14, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.036172866821289
Epoch: 15, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.357 Vali Acc: 0.891 Test Loss: 0.357 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4990322589874268
Epoch: 16, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.354 Vali Acc: 0.898 Test Loss: 0.354 Test Acc: 0.898
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.994757890701294
Epoch: 17, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.038039207458496
Epoch: 18, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.418 Vali Acc: 0.877 Test Loss: 0.418 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5389604568481445
Epoch: 19, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.710 Vali Acc: 0.853 Test Loss: 0.710 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.074861764907837
Epoch: 20, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.586 Vali Acc: 0.860 Test Loss: 0.586 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 22944002
model size : 102.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.0775647163391113
Epoch: 1, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.471 Vali Acc: 0.846 Test Loss: 0.471 Test Acc: 0.846
Validation loss decreased (inf --> -0.846412).  Saving model ...
Epoch: 2 cost time: 1.3173940181732178
Epoch: 2, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
Validation loss decreased (-0.846412 --> -0.863477).  Saving model ...
Epoch: 3 cost time: 0.9388659000396729
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.374 Vali Acc: 0.877 Test Loss: 0.374 Test Acc: 0.877
Validation loss decreased (-0.863477 --> -0.877129).  Saving model ...
Epoch: 4 cost time: 0.8581874370574951
Epoch: 4, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8469054698944092
Epoch: 5, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8441636562347412
Epoch: 6, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.362 Vali Acc: 0.867 Test Loss: 0.362 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8724765777587891
Epoch: 7, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.393 Vali Acc: 0.826 Test Loss: 0.393 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7556321620941162
Epoch: 8, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.346 Vali Acc: 0.884 Test Loss: 0.346 Test Acc: 0.884
Validation loss decreased (-0.877129 --> -0.883956).  Saving model ...
Epoch: 9 cost time: 0.6357409954071045
Epoch: 9, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.339 Vali Acc: 0.863 Test Loss: 0.339 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8538210391998291
Epoch: 10, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.266 Vali Acc: 0.908 Test Loss: 0.266 Test Acc: 0.908
Validation loss decreased (-0.883956 --> -0.907847).  Saving model ...
Epoch: 11 cost time: 0.885570764541626
Epoch: 11, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.411 Vali Acc: 0.850 Test Loss: 0.411 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8517155647277832
Epoch: 12, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.458 Vali Acc: 0.846 Test Loss: 0.458 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9325671195983887
Epoch: 13, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8935189247131348
Epoch: 14, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8374898433685303
Epoch: 15, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6813375949859619
Epoch: 16, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.365 Vali Acc: 0.901 Test Loss: 0.365 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9022026062011719
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.518 Vali Acc: 0.829 Test Loss: 0.518 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8540427684783936
Epoch: 18, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.588 Vali Acc: 0.836 Test Loss: 0.588 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8992242813110352
Epoch: 19, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.593 Vali Acc: 0.836 Test Loss: 0.593 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8472282886505127
Epoch: 20, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 22894850
model size : 102.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps56_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7129082679748535
Epoch: 1, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 1.4679112434387207
Epoch: 2, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.385 Vali Acc: 0.894 Test Loss: 0.385 Test Acc: 0.894
Validation loss decreased (-0.883955 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 1.1825332641601562
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.423 Vali Acc: 0.846 Test Loss: 0.423 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6837446689605713
Epoch: 4, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.420 Vali Acc: 0.836 Test Loss: 0.420 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2847638130187988
Epoch: 5, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.363 Vali Acc: 0.874 Test Loss: 0.363 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8056344985961914
Epoch: 6, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.688 Vali Acc: 0.706 Test Loss: 0.688 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3472793102264404
Epoch: 7, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.502 Vali Acc: 0.771 Test Loss: 0.502 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7334508895874023
Epoch: 8, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.782 Vali Acc: 0.652 Test Loss: 0.782 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4157347679138184
Epoch: 9, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6955218315124512
Epoch: 10, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.498 Vali Acc: 0.823 Test Loss: 0.498 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4608113765716553
Epoch: 11, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.587 Vali Acc: 0.819 Test Loss: 0.587 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.231369972229004
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.663 Vali Acc: 0.785 Test Loss: 0.663 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps56_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 23074562
model size : 102.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps56_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.515307664871216
Epoch: 1, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.371 Vali Acc: 0.891 Test Loss: 0.371 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 1.3684511184692383
Epoch: 2, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.473 Vali Acc: 0.744 Test Loss: 0.473 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1057765483856201
Epoch: 3, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.379 Vali Acc: 0.884 Test Loss: 0.379 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.88106369972229
Epoch: 4, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.417 Vali Acc: 0.867 Test Loss: 0.417 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9711487293243408
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.431 Vali Acc: 0.829 Test Loss: 0.431 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.325761079788208
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.313 Vali Acc: 0.863 Test Loss: 0.313 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.033799648284912
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
Validation loss decreased (-0.890781 --> -0.890782).  Saving model ...
Epoch: 8 cost time: 1.228818655014038
Epoch: 8, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.318 Vali Acc: 0.874 Test Loss: 0.318 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0305073261260986
Epoch: 9, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.465 Vali Acc: 0.823 Test Loss: 0.465 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4383330345153809
Epoch: 10, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.333 Vali Acc: 0.863 Test Loss: 0.333 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0858643054962158
Epoch: 11, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.407299518585205
Epoch: 12, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.346 Vali Acc: 0.843 Test Loss: 0.346 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9148004055023193
Epoch: 13, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.255 Vali Acc: 0.915 Test Loss: 0.255 Test Acc: 0.915
Validation loss decreased (-0.890782 --> -0.914673).  Saving model ...
Epoch: 14 cost time: 1.357578992843628
Epoch: 14, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.17757248878479
Epoch: 15, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4423880577087402
Epoch: 16, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.605 Vali Acc: 0.829 Test Loss: 0.605 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.160783052444458
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.440 Vali Acc: 0.843 Test Loss: 0.440 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.252521276473999
Epoch: 18, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.373 Vali Acc: 0.877 Test Loss: 0.373 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.205244541168213
Epoch: 19, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.461 Vali Acc: 0.901 Test Loss: 0.461 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0272774696350098
Epoch: 20, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.476 Vali Acc: 0.891 Test Loss: 0.476 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9911220073699951
Epoch: 21, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0258476734161377
Epoch: 22, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.607 Vali Acc: 0.843 Test Loss: 0.607 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3861165046691895
Epoch: 23, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.525 Vali Acc: 0.860 Test Loss: 0.525 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps56_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 22982402
model size : 102.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps56_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.7492475509643555
Epoch: 1, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.413 Vali Acc: 0.901 Test Loss: 0.413 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 0.81870436668396
Epoch: 2, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.422 Vali Acc: 0.898 Test Loss: 0.422 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3119447231292725
Epoch: 3, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.370 Vali Acc: 0.894 Test Loss: 0.370 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0160095691680908
Epoch: 4, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.280 Vali Acc: 0.884 Test Loss: 0.280 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8261415958404541
Epoch: 5, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.361 Vali Acc: 0.877 Test Loss: 0.361 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2235708236694336
Epoch: 6, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
Validation loss decreased (-0.901020 --> -0.911260).  Saving model ...
Epoch: 7 cost time: 0.8171234130859375
Epoch: 7, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.282 Vali Acc: 0.884 Test Loss: 0.282 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2331774234771729
Epoch: 8, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.286 Vali Acc: 0.870 Test Loss: 0.286 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9415626525878906
Epoch: 9, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.455 Vali Acc: 0.805 Test Loss: 0.455 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.349205493927002
Epoch: 10, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.407 Vali Acc: 0.788 Test Loss: 0.407 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6628310680389404
Epoch: 11, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.501 Vali Acc: 0.802 Test Loss: 0.501 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2848026752471924
Epoch: 12, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.509 Vali Acc: 0.775 Test Loss: 0.509 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0392181873321533
Epoch: 13, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0157842636108398
Epoch: 14, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.558 Vali Acc: 0.826 Test Loss: 0.558 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1811351776123047
Epoch: 15, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.421 Vali Acc: 0.867 Test Loss: 0.421 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0506391525268555
Epoch: 16, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.733 Vali Acc: 0.768 Test Loss: 0.733 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps56_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 22936322
model size : 102.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps60_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5358049869537354
Epoch: 1, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
Validation loss decreased (inf --> -0.849826).  Saving model ...
Epoch: 2 cost time: 1.0446763038635254
Epoch: 2, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.422 Vali Acc: 0.836 Test Loss: 0.422 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2408840656280518
Epoch: 3, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.349 Vali Acc: 0.894 Test Loss: 0.349 Test Acc: 0.894
Validation loss decreased (-0.849826 --> -0.894194).  Saving model ...
Epoch: 4 cost time: 0.9063456058502197
Epoch: 4, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.409 Vali Acc: 0.823 Test Loss: 0.409 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1941912174224854
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.531 Vali Acc: 0.689 Test Loss: 0.531 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.157984733581543
Epoch: 6, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.545 Vali Acc: 0.659 Test Loss: 0.545 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3246557712554932
Epoch: 7, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.390 Vali Acc: 0.829 Test Loss: 0.390 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4022462368011475
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.487 Vali Acc: 0.802 Test Loss: 0.487 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2107222080230713
Epoch: 9, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.340 Vali Acc: 0.881 Test Loss: 0.340 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1369895935058594
Epoch: 10, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.290 Vali Acc: 0.908 Test Loss: 0.290 Test Acc: 0.908
Validation loss decreased (-0.894194 --> -0.907847).  Saving model ...
Epoch: 11 cost time: 1.0756950378417969
Epoch: 11, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4960517883300781
Epoch: 12, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.680 Vali Acc: 0.648 Test Loss: 0.680 Test Acc: 0.648
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1217639446258545
Epoch: 13, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.393 Vali Acc: 0.874 Test Loss: 0.393 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6593718528747559
Epoch: 14, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.566 Vali Acc: 0.802 Test Loss: 0.566 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.171227216720581
Epoch: 15, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.554 Vali Acc: 0.812 Test Loss: 0.554 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1317858695983887
Epoch: 16, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.835374355316162
Epoch: 17, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.785 Vali Acc: 0.771 Test Loss: 0.785 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3285324573516846
Epoch: 18, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.648 Vali Acc: 0.843 Test Loss: 0.648 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2364046573638916
Epoch: 19, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.838 Vali Acc: 0.744 Test Loss: 0.838 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1031577587127686
Epoch: 20, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.627 Vali Acc: 0.874 Test Loss: 0.627 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps60_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 23114498
model size : 102.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps60_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.550211191177368
Epoch: 1, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.327 Vali Acc: 0.908 Test Loss: 0.327 Test Acc: 0.908
Validation loss decreased (inf --> -0.907847).  Saving model ...
Epoch: 2 cost time: 1.1536107063293457
Epoch: 2, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.382 Vali Acc: 0.874 Test Loss: 0.382 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9103124141693115
Epoch: 3, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.426 Vali Acc: 0.823 Test Loss: 0.426 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.466020107269287
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.409 Vali Acc: 0.816 Test Loss: 0.409 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.101074457168579
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4704158306121826
Epoch: 6, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.303 Vali Acc: 0.891 Test Loss: 0.303 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8955934047698975
Epoch: 7, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.395 Vali Acc: 0.857 Test Loss: 0.395 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4350066184997559
Epoch: 8, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.390 Vali Acc: 0.843 Test Loss: 0.390 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8880252838134766
Epoch: 9, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.308 Vali Acc: 0.887 Test Loss: 0.308 Test Acc: 0.887
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8616955280303955
Epoch: 10, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.738 Vali Acc: 0.655 Test Loss: 0.738 Test Acc: 0.655
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7643814086914062
Epoch: 11, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.349 Vali Acc: 0.877 Test Loss: 0.349 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps60_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 23028482
model size : 102.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps60_str60_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.044687271118164
Epoch: 1, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.415 Vali Acc: 0.894 Test Loss: 0.415 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 1.064819097518921
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
Validation loss decreased (-0.894194 --> -0.911259).  Saving model ...
Epoch: 3 cost time: 0.8274648189544678
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.441 Vali Acc: 0.843 Test Loss: 0.441 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1646671295166016
Epoch: 4, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.354 Vali Acc: 0.898 Test Loss: 0.354 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7710340023040771
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.361 Vali Acc: 0.894 Test Loss: 0.361 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1955604553222656
Epoch: 6, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7614874839782715
Epoch: 7, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.303 Vali Acc: 0.915 Test Loss: 0.303 Test Acc: 0.915
Validation loss decreased (-0.911259 --> -0.914673).  Saving model ...
Epoch: 8 cost time: 1.162606954574585
Epoch: 8, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.412 Vali Acc: 0.812 Test Loss: 0.412 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7926867008209229
Epoch: 9, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8479762077331543
Epoch: 10, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.246 Vali Acc: 0.915 Test Loss: 0.246 Test Acc: 0.915
Validation loss decreased (-0.914673 --> -0.914673).  Saving model ...
Epoch: 11 cost time: 0.7908859252929688
Epoch: 11, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.449 Vali Acc: 0.802 Test Loss: 0.449 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8547821044921875
Epoch: 12, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.485 Vali Acc: 0.846 Test Loss: 0.485 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1055829524993896
Epoch: 13, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.455 Vali Acc: 0.846 Test Loss: 0.455 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7456555366516113
Epoch: 14, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.063366413116455
Epoch: 15, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.939683198928833
Epoch: 16, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.391 Vali Acc: 0.874 Test Loss: 0.391 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7123639583587646
Epoch: 17, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.650 Vali Acc: 0.782 Test Loss: 0.650 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1591987609863281
Epoch: 18, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.440 Vali Acc: 0.881 Test Loss: 0.440 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7206814289093018
Epoch: 19, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.553 Vali Acc: 0.802 Test Loss: 0.553 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1597905158996582
Epoch: 20, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.425 Vali Acc: 0.904 Test Loss: 0.425 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps60_str60_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 22985474
model size : 102.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.849555015563965
Epoch: 1, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.372 Vali Acc: 0.846 Test Loss: 0.372 Test Acc: 0.846
Validation loss decreased (inf --> -0.846413).  Saving model ...
Epoch: 2 cost time: 1.1674582958221436
Epoch: 2, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.511 Vali Acc: 0.669 Test Loss: 0.511 Test Acc: 0.669
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9891936779022217
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.410 Vali Acc: 0.874 Test Loss: 0.410 Test Acc: 0.874
Validation loss decreased (-0.846413 --> -0.873716).  Saving model ...
Epoch: 4 cost time: 1.25864577293396
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.399 Vali Acc: 0.843 Test Loss: 0.399 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2551329135894775
Epoch: 5, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
Validation loss decreased (-0.873716 --> -0.877130).  Saving model ...
Epoch: 6 cost time: 1.1214547157287598
Epoch: 6, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.458 Vali Acc: 0.700 Test Loss: 0.458 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0562572479248047
Epoch: 7, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.690 Vali Acc: 0.594 Test Loss: 0.690 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0228829383850098
Epoch: 8, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.472 Vali Acc: 0.730 Test Loss: 0.472 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0498228073120117
Epoch: 9, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.484 Vali Acc: 0.662 Test Loss: 0.484 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.148740530014038
Epoch: 10, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.376 Vali Acc: 0.819 Test Loss: 0.376 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0255000591278076
Epoch: 11, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.318 Vali Acc: 0.904 Test Loss: 0.318 Test Acc: 0.904
Validation loss decreased (-0.877130 --> -0.904434).  Saving model ...
Epoch: 12 cost time: 1.0820999145507812
Epoch: 12, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.505 Vali Acc: 0.840 Test Loss: 0.505 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7674415111541748
Epoch: 13, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.593 Vali Acc: 0.802 Test Loss: 0.593 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2445416450500488
Epoch: 14, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.456 Vali Acc: 0.795 Test Loss: 0.456 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8268797397613525
Epoch: 15, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.457 Vali Acc: 0.802 Test Loss: 0.457 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1955392360687256
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.511 Vali Acc: 0.853 Test Loss: 0.511 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0595026016235352
Epoch: 17, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.668 Vali Acc: 0.689 Test Loss: 0.668 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6494591236114502
Epoch: 18, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.433 Vali Acc: 0.898 Test Loss: 0.433 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3722004890441895
Epoch: 19, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.522 Vali Acc: 0.853 Test Loss: 0.522 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8788390159606934
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.484 Vali Acc: 0.867 Test Loss: 0.484 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2653727531433105
Epoch: 21, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.675 Vali Acc: 0.819 Test Loss: 0.675 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 23160578
model size : 103.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.6152093410491943
Epoch: 1, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.350 Vali Acc: 0.901 Test Loss: 0.350 Test Acc: 0.901
Validation loss decreased (inf --> -0.901020).  Saving model ...
Epoch: 2 cost time: 1.3099563121795654
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.442 Vali Acc: 0.853 Test Loss: 0.442 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9978306293487549
Epoch: 3, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.387 Vali Acc: 0.877 Test Loss: 0.387 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5745136737823486
Epoch: 4, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.518 Vali Acc: 0.782 Test Loss: 0.518 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0869450569152832
Epoch: 5, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.436 Vali Acc: 0.826 Test Loss: 0.436 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2788746356964111
Epoch: 6, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.434 Vali Acc: 0.829 Test Loss: 0.434 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.11259126663208
Epoch: 7, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1767377853393555
Epoch: 8, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.525 Vali Acc: 0.799 Test Loss: 0.525 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7835373878479004
Epoch: 9, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.443 Vali Acc: 0.812 Test Loss: 0.443 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1371839046478271
Epoch: 10, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7217185497283936
Epoch: 11, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 23080706
model size : 102.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5850586891174316
Epoch: 1, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.419 Vali Acc: 0.904 Test Loss: 0.419 Test Acc: 0.904
Validation loss decreased (inf --> -0.904433).  Saving model ...
Epoch: 2 cost time: 0.7553369998931885
Epoch: 2, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.043149709701538
Epoch: 3, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.357 Vali Acc: 0.870 Test Loss: 0.357 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6985964775085449
Epoch: 4, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1194219589233398
Epoch: 5, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.337 Vali Acc: 0.857 Test Loss: 0.337 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9164199829101562
Epoch: 6, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.309 Vali Acc: 0.874 Test Loss: 0.309 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2215385437011719
Epoch: 7, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8127431869506836
Epoch: 8, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.326 Vali Acc: 0.901 Test Loss: 0.326 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9737634658813477
Epoch: 9, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.448 Vali Acc: 0.805 Test Loss: 0.448 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7758305072784424
Epoch: 10, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.297 Vali Acc: 0.881 Test Loss: 0.297 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8422892093658447
Epoch: 11, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.261 Vali Acc: 0.898 Test Loss: 0.261 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 23040770
model size : 102.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps69_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5048093795776367
Epoch: 1, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.425 Vali Acc: 0.802 Test Loss: 0.425 Test Acc: 0.802
Validation loss decreased (inf --> -0.802044).  Saving model ...
Epoch: 2 cost time: 1.0731379985809326
Epoch: 2, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.365 Vali Acc: 0.898 Test Loss: 0.365 Test Acc: 0.898
Validation loss decreased (-0.802044 --> -0.897607).  Saving model ...
Epoch: 3 cost time: 1.0155823230743408
Epoch: 3, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.510 Vali Acc: 0.754 Test Loss: 0.510 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9475669860839844
Epoch: 4, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.387 Vali Acc: 0.840 Test Loss: 0.387 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8850629329681396
Epoch: 5, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.402 Vali Acc: 0.863 Test Loss: 0.402 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0075340270996094
Epoch: 6, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.321 Vali Acc: 0.904 Test Loss: 0.321 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904434).  Saving model ...
Epoch: 7 cost time: 1.0853111743927002
Epoch: 7, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.403 Vali Acc: 0.819 Test Loss: 0.403 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.064314603805542
Epoch: 8, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.369 Vali Acc: 0.843 Test Loss: 0.369 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0266788005828857
Epoch: 9, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.314 Vali Acc: 0.894 Test Loss: 0.314 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0584783554077148
Epoch: 10, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9838986396789551
Epoch: 11, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.303 Vali Acc: 0.908 Test Loss: 0.303 Test Acc: 0.908
Validation loss decreased (-0.904434 --> -0.907847).  Saving model ...
Epoch: 12 cost time: 0.8535921573638916
Epoch: 12, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
Validation loss decreased (-0.907847 --> -0.911260).  Saving model ...
Epoch: 13 cost time: 1.2275643348693848
Epoch: 13, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.330 Vali Acc: 0.901 Test Loss: 0.330 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.253821611404419
Epoch: 14, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.489 Vali Acc: 0.785 Test Loss: 0.489 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1354453563690186
Epoch: 15, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.020280361175537
Epoch: 16, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.680 Vali Acc: 0.819 Test Loss: 0.680 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0394213199615479
Epoch: 17, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.510 Vali Acc: 0.836 Test Loss: 0.510 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.466170310974121
Epoch: 18, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.175624132156372
Epoch: 19, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.490 Vali Acc: 0.857 Test Loss: 0.490 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6665258407592773
Epoch: 20, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0746631622314453
Epoch: 21, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.942 Vali Acc: 0.758 Test Loss: 0.942 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1569221019744873
Epoch: 22, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.645 Vali Acc: 0.891 Test Loss: 0.645 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps69_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 23208194
model size : 103.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps69_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3194916248321533
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.348 Vali Acc: 0.894 Test Loss: 0.348 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 1.3397412300109863
Epoch: 2, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.555 Vali Acc: 0.618 Test Loss: 0.555 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9319674968719482
Epoch: 3, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.477 Vali Acc: 0.666 Test Loss: 0.477 Test Acc: 0.666
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8969428539276123
Epoch: 4, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.433 Vali Acc: 0.754 Test Loss: 0.433 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.425438404083252
Epoch: 5, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.360 Vali Acc: 0.898 Test Loss: 0.360 Test Acc: 0.898
Validation loss decreased (-0.894194 --> -0.897607).  Saving model ...
Epoch: 6 cost time: 1.1538071632385254
Epoch: 6, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.319 Vali Acc: 0.887 Test Loss: 0.319 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9254665374755859
Epoch: 7, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.295 Vali Acc: 0.881 Test Loss: 0.295 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3475162982940674
Epoch: 8, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
Validation loss decreased (-0.897607 --> -0.904434).  Saving model ...
Epoch: 9 cost time: 0.9255373477935791
Epoch: 9, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.295 Vali Acc: 0.901 Test Loss: 0.295 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4445765018463135
Epoch: 10, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.94814133644104
Epoch: 11, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.976597785949707
Epoch: 12, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.298 Vali Acc: 0.898 Test Loss: 0.298 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3217353820800781
Epoch: 13, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.272 Vali Acc: 0.904 Test Loss: 0.272 Test Acc: 0.904
Validation loss decreased (-0.904434 --> -0.904434).  Saving model ...
Epoch: 14 cost time: 1.004894495010376
Epoch: 14, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.343 Vali Acc: 0.887 Test Loss: 0.343 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2235915660858154
Epoch: 15, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.306 Vali Acc: 0.904 Test Loss: 0.306 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7147359848022461
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
Validation loss decreased (-0.904434 --> -0.911260).  Saving model ...
Epoch: 17 cost time: 0.8242366313934326
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.575 Vali Acc: 0.843 Test Loss: 0.575 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.24583101272583
Epoch: 18, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.423 Vali Acc: 0.894 Test Loss: 0.423 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.314516305923462
Epoch: 19, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.449 Vali Acc: 0.874 Test Loss: 0.449 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9867904186248779
Epoch: 20, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.479 Vali Acc: 0.874 Test Loss: 0.479 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3420865535736084
Epoch: 21, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.705 Vali Acc: 0.799 Test Loss: 0.705 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0022611618041992
Epoch: 22, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.484 Vali Acc: 0.829 Test Loss: 0.484 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2008342742919922
Epoch: 23, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.868 Vali Acc: 0.758 Test Loss: 0.868 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1223154067993164
Epoch: 24, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.814 Vali Acc: 0.816 Test Loss: 0.814 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8520715236663818
Epoch: 25, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.545 Vali Acc: 0.826 Test Loss: 0.545 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3983161449432373
Epoch: 26, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.110 Vali Acc: 0.717 Test Loss: 1.110 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps69_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 23140610
model size : 102.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps69_str69_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.2412161827087402
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.385 Vali Acc: 0.874 Test Loss: 0.385 Test Acc: 0.874
Validation loss decreased (inf --> -0.873716).  Saving model ...
Epoch: 2 cost time: 0.7733705043792725
Epoch: 2, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.384 Vali Acc: 0.918 Test Loss: 0.384 Test Acc: 0.918
Validation loss decreased (-0.873716 --> -0.918085).  Saving model ...
Epoch: 3 cost time: 0.7708454132080078
Epoch: 3, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.364 Vali Acc: 0.874 Test Loss: 0.364 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0133488178253174
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.338 Vali Acc: 0.898 Test Loss: 0.338 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8722338676452637
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8060686588287354
Epoch: 6, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.314 Vali Acc: 0.918 Test Loss: 0.314 Test Acc: 0.918
Validation loss decreased (-0.918085 --> -0.918086).  Saving model ...
Epoch: 7 cost time: 0.8833460807800293
Epoch: 7, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.341 Vali Acc: 0.901 Test Loss: 0.341 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7940418720245361
Epoch: 8, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.345 Vali Acc: 0.863 Test Loss: 0.345 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0432429313659668
Epoch: 9, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.322 Vali Acc: 0.881 Test Loss: 0.322 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8092913627624512
Epoch: 10, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.424 Vali Acc: 0.836 Test Loss: 0.424 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.082453966140747
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.417 Vali Acc: 0.829 Test Loss: 0.417 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9029800891876221
Epoch: 12, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.425 Vali Acc: 0.853 Test Loss: 0.425 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8863391876220703
Epoch: 13, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.481 Vali Acc: 0.788 Test Loss: 0.481 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.029172420501709
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.918086 --> -0.921499).  Saving model ...
Epoch: 15 cost time: 0.7908811569213867
Epoch: 15, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.419 Vali Acc: 0.857 Test Loss: 0.419 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7288229465484619
Epoch: 16, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.479 Vali Acc: 0.823 Test Loss: 0.479 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9831280708312988
Epoch: 17, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.537 Vali Acc: 0.805 Test Loss: 0.537 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1322484016418457
Epoch: 18, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7371854782104492
Epoch: 19, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.488 Vali Acc: 0.850 Test Loss: 0.488 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1313927173614502
Epoch: 20, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.420 Vali Acc: 0.901 Test Loss: 0.420 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.827033519744873
Epoch: 21, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.414 Vali Acc: 0.874 Test Loss: 0.414 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8033192157745361
Epoch: 22, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.470 Vali Acc: 0.860 Test Loss: 0.470 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6293480396270752
Epoch: 23, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0228323936462402
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.539 Vali Acc: 0.887 Test Loss: 0.539 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps69_str69_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 23103746
model size : 102.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps75_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.411654233932495
Epoch: 1, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.682 Vali Acc: 0.498 Test Loss: 0.682 Test Acc: 0.498
Validation loss decreased (inf --> -0.498287).  Saving model ...
Epoch: 2 cost time: 1.4346997737884521
Epoch: 2, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.391 Vali Acc: 0.894 Test Loss: 0.391 Test Acc: 0.894
Validation loss decreased (-0.498287 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 1.6094002723693848
Epoch: 3, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.437 Vali Acc: 0.823 Test Loss: 0.437 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.984001874923706
Epoch: 4, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.359 Vali Acc: 0.891 Test Loss: 0.359 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2083182334899902
Epoch: 5, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.391 Vali Acc: 0.860 Test Loss: 0.391 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5930535793304443
Epoch: 6, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.531 Vali Acc: 0.604 Test Loss: 0.531 Test Acc: 0.604
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0961713790893555
Epoch: 7, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.567 Vali Acc: 0.625 Test Loss: 0.567 Test Acc: 0.625
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4533166885375977
Epoch: 8, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.600 Vali Acc: 0.693 Test Loss: 0.600 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0062673091888428
Epoch: 9, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.447 Vali Acc: 0.751 Test Loss: 0.447 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5552527904510498
Epoch: 10, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.375 Vali Acc: 0.843 Test Loss: 0.375 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.203946828842163
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.495 Vali Acc: 0.765 Test Loss: 0.495 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0678646564483643
Epoch: 12, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.384 Vali Acc: 0.860 Test Loss: 0.384 Test Acc: 0.860
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps75_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 23284994
model size : 103.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.392174243927002
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 1.0309858322143555
Epoch: 2, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7829921245574951
Epoch: 3, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.405 Vali Acc: 0.819 Test Loss: 0.405 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6668248176574707
Epoch: 4, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.441 Vali Acc: 0.812 Test Loss: 0.441 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9911739826202393
Epoch: 5, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.305 Vali Acc: 0.874 Test Loss: 0.305 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7260141372680664
Epoch: 6, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.720 Vali Acc: 0.515 Test Loss: 0.720 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0409274101257324
Epoch: 7, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0920054912567139
Epoch: 8, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.369 Vali Acc: 0.857 Test Loss: 0.369 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.54728102684021
Epoch: 9, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.368 Vali Acc: 0.853 Test Loss: 0.368 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1448752880096436
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.442 Vali Acc: 0.850 Test Loss: 0.442 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.309696912765503
Epoch: 11, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.390 Vali Acc: 0.881 Test Loss: 0.390 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 23217410
model size : 103.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps75_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.344356060028076
Epoch: 1, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.387 Vali Acc: 0.891 Test Loss: 0.387 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 0.9745402336120605
Epoch: 2, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.351 Vali Acc: 0.915 Test Loss: 0.351 Test Acc: 0.915
Validation loss decreased (-0.890781 --> -0.914672).  Saving model ...
Epoch: 3 cost time: 0.9666218757629395
Epoch: 3, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.302 Vali Acc: 0.908 Test Loss: 0.302 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.024634838104248
Epoch: 4, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.425 Vali Acc: 0.768 Test Loss: 0.425 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9641969203948975
Epoch: 5, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.390 Vali Acc: 0.816 Test Loss: 0.390 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8659853935241699
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.318 Vali Acc: 0.887 Test Loss: 0.318 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8834109306335449
Epoch: 7, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.294 Vali Acc: 0.881 Test Loss: 0.294 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.902686357498169
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.472 Vali Acc: 0.730 Test Loss: 0.472 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8231332302093506
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.803701639175415
Epoch: 10, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.829 Vali Acc: 0.577 Test Loss: 0.829 Test Acc: 0.577
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7075324058532715
Epoch: 11, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.413 Vali Acc: 0.823 Test Loss: 0.413 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7847864627838135
Epoch: 12, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps75_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 23183618
model size : 103.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps82_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.2471983432769775
Epoch: 1, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.373 Vali Acc: 0.857 Test Loss: 0.373 Test Acc: 0.857
Validation loss decreased (inf --> -0.856652).  Saving model ...
Epoch: 2 cost time: 1.0553572177886963
Epoch: 2, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.410 Vali Acc: 0.867 Test Loss: 0.410 Test Acc: 0.867
Validation loss decreased (-0.856652 --> -0.866890).  Saving model ...
Epoch: 3 cost time: 1.0628681182861328
Epoch: 3, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.390 Vali Acc: 0.887 Test Loss: 0.390 Test Acc: 0.887
Validation loss decreased (-0.866890 --> -0.887368).  Saving model ...
Epoch: 4 cost time: 1.4363045692443848
Epoch: 4, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.434 Vali Acc: 0.816 Test Loss: 0.434 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3821361064910889
Epoch: 5, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.607 Vali Acc: 0.659 Test Loss: 0.607 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4594898223876953
Epoch: 6, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.345 Vali Acc: 0.870 Test Loss: 0.345 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.404679536819458
Epoch: 7, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.693 Vali Acc: 0.543 Test Loss: 0.693 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1546719074249268
Epoch: 8, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.399 Vali Acc: 0.860 Test Loss: 0.399 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.643186330795288
Epoch: 9, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.360 Vali Acc: 0.874 Test Loss: 0.360 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0085570812225342
Epoch: 10, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
Validation loss decreased (-0.887368 --> -0.904434).  Saving model ...
Epoch: 11 cost time: 1.4563984870910645
Epoch: 11, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1970324516296387
Epoch: 12, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.786 Vali Acc: 0.689 Test Loss: 0.786 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9130618572235107
Epoch: 13, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.582 Vali Acc: 0.778 Test Loss: 0.582 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5940814018249512
Epoch: 14, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0131239891052246
Epoch: 15, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.674 Vali Acc: 0.706 Test Loss: 0.674 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8694603443145752
Epoch: 16, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.831 Vali Acc: 0.782 Test Loss: 0.831 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.444159984588623
Epoch: 17, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.868 Vali Acc: 0.683 Test Loss: 0.868 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.945615291595459
Epoch: 18, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.527 Vali Acc: 0.823 Test Loss: 0.527 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.338230848312378
Epoch: 19, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.531 Vali Acc: 0.850 Test Loss: 0.531 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0415706634521484
Epoch: 20, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.737 Vali Acc: 0.823 Test Loss: 0.737 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps82_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 23366402
model size : 103.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps82_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8547823429107666
Epoch: 1, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 0.7720558643341064
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.530508041381836
Epoch: 3, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0722925662994385
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.446 Vali Acc: 0.802 Test Loss: 0.446 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6877350807189941
Epoch: 5, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.358 Vali Acc: 0.840 Test Loss: 0.358 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.719296932220459
Epoch: 6, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4818639755249023
Epoch: 7, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.618 Vali Acc: 0.631 Test Loss: 0.618 Test Acc: 0.631
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.713670015335083
Epoch: 8, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.610 Vali Acc: 0.625 Test Loss: 0.610 Test Acc: 0.625
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4755370616912842
Epoch: 9, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.451 Vali Acc: 0.823 Test Loss: 0.451 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9085958003997803
Epoch: 10, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.517 Vali Acc: 0.761 Test Loss: 0.517 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2162928581237793
Epoch: 11, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.428 Vali Acc: 0.782 Test Loss: 0.428 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps82_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 23308034
model size : 103.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps82_str82_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.698683977127075
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.363 Vali Acc: 0.894 Test Loss: 0.363 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 0.7350757122039795
Epoch: 2, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1900486946105957
Epoch: 3, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.393 Vali Acc: 0.881 Test Loss: 0.393 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8693265914916992
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.308 Vali Acc: 0.894 Test Loss: 0.308 Test Acc: 0.894
Validation loss decreased (-0.894194 --> -0.894195).  Saving model ...
Epoch: 5 cost time: 1.0912103652954102
Epoch: 5, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.373 Vali Acc: 0.874 Test Loss: 0.373 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.699859619140625
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7514312267303467
Epoch: 7, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.302 Vali Acc: 0.904 Test Loss: 0.302 Test Acc: 0.904
Validation loss decreased (-0.894195 --> -0.904434).  Saving model ...
Epoch: 8 cost time: 0.8281431198120117
Epoch: 8, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.308 Vali Acc: 0.904 Test Loss: 0.308 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6473493576049805
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.376 Vali Acc: 0.836 Test Loss: 0.376 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0354597568511963
Epoch: 10, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8870480060577393
Epoch: 11, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.366 Vali Acc: 0.881 Test Loss: 0.366 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2867133617401123
Epoch: 12, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.537 Vali Acc: 0.802 Test Loss: 0.537 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0085139274597168
Epoch: 13, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.389 Vali Acc: 0.857 Test Loss: 0.389 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9969878196716309
Epoch: 14, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.345 Vali Acc: 0.898 Test Loss: 0.345 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0330877304077148
Epoch: 15, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.484 Vali Acc: 0.836 Test Loss: 0.484 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.913841962814331
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.509 Vali Acc: 0.840 Test Loss: 0.509 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.228632926940918
Epoch: 17, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.386 Vali Acc: 0.863 Test Loss: 0.386 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps82_str82_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 23277314
model size : 103.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps90_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8071372509002686
Epoch: 1, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.350 Vali Acc: 0.887 Test Loss: 0.350 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 1.0868725776672363
Epoch: 2, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.435 Vali Acc: 0.857 Test Loss: 0.435 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2225258350372314
Epoch: 3, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.417 Vali Acc: 0.874 Test Loss: 0.417 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1398894786834717
Epoch: 4, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1676268577575684
Epoch: 5, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.329 Vali Acc: 0.904 Test Loss: 0.329 Test Acc: 0.904
Validation loss decreased (-0.887369 --> -0.904434).  Saving model ...
Epoch: 6 cost time: 1.0285017490386963
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.303 Vali Acc: 0.904 Test Loss: 0.303 Test Acc: 0.904
Validation loss decreased (-0.904434 --> -0.904434).  Saving model ...
Epoch: 7 cost time: 0.9524085521697998
Epoch: 7, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.904434 --> -0.911260).  Saving model ...
Epoch: 8 cost time: 1.1917181015014648
Epoch: 8, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.608 Vali Acc: 0.710 Test Loss: 0.608 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3052210807800293
Epoch: 9, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.465 Vali Acc: 0.751 Test Loss: 0.465 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.910921573638916
Epoch: 10, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.373 Vali Acc: 0.816 Test Loss: 0.373 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8440365791320801
Epoch: 11, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.297 Vali Acc: 0.901 Test Loss: 0.297 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9274306297302246
Epoch: 12, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.386 Vali Acc: 0.840 Test Loss: 0.386 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8707165718078613
Epoch: 13, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.410 Vali Acc: 0.877 Test Loss: 0.410 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9403047561645508
Epoch: 14, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.365 Vali Acc: 0.881 Test Loss: 0.365 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8046834468841553
Epoch: 15, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.498 Vali Acc: 0.843 Test Loss: 0.498 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9750392436981201
Epoch: 16, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.473 Vali Acc: 0.857 Test Loss: 0.473 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8962748050689697
Epoch: 17, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps90_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 23467778
model size : 104.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3899075984954834
Epoch: 1, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.317 Vali Acc: 0.898 Test Loss: 0.317 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.5939140319824219
Epoch: 2, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.349 Vali Acc: 0.908 Test Loss: 0.349 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907846).  Saving model ...
Epoch: 3 cost time: 0.8665282726287842
Epoch: 3, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.366 Vali Acc: 0.901 Test Loss: 0.366 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4501585960388184
Epoch: 4, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.403 Vali Acc: 0.881 Test Loss: 0.403 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8086435794830322
Epoch: 5, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7014684677124023
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.329 Vali Acc: 0.901 Test Loss: 0.329 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.472360372543335
Epoch: 7, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.391 Vali Acc: 0.840 Test Loss: 0.391 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0837666988372803
Epoch: 8, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.485 Vali Acc: 0.782 Test Loss: 0.485 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8632900714874268
Epoch: 9, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.324 Vali Acc: 0.898 Test Loss: 0.324 Test Acc: 0.898
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5985426902770996
Epoch: 10, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.505 Vali Acc: 0.765 Test Loss: 0.505 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7918350696563721
Epoch: 11, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.389 Vali Acc: 0.874 Test Loss: 0.389 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7044439315795898
Epoch: 12, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.456 Vali Acc: 0.840 Test Loss: 0.456 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 23412482
model size : 103.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps90_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.429381847381592
Epoch: 1, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.361 Vali Acc: 0.887 Test Loss: 0.361 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 0.6930198669433594
Epoch: 2, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.341 Vali Acc: 0.894 Test Loss: 0.341 Test Acc: 0.894
Validation loss decreased (-0.887368 --> -0.894195).  Saving model ...
Epoch: 3 cost time: 0.6275012493133545
Epoch: 3, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.398 Vali Acc: 0.860 Test Loss: 0.398 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0121619701385498
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.384 Vali Acc: 0.860 Test Loss: 0.384 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7445821762084961
Epoch: 5, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.301 Vali Acc: 0.894 Test Loss: 0.301 Test Acc: 0.894
Validation loss decreased (-0.894195 --> -0.894195).  Saving model ...
Epoch: 6 cost time: 0.6572372913360596
Epoch: 6, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.334 Vali Acc: 0.860 Test Loss: 0.334 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.660283088684082
Epoch: 7, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.408 Vali Acc: 0.816 Test Loss: 0.408 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0545313358306885
Epoch: 8, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.334 Vali Acc: 0.863 Test Loss: 0.334 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6660041809082031
Epoch: 9, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.295 Vali Acc: 0.898 Test Loss: 0.295 Test Acc: 0.898
Validation loss decreased (-0.894195 --> -0.897608).  Saving model ...
Epoch: 10 cost time: 1.0501937866210938
Epoch: 10, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.571 Vali Acc: 0.754 Test Loss: 0.571 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7220702171325684
Epoch: 11, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7533144950866699
Epoch: 12, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.655 Vali Acc: 0.693 Test Loss: 0.655 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.001265048980713
Epoch: 13, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.449 Vali Acc: 0.857 Test Loss: 0.449 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7132241725921631
Epoch: 14, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.471 Vali Acc: 0.840 Test Loss: 0.471 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.048753023147583
Epoch: 15, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0410521030426025
Epoch: 16, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.787041187286377
Epoch: 17, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.650 Vali Acc: 0.816 Test Loss: 0.650 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0127270221710205
Epoch: 18, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.632 Vali Acc: 0.826 Test Loss: 0.632 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7243947982788086
Epoch: 19, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.582 Vali Acc: 0.833 Test Loss: 0.582 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps90_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 23384834
model size : 103.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps100_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.6677868366241455
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.343 Vali Acc: 0.887 Test Loss: 0.343 Test Acc: 0.887
Validation loss decreased (inf --> -0.887369).  Saving model ...
Epoch: 2 cost time: 1.4760768413543701
Epoch: 2, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.336 Vali Acc: 0.881 Test Loss: 0.336 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.941627025604248
Epoch: 3, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.396 Vali Acc: 0.860 Test Loss: 0.396 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9285640716552734
Epoch: 4, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.441 Vali Acc: 0.768 Test Loss: 0.441 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3616762161254883
Epoch: 5, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.469 Vali Acc: 0.761 Test Loss: 0.469 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9217848777770996
Epoch: 6, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
Validation loss decreased (-0.887369 --> -0.911259).  Saving model ...
Epoch: 7 cost time: 1.2022874355316162
Epoch: 7, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.351 Vali Acc: 0.881 Test Loss: 0.351 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.880549430847168
Epoch: 8, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.435 Vali Acc: 0.805 Test Loss: 0.435 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1736762523651123
Epoch: 9, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.439 Vali Acc: 0.823 Test Loss: 0.439 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2863571643829346
Epoch: 10, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.323 Vali Acc: 0.887 Test Loss: 0.323 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.135305404663086
Epoch: 11, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.327 Vali Acc: 0.887 Test Loss: 0.327 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1975648403167725
Epoch: 12, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.498 Vali Acc: 0.799 Test Loss: 0.498 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1637177467346191
Epoch: 13, Steps: 17 | Train Loss: 0.412 Vali Loss: 1.152 Vali Acc: 0.532 Test Loss: 1.152 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1400001049041748
Epoch: 14, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.622 Vali Acc: 0.823 Test Loss: 0.622 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.111262559890747
Epoch: 15, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.585 Vali Acc: 0.782 Test Loss: 0.585 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1509943008422852
Epoch: 16, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.703 Vali Acc: 0.730 Test Loss: 0.703 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps100_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 23593730
model size : 104.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps100_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3657593727111816
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.360 Vali Acc: 0.891 Test Loss: 0.360 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 0.7400760650634766
Epoch: 2, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.355 Vali Acc: 0.894 Test Loss: 0.355 Test Acc: 0.894
Validation loss decreased (-0.890781 --> -0.894194).  Saving model ...
Epoch: 3 cost time: 0.7747666835784912
Epoch: 3, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.379 Vali Acc: 0.863 Test Loss: 0.379 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7566244602203369
Epoch: 4, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.360 Vali Acc: 0.863 Test Loss: 0.360 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.126405954360962
Epoch: 5, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.383 Vali Acc: 0.863 Test Loss: 0.383 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8045926094055176
Epoch: 6, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.386 Vali Acc: 0.867 Test Loss: 0.386 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9281554222106934
Epoch: 7, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.501 Vali Acc: 0.717 Test Loss: 0.501 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3292407989501953
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7829649448394775
Epoch: 9, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.638 Vali Acc: 0.693 Test Loss: 0.638 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8161957263946533
Epoch: 10, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.659 Vali Acc: 0.662 Test Loss: 0.659 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8546149730682373
Epoch: 11, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.564 Vali Acc: 0.799 Test Loss: 0.564 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3858468532562256
Epoch: 12, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.551 Vali Acc: 0.816 Test Loss: 0.551 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps100_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 23544578
model size : 104.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps100_str100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.0284676551818848
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.361 Vali Acc: 0.884 Test Loss: 0.361 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 0.7375679016113281
Epoch: 2, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.337 Vali Acc: 0.904 Test Loss: 0.337 Test Acc: 0.904
Validation loss decreased (-0.883955 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 0.8450438976287842
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.330 Vali Acc: 0.887 Test Loss: 0.330 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.983055591583252
Epoch: 4, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.362 Vali Acc: 0.894 Test Loss: 0.362 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8673908710479736
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.356 Vali Acc: 0.853 Test Loss: 0.356 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0546975135803223
Epoch: 6, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.382 Vali Acc: 0.840 Test Loss: 0.382 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.741058349609375
Epoch: 7, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.321 Vali Acc: 0.874 Test Loss: 0.321 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7887523174285889
Epoch: 8, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.461 Vali Acc: 0.805 Test Loss: 0.461 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9984636306762695
Epoch: 9, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.385 Vali Acc: 0.836 Test Loss: 0.385 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.046177625656128
Epoch: 10, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.375 Vali Acc: 0.863 Test Loss: 0.375 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8030078411102295
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9101850986480713
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.435 Vali Acc: 0.809 Test Loss: 0.435 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps100_str100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 23520002
model size : 104.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps112_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8727571964263916
Epoch: 1, Steps: 17 | Train Loss: 0.690 Vali Loss: 0.345 Vali Acc: 0.881 Test Loss: 0.345 Test Acc: 0.881
Validation loss decreased (inf --> -0.880543).  Saving model ...
Epoch: 2 cost time: 0.8565971851348877
Epoch: 2, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.394 Vali Acc: 0.887 Test Loss: 0.394 Test Acc: 0.887
Validation loss decreased (-0.880543 --> -0.887368).  Saving model ...
Epoch: 3 cost time: 1.4203968048095703
Epoch: 3, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8512961864471436
Epoch: 4, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.540 Vali Acc: 0.765 Test Loss: 0.540 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8817963600158691
Epoch: 5, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.436 Vali Acc: 0.795 Test Loss: 0.436 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5229735374450684
Epoch: 6, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.336 Vali Acc: 0.894 Test Loss: 0.336 Test Acc: 0.894
Validation loss decreased (-0.887368 --> -0.894195).  Saving model ...
Epoch: 7 cost time: 1.019993543624878
Epoch: 7, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.432124376296997
Epoch: 8, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.369 Vali Acc: 0.812 Test Loss: 0.369 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9821467399597168
Epoch: 9, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3913476467132568
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8561725616455078
Epoch: 11, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.362 Vali Acc: 0.863 Test Loss: 0.362 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0388319492340088
Epoch: 12, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.620 Vali Acc: 0.686 Test Loss: 0.620 Test Acc: 0.686
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4669709205627441
Epoch: 13, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.496 Vali Acc: 0.816 Test Loss: 0.496 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0851318836212158
Epoch: 14, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.457 Vali Acc: 0.846 Test Loss: 0.457 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.317131519317627
Epoch: 15, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.573 Vali Acc: 0.782 Test Loss: 0.573 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2607741355895996
Epoch: 16, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.551 Vali Acc: 0.870 Test Loss: 0.551 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps112_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.89419795221843
model parameter : 23750402
model size : 105.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps112_str56_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.837589979171753
Epoch: 1, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.409 Vali Acc: 0.881 Test Loss: 0.409 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 0.9726173877716064
Epoch: 2, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
Validation loss decreased (-0.880542 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 0.7954611778259277
Epoch: 3, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.403 Vali Acc: 0.901 Test Loss: 0.403 Test Acc: 0.901
Validation loss decreased (-0.890781 --> -0.901020).  Saving model ...
Epoch: 4 cost time: 0.7637629508972168
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.342 Vali Acc: 0.901 Test Loss: 0.342 Test Acc: 0.901
Validation loss decreased (-0.901020 --> -0.901020).  Saving model ...
Epoch: 5 cost time: 0.9083325862884521
Epoch: 5, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.316 Vali Acc: 0.904 Test Loss: 0.316 Test Acc: 0.904
Validation loss decreased (-0.901020 --> -0.904434).  Saving model ...
Epoch: 6 cost time: 0.9242057800292969
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.243 Vali Acc: 0.932 Test Loss: 0.243 Test Acc: 0.932
Validation loss decreased (-0.904434 --> -0.931738).  Saving model ...
Epoch: 7 cost time: 0.8063571453094482
Epoch: 7, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.312 Vali Acc: 0.884 Test Loss: 0.312 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7227139472961426
Epoch: 8, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.544 Vali Acc: 0.676 Test Loss: 0.544 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9355669021606445
Epoch: 9, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.360 Vali Acc: 0.860 Test Loss: 0.360 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9121153354644775
Epoch: 10, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.379 Vali Acc: 0.857 Test Loss: 0.379 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7224030494689941
Epoch: 11, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.374 Vali Acc: 0.853 Test Loss: 0.374 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9016125202178955
Epoch: 12, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.354 Vali Acc: 0.863 Test Loss: 0.354 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9478957653045654
Epoch: 13, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.344 Vali Acc: 0.901 Test Loss: 0.344 Test Acc: 0.901
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9207885265350342
Epoch: 14, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.450 Vali Acc: 0.836 Test Loss: 0.450 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6846714019775391
Epoch: 15, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9344086647033691
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.398 Vali Acc: 0.881 Test Loss: 0.398 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps112_str56_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.931740614334471
model parameter : 23707394
model size : 105.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps112_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3293116092681885
Epoch: 1, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.390 Vali Acc: 0.894 Test Loss: 0.390 Test Acc: 0.894
Validation loss decreased (inf --> -0.894194).  Saving model ...
Epoch: 2 cost time: 0.7649056911468506
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.415 Vali Acc: 0.887 Test Loss: 0.415 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6729934215545654
Epoch: 3, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.796473503112793
Epoch: 4, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
Validation loss decreased (-0.894194 --> -0.911260).  Saving model ...
Epoch: 5 cost time: 0.919647216796875
Epoch: 5, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.284 Vali Acc: 0.898 Test Loss: 0.284 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9300615787506104
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6729238033294678
Epoch: 7, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
Validation loss decreased (-0.911260 --> -0.921499).  Saving model ...
Epoch: 8 cost time: 0.8366391658782959
Epoch: 8, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.283 Vali Acc: 0.908 Test Loss: 0.283 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.013822317123413
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.401 Vali Acc: 0.863 Test Loss: 0.401 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7845988273620605
Epoch: 10, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.342 Vali Acc: 0.870 Test Loss: 0.342 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7448041439056396
Epoch: 11, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.451 Vali Acc: 0.802 Test Loss: 0.451 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7448492050170898
Epoch: 12, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.293 Vali Acc: 0.894 Test Loss: 0.293 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9201264381408691
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
Validation loss decreased (-0.921499 --> -0.924913).  Saving model ...
Epoch: 14 cost time: 0.7241160869598389
Epoch: 14, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.459 Vali Acc: 0.816 Test Loss: 0.459 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6834440231323242
Epoch: 15, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0214147567749023
Epoch: 16, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.354 Vali Acc: 0.904 Test Loss: 0.354 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0854363441467285
Epoch: 17, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.441 Vali Acc: 0.836 Test Loss: 0.441 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8024463653564453
Epoch: 18, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7214624881744385
Epoch: 19, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.589 Vali Acc: 0.823 Test Loss: 0.589 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.614739179611206
Epoch: 20, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.436 Vali Acc: 0.881 Test Loss: 0.436 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7537884712219238
Epoch: 21, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.574 Vali Acc: 0.836 Test Loss: 0.574 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.10984468460083
Epoch: 22, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.556 Vali Acc: 0.857 Test Loss: 0.556 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7779281139373779
Epoch: 23, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.655 Vali Acc: 0.833 Test Loss: 0.655 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps112_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9249146757679181
model parameter : 23685890
model size : 105.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.1138226985931396
Epoch: 1, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.366 Vali Acc: 0.908 Test Loss: 0.366 Test Acc: 0.908
Validation loss decreased (inf --> -0.907846).  Saving model ...
Epoch: 2 cost time: 1.0663623809814453
Epoch: 2, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.419 Vali Acc: 0.829 Test Loss: 0.419 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9146108627319336
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.327 Vali Acc: 0.881 Test Loss: 0.327 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4219071865081787
Epoch: 4, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.431 Vali Acc: 0.720 Test Loss: 0.431 Test Acc: 0.720
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9301972389221191
Epoch: 5, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.248 Vali Acc: 0.908 Test Loss: 0.248 Test Acc: 0.908
Validation loss decreased (-0.907846 --> -0.907847).  Saving model ...
Epoch: 6 cost time: 0.8302738666534424
Epoch: 6, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.348 Vali Acc: 0.874 Test Loss: 0.348 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8024716377258301
Epoch: 7, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.311 Vali Acc: 0.891 Test Loss: 0.311 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5426905155181885
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.554 Vali Acc: 0.795 Test Loss: 0.554 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0279667377471924
Epoch: 9, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.638 Vali Acc: 0.758 Test Loss: 0.638 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4487690925598145
Epoch: 10, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.378 Vali Acc: 0.884 Test Loss: 0.378 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9015169143676758
Epoch: 11, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.407 Vali Acc: 0.874 Test Loss: 0.407 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3437223434448242
Epoch: 12, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.728 Vali Acc: 0.792 Test Loss: 0.728 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8864023685455322
Epoch: 13, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.582 Vali Acc: 0.829 Test Loss: 0.582 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3997459411621094
Epoch: 14, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.625 Vali Acc: 0.829 Test Loss: 0.625 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1350979804992676
Epoch: 15, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.448 Vali Acc: 0.891 Test Loss: 0.448 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9078498293515358
model parameter : 23959298
model size : 106.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.406045436859131
Epoch: 1, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.381 Vali Acc: 0.891 Test Loss: 0.381 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 0.8261003494262695
Epoch: 2, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
Validation loss decreased (-0.890781 --> -0.890781).  Saving model ...
Epoch: 3 cost time: 0.8340721130371094
Epoch: 3, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.369 Vali Acc: 0.904 Test Loss: 0.369 Test Acc: 0.904
Validation loss decreased (-0.890781 --> -0.904433).  Saving model ...
Epoch: 4 cost time: 0.7553951740264893
Epoch: 4, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.466 Vali Acc: 0.659 Test Loss: 0.466 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7509713172912598
Epoch: 5, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7301008701324463
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.345 Vali Acc: 0.863 Test Loss: 0.345 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6859960556030273
Epoch: 7, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.355 Vali Acc: 0.874 Test Loss: 0.355 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6970860958099365
Epoch: 8, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.294 Vali Acc: 0.901 Test Loss: 0.294 Test Acc: 0.901
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7362537384033203
Epoch: 9, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.308 Vali Acc: 0.901 Test Loss: 0.308 Test Acc: 0.901
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7290549278259277
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.408 Vali Acc: 0.840 Test Loss: 0.408 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6184933185577393
Epoch: 11, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7173840999603271
Epoch: 12, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.391 Vali Acc: 0.863 Test Loss: 0.391 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7345964908599854
Epoch: 13, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9044368600682594
model parameter : 23922434
model size : 105.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.168588161468506
Epoch: 1, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.406 Vali Acc: 0.863 Test Loss: 0.406 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 1.0285310745239258
Epoch: 2, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.352 Vali Acc: 0.904 Test Loss: 0.352 Test Acc: 0.904
Validation loss decreased (-0.863477 --> -0.904433).  Saving model ...
Epoch: 3 cost time: 0.7788136005401611
Epoch: 3, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
Validation loss decreased (-0.904433 --> -0.911259).  Saving model ...
Epoch: 4 cost time: 0.7431302070617676
Epoch: 4, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
Validation loss decreased (-0.911259 --> -0.911260).  Saving model ...
Epoch: 5 cost time: 1.1312096118927002
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.268 Vali Acc: 0.898 Test Loss: 0.268 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6575329303741455
Epoch: 6, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.244 Vali Acc: 0.908 Test Loss: 0.244 Test Acc: 0.908
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7019577026367188
Epoch: 7, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.368 Vali Acc: 0.850 Test Loss: 0.368 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8732295036315918
Epoch: 8, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.282 Vali Acc: 0.901 Test Loss: 0.282 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7115545272827148
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.367 Vali Acc: 0.853 Test Loss: 0.367 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8365309238433838
Epoch: 10, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.405 Vali Acc: 0.836 Test Loss: 0.405 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8670930862426758
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.480 Vali Acc: 0.823 Test Loss: 0.480 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7753524780273438
Epoch: 12, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.327 Vali Acc: 0.891 Test Loss: 0.327 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9218969345092773
Epoch: 13, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.465 Vali Acc: 0.795 Test Loss: 0.465 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9330086708068848
Epoch: 14, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.435 Vali Acc: 0.853 Test Loss: 0.435 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 23904002
model size : 105.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps150_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.617345094680786
Epoch: 1, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.328 Vali Acc: 0.898 Test Loss: 0.328 Test Acc: 0.898
Validation loss decreased (inf --> -0.897608).  Saving model ...
Epoch: 2 cost time: 1.5005311965942383
Epoch: 2, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.343 Vali Acc: 0.908 Test Loss: 0.343 Test Acc: 0.908
Validation loss decreased (-0.897608 --> -0.907846).  Saving model ...
Epoch: 3 cost time: 1.1018564701080322
Epoch: 3, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.426 Vali Acc: 0.846 Test Loss: 0.426 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4307904243469238
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.319 Vali Acc: 0.915 Test Loss: 0.319 Test Acc: 0.915
Validation loss decreased (-0.907846 --> -0.914673).  Saving model ...
Epoch: 5 cost time: 0.8433327674865723
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.276 Vali Acc: 0.908 Test Loss: 0.276 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8778378963470459
Epoch: 6, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.266 Vali Acc: 0.898 Test Loss: 0.266 Test Acc: 0.898
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5142593383789062
Epoch: 7, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.635 Vali Acc: 0.608 Test Loss: 0.635 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9323110580444336
Epoch: 8, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.654 Vali Acc: 0.710 Test Loss: 0.654 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6401588916778564
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.906 Vali Acc: 0.631 Test Loss: 0.906 Test Acc: 0.631
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.120906114578247
Epoch: 10, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.394 Vali Acc: 0.867 Test Loss: 0.394 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4739837646484375
Epoch: 11, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.432 Vali Acc: 0.843 Test Loss: 0.432 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.28536057472229
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.472 Vali Acc: 0.823 Test Loss: 0.472 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.07582688331604
Epoch: 13, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.486 Vali Acc: 0.836 Test Loss: 0.486 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9288380146026611
Epoch: 14, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps150_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9146757679180887
model parameter : 24248066
model size : 107.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.8349335193634033
Epoch: 1, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.352 Vali Acc: 0.898 Test Loss: 0.352 Test Acc: 0.898
Validation loss decreased (inf --> -0.897607).  Saving model ...
Epoch: 2 cost time: 0.9420099258422852
Epoch: 2, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.429 Vali Acc: 0.857 Test Loss: 0.429 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2064814567565918
Epoch: 3, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.376 Vali Acc: 0.857 Test Loss: 0.376 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8660750389099121
Epoch: 4, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.355 Vali Acc: 0.870 Test Loss: 0.355 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1750469207763672
Epoch: 5, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.342 Vali Acc: 0.853 Test Loss: 0.342 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0477650165557861
Epoch: 6, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.519 Vali Acc: 0.717 Test Loss: 0.519 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8633391857147217
Epoch: 7, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1358287334442139
Epoch: 8, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9088952541351318
Epoch: 9, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.523 Vali Acc: 0.802 Test Loss: 0.523 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0136034488677979
Epoch: 10, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.450 Vali Acc: 0.857 Test Loss: 0.450 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1939442157745361
Epoch: 11, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.340 Vali Acc: 0.881 Test Loss: 0.340 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8976109215017065
model parameter : 24217346
model size : 107.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps150_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5227982997894287
Epoch: 1, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.363 Vali Acc: 0.887 Test Loss: 0.363 Test Acc: 0.887
Validation loss decreased (inf --> -0.887368).  Saving model ...
Epoch: 2 cost time: 0.9638533592224121
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
Validation loss decreased (-0.887368 --> -0.911259).  Saving model ...
Epoch: 3 cost time: 0.7455272674560547
Epoch: 3, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
Validation loss decreased (-0.911259 --> -0.911259).  Saving model ...
Epoch: 4 cost time: 1.0450589656829834
Epoch: 4, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.337 Vali Acc: 0.891 Test Loss: 0.337 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7633821964263916
Epoch: 5, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.441 Vali Acc: 0.840 Test Loss: 0.441 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9292590618133545
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.313 Vali Acc: 0.901 Test Loss: 0.313 Test Acc: 0.901
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9716489315032959
Epoch: 7, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.275 Vali Acc: 0.898 Test Loss: 0.275 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8137645721435547
Epoch: 8, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.348 Vali Acc: 0.843 Test Loss: 0.348 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0717663764953613
Epoch: 9, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.323 Vali Acc: 0.891 Test Loss: 0.323 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7378277778625488
Epoch: 10, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.294 Vali Acc: 0.908 Test Loss: 0.294 Test Acc: 0.908
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7178893089294434
Epoch: 11, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.315 Vali Acc: 0.894 Test Loss: 0.315 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.01658296585083
Epoch: 12, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.314 Vali Acc: 0.908 Test Loss: 0.314 Test Acc: 0.908
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8251488208770752
Epoch: 13, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.545 Vali Acc: 0.788 Test Loss: 0.545 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps150_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 24201986
model size : 106.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps180_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.5070176124572754
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
Validation loss decreased (inf --> -0.883955).  Saving model ...
Epoch: 2 cost time: 0.9365706443786621
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.411 Vali Acc: 0.816 Test Loss: 0.411 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.379800796508789
Epoch: 3, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.439 Vali Acc: 0.840 Test Loss: 0.439 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0407516956329346
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.330 Vali Acc: 0.884 Test Loss: 0.330 Test Acc: 0.884
Validation loss decreased (-0.883955 --> -0.883956).  Saving model ...
Epoch: 5 cost time: 0.9722206592559814
Epoch: 5, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.509 Vali Acc: 0.727 Test Loss: 0.509 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9380147457122803
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.427 Vali Acc: 0.799 Test Loss: 0.427 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9419353008270264
Epoch: 7, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.301 Vali Acc: 0.901 Test Loss: 0.301 Test Acc: 0.901
Validation loss decreased (-0.883956 --> -0.901021).  Saving model ...
Epoch: 8 cost time: 0.9613361358642578
Epoch: 8, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9152472019195557
Epoch: 9, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.406 Vali Acc: 0.853 Test Loss: 0.406 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8746805191040039
Epoch: 10, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.354 Vali Acc: 0.891 Test Loss: 0.354 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9247777462005615
Epoch: 11, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.432 Vali Acc: 0.857 Test Loss: 0.432 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9422719478607178
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.471 Vali Acc: 0.857 Test Loss: 0.471 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9411652088165283
Epoch: 13, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.456 Vali Acc: 0.850 Test Loss: 0.456 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8996386528015137
Epoch: 14, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.485 Vali Acc: 0.836 Test Loss: 0.485 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.921973466873169
Epoch: 15, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.439 Vali Acc: 0.877 Test Loss: 0.439 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8984534740447998
Epoch: 16, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.874 Test Loss: 0.514 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9049239158630371
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.531 Vali Acc: 0.843 Test Loss: 0.531 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps180_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9010238907849829
model parameter : 24650498
model size : 108.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.100863456726074
Epoch: 1, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
Validation loss decreased (inf --> -0.890781).  Saving model ...
Epoch: 2 cost time: 0.665581226348877
Epoch: 2, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.433 Vali Acc: 0.850 Test Loss: 0.433 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7404351234436035
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
Validation loss decreased (-0.890781 --> -0.894195).  Saving model ...
Epoch: 4 cost time: 0.8568480014801025
Epoch: 4, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.348 Vali Acc: 0.860 Test Loss: 0.348 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0762181282043457
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.298 Vali Acc: 0.887 Test Loss: 0.298 Test Acc: 0.887
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2524211406707764
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
Validation loss decreased (-0.894195 --> -0.921499).  Saving model ...
Epoch: 7 cost time: 0.9657652378082275
Epoch: 7, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8364179134368896
Epoch: 8, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1893980503082275
Epoch: 9, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.309 Vali Acc: 0.877 Test Loss: 0.309 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8968040943145752
Epoch: 10, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.267 Vali Acc: 0.901 Test Loss: 0.267 Test Acc: 0.901
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8013341426849365
Epoch: 11, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.291 Vali Acc: 0.881 Test Loss: 0.291 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7892398834228516
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.374 Vali Acc: 0.870 Test Loss: 0.374 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1502628326416016
Epoch: 13, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.573 Vali Acc: 0.754 Test Loss: 0.573 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1025118827819824
Epoch: 14, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.519 Vali Acc: 0.768 Test Loss: 0.519 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9456977844238281
Epoch: 15, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.322 Vali Acc: 0.881 Test Loss: 0.322 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1221110820770264
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.326 Vali Acc: 0.898 Test Loss: 0.326 Test Acc: 0.898
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9215017064846417
model parameter : 24625922
model size : 108.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps180_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 2.3740389347076416
Epoch: 1, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.416 Vali Acc: 0.904 Test Loss: 0.416 Test Acc: 0.904
Validation loss decreased (inf --> -0.904433).  Saving model ...
Epoch: 2 cost time: 0.9782450199127197
Epoch: 2, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.337 Vali Acc: 0.911 Test Loss: 0.337 Test Acc: 0.911
Validation loss decreased (-0.904433 --> -0.911259).  Saving model ...
Epoch: 3 cost time: 1.1295273303985596
Epoch: 3, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.348 Vali Acc: 0.881 Test Loss: 0.348 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8938412666320801
Epoch: 4, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.364 Vali Acc: 0.840 Test Loss: 0.364 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6715881824493408
Epoch: 5, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.252 Vali Acc: 0.908 Test Loss: 0.252 Test Acc: 0.908
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7982563972473145
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.278 Vali Acc: 0.898 Test Loss: 0.278 Test Acc: 0.898
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1235907077789307
Epoch: 7, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.331 Vali Acc: 0.863 Test Loss: 0.331 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.129281997680664
Epoch: 8, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.309 Vali Acc: 0.884 Test Loss: 0.309 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.771247386932373
Epoch: 9, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.299 Vali Acc: 0.887 Test Loss: 0.299 Test Acc: 0.887
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.044546127319336
Epoch: 10, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.364 Vali Acc: 0.867 Test Loss: 0.364 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0497257709503174
Epoch: 11, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.064723014831543
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.355 Vali Acc: 0.863 Test Loss: 0.355 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_GPT4TS_UEA_ftM_sl896_ll0_pl0_el3_dm768_df768_ps180_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.9112627986348123
model parameter : 24613634
model size : 108.56MB
