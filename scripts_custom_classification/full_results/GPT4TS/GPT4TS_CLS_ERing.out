Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.882371425628662
Epoch: 1, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.841 Vali Acc: 0.230 Test Loss: 1.841 Test Acc: 0.230
Validation loss decreased (inf --> -0.229611).  Saving model ...
Epoch: 2 cost time: 0.9958672523498535
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
Validation loss decreased (-0.229611 --> -0.259241).  Saving model ...
Epoch: 3 cost time: 0.8914158344268799
Epoch: 3, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.711 Vali Acc: 0.311 Test Loss: 1.711 Test Acc: 0.311
Validation loss decreased (-0.259241 --> -0.311094).  Saving model ...
Epoch: 4 cost time: 0.9717726707458496
Epoch: 4, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.571 Vali Acc: 0.533 Test Loss: 1.571 Test Acc: 0.533
Validation loss decreased (-0.311094 --> -0.533318).  Saving model ...
Epoch: 5 cost time: 0.9527122974395752
Epoch: 5, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.417 Vali Acc: 0.644 Test Loss: 1.417 Test Acc: 0.644
Validation loss decreased (-0.533318 --> -0.644430).  Saving model ...
Epoch: 6 cost time: 1.1263854503631592
Epoch: 6, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.262 Vali Acc: 0.678 Test Loss: 1.262 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677765).  Saving model ...
Epoch: 7 cost time: 1.041921854019165
Epoch: 7, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.107 Vali Acc: 0.733 Test Loss: 1.107 Test Acc: 0.733
Validation loss decreased (-0.677765 --> -0.733322).  Saving model ...
Epoch: 8 cost time: 0.8727846145629883
Epoch: 8, Steps: 2 | Train Loss: 0.997 Vali Loss: 0.926 Vali Acc: 0.874 Test Loss: 0.926 Test Acc: 0.874
Validation loss decreased (-0.733322 --> -0.874065).  Saving model ...
Epoch: 9 cost time: 1.055027723312378
Epoch: 9, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.774 Vali Acc: 0.911 Test Loss: 0.774 Test Acc: 0.911
Validation loss decreased (-0.874065 --> -0.911103).  Saving model ...
Epoch: 10 cost time: 0.9220328330993652
Epoch: 10, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0719473361968994
Epoch: 11, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918513).  Saving model ...
Epoch: 12 cost time: 1.1386041641235352
Epoch: 12, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.466 Vali Acc: 0.907 Test Loss: 0.466 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9744873046875
Epoch: 13, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.411 Vali Acc: 0.896 Test Loss: 0.411 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.931361198425293
Epoch: 14, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.351 Vali Acc: 0.907 Test Loss: 0.351 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9898993968963623
Epoch: 15, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
Validation loss decreased (-0.918513 --> -0.940738).  Saving model ...
Epoch: 16 cost time: 1.0451555252075195
Epoch: 16, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9565107822418213
Epoch: 17, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9855103492736816
Epoch: 18, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0334997177124023
Epoch: 19, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.235 Vali Acc: 0.904 Test Loss: 0.235 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9330260753631592
Epoch: 20, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9811840057373047
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.7758052349090576
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.9756088256835938
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8193874359130859
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9161853790283203
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.911 Test Loss: 0.198 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8302617073059082
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7685508728027344
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8082914352416992
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8892037868499756
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7556765079498291
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9171164035797119
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8753619194030762
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 43794438
model size : 181.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0221567153930664
Epoch: 1, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.744 Vali Acc: 0.178 Test Loss: 1.744 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.7420909404754639
Epoch: 2, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.707 Vali Acc: 0.481 Test Loss: 1.707 Test Acc: 0.481
Validation loss decreased (-0.177760 --> -0.481464).  Saving model ...
Epoch: 3 cost time: 0.6651105880737305
Epoch: 3, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.664 Vali Acc: 0.544 Test Loss: 1.664 Test Acc: 0.544
Validation loss decreased (-0.481464 --> -0.544428).  Saving model ...
Epoch: 4 cost time: 0.8223452568054199
Epoch: 4, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.584 Vali Acc: 0.659 Test Loss: 1.584 Test Acc: 0.659
Validation loss decreased (-0.544428 --> -0.659243).  Saving model ...
Epoch: 5 cost time: 0.854759931564331
Epoch: 5, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.483 Vali Acc: 0.752 Test Loss: 1.483 Test Acc: 0.752
Validation loss decreased (-0.659243 --> -0.751837).  Saving model ...
Epoch: 6 cost time: 0.7430672645568848
Epoch: 6, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.373 Vali Acc: 0.815 Test Loss: 1.373 Test Acc: 0.815
Validation loss decreased (-0.751837 --> -0.814801).  Saving model ...
Epoch: 7 cost time: 0.7370290756225586
Epoch: 7, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.263 Vali Acc: 0.837 Test Loss: 1.263 Test Acc: 0.837
Validation loss decreased (-0.814801 --> -0.837024).  Saving model ...
Epoch: 8 cost time: 0.7047286033630371
Epoch: 8, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.139 Vali Acc: 0.885 Test Loss: 1.139 Test Acc: 0.885
Validation loss decreased (-0.837024 --> -0.885174).  Saving model ...
Epoch: 9 cost time: 0.8391790390014648
Epoch: 9, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.012 Vali Acc: 0.922 Test Loss: 1.012 Test Acc: 0.922
Validation loss decreased (-0.885174 --> -0.922212).  Saving model ...
Epoch: 10 cost time: 0.9016733169555664
Epoch: 10, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.895 Vali Acc: 0.933 Test Loss: 0.895 Test Acc: 0.933
Validation loss decreased (-0.922212 --> -0.933324).  Saving model ...
Epoch: 11 cost time: 0.7482588291168213
Epoch: 11, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.788 Vali Acc: 0.937 Test Loss: 0.788 Test Acc: 0.937
Validation loss decreased (-0.933324 --> -0.937029).  Saving model ...
Epoch: 12 cost time: 0.7973134517669678
Epoch: 12, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.692 Vali Acc: 0.926 Test Loss: 0.692 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8693208694458008
Epoch: 13, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.605 Vali Acc: 0.933 Test Loss: 0.605 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7109313011169434
Epoch: 14, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.520 Vali Acc: 0.941 Test Loss: 0.520 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940736).  Saving model ...
Epoch: 15 cost time: 0.7540640830993652
Epoch: 15, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.453 Vali Acc: 0.930 Test Loss: 0.453 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7591328620910645
Epoch: 16, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.396 Vali Acc: 0.952 Test Loss: 0.396 Test Acc: 0.952
Validation loss decreased (-0.940736 --> -0.951848).  Saving model ...
Epoch: 17 cost time: 0.8102095127105713
Epoch: 17, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9100039005279541
Epoch: 18, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.330 Vali Acc: 0.915 Test Loss: 0.330 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8353664875030518
Epoch: 19, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7959156036376953
Epoch: 20, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7599811553955078
Epoch: 21, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9231913089752197
Epoch: 22, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7683422565460205
Epoch: 23, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9579722881317139
Epoch: 24, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7541377544403076
Epoch: 25, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7401003837585449
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 43603974
model size : 181.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7406704425811768
Epoch: 1, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.719 Vali Acc: 0.152 Test Loss: 1.719 Test Acc: 0.152
Validation loss decreased (inf --> -0.151835).  Saving model ...
Epoch: 2 cost time: 0.8013777732849121
Epoch: 2, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.683 Vali Acc: 0.352 Test Loss: 1.683 Test Acc: 0.352
Validation loss decreased (-0.151835 --> -0.351835).  Saving model ...
Epoch: 3 cost time: 0.7173657417297363
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.648 Vali Acc: 0.444 Test Loss: 1.648 Test Acc: 0.444
Validation loss decreased (-0.351835 --> -0.444428).  Saving model ...
Epoch: 4 cost time: 0.7191329002380371
Epoch: 4, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.596 Vali Acc: 0.522 Test Loss: 1.596 Test Acc: 0.522
Validation loss decreased (-0.444428 --> -0.522206).  Saving model ...
Epoch: 5 cost time: 0.8289508819580078
Epoch: 5, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.528 Vali Acc: 0.670 Test Loss: 1.528 Test Acc: 0.670
Validation loss decreased (-0.522206 --> -0.670355).  Saving model ...
Epoch: 6 cost time: 0.8610939979553223
Epoch: 6, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.447 Vali Acc: 0.730 Test Loss: 1.447 Test Acc: 0.730
Validation loss decreased (-0.670355 --> -0.729615).  Saving model ...
Epoch: 7 cost time: 0.7821676731109619
Epoch: 7, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.359 Vali Acc: 0.748 Test Loss: 1.359 Test Acc: 0.748
Validation loss decreased (-0.729615 --> -0.748135).  Saving model ...
Epoch: 8 cost time: 0.7300913333892822
Epoch: 8, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.270 Vali Acc: 0.778 Test Loss: 1.270 Test Acc: 0.778
Validation loss decreased (-0.748135 --> -0.777765).  Saving model ...
Epoch: 9 cost time: 0.8752462863922119
Epoch: 9, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.173 Vali Acc: 0.800 Test Loss: 1.173 Test Acc: 0.800
Validation loss decreased (-0.777765 --> -0.799988).  Saving model ...
Epoch: 10 cost time: 0.7412714958190918
Epoch: 10, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.075 Vali Acc: 0.826 Test Loss: 1.075 Test Acc: 0.826
Validation loss decreased (-0.799988 --> -0.825915).  Saving model ...
Epoch: 11 cost time: 0.7140350341796875
Epoch: 11, Steps: 2 | Train Loss: 0.985 Vali Loss: 0.972 Vali Acc: 0.841 Test Loss: 0.972 Test Acc: 0.841
Validation loss decreased (-0.825915 --> -0.840731).  Saving model ...
Epoch: 12 cost time: 0.9177279472351074
Epoch: 12, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.867 Vali Acc: 0.870 Test Loss: 0.867 Test Acc: 0.870
Validation loss decreased (-0.840731 --> -0.870362).  Saving model ...
Epoch: 13 cost time: 0.8452606201171875
Epoch: 13, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.769 Vali Acc: 0.893 Test Loss: 0.769 Test Acc: 0.893
Validation loss decreased (-0.870362 --> -0.892585).  Saving model ...
Epoch: 14 cost time: 0.7490997314453125
Epoch: 14, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.681 Vali Acc: 0.915 Test Loss: 0.681 Test Acc: 0.915
Validation loss decreased (-0.892585 --> -0.914808).  Saving model ...
Epoch: 15 cost time: 0.9108150005340576
Epoch: 15, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.603 Vali Acc: 0.919 Test Loss: 0.603 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 16 cost time: 0.793043851852417
Epoch: 16, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.534 Vali Acc: 0.915 Test Loss: 0.534 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8267598152160645
Epoch: 17, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9840474128723145
Epoch: 18, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.429 Vali Acc: 0.907 Test Loss: 0.429 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0197749137878418
Epoch: 19, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.382 Vali Acc: 0.907 Test Loss: 0.382 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8446059226989746
Epoch: 20, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.335 Vali Acc: 0.915 Test Loss: 0.335 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8371026515960693
Epoch: 21, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918516).  Saving model ...
Epoch: 22 cost time: 1.0897045135498047
Epoch: 22, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.9011795520782471
Epoch: 23, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9626796245574951
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.243 Vali Acc: 0.904 Test Loss: 0.243 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9927003383636475
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.243 Vali Acc: 0.907 Test Loss: 0.243 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0484442710876465
Epoch: 26, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.220 Vali Acc: 0.915 Test Loss: 0.220 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1469638347625732
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.192 Vali Acc: 0.915 Test Loss: 0.192 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9176301956176758
Epoch: 28, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.926 Test Loss: 0.175 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 1.0369353294372559
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.930 Test Loss: 0.167 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 30 cost time: 0.9957592487335205
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
Validation loss decreased (-0.929628 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.8105707168579102
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.933 Test Loss: 0.159 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9233300685882568
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.930 Test Loss: 0.161 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.133500099182129
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.926 Test Loss: 0.166 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9430530071258545
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.922 Test Loss: 0.170 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.139819860458374
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.922 Test Loss: 0.173 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4128470420837402
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.926 Test Loss: 0.175 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8999080657958984
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.926 Test Loss: 0.180 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7972333431243896
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8771731853485107
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.102104663848877
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 43536390
model size : 180.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2801401615142822
Epoch: 1, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.804 Vali Acc: 0.156 Test Loss: 1.804 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.8069298267364502
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.774 Vali Acc: 0.219 Test Loss: 1.774 Test Acc: 0.219
Validation loss decreased (-0.155538 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.8231847286224365
Epoch: 3, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.735 Vali Acc: 0.315 Test Loss: 1.735 Test Acc: 0.315
Validation loss decreased (-0.218501 --> -0.314797).  Saving model ...
Epoch: 4 cost time: 0.7322499752044678
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.586 Vali Acc: 0.352 Test Loss: 1.586 Test Acc: 0.352
Validation loss decreased (-0.314797 --> -0.351836).  Saving model ...
Epoch: 5 cost time: 0.7869434356689453
Epoch: 5, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.408 Vali Acc: 0.611 Test Loss: 1.408 Test Acc: 0.611
Validation loss decreased (-0.351836 --> -0.611097).  Saving model ...
Epoch: 6 cost time: 0.9144201278686523
Epoch: 6, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.236 Vali Acc: 0.822 Test Loss: 1.236 Test Acc: 0.822
Validation loss decreased (-0.611097 --> -0.822210).  Saving model ...
Epoch: 7 cost time: 0.9238159656524658
Epoch: 7, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.085 Vali Acc: 0.741 Test Loss: 1.085 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.017054796218872
Epoch: 8, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.931 Vali Acc: 0.796 Test Loss: 0.931 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0784788131713867
Epoch: 9, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.782 Vali Acc: 0.907 Test Loss: 0.782 Test Acc: 0.907
Validation loss decreased (-0.822210 --> -0.907400).  Saving model ...
Epoch: 10 cost time: 0.7845776081085205
Epoch: 10, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.665 Vali Acc: 0.922 Test Loss: 0.665 Test Acc: 0.922
Validation loss decreased (-0.907400 --> -0.922216).  Saving model ...
Epoch: 11 cost time: 0.9717147350311279
Epoch: 11, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.582 Vali Acc: 0.904 Test Loss: 0.582 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7862751483917236
Epoch: 12, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.498 Vali Acc: 0.922 Test Loss: 0.498 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 13 cost time: 0.9127824306488037
Epoch: 13, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.428 Vali Acc: 0.915 Test Loss: 0.428 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9382534027099609
Epoch: 14, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 15 cost time: 1.0213782787322998
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
Validation loss decreased (-0.922218 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.888221025466919
Epoch: 16, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.283 Vali Acc: 0.919 Test Loss: 0.283 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8400323390960693
Epoch: 17, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1331989765167236
Epoch: 18, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8229012489318848
Epoch: 19, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8046572208404541
Epoch: 20, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9490697383880615
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7576305866241455
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.8317451477050781
Epoch: 23, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.772921085357666
Epoch: 24, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8875031471252441
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.885551929473877
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8773260116577148
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8209211826324463
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9270303249359131
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9808058738708496
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8947794437408447
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.182831048965454
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 43797510
model size : 181.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.177184581756592
Epoch: 1, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.867 Vali Acc: 0.015 Test Loss: 1.867 Test Acc: 0.015
Validation loss decreased (inf --> -0.014796).  Saving model ...
Epoch: 2 cost time: 0.901742696762085
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.827 Vali Acc: 0.200 Test Loss: 1.827 Test Acc: 0.200
Validation loss decreased (-0.014796 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.8531191349029541
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.788 Vali Acc: 0.319 Test Loss: 1.788 Test Acc: 0.319
Validation loss decreased (-0.199982 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.9346625804901123
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.707 Vali Acc: 0.411 Test Loss: 1.707 Test Acc: 0.411
Validation loss decreased (-0.318501 --> -0.411094).  Saving model ...
Epoch: 5 cost time: 0.9675159454345703
Epoch: 5, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.604 Vali Acc: 0.589 Test Loss: 1.604 Test Acc: 0.589
Validation loss decreased (-0.411094 --> -0.588873).  Saving model ...
Epoch: 6 cost time: 0.745546817779541
Epoch: 6, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.484 Vali Acc: 0.644 Test Loss: 1.484 Test Acc: 0.644
Validation loss decreased (-0.588873 --> -0.644430).  Saving model ...
Epoch: 7 cost time: 0.9135997295379639
Epoch: 7, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.357 Vali Acc: 0.833 Test Loss: 1.357 Test Acc: 0.833
Validation loss decreased (-0.644430 --> -0.833320).  Saving model ...
Epoch: 8 cost time: 0.6793954372406006
Epoch: 8, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.233 Vali Acc: 0.848 Test Loss: 1.233 Test Acc: 0.848
Validation loss decreased (-0.833320 --> -0.848136).  Saving model ...
Epoch: 9 cost time: 0.8235106468200684
Epoch: 9, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.112 Vali Acc: 0.859 Test Loss: 1.112 Test Acc: 0.859
Validation loss decreased (-0.848136 --> -0.859248).  Saving model ...
Epoch: 10 cost time: 0.6750979423522949
Epoch: 10, Steps: 2 | Train Loss: 0.974 Vali Loss: 0.991 Vali Acc: 0.893 Test Loss: 0.991 Test Acc: 0.893
Validation loss decreased (-0.859248 --> -0.892583).  Saving model ...
Epoch: 11 cost time: 0.8079640865325928
Epoch: 11, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.882 Vali Acc: 0.904 Test Loss: 0.882 Test Acc: 0.904
Validation loss decreased (-0.892583 --> -0.903695).  Saving model ...
Epoch: 12 cost time: 0.7421832084655762
Epoch: 12, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.777 Vali Acc: 0.926 Test Loss: 0.777 Test Acc: 0.926
Validation loss decreased (-0.903695 --> -0.925918).  Saving model ...
Epoch: 13 cost time: 0.8948001861572266
Epoch: 13, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.685 Vali Acc: 0.926 Test Loss: 0.685 Test Acc: 0.926
Validation loss decreased (-0.925918 --> -0.925919).  Saving model ...
Epoch: 14 cost time: 0.9202108383178711
Epoch: 14, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.602 Vali Acc: 0.922 Test Loss: 0.602 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7592611312866211
Epoch: 15, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.527 Vali Acc: 0.930 Test Loss: 0.527 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929624).  Saving model ...
Epoch: 16 cost time: 0.9024441242218018
Epoch: 16, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.465 Vali Acc: 0.922 Test Loss: 0.465 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8495993614196777
Epoch: 17, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.411 Vali Acc: 0.930 Test Loss: 0.411 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929626).  Saving model ...
Epoch: 18 cost time: 1.198235273361206
Epoch: 18, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.357 Vali Acc: 0.930 Test Loss: 0.357 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 19 cost time: 1.0357756614685059
Epoch: 19, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 1.008683681488037
Epoch: 20, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9673395156860352
Epoch: 21, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 1.0299763679504395
Epoch: 22, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.975916862487793
Epoch: 23, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.158858299255371
Epoch: 24, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.030362606048584
Epoch: 25, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1010866165161133
Epoch: 26, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0262770652770996
Epoch: 27, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0762231349945068
Epoch: 28, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0093214511871338
Epoch: 29, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 1.125321626663208
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9239993095397949
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1011548042297363
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.229231834411621
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7669339179992676
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1326370239257812
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.084341049194336
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0789477825164795
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0121228694915771
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8925001621246338
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43607046
model size : 181.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8281846046447754
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.833 Vali Acc: 0.119 Test Loss: 1.833 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.6934237480163574
Epoch: 2, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.801 Vali Acc: 0.141 Test Loss: 1.801 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.78755784034729
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.771 Vali Acc: 0.226 Test Loss: 1.771 Test Acc: 0.226
Validation loss decreased (-0.140723 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.7738082408905029
Epoch: 4, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.726 Vali Acc: 0.378 Test Loss: 1.726 Test Acc: 0.378
Validation loss decreased (-0.225908 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 0.7109572887420654
Epoch: 5, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.671 Vali Acc: 0.459 Test Loss: 1.671 Test Acc: 0.459
Validation loss decreased (-0.377761 --> -0.459243).  Saving model ...
Epoch: 6 cost time: 0.6808061599731445
Epoch: 6, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.609 Vali Acc: 0.544 Test Loss: 1.609 Test Acc: 0.544
Validation loss decreased (-0.459243 --> -0.544428).  Saving model ...
Epoch: 7 cost time: 0.7058887481689453
Epoch: 7, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.541 Vali Acc: 0.656 Test Loss: 1.541 Test Acc: 0.656
Validation loss decreased (-0.544428 --> -0.655540).  Saving model ...
Epoch: 8 cost time: 0.7903480529785156
Epoch: 8, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.466 Vali Acc: 0.719 Test Loss: 1.466 Test Acc: 0.719
Validation loss decreased (-0.655540 --> -0.718504).  Saving model ...
Epoch: 9 cost time: 0.8770010471343994
Epoch: 9, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.759 Test Loss: 1.387 Test Acc: 0.759
Validation loss decreased (-0.718504 --> -0.759245).  Saving model ...
Epoch: 10 cost time: 0.820349931716919
Epoch: 10, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.308 Vali Acc: 0.793 Test Loss: 1.308 Test Acc: 0.793
Validation loss decreased (-0.759245 --> -0.792580).  Saving model ...
Epoch: 11 cost time: 0.8076426982879639
Epoch: 11, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.224 Vali Acc: 0.844 Test Loss: 1.224 Test Acc: 0.844
Validation loss decreased (-0.792580 --> -0.844432).  Saving model ...
Epoch: 12 cost time: 0.7540850639343262
Epoch: 12, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.139 Vali Acc: 0.870 Test Loss: 1.139 Test Acc: 0.870
Validation loss decreased (-0.844432 --> -0.870359).  Saving model ...
Epoch: 13 cost time: 0.7801718711853027
Epoch: 13, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.054 Vali Acc: 0.856 Test Loss: 1.054 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8494455814361572
Epoch: 14, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.968 Vali Acc: 0.870 Test Loss: 0.968 Test Acc: 0.870
Validation loss decreased (-0.870359 --> -0.870361).  Saving model ...
Epoch: 15 cost time: 0.6948983669281006
Epoch: 15, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.881 Vali Acc: 0.896 Test Loss: 0.881 Test Acc: 0.896
Validation loss decreased (-0.870361 --> -0.896287).  Saving model ...
Epoch: 16 cost time: 0.7957446575164795
Epoch: 16, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.796 Vali Acc: 0.900 Test Loss: 0.796 Test Acc: 0.900
Validation loss decreased (-0.896287 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.738278865814209
Epoch: 17, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.717 Vali Acc: 0.907 Test Loss: 0.717 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 18 cost time: 0.8907396793365479
Epoch: 18, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.641 Vali Acc: 0.915 Test Loss: 0.641 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 19 cost time: 0.7780399322509766
Epoch: 19, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.570 Vali Acc: 0.915 Test Loss: 0.570 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 20 cost time: 0.8114593029022217
Epoch: 20, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.509 Vali Acc: 0.919 Test Loss: 0.509 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 21 cost time: 0.9079256057739258
Epoch: 21, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 22 cost time: 0.8362574577331543
Epoch: 22, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.397 Vali Acc: 0.930 Test Loss: 0.397 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.8126688003540039
Epoch: 23, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.352 Vali Acc: 0.926 Test Loss: 0.352 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8329787254333496
Epoch: 24, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8863983154296875
Epoch: 25, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 1.0439331531524658
Epoch: 26, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8997628688812256
Epoch: 27, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9447855949401855
Epoch: 28, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.870755672454834
Epoch: 29, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 1.028352975845337
Epoch: 30, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9451949596405029
Epoch: 31, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9143128395080566
Epoch: 32, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9227299690246582
Epoch: 33, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1186320781707764
Epoch: 34, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.8847763538360596
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.8366084098815918
Epoch: 36, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.944443941116333
Epoch: 37, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8878006935119629
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0366404056549072
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9992668628692627
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.084207534790039
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.9182548522949219
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1817238330841064
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 1.017326831817627
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0158450603485107
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0485670566558838
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9666640758514404
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.00931978225708
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.2926690578460693
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.154503345489502
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 43514886
model size : 180.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0623373985290527
Epoch: 1, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.769 Vali Acc: 0.256 Test Loss: 1.769 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.8229854106903076
Epoch: 2, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.680 Vali Acc: 0.267 Test Loss: 1.680 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 0.9335923194885254
Epoch: 3, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.614 Vali Acc: 0.426 Test Loss: 1.614 Test Acc: 0.426
Validation loss decreased (-0.266650 --> -0.425910).  Saving model ...
Epoch: 4 cost time: 0.7784113883972168
Epoch: 4, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.534 Vali Acc: 0.544 Test Loss: 1.534 Test Acc: 0.544
Validation loss decreased (-0.425910 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 0.7205862998962402
Epoch: 5, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.432 Vali Acc: 0.696 Test Loss: 1.432 Test Acc: 0.696
Validation loss decreased (-0.544429 --> -0.696282).  Saving model ...
Epoch: 6 cost time: 0.6908435821533203
Epoch: 6, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.320 Vali Acc: 0.730 Test Loss: 1.320 Test Acc: 0.730
Validation loss decreased (-0.696282 --> -0.729616).  Saving model ...
Epoch: 7 cost time: 0.6986544132232666
Epoch: 7, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.207 Vali Acc: 0.707 Test Loss: 1.207 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7592895030975342
Epoch: 8, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.097 Vali Acc: 0.719 Test Loss: 1.097 Test Acc: 0.719
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.165501594543457
Epoch: 9, Steps: 2 | Train Loss: 1.000 Vali Loss: 0.985 Vali Acc: 0.785 Test Loss: 0.985 Test Acc: 0.785
Validation loss decreased (-0.729616 --> -0.785175).  Saving model ...
Epoch: 10 cost time: 0.7828152179718018
Epoch: 10, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.873 Vali Acc: 0.852 Test Loss: 0.873 Test Acc: 0.852
Validation loss decreased (-0.785175 --> -0.851843).  Saving model ...
Epoch: 11 cost time: 0.7516837120056152
Epoch: 11, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.768 Vali Acc: 0.896 Test Loss: 0.768 Test Acc: 0.896
Validation loss decreased (-0.851843 --> -0.896289).  Saving model ...
Epoch: 12 cost time: 0.8569667339324951
Epoch: 12, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.673 Vali Acc: 0.896 Test Loss: 0.673 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 13 cost time: 0.8569800853729248
Epoch: 13, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.585 Vali Acc: 0.915 Test Loss: 0.585 Test Acc: 0.915
Validation loss decreased (-0.896290 --> -0.914809).  Saving model ...
Epoch: 14 cost time: 0.8975117206573486
Epoch: 14, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.515 Vali Acc: 0.907 Test Loss: 0.515 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.817399263381958
Epoch: 15, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.454 Vali Acc: 0.907 Test Loss: 0.454 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7479462623596191
Epoch: 16, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.400 Vali Acc: 0.919 Test Loss: 0.400 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918515).  Saving model ...
Epoch: 17 cost time: 0.8755936622619629
Epoch: 17, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9023656845092773
Epoch: 18, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.327 Vali Acc: 0.926 Test Loss: 0.327 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.8990538120269775
Epoch: 19, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 20 cost time: 0.899834394454956
Epoch: 20, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.7688050270080566
Epoch: 21, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 0.9403669834136963
Epoch: 22, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8794703483581543
Epoch: 23, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 24 cost time: 0.8321106433868408
Epoch: 24, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.8978936672210693
Epoch: 25, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6934876441955566
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6988224983215332
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8615357875823975
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9638521671295166
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.919 Test Loss: 0.200 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8282017707824707
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.919 Test Loss: 0.212 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8914356231689453
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8268759250640869
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8644022941589355
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9450297355651855
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.997302770614624
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.9031057357788086
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9918482303619385
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7830860614776611
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7776534557342529
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8922958374023438
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.924236536026001
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7319867610931396
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7190845012664795
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0068223476409912
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8569784164428711
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43616262
model size : 181.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1323230266571045
Epoch: 1, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.706 Vali Acc: 0.259 Test Loss: 1.706 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.6576387882232666
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.637 Vali Acc: 0.407 Test Loss: 1.637 Test Acc: 0.407
Validation loss decreased (-0.259242 --> -0.407391).  Saving model ...
Epoch: 3 cost time: 0.788548469543457
Epoch: 3, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.585 Vali Acc: 0.593 Test Loss: 1.585 Test Acc: 0.593
Validation loss decreased (-0.407391 --> -0.592577).  Saving model ...
Epoch: 4 cost time: 0.763770580291748
Epoch: 4, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.528 Vali Acc: 0.637 Test Loss: 1.528 Test Acc: 0.637
Validation loss decreased (-0.592577 --> -0.637022).  Saving model ...
Epoch: 5 cost time: 0.7746310234069824
Epoch: 5, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.458 Vali Acc: 0.726 Test Loss: 1.458 Test Acc: 0.726
Validation loss decreased (-0.637022 --> -0.725911).  Saving model ...
Epoch: 6 cost time: 0.8127501010894775
Epoch: 6, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.377 Vali Acc: 0.804 Test Loss: 1.377 Test Acc: 0.804
Validation loss decreased (-0.725911 --> -0.803690).  Saving model ...
Epoch: 7 cost time: 0.8314356803894043
Epoch: 7, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.288 Vali Acc: 0.844 Test Loss: 1.288 Test Acc: 0.844
Validation loss decreased (-0.803690 --> -0.844432).  Saving model ...
Epoch: 8 cost time: 0.8530130386352539
Epoch: 8, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.192 Vali Acc: 0.867 Test Loss: 1.192 Test Acc: 0.867
Validation loss decreased (-0.844432 --> -0.866655).  Saving model ...
Epoch: 9 cost time: 0.9502072334289551
Epoch: 9, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.092 Vali Acc: 0.874 Test Loss: 1.092 Test Acc: 0.874
Validation loss decreased (-0.866655 --> -0.874063).  Saving model ...
Epoch: 10 cost time: 0.8832390308380127
Epoch: 10, Steps: 2 | Train Loss: 1.013 Vali Loss: 0.994 Vali Acc: 0.878 Test Loss: 0.994 Test Acc: 0.878
Validation loss decreased (-0.874063 --> -0.877768).  Saving model ...
Epoch: 11 cost time: 0.708214282989502
Epoch: 11, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.903 Vali Acc: 0.881 Test Loss: 0.903 Test Acc: 0.881
Validation loss decreased (-0.877768 --> -0.881472).  Saving model ...
Epoch: 12 cost time: 0.7589607238769531
Epoch: 12, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.814 Vali Acc: 0.919 Test Loss: 0.814 Test Acc: 0.919
Validation loss decreased (-0.881472 --> -0.918510).  Saving model ...
Epoch: 13 cost time: 0.8030416965484619
Epoch: 13, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.730 Vali Acc: 0.922 Test Loss: 0.730 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922215).  Saving model ...
Epoch: 14 cost time: 0.763458251953125
Epoch: 14, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.652 Vali Acc: 0.911 Test Loss: 0.652 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5760061740875244
Epoch: 15, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.582 Vali Acc: 0.915 Test Loss: 0.582 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6828570365905762
Epoch: 16, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.517 Vali Acc: 0.922 Test Loss: 0.517 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922217).  Saving model ...
Epoch: 17 cost time: 0.6596479415893555
Epoch: 17, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.461 Vali Acc: 0.922 Test Loss: 0.461 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 18 cost time: 0.7521705627441406
Epoch: 18, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.413 Vali Acc: 0.919 Test Loss: 0.413 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6844527721405029
Epoch: 19, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.366 Vali Acc: 0.926 Test Loss: 0.366 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 20 cost time: 0.8530397415161133
Epoch: 20, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.321 Vali Acc: 0.922 Test Loss: 0.321 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7283828258514404
Epoch: 21, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.7078731060028076
Epoch: 22, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6139860153198242
Epoch: 23, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6198694705963135
Epoch: 24, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.696413516998291
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.929627 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.698760986328125
Epoch: 26, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5674054622650146
Epoch: 27, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8191897869110107
Epoch: 28, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8409628868103027
Epoch: 29, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.930 Test Loss: 0.166 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8524186611175537
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6937673091888428
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.560293436050415
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6024572849273682
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8892912864685059
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6844549179077148
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43554822
model size : 180.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0710654258728027
Epoch: 1, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.836 Vali Acc: 0.167 Test Loss: 1.836 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.6213383674621582
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.769 Vali Acc: 0.248 Test Loss: 1.769 Test Acc: 0.248
Validation loss decreased (-0.166648 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.8679747581481934
Epoch: 3, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.724 Vali Acc: 0.270 Test Loss: 1.724 Test Acc: 0.270
Validation loss decreased (-0.248130 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 0.8023326396942139
Epoch: 4, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.680 Vali Acc: 0.341 Test Loss: 1.680 Test Acc: 0.341
Validation loss decreased (-0.270353 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.6267201900482178
Epoch: 5, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.626 Vali Acc: 0.444 Test Loss: 1.626 Test Acc: 0.444
Validation loss decreased (-0.340724 --> -0.444428).  Saving model ...
Epoch: 6 cost time: 0.7099525928497314
Epoch: 6, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.564 Vali Acc: 0.615 Test Loss: 1.564 Test Acc: 0.615
Validation loss decreased (-0.444428 --> -0.614799).  Saving model ...
Epoch: 7 cost time: 0.6474616527557373
Epoch: 7, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.497 Vali Acc: 0.656 Test Loss: 1.497 Test Acc: 0.656
Validation loss decreased (-0.614799 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 0.7415735721588135
Epoch: 8, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.426 Vali Acc: 0.711 Test Loss: 1.426 Test Acc: 0.711
Validation loss decreased (-0.655541 --> -0.711097).  Saving model ...
Epoch: 9 cost time: 0.6642847061157227
Epoch: 9, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.348 Vali Acc: 0.789 Test Loss: 1.348 Test Acc: 0.789
Validation loss decreased (-0.711097 --> -0.788875).  Saving model ...
Epoch: 10 cost time: 0.6999902725219727
Epoch: 10, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.267 Vali Acc: 0.819 Test Loss: 1.267 Test Acc: 0.819
Validation loss decreased (-0.788875 --> -0.818506).  Saving model ...
Epoch: 11 cost time: 0.8444745540618896
Epoch: 11, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.179 Vali Acc: 0.844 Test Loss: 1.179 Test Acc: 0.844
Validation loss decreased (-0.818506 --> -0.844433).  Saving model ...
Epoch: 12 cost time: 0.6165492534637451
Epoch: 12, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.087 Vali Acc: 0.881 Test Loss: 1.087 Test Acc: 0.881
Validation loss decreased (-0.844433 --> -0.881471).  Saving model ...
Epoch: 13 cost time: 0.7358860969543457
Epoch: 13, Steps: 2 | Train Loss: 1.011 Vali Loss: 0.996 Vali Acc: 0.889 Test Loss: 0.996 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888879).  Saving model ...
Epoch: 14 cost time: 0.739877462387085
Epoch: 14, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.908 Vali Acc: 0.926 Test Loss: 0.908 Test Acc: 0.926
Validation loss decreased (-0.888879 --> -0.925917).  Saving model ...
Epoch: 15 cost time: 0.8231117725372314
Epoch: 15, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.824 Vali Acc: 0.926 Test Loss: 0.824 Test Acc: 0.926
Validation loss decreased (-0.925917 --> -0.925918).  Saving model ...
Epoch: 16 cost time: 0.6773226261138916
Epoch: 16, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.741 Vali Acc: 0.930 Test Loss: 0.741 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 17 cost time: 0.7331705093383789
Epoch: 17, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.664 Vali Acc: 0.937 Test Loss: 0.664 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937030).  Saving model ...
Epoch: 18 cost time: 0.7728309631347656
Epoch: 18, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.593 Vali Acc: 0.933 Test Loss: 0.593 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6882302761077881
Epoch: 19, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.528 Vali Acc: 0.937 Test Loss: 0.528 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937032).  Saving model ...
Epoch: 20 cost time: 0.7104122638702393
Epoch: 20, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.469 Vali Acc: 0.937 Test Loss: 0.469 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 21 cost time: 0.7202229499816895
Epoch: 21, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.414 Vali Acc: 0.937 Test Loss: 0.414 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.7748141288757324
Epoch: 22, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.369 Vali Acc: 0.937 Test Loss: 0.369 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 23 cost time: 0.8941905498504639
Epoch: 23, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 0.7594430446624756
Epoch: 24, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.7164840698242188
Epoch: 25, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7085585594177246
Epoch: 26, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7366092205047607
Epoch: 27, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.7363674640655518
Epoch: 28, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6448574066162109
Epoch: 29, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6366527080535889
Epoch: 30, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7412641048431396
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7071506977081299
Epoch: 32, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5584771633148193
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.937 Test Loss: 0.166 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5070958137512207
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7014811038970947
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8220038414001465
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6273324489593506
Epoch: 37, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 43505670
model size : 180.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0646800994873047
Epoch: 1, Steps: 2 | Train Loss: 2.007 Vali Loss: 1.915 Vali Acc: 0.093 Test Loss: 1.915 Test Acc: 0.093
Validation loss decreased (inf --> -0.092573).  Saving model ...
Epoch: 2 cost time: 0.784806489944458
Epoch: 2, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.865 Vali Acc: 0.070 Test Loss: 1.865 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.719353437423706
Epoch: 3, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.832 Vali Acc: 0.081 Test Loss: 1.832 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7238245010375977
Epoch: 4, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.750 Vali Acc: 0.200 Test Loss: 1.750 Test Acc: 0.200
Validation loss decreased (-0.092573 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 0.7822766304016113
Epoch: 5, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.644 Vali Acc: 0.378 Test Loss: 1.644 Test Acc: 0.378
Validation loss decreased (-0.199983 --> -0.377761).  Saving model ...
Epoch: 6 cost time: 0.6683034896850586
Epoch: 6, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.523 Vali Acc: 0.681 Test Loss: 1.523 Test Acc: 0.681
Validation loss decreased (-0.377761 --> -0.681466).  Saving model ...
Epoch: 7 cost time: 0.6698691844940186
Epoch: 7, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.393 Vali Acc: 0.848 Test Loss: 1.393 Test Acc: 0.848
Validation loss decreased (-0.681466 --> -0.848134).  Saving model ...
Epoch: 8 cost time: 0.8099508285522461
Epoch: 8, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.267 Vali Acc: 0.852 Test Loss: 1.267 Test Acc: 0.852
Validation loss decreased (-0.848134 --> -0.851839).  Saving model ...
Epoch: 9 cost time: 0.9094102382659912
Epoch: 9, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.141 Vali Acc: 0.819 Test Loss: 1.141 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8779494762420654
Epoch: 10, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.010 Vali Acc: 0.856 Test Loss: 1.010 Test Acc: 0.856
Validation loss decreased (-0.851839 --> -0.855545).  Saving model ...
Epoch: 11 cost time: 0.8031110763549805
Epoch: 11, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.884 Vali Acc: 0.915 Test Loss: 0.884 Test Acc: 0.915
Validation loss decreased (-0.855545 --> -0.914806).  Saving model ...
Epoch: 12 cost time: 0.8065149784088135
Epoch: 12, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.767 Vali Acc: 0.885 Test Loss: 0.767 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8864138126373291
Epoch: 13, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.669 Vali Acc: 0.859 Test Loss: 0.669 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8677487373352051
Epoch: 14, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.571 Vali Acc: 0.896 Test Loss: 0.571 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8177673816680908
Epoch: 15, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.485 Vali Acc: 0.933 Test Loss: 0.485 Test Acc: 0.933
Validation loss decreased (-0.914806 --> -0.933328).  Saving model ...
Epoch: 16 cost time: 0.6774353981018066
Epoch: 16, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.418 Vali Acc: 0.919 Test Loss: 0.418 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8375239372253418
Epoch: 17, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6701993942260742
Epoch: 18, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7023077011108398
Epoch: 19, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7106161117553711
Epoch: 20, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.253 Vali Acc: 0.907 Test Loss: 0.253 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7044782638549805
Epoch: 21, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7042295932769775
Epoch: 22, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8597164154052734
Epoch: 23, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.880535364151001
Epoch: 24, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.758791446685791
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.904 Test Loss: 0.218 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 43619334
model size : 181.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.646596908569336
Epoch: 1, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.853 Vali Acc: 0.163 Test Loss: 1.853 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.7411715984344482
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.824 Vali Acc: 0.185 Test Loss: 1.824 Test Acc: 0.185
Validation loss decreased (-0.162944 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.7522201538085938
Epoch: 3, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.788 Vali Acc: 0.263 Test Loss: 1.788 Test Acc: 0.263
Validation loss decreased (-0.185167 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 0.6844742298126221
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.728 Vali Acc: 0.300 Test Loss: 1.728 Test Acc: 0.300
Validation loss decreased (-0.262945 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.5880780220031738
Epoch: 5, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.655 Vali Acc: 0.433 Test Loss: 1.655 Test Acc: 0.433
Validation loss decreased (-0.299983 --> -0.433317).  Saving model ...
Epoch: 6 cost time: 0.6072149276733398
Epoch: 6, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.576 Vali Acc: 0.533 Test Loss: 1.576 Test Acc: 0.533
Validation loss decreased (-0.433317 --> -0.533318).  Saving model ...
Epoch: 7 cost time: 0.705225944519043
Epoch: 7, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.496 Vali Acc: 0.589 Test Loss: 1.496 Test Acc: 0.589
Validation loss decreased (-0.533318 --> -0.588874).  Saving model ...
Epoch: 8 cost time: 0.6802749633789062
Epoch: 8, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.406 Vali Acc: 0.733 Test Loss: 1.406 Test Acc: 0.733
Validation loss decreased (-0.588874 --> -0.733319).  Saving model ...
Epoch: 9 cost time: 0.5984516143798828
Epoch: 9, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.306 Vali Acc: 0.807 Test Loss: 1.306 Test Acc: 0.807
Validation loss decreased (-0.733319 --> -0.807394).  Saving model ...
Epoch: 10 cost time: 0.6628072261810303
Epoch: 10, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.204 Vali Acc: 0.848 Test Loss: 1.204 Test Acc: 0.848
Validation loss decreased (-0.807394 --> -0.848136).  Saving model ...
Epoch: 11 cost time: 0.5986933708190918
Epoch: 11, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.107 Vali Acc: 0.863 Test Loss: 1.107 Test Acc: 0.863
Validation loss decreased (-0.848136 --> -0.862952).  Saving model ...
Epoch: 12 cost time: 0.7553672790527344
Epoch: 12, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.008 Vali Acc: 0.848 Test Loss: 1.008 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7464399337768555
Epoch: 13, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.910 Vali Acc: 0.841 Test Loss: 0.910 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7505807876586914
Epoch: 14, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.811 Vali Acc: 0.874 Test Loss: 0.811 Test Acc: 0.874
Validation loss decreased (-0.862952 --> -0.874066).  Saving model ...
Epoch: 15 cost time: 0.7818474769592285
Epoch: 15, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.721 Vali Acc: 0.889 Test Loss: 0.721 Test Acc: 0.889
Validation loss decreased (-0.874066 --> -0.888882).  Saving model ...
Epoch: 16 cost time: 0.7878561019897461
Epoch: 16, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.634 Vali Acc: 0.904 Test Loss: 0.634 Test Acc: 0.904
Validation loss decreased (-0.888882 --> -0.903697).  Saving model ...
Epoch: 17 cost time: 0.7936379909515381
Epoch: 17, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.558 Vali Acc: 0.904 Test Loss: 0.558 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 18 cost time: 0.7580065727233887
Epoch: 18, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.493 Vali Acc: 0.881 Test Loss: 0.493 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8953502178192139
Epoch: 19, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 0.675940752029419
Epoch: 20, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.374 Vali Acc: 0.919 Test Loss: 0.374 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.7658545970916748
Epoch: 21, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7284822463989258
Epoch: 22, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.822162389755249
Epoch: 23, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.272 Vali Acc: 0.904 Test Loss: 0.272 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.715277910232544
Epoch: 24, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6981346607208252
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.266 Vali Acc: 0.900 Test Loss: 0.266 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7446255683898926
Epoch: 26, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7935574054718018
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.270 Vali Acc: 0.896 Test Loss: 0.270 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6443741321563721
Epoch: 28, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7270777225494385
Epoch: 29, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.700979471206665
Epoch: 30, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 43557894
model size : 180.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.944133996963501
Epoch: 1, Steps: 2 | Train Loss: 2.029 Vali Loss: 1.949 Vali Acc: 0.167 Test Loss: 1.949 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6286165714263916
Epoch: 2, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.849 Vali Acc: 0.152 Test Loss: 1.849 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6446428298950195
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.805 Vali Acc: 0.159 Test Loss: 1.805 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6601698398590088
Epoch: 4, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.768 Vali Acc: 0.281 Test Loss: 1.768 Test Acc: 0.281
Validation loss decreased (-0.166647 --> -0.281464).  Saving model ...
Epoch: 5 cost time: 0.5799369812011719
Epoch: 5, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.722 Vali Acc: 0.415 Test Loss: 1.722 Test Acc: 0.415
Validation loss decreased (-0.281464 --> -0.414798).  Saving model ...
Epoch: 6 cost time: 0.6009941101074219
Epoch: 6, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.670 Vali Acc: 0.522 Test Loss: 1.670 Test Acc: 0.522
Validation loss decreased (-0.414798 --> -0.522206).  Saving model ...
Epoch: 7 cost time: 0.6433086395263672
Epoch: 7, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.616 Vali Acc: 0.593 Test Loss: 1.616 Test Acc: 0.593
Validation loss decreased (-0.522206 --> -0.592576).  Saving model ...
Epoch: 8 cost time: 0.5547707080841064
Epoch: 8, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.558 Vali Acc: 0.693 Test Loss: 1.558 Test Acc: 0.693
Validation loss decreased (-0.592576 --> -0.692577).  Saving model ...
Epoch: 9 cost time: 0.6593756675720215
Epoch: 9, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.497 Vali Acc: 0.741 Test Loss: 1.497 Test Acc: 0.741
Validation loss decreased (-0.692577 --> -0.740726).  Saving model ...
Epoch: 10 cost time: 0.5737154483795166
Epoch: 10, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.428 Vali Acc: 0.785 Test Loss: 1.428 Test Acc: 0.785
Validation loss decreased (-0.740726 --> -0.785171).  Saving model ...
Epoch: 11 cost time: 0.7056903839111328
Epoch: 11, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.354 Vali Acc: 0.830 Test Loss: 1.354 Test Acc: 0.830
Validation loss decreased (-0.785171 --> -0.829616).  Saving model ...
Epoch: 12 cost time: 0.688098669052124
Epoch: 12, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.280 Vali Acc: 0.848 Test Loss: 1.280 Test Acc: 0.848
Validation loss decreased (-0.829616 --> -0.848135).  Saving model ...
Epoch: 13 cost time: 0.6631572246551514
Epoch: 13, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.203 Vali Acc: 0.852 Test Loss: 1.203 Test Acc: 0.852
Validation loss decreased (-0.848135 --> -0.851840).  Saving model ...
Epoch: 14 cost time: 0.6179773807525635
Epoch: 14, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.122 Vali Acc: 0.881 Test Loss: 1.122 Test Acc: 0.881
Validation loss decreased (-0.851840 --> -0.881470).  Saving model ...
Epoch: 15 cost time: 0.7110297679901123
Epoch: 15, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.036 Vali Acc: 0.911 Test Loss: 1.036 Test Acc: 0.911
Validation loss decreased (-0.881470 --> -0.911101).  Saving model ...
Epoch: 16 cost time: 0.6616532802581787
Epoch: 16, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.949 Vali Acc: 0.907 Test Loss: 0.949 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6516733169555664
Epoch: 17, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.864 Vali Acc: 0.915 Test Loss: 0.864 Test Acc: 0.915
Validation loss decreased (-0.911101 --> -0.914806).  Saving model ...
Epoch: 18 cost time: 0.7386088371276855
Epoch: 18, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.783 Vali Acc: 0.919 Test Loss: 0.783 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918511).  Saving model ...
Epoch: 19 cost time: 0.5821564197540283
Epoch: 19, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.701 Vali Acc: 0.926 Test Loss: 0.701 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 20 cost time: 0.5729148387908936
Epoch: 20, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.618 Vali Acc: 0.911 Test Loss: 0.618 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6330792903900146
Epoch: 21, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6607208251953125
Epoch: 22, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.471 Vali Acc: 0.896 Test Loss: 0.471 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6823608875274658
Epoch: 23, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.408 Vali Acc: 0.896 Test Loss: 0.408 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6383893489837646
Epoch: 24, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.356 Vali Acc: 0.896 Test Loss: 0.356 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.695549488067627
Epoch: 25, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.82470703125
Epoch: 26, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8743255138397217
Epoch: 27, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7024531364440918
Epoch: 28, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.5848398208618164
Epoch: 29, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6894357204437256
Epoch: 30, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.685582160949707
Epoch: 31, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.233 Vali Acc: 0.915 Test Loss: 0.233 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7283444404602051
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.597357988357544
Epoch: 33, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.241 Vali Acc: 0.904 Test Loss: 0.241 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5694136619567871
Epoch: 34, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.250 Vali Acc: 0.896 Test Loss: 0.250 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7414381504058838
Epoch: 35, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6224286556243896
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.246 Vali Acc: 0.907 Test Loss: 0.246 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6652629375457764
Epoch: 37, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.904 Test Loss: 0.241 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6468944549560547
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.904 Test Loss: 0.235 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 43496454
model size : 180.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.677262306213379
Epoch: 1, Steps: 2 | Train Loss: 1.951 Vali Loss: 1.856 Vali Acc: 0.163 Test Loss: 1.856 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.6818997859954834
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.789 Vali Acc: 0.193 Test Loss: 1.789 Test Acc: 0.193
Validation loss decreased (-0.162944 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.8313603401184082
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.733 Vali Acc: 0.293 Test Loss: 1.733 Test Acc: 0.293
Validation loss decreased (-0.192575 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.7379574775695801
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.647 Vali Acc: 0.404 Test Loss: 1.647 Test Acc: 0.404
Validation loss decreased (-0.292575 --> -0.403687).  Saving model ...
Epoch: 5 cost time: 0.7575106620788574
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.539 Vali Acc: 0.541 Test Loss: 1.539 Test Acc: 0.541
Validation loss decreased (-0.403687 --> -0.540725).  Saving model ...
Epoch: 6 cost time: 0.6979618072509766
Epoch: 6, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.421 Vali Acc: 0.644 Test Loss: 1.421 Test Acc: 0.644
Validation loss decreased (-0.540725 --> -0.644430).  Saving model ...
Epoch: 7 cost time: 0.7203662395477295
Epoch: 7, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.294 Vali Acc: 0.726 Test Loss: 1.294 Test Acc: 0.726
Validation loss decreased (-0.644430 --> -0.725913).  Saving model ...
Epoch: 8 cost time: 0.7576448917388916
Epoch: 8, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.169 Vali Acc: 0.800 Test Loss: 1.169 Test Acc: 0.800
Validation loss decreased (-0.725913 --> -0.799988).  Saving model ...
Epoch: 9 cost time: 0.6555271148681641
Epoch: 9, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.047 Vali Acc: 0.837 Test Loss: 1.047 Test Acc: 0.837
Validation loss decreased (-0.799988 --> -0.837027).  Saving model ...
Epoch: 10 cost time: 0.664376974105835
Epoch: 10, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.933 Vali Acc: 0.859 Test Loss: 0.933 Test Acc: 0.859
Validation loss decreased (-0.837027 --> -0.859250).  Saving model ...
Epoch: 11 cost time: 0.6942400932312012
Epoch: 11, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.824 Vali Acc: 0.870 Test Loss: 0.824 Test Acc: 0.870
Validation loss decreased (-0.859250 --> -0.870362).  Saving model ...
Epoch: 12 cost time: 0.7430830001831055
Epoch: 12, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.720 Vali Acc: 0.893 Test Loss: 0.720 Test Acc: 0.893
Validation loss decreased (-0.870362 --> -0.892585).  Saving model ...
Epoch: 13 cost time: 0.7547683715820312
Epoch: 13, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.627 Vali Acc: 0.922 Test Loss: 0.627 Test Acc: 0.922
Validation loss decreased (-0.892585 --> -0.922216).  Saving model ...
Epoch: 14 cost time: 0.800544023513794
Epoch: 14, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.548 Vali Acc: 0.930 Test Loss: 0.548 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 15 cost time: 0.6880714893341064
Epoch: 15, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.481 Vali Acc: 0.922 Test Loss: 0.481 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.732450008392334
Epoch: 16, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7510864734649658
Epoch: 17, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7267518043518066
Epoch: 18, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8130578994750977
Epoch: 19, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.8647310733795166
Epoch: 20, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.9225120544433594
Epoch: 21, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.7370374202728271
Epoch: 22, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7494714260101318
Epoch: 23, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7564003467559814
Epoch: 24, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.201 Vali Acc: 0.911 Test Loss: 0.201 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7719540596008301
Epoch: 25, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.7425951957702637
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.7191076278686523
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.709277868270874
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7012510299682617
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8273105621337891
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.785846471786499
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7511217594146729
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6518220901489258
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.926 Test Loss: 0.188 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7795305252075195
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7016351222991943
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7607128620147705
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7582728862762451
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43628550
model size : 181.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.522552251815796
Epoch: 1, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.748 Vali Acc: 0.274 Test Loss: 1.748 Test Acc: 0.274
Validation loss decreased (inf --> -0.274057).  Saving model ...
Epoch: 2 cost time: 0.6218314170837402
Epoch: 2, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.715 Vali Acc: 0.181 Test Loss: 1.715 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6069867610931396
Epoch: 3, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.688 Vali Acc: 0.241 Test Loss: 1.688 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7493915557861328
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.646 Vali Acc: 0.359 Test Loss: 1.646 Test Acc: 0.359
Validation loss decreased (-0.274057 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.6559455394744873
Epoch: 5, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.594 Vali Acc: 0.485 Test Loss: 1.594 Test Acc: 0.485
Validation loss decreased (-0.359243 --> -0.485169).  Saving model ...
Epoch: 6 cost time: 0.6422426700592041
Epoch: 6, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.528 Vali Acc: 0.581 Test Loss: 1.528 Test Acc: 0.581
Validation loss decreased (-0.485169 --> -0.581466).  Saving model ...
Epoch: 7 cost time: 0.5491278171539307
Epoch: 7, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.454 Vali Acc: 0.674 Test Loss: 1.454 Test Acc: 0.674
Validation loss decreased (-0.581466 --> -0.674060).  Saving model ...
Epoch: 8 cost time: 0.6920721530914307
Epoch: 8, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.375 Vali Acc: 0.796 Test Loss: 1.375 Test Acc: 0.796
Validation loss decreased (-0.674060 --> -0.796283).  Saving model ...
Epoch: 9 cost time: 0.6234323978424072
Epoch: 9, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.291 Vali Acc: 0.822 Test Loss: 1.291 Test Acc: 0.822
Validation loss decreased (-0.796283 --> -0.822209).  Saving model ...
Epoch: 10 cost time: 0.710629940032959
Epoch: 10, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.203 Vali Acc: 0.819 Test Loss: 1.203 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5423073768615723
Epoch: 11, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.112 Vali Acc: 0.807 Test Loss: 1.112 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6802940368652344
Epoch: 12, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.023 Vali Acc: 0.819 Test Loss: 1.023 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6766135692596436
Epoch: 13, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.933 Vali Acc: 0.844 Test Loss: 0.933 Test Acc: 0.844
Validation loss decreased (-0.822209 --> -0.844435).  Saving model ...
Epoch: 14 cost time: 0.6756703853607178
Epoch: 14, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.848 Vali Acc: 0.878 Test Loss: 0.848 Test Acc: 0.878
Validation loss decreased (-0.844435 --> -0.877769).  Saving model ...
Epoch: 15 cost time: 0.6807284355163574
Epoch: 15, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.767 Vali Acc: 0.896 Test Loss: 0.767 Test Acc: 0.896
Validation loss decreased (-0.877769 --> -0.896289).  Saving model ...
Epoch: 16 cost time: 0.6777665615081787
Epoch: 16, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.692 Vali Acc: 0.911 Test Loss: 0.692 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911104).  Saving model ...
Epoch: 17 cost time: 0.6989576816558838
Epoch: 17, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.621 Vali Acc: 0.922 Test Loss: 0.621 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922216).  Saving model ...
Epoch: 18 cost time: 0.6258342266082764
Epoch: 18, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.549 Vali Acc: 0.937 Test Loss: 0.549 Test Acc: 0.937
Validation loss decreased (-0.922216 --> -0.937032).  Saving model ...
Epoch: 19 cost time: 0.7224249839782715
Epoch: 19, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.483 Vali Acc: 0.941 Test Loss: 0.483 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 20 cost time: 0.7170016765594482
Epoch: 20, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.424 Vali Acc: 0.944 Test Loss: 0.424 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 21 cost time: 0.7371418476104736
Epoch: 21, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.376 Vali Acc: 0.933 Test Loss: 0.376 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7791175842285156
Epoch: 22, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.336 Vali Acc: 0.933 Test Loss: 0.336 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7056958675384521
Epoch: 23, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8286292552947998
Epoch: 24, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7909684181213379
Epoch: 25, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8027002811431885
Epoch: 26, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6734826564788818
Epoch: 27, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6398749351501465
Epoch: 28, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7705931663513184
Epoch: 29, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8937742710113525
Epoch: 30, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 43536390
model size : 180.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.070603132247925
Epoch: 1, Steps: 2 | Train Loss: 2.039 Vali Loss: 1.908 Vali Acc: 0.148 Test Loss: 1.908 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.6697707176208496
Epoch: 2, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.840 Vali Acc: 0.141 Test Loss: 1.840 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.748715877532959
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.800 Vali Acc: 0.144 Test Loss: 1.800 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6662943363189697
Epoch: 4, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.763 Vali Acc: 0.170 Test Loss: 1.763 Test Acc: 0.170
Validation loss decreased (-0.148129 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.7827486991882324
Epoch: 5, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.719 Vali Acc: 0.219 Test Loss: 1.719 Test Acc: 0.219
Validation loss decreased (-0.170353 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.8009088039398193
Epoch: 6, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.670 Vali Acc: 0.356 Test Loss: 1.670 Test Acc: 0.356
Validation loss decreased (-0.218501 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.6770107746124268
Epoch: 7, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.620 Vali Acc: 0.493 Test Loss: 1.620 Test Acc: 0.493
Validation loss decreased (-0.355539 --> -0.492576).  Saving model ...
Epoch: 8 cost time: 0.634962797164917
Epoch: 8, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.565 Vali Acc: 0.589 Test Loss: 1.565 Test Acc: 0.589
Validation loss decreased (-0.492576 --> -0.588873).  Saving model ...
Epoch: 9 cost time: 0.6832351684570312
Epoch: 9, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.506 Vali Acc: 0.663 Test Loss: 1.506 Test Acc: 0.663
Validation loss decreased (-0.588873 --> -0.662948).  Saving model ...
Epoch: 10 cost time: 0.645662784576416
Epoch: 10, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.444 Vali Acc: 0.726 Test Loss: 1.444 Test Acc: 0.726
Validation loss decreased (-0.662948 --> -0.725911).  Saving model ...
Epoch: 11 cost time: 0.7710385322570801
Epoch: 11, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.377 Vali Acc: 0.774 Test Loss: 1.377 Test Acc: 0.774
Validation loss decreased (-0.725911 --> -0.774060).  Saving model ...
Epoch: 12 cost time: 0.6355490684509277
Epoch: 12, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.303 Vali Acc: 0.807 Test Loss: 1.303 Test Acc: 0.807
Validation loss decreased (-0.774060 --> -0.807394).  Saving model ...
Epoch: 13 cost time: 0.6560580730438232
Epoch: 13, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.230 Vali Acc: 0.826 Test Loss: 1.230 Test Acc: 0.826
Validation loss decreased (-0.807394 --> -0.825914).  Saving model ...
Epoch: 14 cost time: 0.6237187385559082
Epoch: 14, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.156 Vali Acc: 0.837 Test Loss: 1.156 Test Acc: 0.837
Validation loss decreased (-0.825914 --> -0.837025).  Saving model ...
Epoch: 15 cost time: 0.5832192897796631
Epoch: 15, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.082 Vali Acc: 0.856 Test Loss: 1.082 Test Acc: 0.856
Validation loss decreased (-0.837025 --> -0.855545).  Saving model ...
Epoch: 16 cost time: 0.7546553611755371
Epoch: 16, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.007 Vali Acc: 0.889 Test Loss: 1.007 Test Acc: 0.889
Validation loss decreased (-0.855545 --> -0.888879).  Saving model ...
Epoch: 17 cost time: 0.5738434791564941
Epoch: 17, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.933 Vali Acc: 0.904 Test Loss: 0.933 Test Acc: 0.904
Validation loss decreased (-0.888879 --> -0.903694).  Saving model ...
Epoch: 18 cost time: 0.6739380359649658
Epoch: 18, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.859 Vali Acc: 0.907 Test Loss: 0.859 Test Acc: 0.907
Validation loss decreased (-0.903694 --> -0.907399).  Saving model ...
Epoch: 19 cost time: 0.5887265205383301
Epoch: 19, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.788 Vali Acc: 0.922 Test Loss: 0.788 Test Acc: 0.922
Validation loss decreased (-0.907399 --> -0.922214).  Saving model ...
Epoch: 20 cost time: 0.6756062507629395
Epoch: 20, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.719 Vali Acc: 0.922 Test Loss: 0.719 Test Acc: 0.922
Validation loss decreased (-0.922214 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.6633868217468262
Epoch: 21, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.649 Vali Acc: 0.922 Test Loss: 0.649 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 22 cost time: 0.6338522434234619
Epoch: 22, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.580 Vali Acc: 0.930 Test Loss: 0.580 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 23 cost time: 0.6599535942077637
Epoch: 23, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.511 Vali Acc: 0.926 Test Loss: 0.511 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6586298942565918
Epoch: 24, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.452 Vali Acc: 0.922 Test Loss: 0.452 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.575808048248291
Epoch: 25, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7037761211395264
Epoch: 26, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7288615703582764
Epoch: 27, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.6536505222320557
Epoch: 28, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.6386966705322266
Epoch: 29, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.7194185256958008
Epoch: 30, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.7501707077026367
Epoch: 31, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6854326725006104
Epoch: 32, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5868344306945801
Epoch: 33, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6909759044647217
Epoch: 34, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.922 Test Loss: 0.182 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7631561756134033
Epoch: 35, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.915 Test Loss: 0.180 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7547991275787354
Epoch: 36, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.919 Test Loss: 0.181 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6925008296966553
Epoch: 37, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.919 Test Loss: 0.179 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7194561958312988
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7957758903503418
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933332).  Saving model ...
Epoch: 40 cost time: 0.6814577579498291
Epoch: 40, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.6531224250793457
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.6662807464599609
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.937 Test Loss: 0.165 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7079184055328369
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6435911655426025
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8096885681152344
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7018013000488281
Epoch: 46, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5613889694213867
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.66379714012146
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7167966365814209
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.5933041572570801
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43499526
model size : 180.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6643362045288086
Epoch: 1, Steps: 2 | Train Loss: 1.979 Vali Loss: 1.925 Vali Acc: 0.100 Test Loss: 1.925 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 0.7378077507019043
Epoch: 2, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.847 Vali Acc: 0.170 Test Loss: 1.847 Test Acc: 0.170
Validation loss decreased (-0.099981 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 1.0781190395355225
Epoch: 3, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.787 Vali Acc: 0.148 Test Loss: 1.787 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7688007354736328
Epoch: 4, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.699 Vali Acc: 0.267 Test Loss: 1.699 Test Acc: 0.267
Validation loss decreased (-0.170352 --> -0.266650).  Saving model ...
Epoch: 5 cost time: 0.9396271705627441
Epoch: 5, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.590 Vali Acc: 0.500 Test Loss: 1.590 Test Acc: 0.500
Validation loss decreased (-0.266650 --> -0.499984).  Saving model ...
Epoch: 6 cost time: 0.6976656913757324
Epoch: 6, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.464 Vali Acc: 0.667 Test Loss: 1.464 Test Acc: 0.667
Validation loss decreased (-0.499984 --> -0.666652).  Saving model ...
Epoch: 7 cost time: 0.7833783626556396
Epoch: 7, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.332 Vali Acc: 0.715 Test Loss: 1.332 Test Acc: 0.715
Validation loss decreased (-0.666652 --> -0.714801).  Saving model ...
Epoch: 8 cost time: 0.6950728893280029
Epoch: 8, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.205 Vali Acc: 0.770 Test Loss: 1.205 Test Acc: 0.770
Validation loss decreased (-0.714801 --> -0.770358).  Saving model ...
Epoch: 9 cost time: 0.7152912616729736
Epoch: 9, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.075 Vali Acc: 0.804 Test Loss: 1.075 Test Acc: 0.804
Validation loss decreased (-0.770358 --> -0.803693).  Saving model ...
Epoch: 10 cost time: 0.7576553821563721
Epoch: 10, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.951 Vali Acc: 0.830 Test Loss: 0.951 Test Acc: 0.830
Validation loss decreased (-0.803693 --> -0.829620).  Saving model ...
Epoch: 11 cost time: 0.6964564323425293
Epoch: 11, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.834 Vali Acc: 0.874 Test Loss: 0.834 Test Acc: 0.874
Validation loss decreased (-0.829620 --> -0.874066).  Saving model ...
Epoch: 12 cost time: 0.7360985279083252
Epoch: 12, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
Validation loss decreased (-0.874066 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.6277124881744385
Epoch: 13, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.635 Vali Acc: 0.904 Test Loss: 0.635 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 14 cost time: 0.7389011383056641
Epoch: 14, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.552 Vali Acc: 0.907 Test Loss: 0.552 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907402).  Saving model ...
Epoch: 15 cost time: 0.7591228485107422
Epoch: 15, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.478 Vali Acc: 0.907 Test Loss: 0.478 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 16 cost time: 0.7065362930297852
Epoch: 16, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.411 Vali Acc: 0.919 Test Loss: 0.411 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918514).  Saving model ...
Epoch: 17 cost time: 0.6612124443054199
Epoch: 17, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.352 Vali Acc: 0.933 Test Loss: 0.352 Test Acc: 0.933
Validation loss decreased (-0.918514 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.6237437725067139
Epoch: 18, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6745240688323975
Epoch: 19, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9787817001342773
Epoch: 20, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8103134632110596
Epoch: 21, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7883467674255371
Epoch: 22, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.776822566986084
Epoch: 23, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7047085762023926
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.907 Test Loss: 0.240 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6018562316894531
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.907 Test Loss: 0.247 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7245147228240967
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7474071979522705
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.907 Test Loss: 0.254 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 43631622
model size : 181.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8061044216156006
Epoch: 1, Steps: 2 | Train Loss: 1.954 Vali Loss: 1.850 Vali Acc: 0.152 Test Loss: 1.850 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.671295166015625
Epoch: 2, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.798 Vali Acc: 0.233 Test Loss: 1.798 Test Acc: 0.233
Validation loss decreased (-0.151833 --> -0.233315).  Saving model ...
Epoch: 3 cost time: 0.7719426155090332
Epoch: 3, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.763 Vali Acc: 0.267 Test Loss: 1.763 Test Acc: 0.267
Validation loss decreased (-0.233315 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.689929723739624
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.716 Vali Acc: 0.385 Test Loss: 1.716 Test Acc: 0.385
Validation loss decreased (-0.266649 --> -0.385168).  Saving model ...
Epoch: 5 cost time: 0.7532854080200195
Epoch: 5, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.655 Vali Acc: 0.504 Test Loss: 1.655 Test Acc: 0.504
Validation loss decreased (-0.385168 --> -0.503687).  Saving model ...
Epoch: 6 cost time: 0.7775053977966309
Epoch: 6, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.585 Vali Acc: 0.607 Test Loss: 1.585 Test Acc: 0.607
Validation loss decreased (-0.503687 --> -0.607392).  Saving model ...
Epoch: 7 cost time: 0.6518735885620117
Epoch: 7, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.503 Vali Acc: 0.700 Test Loss: 1.503 Test Acc: 0.700
Validation loss decreased (-0.607392 --> -0.699985).  Saving model ...
Epoch: 8 cost time: 0.7161667346954346
Epoch: 8, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.417 Vali Acc: 0.726 Test Loss: 1.417 Test Acc: 0.726
Validation loss decreased (-0.699985 --> -0.725912).  Saving model ...
Epoch: 9 cost time: 0.7957890033721924
Epoch: 9, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.326 Vali Acc: 0.789 Test Loss: 1.326 Test Acc: 0.789
Validation loss decreased (-0.725912 --> -0.788876).  Saving model ...
Epoch: 10 cost time: 0.7322654724121094
Epoch: 10, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.231 Vali Acc: 0.830 Test Loss: 1.231 Test Acc: 0.830
Validation loss decreased (-0.788876 --> -0.829617).  Saving model ...
Epoch: 11 cost time: 0.8091366291046143
Epoch: 11, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.139 Vali Acc: 0.870 Test Loss: 1.139 Test Acc: 0.870
Validation loss decreased (-0.829617 --> -0.870359).  Saving model ...
Epoch: 12 cost time: 0.7010476589202881
Epoch: 12, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.048 Vali Acc: 0.874 Test Loss: 1.048 Test Acc: 0.874
Validation loss decreased (-0.870359 --> -0.874064).  Saving model ...
Epoch: 13 cost time: 0.6477196216583252
Epoch: 13, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.958 Vali Acc: 0.896 Test Loss: 0.958 Test Acc: 0.896
Validation loss decreased (-0.874064 --> -0.896287).  Saving model ...
Epoch: 14 cost time: 0.6948657035827637
Epoch: 14, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.866 Vali Acc: 0.904 Test Loss: 0.866 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
Epoch: 15 cost time: 0.7360279560089111
Epoch: 15, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.771 Vali Acc: 0.915 Test Loss: 0.771 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914807).  Saving model ...
Epoch: 16 cost time: 0.6864578723907471
Epoch: 16, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.683 Vali Acc: 0.926 Test Loss: 0.683 Test Acc: 0.926
Validation loss decreased (-0.914807 --> -0.925919).  Saving model ...
Epoch: 17 cost time: 0.7074956893920898
Epoch: 17, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.600 Vali Acc: 0.930 Test Loss: 0.600 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929624).  Saving model ...
Epoch: 18 cost time: 0.621042013168335
Epoch: 18, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.523 Vali Acc: 0.926 Test Loss: 0.523 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7604899406433105
Epoch: 19, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.459 Vali Acc: 0.919 Test Loss: 0.459 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.775681734085083
Epoch: 20, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.408 Vali Acc: 0.904 Test Loss: 0.408 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7245485782623291
Epoch: 21, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.366 Vali Acc: 0.904 Test Loss: 0.366 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7420628070831299
Epoch: 22, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.617279052734375
Epoch: 23, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.6511566638946533
Epoch: 24, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.5962250232696533
Epoch: 25, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5852904319763184
Epoch: 26, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5661537647247314
Epoch: 27, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6045863628387451
Epoch: 28, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.238 Vali Acc: 0.904 Test Loss: 0.238 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6960194110870361
Epoch: 29, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.904 Test Loss: 0.236 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6281993389129639
Epoch: 30, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.904 Test Loss: 0.238 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5520389080047607
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.242 Vali Acc: 0.896 Test Loss: 0.242 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7557423114776611
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.896 Test Loss: 0.244 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6422610282897949
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.251 Vali Acc: 0.896 Test Loss: 0.251 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8065071105957031
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 43545606
model size : 180.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.507495641708374
Epoch: 1, Steps: 2 | Train Loss: 1.999 Vali Loss: 1.895 Vali Acc: 0.178 Test Loss: 1.895 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.594273567199707
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.823 Vali Acc: 0.174 Test Loss: 1.823 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.622051477432251
Epoch: 3, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.780 Vali Acc: 0.167 Test Loss: 1.780 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8459575176239014
Epoch: 4, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.743 Vali Acc: 0.193 Test Loss: 1.743 Test Acc: 0.193
Validation loss decreased (-0.177759 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.633258581161499
Epoch: 5, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.699 Vali Acc: 0.281 Test Loss: 1.699 Test Acc: 0.281
Validation loss decreased (-0.192575 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 0.7088510990142822
Epoch: 6, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.653 Vali Acc: 0.504 Test Loss: 1.653 Test Acc: 0.504
Validation loss decreased (-0.281464 --> -0.503687).  Saving model ...
Epoch: 7 cost time: 0.7543697357177734
Epoch: 7, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.604 Vali Acc: 0.556 Test Loss: 1.604 Test Acc: 0.556
Validation loss decreased (-0.503687 --> -0.555540).  Saving model ...
Epoch: 8 cost time: 0.572899580001831
Epoch: 8, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.551 Vali Acc: 0.607 Test Loss: 1.551 Test Acc: 0.607
Validation loss decreased (-0.555540 --> -0.607392).  Saving model ...
Epoch: 9 cost time: 0.599700927734375
Epoch: 9, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.497 Vali Acc: 0.648 Test Loss: 1.497 Test Acc: 0.648
Validation loss decreased (-0.607392 --> -0.648133).  Saving model ...
Epoch: 10 cost time: 0.6762351989746094
Epoch: 10, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.438 Vali Acc: 0.711 Test Loss: 1.438 Test Acc: 0.711
Validation loss decreased (-0.648133 --> -0.711097).  Saving model ...
Epoch: 11 cost time: 0.6505544185638428
Epoch: 11, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.375 Vali Acc: 0.744 Test Loss: 1.375 Test Acc: 0.744
Validation loss decreased (-0.711097 --> -0.744431).  Saving model ...
Epoch: 12 cost time: 0.7706129550933838
Epoch: 12, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.310 Vali Acc: 0.763 Test Loss: 1.310 Test Acc: 0.763
Validation loss decreased (-0.744431 --> -0.762950).  Saving model ...
Epoch: 13 cost time: 0.6310420036315918
Epoch: 13, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.239 Vali Acc: 0.830 Test Loss: 1.239 Test Acc: 0.830
Validation loss decreased (-0.762950 --> -0.829617).  Saving model ...
Epoch: 14 cost time: 0.8450906276702881
Epoch: 14, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.164 Vali Acc: 0.867 Test Loss: 1.164 Test Acc: 0.867
Validation loss decreased (-0.829617 --> -0.866655).  Saving model ...
Epoch: 15 cost time: 0.7185463905334473
Epoch: 15, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.084 Vali Acc: 0.900 Test Loss: 1.084 Test Acc: 0.900
Validation loss decreased (-0.866655 --> -0.899989).  Saving model ...
Epoch: 16 cost time: 0.6100485324859619
Epoch: 16, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.003 Vali Acc: 0.907 Test Loss: 1.003 Test Acc: 0.907
Validation loss decreased (-0.899989 --> -0.907397).  Saving model ...
Epoch: 17 cost time: 0.5682413578033447
Epoch: 17, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.922 Vali Acc: 0.915 Test Loss: 0.922 Test Acc: 0.915
Validation loss decreased (-0.907397 --> -0.914806).  Saving model ...
Epoch: 18 cost time: 0.8851838111877441
Epoch: 18, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.840 Vali Acc: 0.922 Test Loss: 0.840 Test Acc: 0.922
Validation loss decreased (-0.914806 --> -0.922214).  Saving model ...
Epoch: 19 cost time: 0.6110162734985352
Epoch: 19, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.761 Vali Acc: 0.926 Test Loss: 0.761 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925918).  Saving model ...
Epoch: 20 cost time: 0.7077107429504395
Epoch: 20, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.687 Vali Acc: 0.930 Test Loss: 0.687 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929623).  Saving model ...
Epoch: 21 cost time: 0.5379972457885742
Epoch: 21, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.613 Vali Acc: 0.933 Test Loss: 0.613 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 22 cost time: 0.6482315063476562
Epoch: 22, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.543 Vali Acc: 0.941 Test Loss: 0.543 Test Acc: 0.941
Validation loss decreased (-0.933327 --> -0.940735).  Saving model ...
Epoch: 23 cost time: 0.5260848999023438
Epoch: 23, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.473 Vali Acc: 0.941 Test Loss: 0.473 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 24 cost time: 0.6827678680419922
Epoch: 24, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.410 Vali Acc: 0.937 Test Loss: 0.410 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6815307140350342
Epoch: 25, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 26 cost time: 0.4748866558074951
Epoch: 26, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5308642387390137
Epoch: 27, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6089179515838623
Epoch: 28, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.5404872894287109
Epoch: 29, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.6129326820373535
Epoch: 30, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5989434719085693
Epoch: 31, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.632178783416748
Epoch: 32, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.703723669052124
Epoch: 33, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6987686157226562
Epoch: 34, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5700275897979736
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6662108898162842
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.919 Test Loss: 0.200 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6876118183135986
Epoch: 37, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.926 Test Loss: 0.197 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6949403285980225
Epoch: 38, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5444924831390381
Epoch: 39, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43502598
model size : 180.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.813011646270752
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.766 Vali Acc: 0.219 Test Loss: 1.766 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.7685902118682861
Epoch: 2, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.727 Vali Acc: 0.237 Test Loss: 1.727 Test Acc: 0.237
Validation loss decreased (-0.218501 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.6229033470153809
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.697 Vali Acc: 0.300 Test Loss: 1.697 Test Acc: 0.300
Validation loss decreased (-0.237020 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.7208125591278076
Epoch: 4, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.643 Vali Acc: 0.530 Test Loss: 1.643 Test Acc: 0.530
Validation loss decreased (-0.299983 --> -0.529613).  Saving model ...
Epoch: 5 cost time: 0.7745604515075684
Epoch: 5, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.572 Vali Acc: 0.656 Test Loss: 1.572 Test Acc: 0.656
Validation loss decreased (-0.529613 --> -0.655540).  Saving model ...
Epoch: 6 cost time: 0.6626129150390625
Epoch: 6, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.488 Vali Acc: 0.756 Test Loss: 1.488 Test Acc: 0.756
Validation loss decreased (-0.655540 --> -0.755541).  Saving model ...
Epoch: 7 cost time: 0.6558232307434082
Epoch: 7, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.396 Vali Acc: 0.800 Test Loss: 1.396 Test Acc: 0.800
Validation loss decreased (-0.755541 --> -0.799986).  Saving model ...
Epoch: 8 cost time: 0.6880128383636475
Epoch: 8, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.299 Vali Acc: 0.848 Test Loss: 1.299 Test Acc: 0.848
Validation loss decreased (-0.799986 --> -0.848135).  Saving model ...
Epoch: 9 cost time: 0.6337730884552002
Epoch: 9, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.199 Vali Acc: 0.859 Test Loss: 1.199 Test Acc: 0.859
Validation loss decreased (-0.848135 --> -0.859247).  Saving model ...
Epoch: 10 cost time: 0.697150468826294
Epoch: 10, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.098 Vali Acc: 0.863 Test Loss: 1.098 Test Acc: 0.863
Validation loss decreased (-0.859247 --> -0.862952).  Saving model ...
Epoch: 11 cost time: 0.6136636734008789
Epoch: 11, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.000 Vali Acc: 0.874 Test Loss: 1.000 Test Acc: 0.874
Validation loss decreased (-0.862952 --> -0.874064).  Saving model ...
Epoch: 12 cost time: 0.7107572555541992
Epoch: 12, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.900 Vali Acc: 0.893 Test Loss: 0.900 Test Acc: 0.893
Validation loss decreased (-0.874064 --> -0.892584).  Saving model ...
Epoch: 13 cost time: 0.7023468017578125
Epoch: 13, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.803 Vali Acc: 0.889 Test Loss: 0.803 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6065824031829834
Epoch: 14, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.714 Vali Acc: 0.904 Test Loss: 0.714 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903697).  Saving model ...
Epoch: 15 cost time: 0.7224080562591553
Epoch: 15, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.631 Vali Acc: 0.900 Test Loss: 0.631 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7760815620422363
Epoch: 16, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.558 Vali Acc: 0.904 Test Loss: 0.558 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 17 cost time: 0.8117189407348633
Epoch: 17, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.487 Vali Acc: 0.907 Test Loss: 0.487 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907403).  Saving model ...
Epoch: 18 cost time: 0.8007957935333252
Epoch: 18, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.423 Vali Acc: 0.919 Test Loss: 0.423 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.7397205829620361
Epoch: 19, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.370 Vali Acc: 0.919 Test Loss: 0.370 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.7309606075286865
Epoch: 20, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.5640530586242676
Epoch: 21, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.6193451881408691
Epoch: 22, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.706540584564209
Epoch: 23, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6224014759063721
Epoch: 24, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.907 Test Loss: 0.248 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7484614849090576
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.241 Vali Acc: 0.907 Test Loss: 0.241 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6134395599365234
Epoch: 26, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7053463459014893
Epoch: 27, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8901453018188477
Epoch: 28, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.919 Test Loss: 0.223 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7130370140075684
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6285600662231445
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7041287422180176
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 43579398
model size : 180.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6319806575775146
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.772 Vali Acc: 0.181 Test Loss: 1.772 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.6192910671234131
Epoch: 2, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.728 Vali Acc: 0.263 Test Loss: 1.728 Test Acc: 0.263
Validation loss decreased (-0.181464 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.7033984661102295
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.703 Vali Acc: 0.393 Test Loss: 1.703 Test Acc: 0.393
Validation loss decreased (-0.262946 --> -0.392576).  Saving model ...
Epoch: 4 cost time: 0.760915994644165
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.666 Vali Acc: 0.459 Test Loss: 1.666 Test Acc: 0.459
Validation loss decreased (-0.392576 --> -0.459243).  Saving model ...
Epoch: 5 cost time: 0.7201242446899414
Epoch: 5, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.619 Vali Acc: 0.556 Test Loss: 1.619 Test Acc: 0.556
Validation loss decreased (-0.459243 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 0.5782063007354736
Epoch: 6, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.563 Vali Acc: 0.659 Test Loss: 1.563 Test Acc: 0.659
Validation loss decreased (-0.555539 --> -0.659244).  Saving model ...
Epoch: 7 cost time: 0.7037458419799805
Epoch: 7, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.499 Vali Acc: 0.744 Test Loss: 1.499 Test Acc: 0.744
Validation loss decreased (-0.659244 --> -0.744429).  Saving model ...
Epoch: 8 cost time: 0.6630458831787109
Epoch: 8, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.429 Vali Acc: 0.781 Test Loss: 1.429 Test Acc: 0.781
Validation loss decreased (-0.744429 --> -0.781467).  Saving model ...
Epoch: 9 cost time: 0.7715535163879395
Epoch: 9, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.353 Vali Acc: 0.830 Test Loss: 1.353 Test Acc: 0.830
Validation loss decreased (-0.781467 --> -0.829616).  Saving model ...
Epoch: 10 cost time: 0.6541280746459961
Epoch: 10, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.273 Vali Acc: 0.859 Test Loss: 1.273 Test Acc: 0.859
Validation loss decreased (-0.829616 --> -0.859247).  Saving model ...
Epoch: 11 cost time: 0.7171177864074707
Epoch: 11, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.194 Vali Acc: 0.889 Test Loss: 1.194 Test Acc: 0.889
Validation loss decreased (-0.859247 --> -0.888877).  Saving model ...
Epoch: 12 cost time: 0.6019432544708252
Epoch: 12, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.114 Vali Acc: 0.896 Test Loss: 1.114 Test Acc: 0.896
Validation loss decreased (-0.888877 --> -0.896285).  Saving model ...
Epoch: 13 cost time: 0.7506670951843262
Epoch: 13, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.033 Vali Acc: 0.907 Test Loss: 1.033 Test Acc: 0.907
Validation loss decreased (-0.896285 --> -0.907397).  Saving model ...
Epoch: 14 cost time: 0.8248081207275391
Epoch: 14, Steps: 2 | Train Loss: 1.007 Vali Loss: 0.952 Vali Acc: 0.919 Test Loss: 0.952 Test Acc: 0.919
Validation loss decreased (-0.907397 --> -0.918509).  Saving model ...
Epoch: 15 cost time: 0.6567106246948242
Epoch: 15, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.872 Vali Acc: 0.930 Test Loss: 0.872 Test Acc: 0.930
Validation loss decreased (-0.918509 --> -0.929621).  Saving model ...
Epoch: 16 cost time: 0.7032647132873535
Epoch: 16, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.792 Vali Acc: 0.930 Test Loss: 0.792 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929622).  Saving model ...
Epoch: 17 cost time: 0.7775130271911621
Epoch: 17, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.709 Vali Acc: 0.944 Test Loss: 0.709 Test Acc: 0.944
Validation loss decreased (-0.929622 --> -0.944437).  Saving model ...
Epoch: 18 cost time: 0.7070705890655518
Epoch: 18, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.631 Vali Acc: 0.948 Test Loss: 0.631 Test Acc: 0.948
Validation loss decreased (-0.944437 --> -0.948142).  Saving model ...
Epoch: 19 cost time: 0.8255603313446045
Epoch: 19, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.562 Vali Acc: 0.944 Test Loss: 0.562 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8813591003417969
Epoch: 20, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.496 Vali Acc: 0.941 Test Loss: 0.496 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8822016716003418
Epoch: 21, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.435 Vali Acc: 0.944 Test Loss: 0.435 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7424066066741943
Epoch: 22, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8126816749572754
Epoch: 23, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.335 Vali Acc: 0.937 Test Loss: 0.335 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7838597297668457
Epoch: 24, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8309597969055176
Epoch: 25, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6493442058563232
Epoch: 26, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7156507968902588
Epoch: 27, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8305366039276123
Epoch: 28, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 43536390
model size : 180.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.405406951904297
Epoch: 1, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.873 Vali Acc: 0.241 Test Loss: 1.873 Test Acc: 0.241
Validation loss decreased (inf --> -0.240722).  Saving model ...
Epoch: 2 cost time: 0.6375763416290283
Epoch: 2, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.829 Vali Acc: 0.204 Test Loss: 1.829 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6088237762451172
Epoch: 3, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.803 Vali Acc: 0.222 Test Loss: 1.803 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6052157878875732
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.775 Vali Acc: 0.237 Test Loss: 1.775 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5381894111633301
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.741 Vali Acc: 0.281 Test Loss: 1.741 Test Acc: 0.281
Validation loss decreased (-0.240722 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 0.706099271774292
Epoch: 6, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.699 Vali Acc: 0.367 Test Loss: 1.699 Test Acc: 0.367
Validation loss decreased (-0.281464 --> -0.366650).  Saving model ...
Epoch: 7 cost time: 0.569223165512085
Epoch: 7, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.651 Vali Acc: 0.493 Test Loss: 1.651 Test Acc: 0.493
Validation loss decreased (-0.366650 --> -0.492576).  Saving model ...
Epoch: 8 cost time: 0.6437962055206299
Epoch: 8, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.601 Vali Acc: 0.548 Test Loss: 1.601 Test Acc: 0.548
Validation loss decreased (-0.492576 --> -0.548132).  Saving model ...
Epoch: 9 cost time: 0.573488712310791
Epoch: 9, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.547 Vali Acc: 0.619 Test Loss: 1.547 Test Acc: 0.619
Validation loss decreased (-0.548132 --> -0.618503).  Saving model ...
Epoch: 10 cost time: 0.6487557888031006
Epoch: 10, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.489 Vali Acc: 0.704 Test Loss: 1.489 Test Acc: 0.704
Validation loss decreased (-0.618503 --> -0.703689).  Saving model ...
Epoch: 11 cost time: 0.5494678020477295
Epoch: 11, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.427 Vali Acc: 0.752 Test Loss: 1.427 Test Acc: 0.752
Validation loss decreased (-0.703689 --> -0.751838).  Saving model ...
Epoch: 12 cost time: 0.660259485244751
Epoch: 12, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.363 Vali Acc: 0.800 Test Loss: 1.363 Test Acc: 0.800
Validation loss decreased (-0.751838 --> -0.799986).  Saving model ...
Epoch: 13 cost time: 0.6128623485565186
Epoch: 13, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.295 Vali Acc: 0.811 Test Loss: 1.295 Test Acc: 0.811
Validation loss decreased (-0.799986 --> -0.811098).  Saving model ...
Epoch: 14 cost time: 0.5890400409698486
Epoch: 14, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.227 Vali Acc: 0.826 Test Loss: 1.227 Test Acc: 0.826
Validation loss decreased (-0.811098 --> -0.825914).  Saving model ...
Epoch: 15 cost time: 0.6712870597839355
Epoch: 15, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.156 Vali Acc: 0.837 Test Loss: 1.156 Test Acc: 0.837
Validation loss decreased (-0.825914 --> -0.837025).  Saving model ...
Epoch: 16 cost time: 0.586169958114624
Epoch: 16, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.084 Vali Acc: 0.852 Test Loss: 1.084 Test Acc: 0.852
Validation loss decreased (-0.837025 --> -0.851841).  Saving model ...
Epoch: 17 cost time: 0.6890616416931152
Epoch: 17, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.009 Vali Acc: 0.874 Test Loss: 1.009 Test Acc: 0.874
Validation loss decreased (-0.851841 --> -0.874064).  Saving model ...
Epoch: 18 cost time: 0.8786487579345703
Epoch: 18, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.929 Vali Acc: 0.900 Test Loss: 0.929 Test Acc: 0.900
Validation loss decreased (-0.874064 --> -0.899991).  Saving model ...
Epoch: 19 cost time: 0.5893785953521729
Epoch: 19, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.846 Vali Acc: 0.930 Test Loss: 0.846 Test Acc: 0.930
Validation loss decreased (-0.899991 --> -0.929621).  Saving model ...
Epoch: 20 cost time: 0.8190276622772217
Epoch: 20, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.764 Vali Acc: 0.926 Test Loss: 0.764 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6764676570892334
Epoch: 21, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.686 Vali Acc: 0.926 Test Loss: 0.686 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7139050960540771
Epoch: 22, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.611 Vali Acc: 0.926 Test Loss: 0.611 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6281027793884277
Epoch: 23, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.540 Vali Acc: 0.933 Test Loss: 0.540 Test Acc: 0.933
Validation loss decreased (-0.929621 --> -0.933328).  Saving model ...
Epoch: 24 cost time: 0.6868634223937988
Epoch: 24, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.476 Vali Acc: 0.941 Test Loss: 0.476 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 25 cost time: 0.6892764568328857
Epoch: 25, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.422 Vali Acc: 0.944 Test Loss: 0.422 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 26 cost time: 0.7012584209442139
Epoch: 26, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.376 Vali Acc: 0.941 Test Loss: 0.376 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6271979808807373
Epoch: 27, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5914723873138428
Epoch: 28, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.663485050201416
Epoch: 29, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7305035591125488
Epoch: 30, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8734471797943115
Epoch: 31, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.795856237411499
Epoch: 32, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7625718116760254
Epoch: 33, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8137953281402588
Epoch: 34, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.234 Vali Acc: 0.907 Test Loss: 0.234 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7215442657470703
Epoch: 35, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.236 Vali Acc: 0.907 Test Loss: 0.236 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 43505670
model size : 180.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.817140817642212
Epoch: 1, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.876 Vali Acc: 0.052 Test Loss: 1.876 Test Acc: 0.052
Validation loss decreased (inf --> -0.051833).  Saving model ...
Epoch: 2 cost time: 0.7754702568054199
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.827 Vali Acc: 0.226 Test Loss: 1.827 Test Acc: 0.226
Validation loss decreased (-0.051833 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.7337532043457031
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.780 Vali Acc: 0.322 Test Loss: 1.780 Test Acc: 0.322
Validation loss decreased (-0.225908 --> -0.322204).  Saving model ...
Epoch: 4 cost time: 0.6979572772979736
Epoch: 4, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.718 Vali Acc: 0.393 Test Loss: 1.718 Test Acc: 0.393
Validation loss decreased (-0.322204 --> -0.392575).  Saving model ...
Epoch: 5 cost time: 0.6825299263000488
Epoch: 5, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.639 Vali Acc: 0.470 Test Loss: 1.639 Test Acc: 0.470
Validation loss decreased (-0.392575 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.722461462020874
Epoch: 6, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.551 Vali Acc: 0.548 Test Loss: 1.551 Test Acc: 0.548
Validation loss decreased (-0.470354 --> -0.548133).  Saving model ...
Epoch: 7 cost time: 0.6795165538787842
Epoch: 7, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.450 Vali Acc: 0.637 Test Loss: 1.450 Test Acc: 0.637
Validation loss decreased (-0.548133 --> -0.637023).  Saving model ...
Epoch: 8 cost time: 0.7615401744842529
Epoch: 8, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.343 Vali Acc: 0.704 Test Loss: 1.343 Test Acc: 0.704
Validation loss decreased (-0.637023 --> -0.703690).  Saving model ...
Epoch: 9 cost time: 0.7507054805755615
Epoch: 9, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.232 Vali Acc: 0.767 Test Loss: 1.232 Test Acc: 0.767
Validation loss decreased (-0.703690 --> -0.766654).  Saving model ...
Epoch: 10 cost time: 0.7201743125915527
Epoch: 10, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.119 Vali Acc: 0.833 Test Loss: 1.119 Test Acc: 0.833
Validation loss decreased (-0.766654 --> -0.833322).  Saving model ...
Epoch: 11 cost time: 0.9239358901977539
Epoch: 11, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.008 Vali Acc: 0.852 Test Loss: 1.008 Test Acc: 0.852
Validation loss decreased (-0.833322 --> -0.851842).  Saving model ...
Epoch: 12 cost time: 0.7211368083953857
Epoch: 12, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.906 Vali Acc: 0.859 Test Loss: 0.906 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859250).  Saving model ...
Epoch: 13 cost time: 0.8122575283050537
Epoch: 13, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7324550151824951
Epoch: 14, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.716 Vali Acc: 0.856 Test Loss: 0.716 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7108931541442871
Epoch: 15, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.633 Vali Acc: 0.893 Test Loss: 0.633 Test Acc: 0.893
Validation loss decreased (-0.859250 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.9556801319122314
Epoch: 16, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.558 Vali Acc: 0.874 Test Loss: 0.558 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6646754741668701
Epoch: 17, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.491 Vali Acc: 0.911 Test Loss: 0.491 Test Acc: 0.911
Validation loss decreased (-0.892586 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.7606065273284912
Epoch: 18, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.436 Vali Acc: 0.896 Test Loss: 0.436 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7958784103393555
Epoch: 19, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 0.7248556613922119
Epoch: 20, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.8354301452636719
Epoch: 21, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 22 cost time: 0.8280088901519775
Epoch: 22, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.272 Vali Acc: 0.904 Test Loss: 0.272 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8097350597381592
Epoch: 23, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8248300552368164
Epoch: 24, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7159123420715332
Epoch: 25, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 26 cost time: 0.7347016334533691
Epoch: 26, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7381634712219238
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7442045211791992
Epoch: 28, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.915 Test Loss: 0.236 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8822810649871826
Epoch: 29, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7544877529144287
Epoch: 30, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6897275447845459
Epoch: 31, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7676010131835938
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.915 Test Loss: 0.222 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7340896129608154
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.217 Vali Acc: 0.915 Test Loss: 0.217 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.818526029586792
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 35 cost time: 0.7499511241912842
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 36 cost time: 0.7898240089416504
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 37 cost time: 0.6503264904022217
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6673603057861328
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6346755027770996
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7062156200408936
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6707010269165039
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7021334171295166
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8204057216644287
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6726670265197754
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8188951015472412
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7149691581726074
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 43588614
model size : 180.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9222733974456787
Epoch: 1, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.808 Vali Acc: 0.200 Test Loss: 1.808 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.6873157024383545
Epoch: 2, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.769 Vali Acc: 0.259 Test Loss: 1.769 Test Acc: 0.259
Validation loss decreased (-0.199982 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.6655502319335938
Epoch: 3, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.738 Vali Acc: 0.307 Test Loss: 1.738 Test Acc: 0.307
Validation loss decreased (-0.259242 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.7008090019226074
Epoch: 4, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.696 Vali Acc: 0.367 Test Loss: 1.696 Test Acc: 0.367
Validation loss decreased (-0.307390 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.765648365020752
Epoch: 5, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.644 Vali Acc: 0.400 Test Loss: 1.644 Test Acc: 0.400
Validation loss decreased (-0.366650 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 0.7454328536987305
Epoch: 6, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.586 Vali Acc: 0.448 Test Loss: 1.586 Test Acc: 0.448
Validation loss decreased (-0.399984 --> -0.448132).  Saving model ...
Epoch: 7 cost time: 0.655062198638916
Epoch: 7, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.522 Vali Acc: 0.496 Test Loss: 1.522 Test Acc: 0.496
Validation loss decreased (-0.448132 --> -0.496281).  Saving model ...
Epoch: 8 cost time: 0.6862728595733643
Epoch: 8, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.454 Vali Acc: 0.541 Test Loss: 1.454 Test Acc: 0.541
Validation loss decreased (-0.496281 --> -0.540726).  Saving model ...
Epoch: 9 cost time: 0.843421459197998
Epoch: 9, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.379 Vali Acc: 0.593 Test Loss: 1.379 Test Acc: 0.593
Validation loss decreased (-0.540726 --> -0.592579).  Saving model ...
Epoch: 10 cost time: 0.533174991607666
Epoch: 10, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.297 Vali Acc: 0.667 Test Loss: 1.297 Test Acc: 0.667
Validation loss decreased (-0.592579 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 0.6393938064575195
Epoch: 11, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.210 Vali Acc: 0.722 Test Loss: 1.210 Test Acc: 0.722
Validation loss decreased (-0.666654 --> -0.722210).  Saving model ...
Epoch: 12 cost time: 0.8058996200561523
Epoch: 12, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.122 Vali Acc: 0.778 Test Loss: 1.122 Test Acc: 0.778
Validation loss decreased (-0.722210 --> -0.777767).  Saving model ...
Epoch: 13 cost time: 0.7334263324737549
Epoch: 13, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.035 Vali Acc: 0.800 Test Loss: 1.035 Test Acc: 0.800
Validation loss decreased (-0.777767 --> -0.799990).  Saving model ...
Epoch: 14 cost time: 0.7062273025512695
Epoch: 14, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.945 Vali Acc: 0.852 Test Loss: 0.945 Test Acc: 0.852
Validation loss decreased (-0.799990 --> -0.851842).  Saving model ...
Epoch: 15 cost time: 0.7293329238891602
Epoch: 15, Steps: 2 | Train Loss: 0.857 Vali Loss: 0.856 Vali Acc: 0.889 Test Loss: 0.856 Test Acc: 0.889
Validation loss decreased (-0.851842 --> -0.888880).  Saving model ...
Epoch: 16 cost time: 0.7676310539245605
Epoch: 16, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.769 Vali Acc: 0.900 Test Loss: 0.769 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.6874165534973145
Epoch: 17, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.684 Vali Acc: 0.915 Test Loss: 0.684 Test Acc: 0.915
Validation loss decreased (-0.899992 --> -0.914808).  Saving model ...
Epoch: 18 cost time: 0.7231471538543701
Epoch: 18, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.602 Vali Acc: 0.919 Test Loss: 0.602 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918513).  Saving model ...
Epoch: 19 cost time: 0.5252337455749512
Epoch: 19, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.528 Vali Acc: 0.922 Test Loss: 0.528 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 20 cost time: 0.7229344844818115
Epoch: 20, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.462 Vali Acc: 0.926 Test Loss: 0.462 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 21 cost time: 0.6411886215209961
Epoch: 21, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.405 Vali Acc: 0.937 Test Loss: 0.405 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.5017852783203125
Epoch: 22, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.43967652320861816
Epoch: 23, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5803670883178711
Epoch: 24, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5890300273895264
Epoch: 25, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.727346658706665
Epoch: 26, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6183485984802246
Epoch: 27, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5607244968414307
Epoch: 28, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5835790634155273
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6047890186309814
Epoch: 30, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7312572002410889
Epoch: 31, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 43545606
model size : 180.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7105019092559814
Epoch: 1, Steps: 2 | Train Loss: 2.040 Vali Loss: 1.910 Vali Acc: 0.163 Test Loss: 1.910 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.5500149726867676
Epoch: 2, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.848 Vali Acc: 0.144 Test Loss: 1.848 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5661861896514893
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.812 Vali Acc: 0.156 Test Loss: 1.812 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.605492115020752
Epoch: 4, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.781 Vali Acc: 0.159 Test Loss: 1.781 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5810229778289795
Epoch: 5, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.745 Vali Acc: 0.196 Test Loss: 1.745 Test Acc: 0.196
Validation loss decreased (-0.162944 --> -0.196279).  Saving model ...
Epoch: 6 cost time: 0.6455428600311279
Epoch: 6, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.703 Vali Acc: 0.315 Test Loss: 1.703 Test Acc: 0.315
Validation loss decreased (-0.196279 --> -0.314798).  Saving model ...
Epoch: 7 cost time: 0.688300609588623
Epoch: 7, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.658 Vali Acc: 0.430 Test Loss: 1.658 Test Acc: 0.430
Validation loss decreased (-0.314798 --> -0.429613).  Saving model ...
Epoch: 8 cost time: 0.6868438720703125
Epoch: 8, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.612 Vali Acc: 0.570 Test Loss: 1.612 Test Acc: 0.570
Validation loss decreased (-0.429613 --> -0.570354).  Saving model ...
Epoch: 9 cost time: 0.8714687824249268
Epoch: 9, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.566 Vali Acc: 0.674 Test Loss: 1.566 Test Acc: 0.674
Validation loss decreased (-0.570354 --> -0.674058).  Saving model ...
Epoch: 10 cost time: 0.6884849071502686
Epoch: 10, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.517 Vali Acc: 0.696 Test Loss: 1.517 Test Acc: 0.696
Validation loss decreased (-0.674058 --> -0.696281).  Saving model ...
Epoch: 11 cost time: 0.7293171882629395
Epoch: 11, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.465 Vali Acc: 0.707 Test Loss: 1.465 Test Acc: 0.707
Validation loss decreased (-0.696281 --> -0.707393).  Saving model ...
Epoch: 12 cost time: 0.5636947154998779
Epoch: 12, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.409 Vali Acc: 0.719 Test Loss: 1.409 Test Acc: 0.719
Validation loss decreased (-0.707393 --> -0.718504).  Saving model ...
Epoch: 13 cost time: 0.5934634208679199
Epoch: 13, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.349 Vali Acc: 0.744 Test Loss: 1.349 Test Acc: 0.744
Validation loss decreased (-0.718504 --> -0.744431).  Saving model ...
Epoch: 14 cost time: 0.7181291580200195
Epoch: 14, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.284 Vali Acc: 0.759 Test Loss: 1.284 Test Acc: 0.759
Validation loss decreased (-0.744431 --> -0.759246).  Saving model ...
Epoch: 15 cost time: 0.6688692569732666
Epoch: 15, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.215 Vali Acc: 0.811 Test Loss: 1.215 Test Acc: 0.811
Validation loss decreased (-0.759246 --> -0.811099).  Saving model ...
Epoch: 16 cost time: 0.7717869281768799
Epoch: 16, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.144 Vali Acc: 0.841 Test Loss: 1.144 Test Acc: 0.841
Validation loss decreased (-0.811099 --> -0.840729).  Saving model ...
Epoch: 17 cost time: 0.6244606971740723
Epoch: 17, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.067 Vali Acc: 0.863 Test Loss: 1.067 Test Acc: 0.863
Validation loss decreased (-0.840729 --> -0.862952).  Saving model ...
Epoch: 18 cost time: 0.6322727203369141
Epoch: 18, Steps: 2 | Train Loss: 0.950 Vali Loss: 0.990 Vali Acc: 0.870 Test Loss: 0.990 Test Acc: 0.870
Validation loss decreased (-0.862952 --> -0.870360).  Saving model ...
Epoch: 19 cost time: 0.6665353775024414
Epoch: 19, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.910 Vali Acc: 0.881 Test Loss: 0.910 Test Acc: 0.881
Validation loss decreased (-0.870360 --> -0.881472).  Saving model ...
Epoch: 20 cost time: 0.7158246040344238
Epoch: 20, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.827 Vali Acc: 0.893 Test Loss: 0.827 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 21 cost time: 0.551131010055542
Epoch: 21, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.743 Vali Acc: 0.911 Test Loss: 0.743 Test Acc: 0.911
Validation loss decreased (-0.892584 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.7104926109313965
Epoch: 22, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.658 Vali Acc: 0.915 Test Loss: 0.658 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 23 cost time: 0.6413283348083496
Epoch: 23, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.576 Vali Acc: 0.930 Test Loss: 0.576 Test Acc: 0.930
Validation loss decreased (-0.914808 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.7097997665405273
Epoch: 24, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.502 Vali Acc: 0.937 Test Loss: 0.502 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 25 cost time: 0.8454649448394775
Epoch: 25, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.437 Vali Acc: 0.930 Test Loss: 0.437 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8031141757965088
Epoch: 26, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6866536140441895
Epoch: 27, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6423873901367188
Epoch: 28, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7425003051757812
Epoch: 29, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7988922595977783
Epoch: 30, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7605435848236084
Epoch: 31, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.5979101657867432
Epoch: 32, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5739219188690186
Epoch: 33, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9327266216278076
Epoch: 34, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.700007438659668
Epoch: 35, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7257182598114014
Epoch: 36, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.815565824508667
Epoch: 37, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5550446510314941
Epoch: 38, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.9454755783081055
Epoch: 39, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 40 cost time: 0.5528085231781006
Epoch: 40, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.948 Test Loss: 0.159 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 41 cost time: 0.6249635219573975
Epoch: 41, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.948147 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.7556920051574707
Epoch: 42, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 43 cost time: 0.9862847328186035
Epoch: 43, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9145779609680176
Epoch: 44, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.955554 --> -0.962961).  Saving model ...
Epoch: 45 cost time: 0.777801513671875
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6993656158447266
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.948 Test Loss: 0.153 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9112577438354492
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.789212703704834
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8358135223388672
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8127682209014893
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.948 Test Loss: 0.154 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 43508742
model size : 180.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.717149257659912
Epoch: 1, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.863 Vali Acc: 0.122 Test Loss: 1.863 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.666818380355835
Epoch: 2, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.807 Vali Acc: 0.230 Test Loss: 1.807 Test Acc: 0.230
Validation loss decreased (-0.122204 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 0.7640156745910645
Epoch: 3, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.771 Vali Acc: 0.267 Test Loss: 1.771 Test Acc: 0.267
Validation loss decreased (-0.229612 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.6608712673187256
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.718 Vali Acc: 0.359 Test Loss: 1.718 Test Acc: 0.359
Validation loss decreased (-0.266649 --> -0.359242).  Saving model ...
Epoch: 5 cost time: 0.580742597579956
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.652 Vali Acc: 0.441 Test Loss: 1.652 Test Acc: 0.441
Validation loss decreased (-0.359242 --> -0.440724).  Saving model ...
Epoch: 6 cost time: 0.7369351387023926
Epoch: 6, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.578 Vali Acc: 0.600 Test Loss: 1.578 Test Acc: 0.600
Validation loss decreased (-0.440724 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 0.7946345806121826
Epoch: 7, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.493 Vali Acc: 0.674 Test Loss: 1.493 Test Acc: 0.674
Validation loss decreased (-0.599984 --> -0.674059).  Saving model ...
Epoch: 8 cost time: 0.7444496154785156
Epoch: 8, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.398 Vali Acc: 0.763 Test Loss: 1.398 Test Acc: 0.763
Validation loss decreased (-0.674059 --> -0.762949).  Saving model ...
Epoch: 9 cost time: 0.5867829322814941
Epoch: 9, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.301 Vali Acc: 0.837 Test Loss: 1.301 Test Acc: 0.837
Validation loss decreased (-0.762949 --> -0.837024).  Saving model ...
Epoch: 10 cost time: 0.622622013092041
Epoch: 10, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.203 Vali Acc: 0.878 Test Loss: 1.203 Test Acc: 0.878
Validation loss decreased (-0.837024 --> -0.877766).  Saving model ...
Epoch: 11 cost time: 0.5652823448181152
Epoch: 11, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.106 Vali Acc: 0.889 Test Loss: 1.106 Test Acc: 0.889
Validation loss decreased (-0.877766 --> -0.888878).  Saving model ...
Epoch: 12 cost time: 0.7752375602722168
Epoch: 12, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.007 Vali Acc: 0.878 Test Loss: 1.007 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.691016674041748
Epoch: 13, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.904 Vali Acc: 0.900 Test Loss: 0.904 Test Acc: 0.900
Validation loss decreased (-0.888878 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.6215415000915527
Epoch: 14, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.805 Vali Acc: 0.930 Test Loss: 0.805 Test Acc: 0.930
Validation loss decreased (-0.899991 --> -0.929622).  Saving model ...
Epoch: 15 cost time: 0.7668006420135498
Epoch: 15, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.715 Vali Acc: 0.937 Test Loss: 0.715 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937030).  Saving model ...
Epoch: 16 cost time: 0.6935310363769531
Epoch: 16, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.629 Vali Acc: 0.919 Test Loss: 0.629 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7255368232727051
Epoch: 17, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.549 Vali Acc: 0.919 Test Loss: 0.549 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6420574188232422
Epoch: 18, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.931396484375
Epoch: 19, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.428 Vali Acc: 0.893 Test Loss: 0.428 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8933858871459961
Epoch: 20, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6857156753540039
Epoch: 21, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.316 Vali Acc: 0.907 Test Loss: 0.316 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6921794414520264
Epoch: 22, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6390678882598877
Epoch: 23, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7006733417510986
Epoch: 24, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7186644077301025
Epoch: 25, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 43597830
model size : 180.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.567960500717163
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.765 Vali Acc: 0.178 Test Loss: 1.765 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.7864747047424316
Epoch: 2, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.725 Vali Acc: 0.200 Test Loss: 1.725 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 0.6480119228363037
Epoch: 3, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.702 Vali Acc: 0.356 Test Loss: 1.702 Test Acc: 0.356
Validation loss decreased (-0.199983 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 0.7633645534515381
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.670 Vali Acc: 0.441 Test Loss: 1.670 Test Acc: 0.441
Validation loss decreased (-0.355539 --> -0.440724).  Saving model ...
Epoch: 5 cost time: 0.5781335830688477
Epoch: 5, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.630 Vali Acc: 0.507 Test Loss: 1.630 Test Acc: 0.507
Validation loss decreased (-0.440724 --> -0.507391).  Saving model ...
Epoch: 6 cost time: 0.6537344455718994
Epoch: 6, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.583 Vali Acc: 0.596 Test Loss: 1.583 Test Acc: 0.596
Validation loss decreased (-0.507391 --> -0.596280).  Saving model ...
Epoch: 7 cost time: 0.8182086944580078
Epoch: 7, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.528 Vali Acc: 0.670 Test Loss: 1.528 Test Acc: 0.670
Validation loss decreased (-0.596280 --> -0.670355).  Saving model ...
Epoch: 8 cost time: 0.6931333541870117
Epoch: 8, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.469 Vali Acc: 0.752 Test Loss: 1.469 Test Acc: 0.752
Validation loss decreased (-0.670355 --> -0.751837).  Saving model ...
Epoch: 9 cost time: 0.7088906764984131
Epoch: 9, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.405 Vali Acc: 0.781 Test Loss: 1.405 Test Acc: 0.781
Validation loss decreased (-0.751837 --> -0.781467).  Saving model ...
Epoch: 10 cost time: 0.623741626739502
Epoch: 10, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.335 Vali Acc: 0.833 Test Loss: 1.335 Test Acc: 0.833
Validation loss decreased (-0.781467 --> -0.833320).  Saving model ...
Epoch: 11 cost time: 0.6738123893737793
Epoch: 11, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.261 Vali Acc: 0.867 Test Loss: 1.261 Test Acc: 0.867
Validation loss decreased (-0.833320 --> -0.866654).  Saving model ...
Epoch: 12 cost time: 0.6378202438354492
Epoch: 12, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.184 Vali Acc: 0.889 Test Loss: 1.184 Test Acc: 0.889
Validation loss decreased (-0.866654 --> -0.888877).  Saving model ...
Epoch: 13 cost time: 0.7371342182159424
Epoch: 13, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.106 Vali Acc: 0.896 Test Loss: 1.106 Test Acc: 0.896
Validation loss decreased (-0.888877 --> -0.896285).  Saving model ...
Epoch: 14 cost time: 0.643791913986206
Epoch: 14, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.025 Vali Acc: 0.907 Test Loss: 1.025 Test Acc: 0.907
Validation loss decreased (-0.896285 --> -0.907397).  Saving model ...
Epoch: 15 cost time: 0.5748348236083984
Epoch: 15, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.944 Vali Acc: 0.915 Test Loss: 0.944 Test Acc: 0.915
Validation loss decreased (-0.907397 --> -0.914805).  Saving model ...
Epoch: 16 cost time: 0.7462372779846191
Epoch: 16, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.860 Vali Acc: 0.933 Test Loss: 0.860 Test Acc: 0.933
Validation loss decreased (-0.914805 --> -0.933325).  Saving model ...
Epoch: 17 cost time: 0.859687328338623
Epoch: 17, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.778 Vali Acc: 0.941 Test Loss: 0.778 Test Acc: 0.941
Validation loss decreased (-0.933325 --> -0.940733).  Saving model ...
Epoch: 18 cost time: 0.6556949615478516
Epoch: 18, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.699 Vali Acc: 0.948 Test Loss: 0.699 Test Acc: 0.948
Validation loss decreased (-0.940733 --> -0.948141).  Saving model ...
Epoch: 19 cost time: 0.6800405979156494
Epoch: 19, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.625 Vali Acc: 0.952 Test Loss: 0.625 Test Acc: 0.952
Validation loss decreased (-0.948141 --> -0.951846).  Saving model ...
Epoch: 20 cost time: 0.7346076965332031
Epoch: 20, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.551 Vali Acc: 0.952 Test Loss: 0.551 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951846).  Saving model ...
Epoch: 21 cost time: 0.8068244457244873
Epoch: 21, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.483 Vali Acc: 0.948 Test Loss: 0.483 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7215983867645264
Epoch: 22, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.420 Vali Acc: 0.948 Test Loss: 0.420 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.697390079498291
Epoch: 23, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.365 Vali Acc: 0.952 Test Loss: 0.365 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951848).  Saving model ...
Epoch: 24 cost time: 0.7394838333129883
Epoch: 24, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.314 Vali Acc: 0.952 Test Loss: 0.314 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 0.7242076396942139
Epoch: 25, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.271 Vali Acc: 0.952 Test Loss: 0.271 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.9145815372467041
Epoch: 26, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.237 Vali Acc: 0.952 Test Loss: 0.237 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 27 cost time: 0.6843485832214355
Epoch: 27, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8039443492889404
Epoch: 28, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0538063049316406
Epoch: 29, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8658838272094727
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7157702445983887
Epoch: 31, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6380751132965088
Epoch: 32, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7808465957641602
Epoch: 33, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.926 Test Loss: 0.172 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.869492769241333
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.926 Test Loss: 0.165 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6738247871398926
Epoch: 35, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.930 Test Loss: 0.161 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.822812557220459
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.933 Test Loss: 0.156 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 43542534
model size : 180.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.006056785583496
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.796 Vali Acc: 0.285 Test Loss: 1.796 Test Acc: 0.285
Validation loss decreased (inf --> -0.285167).  Saving model ...
Epoch: 2 cost time: 0.6559667587280273
Epoch: 2, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.761 Vali Acc: 0.237 Test Loss: 1.761 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5350313186645508
Epoch: 3, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.742 Vali Acc: 0.267 Test Loss: 1.742 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6395814418792725
Epoch: 4, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.721 Vali Acc: 0.304 Test Loss: 1.721 Test Acc: 0.304
Validation loss decreased (-0.285167 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.8399357795715332
Epoch: 5, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.695 Vali Acc: 0.326 Test Loss: 1.695 Test Acc: 0.326
Validation loss decreased (-0.303686 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 0.7689762115478516
Epoch: 6, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.666 Vali Acc: 0.359 Test Loss: 1.666 Test Acc: 0.359
Validation loss decreased (-0.325909 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 0.7213790416717529
Epoch: 7, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.631 Vali Acc: 0.400 Test Loss: 1.631 Test Acc: 0.400
Validation loss decreased (-0.359243 --> -0.399984).  Saving model ...
Epoch: 8 cost time: 0.6458470821380615
Epoch: 8, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.594 Vali Acc: 0.459 Test Loss: 1.594 Test Acc: 0.459
Validation loss decreased (-0.399984 --> -0.459243).  Saving model ...
Epoch: 9 cost time: 0.6892099380493164
Epoch: 9, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.554 Vali Acc: 0.504 Test Loss: 1.554 Test Acc: 0.504
Validation loss decreased (-0.459243 --> -0.503688).  Saving model ...
Epoch: 10 cost time: 0.7313535213470459
Epoch: 10, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.511 Vali Acc: 0.526 Test Loss: 1.511 Test Acc: 0.526
Validation loss decreased (-0.503688 --> -0.525911).  Saving model ...
Epoch: 11 cost time: 0.8080556392669678
Epoch: 11, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.465 Vali Acc: 0.544 Test Loss: 1.465 Test Acc: 0.544
Validation loss decreased (-0.525911 --> -0.544430).  Saving model ...
Epoch: 12 cost time: 0.5714757442474365
Epoch: 12, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.418 Vali Acc: 0.611 Test Loss: 1.418 Test Acc: 0.611
Validation loss decreased (-0.544430 --> -0.611097).  Saving model ...
Epoch: 13 cost time: 0.6061716079711914
Epoch: 13, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.369 Vali Acc: 0.652 Test Loss: 1.369 Test Acc: 0.652
Validation loss decreased (-0.611097 --> -0.651838).  Saving model ...
Epoch: 14 cost time: 0.8813271522521973
Epoch: 14, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.316 Vali Acc: 0.700 Test Loss: 1.316 Test Acc: 0.700
Validation loss decreased (-0.651838 --> -0.699987).  Saving model ...
Epoch: 15 cost time: 0.767268180847168
Epoch: 15, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.261 Vali Acc: 0.737 Test Loss: 1.261 Test Acc: 0.737
Validation loss decreased (-0.699987 --> -0.737024).  Saving model ...
Epoch: 16 cost time: 0.6079702377319336
Epoch: 16, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.201 Vali Acc: 0.789 Test Loss: 1.201 Test Acc: 0.789
Validation loss decreased (-0.737024 --> -0.788877).  Saving model ...
Epoch: 17 cost time: 0.6677353382110596
Epoch: 17, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.138 Vali Acc: 0.807 Test Loss: 1.138 Test Acc: 0.807
Validation loss decreased (-0.788877 --> -0.807396).  Saving model ...
Epoch: 18 cost time: 0.7031517028808594
Epoch: 18, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.071 Vali Acc: 0.833 Test Loss: 1.071 Test Acc: 0.833
Validation loss decreased (-0.807396 --> -0.833323).  Saving model ...
Epoch: 19 cost time: 0.6153552532196045
Epoch: 19, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.002 Vali Acc: 0.852 Test Loss: 1.002 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 20 cost time: 0.5454683303833008
Epoch: 20, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.933 Vali Acc: 0.870 Test Loss: 0.933 Test Acc: 0.870
Validation loss decreased (-0.851842 --> -0.870361).  Saving model ...
Epoch: 21 cost time: 0.7130074501037598
Epoch: 21, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.864 Vali Acc: 0.878 Test Loss: 0.864 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 22 cost time: 0.6377770900726318
Epoch: 22, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.793 Vali Acc: 0.878 Test Loss: 0.793 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 23 cost time: 0.6612718105316162
Epoch: 23, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.722 Vali Acc: 0.885 Test Loss: 0.722 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885178).  Saving model ...
Epoch: 24 cost time: 0.7467420101165771
Epoch: 24, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.651 Vali Acc: 0.896 Test Loss: 0.651 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 25 cost time: 0.6936779022216797
Epoch: 25, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.586 Vali Acc: 0.904 Test Loss: 0.586 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 26 cost time: 0.6004421710968018
Epoch: 26, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.524 Vali Acc: 0.911 Test Loss: 0.524 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 0.73752760887146
Epoch: 27, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.464 Vali Acc: 0.915 Test Loss: 0.464 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 28 cost time: 0.6354594230651855
Epoch: 28, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.411 Vali Acc: 0.919 Test Loss: 0.411 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 29 cost time: 0.7668008804321289
Epoch: 29, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.364 Vali Acc: 0.922 Test Loss: 0.364 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922219).  Saving model ...
Epoch: 30 cost time: 0.6744694709777832
Epoch: 30, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6244056224822998
Epoch: 31, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 0.8031353950500488
Epoch: 32, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.6520566940307617
Epoch: 33, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.682387113571167
Epoch: 34, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.7088027000427246
Epoch: 35, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.5718107223510742
Epoch: 36, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.6607913970947266
Epoch: 37, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.6916468143463135
Epoch: 38, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6621227264404297
Epoch: 39, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7338378429412842
Epoch: 40, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6779487133026123
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6567108631134033
Epoch: 42, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6090514659881592
Epoch: 43, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6330709457397461
Epoch: 44, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6387577056884766
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5743205547332764
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7457618713378906
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43511814
model size : 180.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.53756046295166
Epoch: 1, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.780 Vali Acc: 0.222 Test Loss: 1.780 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 0.7360656261444092
Epoch: 2, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.744 Vali Acc: 0.352 Test Loss: 1.744 Test Acc: 0.352
Validation loss decreased (-0.222204 --> -0.351834).  Saving model ...
Epoch: 3 cost time: 0.7497360706329346
Epoch: 3, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.718 Vali Acc: 0.422 Test Loss: 1.718 Test Acc: 0.422
Validation loss decreased (-0.351834 --> -0.422205).  Saving model ...
Epoch: 4 cost time: 0.7149574756622314
Epoch: 4, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.677 Vali Acc: 0.474 Test Loss: 1.677 Test Acc: 0.474
Validation loss decreased (-0.422205 --> -0.474057).  Saving model ...
Epoch: 5 cost time: 0.7779815196990967
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.625 Vali Acc: 0.533 Test Loss: 1.625 Test Acc: 0.533
Validation loss decreased (-0.474057 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 0.7322781085968018
Epoch: 6, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.561 Vali Acc: 0.630 Test Loss: 1.561 Test Acc: 0.630
Validation loss decreased (-0.533317 --> -0.629614).  Saving model ...
Epoch: 7 cost time: 0.6456770896911621
Epoch: 7, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.490 Vali Acc: 0.685 Test Loss: 1.490 Test Acc: 0.685
Validation loss decreased (-0.629614 --> -0.685170).  Saving model ...
Epoch: 8 cost time: 0.7582736015319824
Epoch: 8, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.413 Vali Acc: 0.737 Test Loss: 1.413 Test Acc: 0.737
Validation loss decreased (-0.685170 --> -0.737023).  Saving model ...
Epoch: 9 cost time: 0.6010463237762451
Epoch: 9, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.330 Vali Acc: 0.770 Test Loss: 1.330 Test Acc: 0.770
Validation loss decreased (-0.737023 --> -0.770357).  Saving model ...
Epoch: 10 cost time: 0.7846024036407471
Epoch: 10, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.244 Vali Acc: 0.811 Test Loss: 1.244 Test Acc: 0.811
Validation loss decreased (-0.770357 --> -0.811099).  Saving model ...
Epoch: 11 cost time: 0.7402005195617676
Epoch: 11, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.156 Vali Acc: 0.837 Test Loss: 1.156 Test Acc: 0.837
Validation loss decreased (-0.811099 --> -0.837025).  Saving model ...
Epoch: 12 cost time: 0.6924943923950195
Epoch: 12, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.066 Vali Acc: 0.870 Test Loss: 1.066 Test Acc: 0.870
Validation loss decreased (-0.837025 --> -0.870360).  Saving model ...
Epoch: 13 cost time: 0.620011568069458
Epoch: 13, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.977 Vali Acc: 0.885 Test Loss: 0.977 Test Acc: 0.885
Validation loss decreased (-0.870360 --> -0.885175).  Saving model ...
Epoch: 14 cost time: 0.7835819721221924
Epoch: 14, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.891 Vali Acc: 0.896 Test Loss: 0.891 Test Acc: 0.896
Validation loss decreased (-0.885175 --> -0.896287).  Saving model ...
Epoch: 15 cost time: 0.6535313129425049
Epoch: 15, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.806 Vali Acc: 0.896 Test Loss: 0.806 Test Acc: 0.896
Validation loss decreased (-0.896287 --> -0.896288).  Saving model ...
Epoch: 16 cost time: 0.6402599811553955
Epoch: 16, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.719 Vali Acc: 0.911 Test Loss: 0.719 Test Acc: 0.911
Validation loss decreased (-0.896288 --> -0.911104).  Saving model ...
Epoch: 17 cost time: 0.6385030746459961
Epoch: 17, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.639 Vali Acc: 0.919 Test Loss: 0.639 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 18 cost time: 0.6650359630584717
Epoch: 18, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.561 Vali Acc: 0.919 Test Loss: 0.561 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 19 cost time: 0.6451592445373535
Epoch: 19, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.490 Vali Acc: 0.919 Test Loss: 0.490 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 20 cost time: 0.6861536502838135
Epoch: 20, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.427 Vali Acc: 0.922 Test Loss: 0.427 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.6813194751739502
Epoch: 21, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 22 cost time: 0.6376447677612305
Epoch: 22, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940738).  Saving model ...
Epoch: 23 cost time: 0.5978026390075684
Epoch: 23, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6670904159545898
Epoch: 24, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7342982292175293
Epoch: 25, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 0.655705451965332
Epoch: 26, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6809709072113037
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7536547183990479
Epoch: 28, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.630408763885498
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6243946552276611
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5517568588256836
Epoch: 31, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.7646036148071289
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6366095542907715
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6981220245361328
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7181606292724609
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7626981735229492
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6582272052764893
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6900560855865479
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7357816696166992
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9517982006072998
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.651059627532959
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43585542
model size : 180.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8696515560150146
Epoch: 1, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.905 Vali Acc: 0.085 Test Loss: 1.905 Test Acc: 0.085
Validation loss decreased (inf --> -0.085166).  Saving model ...
Epoch: 2 cost time: 0.6624481678009033
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.845 Vali Acc: 0.107 Test Loss: 1.845 Test Acc: 0.107
Validation loss decreased (-0.085166 --> -0.107389).  Saving model ...
Epoch: 3 cost time: 0.657019853591919
Epoch: 3, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.809 Vali Acc: 0.200 Test Loss: 1.809 Test Acc: 0.200
Validation loss decreased (-0.107389 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.8297860622406006
Epoch: 4, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.777 Vali Acc: 0.285 Test Loss: 1.777 Test Acc: 0.285
Validation loss decreased (-0.199982 --> -0.285167).  Saving model ...
Epoch: 5 cost time: 0.7692046165466309
Epoch: 5, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.738 Vali Acc: 0.356 Test Loss: 1.738 Test Acc: 0.356
Validation loss decreased (-0.285167 --> -0.355538).  Saving model ...
Epoch: 6 cost time: 0.641524076461792
Epoch: 6, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.694 Vali Acc: 0.404 Test Loss: 1.694 Test Acc: 0.404
Validation loss decreased (-0.355538 --> -0.403687).  Saving model ...
Epoch: 7 cost time: 0.8074724674224854
Epoch: 7, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.647 Vali Acc: 0.481 Test Loss: 1.647 Test Acc: 0.481
Validation loss decreased (-0.403687 --> -0.481465).  Saving model ...
Epoch: 8 cost time: 0.620511531829834
Epoch: 8, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.596 Vali Acc: 0.526 Test Loss: 1.596 Test Acc: 0.526
Validation loss decreased (-0.481465 --> -0.525910).  Saving model ...
Epoch: 9 cost time: 0.644834041595459
Epoch: 9, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.542 Vali Acc: 0.541 Test Loss: 1.542 Test Acc: 0.541
Validation loss decreased (-0.525910 --> -0.540725).  Saving model ...
Epoch: 10 cost time: 0.6817145347595215
Epoch: 10, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.484 Vali Acc: 0.574 Test Loss: 1.484 Test Acc: 0.574
Validation loss decreased (-0.540725 --> -0.574059).  Saving model ...
Epoch: 11 cost time: 0.7401454448699951
Epoch: 11, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.425 Vali Acc: 0.611 Test Loss: 1.425 Test Acc: 0.611
Validation loss decreased (-0.574059 --> -0.611097).  Saving model ...
Epoch: 12 cost time: 0.7125616073608398
Epoch: 12, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.363 Vali Acc: 0.659 Test Loss: 1.363 Test Acc: 0.659
Validation loss decreased (-0.611097 --> -0.659246).  Saving model ...
Epoch: 13 cost time: 0.6530015468597412
Epoch: 13, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.298 Vali Acc: 0.707 Test Loss: 1.298 Test Acc: 0.707
Validation loss decreased (-0.659246 --> -0.707394).  Saving model ...
Epoch: 14 cost time: 0.5280044078826904
Epoch: 14, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.225 Vali Acc: 0.774 Test Loss: 1.225 Test Acc: 0.774
Validation loss decreased (-0.707394 --> -0.774062).  Saving model ...
Epoch: 15 cost time: 0.6387591361999512
Epoch: 15, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.149 Vali Acc: 0.852 Test Loss: 1.149 Test Acc: 0.852
Validation loss decreased (-0.774062 --> -0.851840).  Saving model ...
Epoch: 16 cost time: 0.594719409942627
Epoch: 16, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.068 Vali Acc: 0.878 Test Loss: 1.068 Test Acc: 0.878
Validation loss decreased (-0.851840 --> -0.877767).  Saving model ...
Epoch: 17 cost time: 0.5142488479614258
Epoch: 17, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.987 Vali Acc: 0.885 Test Loss: 0.987 Test Acc: 0.885
Validation loss decreased (-0.877767 --> -0.885175).  Saving model ...
Epoch: 18 cost time: 0.7273521423339844
Epoch: 18, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.911 Vali Acc: 0.889 Test Loss: 0.911 Test Acc: 0.889
Validation loss decreased (-0.885175 --> -0.888880).  Saving model ...
Epoch: 19 cost time: 0.6500718593597412
Epoch: 19, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.837 Vali Acc: 0.893 Test Loss: 0.837 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 20 cost time: 0.6271939277648926
Epoch: 20, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.764 Vali Acc: 0.904 Test Loss: 0.764 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903696).  Saving model ...
Epoch: 21 cost time: 0.6353440284729004
Epoch: 21, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.693 Vali Acc: 0.915 Test Loss: 0.693 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 22 cost time: 0.6765451431274414
Epoch: 22, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.625 Vali Acc: 0.915 Test Loss: 0.625 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 23 cost time: 0.6541547775268555
Epoch: 23, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.561 Vali Acc: 0.919 Test Loss: 0.561 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.6926350593566895
Epoch: 24, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.502 Vali Acc: 0.922 Test Loss: 0.502 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.8349175453186035
Epoch: 25, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.450 Vali Acc: 0.911 Test Loss: 0.450 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6478004455566406
Epoch: 26, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5894105434417725
Epoch: 27, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6843304634094238
Epoch: 28, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.328 Vali Acc: 0.915 Test Loss: 0.328 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6049323081970215
Epoch: 29, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.298 Vali Acc: 0.907 Test Loss: 0.298 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6262948513031006
Epoch: 30, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 0.6317017078399658
Epoch: 31, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.6376912593841553
Epoch: 32, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.925923 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.7518775463104248
Epoch: 33, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6514143943786621
Epoch: 34, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6420774459838867
Epoch: 35, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5108809471130371
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6004774570465088
Epoch: 37, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.630943775177002
Epoch: 38, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6250417232513428
Epoch: 39, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6160752773284912
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6531863212585449
Epoch: 41, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5925619602203369
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 43548678
model size : 180.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9271297454833984
Epoch: 1, Steps: 2 | Train Loss: 1.965 Vali Loss: 1.873 Vali Acc: 0.133 Test Loss: 1.873 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.6368768215179443
Epoch: 2, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.840 Vali Acc: 0.122 Test Loss: 1.840 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6923058032989502
Epoch: 3, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.818 Vali Acc: 0.137 Test Loss: 1.818 Test Acc: 0.137
Validation loss decreased (-0.133315 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.6684417724609375
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.794 Vali Acc: 0.174 Test Loss: 1.794 Test Acc: 0.174
Validation loss decreased (-0.137019 --> -0.174056).  Saving model ...
Epoch: 5 cost time: 0.7869584560394287
Epoch: 5, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.766 Vali Acc: 0.211 Test Loss: 1.766 Test Acc: 0.211
Validation loss decreased (-0.174056 --> -0.211093).  Saving model ...
Epoch: 6 cost time: 0.8186042308807373
Epoch: 6, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.734 Vali Acc: 0.267 Test Loss: 1.734 Test Acc: 0.267
Validation loss decreased (-0.211093 --> -0.266649).  Saving model ...
Epoch: 7 cost time: 0.5740280151367188
Epoch: 7, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.699 Vali Acc: 0.419 Test Loss: 1.699 Test Acc: 0.419
Validation loss decreased (-0.266649 --> -0.418502).  Saving model ...
Epoch: 8 cost time: 0.6487250328063965
Epoch: 8, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.661 Vali Acc: 0.556 Test Loss: 1.661 Test Acc: 0.556
Validation loss decreased (-0.418502 --> -0.555539).  Saving model ...
Epoch: 9 cost time: 0.6189918518066406
Epoch: 9, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.622 Vali Acc: 0.607 Test Loss: 1.622 Test Acc: 0.607
Validation loss decreased (-0.555539 --> -0.607391).  Saving model ...
Epoch: 10 cost time: 0.6333673000335693
Epoch: 10, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.579 Vali Acc: 0.659 Test Loss: 1.579 Test Acc: 0.659
Validation loss decreased (-0.607391 --> -0.659243).  Saving model ...
Epoch: 11 cost time: 0.727764368057251
Epoch: 11, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.531 Vali Acc: 0.715 Test Loss: 1.531 Test Acc: 0.715
Validation loss decreased (-0.659243 --> -0.714800).  Saving model ...
Epoch: 12 cost time: 0.5976624488830566
Epoch: 12, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.481 Vali Acc: 0.774 Test Loss: 1.481 Test Acc: 0.774
Validation loss decreased (-0.714800 --> -0.774059).  Saving model ...
Epoch: 13 cost time: 0.6535022258758545
Epoch: 13, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.429 Vali Acc: 0.800 Test Loss: 1.429 Test Acc: 0.800
Validation loss decreased (-0.774059 --> -0.799986).  Saving model ...
Epoch: 14 cost time: 0.7289402484893799
Epoch: 14, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.374 Vali Acc: 0.833 Test Loss: 1.374 Test Acc: 0.833
Validation loss decreased (-0.799986 --> -0.833320).  Saving model ...
Epoch: 15 cost time: 0.6793386936187744
Epoch: 15, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.319 Vali Acc: 0.856 Test Loss: 1.319 Test Acc: 0.856
Validation loss decreased (-0.833320 --> -0.855542).  Saving model ...
Epoch: 16 cost time: 0.8286423683166504
Epoch: 16, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.262 Vali Acc: 0.856 Test Loss: 1.262 Test Acc: 0.856
Validation loss decreased (-0.855542 --> -0.855543).  Saving model ...
Epoch: 17 cost time: 0.6096374988555908
Epoch: 17, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.201 Vali Acc: 0.889 Test Loss: 1.201 Test Acc: 0.889
Validation loss decreased (-0.855543 --> -0.888877).  Saving model ...
Epoch: 18 cost time: 0.6710188388824463
Epoch: 18, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.136 Vali Acc: 0.907 Test Loss: 1.136 Test Acc: 0.907
Validation loss decreased (-0.888877 --> -0.907396).  Saving model ...
Epoch: 19 cost time: 0.5827639102935791
Epoch: 19, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.066 Vali Acc: 0.915 Test Loss: 1.066 Test Acc: 0.915
Validation loss decreased (-0.907396 --> -0.914804).  Saving model ...
Epoch: 20 cost time: 0.7875816822052002
Epoch: 20, Steps: 2 | Train Loss: 1.053 Vali Loss: 0.992 Vali Acc: 0.926 Test Loss: 0.992 Test Acc: 0.926
Validation loss decreased (-0.914804 --> -0.925916).  Saving model ...
Epoch: 21 cost time: 0.47081446647644043
Epoch: 21, Steps: 2 | Train Loss: 0.949 Vali Loss: 0.914 Vali Acc: 0.937 Test Loss: 0.914 Test Acc: 0.937
Validation loss decreased (-0.925916 --> -0.937028).  Saving model ...
Epoch: 22 cost time: 0.6755905151367188
Epoch: 22, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.837 Vali Acc: 0.937 Test Loss: 0.837 Test Acc: 0.937
Validation loss decreased (-0.937028 --> -0.937029).  Saving model ...
Epoch: 23 cost time: 0.6946067810058594
Epoch: 23, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.762 Vali Acc: 0.933 Test Loss: 0.762 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6656045913696289
Epoch: 24, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.690 Vali Acc: 0.930 Test Loss: 0.690 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5733816623687744
Epoch: 25, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.617 Vali Acc: 0.933 Test Loss: 0.617 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6342949867248535
Epoch: 26, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.547 Vali Acc: 0.926 Test Loss: 0.547 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5640578269958496
Epoch: 27, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.482 Vali Acc: 0.933 Test Loss: 0.482 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.654104471206665
Epoch: 28, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.423 Vali Acc: 0.933 Test Loss: 0.423 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7437758445739746
Epoch: 29, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6929690837860107
Epoch: 30, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.329 Vali Acc: 0.948 Test Loss: 0.329 Test Acc: 0.948
Validation loss decreased (-0.937029 --> -0.948145).  Saving model ...
Epoch: 31 cost time: 0.694286584854126
Epoch: 31, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6442770957946777
Epoch: 32, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7368245124816895
Epoch: 33, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6772687435150146
Epoch: 34, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6964435577392578
Epoch: 35, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7156507968902588
Epoch: 36, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9659714698791504
Epoch: 37, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.748236894607544
Epoch: 38, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.648230791091919
Epoch: 39, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.026392936706543
Epoch: 40, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 43530246
model size : 180.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.70052170753479
Epoch: 1, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.839 Vali Acc: 0.207 Test Loss: 1.839 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.7982442378997803
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.795 Vali Acc: 0.270 Test Loss: 1.795 Test Acc: 0.270
Validation loss decreased (-0.207389 --> -0.270352).  Saving model ...
Epoch: 3 cost time: 0.8768320083618164
Epoch: 3, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.705 Vali Acc: 0.348 Test Loss: 1.705 Test Acc: 0.348
Validation loss decreased (-0.270352 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.8942379951477051
Epoch: 4, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.560 Vali Acc: 0.544 Test Loss: 1.560 Test Acc: 0.544
Validation loss decreased (-0.348131 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 0.8967444896697998
Epoch: 5, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.399 Vali Acc: 0.670 Test Loss: 1.399 Test Acc: 0.670
Validation loss decreased (-0.544429 --> -0.670356).  Saving model ...
Epoch: 6 cost time: 0.9233207702636719
Epoch: 6, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.237 Vali Acc: 0.711 Test Loss: 1.237 Test Acc: 0.711
Validation loss decreased (-0.670356 --> -0.711099).  Saving model ...
Epoch: 7 cost time: 0.8839840888977051
Epoch: 7, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.080 Vali Acc: 0.737 Test Loss: 1.080 Test Acc: 0.737
Validation loss decreased (-0.711099 --> -0.737026).  Saving model ...
Epoch: 8 cost time: 0.7695870399475098
Epoch: 8, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.897 Vali Acc: 0.874 Test Loss: 0.897 Test Acc: 0.874
Validation loss decreased (-0.737026 --> -0.874065).  Saving model ...
Epoch: 9 cost time: 0.9321486949920654
Epoch: 9, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.749 Vali Acc: 0.915 Test Loss: 0.749 Test Acc: 0.915
Validation loss decreased (-0.874065 --> -0.914807).  Saving model ...
Epoch: 10 cost time: 0.8089766502380371
Epoch: 10, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.632 Vali Acc: 0.907 Test Loss: 0.632 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.762883186340332
Epoch: 11, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.528 Vali Acc: 0.922 Test Loss: 0.528 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922217).  Saving model ...
Epoch: 12 cost time: 0.7721295356750488
Epoch: 12, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.449 Vali Acc: 0.904 Test Loss: 0.449 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7224040031433105
Epoch: 13, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.390 Vali Acc: 0.907 Test Loss: 0.390 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7428836822509766
Epoch: 14, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
Validation loss decreased (-0.922217 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 0.6887245178222656
Epoch: 15, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.288 Vali Acc: 0.926 Test Loss: 0.288 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7573373317718506
Epoch: 16, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7381961345672607
Epoch: 17, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.9954166412353516
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6523959636688232
Epoch: 19, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.919 Test Loss: 0.205 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8115315437316895
Epoch: 20, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7142331600189209
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.817086935043335
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8314831256866455
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7701907157897949
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.919 Test Loss: 0.191 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7857434749603271
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.911 Test Loss: 0.199 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.80828857421875
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.738839864730835
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7974128723144531
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.926 Test Loss: 0.187 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8790111541748047
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8249270915985107
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.8923153877258301
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.7233872413635254
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.7534677982330322
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8309917449951172
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7408430576324463
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8483095169067383
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7277050018310547
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.816185474395752
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8629708290100098
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8865151405334473
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6639020442962646
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7978553771972656
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 36706566
model size : 154.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7169973850250244
Epoch: 1, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.741 Vali Acc: 0.200 Test Loss: 1.741 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.70973801612854
Epoch: 2, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.698 Vali Acc: 0.496 Test Loss: 1.698 Test Acc: 0.496
Validation loss decreased (-0.199983 --> -0.496279).  Saving model ...
Epoch: 3 cost time: 0.6770412921905518
Epoch: 3, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.651 Vali Acc: 0.552 Test Loss: 1.651 Test Acc: 0.552
Validation loss decreased (-0.496279 --> -0.551835).  Saving model ...
Epoch: 4 cost time: 0.6823520660400391
Epoch: 4, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.567 Vali Acc: 0.696 Test Loss: 1.567 Test Acc: 0.696
Validation loss decreased (-0.551835 --> -0.696281).  Saving model ...
Epoch: 5 cost time: 0.7467999458312988
Epoch: 5, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.462 Vali Acc: 0.767 Test Loss: 1.462 Test Acc: 0.767
Validation loss decreased (-0.696281 --> -0.766652).  Saving model ...
Epoch: 6 cost time: 0.65458083152771
Epoch: 6, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.348 Vali Acc: 0.811 Test Loss: 1.348 Test Acc: 0.811
Validation loss decreased (-0.766652 --> -0.811098).  Saving model ...
Epoch: 7 cost time: 0.7563157081604004
Epoch: 7, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.234 Vali Acc: 0.830 Test Loss: 1.234 Test Acc: 0.830
Validation loss decreased (-0.811098 --> -0.829617).  Saving model ...
Epoch: 8 cost time: 0.779278039932251
Epoch: 8, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.109 Vali Acc: 0.904 Test Loss: 1.109 Test Acc: 0.904
Validation loss decreased (-0.829617 --> -0.903693).  Saving model ...
Epoch: 9 cost time: 0.6886703968048096
Epoch: 9, Steps: 2 | Train Loss: 1.036 Vali Loss: 0.982 Vali Acc: 0.922 Test Loss: 0.982 Test Acc: 0.922
Validation loss decreased (-0.903693 --> -0.922212).  Saving model ...
Epoch: 10 cost time: 0.7059173583984375
Epoch: 10, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.864 Vali Acc: 0.937 Test Loss: 0.864 Test Acc: 0.937
Validation loss decreased (-0.922212 --> -0.937028).  Saving model ...
Epoch: 11 cost time: 0.7373743057250977
Epoch: 11, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.757 Vali Acc: 0.930 Test Loss: 0.757 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8847758769989014
Epoch: 12, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.663 Vali Acc: 0.930 Test Loss: 0.663 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8172502517700195
Epoch: 13, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.582 Vali Acc: 0.930 Test Loss: 0.582 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7713930606842041
Epoch: 14, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.503 Vali Acc: 0.937 Test Loss: 0.503 Test Acc: 0.937
Validation loss decreased (-0.937028 --> -0.937032).  Saving model ...
Epoch: 15 cost time: 0.6655144691467285
Epoch: 15, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.444 Vali Acc: 0.922 Test Loss: 0.444 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.738455057144165
Epoch: 16, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.384 Vali Acc: 0.948 Test Loss: 0.384 Test Acc: 0.948
Validation loss decreased (-0.937032 --> -0.948144).  Saving model ...
Epoch: 17 cost time: 0.8767216205596924
Epoch: 17, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.826829195022583
Epoch: 18, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8180148601531982
Epoch: 19, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0233492851257324
Epoch: 20, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7400119304656982
Epoch: 21, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8192470073699951
Epoch: 22, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.842717170715332
Epoch: 23, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7975566387176514
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8983900547027588
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.165 Vali Acc: 0.937 Test Loss: 0.165 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.859551191329956
Epoch: 26, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.944 Test Loss: 0.151 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 36516102
model size : 153.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.166377067565918
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.715 Vali Acc: 0.152 Test Loss: 1.715 Test Acc: 0.152
Validation loss decreased (inf --> -0.151835).  Saving model ...
Epoch: 2 cost time: 0.6009366512298584
Epoch: 2, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.676 Vali Acc: 0.356 Test Loss: 1.676 Test Acc: 0.356
Validation loss decreased (-0.151835 --> -0.355539).  Saving model ...
Epoch: 3 cost time: 0.7043254375457764
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.640 Vali Acc: 0.452 Test Loss: 1.640 Test Acc: 0.452
Validation loss decreased (-0.355539 --> -0.451835).  Saving model ...
Epoch: 4 cost time: 0.8509359359741211
Epoch: 4, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.585 Vali Acc: 0.522 Test Loss: 1.585 Test Acc: 0.522
Validation loss decreased (-0.451835 --> -0.522206).  Saving model ...
Epoch: 5 cost time: 0.7992069721221924
Epoch: 5, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.513 Vali Acc: 0.678 Test Loss: 1.513 Test Acc: 0.678
Validation loss decreased (-0.522206 --> -0.677763).  Saving model ...
Epoch: 6 cost time: 0.867032527923584
Epoch: 6, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.430 Vali Acc: 0.737 Test Loss: 1.430 Test Acc: 0.737
Validation loss decreased (-0.677763 --> -0.737023).  Saving model ...
Epoch: 7 cost time: 0.7757432460784912
Epoch: 7, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.339 Vali Acc: 0.748 Test Loss: 1.339 Test Acc: 0.748
Validation loss decreased (-0.737023 --> -0.748135).  Saving model ...
Epoch: 8 cost time: 0.7764890193939209
Epoch: 8, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.246 Vali Acc: 0.770 Test Loss: 1.246 Test Acc: 0.770
Validation loss decreased (-0.748135 --> -0.770358).  Saving model ...
Epoch: 9 cost time: 0.6656334400177002
Epoch: 9, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.148 Vali Acc: 0.781 Test Loss: 1.148 Test Acc: 0.781
Validation loss decreased (-0.770358 --> -0.781470).  Saving model ...
Epoch: 10 cost time: 0.7636089324951172
Epoch: 10, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.049 Vali Acc: 0.807 Test Loss: 1.049 Test Acc: 0.807
Validation loss decreased (-0.781470 --> -0.807397).  Saving model ...
Epoch: 11 cost time: 0.6706891059875488
Epoch: 11, Steps: 2 | Train Loss: 0.988 Vali Loss: 0.945 Vali Acc: 0.841 Test Loss: 0.945 Test Acc: 0.841
Validation loss decreased (-0.807397 --> -0.840731).  Saving model ...
Epoch: 12 cost time: 0.6807060241699219
Epoch: 12, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.842 Vali Acc: 0.881 Test Loss: 0.842 Test Acc: 0.881
Validation loss decreased (-0.840731 --> -0.881473).  Saving model ...
Epoch: 13 cost time: 0.7307734489440918
Epoch: 13, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.746 Vali Acc: 0.889 Test Loss: 0.746 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 0.7053272724151611
Epoch: 14, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.659 Vali Acc: 0.904 Test Loss: 0.659 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903697).  Saving model ...
Epoch: 15 cost time: 0.5976464748382568
Epoch: 15, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.584 Vali Acc: 0.907 Test Loss: 0.584 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907402).  Saving model ...
Epoch: 16 cost time: 0.7154185771942139
Epoch: 16, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.520 Vali Acc: 0.904 Test Loss: 0.520 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6912102699279785
Epoch: 17, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.601999044418335
Epoch: 18, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.425 Vali Acc: 0.893 Test Loss: 0.425 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6223452091217041
Epoch: 19, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.380 Vali Acc: 0.896 Test Loss: 0.380 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7232422828674316
Epoch: 20, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.335 Vali Acc: 0.904 Test Loss: 0.335 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.685523271560669
Epoch: 21, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.294 Vali Acc: 0.915 Test Loss: 0.294 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 0.6053454875946045
Epoch: 22, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 23 cost time: 0.570624828338623
Epoch: 23, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6852762699127197
Epoch: 24, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 0.639631986618042
Epoch: 25, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 26 cost time: 0.635648250579834
Epoch: 26, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 27 cost time: 0.7878198623657227
Epoch: 27, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933332).  Saving model ...
Epoch: 28 cost time: 0.6574661731719971
Epoch: 28, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.6748895645141602
Epoch: 29, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.933 Test Loss: 0.155 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.733161211013794
Epoch: 30, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.937 Test Loss: 0.152 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937036).  Saving model ...
Epoch: 31 cost time: 0.739612340927124
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.948 Test Loss: 0.152 Test Acc: 0.948
Validation loss decreased (-0.937036 --> -0.948147).  Saving model ...
Epoch: 32 cost time: 0.6735584735870361
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.937 Test Loss: 0.158 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7517621517181396
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.933 Test Loss: 0.164 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.586083173751831
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6876606941223145
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.922 Test Loss: 0.175 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6254785060882568
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.930 Test Loss: 0.176 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6626501083374023
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6463229656219482
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6382279396057129
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.859339714050293
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7716860771179199
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 36448518
model size : 153.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.393575668334961
Epoch: 1, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.804 Vali Acc: 0.167 Test Loss: 1.804 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.8177711963653564
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.770 Vali Acc: 0.226 Test Loss: 1.770 Test Acc: 0.226
Validation loss decreased (-0.166649 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.7148947715759277
Epoch: 3, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.725 Vali Acc: 0.315 Test Loss: 1.725 Test Acc: 0.315
Validation loss decreased (-0.225908 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.7363502979278564
Epoch: 4, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.572 Vali Acc: 0.367 Test Loss: 1.572 Test Acc: 0.367
Validation loss decreased (-0.314798 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 0.6763043403625488
Epoch: 5, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.391 Vali Acc: 0.630 Test Loss: 1.391 Test Acc: 0.630
Validation loss decreased (-0.366651 --> -0.629616).  Saving model ...
Epoch: 6 cost time: 0.8023130893707275
Epoch: 6, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.214 Vali Acc: 0.796 Test Loss: 1.214 Test Acc: 0.796
Validation loss decreased (-0.629616 --> -0.796284).  Saving model ...
Epoch: 7 cost time: 0.7091338634490967
Epoch: 7, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.059 Vali Acc: 0.722 Test Loss: 1.059 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6840550899505615
Epoch: 8, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.903 Vali Acc: 0.807 Test Loss: 0.903 Test Acc: 0.807
Validation loss decreased (-0.796284 --> -0.807398).  Saving model ...
Epoch: 9 cost time: 0.6553270816802979
Epoch: 9, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.751 Vali Acc: 0.915 Test Loss: 0.751 Test Acc: 0.915
Validation loss decreased (-0.807398 --> -0.914807).  Saving model ...
Epoch: 10 cost time: 0.8290355205535889
Epoch: 10, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.636 Vali Acc: 0.926 Test Loss: 0.636 Test Acc: 0.926
Validation loss decreased (-0.914807 --> -0.925920).  Saving model ...
Epoch: 11 cost time: 0.8562309741973877
Epoch: 11, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.558 Vali Acc: 0.911 Test Loss: 0.558 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.876734733581543
Epoch: 12, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.488 Vali Acc: 0.919 Test Loss: 0.488 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7610394954681396
Epoch: 13, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.430 Vali Acc: 0.907 Test Loss: 0.430 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7131791114807129
Epoch: 14, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.368 Vali Acc: 0.919 Test Loss: 0.368 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8127901554107666
Epoch: 15, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.9065642356872559
Epoch: 16, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.934877872467041
Epoch: 17, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9079375267028809
Epoch: 18, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.265 Vali Acc: 0.907 Test Loss: 0.265 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9316153526306152
Epoch: 19, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8310840129852295
Epoch: 20, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8192729949951172
Epoch: 21, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.919 Test Loss: 0.202 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8116302490234375
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.9716572761535645
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.8633630275726318
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.8770232200622559
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9102637767791748
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8315114974975586
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.762134313583374
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8764832019805908
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8309299945831299
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7799942493438721
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9454281330108643
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7567026615142822
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.752983808517456
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 36709638
model size : 154.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.487217426300049
Epoch: 1, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.871 Vali Acc: 0.015 Test Loss: 1.871 Test Acc: 0.015
Validation loss decreased (inf --> -0.014796).  Saving model ...
Epoch: 2 cost time: 0.6654510498046875
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.825 Vali Acc: 0.196 Test Loss: 1.825 Test Acc: 0.196
Validation loss decreased (-0.014796 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6457686424255371
Epoch: 3, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.782 Vali Acc: 0.304 Test Loss: 1.782 Test Acc: 0.304
Validation loss decreased (-0.196278 --> -0.303686).  Saving model ...
Epoch: 4 cost time: 0.7589833736419678
Epoch: 4, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.697 Vali Acc: 0.441 Test Loss: 1.697 Test Acc: 0.441
Validation loss decreased (-0.303686 --> -0.440724).  Saving model ...
Epoch: 5 cost time: 0.7228784561157227
Epoch: 5, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.590 Vali Acc: 0.622 Test Loss: 1.590 Test Acc: 0.622
Validation loss decreased (-0.440724 --> -0.622206).  Saving model ...
Epoch: 6 cost time: 0.7068006992340088
Epoch: 6, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.466 Vali Acc: 0.685 Test Loss: 1.466 Test Acc: 0.685
Validation loss decreased (-0.622206 --> -0.685171).  Saving model ...
Epoch: 7 cost time: 0.632530927658081
Epoch: 7, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.335 Vali Acc: 0.833 Test Loss: 1.335 Test Acc: 0.833
Validation loss decreased (-0.685171 --> -0.833320).  Saving model ...
Epoch: 8 cost time: 0.7430648803710938
Epoch: 8, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.209 Vali Acc: 0.852 Test Loss: 1.209 Test Acc: 0.852
Validation loss decreased (-0.833320 --> -0.851840).  Saving model ...
Epoch: 9 cost time: 0.6195366382598877
Epoch: 9, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.086 Vali Acc: 0.863 Test Loss: 1.086 Test Acc: 0.863
Validation loss decreased (-0.851840 --> -0.862952).  Saving model ...
Epoch: 10 cost time: 0.6978292465209961
Epoch: 10, Steps: 2 | Train Loss: 0.979 Vali Loss: 0.964 Vali Acc: 0.900 Test Loss: 0.964 Test Acc: 0.900
Validation loss decreased (-0.862952 --> -0.899990).  Saving model ...
Epoch: 11 cost time: 0.8431756496429443
Epoch: 11, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.853 Vali Acc: 0.911 Test Loss: 0.853 Test Acc: 0.911
Validation loss decreased (-0.899990 --> -0.911103).  Saving model ...
Epoch: 12 cost time: 0.7224056720733643
Epoch: 12, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.751 Vali Acc: 0.919 Test Loss: 0.751 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918511).  Saving model ...
Epoch: 13 cost time: 0.9216113090515137
Epoch: 13, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.662 Vali Acc: 0.922 Test Loss: 0.662 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 14 cost time: 0.7698960304260254
Epoch: 14, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.583 Vali Acc: 0.919 Test Loss: 0.583 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8119218349456787
Epoch: 15, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.511 Vali Acc: 0.926 Test Loss: 0.511 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.6873867511749268
Epoch: 16, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.453 Vali Acc: 0.926 Test Loss: 0.453 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 17 cost time: 0.9080226421356201
Epoch: 17, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 18 cost time: 0.7627367973327637
Epoch: 18, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.352 Vali Acc: 0.926 Test Loss: 0.352 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 19 cost time: 0.8187065124511719
Epoch: 19, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8312993049621582
Epoch: 20, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.304 Vali Acc: 0.907 Test Loss: 0.304 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7473313808441162
Epoch: 21, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6827797889709473
Epoch: 22, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.8916301727294922
Epoch: 23, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.7709352970123291
Epoch: 24, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6986143589019775
Epoch: 25, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.707916259765625
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8647308349609375
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.7369019985198975
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.826890230178833
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8076961040496826
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7364177703857422
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7312536239624023
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.7463078498840332
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6426756381988525
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.806755542755127
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7102153301239014
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6872994899749756
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7076900005340576
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.718620777130127
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8029918670654297
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6256053447723389
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.708336353302002
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6105575561523438
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6068928241729736
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36519174
model size : 153.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9985835552215576
Epoch: 1, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.831 Vali Acc: 0.115 Test Loss: 1.831 Test Acc: 0.115
Validation loss decreased (inf --> -0.114797).  Saving model ...
Epoch: 2 cost time: 0.5904669761657715
Epoch: 2, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.799 Vali Acc: 0.133 Test Loss: 1.799 Test Acc: 0.133
Validation loss decreased (-0.114797 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.6070542335510254
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.768 Vali Acc: 0.244 Test Loss: 1.768 Test Acc: 0.244
Validation loss decreased (-0.133315 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.708784818649292
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.720 Vali Acc: 0.341 Test Loss: 1.720 Test Acc: 0.341
Validation loss decreased (-0.244427 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.7085592746734619
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.662 Vali Acc: 0.441 Test Loss: 1.662 Test Acc: 0.441
Validation loss decreased (-0.340724 --> -0.440724).  Saving model ...
Epoch: 6 cost time: 0.7020108699798584
Epoch: 6, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.596 Vali Acc: 0.567 Test Loss: 1.596 Test Acc: 0.567
Validation loss decreased (-0.440724 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 0.7576916217803955
Epoch: 7, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.524 Vali Acc: 0.648 Test Loss: 1.524 Test Acc: 0.648
Validation loss decreased (-0.566651 --> -0.648133).  Saving model ...
Epoch: 8 cost time: 0.6433148384094238
Epoch: 8, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.445 Vali Acc: 0.707 Test Loss: 1.445 Test Acc: 0.707
Validation loss decreased (-0.648133 --> -0.707393).  Saving model ...
Epoch: 9 cost time: 0.8581469058990479
Epoch: 9, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.363 Vali Acc: 0.778 Test Loss: 1.363 Test Acc: 0.778
Validation loss decreased (-0.707393 --> -0.777764).  Saving model ...
Epoch: 10 cost time: 0.8466377258300781
Epoch: 10, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.279 Vali Acc: 0.815 Test Loss: 1.279 Test Acc: 0.815
Validation loss decreased (-0.777764 --> -0.814802).  Saving model ...
Epoch: 11 cost time: 0.6840934753417969
Epoch: 11, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.193 Vali Acc: 0.841 Test Loss: 1.193 Test Acc: 0.841
Validation loss decreased (-0.814802 --> -0.840729).  Saving model ...
Epoch: 12 cost time: 0.880915641784668
Epoch: 12, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.107 Vali Acc: 0.856 Test Loss: 1.107 Test Acc: 0.856
Validation loss decreased (-0.840729 --> -0.855544).  Saving model ...
Epoch: 13 cost time: 0.7352077960968018
Epoch: 13, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.022 Vali Acc: 0.856 Test Loss: 1.022 Test Acc: 0.856
Validation loss decreased (-0.855544 --> -0.855545).  Saving model ...
Epoch: 14 cost time: 0.8027083873748779
Epoch: 14, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.935 Vali Acc: 0.881 Test Loss: 0.935 Test Acc: 0.881
Validation loss decreased (-0.855545 --> -0.881472).  Saving model ...
Epoch: 15 cost time: 0.7958502769470215
Epoch: 15, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.849 Vali Acc: 0.885 Test Loss: 0.849 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885177).  Saving model ...
Epoch: 16 cost time: 0.7162008285522461
Epoch: 16, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.765 Vali Acc: 0.904 Test Loss: 0.765 Test Acc: 0.904
Validation loss decreased (-0.885177 --> -0.903696).  Saving model ...
Epoch: 17 cost time: 0.6384387016296387
Epoch: 17, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.687 Vali Acc: 0.922 Test Loss: 0.687 Test Acc: 0.922
Validation loss decreased (-0.903696 --> -0.922215).  Saving model ...
Epoch: 18 cost time: 0.7878541946411133
Epoch: 18, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.616 Vali Acc: 0.930 Test Loss: 0.616 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929623).  Saving model ...
Epoch: 19 cost time: 0.6787474155426025
Epoch: 19, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.552 Vali Acc: 0.926 Test Loss: 0.552 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6944646835327148
Epoch: 20, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.499 Vali Acc: 0.915 Test Loss: 0.499 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8690552711486816
Epoch: 21, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.448 Vali Acc: 0.915 Test Loss: 0.448 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7646181583404541
Epoch: 22, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.396 Vali Acc: 0.919 Test Loss: 0.396 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6761622428894043
Epoch: 23, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6899619102478027
Epoch: 24, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.7006516456604004
Epoch: 25, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
Validation loss decreased (-0.929627 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 0.7161235809326172
Epoch: 26, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.6163744926452637
Epoch: 27, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.7117354869842529
Epoch: 28, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7039833068847656
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7553377151489258
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.8627822399139404
Epoch: 31, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.6570839881896973
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.7236084938049316
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.6947696208953857
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.7691786289215088
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8273406028747559
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6667602062225342
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6198029518127441
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.677098274230957
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7331373691558838
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8569915294647217
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7874341011047363
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6761796474456787
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6478424072265625
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 36427014
model size : 153.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.5619471073150635
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.769 Vali Acc: 0.300 Test Loss: 1.769 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 0.6529910564422607
Epoch: 2, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.672 Vali Acc: 0.337 Test Loss: 1.672 Test Acc: 0.337
Validation loss decreased (-0.299982 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.7012453079223633
Epoch: 3, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.602 Vali Acc: 0.463 Test Loss: 1.602 Test Acc: 0.463
Validation loss decreased (-0.337020 --> -0.462947).  Saving model ...
Epoch: 4 cost time: 0.674513578414917
Epoch: 4, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.518 Vali Acc: 0.556 Test Loss: 1.518 Test Acc: 0.556
Validation loss decreased (-0.462947 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 0.6915328502655029
Epoch: 5, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.413 Vali Acc: 0.711 Test Loss: 1.413 Test Acc: 0.711
Validation loss decreased (-0.555540 --> -0.711097).  Saving model ...
Epoch: 6 cost time: 0.7478926181793213
Epoch: 6, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.299 Vali Acc: 0.730 Test Loss: 1.299 Test Acc: 0.730
Validation loss decreased (-0.711097 --> -0.729617).  Saving model ...
Epoch: 7 cost time: 0.7822749614715576
Epoch: 7, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.186 Vali Acc: 0.722 Test Loss: 1.186 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7522549629211426
Epoch: 8, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.074 Vali Acc: 0.748 Test Loss: 1.074 Test Acc: 0.748
Validation loss decreased (-0.729617 --> -0.748137).  Saving model ...
Epoch: 9 cost time: 0.5685327053070068
Epoch: 9, Steps: 2 | Train Loss: 0.976 Vali Loss: 0.961 Vali Acc: 0.781 Test Loss: 0.961 Test Acc: 0.781
Validation loss decreased (-0.748137 --> -0.781472).  Saving model ...
Epoch: 10 cost time: 0.6163473129272461
Epoch: 10, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.849 Vali Acc: 0.856 Test Loss: 0.849 Test Acc: 0.856
Validation loss decreased (-0.781472 --> -0.855547).  Saving model ...
Epoch: 11 cost time: 0.7724745273590088
Epoch: 11, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.746 Vali Acc: 0.893 Test Loss: 0.746 Test Acc: 0.893
Validation loss decreased (-0.855547 --> -0.892585).  Saving model ...
Epoch: 12 cost time: 0.7955398559570312
Epoch: 12, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.651 Vali Acc: 0.900 Test Loss: 0.651 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.7314112186431885
Epoch: 13, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.568 Vali Acc: 0.915 Test Loss: 0.568 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914809).  Saving model ...
Epoch: 14 cost time: 0.7289094924926758
Epoch: 14, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.504 Vali Acc: 0.896 Test Loss: 0.504 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8654379844665527
Epoch: 15, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5560414791107178
Epoch: 16, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.393 Vali Acc: 0.915 Test Loss: 0.393 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914811).  Saving model ...
Epoch: 17 cost time: 0.5899958610534668
Epoch: 17, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.364 Vali Acc: 0.915 Test Loss: 0.364 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 18 cost time: 0.6659200191497803
Epoch: 18, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 19 cost time: 0.6538207530975342
Epoch: 19, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 20 cost time: 0.6461634635925293
Epoch: 20, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 21 cost time: 0.6712112426757812
Epoch: 21, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.6700913906097412
Epoch: 22, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.5327746868133545
Epoch: 23, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6871161460876465
Epoch: 24, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 25 cost time: 0.7337095737457275
Epoch: 25, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7262279987335205
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7131228446960449
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 28 cost time: 0.6694777011871338
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.915 Test Loss: 0.195 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6947298049926758
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.919 Test Loss: 0.203 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.710705041885376
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6668035984039307
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6556699275970459
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6746101379394531
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.6414191722869873
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.7467653751373291
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.6330373287200928
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.6036832332611084
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6391282081604004
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.637953519821167
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6235136985778809
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6964826583862305
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9977397918701172
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7977695465087891
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7809772491455078
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7654459476470947
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7899453639984131
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7653400897979736
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 36528390
model size : 154.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.954690456390381
Epoch: 1, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.703 Vali Acc: 0.274 Test Loss: 1.703 Test Acc: 0.274
Validation loss decreased (inf --> -0.274057).  Saving model ...
Epoch: 2 cost time: 0.7314672470092773
Epoch: 2, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.632 Vali Acc: 0.385 Test Loss: 1.632 Test Acc: 0.385
Validation loss decreased (-0.274057 --> -0.385169).  Saving model ...
Epoch: 3 cost time: 0.6749804019927979
Epoch: 3, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.577 Vali Acc: 0.611 Test Loss: 1.577 Test Acc: 0.611
Validation loss decreased (-0.385169 --> -0.611095).  Saving model ...
Epoch: 4 cost time: 0.740931510925293
Epoch: 4, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.516 Vali Acc: 0.633 Test Loss: 1.516 Test Acc: 0.633
Validation loss decreased (-0.611095 --> -0.633318).  Saving model ...
Epoch: 5 cost time: 0.8649134635925293
Epoch: 5, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.442 Vali Acc: 0.733 Test Loss: 1.442 Test Acc: 0.733
Validation loss decreased (-0.633318 --> -0.733319).  Saving model ...
Epoch: 6 cost time: 0.8095049858093262
Epoch: 6, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.359 Vali Acc: 0.819 Test Loss: 1.359 Test Acc: 0.819
Validation loss decreased (-0.733319 --> -0.818505).  Saving model ...
Epoch: 7 cost time: 0.6907269954681396
Epoch: 7, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.266 Vali Acc: 0.841 Test Loss: 1.266 Test Acc: 0.841
Validation loss decreased (-0.818505 --> -0.840728).  Saving model ...
Epoch: 8 cost time: 0.7826154232025146
Epoch: 8, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.168 Vali Acc: 0.841 Test Loss: 1.168 Test Acc: 0.841
Validation loss decreased (-0.840728 --> -0.840729).  Saving model ...
Epoch: 9 cost time: 0.819333553314209
Epoch: 9, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.066 Vali Acc: 0.878 Test Loss: 1.066 Test Acc: 0.878
Validation loss decreased (-0.840729 --> -0.877767).  Saving model ...
Epoch: 10 cost time: 0.6256153583526611
Epoch: 10, Steps: 2 | Train Loss: 1.013 Vali Loss: 0.968 Vali Acc: 0.881 Test Loss: 0.968 Test Acc: 0.881
Validation loss decreased (-0.877767 --> -0.881472).  Saving model ...
Epoch: 11 cost time: 1.0067799091339111
Epoch: 11, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.876 Vali Acc: 0.885 Test Loss: 0.876 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 12 cost time: 0.827653169631958
Epoch: 12, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.787 Vali Acc: 0.915 Test Loss: 0.787 Test Acc: 0.915
Validation loss decreased (-0.885176 --> -0.914807).  Saving model ...
Epoch: 13 cost time: 0.7672867774963379
Epoch: 13, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.704 Vali Acc: 0.919 Test Loss: 0.704 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 14 cost time: 0.755059003829956
Epoch: 14, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.631 Vali Acc: 0.900 Test Loss: 0.631 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7766423225402832
Epoch: 15, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.567 Vali Acc: 0.893 Test Loss: 0.567 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7293684482574463
Epoch: 16, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.508 Vali Acc: 0.896 Test Loss: 0.508 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9315431118011475
Epoch: 17, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.457 Vali Acc: 0.915 Test Loss: 0.457 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8886775970458984
Epoch: 18, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.405 Vali Acc: 0.922 Test Loss: 0.405 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922218).  Saving model ...
Epoch: 19 cost time: 0.866213321685791
Epoch: 19, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 0.8861494064331055
Epoch: 20, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940738).  Saving model ...
Epoch: 21 cost time: 1.005953311920166
Epoch: 21, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5873966217041016
Epoch: 22, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5070664882659912
Epoch: 23, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6318886280059814
Epoch: 24, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9184534549713135
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9900624752044678
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8294527530670166
Epoch: 27, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.8841874599456787
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7897205352783203
Epoch: 29, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.926 Test Loss: 0.176 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8402786254882812
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.926 Test Loss: 0.178 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.812701940536499
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8937654495239258
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.926 Test Loss: 0.175 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8365652561187744
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.926 Test Loss: 0.173 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8435766696929932
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8777563571929932
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.926 Test Loss: 0.174 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8481810092926025
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.930 Test Loss: 0.176 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7933356761932373
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36466950
model size : 153.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.074476480484009
Epoch: 1, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.835 Vali Acc: 0.167 Test Loss: 1.835 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.7338674068450928
Epoch: 2, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.762 Vali Acc: 0.252 Test Loss: 1.762 Test Acc: 0.252
Validation loss decreased (-0.166648 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.7687387466430664
Epoch: 3, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.716 Vali Acc: 0.274 Test Loss: 1.716 Test Acc: 0.274
Validation loss decreased (-0.251834 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.7209043502807617
Epoch: 4, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.670 Vali Acc: 0.356 Test Loss: 1.670 Test Acc: 0.356
Validation loss decreased (-0.274057 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 0.7021102905273438
Epoch: 5, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.614 Vali Acc: 0.485 Test Loss: 1.614 Test Acc: 0.485
Validation loss decreased (-0.355539 --> -0.485169).  Saving model ...
Epoch: 6 cost time: 0.817333459854126
Epoch: 6, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.551 Vali Acc: 0.633 Test Loss: 1.551 Test Acc: 0.633
Validation loss decreased (-0.485169 --> -0.633318).  Saving model ...
Epoch: 7 cost time: 0.5554914474487305
Epoch: 7, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.484 Vali Acc: 0.678 Test Loss: 1.484 Test Acc: 0.678
Validation loss decreased (-0.633318 --> -0.677763).  Saving model ...
Epoch: 8 cost time: 0.779595136642456
Epoch: 8, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.412 Vali Acc: 0.737 Test Loss: 1.412 Test Acc: 0.737
Validation loss decreased (-0.677763 --> -0.737023).  Saving model ...
Epoch: 9 cost time: 0.6502213478088379
Epoch: 9, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.333 Vali Acc: 0.789 Test Loss: 1.333 Test Acc: 0.789
Validation loss decreased (-0.737023 --> -0.788876).  Saving model ...
Epoch: 10 cost time: 0.8317253589630127
Epoch: 10, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.252 Vali Acc: 0.826 Test Loss: 1.252 Test Acc: 0.826
Validation loss decreased (-0.788876 --> -0.825913).  Saving model ...
Epoch: 11 cost time: 0.7883994579315186
Epoch: 11, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.164 Vali Acc: 0.844 Test Loss: 1.164 Test Acc: 0.844
Validation loss decreased (-0.825913 --> -0.844433).  Saving model ...
Epoch: 12 cost time: 0.6958863735198975
Epoch: 12, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.073 Vali Acc: 0.878 Test Loss: 1.073 Test Acc: 0.878
Validation loss decreased (-0.844433 --> -0.877767).  Saving model ...
Epoch: 13 cost time: 0.7618935108184814
Epoch: 13, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.984 Vali Acc: 0.889 Test Loss: 0.984 Test Acc: 0.889
Validation loss decreased (-0.877767 --> -0.888879).  Saving model ...
Epoch: 14 cost time: 0.7087035179138184
Epoch: 14, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.897 Vali Acc: 0.911 Test Loss: 0.897 Test Acc: 0.911
Validation loss decreased (-0.888879 --> -0.911102).  Saving model ...
Epoch: 15 cost time: 0.7415351867675781
Epoch: 15, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.816 Vali Acc: 0.930 Test Loss: 0.816 Test Acc: 0.930
Validation loss decreased (-0.911102 --> -0.929621).  Saving model ...
Epoch: 16 cost time: 0.7865123748779297
Epoch: 16, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.736 Vali Acc: 0.922 Test Loss: 0.736 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7352101802825928
Epoch: 17, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.664 Vali Acc: 0.937 Test Loss: 0.664 Test Acc: 0.937
Validation loss decreased (-0.929621 --> -0.937030).  Saving model ...
Epoch: 18 cost time: 0.658684492111206
Epoch: 18, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.595 Vali Acc: 0.930 Test Loss: 0.595 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7489018440246582
Epoch: 19, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.533 Vali Acc: 0.926 Test Loss: 0.533 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6985883712768555
Epoch: 20, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.473 Vali Acc: 0.926 Test Loss: 0.473 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6123583316802979
Epoch: 21, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.416 Vali Acc: 0.933 Test Loss: 0.416 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8433988094329834
Epoch: 22, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.371 Vali Acc: 0.941 Test Loss: 0.371 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.57527756690979
Epoch: 23, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.328 Vali Acc: 0.948 Test Loss: 0.328 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.6355104446411133
Epoch: 24, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.291 Vali Acc: 0.948 Test Loss: 0.291 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 25 cost time: 0.7191882133483887
Epoch: 25, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7382409572601318
Epoch: 26, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7067854404449463
Epoch: 27, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5315449237823486
Epoch: 28, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6125648021697998
Epoch: 29, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8215761184692383
Epoch: 30, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.7287251949310303
Epoch: 31, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.6771249771118164
Epoch: 32, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.941 Test Loss: 0.156 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6392107009887695
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.977576494216919
Epoch: 34, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8995795249938965
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5482692718505859
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.639462947845459
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7657403945922852
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7494897842407227
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.748694896697998
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7848196029663086
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 36417798
model size : 153.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1039514541625977
Epoch: 1, Steps: 2 | Train Loss: 2.019 Vali Loss: 1.918 Vali Acc: 0.104 Test Loss: 1.918 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.7188162803649902
Epoch: 2, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.863 Vali Acc: 0.093 Test Loss: 1.863 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7085456848144531
Epoch: 3, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.825 Vali Acc: 0.093 Test Loss: 1.825 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6282436847686768
Epoch: 4, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.743 Vali Acc: 0.211 Test Loss: 1.743 Test Acc: 0.211
Validation loss decreased (-0.103685 --> -0.211094).  Saving model ...
Epoch: 5 cost time: 0.7323768138885498
Epoch: 5, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.636 Vali Acc: 0.319 Test Loss: 1.636 Test Acc: 0.319
Validation loss decreased (-0.211094 --> -0.318502).  Saving model ...
Epoch: 6 cost time: 0.900254487991333
Epoch: 6, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.512 Vali Acc: 0.652 Test Loss: 1.512 Test Acc: 0.652
Validation loss decreased (-0.318502 --> -0.651837).  Saving model ...
Epoch: 7 cost time: 0.6711728572845459
Epoch: 7, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.377 Vali Acc: 0.848 Test Loss: 1.377 Test Acc: 0.848
Validation loss decreased (-0.651837 --> -0.848134).  Saving model ...
Epoch: 8 cost time: 0.6596486568450928
Epoch: 8, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.245 Vali Acc: 0.852 Test Loss: 1.245 Test Acc: 0.852
Validation loss decreased (-0.848134 --> -0.851839).  Saving model ...
Epoch: 9 cost time: 0.7835538387298584
Epoch: 9, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.118 Vali Acc: 0.800 Test Loss: 1.118 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6693542003631592
Epoch: 10, Steps: 2 | Train Loss: 0.983 Vali Loss: 0.989 Vali Acc: 0.837 Test Loss: 0.989 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6790549755096436
Epoch: 11, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.860 Vali Acc: 0.907 Test Loss: 0.860 Test Acc: 0.907
Validation loss decreased (-0.851839 --> -0.907399).  Saving model ...
Epoch: 12 cost time: 0.6841154098510742
Epoch: 12, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.741 Vali Acc: 0.915 Test Loss: 0.741 Test Acc: 0.915
Validation loss decreased (-0.907399 --> -0.914807).  Saving model ...
Epoch: 13 cost time: 0.7338128089904785
Epoch: 13, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.640 Vali Acc: 0.896 Test Loss: 0.640 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7006385326385498
Epoch: 14, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.547 Vali Acc: 0.904 Test Loss: 0.547 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6421403884887695
Epoch: 15, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.465 Vali Acc: 0.937 Test Loss: 0.465 Test Acc: 0.937
Validation loss decreased (-0.914807 --> -0.937032).  Saving model ...
Epoch: 16 cost time: 0.6555767059326172
Epoch: 16, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.394 Vali Acc: 0.926 Test Loss: 0.394 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.805905818939209
Epoch: 17, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.334 Vali Acc: 0.922 Test Loss: 0.334 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7475557327270508
Epoch: 18, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.292 Vali Acc: 0.915 Test Loss: 0.292 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6490094661712646
Epoch: 19, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.275 Vali Acc: 0.904 Test Loss: 0.275 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9259624481201172
Epoch: 20, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7881152629852295
Epoch: 21, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1279785633087158
Epoch: 22, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5897283554077148
Epoch: 23, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6174271106719971
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.893 Test Loss: 0.250 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.908043384552002
Epoch: 25, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 36531462
model size : 154.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6952154636383057
Epoch: 1, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.854 Vali Acc: 0.170 Test Loss: 1.854 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.7720904350280762
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.824 Vali Acc: 0.207 Test Loss: 1.824 Test Acc: 0.207
Validation loss decreased (-0.170352 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.7268998622894287
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.786 Vali Acc: 0.274 Test Loss: 1.786 Test Acc: 0.274
Validation loss decreased (-0.207389 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 0.7595090866088867
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.724 Vali Acc: 0.311 Test Loss: 1.724 Test Acc: 0.311
Validation loss decreased (-0.274056 --> -0.311094).  Saving model ...
Epoch: 5 cost time: 0.6814277172088623
Epoch: 5, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.647 Vali Acc: 0.419 Test Loss: 1.647 Test Acc: 0.419
Validation loss decreased (-0.311094 --> -0.418502).  Saving model ...
Epoch: 6 cost time: 0.9017074108123779
Epoch: 6, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.564 Vali Acc: 0.519 Test Loss: 1.564 Test Acc: 0.519
Validation loss decreased (-0.418502 --> -0.518503).  Saving model ...
Epoch: 7 cost time: 0.7434864044189453
Epoch: 7, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.480 Vali Acc: 0.604 Test Loss: 1.480 Test Acc: 0.604
Validation loss decreased (-0.518503 --> -0.603689).  Saving model ...
Epoch: 8 cost time: 0.8172001838684082
Epoch: 8, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.384 Vali Acc: 0.767 Test Loss: 1.384 Test Acc: 0.767
Validation loss decreased (-0.603689 --> -0.766653).  Saving model ...
Epoch: 9 cost time: 0.719567060470581
Epoch: 9, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.278 Vali Acc: 0.830 Test Loss: 1.278 Test Acc: 0.830
Validation loss decreased (-0.766653 --> -0.829617).  Saving model ...
Epoch: 10 cost time: 0.6922099590301514
Epoch: 10, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.172 Vali Acc: 0.863 Test Loss: 1.172 Test Acc: 0.863
Validation loss decreased (-0.829617 --> -0.862951).  Saving model ...
Epoch: 11 cost time: 0.6917924880981445
Epoch: 11, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.072 Vali Acc: 0.856 Test Loss: 1.072 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.697777509689331
Epoch: 12, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.973 Vali Acc: 0.841 Test Loss: 0.973 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6532862186431885
Epoch: 13, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.878 Vali Acc: 0.848 Test Loss: 0.878 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6905086040496826
Epoch: 14, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.780 Vali Acc: 0.885 Test Loss: 0.780 Test Acc: 0.885
Validation loss decreased (-0.862951 --> -0.885177).  Saving model ...
Epoch: 15 cost time: 0.6997203826904297
Epoch: 15, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.690 Vali Acc: 0.904 Test Loss: 0.690 Test Acc: 0.904
Validation loss decreased (-0.885177 --> -0.903697).  Saving model ...
Epoch: 16 cost time: 0.7521579265594482
Epoch: 16, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.604 Vali Acc: 0.915 Test Loss: 0.604 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914809).  Saving model ...
Epoch: 17 cost time: 0.7656161785125732
Epoch: 17, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.527 Vali Acc: 0.907 Test Loss: 0.527 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9417529106140137
Epoch: 18, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.462 Vali Acc: 0.915 Test Loss: 0.462 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 19 cost time: 0.9832053184509277
Epoch: 19, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.409 Vali Acc: 0.919 Test Loss: 0.409 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 20 cost time: 0.9431514739990234
Epoch: 20, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8018262386322021
Epoch: 21, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.338 Vali Acc: 0.904 Test Loss: 0.338 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.735278844833374
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.291 Vali Acc: 0.907 Test Loss: 0.291 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8738150596618652
Epoch: 23, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.260 Vali Acc: 0.907 Test Loss: 0.260 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.97538161277771
Epoch: 24, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.254 Vali Acc: 0.893 Test Loss: 0.254 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8882918357849121
Epoch: 25, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.254 Vali Acc: 0.893 Test Loss: 0.254 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8749442100524902
Epoch: 26, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.261 Vali Acc: 0.885 Test Loss: 0.261 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0845625400543213
Epoch: 27, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.267 Vali Acc: 0.893 Test Loss: 0.267 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.076612949371338
Epoch: 28, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.281 Vali Acc: 0.896 Test Loss: 0.281 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9966731071472168
Epoch: 29, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.309 Vali Acc: 0.889 Test Loss: 0.309 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 36470022
model size : 153.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1990861892700195
Epoch: 1, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.950 Vali Acc: 0.167 Test Loss: 1.950 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.7371916770935059
Epoch: 2, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.849 Vali Acc: 0.152 Test Loss: 1.849 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6493208408355713
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.803 Vali Acc: 0.156 Test Loss: 1.803 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6478173732757568
Epoch: 4, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.765 Vali Acc: 0.270 Test Loss: 1.765 Test Acc: 0.270
Validation loss decreased (-0.166647 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.7062594890594482
Epoch: 5, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.717 Vali Acc: 0.407 Test Loss: 1.717 Test Acc: 0.407
Validation loss decreased (-0.270353 --> -0.407390).  Saving model ...
Epoch: 6 cost time: 0.6619377136230469
Epoch: 6, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.664 Vali Acc: 0.504 Test Loss: 1.664 Test Acc: 0.504
Validation loss decreased (-0.407390 --> -0.503687).  Saving model ...
Epoch: 7 cost time: 0.5725357532501221
Epoch: 7, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.607 Vali Acc: 0.593 Test Loss: 1.607 Test Acc: 0.593
Validation loss decreased (-0.503687 --> -0.592577).  Saving model ...
Epoch: 8 cost time: 0.6130237579345703
Epoch: 8, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.547 Vali Acc: 0.689 Test Loss: 1.547 Test Acc: 0.689
Validation loss decreased (-0.592577 --> -0.688873).  Saving model ...
Epoch: 9 cost time: 0.6751363277435303
Epoch: 9, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.482 Vali Acc: 0.744 Test Loss: 1.482 Test Acc: 0.744
Validation loss decreased (-0.688873 --> -0.744430).  Saving model ...
Epoch: 10 cost time: 0.5942573547363281
Epoch: 10, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.411 Vali Acc: 0.785 Test Loss: 1.411 Test Acc: 0.785
Validation loss decreased (-0.744430 --> -0.785171).  Saving model ...
Epoch: 11 cost time: 0.7616360187530518
Epoch: 11, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.335 Vali Acc: 0.811 Test Loss: 1.335 Test Acc: 0.811
Validation loss decreased (-0.785171 --> -0.811098).  Saving model ...
Epoch: 12 cost time: 0.6415467262268066
Epoch: 12, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.258 Vali Acc: 0.844 Test Loss: 1.258 Test Acc: 0.844
Validation loss decreased (-0.811098 --> -0.844432).  Saving model ...
Epoch: 13 cost time: 0.6240139007568359
Epoch: 13, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.180 Vali Acc: 0.859 Test Loss: 1.180 Test Acc: 0.859
Validation loss decreased (-0.844432 --> -0.859247).  Saving model ...
Epoch: 14 cost time: 0.5743072032928467
Epoch: 14, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.097 Vali Acc: 0.874 Test Loss: 1.097 Test Acc: 0.874
Validation loss decreased (-0.859247 --> -0.874063).  Saving model ...
Epoch: 15 cost time: 0.604708194732666
Epoch: 15, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.010 Vali Acc: 0.896 Test Loss: 1.010 Test Acc: 0.896
Validation loss decreased (-0.874063 --> -0.896286).  Saving model ...
Epoch: 16 cost time: 0.5662105083465576
Epoch: 16, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.922 Vali Acc: 0.904 Test Loss: 0.922 Test Acc: 0.904
Validation loss decreased (-0.896286 --> -0.903694).  Saving model ...
Epoch: 17 cost time: 0.5709807872772217
Epoch: 17, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.837 Vali Acc: 0.915 Test Loss: 0.837 Test Acc: 0.915
Validation loss decreased (-0.903694 --> -0.914806).  Saving model ...
Epoch: 18 cost time: 0.5622239112854004
Epoch: 18, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.753 Vali Acc: 0.915 Test Loss: 0.753 Test Acc: 0.915
Validation loss decreased (-0.914806 --> -0.914807).  Saving model ...
Epoch: 19 cost time: 0.5474522113800049
Epoch: 19, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.669 Vali Acc: 0.926 Test Loss: 0.669 Test Acc: 0.926
Validation loss decreased (-0.914807 --> -0.925919).  Saving model ...
Epoch: 20 cost time: 0.7091548442840576
Epoch: 20, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.588 Vali Acc: 0.911 Test Loss: 0.588 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.59706711769104
Epoch: 21, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.512 Vali Acc: 0.904 Test Loss: 0.512 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.48390769958496094
Epoch: 22, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.446 Vali Acc: 0.896 Test Loss: 0.446 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.49986863136291504
Epoch: 23, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.390 Vali Acc: 0.893 Test Loss: 0.390 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7517096996307373
Epoch: 24, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.347 Vali Acc: 0.885 Test Loss: 0.347 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7408285140991211
Epoch: 25, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.306 Vali Acc: 0.893 Test Loss: 0.306 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5901663303375244
Epoch: 26, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5584414005279541
Epoch: 27, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.252 Vali Acc: 0.904 Test Loss: 0.252 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6071255207061768
Epoch: 28, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.7003746032714844
Epoch: 29, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6916253566741943
Epoch: 30, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6621623039245605
Epoch: 31, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7287487983703613
Epoch: 32, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.244 Vali Acc: 0.893 Test Loss: 0.244 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6933495998382568
Epoch: 33, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.251 Vali Acc: 0.896 Test Loss: 0.251 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6887192726135254
Epoch: 34, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.247 Vali Acc: 0.896 Test Loss: 0.247 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7152814865112305
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.774799108505249
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.231 Vali Acc: 0.900 Test Loss: 0.231 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.723832368850708
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.907 Test Loss: 0.227 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9536228179931641
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 36408582
model size : 153.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.917574405670166
Epoch: 1, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.859 Vali Acc: 0.163 Test Loss: 1.859 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.8531572818756104
Epoch: 2, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.789 Vali Acc: 0.215 Test Loss: 1.789 Test Acc: 0.215
Validation loss decreased (-0.162944 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.8893489837646484
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.729 Vali Acc: 0.326 Test Loss: 1.729 Test Acc: 0.326
Validation loss decreased (-0.214797 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.8426265716552734
Epoch: 4, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.640 Vali Acc: 0.407 Test Loss: 1.640 Test Acc: 0.407
Validation loss decreased (-0.325909 --> -0.407391).  Saving model ...
Epoch: 5 cost time: 0.7427806854248047
Epoch: 5, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.528 Vali Acc: 0.600 Test Loss: 1.528 Test Acc: 0.600
Validation loss decreased (-0.407391 --> -0.599985).  Saving model ...
Epoch: 6 cost time: 0.7162408828735352
Epoch: 6, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.407 Vali Acc: 0.670 Test Loss: 1.407 Test Acc: 0.670
Validation loss decreased (-0.599985 --> -0.670356).  Saving model ...
Epoch: 7 cost time: 0.8389952182769775
Epoch: 7, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.280 Vali Acc: 0.711 Test Loss: 1.280 Test Acc: 0.711
Validation loss decreased (-0.670356 --> -0.711098).  Saving model ...
Epoch: 8 cost time: 0.7581624984741211
Epoch: 8, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.156 Vali Acc: 0.774 Test Loss: 1.156 Test Acc: 0.774
Validation loss decreased (-0.711098 --> -0.774063).  Saving model ...
Epoch: 9 cost time: 0.6229608058929443
Epoch: 9, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.033 Vali Acc: 0.837 Test Loss: 1.033 Test Acc: 0.837
Validation loss decreased (-0.774063 --> -0.837027).  Saving model ...
Epoch: 10 cost time: 0.7555248737335205
Epoch: 10, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.917 Vali Acc: 0.859 Test Loss: 0.917 Test Acc: 0.859
Validation loss decreased (-0.837027 --> -0.859250).  Saving model ...
Epoch: 11 cost time: 0.7351832389831543
Epoch: 11, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.806 Vali Acc: 0.878 Test Loss: 0.806 Test Acc: 0.878
Validation loss decreased (-0.859250 --> -0.877770).  Saving model ...
Epoch: 12 cost time: 0.7709426879882812
Epoch: 12, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.702 Vali Acc: 0.889 Test Loss: 0.702 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 0.7404220104217529
Epoch: 13, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.610 Vali Acc: 0.915 Test Loss: 0.610 Test Acc: 0.915
Validation loss decreased (-0.888882 --> -0.914809).  Saving model ...
Epoch: 14 cost time: 0.874032735824585
Epoch: 14, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.535 Vali Acc: 0.933 Test Loss: 0.535 Test Acc: 0.933
Validation loss decreased (-0.914809 --> -0.933328).  Saving model ...
Epoch: 15 cost time: 0.6894576549530029
Epoch: 15, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.474 Vali Acc: 0.922 Test Loss: 0.474 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.829010009765625
Epoch: 16, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.420 Vali Acc: 0.919 Test Loss: 0.420 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.946974515914917
Epoch: 17, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.377 Vali Acc: 0.907 Test Loss: 0.377 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8098666667938232
Epoch: 18, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8074791431427002
Epoch: 19, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9115207195281982
Epoch: 20, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.8516542911529541
Epoch: 21, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7103626728057861
Epoch: 22, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8157870769500732
Epoch: 23, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9478349685668945
Epoch: 24, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.185 Vali Acc: 0.926 Test Loss: 0.185 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6855685710906982
Epoch: 25, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 26 cost time: 0.8203792572021484
Epoch: 26, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 27 cost time: 0.7560858726501465
Epoch: 27, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8931639194488525
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7950839996337891
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7159767150878906
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7416110038757324
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6850759983062744
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7524676322937012
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.7619538307189941
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7155497074127197
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.6729774475097656
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6445748805999756
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.7422235012054443
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.926 Test Loss: 0.182 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7596759796142578
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5977222919464111
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7150113582611084
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8062899112701416
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9535720348358154
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9136462211608887
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7129452228546143
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8609492778778076
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.714261531829834
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36540678
model size : 154.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4935898780822754
Epoch: 1, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.744 Vali Acc: 0.281 Test Loss: 1.744 Test Acc: 0.281
Validation loss decreased (inf --> -0.281464).  Saving model ...
Epoch: 2 cost time: 0.6113402843475342
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.710 Vali Acc: 0.181 Test Loss: 1.710 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.633798360824585
Epoch: 3, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.680 Vali Acc: 0.241 Test Loss: 1.680 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5681273937225342
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.636 Vali Acc: 0.396 Test Loss: 1.636 Test Acc: 0.396
Validation loss decreased (-0.281464 --> -0.396280).  Saving model ...
Epoch: 5 cost time: 0.6729981899261475
Epoch: 5, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.582 Vali Acc: 0.474 Test Loss: 1.582 Test Acc: 0.474
Validation loss decreased (-0.396280 --> -0.474058).  Saving model ...
Epoch: 6 cost time: 0.6111676692962646
Epoch: 6, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.516 Vali Acc: 0.581 Test Loss: 1.516 Test Acc: 0.581
Validation loss decreased (-0.474058 --> -0.581466).  Saving model ...
Epoch: 7 cost time: 0.7614092826843262
Epoch: 7, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.440 Vali Acc: 0.659 Test Loss: 1.440 Test Acc: 0.659
Validation loss decreased (-0.581466 --> -0.659245).  Saving model ...
Epoch: 8 cost time: 0.6492259502410889
Epoch: 8, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.359 Vali Acc: 0.759 Test Loss: 1.359 Test Acc: 0.759
Validation loss decreased (-0.659245 --> -0.759246).  Saving model ...
Epoch: 9 cost time: 0.7120075225830078
Epoch: 9, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.273 Vali Acc: 0.841 Test Loss: 1.273 Test Acc: 0.841
Validation loss decreased (-0.759246 --> -0.840728).  Saving model ...
Epoch: 10 cost time: 0.73451828956604
Epoch: 10, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.182 Vali Acc: 0.856 Test Loss: 1.182 Test Acc: 0.856
Validation loss decreased (-0.840728 --> -0.855544).  Saving model ...
Epoch: 11 cost time: 0.8016993999481201
Epoch: 11, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.089 Vali Acc: 0.863 Test Loss: 1.089 Test Acc: 0.863
Validation loss decreased (-0.855544 --> -0.862952).  Saving model ...
Epoch: 12 cost time: 0.6612846851348877
Epoch: 12, Steps: 2 | Train Loss: 1.001 Vali Loss: 0.997 Vali Acc: 0.856 Test Loss: 0.997 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7162508964538574
Epoch: 13, Steps: 2 | Train Loss: 0.914 Vali Loss: 0.906 Vali Acc: 0.889 Test Loss: 0.906 Test Acc: 0.889
Validation loss decreased (-0.862952 --> -0.888880).  Saving model ...
Epoch: 14 cost time: 0.691368579864502
Epoch: 14, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.822 Vali Acc: 0.915 Test Loss: 0.822 Test Acc: 0.915
Validation loss decreased (-0.888880 --> -0.914807).  Saving model ...
Epoch: 15 cost time: 0.6235270500183105
Epoch: 15, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.745 Vali Acc: 0.907 Test Loss: 0.745 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7696969509124756
Epoch: 16, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.672 Vali Acc: 0.911 Test Loss: 0.672 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6904482841491699
Epoch: 17, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.603 Vali Acc: 0.911 Test Loss: 0.603 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6750445365905762
Epoch: 18, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.535 Vali Acc: 0.933 Test Loss: 0.535 Test Acc: 0.933
Validation loss decreased (-0.914807 --> -0.933328).  Saving model ...
Epoch: 19 cost time: 0.6827540397644043
Epoch: 19, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.472 Vali Acc: 0.941 Test Loss: 0.472 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 20 cost time: 0.5849771499633789
Epoch: 20, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.418 Vali Acc: 0.937 Test Loss: 0.418 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7391941547393799
Epoch: 21, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.750511646270752
Epoch: 22, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7336452007293701
Epoch: 23, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7947592735290527
Epoch: 24, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7666559219360352
Epoch: 25, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6452236175537109
Epoch: 26, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6337008476257324
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7780790328979492
Epoch: 28, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.855461835861206
Epoch: 29, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36448518
model size : 153.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8059468269348145
Epoch: 1, Steps: 2 | Train Loss: 2.028 Vali Loss: 1.909 Vali Acc: 0.159 Test Loss: 1.909 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.7011861801147461
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.841 Vali Acc: 0.141 Test Loss: 1.841 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6822588443756104
Epoch: 3, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.800 Vali Acc: 0.137 Test Loss: 1.800 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7354676723480225
Epoch: 4, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.763 Vali Acc: 0.156 Test Loss: 1.763 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6397731304168701
Epoch: 5, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.717 Vali Acc: 0.193 Test Loss: 1.717 Test Acc: 0.193
Validation loss decreased (-0.159240 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.8125772476196289
Epoch: 6, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.665 Vali Acc: 0.311 Test Loss: 1.665 Test Acc: 0.311
Validation loss decreased (-0.192575 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 0.7847697734832764
Epoch: 7, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.612 Vali Acc: 0.485 Test Loss: 1.612 Test Acc: 0.485
Validation loss decreased (-0.311094 --> -0.485169).  Saving model ...
Epoch: 8 cost time: 0.8036205768585205
Epoch: 8, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.554 Vali Acc: 0.585 Test Loss: 1.554 Test Acc: 0.585
Validation loss decreased (-0.485169 --> -0.585170).  Saving model ...
Epoch: 9 cost time: 0.7344298362731934
Epoch: 9, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.493 Vali Acc: 0.667 Test Loss: 1.493 Test Acc: 0.667
Validation loss decreased (-0.585170 --> -0.666652).  Saving model ...
Epoch: 10 cost time: 0.6905517578125
Epoch: 10, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.429 Vali Acc: 0.726 Test Loss: 1.429 Test Acc: 0.726
Validation loss decreased (-0.666652 --> -0.725912).  Saving model ...
Epoch: 11 cost time: 0.7035911083221436
Epoch: 11, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.358 Vali Acc: 0.770 Test Loss: 1.358 Test Acc: 0.770
Validation loss decreased (-0.725912 --> -0.770357).  Saving model ...
Epoch: 12 cost time: 0.8763697147369385
Epoch: 12, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.282 Vali Acc: 0.796 Test Loss: 1.282 Test Acc: 0.796
Validation loss decreased (-0.770357 --> -0.796283).  Saving model ...
Epoch: 13 cost time: 0.7666358947753906
Epoch: 13, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.206 Vali Acc: 0.833 Test Loss: 1.206 Test Acc: 0.833
Validation loss decreased (-0.796283 --> -0.833321).  Saving model ...
Epoch: 14 cost time: 0.7499909400939941
Epoch: 14, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.131 Vali Acc: 0.837 Test Loss: 1.131 Test Acc: 0.837
Validation loss decreased (-0.833321 --> -0.837026).  Saving model ...
Epoch: 15 cost time: 0.7599618434906006
Epoch: 15, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.056 Vali Acc: 0.859 Test Loss: 1.056 Test Acc: 0.859
Validation loss decreased (-0.837026 --> -0.859249).  Saving model ...
Epoch: 16 cost time: 0.8170292377471924
Epoch: 16, Steps: 2 | Train Loss: 1.000 Vali Loss: 0.981 Vali Acc: 0.870 Test Loss: 0.981 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870361).  Saving model ...
Epoch: 17 cost time: 0.8620190620422363
Epoch: 17, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.906 Vali Acc: 0.893 Test Loss: 0.906 Test Acc: 0.893
Validation loss decreased (-0.870361 --> -0.892584).  Saving model ...
Epoch: 18 cost time: 0.6841073036193848
Epoch: 18, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.834 Vali Acc: 0.885 Test Loss: 0.834 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8581266403198242
Epoch: 19, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.765 Vali Acc: 0.907 Test Loss: 0.765 Test Acc: 0.907
Validation loss decreased (-0.892584 --> -0.907400).  Saving model ...
Epoch: 20 cost time: 0.9275782108306885
Epoch: 20, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.697 Vali Acc: 0.907 Test Loss: 0.697 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 21 cost time: 0.7756943702697754
Epoch: 21, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.628 Vali Acc: 0.919 Test Loss: 0.628 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 22 cost time: 0.8590047359466553
Epoch: 22, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.561 Vali Acc: 0.911 Test Loss: 0.561 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6961045265197754
Epoch: 23, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.75040602684021
Epoch: 24, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.433 Vali Acc: 0.919 Test Loss: 0.433 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918514).  Saving model ...
Epoch: 25 cost time: 0.9270937442779541
Epoch: 25, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 26 cost time: 0.748786449432373
Epoch: 26, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.922218 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.8715896606445312
Epoch: 27, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.7530200481414795
Epoch: 28, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7683916091918945
Epoch: 29, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0185253620147705
Epoch: 30, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8641743659973145
Epoch: 31, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.207 Vali Acc: 0.919 Test Loss: 0.207 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8186357021331787
Epoch: 32, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8021786212921143
Epoch: 33, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0225694179534912
Epoch: 34, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.184 Vali Acc: 0.922 Test Loss: 0.184 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7789261341094971
Epoch: 35, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.181 Vali Acc: 0.919 Test Loss: 0.181 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6205394268035889
Epoch: 36, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.176 Vali Acc: 0.922 Test Loss: 0.176 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6876764297485352
Epoch: 37, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.933 Test Loss: 0.169 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36411654
model size : 153.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9884848594665527
Epoch: 1, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.927 Vali Acc: 0.100 Test Loss: 1.927 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 0.6336557865142822
Epoch: 2, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.846 Vali Acc: 0.159 Test Loss: 1.846 Test Acc: 0.159
Validation loss decreased (-0.099981 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.8014073371887207
Epoch: 3, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.781 Vali Acc: 0.163 Test Loss: 1.781 Test Acc: 0.163
Validation loss decreased (-0.159241 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.7496609687805176
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.690 Vali Acc: 0.296 Test Loss: 1.690 Test Acc: 0.296
Validation loss decreased (-0.162945 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.6953277587890625
Epoch: 5, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.577 Vali Acc: 0.504 Test Loss: 1.577 Test Acc: 0.504
Validation loss decreased (-0.296279 --> -0.503688).  Saving model ...
Epoch: 6 cost time: 0.8667774200439453
Epoch: 6, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.445 Vali Acc: 0.659 Test Loss: 1.445 Test Acc: 0.659
Validation loss decreased (-0.503688 --> -0.659245).  Saving model ...
Epoch: 7 cost time: 0.6232764720916748
Epoch: 7, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.307 Vali Acc: 0.711 Test Loss: 1.307 Test Acc: 0.711
Validation loss decreased (-0.659245 --> -0.711098).  Saving model ...
Epoch: 8 cost time: 0.9871563911437988
Epoch: 8, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.175 Vali Acc: 0.781 Test Loss: 1.175 Test Acc: 0.781
Validation loss decreased (-0.711098 --> -0.781470).  Saving model ...
Epoch: 9 cost time: 0.8192753791809082
Epoch: 9, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.041 Vali Acc: 0.815 Test Loss: 1.041 Test Acc: 0.815
Validation loss decreased (-0.781470 --> -0.814804).  Saving model ...
Epoch: 10 cost time: 0.6060371398925781
Epoch: 10, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.917 Vali Acc: 0.852 Test Loss: 0.917 Test Acc: 0.852
Validation loss decreased (-0.814804 --> -0.851843).  Saving model ...
Epoch: 11 cost time: 0.6213679313659668
Epoch: 11, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.801 Vali Acc: 0.881 Test Loss: 0.801 Test Acc: 0.881
Validation loss decreased (-0.851843 --> -0.881473).  Saving model ...
Epoch: 12 cost time: 0.7968034744262695
Epoch: 12, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.699 Vali Acc: 0.896 Test Loss: 0.699 Test Acc: 0.896
Validation loss decreased (-0.881473 --> -0.896289).  Saving model ...
Epoch: 13 cost time: 0.7491912841796875
Epoch: 13, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.604 Vali Acc: 0.911 Test Loss: 0.604 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911105).  Saving model ...
Epoch: 14 cost time: 0.6904432773590088
Epoch: 14, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.522 Vali Acc: 0.919 Test Loss: 0.522 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 15 cost time: 0.8879227638244629
Epoch: 15, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 16 cost time: 0.7553529739379883
Epoch: 16, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.386 Vali Acc: 0.919 Test Loss: 0.386 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9514126777648926
Epoch: 17, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8237645626068115
Epoch: 18, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7719652652740479
Epoch: 19, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8894376754760742
Epoch: 20, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9503519535064697
Epoch: 21, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7694895267486572
Epoch: 22, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.9684884548187256
Epoch: 23, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.915 Test Loss: 0.230 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8765323162078857
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7900588512420654
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8634614944458008
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0824668407440186
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8531947135925293
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.804771900177002
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8049745559692383
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7757396697998047
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.280 Vali Acc: 0.907 Test Loss: 0.280 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9647181034088135
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.293 Vali Acc: 0.896 Test Loss: 0.293 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 36543750
model size : 154.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.916229248046875
Epoch: 1, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.854 Vali Acc: 0.156 Test Loss: 1.854 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.7238578796386719
Epoch: 2, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.800 Vali Acc: 0.244 Test Loss: 1.800 Test Acc: 0.244
Validation loss decreased (-0.155537 --> -0.244426).  Saving model ...
Epoch: 3 cost time: 0.7169721126556396
Epoch: 3, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.764 Vali Acc: 0.285 Test Loss: 1.764 Test Acc: 0.285
Validation loss decreased (-0.244426 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.7570614814758301
Epoch: 4, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.713 Vali Acc: 0.385 Test Loss: 1.713 Test Acc: 0.385
Validation loss decreased (-0.285168 --> -0.385168).  Saving model ...
Epoch: 5 cost time: 0.6628575325012207
Epoch: 5, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.649 Vali Acc: 0.515 Test Loss: 1.649 Test Acc: 0.515
Validation loss decreased (-0.385168 --> -0.514798).  Saving model ...
Epoch: 6 cost time: 0.7175297737121582
Epoch: 6, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.577 Vali Acc: 0.611 Test Loss: 1.577 Test Acc: 0.611
Validation loss decreased (-0.514798 --> -0.611095).  Saving model ...
Epoch: 7 cost time: 0.8065640926361084
Epoch: 7, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.493 Vali Acc: 0.711 Test Loss: 1.493 Test Acc: 0.711
Validation loss decreased (-0.611095 --> -0.711096).  Saving model ...
Epoch: 8 cost time: 0.7260723114013672
Epoch: 8, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.404 Vali Acc: 0.741 Test Loss: 1.404 Test Acc: 0.741
Validation loss decreased (-0.711096 --> -0.740727).  Saving model ...
Epoch: 9 cost time: 0.6152260303497314
Epoch: 9, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.310 Vali Acc: 0.781 Test Loss: 1.310 Test Acc: 0.781
Validation loss decreased (-0.740727 --> -0.781468).  Saving model ...
Epoch: 10 cost time: 0.7174532413482666
Epoch: 10, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.213 Vali Acc: 0.852 Test Loss: 1.213 Test Acc: 0.852
Validation loss decreased (-0.781468 --> -0.851840).  Saving model ...
Epoch: 11 cost time: 0.7480828762054443
Epoch: 11, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.118 Vali Acc: 0.893 Test Loss: 1.118 Test Acc: 0.893
Validation loss decreased (-0.851840 --> -0.892581).  Saving model ...
Epoch: 12 cost time: 0.7870333194732666
Epoch: 12, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.028 Vali Acc: 0.904 Test Loss: 1.028 Test Acc: 0.904
Validation loss decreased (-0.892581 --> -0.903693).  Saving model ...
Epoch: 13 cost time: 0.7231676578521729
Epoch: 13, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.937 Vali Acc: 0.911 Test Loss: 0.937 Test Acc: 0.911
Validation loss decreased (-0.903693 --> -0.911102).  Saving model ...
Epoch: 14 cost time: 0.6320223808288574
Epoch: 14, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.846 Vali Acc: 0.919 Test Loss: 0.846 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918510).  Saving model ...
Epoch: 15 cost time: 0.7754344940185547
Epoch: 15, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.753 Vali Acc: 0.919 Test Loss: 0.753 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918511).  Saving model ...
Epoch: 16 cost time: 0.7411091327667236
Epoch: 16, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.669 Vali Acc: 0.922 Test Loss: 0.669 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 17 cost time: 0.7157018184661865
Epoch: 17, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.591 Vali Acc: 0.919 Test Loss: 0.591 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6718108654022217
Epoch: 18, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.517 Vali Acc: 0.922 Test Loss: 0.517 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 19 cost time: 0.6640963554382324
Epoch: 19, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.661715030670166
Epoch: 20, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.405 Vali Acc: 0.922 Test Loss: 0.405 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.7604269981384277
Epoch: 21, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.362 Vali Acc: 0.907 Test Loss: 0.362 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.84248948097229
Epoch: 22, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.321 Vali Acc: 0.915 Test Loss: 0.321 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7222375869750977
Epoch: 23, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
Validation loss decreased (-0.922218 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 0.787419319152832
Epoch: 24, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6726622581481934
Epoch: 25, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7570228576660156
Epoch: 26, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6923484802246094
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7183482646942139
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.241 Vali Acc: 0.907 Test Loss: 0.241 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7608129978179932
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.236 Vali Acc: 0.904 Test Loss: 0.236 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7934267520904541
Epoch: 30, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.239 Vali Acc: 0.904 Test Loss: 0.239 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8251869678497314
Epoch: 31, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.904 Test Loss: 0.240 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8039069175720215
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.907 Test Loss: 0.236 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8340187072753906
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.907 Test Loss: 0.234 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 36457734
model size : 153.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.50553822517395
Epoch: 1, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.890 Vali Acc: 0.174 Test Loss: 1.890 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.6227149963378906
Epoch: 2, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.817 Vali Acc: 0.174 Test Loss: 1.817 Test Acc: 0.174
Validation loss decreased (-0.174055 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.6066122055053711
Epoch: 3, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.774 Vali Acc: 0.159 Test Loss: 1.774 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5493342876434326
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.735 Vali Acc: 0.200 Test Loss: 1.735 Test Acc: 0.200
Validation loss decreased (-0.174056 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 0.7533280849456787
Epoch: 5, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.690 Vali Acc: 0.307 Test Loss: 1.690 Test Acc: 0.307
Validation loss decreased (-0.199983 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 0.4991443157196045
Epoch: 6, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.641 Vali Acc: 0.522 Test Loss: 1.641 Test Acc: 0.522
Validation loss decreased (-0.307391 --> -0.522206).  Saving model ...
Epoch: 7 cost time: 0.5567445755004883
Epoch: 7, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.591 Vali Acc: 0.563 Test Loss: 1.591 Test Acc: 0.563
Validation loss decreased (-0.522206 --> -0.562947).  Saving model ...
Epoch: 8 cost time: 0.6694605350494385
Epoch: 8, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.536 Vali Acc: 0.619 Test Loss: 1.536 Test Acc: 0.619
Validation loss decreased (-0.562947 --> -0.618503).  Saving model ...
Epoch: 9 cost time: 0.633134126663208
Epoch: 9, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.480 Vali Acc: 0.652 Test Loss: 1.480 Test Acc: 0.652
Validation loss decreased (-0.618503 --> -0.651837).  Saving model ...
Epoch: 10 cost time: 0.6755790710449219
Epoch: 10, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.419 Vali Acc: 0.711 Test Loss: 1.419 Test Acc: 0.711
Validation loss decreased (-0.651837 --> -0.711097).  Saving model ...
Epoch: 11 cost time: 0.6470761299133301
Epoch: 11, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.353 Vali Acc: 0.744 Test Loss: 1.353 Test Acc: 0.744
Validation loss decreased (-0.711097 --> -0.744431).  Saving model ...
Epoch: 12 cost time: 0.5835137367248535
Epoch: 12, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.285 Vali Acc: 0.778 Test Loss: 1.285 Test Acc: 0.778
Validation loss decreased (-0.744431 --> -0.777765).  Saving model ...
Epoch: 13 cost time: 0.7249085903167725
Epoch: 13, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.212 Vali Acc: 0.830 Test Loss: 1.212 Test Acc: 0.830
Validation loss decreased (-0.777765 --> -0.829618).  Saving model ...
Epoch: 14 cost time: 0.7314350605010986
Epoch: 14, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.134 Vali Acc: 0.870 Test Loss: 1.134 Test Acc: 0.870
Validation loss decreased (-0.829618 --> -0.870359).  Saving model ...
Epoch: 15 cost time: 0.4877750873565674
Epoch: 15, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.053 Vali Acc: 0.900 Test Loss: 1.053 Test Acc: 0.900
Validation loss decreased (-0.870359 --> -0.899989).  Saving model ...
Epoch: 16 cost time: 0.6556713581085205
Epoch: 16, Steps: 2 | Train Loss: 0.974 Vali Loss: 0.972 Vali Acc: 0.907 Test Loss: 0.972 Test Acc: 0.907
Validation loss decreased (-0.899989 --> -0.907398).  Saving model ...
Epoch: 17 cost time: 0.6890163421630859
Epoch: 17, Steps: 2 | Train Loss: 0.914 Vali Loss: 0.890 Vali Acc: 0.911 Test Loss: 0.890 Test Acc: 0.911
Validation loss decreased (-0.907398 --> -0.911102).  Saving model ...
Epoch: 18 cost time: 0.4933352470397949
Epoch: 18, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.809 Vali Acc: 0.915 Test Loss: 0.809 Test Acc: 0.915
Validation loss decreased (-0.911102 --> -0.914807).  Saving model ...
Epoch: 19 cost time: 0.6702778339385986
Epoch: 19, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.734 Vali Acc: 0.930 Test Loss: 0.734 Test Acc: 0.930
Validation loss decreased (-0.914807 --> -0.929622).  Saving model ...
Epoch: 20 cost time: 0.6576700210571289
Epoch: 20, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.664 Vali Acc: 0.937 Test Loss: 0.664 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937030).  Saving model ...
Epoch: 21 cost time: 0.6096723079681396
Epoch: 21, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.593 Vali Acc: 0.933 Test Loss: 0.593 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5783653259277344
Epoch: 22, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.524 Vali Acc: 0.941 Test Loss: 0.524 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940736).  Saving model ...
Epoch: 23 cost time: 0.7276091575622559
Epoch: 23, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.458 Vali Acc: 0.941 Test Loss: 0.458 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 24 cost time: 0.678065299987793
Epoch: 24, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.399 Vali Acc: 0.944 Test Loss: 0.399 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 25 cost time: 0.6397714614868164
Epoch: 25, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.350 Vali Acc: 0.944 Test Loss: 0.350 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 0.6015589237213135
Epoch: 26, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 0.6121702194213867
Epoch: 27, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.5149359703063965
Epoch: 28, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.5864980220794678
Epoch: 29, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.584881067276001
Epoch: 30, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6587381362915039
Epoch: 31, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5617015361785889
Epoch: 32, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6531414985656738
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7041513919830322
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5866599082946777
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.67868971824646
Epoch: 36, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6392335891723633
Epoch: 37, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5770344734191895
Epoch: 38, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 36414726
model size : 153.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6160640716552734
Epoch: 1, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.763 Vali Acc: 0.222 Test Loss: 1.763 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.7447009086608887
Epoch: 2, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.723 Vali Acc: 0.244 Test Loss: 1.723 Test Acc: 0.244
Validation loss decreased (-0.222205 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 0.752110481262207
Epoch: 3, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.692 Vali Acc: 0.326 Test Loss: 1.692 Test Acc: 0.326
Validation loss decreased (-0.244427 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.689385175704956
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.634 Vali Acc: 0.522 Test Loss: 1.634 Test Acc: 0.522
Validation loss decreased (-0.325909 --> -0.522206).  Saving model ...
Epoch: 5 cost time: 0.8609163761138916
Epoch: 5, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.560 Vali Acc: 0.659 Test Loss: 1.560 Test Acc: 0.659
Validation loss decreased (-0.522206 --> -0.659244).  Saving model ...
Epoch: 6 cost time: 0.9004700183868408
Epoch: 6, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.472 Vali Acc: 0.737 Test Loss: 1.472 Test Acc: 0.737
Validation loss decreased (-0.659244 --> -0.737022).  Saving model ...
Epoch: 7 cost time: 1.0924861431121826
Epoch: 7, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.378 Vali Acc: 0.796 Test Loss: 1.378 Test Acc: 0.796
Validation loss decreased (-0.737022 --> -0.796283).  Saving model ...
Epoch: 8 cost time: 0.9105424880981445
Epoch: 8, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.278 Vali Acc: 0.830 Test Loss: 1.278 Test Acc: 0.830
Validation loss decreased (-0.796283 --> -0.829617).  Saving model ...
Epoch: 9 cost time: 1.1516470909118652
Epoch: 9, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.176 Vali Acc: 0.852 Test Loss: 1.176 Test Acc: 0.852
Validation loss decreased (-0.829617 --> -0.851840).  Saving model ...
Epoch: 10 cost time: 0.8009769916534424
Epoch: 10, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.072 Vali Acc: 0.867 Test Loss: 1.072 Test Acc: 0.867
Validation loss decreased (-0.851840 --> -0.866656).  Saving model ...
Epoch: 11 cost time: 0.8466196060180664
Epoch: 11, Steps: 2 | Train Loss: 0.978 Vali Loss: 0.971 Vali Acc: 0.881 Test Loss: 0.971 Test Acc: 0.881
Validation loss decreased (-0.866656 --> -0.881472).  Saving model ...
Epoch: 12 cost time: 0.9931740760803223
Epoch: 12, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.870 Vali Acc: 0.900 Test Loss: 0.870 Test Acc: 0.900
Validation loss decreased (-0.881472 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.9376926422119141
Epoch: 13, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.773 Vali Acc: 0.893 Test Loss: 0.773 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9534084796905518
Epoch: 14, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.686 Vali Acc: 0.893 Test Loss: 0.686 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.856029748916626
Epoch: 15, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.607 Vali Acc: 0.900 Test Loss: 0.607 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.8110997676849365
Epoch: 16, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.536 Vali Acc: 0.896 Test Loss: 0.536 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8796947002410889
Epoch: 17, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.470 Vali Acc: 0.896 Test Loss: 0.470 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0713486671447754
Epoch: 18, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.408 Vali Acc: 0.915 Test Loss: 0.408 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.8424367904663086
Epoch: 19, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9218506813049316
Epoch: 20, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0768983364105225
Epoch: 21, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 0.946624755859375
Epoch: 22, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.260 Vali Acc: 0.919 Test Loss: 0.260 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 23 cost time: 1.189488172531128
Epoch: 23, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 1.0456249713897705
Epoch: 24, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9510238170623779
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0001473426818848
Epoch: 26, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.214 Vali Acc: 0.919 Test Loss: 0.214 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9073460102081299
Epoch: 27, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.908029317855835
Epoch: 28, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.9235138893127441
Epoch: 29, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.009005069732666
Epoch: 30, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.258880853652954
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0437874794006348
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8984417915344238
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.9790136814117432
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0071978569030762
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7938821315765381
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9186975955963135
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8033895492553711
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8573942184448242
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0125706195831299
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8571856021881104
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8370425701141357
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8368320465087891
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 36491526
model size : 153.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3693151473999023
Epoch: 1, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.772 Vali Acc: 0.181 Test Loss: 1.772 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.7714385986328125
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.725 Vali Acc: 0.270 Test Loss: 1.725 Test Acc: 0.270
Validation loss decreased (-0.181464 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.696131706237793
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.697 Vali Acc: 0.415 Test Loss: 1.697 Test Acc: 0.415
Validation loss decreased (-0.270353 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.7818353176116943
Epoch: 4, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.658 Vali Acc: 0.493 Test Loss: 1.658 Test Acc: 0.493
Validation loss decreased (-0.414798 --> -0.492576).  Saving model ...
Epoch: 5 cost time: 0.947058916091919
Epoch: 5, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.610 Vali Acc: 0.563 Test Loss: 1.610 Test Acc: 0.563
Validation loss decreased (-0.492576 --> -0.562947).  Saving model ...
Epoch: 6 cost time: 0.6199135780334473
Epoch: 6, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.553 Vali Acc: 0.648 Test Loss: 1.553 Test Acc: 0.648
Validation loss decreased (-0.562947 --> -0.648133).  Saving model ...
Epoch: 7 cost time: 0.7239046096801758
Epoch: 7, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.489 Vali Acc: 0.733 Test Loss: 1.489 Test Acc: 0.733
Validation loss decreased (-0.648133 --> -0.733318).  Saving model ...
Epoch: 8 cost time: 0.9359540939331055
Epoch: 8, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.418 Vali Acc: 0.767 Test Loss: 1.418 Test Acc: 0.767
Validation loss decreased (-0.733318 --> -0.766652).  Saving model ...
Epoch: 9 cost time: 0.885962963104248
Epoch: 9, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.341 Vali Acc: 0.830 Test Loss: 1.341 Test Acc: 0.830
Validation loss decreased (-0.766652 --> -0.829616).  Saving model ...
Epoch: 10 cost time: 0.7794575691223145
Epoch: 10, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.259 Vali Acc: 0.859 Test Loss: 1.259 Test Acc: 0.859
Validation loss decreased (-0.829616 --> -0.859247).  Saving model ...
Epoch: 11 cost time: 0.6755826473236084
Epoch: 11, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.179 Vali Acc: 0.885 Test Loss: 1.179 Test Acc: 0.885
Validation loss decreased (-0.859247 --> -0.885173).  Saving model ...
Epoch: 12 cost time: 0.7741482257843018
Epoch: 12, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.097 Vali Acc: 0.904 Test Loss: 1.097 Test Acc: 0.904
Validation loss decreased (-0.885173 --> -0.903693).  Saving model ...
Epoch: 13 cost time: 0.9590907096862793
Epoch: 13, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.016 Vali Acc: 0.907 Test Loss: 1.016 Test Acc: 0.907
Validation loss decreased (-0.903693 --> -0.907397).  Saving model ...
Epoch: 14 cost time: 0.8470830917358398
Epoch: 14, Steps: 2 | Train Loss: 0.914 Vali Loss: 0.935 Vali Acc: 0.930 Test Loss: 0.935 Test Acc: 0.930
Validation loss decreased (-0.907397 --> -0.929620).  Saving model ...
Epoch: 15 cost time: 0.7422115802764893
Epoch: 15, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.856 Vali Acc: 0.933 Test Loss: 0.856 Test Acc: 0.933
Validation loss decreased (-0.929620 --> -0.933325).  Saving model ...
Epoch: 16 cost time: 0.9197404384613037
Epoch: 16, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.777 Vali Acc: 0.933 Test Loss: 0.777 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933326).  Saving model ...
Epoch: 17 cost time: 0.716871976852417
Epoch: 17, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.697 Vali Acc: 0.948 Test Loss: 0.697 Test Acc: 0.948
Validation loss decreased (-0.933326 --> -0.948141).  Saving model ...
Epoch: 18 cost time: 0.8104343414306641
Epoch: 18, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.623 Vali Acc: 0.944 Test Loss: 0.623 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8949322700500488
Epoch: 19, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.554 Vali Acc: 0.933 Test Loss: 0.554 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7702581882476807
Epoch: 20, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.488 Vali Acc: 0.930 Test Loss: 0.488 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7060716152191162
Epoch: 21, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.428 Vali Acc: 0.937 Test Loss: 0.428 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9389660358428955
Epoch: 22, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.375 Vali Acc: 0.941 Test Loss: 0.375 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6825675964355469
Epoch: 23, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7282533645629883
Epoch: 24, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8320474624633789
Epoch: 25, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
Validation loss decreased (-0.948141 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.8282554149627686
Epoch: 26, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7713751792907715
Epoch: 27, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8314816951751709
Epoch: 28, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8836770057678223
Epoch: 29, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7604160308837891
Epoch: 30, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7595517635345459
Epoch: 31, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.166 Vali Acc: 0.937 Test Loss: 0.166 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7254681587219238
Epoch: 32, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8821277618408203
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8644015789031982
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7291746139526367
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 36448518
model size : 153.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2220618724823
Epoch: 1, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.873 Vali Acc: 0.248 Test Loss: 1.873 Test Acc: 0.248
Validation loss decreased (inf --> -0.248129).  Saving model ...
Epoch: 2 cost time: 0.5914671421051025
Epoch: 2, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.829 Vali Acc: 0.207 Test Loss: 1.829 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7869794368743896
Epoch: 3, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.802 Vali Acc: 0.230 Test Loss: 1.802 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8620941638946533
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.772 Vali Acc: 0.259 Test Loss: 1.772 Test Acc: 0.259
Validation loss decreased (-0.248129 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.6746914386749268
Epoch: 5, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.736 Vali Acc: 0.289 Test Loss: 1.736 Test Acc: 0.289
Validation loss decreased (-0.259242 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.7915856838226318
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.692 Vali Acc: 0.359 Test Loss: 1.692 Test Acc: 0.359
Validation loss decreased (-0.288872 --> -0.359242).  Saving model ...
Epoch: 7 cost time: 0.7042632102966309
Epoch: 7, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.643 Vali Acc: 0.489 Test Loss: 1.643 Test Acc: 0.489
Validation loss decreased (-0.359242 --> -0.488872).  Saving model ...
Epoch: 8 cost time: 0.7530519962310791
Epoch: 8, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.590 Vali Acc: 0.541 Test Loss: 1.590 Test Acc: 0.541
Validation loss decreased (-0.488872 --> -0.540725).  Saving model ...
Epoch: 9 cost time: 0.7274131774902344
Epoch: 9, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.535 Vali Acc: 0.604 Test Loss: 1.535 Test Acc: 0.604
Validation loss decreased (-0.540725 --> -0.603688).  Saving model ...
Epoch: 10 cost time: 0.6604986190795898
Epoch: 10, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.475 Vali Acc: 0.693 Test Loss: 1.475 Test Acc: 0.693
Validation loss decreased (-0.603688 --> -0.692578).  Saving model ...
Epoch: 11 cost time: 0.6912469863891602
Epoch: 11, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.411 Vali Acc: 0.752 Test Loss: 1.411 Test Acc: 0.752
Validation loss decreased (-0.692578 --> -0.751838).  Saving model ...
Epoch: 12 cost time: 0.7335567474365234
Epoch: 12, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.345 Vali Acc: 0.804 Test Loss: 1.345 Test Acc: 0.804
Validation loss decreased (-0.751838 --> -0.803690).  Saving model ...
Epoch: 13 cost time: 0.5563929080963135
Epoch: 13, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.275 Vali Acc: 0.815 Test Loss: 1.275 Test Acc: 0.815
Validation loss decreased (-0.803690 --> -0.814802).  Saving model ...
Epoch: 14 cost time: 0.5822770595550537
Epoch: 14, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.205 Vali Acc: 0.841 Test Loss: 1.205 Test Acc: 0.841
Validation loss decreased (-0.814802 --> -0.840729).  Saving model ...
Epoch: 15 cost time: 0.7639896869659424
Epoch: 15, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.133 Vali Acc: 0.844 Test Loss: 1.133 Test Acc: 0.844
Validation loss decreased (-0.840729 --> -0.844433).  Saving model ...
Epoch: 16 cost time: 0.6793498992919922
Epoch: 16, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.060 Vali Acc: 0.863 Test Loss: 1.060 Test Acc: 0.863
Validation loss decreased (-0.844433 --> -0.862952).  Saving model ...
Epoch: 17 cost time: 0.7809176445007324
Epoch: 17, Steps: 2 | Train Loss: 0.999 Vali Loss: 0.986 Vali Acc: 0.881 Test Loss: 0.986 Test Acc: 0.881
Validation loss decreased (-0.862952 --> -0.881472).  Saving model ...
Epoch: 18 cost time: 0.688920259475708
Epoch: 18, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.905 Vali Acc: 0.907 Test Loss: 0.905 Test Acc: 0.907
Validation loss decreased (-0.881472 --> -0.907398).  Saving model ...
Epoch: 19 cost time: 0.7064838409423828
Epoch: 19, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.824 Vali Acc: 0.922 Test Loss: 0.824 Test Acc: 0.922
Validation loss decreased (-0.907398 --> -0.922214).  Saving model ...
Epoch: 20 cost time: 0.8046228885650635
Epoch: 20, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.742 Vali Acc: 0.937 Test Loss: 0.742 Test Acc: 0.937
Validation loss decreased (-0.922214 --> -0.937030).  Saving model ...
Epoch: 21 cost time: 0.6766486167907715
Epoch: 21, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.665 Vali Acc: 0.930 Test Loss: 0.665 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7544362545013428
Epoch: 22, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.591 Vali Acc: 0.930 Test Loss: 0.591 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7576022148132324
Epoch: 23, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.521 Vali Acc: 0.930 Test Loss: 0.521 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7659051418304443
Epoch: 24, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.458 Vali Acc: 0.930 Test Loss: 0.458 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6729097366333008
Epoch: 25, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.404 Vali Acc: 0.937 Test Loss: 0.404 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.8192059993743896
Epoch: 26, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 27 cost time: 0.720266580581665
Epoch: 27, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6639797687530518
Epoch: 28, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8567600250244141
Epoch: 29, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.271 Vali Acc: 0.919 Test Loss: 0.271 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.596142053604126
Epoch: 30, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5458176136016846
Epoch: 31, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.804375171661377
Epoch: 32, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7363011837005615
Epoch: 33, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6273932456970215
Epoch: 34, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6229159832000732
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9057469367980957
Epoch: 36, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36417798
model size : 153.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9353654384613037
Epoch: 1, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.878 Vali Acc: 0.063 Test Loss: 1.878 Test Acc: 0.063
Validation loss decreased (inf --> -0.062944).  Saving model ...
Epoch: 2 cost time: 0.806934118270874
Epoch: 2, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.824 Vali Acc: 0.230 Test Loss: 1.824 Test Acc: 0.230
Validation loss decreased (-0.062944 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.7531769275665283
Epoch: 3, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.776 Vali Acc: 0.333 Test Loss: 1.776 Test Acc: 0.333
Validation loss decreased (-0.229611 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.8048603534698486
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.711 Vali Acc: 0.396 Test Loss: 1.711 Test Acc: 0.396
Validation loss decreased (-0.333316 --> -0.396279).  Saving model ...
Epoch: 5 cost time: 0.780616044998169
Epoch: 5, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.630 Vali Acc: 0.474 Test Loss: 1.630 Test Acc: 0.474
Validation loss decreased (-0.396279 --> -0.474058).  Saving model ...
Epoch: 6 cost time: 0.839379072189331
Epoch: 6, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.538 Vali Acc: 0.544 Test Loss: 1.538 Test Acc: 0.544
Validation loss decreased (-0.474058 --> -0.544429).  Saving model ...
Epoch: 7 cost time: 0.852891206741333
Epoch: 7, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.434 Vali Acc: 0.641 Test Loss: 1.434 Test Acc: 0.641
Validation loss decreased (-0.544429 --> -0.640726).  Saving model ...
Epoch: 8 cost time: 0.7515370845794678
Epoch: 8, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.324 Vali Acc: 0.707 Test Loss: 1.324 Test Acc: 0.707
Validation loss decreased (-0.640726 --> -0.707394).  Saving model ...
Epoch: 9 cost time: 0.7935266494750977
Epoch: 9, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.211 Vali Acc: 0.763 Test Loss: 1.211 Test Acc: 0.763
Validation loss decreased (-0.707394 --> -0.762951).  Saving model ...
Epoch: 10 cost time: 0.838554859161377
Epoch: 10, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.097 Vali Acc: 0.830 Test Loss: 1.097 Test Acc: 0.830
Validation loss decreased (-0.762951 --> -0.829619).  Saving model ...
Epoch: 11 cost time: 1.1367521286010742
Epoch: 11, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.986 Vali Acc: 0.837 Test Loss: 0.986 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837027).  Saving model ...
Epoch: 12 cost time: 0.8331906795501709
Epoch: 12, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.883 Vali Acc: 0.848 Test Loss: 0.883 Test Acc: 0.848
Validation loss decreased (-0.837027 --> -0.848139).  Saving model ...
Epoch: 13 cost time: 0.8595707416534424
Epoch: 13, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.786 Vali Acc: 0.856 Test Loss: 0.786 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855548).  Saving model ...
Epoch: 14 cost time: 0.9028630256652832
Epoch: 14, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.697 Vali Acc: 0.874 Test Loss: 0.697 Test Acc: 0.874
Validation loss decreased (-0.855548 --> -0.874067).  Saving model ...
Epoch: 15 cost time: 0.995413064956665
Epoch: 15, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.617 Vali Acc: 0.900 Test Loss: 0.617 Test Acc: 0.900
Validation loss decreased (-0.874067 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 1.24247145652771
Epoch: 16, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.546 Vali Acc: 0.904 Test Loss: 0.546 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 17 cost time: 0.9089639186859131
Epoch: 17, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.484 Vali Acc: 0.904 Test Loss: 0.484 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 0.8221297264099121
Epoch: 18, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.432 Vali Acc: 0.896 Test Loss: 0.432 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9790754318237305
Epoch: 19, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.375 Vali Acc: 0.911 Test Loss: 0.375 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 1.1033987998962402
Epoch: 20, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.8631525039672852
Epoch: 21, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 1.168607234954834
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 0.9414598941802979
Epoch: 23, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 0.8932697772979736
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 25 cost time: 0.8083391189575195
Epoch: 25, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.9400129318237305
Epoch: 26, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 1.0526790618896484
Epoch: 27, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8973972797393799
Epoch: 28, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0283305644989014
Epoch: 29, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0619614124298096
Epoch: 30, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.915 Test Loss: 0.221 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9338033199310303
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.919 Test Loss: 0.215 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9908177852630615
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8499071598052979
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 34 cost time: 1.0341269969940186
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1036508083343506
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.883103609085083
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1111981868743896
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9767866134643555
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.220 Vali Acc: 0.919 Test Loss: 0.220 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8591656684875488
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1907010078430176
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.230 Vali Acc: 0.907 Test Loss: 0.230 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9338459968566895
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.907 Test Loss: 0.235 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8889050483703613
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8183414936065674
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.915 Test Loss: 0.238 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 36500742
model size : 153.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.100276231765747
Epoch: 1, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.809 Vali Acc: 0.200 Test Loss: 1.809 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.6579620838165283
Epoch: 2, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.768 Vali Acc: 0.263 Test Loss: 1.768 Test Acc: 0.263
Validation loss decreased (-0.199982 --> -0.262945).  Saving model ...
Epoch: 3 cost time: 0.5976243019104004
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.735 Vali Acc: 0.319 Test Loss: 1.735 Test Acc: 0.319
Validation loss decreased (-0.262945 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.8815016746520996
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.692 Vali Acc: 0.378 Test Loss: 1.692 Test Acc: 0.378
Validation loss decreased (-0.318501 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 0.7082178592681885
Epoch: 5, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.638 Vali Acc: 0.404 Test Loss: 1.638 Test Acc: 0.404
Validation loss decreased (-0.377761 --> -0.403687).  Saving model ...
Epoch: 6 cost time: 0.4915151596069336
Epoch: 6, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.578 Vali Acc: 0.448 Test Loss: 1.578 Test Acc: 0.448
Validation loss decreased (-0.403687 --> -0.448132).  Saving model ...
Epoch: 7 cost time: 0.545861005783081
Epoch: 7, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.514 Vali Acc: 0.493 Test Loss: 1.514 Test Acc: 0.493
Validation loss decreased (-0.448132 --> -0.492577).  Saving model ...
Epoch: 8 cost time: 0.7067317962646484
Epoch: 8, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.444 Vali Acc: 0.530 Test Loss: 1.444 Test Acc: 0.530
Validation loss decreased (-0.492577 --> -0.529615).  Saving model ...
Epoch: 9 cost time: 0.5193116664886475
Epoch: 9, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.368 Vali Acc: 0.596 Test Loss: 1.368 Test Acc: 0.596
Validation loss decreased (-0.529615 --> -0.596283).  Saving model ...
Epoch: 10 cost time: 0.621652364730835
Epoch: 10, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.285 Vali Acc: 0.678 Test Loss: 1.285 Test Acc: 0.678
Validation loss decreased (-0.596283 --> -0.677765).  Saving model ...
Epoch: 11 cost time: 0.7422876358032227
Epoch: 11, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.198 Vali Acc: 0.748 Test Loss: 1.198 Test Acc: 0.748
Validation loss decreased (-0.677765 --> -0.748136).  Saving model ...
Epoch: 12 cost time: 0.6761269569396973
Epoch: 12, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.110 Vali Acc: 0.785 Test Loss: 1.110 Test Acc: 0.785
Validation loss decreased (-0.748136 --> -0.785174).  Saving model ...
Epoch: 13 cost time: 0.660059928894043
Epoch: 13, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.022 Vali Acc: 0.811 Test Loss: 1.022 Test Acc: 0.811
Validation loss decreased (-0.785174 --> -0.811101).  Saving model ...
Epoch: 14 cost time: 0.6703798770904541
Epoch: 14, Steps: 2 | Train Loss: 0.918 Vali Loss: 0.934 Vali Acc: 0.856 Test Loss: 0.934 Test Acc: 0.856
Validation loss decreased (-0.811101 --> -0.855546).  Saving model ...
Epoch: 15 cost time: 0.6726558208465576
Epoch: 15, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.846 Vali Acc: 0.881 Test Loss: 0.846 Test Acc: 0.881
Validation loss decreased (-0.855546 --> -0.881473).  Saving model ...
Epoch: 16 cost time: 0.7176249027252197
Epoch: 16, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.761 Vali Acc: 0.900 Test Loss: 0.761 Test Acc: 0.900
Validation loss decreased (-0.881473 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.7390899658203125
Epoch: 17, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.679 Vali Acc: 0.907 Test Loss: 0.679 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907401).  Saving model ...
Epoch: 18 cost time: 0.6344475746154785
Epoch: 18, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.601 Vali Acc: 0.915 Test Loss: 0.601 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 19 cost time: 0.6609518527984619
Epoch: 19, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.532 Vali Acc: 0.922 Test Loss: 0.532 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 20 cost time: 0.6831493377685547
Epoch: 20, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.469 Vali Acc: 0.915 Test Loss: 0.469 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7121186256408691
Epoch: 21, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 22 cost time: 0.6399619579315186
Epoch: 22, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.7140767574310303
Epoch: 23, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6628618240356445
Epoch: 24, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7737689018249512
Epoch: 25, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.267 Vali Acc: 0.904 Test Loss: 0.267 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7150998115539551
Epoch: 26, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5643973350524902
Epoch: 27, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6914083957672119
Epoch: 28, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.6895289421081543
Epoch: 29, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.212 Vali Acc: 0.915 Test Loss: 0.212 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7262094020843506
Epoch: 30, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7117578983306885
Epoch: 31, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.915 Test Loss: 0.222 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6961145401000977
Epoch: 32, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.220 Vali Acc: 0.919 Test Loss: 0.220 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.732795238494873
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5994534492492676
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7435081005096436
Epoch: 35, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6503353118896484
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6961305141448975
Epoch: 37, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7372524738311768
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 36457734
model size : 153.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.768946647644043
Epoch: 1, Steps: 2 | Train Loss: 2.042 Vali Loss: 1.910 Vali Acc: 0.163 Test Loss: 1.910 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 1.084883689880371
Epoch: 2, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.848 Vali Acc: 0.144 Test Loss: 1.848 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6209397315979004
Epoch: 3, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.812 Vali Acc: 0.156 Test Loss: 1.812 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6649801731109619
Epoch: 4, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.780 Vali Acc: 0.163 Test Loss: 1.780 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.6386849880218506
Epoch: 5, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.743 Vali Acc: 0.211 Test Loss: 1.743 Test Acc: 0.211
Validation loss decreased (-0.162945 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 0.7517399787902832
Epoch: 6, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.699 Vali Acc: 0.330 Test Loss: 1.699 Test Acc: 0.330
Validation loss decreased (-0.211094 --> -0.329613).  Saving model ...
Epoch: 7 cost time: 0.6268243789672852
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.653 Vali Acc: 0.437 Test Loss: 1.653 Test Acc: 0.437
Validation loss decreased (-0.329613 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 0.7714848518371582
Epoch: 8, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.605 Vali Acc: 0.581 Test Loss: 1.605 Test Acc: 0.581
Validation loss decreased (-0.437021 --> -0.581465).  Saving model ...
Epoch: 9 cost time: 0.7025673389434814
Epoch: 9, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.556 Vali Acc: 0.685 Test Loss: 1.556 Test Acc: 0.685
Validation loss decreased (-0.581465 --> -0.685170).  Saving model ...
Epoch: 10 cost time: 0.6765310764312744
Epoch: 10, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.506 Vali Acc: 0.704 Test Loss: 1.506 Test Acc: 0.704
Validation loss decreased (-0.685170 --> -0.703689).  Saving model ...
Epoch: 11 cost time: 0.6993138790130615
Epoch: 11, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.452 Vali Acc: 0.722 Test Loss: 1.452 Test Acc: 0.722
Validation loss decreased (-0.703689 --> -0.722208).  Saving model ...
Epoch: 12 cost time: 0.6234540939331055
Epoch: 12, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.395 Vali Acc: 0.741 Test Loss: 1.395 Test Acc: 0.741
Validation loss decreased (-0.722208 --> -0.740727).  Saving model ...
Epoch: 13 cost time: 0.6999502182006836
Epoch: 13, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.334 Vali Acc: 0.748 Test Loss: 1.334 Test Acc: 0.748
Validation loss decreased (-0.740727 --> -0.748135).  Saving model ...
Epoch: 14 cost time: 0.6467194557189941
Epoch: 14, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.267 Vali Acc: 0.770 Test Loss: 1.267 Test Acc: 0.770
Validation loss decreased (-0.748135 --> -0.770358).  Saving model ...
Epoch: 15 cost time: 0.6743779182434082
Epoch: 15, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.196 Vali Acc: 0.822 Test Loss: 1.196 Test Acc: 0.822
Validation loss decreased (-0.770358 --> -0.822210).  Saving model ...
Epoch: 16 cost time: 0.6296389102935791
Epoch: 16, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.123 Vali Acc: 0.844 Test Loss: 1.123 Test Acc: 0.844
Validation loss decreased (-0.822210 --> -0.844433).  Saving model ...
Epoch: 17 cost time: 0.6096715927124023
Epoch: 17, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.046 Vali Acc: 0.878 Test Loss: 1.046 Test Acc: 0.878
Validation loss decreased (-0.844433 --> -0.877767).  Saving model ...
Epoch: 18 cost time: 0.6763370037078857
Epoch: 18, Steps: 2 | Train Loss: 0.981 Vali Loss: 0.969 Vali Acc: 0.885 Test Loss: 0.969 Test Acc: 0.885
Validation loss decreased (-0.877767 --> -0.885175).  Saving model ...
Epoch: 19 cost time: 0.7590487003326416
Epoch: 19, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.891 Vali Acc: 0.900 Test Loss: 0.891 Test Acc: 0.900
Validation loss decreased (-0.885175 --> -0.899991).  Saving model ...
Epoch: 20 cost time: 0.6397364139556885
Epoch: 20, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.813 Vali Acc: 0.904 Test Loss: 0.813 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903696).  Saving model ...
Epoch: 21 cost time: 0.6007411479949951
Epoch: 21, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.733 Vali Acc: 0.911 Test Loss: 0.733 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.5955424308776855
Epoch: 22, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.652 Vali Acc: 0.922 Test Loss: 0.652 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922216).  Saving model ...
Epoch: 23 cost time: 0.6353669166564941
Epoch: 23, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.575 Vali Acc: 0.933 Test Loss: 0.575 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 24 cost time: 0.6272094249725342
Epoch: 24, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.504 Vali Acc: 0.937 Test Loss: 0.504 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 25 cost time: 0.6639950275421143
Epoch: 25, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.441 Vali Acc: 0.933 Test Loss: 0.441 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5847880840301514
Epoch: 26, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.387 Vali Acc: 0.926 Test Loss: 0.387 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6444768905639648
Epoch: 27, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.347 Vali Acc: 0.915 Test Loss: 0.347 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7674112319946289
Epoch: 28, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6470608711242676
Epoch: 29, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.6683390140533447
Epoch: 30, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
Validation loss decreased (-0.940738 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.8701956272125244
Epoch: 31, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.770047664642334
Epoch: 32, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7066051959991455
Epoch: 33, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7010364532470703
Epoch: 34, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6809465885162354
Epoch: 35, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6775634288787842
Epoch: 36, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7162613868713379
Epoch: 37, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8682968616485596
Epoch: 38, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.587512731552124
Epoch: 39, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.736220121383667
Epoch: 40, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.5539894104003906
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6483776569366455
Epoch: 42, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.778052806854248
Epoch: 43, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6391963958740234
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6934704780578613
Epoch: 45, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5986602306365967
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6179962158203125
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7245981693267822
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.7008743286132812
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.158 Vali Acc: 0.952 Test Loss: 0.158 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.8846216201782227
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 36420870
model size : 153.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8777167797088623
Epoch: 1, Steps: 2 | Train Loss: 2.010 Vali Loss: 1.865 Vali Acc: 0.141 Test Loss: 1.865 Test Acc: 0.141
Validation loss decreased (inf --> -0.140722).  Saving model ...
Epoch: 2 cost time: 0.7827301025390625
Epoch: 2, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.807 Vali Acc: 0.222 Test Loss: 1.807 Test Acc: 0.222
Validation loss decreased (-0.140722 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.6779417991638184
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.770 Vali Acc: 0.270 Test Loss: 1.770 Test Acc: 0.270
Validation loss decreased (-0.222204 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 0.7208759784698486
Epoch: 4, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.715 Vali Acc: 0.341 Test Loss: 1.715 Test Acc: 0.341
Validation loss decreased (-0.270353 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.7449338436126709
Epoch: 5, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.646 Vali Acc: 0.419 Test Loss: 1.646 Test Acc: 0.419
Validation loss decreased (-0.340724 --> -0.418502).  Saving model ...
Epoch: 6 cost time: 0.5860788822174072
Epoch: 6, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.569 Vali Acc: 0.589 Test Loss: 1.569 Test Acc: 0.589
Validation loss decreased (-0.418502 --> -0.588873).  Saving model ...
Epoch: 7 cost time: 0.7362508773803711
Epoch: 7, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.479 Vali Acc: 0.685 Test Loss: 1.479 Test Acc: 0.685
Validation loss decreased (-0.588873 --> -0.685170).  Saving model ...
Epoch: 8 cost time: 0.7736036777496338
Epoch: 8, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.380 Vali Acc: 0.752 Test Loss: 1.380 Test Acc: 0.752
Validation loss decreased (-0.685170 --> -0.751838).  Saving model ...
Epoch: 9 cost time: 0.6918184757232666
Epoch: 9, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.279 Vali Acc: 0.833 Test Loss: 1.279 Test Acc: 0.833
Validation loss decreased (-0.751838 --> -0.833321).  Saving model ...
Epoch: 10 cost time: 0.8444380760192871
Epoch: 10, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.179 Vali Acc: 0.874 Test Loss: 1.179 Test Acc: 0.874
Validation loss decreased (-0.833321 --> -0.874062).  Saving model ...
Epoch: 11 cost time: 0.6578247547149658
Epoch: 11, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.079 Vali Acc: 0.881 Test Loss: 1.079 Test Acc: 0.881
Validation loss decreased (-0.874062 --> -0.881471).  Saving model ...
Epoch: 12 cost time: 0.6180241107940674
Epoch: 12, Steps: 2 | Train Loss: 0.978 Vali Loss: 0.979 Vali Acc: 0.878 Test Loss: 0.979 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5871574878692627
Epoch: 13, Steps: 2 | Train Loss: 0.918 Vali Loss: 0.876 Vali Acc: 0.889 Test Loss: 0.876 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888880).  Saving model ...
Epoch: 14 cost time: 0.7411949634552002
Epoch: 14, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.777 Vali Acc: 0.907 Test Loss: 0.777 Test Acc: 0.907
Validation loss decreased (-0.888880 --> -0.907400).  Saving model ...
Epoch: 15 cost time: 0.8713669776916504
Epoch: 15, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.689 Vali Acc: 0.944 Test Loss: 0.689 Test Acc: 0.944
Validation loss decreased (-0.907400 --> -0.944438).  Saving model ...
Epoch: 16 cost time: 0.8217732906341553
Epoch: 16, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.606 Vali Acc: 0.937 Test Loss: 0.606 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.776641845703125
Epoch: 17, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.530 Vali Acc: 0.926 Test Loss: 0.530 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8711211681365967
Epoch: 18, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.467 Vali Acc: 0.904 Test Loss: 0.467 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7824950218200684
Epoch: 19, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6791129112243652
Epoch: 20, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.358 Vali Acc: 0.907 Test Loss: 0.358 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7379007339477539
Epoch: 21, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7206132411956787
Epoch: 22, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6636941432952881
Epoch: 23, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8090720176696777
Epoch: 24, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7441322803497314
Epoch: 25, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 36509958
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.549424409866333
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.762 Vali Acc: 0.185 Test Loss: 1.762 Test Acc: 0.185
Validation loss decreased (inf --> -0.185168).  Saving model ...
Epoch: 2 cost time: 0.7152276039123535
Epoch: 2, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.720 Vali Acc: 0.219 Test Loss: 1.720 Test Acc: 0.219
Validation loss decreased (-0.185168 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.6497116088867188
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.695 Vali Acc: 0.367 Test Loss: 1.695 Test Acc: 0.367
Validation loss decreased (-0.218501 --> -0.366650).  Saving model ...
Epoch: 4 cost time: 0.5756654739379883
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.661 Vali Acc: 0.441 Test Loss: 1.661 Test Acc: 0.441
Validation loss decreased (-0.366650 --> -0.440724).  Saving model ...
Epoch: 5 cost time: 0.643625020980835
Epoch: 5, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.619 Vali Acc: 0.522 Test Loss: 1.619 Test Acc: 0.522
Validation loss decreased (-0.440724 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 0.6161112785339355
Epoch: 6, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.570 Vali Acc: 0.596 Test Loss: 1.570 Test Acc: 0.596
Validation loss decreased (-0.522206 --> -0.596281).  Saving model ...
Epoch: 7 cost time: 0.6582674980163574
Epoch: 7, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.513 Vali Acc: 0.674 Test Loss: 1.513 Test Acc: 0.674
Validation loss decreased (-0.596281 --> -0.674059).  Saving model ...
Epoch: 8 cost time: 0.5408551692962646
Epoch: 8, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.452 Vali Acc: 0.756 Test Loss: 1.452 Test Acc: 0.756
Validation loss decreased (-0.674059 --> -0.755541).  Saving model ...
Epoch: 9 cost time: 0.728834867477417
Epoch: 9, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.386 Vali Acc: 0.781 Test Loss: 1.386 Test Acc: 0.781
Validation loss decreased (-0.755541 --> -0.781468).  Saving model ...
Epoch: 10 cost time: 0.7684590816497803
Epoch: 10, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.315 Vali Acc: 0.830 Test Loss: 1.315 Test Acc: 0.830
Validation loss decreased (-0.781468 --> -0.829616).  Saving model ...
Epoch: 11 cost time: 0.693002462387085
Epoch: 11, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.241 Vali Acc: 0.870 Test Loss: 1.241 Test Acc: 0.870
Validation loss decreased (-0.829616 --> -0.870358).  Saving model ...
Epoch: 12 cost time: 0.6646127700805664
Epoch: 12, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.164 Vali Acc: 0.878 Test Loss: 1.164 Test Acc: 0.878
Validation loss decreased (-0.870358 --> -0.877766).  Saving model ...
Epoch: 13 cost time: 0.6284658908843994
Epoch: 13, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.086 Vali Acc: 0.889 Test Loss: 1.086 Test Acc: 0.889
Validation loss decreased (-0.877766 --> -0.888878).  Saving model ...
Epoch: 14 cost time: 0.6642007827758789
Epoch: 14, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.007 Vali Acc: 0.893 Test Loss: 1.007 Test Acc: 0.893
Validation loss decreased (-0.888878 --> -0.892583).  Saving model ...
Epoch: 15 cost time: 0.5997157096862793
Epoch: 15, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.927 Vali Acc: 0.904 Test Loss: 0.927 Test Acc: 0.904
Validation loss decreased (-0.892583 --> -0.903694).  Saving model ...
Epoch: 16 cost time: 0.6736032962799072
Epoch: 16, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.845 Vali Acc: 0.930 Test Loss: 0.845 Test Acc: 0.930
Validation loss decreased (-0.903694 --> -0.929621).  Saving model ...
Epoch: 17 cost time: 0.5586752891540527
Epoch: 17, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.765 Vali Acc: 0.941 Test Loss: 0.765 Test Acc: 0.941
Validation loss decreased (-0.929621 --> -0.940733).  Saving model ...
Epoch: 18 cost time: 0.5563616752624512
Epoch: 18, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.689 Vali Acc: 0.944 Test Loss: 0.689 Test Acc: 0.944
Validation loss decreased (-0.940733 --> -0.944438).  Saving model ...
Epoch: 19 cost time: 0.6803040504455566
Epoch: 19, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.617 Vali Acc: 0.944 Test Loss: 0.617 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944438).  Saving model ...
Epoch: 20 cost time: 0.6756086349487305
Epoch: 20, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.547 Vali Acc: 0.944 Test Loss: 0.547 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944439).  Saving model ...
Epoch: 21 cost time: 0.6172835826873779
Epoch: 21, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.479 Vali Acc: 0.948 Test Loss: 0.479 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 22 cost time: 0.6397264003753662
Epoch: 22, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.417 Vali Acc: 0.956 Test Loss: 0.417 Test Acc: 0.956
Validation loss decreased (-0.948143 --> -0.955551).  Saving model ...
Epoch: 23 cost time: 0.5881528854370117
Epoch: 23, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.365 Vali Acc: 0.952 Test Loss: 0.365 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5806715488433838
Epoch: 24, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.318 Vali Acc: 0.948 Test Loss: 0.318 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6274468898773193
Epoch: 25, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7248165607452393
Epoch: 26, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8201296329498291
Epoch: 27, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.666393518447876
Epoch: 28, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8439109325408936
Epoch: 29, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7858672142028809
Epoch: 30, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7564175128936768
Epoch: 31, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6844260692596436
Epoch: 32, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.955551 --> -0.959258).  Saving model ...
Epoch: 33 cost time: 0.6835036277770996
Epoch: 33, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.564826250076294
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8642690181732178
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6985998153686523
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.660200834274292
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6170814037322998
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8057591915130615
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9342939853668213
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.916440486907959
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.937 Test Loss: 0.163 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6691970825195312
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 36454662
model size : 153.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1522533893585205
Epoch: 1, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.798 Vali Acc: 0.289 Test Loss: 1.798 Test Acc: 0.289
Validation loss decreased (inf --> -0.288871).  Saving model ...
Epoch: 2 cost time: 0.6471042633056641
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.761 Vali Acc: 0.248 Test Loss: 1.761 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5335521697998047
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.740 Vali Acc: 0.244 Test Loss: 1.740 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6385495662689209
Epoch: 4, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.718 Vali Acc: 0.285 Test Loss: 1.718 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7666773796081543
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.691 Vali Acc: 0.319 Test Loss: 1.691 Test Acc: 0.319
Validation loss decreased (-0.288871 --> -0.318502).  Saving model ...
Epoch: 6 cost time: 0.5818493366241455
Epoch: 6, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.661 Vali Acc: 0.374 Test Loss: 1.661 Test Acc: 0.374
Validation loss decreased (-0.318502 --> -0.374057).  Saving model ...
Epoch: 7 cost time: 0.6410200595855713
Epoch: 7, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.625 Vali Acc: 0.437 Test Loss: 1.625 Test Acc: 0.437
Validation loss decreased (-0.374057 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 0.716717004776001
Epoch: 8, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.586 Vali Acc: 0.481 Test Loss: 1.586 Test Acc: 0.481
Validation loss decreased (-0.437021 --> -0.481466).  Saving model ...
Epoch: 9 cost time: 0.7231612205505371
Epoch: 9, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.545 Vali Acc: 0.504 Test Loss: 1.545 Test Acc: 0.504
Validation loss decreased (-0.481466 --> -0.503688).  Saving model ...
Epoch: 10 cost time: 0.6688649654388428
Epoch: 10, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.501 Vali Acc: 0.533 Test Loss: 1.501 Test Acc: 0.533
Validation loss decreased (-0.503688 --> -0.533318).  Saving model ...
Epoch: 11 cost time: 0.6332223415374756
Epoch: 11, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.454 Vali Acc: 0.567 Test Loss: 1.454 Test Acc: 0.567
Validation loss decreased (-0.533318 --> -0.566652).  Saving model ...
Epoch: 12 cost time: 0.6974775791168213
Epoch: 12, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.406 Vali Acc: 0.626 Test Loss: 1.406 Test Acc: 0.626
Validation loss decreased (-0.566652 --> -0.625912).  Saving model ...
Epoch: 13 cost time: 0.6139366626739502
Epoch: 13, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.354 Vali Acc: 0.689 Test Loss: 1.354 Test Acc: 0.689
Validation loss decreased (-0.625912 --> -0.688875).  Saving model ...
Epoch: 14 cost time: 0.5953879356384277
Epoch: 14, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.301 Vali Acc: 0.715 Test Loss: 1.301 Test Acc: 0.715
Validation loss decreased (-0.688875 --> -0.714802).  Saving model ...
Epoch: 15 cost time: 0.9574804306030273
Epoch: 15, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.244 Vali Acc: 0.752 Test Loss: 1.244 Test Acc: 0.752
Validation loss decreased (-0.714802 --> -0.751839).  Saving model ...
Epoch: 16 cost time: 0.8022103309631348
Epoch: 16, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.184 Vali Acc: 0.789 Test Loss: 1.184 Test Acc: 0.789
Validation loss decreased (-0.751839 --> -0.788877).  Saving model ...
Epoch: 17 cost time: 0.6233673095703125
Epoch: 17, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.120 Vali Acc: 0.819 Test Loss: 1.120 Test Acc: 0.819
Validation loss decreased (-0.788877 --> -0.818507).  Saving model ...
Epoch: 18 cost time: 0.6025152206420898
Epoch: 18, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.052 Vali Acc: 0.844 Test Loss: 1.052 Test Acc: 0.844
Validation loss decreased (-0.818507 --> -0.844434).  Saving model ...
Epoch: 19 cost time: 0.6128113269805908
Epoch: 19, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.983 Vali Acc: 0.870 Test Loss: 0.983 Test Acc: 0.870
Validation loss decreased (-0.844434 --> -0.870361).  Saving model ...
Epoch: 20 cost time: 0.6788311004638672
Epoch: 20, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.913 Vali Acc: 0.878 Test Loss: 0.913 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 21 cost time: 0.587080717086792
Epoch: 21, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.843 Vali Acc: 0.885 Test Loss: 0.843 Test Acc: 0.885
Validation loss decreased (-0.877769 --> -0.885177).  Saving model ...
Epoch: 22 cost time: 0.603783369064331
Epoch: 22, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.773 Vali Acc: 0.885 Test Loss: 0.773 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885177).  Saving model ...
Epoch: 23 cost time: 0.641838788986206
Epoch: 23, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.701 Vali Acc: 0.893 Test Loss: 0.701 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892586).  Saving model ...
Epoch: 24 cost time: 0.6790165901184082
Epoch: 24, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.5998256206512451
Epoch: 25, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.568 Vali Acc: 0.907 Test Loss: 0.568 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 26 cost time: 0.5325727462768555
Epoch: 26, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.509 Vali Acc: 0.915 Test Loss: 0.509 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.7716526985168457
Epoch: 27, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.452 Vali Acc: 0.919 Test Loss: 0.452 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.6456644535064697
Epoch: 28, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.401 Vali Acc: 0.919 Test Loss: 0.401 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 29 cost time: 0.5788578987121582
Epoch: 29, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.918515 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.47423720359802246
Epoch: 30, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.6041262149810791
Epoch: 31, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6554641723632812
Epoch: 32, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.659477949142456
Epoch: 33, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7109086513519287
Epoch: 34, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7244205474853516
Epoch: 35, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6718535423278809
Epoch: 36, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7692465782165527
Epoch: 37, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.701946496963501
Epoch: 38, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.7763450145721436
Epoch: 39, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.6818623542785645
Epoch: 40, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.662205696105957
Epoch: 41, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6362788677215576
Epoch: 42, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7046546936035156
Epoch: 43, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7487118244171143
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6503050327301025
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5622777938842773
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6290628910064697
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5630893707275391
Epoch: 48, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7553207874298096
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8351325988769531
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 36423942
model size : 153.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5939998626708984
Epoch: 1, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.777 Vali Acc: 0.230 Test Loss: 1.777 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.5800728797912598
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.741 Vali Acc: 0.348 Test Loss: 1.741 Test Acc: 0.348
Validation loss decreased (-0.229612 --> -0.348131).  Saving model ...
Epoch: 3 cost time: 0.6707565784454346
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.713 Vali Acc: 0.419 Test Loss: 1.713 Test Acc: 0.419
Validation loss decreased (-0.348131 --> -0.418501).  Saving model ...
Epoch: 4 cost time: 0.6359584331512451
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.671 Vali Acc: 0.470 Test Loss: 1.671 Test Acc: 0.470
Validation loss decreased (-0.418501 --> -0.470354).  Saving model ...
Epoch: 5 cost time: 0.7555782794952393
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.617 Vali Acc: 0.533 Test Loss: 1.617 Test Acc: 0.533
Validation loss decreased (-0.470354 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 0.6772644519805908
Epoch: 6, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.551 Vali Acc: 0.637 Test Loss: 1.551 Test Acc: 0.637
Validation loss decreased (-0.533317 --> -0.637022).  Saving model ...
Epoch: 7 cost time: 0.7886829376220703
Epoch: 7, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.477 Vali Acc: 0.689 Test Loss: 1.477 Test Acc: 0.689
Validation loss decreased (-0.637022 --> -0.688874).  Saving model ...
Epoch: 8 cost time: 0.6362779140472412
Epoch: 8, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.399 Vali Acc: 0.737 Test Loss: 1.399 Test Acc: 0.737
Validation loss decreased (-0.688874 --> -0.737023).  Saving model ...
Epoch: 9 cost time: 0.5819225311279297
Epoch: 9, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.315 Vali Acc: 0.759 Test Loss: 1.315 Test Acc: 0.759
Validation loss decreased (-0.737023 --> -0.759246).  Saving model ...
Epoch: 10 cost time: 0.746525764465332
Epoch: 10, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.227 Vali Acc: 0.804 Test Loss: 1.227 Test Acc: 0.804
Validation loss decreased (-0.759246 --> -0.803691).  Saving model ...
Epoch: 11 cost time: 0.6411044597625732
Epoch: 11, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.139 Vali Acc: 0.837 Test Loss: 1.139 Test Acc: 0.837
Validation loss decreased (-0.803691 --> -0.837026).  Saving model ...
Epoch: 12 cost time: 0.7349042892456055
Epoch: 12, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.050 Vali Acc: 0.852 Test Loss: 1.050 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851841).  Saving model ...
Epoch: 13 cost time: 0.8512277603149414
Epoch: 13, Steps: 2 | Train Loss: 0.973 Vali Loss: 0.962 Vali Acc: 0.889 Test Loss: 0.962 Test Acc: 0.889
Validation loss decreased (-0.851841 --> -0.888879).  Saving model ...
Epoch: 14 cost time: 0.656207799911499
Epoch: 14, Steps: 2 | Train Loss: 0.857 Vali Loss: 0.878 Vali Acc: 0.878 Test Loss: 0.878 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6530444622039795
Epoch: 15, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.794 Vali Acc: 0.900 Test Loss: 0.794 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.7313580513000488
Epoch: 16, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.710 Vali Acc: 0.907 Test Loss: 0.710 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 17 cost time: 0.7214770317077637
Epoch: 17, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.631 Vali Acc: 0.919 Test Loss: 0.631 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 18 cost time: 0.5790855884552002
Epoch: 18, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.556 Vali Acc: 0.915 Test Loss: 0.556 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6527450084686279
Epoch: 19, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.487 Vali Acc: 0.911 Test Loss: 0.487 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7812848091125488
Epoch: 20, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.424 Vali Acc: 0.926 Test Loss: 0.424 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.6289737224578857
Epoch: 21, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.371 Vali Acc: 0.926 Test Loss: 0.371 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.794931173324585
Epoch: 22, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.6592514514923096
Epoch: 23, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.6986026763916016
Epoch: 24, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7219312191009521
Epoch: 25, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8471047878265381
Epoch: 26, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.5914640426635742
Epoch: 27, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7443170547485352
Epoch: 28, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7605123519897461
Epoch: 29, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7541260719299316
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.65193772315979
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5905306339263916
Epoch: 32, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7143492698669434
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6415755748748779
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6891884803771973
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7442870140075684
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36497670
model size : 153.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.194333076477051
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.906 Vali Acc: 0.089 Test Loss: 1.906 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 0.6566646099090576
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.844 Vali Acc: 0.133 Test Loss: 1.844 Test Acc: 0.133
Validation loss decreased (-0.088870 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.7720229625701904
Epoch: 3, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.806 Vali Acc: 0.237 Test Loss: 1.806 Test Acc: 0.237
Validation loss decreased (-0.133315 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.6505270004272461
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.772 Vali Acc: 0.307 Test Loss: 1.772 Test Acc: 0.307
Validation loss decreased (-0.237019 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.610194206237793
Epoch: 5, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.730 Vali Acc: 0.367 Test Loss: 1.730 Test Acc: 0.367
Validation loss decreased (-0.307390 --> -0.366649).  Saving model ...
Epoch: 6 cost time: 0.5724985599517822
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.685 Vali Acc: 0.415 Test Loss: 1.685 Test Acc: 0.415
Validation loss decreased (-0.366649 --> -0.414798).  Saving model ...
Epoch: 7 cost time: 0.6722133159637451
Epoch: 7, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.635 Vali Acc: 0.481 Test Loss: 1.635 Test Acc: 0.481
Validation loss decreased (-0.414798 --> -0.481465).  Saving model ...
Epoch: 8 cost time: 0.5350766181945801
Epoch: 8, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.581 Vali Acc: 0.541 Test Loss: 1.581 Test Acc: 0.541
Validation loss decreased (-0.481465 --> -0.540725).  Saving model ...
Epoch: 9 cost time: 0.6743237972259521
Epoch: 9, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.524 Vali Acc: 0.563 Test Loss: 1.524 Test Acc: 0.563
Validation loss decreased (-0.540725 --> -0.562948).  Saving model ...
Epoch: 10 cost time: 0.7718372344970703
Epoch: 10, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.463 Vali Acc: 0.589 Test Loss: 1.463 Test Acc: 0.589
Validation loss decreased (-0.562948 --> -0.588874).  Saving model ...
Epoch: 11 cost time: 0.586897611618042
Epoch: 11, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.400 Vali Acc: 0.626 Test Loss: 1.400 Test Acc: 0.626
Validation loss decreased (-0.588874 --> -0.625912).  Saving model ...
Epoch: 12 cost time: 0.6780364513397217
Epoch: 12, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.337 Vali Acc: 0.670 Test Loss: 1.337 Test Acc: 0.670
Validation loss decreased (-0.625912 --> -0.670357).  Saving model ...
Epoch: 13 cost time: 0.6671829223632812
Epoch: 13, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.270 Vali Acc: 0.719 Test Loss: 1.270 Test Acc: 0.719
Validation loss decreased (-0.670357 --> -0.718506).  Saving model ...
Epoch: 14 cost time: 0.6154880523681641
Epoch: 14, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.196 Vali Acc: 0.781 Test Loss: 1.196 Test Acc: 0.781
Validation loss decreased (-0.718506 --> -0.781470).  Saving model ...
Epoch: 15 cost time: 0.7936038970947266
Epoch: 15, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.119 Vali Acc: 0.852 Test Loss: 1.119 Test Acc: 0.852
Validation loss decreased (-0.781470 --> -0.851841).  Saving model ...
Epoch: 16 cost time: 0.8161709308624268
Epoch: 16, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.039 Vali Acc: 0.863 Test Loss: 1.039 Test Acc: 0.863
Validation loss decreased (-0.851841 --> -0.862953).  Saving model ...
Epoch: 17 cost time: 0.6799566745758057
Epoch: 17, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.958 Vali Acc: 0.881 Test Loss: 0.958 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881472).  Saving model ...
Epoch: 18 cost time: 0.7549524307250977
Epoch: 18, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.882 Vali Acc: 0.893 Test Loss: 0.882 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 19 cost time: 0.6291947364807129
Epoch: 19, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.810 Vali Acc: 0.893 Test Loss: 0.810 Test Acc: 0.893
Validation loss decreased (-0.892584 --> -0.892584).  Saving model ...
Epoch: 20 cost time: 0.6276454925537109
Epoch: 20, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.6709263324737549
Epoch: 21, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.668 Vali Acc: 0.904 Test Loss: 0.668 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 22 cost time: 0.5970809459686279
Epoch: 22, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.602 Vali Acc: 0.911 Test Loss: 0.602 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.6260180473327637
Epoch: 23, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.539 Vali Acc: 0.919 Test Loss: 0.539 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.5934176445007324
Epoch: 24, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.480 Vali Acc: 0.930 Test Loss: 0.480 Test Acc: 0.930
Validation loss decreased (-0.918513 --> -0.929625).  Saving model ...
Epoch: 25 cost time: 0.5451304912567139
Epoch: 25, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.427 Vali Acc: 0.926 Test Loss: 0.427 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5128607749938965
Epoch: 26, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.377 Vali Acc: 0.930 Test Loss: 0.377 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 27 cost time: 0.6174142360687256
Epoch: 27, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 28 cost time: 0.6674997806549072
Epoch: 28, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6045057773590088
Epoch: 29, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.282 Vali Acc: 0.915 Test Loss: 0.282 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6281721591949463
Epoch: 30, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5791997909545898
Epoch: 31, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6132297515869141
Epoch: 32, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.683974027633667
Epoch: 33, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7160005569458008
Epoch: 34, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5571215152740479
Epoch: 35, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.5762126445770264
Epoch: 36, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.6453261375427246
Epoch: 37, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.6949598789215088
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 39 cost time: 0.6749539375305176
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 40 cost time: 0.7410440444946289
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.6018309593200684
Epoch: 41, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.6693570613861084
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6690094470977783
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.598459005355835
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.710674524307251
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6348669528961182
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7249317169189453
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6805248260498047
Epoch: 48, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6531643867492676
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7005939483642578
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 36460806
model size : 153.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.780367851257324
Epoch: 1, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.877 Vali Acc: 0.130 Test Loss: 1.877 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.595710039138794
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.841 Vali Acc: 0.111 Test Loss: 1.841 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6875336170196533
Epoch: 3, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.818 Vali Acc: 0.144 Test Loss: 1.818 Test Acc: 0.144
Validation loss decreased (-0.129611 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 0.7525985240936279
Epoch: 4, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.794 Vali Acc: 0.167 Test Loss: 1.794 Test Acc: 0.167
Validation loss decreased (-0.144426 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.7201247215270996
Epoch: 5, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.764 Vali Acc: 0.193 Test Loss: 1.764 Test Acc: 0.193
Validation loss decreased (-0.166649 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.6730279922485352
Epoch: 6, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.731 Vali Acc: 0.285 Test Loss: 1.731 Test Acc: 0.285
Validation loss decreased (-0.192575 --> -0.285168).  Saving model ...
Epoch: 7 cost time: 0.7307929992675781
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.695 Vali Acc: 0.430 Test Loss: 1.695 Test Acc: 0.430
Validation loss decreased (-0.285168 --> -0.429613).  Saving model ...
Epoch: 8 cost time: 0.6623404026031494
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.655 Vali Acc: 0.548 Test Loss: 1.655 Test Acc: 0.548
Validation loss decreased (-0.429613 --> -0.548132).  Saving model ...
Epoch: 9 cost time: 0.5839152336120605
Epoch: 9, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.614 Vali Acc: 0.619 Test Loss: 1.614 Test Acc: 0.619
Validation loss decreased (-0.548132 --> -0.618502).  Saving model ...
Epoch: 10 cost time: 0.7067902088165283
Epoch: 10, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.569 Vali Acc: 0.685 Test Loss: 1.569 Test Acc: 0.685
Validation loss decreased (-0.618502 --> -0.685169).  Saving model ...
Epoch: 11 cost time: 0.7474398612976074
Epoch: 11, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.519 Vali Acc: 0.726 Test Loss: 1.519 Test Acc: 0.726
Validation loss decreased (-0.685169 --> -0.725911).  Saving model ...
Epoch: 12 cost time: 0.6436450481414795
Epoch: 12, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.468 Vali Acc: 0.785 Test Loss: 1.468 Test Acc: 0.785
Validation loss decreased (-0.725911 --> -0.785171).  Saving model ...
Epoch: 13 cost time: 0.7871115207672119
Epoch: 13, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.414 Vali Acc: 0.800 Test Loss: 1.414 Test Acc: 0.800
Validation loss decreased (-0.785171 --> -0.799986).  Saving model ...
Epoch: 14 cost time: 0.7690575122833252
Epoch: 14, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.356 Vali Acc: 0.837 Test Loss: 1.356 Test Acc: 0.837
Validation loss decreased (-0.799986 --> -0.837023).  Saving model ...
Epoch: 15 cost time: 0.6318607330322266
Epoch: 15, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.300 Vali Acc: 0.848 Test Loss: 1.300 Test Acc: 0.848
Validation loss decreased (-0.837023 --> -0.848135).  Saving model ...
Epoch: 16 cost time: 0.6487605571746826
Epoch: 16, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.240 Vali Acc: 0.874 Test Loss: 1.240 Test Acc: 0.874
Validation loss decreased (-0.848135 --> -0.874062).  Saving model ...
Epoch: 17 cost time: 0.6326489448547363
Epoch: 17, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.178 Vali Acc: 0.900 Test Loss: 1.178 Test Acc: 0.900
Validation loss decreased (-0.874062 --> -0.899988).  Saving model ...
Epoch: 18 cost time: 0.7985091209411621
Epoch: 18, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.112 Vali Acc: 0.915 Test Loss: 1.112 Test Acc: 0.915
Validation loss decreased (-0.899988 --> -0.914804).  Saving model ...
Epoch: 19 cost time: 0.7269933223724365
Epoch: 19, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.041 Vali Acc: 0.915 Test Loss: 1.041 Test Acc: 0.915
Validation loss decreased (-0.914804 --> -0.914804).  Saving model ...
Epoch: 20 cost time: 0.7389247417449951
Epoch: 20, Steps: 2 | Train Loss: 1.029 Vali Loss: 0.967 Vali Acc: 0.930 Test Loss: 0.967 Test Acc: 0.930
Validation loss decreased (-0.914804 --> -0.929620).  Saving model ...
Epoch: 21 cost time: 0.7362313270568848
Epoch: 21, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.890 Vali Acc: 0.937 Test Loss: 0.890 Test Acc: 0.937
Validation loss decreased (-0.929620 --> -0.937028).  Saving model ...
Epoch: 22 cost time: 0.7113080024719238
Epoch: 22, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.813 Vali Acc: 0.948 Test Loss: 0.813 Test Acc: 0.948
Validation loss decreased (-0.937028 --> -0.948140).  Saving model ...
Epoch: 23 cost time: 0.6695060729980469
Epoch: 23, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.739 Vali Acc: 0.944 Test Loss: 0.739 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6332781314849854
Epoch: 24, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.669 Vali Acc: 0.941 Test Loss: 0.669 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6918916702270508
Epoch: 25, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.599 Vali Acc: 0.944 Test Loss: 0.599 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5548338890075684
Epoch: 26, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.532 Vali Acc: 0.944 Test Loss: 0.532 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5958025455474854
Epoch: 27, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.471 Vali Acc: 0.952 Test Loss: 0.471 Test Acc: 0.952
Validation loss decreased (-0.948140 --> -0.951847).  Saving model ...
Epoch: 28 cost time: 0.6237227916717529
Epoch: 28, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.416 Vali Acc: 0.944 Test Loss: 0.416 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6681962013244629
Epoch: 29, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.368 Vali Acc: 0.944 Test Loss: 0.368 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6437621116638184
Epoch: 30, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5212390422821045
Epoch: 31, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.652583122253418
Epoch: 32, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.744654655456543
Epoch: 33, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7614150047302246
Epoch: 34, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6603395938873291
Epoch: 35, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0215866565704346
Epoch: 36, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7946436405181885
Epoch: 37, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 36442374
model size : 153.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5061490535736084
Epoch: 1, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.835 Vali Acc: 0.237 Test Loss: 1.835 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.737257719039917
Epoch: 2, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.779 Vali Acc: 0.263 Test Loss: 1.779 Test Acc: 0.263
Validation loss decreased (-0.237019 --> -0.262945).  Saving model ...
Epoch: 3 cost time: 0.6757586002349854
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.689 Vali Acc: 0.319 Test Loss: 1.689 Test Acc: 0.319
Validation loss decreased (-0.262945 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.9958760738372803
Epoch: 4, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.541 Vali Acc: 0.552 Test Loss: 1.541 Test Acc: 0.552
Validation loss decreased (-0.318502 --> -0.551836).  Saving model ...
Epoch: 5 cost time: 0.7075684070587158
Epoch: 5, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.375 Vali Acc: 0.674 Test Loss: 1.375 Test Acc: 0.674
Validation loss decreased (-0.551836 --> -0.674060).  Saving model ...
Epoch: 6 cost time: 0.8311450481414795
Epoch: 6, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.210 Vali Acc: 0.715 Test Loss: 1.210 Test Acc: 0.715
Validation loss decreased (-0.674060 --> -0.714803).  Saving model ...
Epoch: 7 cost time: 0.7974574565887451
Epoch: 7, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.053 Vali Acc: 0.748 Test Loss: 1.053 Test Acc: 0.748
Validation loss decreased (-0.714803 --> -0.748138).  Saving model ...
Epoch: 8 cost time: 0.801201581954956
Epoch: 8, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.866 Vali Acc: 0.896 Test Loss: 0.866 Test Acc: 0.896
Validation loss decreased (-0.748138 --> -0.896288).  Saving model ...
Epoch: 9 cost time: 0.7059242725372314
Epoch: 9, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.716 Vali Acc: 0.919 Test Loss: 0.716 Test Acc: 0.919
Validation loss decreased (-0.896288 --> -0.918511).  Saving model ...
Epoch: 10 cost time: 0.8209719657897949
Epoch: 10, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.606 Vali Acc: 0.896 Test Loss: 0.606 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9031894207000732
Epoch: 11, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.505 Vali Acc: 0.926 Test Loss: 0.505 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925921).  Saving model ...
Epoch: 12 cost time: 0.6997222900390625
Epoch: 12, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.436 Vali Acc: 0.896 Test Loss: 0.436 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9381444454193115
Epoch: 13, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.378 Vali Acc: 0.896 Test Loss: 0.378 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8328161239624023
Epoch: 14, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.315 Vali Acc: 0.941 Test Loss: 0.315 Test Acc: 0.941
Validation loss decreased (-0.925921 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.8002040386199951
Epoch: 15, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8226833343505859
Epoch: 16, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8797144889831543
Epoch: 17, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7290902137756348
Epoch: 18, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7091178894042969
Epoch: 19, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.787926435470581
Epoch: 20, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.9392001628875732
Epoch: 21, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.5833439826965332
Epoch: 22, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7493259906768799
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.915 Test Loss: 0.192 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9518778324127197
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.907 Test Loss: 0.193 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7604432106018066
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.919 Test Loss: 0.191 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9392910003662109
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0400114059448242
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.926 Test Loss: 0.187 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6915690898895264
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9503800868988037
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7563903331756592
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7583098411560059
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 29618694
model size : 127.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.719493865966797
Epoch: 1, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.740 Vali Acc: 0.170 Test Loss: 1.740 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.7828617095947266
Epoch: 2, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.695 Vali Acc: 0.493 Test Loss: 1.695 Test Acc: 0.493
Validation loss decreased (-0.170353 --> -0.492576).  Saving model ...
Epoch: 3 cost time: 0.6112446784973145
Epoch: 3, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.648 Vali Acc: 0.578 Test Loss: 1.648 Test Acc: 0.578
Validation loss decreased (-0.492576 --> -0.577761).  Saving model ...
Epoch: 4 cost time: 0.6882860660552979
Epoch: 4, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.561 Vali Acc: 0.670 Test Loss: 1.561 Test Acc: 0.670
Validation loss decreased (-0.577761 --> -0.670355).  Saving model ...
Epoch: 5 cost time: 0.7822535037994385
Epoch: 5, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.451 Vali Acc: 0.756 Test Loss: 1.451 Test Acc: 0.756
Validation loss decreased (-0.670355 --> -0.755541).  Saving model ...
Epoch: 6 cost time: 0.6393599510192871
Epoch: 6, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.332 Vali Acc: 0.800 Test Loss: 1.332 Test Acc: 0.800
Validation loss decreased (-0.755541 --> -0.799987).  Saving model ...
Epoch: 7 cost time: 0.715285062789917
Epoch: 7, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.213 Vali Acc: 0.830 Test Loss: 1.213 Test Acc: 0.830
Validation loss decreased (-0.799987 --> -0.829617).  Saving model ...
Epoch: 8 cost time: 0.8929495811462402
Epoch: 8, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.085 Vali Acc: 0.896 Test Loss: 1.085 Test Acc: 0.896
Validation loss decreased (-0.829617 --> -0.896285).  Saving model ...
Epoch: 9 cost time: 0.6535618305206299
Epoch: 9, Steps: 2 | Train Loss: 1.032 Vali Loss: 0.956 Vali Acc: 0.926 Test Loss: 0.956 Test Acc: 0.926
Validation loss decreased (-0.896285 --> -0.925916).  Saving model ...
Epoch: 10 cost time: 0.6466319561004639
Epoch: 10, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.839 Vali Acc: 0.937 Test Loss: 0.839 Test Acc: 0.937
Validation loss decreased (-0.925916 --> -0.937029).  Saving model ...
Epoch: 11 cost time: 0.6648485660552979
Epoch: 11, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.735 Vali Acc: 0.941 Test Loss: 0.735 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940733).  Saving model ...
Epoch: 12 cost time: 0.6883013248443604
Epoch: 12, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.644 Vali Acc: 0.922 Test Loss: 0.644 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6727871894836426
Epoch: 13, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.563 Vali Acc: 0.930 Test Loss: 0.563 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7989888191223145
Epoch: 14, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.485 Vali Acc: 0.952 Test Loss: 0.485 Test Acc: 0.952
Validation loss decreased (-0.940733 --> -0.951847).  Saving model ...
Epoch: 15 cost time: 0.72829270362854
Epoch: 15, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7564902305603027
Epoch: 16, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.371 Vali Acc: 0.952 Test Loss: 0.371 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 17 cost time: 0.8370378017425537
Epoch: 17, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1320452690124512
Epoch: 18, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.704272985458374
Epoch: 19, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8366937637329102
Epoch: 20, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.739924430847168
Epoch: 21, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8135433197021484
Epoch: 22, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5559751987457275
Epoch: 23, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6106791496276855
Epoch: 24, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6804251670837402
Epoch: 25, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.937 Test Loss: 0.166 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8061447143554688
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.944 Test Loss: 0.148 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 29428230
model size : 126.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.773124933242798
Epoch: 1, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.711 Vali Acc: 0.156 Test Loss: 1.711 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.8713710308074951
Epoch: 2, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.669 Vali Acc: 0.370 Test Loss: 1.669 Test Acc: 0.370
Validation loss decreased (-0.155538 --> -0.370354).  Saving model ...
Epoch: 3 cost time: 0.6031701564788818
Epoch: 3, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.630 Vali Acc: 0.437 Test Loss: 1.630 Test Acc: 0.437
Validation loss decreased (-0.370354 --> -0.437021).  Saving model ...
Epoch: 4 cost time: 0.850440263748169
Epoch: 4, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.573 Vali Acc: 0.530 Test Loss: 1.573 Test Acc: 0.530
Validation loss decreased (-0.437021 --> -0.529614).  Saving model ...
Epoch: 5 cost time: 0.9421875476837158
Epoch: 5, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.499 Vali Acc: 0.689 Test Loss: 1.499 Test Acc: 0.689
Validation loss decreased (-0.529614 --> -0.688874).  Saving model ...
Epoch: 6 cost time: 0.6729154586791992
Epoch: 6, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.412 Vali Acc: 0.719 Test Loss: 1.412 Test Acc: 0.719
Validation loss decreased (-0.688874 --> -0.718504).  Saving model ...
Epoch: 7 cost time: 0.8304362297058105
Epoch: 7, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.318 Vali Acc: 0.752 Test Loss: 1.318 Test Acc: 0.752
Validation loss decreased (-0.718504 --> -0.751839).  Saving model ...
Epoch: 8 cost time: 0.663097620010376
Epoch: 8, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.221 Vali Acc: 0.785 Test Loss: 1.221 Test Acc: 0.785
Validation loss decreased (-0.751839 --> -0.785173).  Saving model ...
Epoch: 9 cost time: 0.6813759803771973
Epoch: 9, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.121 Vali Acc: 0.800 Test Loss: 1.121 Test Acc: 0.800
Validation loss decreased (-0.785173 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 0.7214221954345703
Epoch: 10, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.022 Vali Acc: 0.819 Test Loss: 1.022 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818508).  Saving model ...
Epoch: 11 cost time: 0.7649710178375244
Epoch: 11, Steps: 2 | Train Loss: 0.915 Vali Loss: 0.922 Vali Acc: 0.841 Test Loss: 0.922 Test Acc: 0.841
Validation loss decreased (-0.818508 --> -0.840732).  Saving model ...
Epoch: 12 cost time: 0.7440977096557617
Epoch: 12, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.822 Vali Acc: 0.863 Test Loss: 0.822 Test Acc: 0.863
Validation loss decreased (-0.840732 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.5675909519195557
Epoch: 13, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.729 Vali Acc: 0.889 Test Loss: 0.729 Test Acc: 0.889
Validation loss decreased (-0.862955 --> -0.888882).  Saving model ...
Epoch: 14 cost time: 0.6672446727752686
Epoch: 14, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.644 Vali Acc: 0.911 Test Loss: 0.644 Test Acc: 0.911
Validation loss decreased (-0.888882 --> -0.911105).  Saving model ...
Epoch: 15 cost time: 0.6266632080078125
Epoch: 15, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.569 Vali Acc: 0.915 Test Loss: 0.569 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 16 cost time: 0.7972991466522217
Epoch: 16, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.505 Vali Acc: 0.919 Test Loss: 0.505 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 17 cost time: 0.6669909954071045
Epoch: 17, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.451 Vali Acc: 0.911 Test Loss: 0.451 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6754472255706787
Epoch: 18, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.400 Vali Acc: 0.915 Test Loss: 0.400 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7236428260803223
Epoch: 19, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.360 Vali Acc: 0.919 Test Loss: 0.360 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.7639718055725098
Epoch: 20, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.5928876399993896
Epoch: 21, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.6997590065002441
Epoch: 22, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.6825635433197021
Epoch: 23, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.8306071758270264
Epoch: 24, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7311878204345703
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6452183723449707
Epoch: 26, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.209 Vali Acc: 0.915 Test Loss: 0.209 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6470646858215332
Epoch: 27, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 28 cost time: 0.732694149017334
Epoch: 28, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
Validation loss decreased (-0.929628 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.6999320983886719
Epoch: 29, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.937 Test Loss: 0.164 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.848294734954834
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.7035579681396484
Epoch: 31, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.74967360496521
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.937 Test Loss: 0.157 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9134392738342285
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.933 Test Loss: 0.159 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7684676647186279
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.933 Test Loss: 0.163 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6413364410400391
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8884973526000977
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9385061264038086
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.926 Test Loss: 0.179 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.838982105255127
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6744654178619385
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8224513530731201
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6673030853271484
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 29360646
model size : 126.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.312432050704956
Epoch: 1, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.804 Vali Acc: 0.207 Test Loss: 1.804 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.7942228317260742
Epoch: 2, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.762 Vali Acc: 0.248 Test Loss: 1.762 Test Acc: 0.248
Validation loss decreased (-0.207389 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 0.755866527557373
Epoch: 3, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.714 Vali Acc: 0.319 Test Loss: 1.714 Test Acc: 0.319
Validation loss decreased (-0.248131 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.8839187622070312
Epoch: 4, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.560 Vali Acc: 0.370 Test Loss: 1.560 Test Acc: 0.370
Validation loss decreased (-0.318501 --> -0.370355).  Saving model ...
Epoch: 5 cost time: 0.7058007717132568
Epoch: 5, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.372 Vali Acc: 0.574 Test Loss: 1.372 Test Acc: 0.574
Validation loss decreased (-0.370355 --> -0.574060).  Saving model ...
Epoch: 6 cost time: 0.6924538612365723
Epoch: 6, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.188 Vali Acc: 0.815 Test Loss: 1.188 Test Acc: 0.815
Validation loss decreased (-0.574060 --> -0.814803).  Saving model ...
Epoch: 7 cost time: 0.8224010467529297
Epoch: 7, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.036 Vali Acc: 0.733 Test Loss: 1.036 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7494261264801025
Epoch: 8, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.879 Vali Acc: 0.811 Test Loss: 0.879 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9744529724121094
Epoch: 9, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.736 Vali Acc: 0.904 Test Loss: 0.736 Test Acc: 0.904
Validation loss decreased (-0.814803 --> -0.903696).  Saving model ...
Epoch: 10 cost time: 1.0536911487579346
Epoch: 10, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.625 Vali Acc: 0.919 Test Loss: 0.625 Test Acc: 0.919
Validation loss decreased (-0.903696 --> -0.918512).  Saving model ...
Epoch: 11 cost time: 0.7082438468933105
Epoch: 11, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.543 Vali Acc: 0.904 Test Loss: 0.543 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8128795623779297
Epoch: 12, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.467 Vali Acc: 0.915 Test Loss: 0.467 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.92616868019104
Epoch: 13, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918514).  Saving model ...
Epoch: 14 cost time: 0.7478532791137695
Epoch: 14, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.345 Vali Acc: 0.922 Test Loss: 0.345 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 1.0976016521453857
Epoch: 15, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.6729526519775391
Epoch: 16, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7396800518035889
Epoch: 17, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 18 cost time: 0.7578599452972412
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.929627 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.877166748046875
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.8943006992340088
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.7497086524963379
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.852571964263916
Epoch: 22, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7599325180053711
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7467532157897949
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7314531803131104
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8420460224151611
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7309126853942871
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.610558032989502
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6777558326721191
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7056045532226562
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 29621766
model size : 127.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0808677673339844
Epoch: 1, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.871 Vali Acc: 0.015 Test Loss: 1.871 Test Acc: 0.015
Validation loss decreased (inf --> -0.014796).  Saving model ...
Epoch: 2 cost time: 0.5846061706542969
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.822 Vali Acc: 0.204 Test Loss: 1.822 Test Acc: 0.204
Validation loss decreased (-0.014796 --> -0.203685).  Saving model ...
Epoch: 3 cost time: 0.6830496788024902
Epoch: 3, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.776 Vali Acc: 0.322 Test Loss: 1.776 Test Acc: 0.322
Validation loss decreased (-0.203685 --> -0.322204).  Saving model ...
Epoch: 4 cost time: 0.6738419532775879
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.688 Vali Acc: 0.426 Test Loss: 1.688 Test Acc: 0.426
Validation loss decreased (-0.322204 --> -0.425909).  Saving model ...
Epoch: 5 cost time: 0.5657544136047363
Epoch: 5, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.577 Vali Acc: 0.604 Test Loss: 1.577 Test Acc: 0.604
Validation loss decreased (-0.425909 --> -0.603688).  Saving model ...
Epoch: 6 cost time: 0.6949911117553711
Epoch: 6, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.450 Vali Acc: 0.659 Test Loss: 1.450 Test Acc: 0.659
Validation loss decreased (-0.603688 --> -0.659245).  Saving model ...
Epoch: 7 cost time: 0.7451777458190918
Epoch: 7, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.315 Vali Acc: 0.830 Test Loss: 1.315 Test Acc: 0.830
Validation loss decreased (-0.659245 --> -0.829616).  Saving model ...
Epoch: 8 cost time: 0.6573271751403809
Epoch: 8, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.183 Vali Acc: 0.867 Test Loss: 1.183 Test Acc: 0.867
Validation loss decreased (-0.829616 --> -0.866655).  Saving model ...
Epoch: 9 cost time: 0.7795696258544922
Epoch: 9, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.057 Vali Acc: 0.859 Test Loss: 1.057 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8122990131378174
Epoch: 10, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.935 Vali Acc: 0.904 Test Loss: 0.935 Test Acc: 0.904
Validation loss decreased (-0.866655 --> -0.903694).  Saving model ...
Epoch: 11 cost time: 0.7187848091125488
Epoch: 11, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.829 Vali Acc: 0.900 Test Loss: 0.829 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6577126979827881
Epoch: 12, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.730 Vali Acc: 0.926 Test Loss: 0.730 Test Acc: 0.926
Validation loss decreased (-0.903694 --> -0.925919).  Saving model ...
Epoch: 13 cost time: 0.7834556102752686
Epoch: 13, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.644 Vali Acc: 0.926 Test Loss: 0.644 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925919).  Saving model ...
Epoch: 14 cost time: 0.6181306838989258
Epoch: 14, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.564 Vali Acc: 0.919 Test Loss: 0.564 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7013704776763916
Epoch: 15, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.493 Vali Acc: 0.926 Test Loss: 0.493 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.8296794891357422
Epoch: 16, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.435 Vali Acc: 0.922 Test Loss: 0.435 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9505481719970703
Epoch: 17, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 18 cost time: 0.5847194194793701
Epoch: 18, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.340 Vali Acc: 0.937 Test Loss: 0.340 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937034).  Saving model ...
Epoch: 19 cost time: 0.7057206630706787
Epoch: 19, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7641451358795166
Epoch: 20, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6967487335205078
Epoch: 21, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8882136344909668
Epoch: 22, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7211880683898926
Epoch: 23, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7583932876586914
Epoch: 24, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5918643474578857
Epoch: 25, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.697953462600708
Epoch: 26, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7538044452667236
Epoch: 27, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8233695030212402
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 29431302
model size : 126.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.048750400543213
Epoch: 1, Steps: 2 | Train Loss: 1.923 Vali Loss: 1.829 Vali Acc: 0.122 Test Loss: 1.829 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.7190260887145996
Epoch: 2, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.793 Vali Acc: 0.163 Test Loss: 1.793 Test Acc: 0.163
Validation loss decreased (-0.122204 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.8435232639312744
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.760 Vali Acc: 0.248 Test Loss: 1.760 Test Acc: 0.248
Validation loss decreased (-0.162945 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.5730819702148438
Epoch: 4, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.712 Vali Acc: 0.378 Test Loss: 1.712 Test Acc: 0.378
Validation loss decreased (-0.248131 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 0.62457275390625
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.652 Vali Acc: 0.456 Test Loss: 1.652 Test Acc: 0.456
Validation loss decreased (-0.377761 --> -0.455539).  Saving model ...
Epoch: 6 cost time: 0.6225063800811768
Epoch: 6, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.584 Vali Acc: 0.548 Test Loss: 1.584 Test Acc: 0.548
Validation loss decreased (-0.455539 --> -0.548132).  Saving model ...
Epoch: 7 cost time: 0.6575899124145508
Epoch: 7, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.510 Vali Acc: 0.652 Test Loss: 1.510 Test Acc: 0.652
Validation loss decreased (-0.548132 --> -0.651837).  Saving model ...
Epoch: 8 cost time: 0.6780581474304199
Epoch: 8, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.429 Vali Acc: 0.715 Test Loss: 1.429 Test Acc: 0.715
Validation loss decreased (-0.651837 --> -0.714801).  Saving model ...
Epoch: 9 cost time: 0.8409826755523682
Epoch: 9, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.345 Vali Acc: 0.785 Test Loss: 1.345 Test Acc: 0.785
Validation loss decreased (-0.714801 --> -0.785172).  Saving model ...
Epoch: 10 cost time: 0.7651145458221436
Epoch: 10, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.259 Vali Acc: 0.822 Test Loss: 1.259 Test Acc: 0.822
Validation loss decreased (-0.785172 --> -0.822210).  Saving model ...
Epoch: 11 cost time: 0.728386402130127
Epoch: 11, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.172 Vali Acc: 0.848 Test Loss: 1.172 Test Acc: 0.848
Validation loss decreased (-0.822210 --> -0.848136).  Saving model ...
Epoch: 12 cost time: 0.6976315975189209
Epoch: 12, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.085 Vali Acc: 0.870 Test Loss: 1.085 Test Acc: 0.870
Validation loss decreased (-0.848136 --> -0.870360).  Saving model ...
Epoch: 13 cost time: 0.7133424282073975
Epoch: 13, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.000 Vali Acc: 0.867 Test Loss: 1.000 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9912042617797852
Epoch: 14, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.914 Vali Acc: 0.870 Test Loss: 0.914 Test Acc: 0.870
Validation loss decreased (-0.870360 --> -0.870361).  Saving model ...
Epoch: 15 cost time: 0.5766763687133789
Epoch: 15, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.830 Vali Acc: 0.878 Test Loss: 0.830 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 16 cost time: 0.7968249320983887
Epoch: 16, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888881).  Saving model ...
Epoch: 17 cost time: 0.6750078201293945
Epoch: 17, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.671 Vali Acc: 0.911 Test Loss: 0.671 Test Acc: 0.911
Validation loss decreased (-0.888881 --> -0.911104).  Saving model ...
Epoch: 18 cost time: 0.828179121017456
Epoch: 18, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.600 Vali Acc: 0.919 Test Loss: 0.600 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918513).  Saving model ...
Epoch: 19 cost time: 0.6814792156219482
Epoch: 19, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.536 Vali Acc: 0.930 Test Loss: 0.536 Test Acc: 0.930
Validation loss decreased (-0.918513 --> -0.929624).  Saving model ...
Epoch: 20 cost time: 0.7051842212677002
Epoch: 20, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.482 Vali Acc: 0.919 Test Loss: 0.482 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6162075996398926
Epoch: 21, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.433 Vali Acc: 0.919 Test Loss: 0.433 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7111997604370117
Epoch: 22, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.386 Vali Acc: 0.926 Test Loss: 0.386 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7550227642059326
Epoch: 23, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6611380577087402
Epoch: 24, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8415086269378662
Epoch: 25, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.7542860507965088
Epoch: 26, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6081933975219727
Epoch: 27, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6793007850646973
Epoch: 28, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6929540634155273
Epoch: 29, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7186636924743652
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.7193317413330078
Epoch: 31, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.6696131229400635
Epoch: 32, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8146207332611084
Epoch: 33, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7492220401763916
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.7205696105957031
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.8090956211090088
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7008614540100098
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7125341892242432
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7505464553833008
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6832282543182373
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7779533863067627
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.7447514533996582
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6483709812164307
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6817400455474854
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6917166709899902
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.687706708908081
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6979966163635254
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7007503509521484
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.817730188369751
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7372443675994873
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 29339142
model size : 126.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6801350116729736
Epoch: 1, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.768 Vali Acc: 0.311 Test Loss: 1.768 Test Acc: 0.311
Validation loss decreased (inf --> -0.311093).  Saving model ...
Epoch: 2 cost time: 0.7850234508514404
Epoch: 2, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.664 Vali Acc: 0.389 Test Loss: 1.664 Test Acc: 0.389
Validation loss decreased (-0.311093 --> -0.388872).  Saving model ...
Epoch: 3 cost time: 0.631669282913208
Epoch: 3, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.590 Vali Acc: 0.467 Test Loss: 1.590 Test Acc: 0.467
Validation loss decreased (-0.388872 --> -0.466651).  Saving model ...
Epoch: 4 cost time: 0.8431928157806396
Epoch: 4, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.505 Vali Acc: 0.589 Test Loss: 1.505 Test Acc: 0.589
Validation loss decreased (-0.466651 --> -0.588874).  Saving model ...
Epoch: 5 cost time: 0.5473926067352295
Epoch: 5, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.398 Vali Acc: 0.711 Test Loss: 1.398 Test Acc: 0.711
Validation loss decreased (-0.588874 --> -0.711097).  Saving model ...
Epoch: 6 cost time: 0.7192533016204834
Epoch: 6, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.281 Vali Acc: 0.763 Test Loss: 1.281 Test Acc: 0.763
Validation loss decreased (-0.711097 --> -0.762950).  Saving model ...
Epoch: 7 cost time: 0.6692347526550293
Epoch: 7, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.164 Vali Acc: 0.778 Test Loss: 1.164 Test Acc: 0.778
Validation loss decreased (-0.762950 --> -0.777766).  Saving model ...
Epoch: 8 cost time: 0.6885008811950684
Epoch: 8, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.049 Vali Acc: 0.789 Test Loss: 1.049 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788878).  Saving model ...
Epoch: 9 cost time: 0.8042325973510742
Epoch: 9, Steps: 2 | Train Loss: 0.993 Vali Loss: 0.938 Vali Acc: 0.837 Test Loss: 0.938 Test Acc: 0.837
Validation loss decreased (-0.788878 --> -0.837028).  Saving model ...
Epoch: 10 cost time: 0.6428377628326416
Epoch: 10, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.832 Vali Acc: 0.870 Test Loss: 0.832 Test Acc: 0.870
Validation loss decreased (-0.837028 --> -0.870362).  Saving model ...
Epoch: 11 cost time: 0.8585283756256104
Epoch: 11, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.732 Vali Acc: 0.900 Test Loss: 0.732 Test Acc: 0.900
Validation loss decreased (-0.870362 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.7440578937530518
Epoch: 12, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.639 Vali Acc: 0.904 Test Loss: 0.639 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 13 cost time: 0.6376636028289795
Epoch: 13, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.559 Vali Acc: 0.904 Test Loss: 0.559 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 14 cost time: 0.6786754131317139
Epoch: 14, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.498 Vali Acc: 0.881 Test Loss: 0.498 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7418005466461182
Epoch: 15, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.436 Vali Acc: 0.893 Test Loss: 0.436 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6346502304077148
Epoch: 16, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.379 Vali Acc: 0.922 Test Loss: 0.379 Test Acc: 0.922
Validation loss decreased (-0.903698 --> -0.922218).  Saving model ...
Epoch: 17 cost time: 0.710120677947998
Epoch: 17, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.347 Vali Acc: 0.915 Test Loss: 0.347 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8160951137542725
Epoch: 18, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.9011712074279785
Epoch: 19, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5920305252075195
Epoch: 20, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6686160564422607
Epoch: 21, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7113258838653564
Epoch: 22, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.221 Vali Acc: 0.915 Test Loss: 0.221 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7838034629821777
Epoch: 23, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7304551601409912
Epoch: 24, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929628).  Saving model ...
Epoch: 25 cost time: 0.8115599155426025
Epoch: 25, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 26 cost time: 0.8089480400085449
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.778353214263916
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.7459218502044678
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7052834033966064
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9111337661743164
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7712452411651611
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7093420028686523
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.7857770919799805
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.7783255577087402
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.7603838443756104
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7691869735717773
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.759979248046875
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6319630146026611
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7131316661834717
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7092282772064209
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7514746189117432
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6756134033203125
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6255512237548828
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7228102684020996
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 29440518
model size : 126.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.577038526535034
Epoch: 1, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.700 Vali Acc: 0.256 Test Loss: 1.700 Test Acc: 0.256
Validation loss decreased (inf --> -0.255539).  Saving model ...
Epoch: 2 cost time: 0.7493534088134766
Epoch: 2, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.623 Vali Acc: 0.389 Test Loss: 1.623 Test Acc: 0.389
Validation loss decreased (-0.255539 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 0.7031295299530029
Epoch: 3, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.565 Vali Acc: 0.600 Test Loss: 1.565 Test Acc: 0.600
Validation loss decreased (-0.388873 --> -0.599984).  Saving model ...
Epoch: 4 cost time: 0.6775012016296387
Epoch: 4, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.504 Vali Acc: 0.648 Test Loss: 1.504 Test Acc: 0.648
Validation loss decreased (-0.599984 --> -0.648133).  Saving model ...
Epoch: 5 cost time: 0.6160194873809814
Epoch: 5, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.429 Vali Acc: 0.744 Test Loss: 1.429 Test Acc: 0.744
Validation loss decreased (-0.648133 --> -0.744430).  Saving model ...
Epoch: 6 cost time: 0.6349437236785889
Epoch: 6, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.344 Vali Acc: 0.793 Test Loss: 1.344 Test Acc: 0.793
Validation loss decreased (-0.744430 --> -0.792579).  Saving model ...
Epoch: 7 cost time: 0.7381024360656738
Epoch: 7, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.250 Vali Acc: 0.837 Test Loss: 1.250 Test Acc: 0.837
Validation loss decreased (-0.792579 --> -0.837025).  Saving model ...
Epoch: 8 cost time: 0.6372518539428711
Epoch: 8, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.151 Vali Acc: 0.863 Test Loss: 1.151 Test Acc: 0.863
Validation loss decreased (-0.837025 --> -0.862951).  Saving model ...
Epoch: 9 cost time: 0.7065966129302979
Epoch: 9, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.050 Vali Acc: 0.867 Test Loss: 1.050 Test Acc: 0.867
Validation loss decreased (-0.862951 --> -0.866656).  Saving model ...
Epoch: 10 cost time: 0.8150761127471924
Epoch: 10, Steps: 2 | Train Loss: 0.982 Vali Loss: 0.952 Vali Acc: 0.881 Test Loss: 0.952 Test Acc: 0.881
Validation loss decreased (-0.866656 --> -0.881472).  Saving model ...
Epoch: 11 cost time: 0.635455846786499
Epoch: 11, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.860 Vali Acc: 0.885 Test Loss: 0.860 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 0.7211623191833496
Epoch: 12, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.773 Vali Acc: 0.900 Test Loss: 0.773 Test Acc: 0.900
Validation loss decreased (-0.885177 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 0.738762378692627
Epoch: 13, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.691 Vali Acc: 0.915 Test Loss: 0.691 Test Acc: 0.915
Validation loss decreased (-0.899992 --> -0.914808).  Saving model ...
Epoch: 14 cost time: 0.8324997425079346
Epoch: 14, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.617 Vali Acc: 0.904 Test Loss: 0.617 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7455704212188721
Epoch: 15, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.551 Vali Acc: 0.904 Test Loss: 0.551 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7701148986816406
Epoch: 16, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.491 Vali Acc: 0.919 Test Loss: 0.491 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918514).  Saving model ...
Epoch: 17 cost time: 0.7211716175079346
Epoch: 17, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.441 Vali Acc: 0.930 Test Loss: 0.441 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 0.833453893661499
Epoch: 18, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.391 Vali Acc: 0.922 Test Loss: 0.391 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6912963390350342
Epoch: 19, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8077201843261719
Epoch: 20, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929627).  Saving model ...
Epoch: 21 cost time: 0.8192837238311768
Epoch: 21, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.6320197582244873
Epoch: 22, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.263 Vali Acc: 0.915 Test Loss: 0.263 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6380584239959717
Epoch: 23, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.9736666679382324
Epoch: 24, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.9171183109283447
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.8233511447906494
Epoch: 26, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.808342695236206
Epoch: 27, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.6519408226013184
Epoch: 28, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.7510108947753906
Epoch: 29, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.156 Vali Acc: 0.933 Test Loss: 0.156 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7033486366271973
Epoch: 30, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.930 Test Loss: 0.155 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.804126501083374
Epoch: 31, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.930 Test Loss: 0.160 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6362452507019043
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.933 Test Loss: 0.158 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7841091156005859
Epoch: 33, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.937 Test Loss: 0.156 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7542695999145508
Epoch: 34, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.941 Test Loss: 0.158 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.6330008506774902
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8275561332702637
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7737910747528076
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9054286479949951
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.758216142654419
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7393178939819336
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8528528213500977
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9466619491577148
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8359658718109131
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.150705099105835
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 29379078
model size : 126.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.471971035003662
Epoch: 1, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.834 Vali Acc: 0.167 Test Loss: 1.834 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.65061354637146
Epoch: 2, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.759 Vali Acc: 0.248 Test Loss: 1.759 Test Acc: 0.248
Validation loss decreased (-0.166648 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 0.6238763332366943
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.710 Vali Acc: 0.267 Test Loss: 1.710 Test Acc: 0.267
Validation loss decreased (-0.248131 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 0.669802188873291
Epoch: 4, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.664 Vali Acc: 0.359 Test Loss: 1.664 Test Acc: 0.359
Validation loss decreased (-0.266650 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.7659482955932617
Epoch: 5, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.606 Vali Acc: 0.493 Test Loss: 1.606 Test Acc: 0.493
Validation loss decreased (-0.359243 --> -0.492577).  Saving model ...
Epoch: 6 cost time: 0.5391871929168701
Epoch: 6, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.541 Vali Acc: 0.611 Test Loss: 1.541 Test Acc: 0.611
Validation loss decreased (-0.492577 --> -0.611096).  Saving model ...
Epoch: 7 cost time: 0.740020751953125
Epoch: 7, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.472 Vali Acc: 0.681 Test Loss: 1.472 Test Acc: 0.681
Validation loss decreased (-0.611096 --> -0.681467).  Saving model ...
Epoch: 8 cost time: 0.7304844856262207
Epoch: 8, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.398 Vali Acc: 0.719 Test Loss: 1.398 Test Acc: 0.719
Validation loss decreased (-0.681467 --> -0.718505).  Saving model ...
Epoch: 9 cost time: 0.6754519939422607
Epoch: 9, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.316 Vali Acc: 0.800 Test Loss: 1.316 Test Acc: 0.800
Validation loss decreased (-0.718505 --> -0.799987).  Saving model ...
Epoch: 10 cost time: 0.682722806930542
Epoch: 10, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.232 Vali Acc: 0.841 Test Loss: 1.232 Test Acc: 0.841
Validation loss decreased (-0.799987 --> -0.840728).  Saving model ...
Epoch: 11 cost time: 0.8953189849853516
Epoch: 11, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.142 Vali Acc: 0.852 Test Loss: 1.142 Test Acc: 0.852
Validation loss decreased (-0.840728 --> -0.851840).  Saving model ...
Epoch: 12 cost time: 0.6846497058868408
Epoch: 12, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.049 Vali Acc: 0.885 Test Loss: 1.049 Test Acc: 0.885
Validation loss decreased (-0.851840 --> -0.885175).  Saving model ...
Epoch: 13 cost time: 0.6548762321472168
Epoch: 13, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.959 Vali Acc: 0.911 Test Loss: 0.959 Test Acc: 0.911
Validation loss decreased (-0.885175 --> -0.911102).  Saving model ...
Epoch: 14 cost time: 0.6406204700469971
Epoch: 14, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.872 Vali Acc: 0.919 Test Loss: 0.872 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918510).  Saving model ...
Epoch: 15 cost time: 0.5838356018066406
Epoch: 15, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.791 Vali Acc: 0.922 Test Loss: 0.791 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922214).  Saving model ...
Epoch: 16 cost time: 0.6617817878723145
Epoch: 16, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.714 Vali Acc: 0.930 Test Loss: 0.714 Test Acc: 0.930
Validation loss decreased (-0.922214 --> -0.929622).  Saving model ...
Epoch: 17 cost time: 0.6685593128204346
Epoch: 17, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.642 Vali Acc: 0.937 Test Loss: 0.642 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937031).  Saving model ...
Epoch: 18 cost time: 0.7578206062316895
Epoch: 18, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.575 Vali Acc: 0.933 Test Loss: 0.575 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6363425254821777
Epoch: 19, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.514 Vali Acc: 0.930 Test Loss: 0.514 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.621997594833374
Epoch: 20, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.459 Vali Acc: 0.933 Test Loss: 0.459 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6329619884490967
Epoch: 21, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.411 Vali Acc: 0.941 Test Loss: 0.411 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940737).  Saving model ...
Epoch: 22 cost time: 0.7344679832458496
Epoch: 22, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.370 Vali Acc: 0.937 Test Loss: 0.370 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6740269660949707
Epoch: 23, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.707383394241333
Epoch: 24, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.7871339321136475
Epoch: 25, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6967692375183105
Epoch: 26, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5906813144683838
Epoch: 27, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6256999969482422
Epoch: 28, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.7876572608947754
Epoch: 29, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.7289812564849854
Epoch: 30, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.7040081024169922
Epoch: 31, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6759405136108398
Epoch: 32, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6504430770874023
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.937 Test Loss: 0.166 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5414667129516602
Epoch: 34, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6115081310272217
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7993621826171875
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7288553714752197
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6792855262756348
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.933 Test Loss: 0.168 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.604543924331665
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6999242305755615
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 29329926
model size : 126.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7598109245300293
Epoch: 1, Steps: 2 | Train Loss: 2.026 Vali Loss: 1.922 Vali Acc: 0.111 Test Loss: 1.922 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 0.7379209995269775
Epoch: 2, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.861 Vali Acc: 0.122 Test Loss: 1.861 Test Acc: 0.122
Validation loss decreased (-0.111092 --> -0.122204).  Saving model ...
Epoch: 3 cost time: 0.646275520324707
Epoch: 3, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.818 Vali Acc: 0.115 Test Loss: 1.818 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6032261848449707
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.731 Vali Acc: 0.233 Test Loss: 1.731 Test Acc: 0.233
Validation loss decreased (-0.122204 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 0.6887733936309814
Epoch: 5, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.621 Vali Acc: 0.367 Test Loss: 1.621 Test Acc: 0.367
Validation loss decreased (-0.233316 --> -0.366650).  Saving model ...
Epoch: 6 cost time: 0.6108572483062744
Epoch: 6, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.494 Vali Acc: 0.663 Test Loss: 1.494 Test Acc: 0.663
Validation loss decreased (-0.366650 --> -0.662948).  Saving model ...
Epoch: 7 cost time: 0.6967146396636963
Epoch: 7, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.356 Vali Acc: 0.859 Test Loss: 1.356 Test Acc: 0.859
Validation loss decreased (-0.662948 --> -0.859246).  Saving model ...
Epoch: 8 cost time: 0.8099677562713623
Epoch: 8, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.220 Vali Acc: 0.852 Test Loss: 1.220 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7339441776275635
Epoch: 9, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.091 Vali Acc: 0.830 Test Loss: 1.091 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9597411155700684
Epoch: 10, Steps: 2 | Train Loss: 0.970 Vali Loss: 0.962 Vali Acc: 0.859 Test Loss: 0.962 Test Acc: 0.859
Validation loss decreased (-0.859246 --> -0.859250).  Saving model ...
Epoch: 11 cost time: 0.6446058750152588
Epoch: 11, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.837 Vali Acc: 0.911 Test Loss: 0.837 Test Acc: 0.911
Validation loss decreased (-0.859250 --> -0.911103).  Saving model ...
Epoch: 12 cost time: 0.7281038761138916
Epoch: 12, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.722 Vali Acc: 0.889 Test Loss: 0.722 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8608992099761963
Epoch: 13, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.624 Vali Acc: 0.878 Test Loss: 0.624 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6260285377502441
Epoch: 14, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7720329761505127
Epoch: 15, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.453 Vali Acc: 0.926 Test Loss: 0.453 Test Acc: 0.926
Validation loss decreased (-0.911103 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.7573904991149902
Epoch: 16, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.395 Vali Acc: 0.922 Test Loss: 0.395 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7998943328857422
Epoch: 17, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.343 Vali Acc: 0.926 Test Loss: 0.343 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 18 cost time: 0.7048394680023193
Epoch: 18, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.297 Vali Acc: 0.915 Test Loss: 0.297 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6846976280212402
Epoch: 19, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.266 Vali Acc: 0.911 Test Loss: 0.266 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7273187637329102
Epoch: 20, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.237 Vali Acc: 0.907 Test Loss: 0.237 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7447664737701416
Epoch: 21, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6766681671142578
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.201 Vali Acc: 0.919 Test Loss: 0.201 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7785828113555908
Epoch: 23, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.206 Vali Acc: 0.911 Test Loss: 0.206 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8504841327667236
Epoch: 24, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8668794631958008
Epoch: 25, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6789910793304443
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7311801910400391
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 29443590
model size : 126.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9461143016815186
Epoch: 1, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.849 Vali Acc: 0.174 Test Loss: 1.849 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.7441227436065674
Epoch: 2, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.815 Vali Acc: 0.222 Test Loss: 1.815 Test Acc: 0.222
Validation loss decreased (-0.174056 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.5968856811523438
Epoch: 3, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.775 Vali Acc: 0.267 Test Loss: 1.775 Test Acc: 0.267
Validation loss decreased (-0.222204 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.682835578918457
Epoch: 4, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.711 Vali Acc: 0.322 Test Loss: 1.711 Test Acc: 0.322
Validation loss decreased (-0.266649 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.706946849822998
Epoch: 5, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.632 Vali Acc: 0.459 Test Loss: 1.632 Test Acc: 0.459
Validation loss decreased (-0.322205 --> -0.459243).  Saving model ...
Epoch: 6 cost time: 0.817918062210083
Epoch: 6, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.547 Vali Acc: 0.533 Test Loss: 1.547 Test Acc: 0.533
Validation loss decreased (-0.459243 --> -0.533318).  Saving model ...
Epoch: 7 cost time: 0.726679801940918
Epoch: 7, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.459 Vali Acc: 0.615 Test Loss: 1.459 Test Acc: 0.615
Validation loss decreased (-0.533318 --> -0.614800).  Saving model ...
Epoch: 8 cost time: 0.6636037826538086
Epoch: 8, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.361 Vali Acc: 0.781 Test Loss: 1.361 Test Acc: 0.781
Validation loss decreased (-0.614800 --> -0.781468).  Saving model ...
Epoch: 9 cost time: 0.7772271633148193
Epoch: 9, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.254 Vali Acc: 0.841 Test Loss: 1.254 Test Acc: 0.841
Validation loss decreased (-0.781468 --> -0.840728).  Saving model ...
Epoch: 10 cost time: 0.7017242908477783
Epoch: 10, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.147 Vali Acc: 0.878 Test Loss: 1.147 Test Acc: 0.878
Validation loss decreased (-0.840728 --> -0.877766).  Saving model ...
Epoch: 11 cost time: 0.6901092529296875
Epoch: 11, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.046 Vali Acc: 0.878 Test Loss: 1.046 Test Acc: 0.878
Validation loss decreased (-0.877766 --> -0.877767).  Saving model ...
Epoch: 12 cost time: 0.6915643215179443
Epoch: 12, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.947 Vali Acc: 0.874 Test Loss: 0.947 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5506951808929443
Epoch: 13, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.851 Vali Acc: 0.867 Test Loss: 0.851 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7363033294677734
Epoch: 14, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.753 Vali Acc: 0.889 Test Loss: 0.753 Test Acc: 0.889
Validation loss decreased (-0.877767 --> -0.888881).  Saving model ...
Epoch: 15 cost time: 0.672229528427124
Epoch: 15, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.665 Vali Acc: 0.896 Test Loss: 0.665 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896290).  Saving model ...
Epoch: 16 cost time: 0.6598138809204102
Epoch: 16, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.582 Vali Acc: 0.911 Test Loss: 0.582 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 0.5528824329376221
Epoch: 17, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.509 Vali Acc: 0.911 Test Loss: 0.509 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.6648774147033691
Epoch: 18, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.448 Vali Acc: 0.919 Test Loss: 0.448 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.7050964832305908
Epoch: 19, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.391 Vali Acc: 0.922 Test Loss: 0.391 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 0.690854549407959
Epoch: 20, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.8910160064697266
Epoch: 21, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6391153335571289
Epoch: 22, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 0.7123911380767822
Epoch: 23, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6685781478881836
Epoch: 24, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.644803524017334
Epoch: 25, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.230 Vali Acc: 0.907 Test Loss: 0.230 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6408367156982422
Epoch: 26, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.904 Test Loss: 0.223 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6458828449249268
Epoch: 27, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.904 Test Loss: 0.227 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.707324743270874
Epoch: 28, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8075037002563477
Epoch: 29, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.257 Vali Acc: 0.893 Test Loss: 0.257 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6312611103057861
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.896 Test Loss: 0.294 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.591801643371582
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.893 Test Loss: 0.302 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6271853446960449
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.290 Vali Acc: 0.896 Test Loss: 0.290 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 29382150
model size : 126.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4960570335388184
Epoch: 1, Steps: 2 | Train Loss: 1.996 Vali Loss: 1.948 Vali Acc: 0.167 Test Loss: 1.948 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6175711154937744
Epoch: 2, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.846 Vali Acc: 0.152 Test Loss: 1.846 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7936182022094727
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.799 Vali Acc: 0.170 Test Loss: 1.799 Test Acc: 0.170
Validation loss decreased (-0.166647 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 0.5917117595672607
Epoch: 4, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.760 Vali Acc: 0.293 Test Loss: 1.760 Test Acc: 0.293
Validation loss decreased (-0.170352 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.5664923191070557
Epoch: 5, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.710 Vali Acc: 0.437 Test Loss: 1.710 Test Acc: 0.437
Validation loss decreased (-0.292575 --> -0.437020).  Saving model ...
Epoch: 6 cost time: 0.6546182632446289
Epoch: 6, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.655 Vali Acc: 0.530 Test Loss: 1.655 Test Acc: 0.530
Validation loss decreased (-0.437020 --> -0.529613).  Saving model ...
Epoch: 7 cost time: 0.5674636363983154
Epoch: 7, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.596 Vali Acc: 0.604 Test Loss: 1.596 Test Acc: 0.604
Validation loss decreased (-0.529613 --> -0.603688).  Saving model ...
Epoch: 8 cost time: 0.623100996017456
Epoch: 8, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.534 Vali Acc: 0.693 Test Loss: 1.534 Test Acc: 0.693
Validation loss decreased (-0.603688 --> -0.692577).  Saving model ...
Epoch: 9 cost time: 0.6261613368988037
Epoch: 9, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.469 Vali Acc: 0.744 Test Loss: 1.469 Test Acc: 0.744
Validation loss decreased (-0.692577 --> -0.744430).  Saving model ...
Epoch: 10 cost time: 0.8071458339691162
Epoch: 10, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.397 Vali Acc: 0.770 Test Loss: 1.397 Test Acc: 0.770
Validation loss decreased (-0.744430 --> -0.770356).  Saving model ...
Epoch: 11 cost time: 0.6538581848144531
Epoch: 11, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.321 Vali Acc: 0.826 Test Loss: 1.321 Test Acc: 0.826
Validation loss decreased (-0.770356 --> -0.825913).  Saving model ...
Epoch: 12 cost time: 0.8581507205963135
Epoch: 12, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.244 Vali Acc: 0.848 Test Loss: 1.244 Test Acc: 0.848
Validation loss decreased (-0.825913 --> -0.848136).  Saving model ...
Epoch: 13 cost time: 0.8263726234436035
Epoch: 13, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.166 Vali Acc: 0.870 Test Loss: 1.166 Test Acc: 0.870
Validation loss decreased (-0.848136 --> -0.870359).  Saving model ...
Epoch: 14 cost time: 0.6617705821990967
Epoch: 14, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.087 Vali Acc: 0.893 Test Loss: 1.087 Test Acc: 0.893
Validation loss decreased (-0.870359 --> -0.892582).  Saving model ...
Epoch: 15 cost time: 0.6905138492584229
Epoch: 15, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.004 Vali Acc: 0.900 Test Loss: 1.004 Test Acc: 0.900
Validation loss decreased (-0.892582 --> -0.899990).  Saving model ...
Epoch: 16 cost time: 0.5424816608428955
Epoch: 16, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.922 Vali Acc: 0.900 Test Loss: 0.922 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899991).  Saving model ...
Epoch: 17 cost time: 0.7192671298980713
Epoch: 17, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.841 Vali Acc: 0.904 Test Loss: 0.841 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903695).  Saving model ...
Epoch: 18 cost time: 0.6768105030059814
Epoch: 18, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.759 Vali Acc: 0.907 Test Loss: 0.759 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907400).  Saving model ...
Epoch: 19 cost time: 0.6439321041107178
Epoch: 19, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.677 Vali Acc: 0.926 Test Loss: 0.677 Test Acc: 0.926
Validation loss decreased (-0.907400 --> -0.925919).  Saving model ...
Epoch: 20 cost time: 0.7327160835266113
Epoch: 20, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.601 Vali Acc: 0.915 Test Loss: 0.601 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6516358852386475
Epoch: 21, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6123270988464355
Epoch: 22, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6194231510162354
Epoch: 23, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.404 Vali Acc: 0.900 Test Loss: 0.404 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.667170524597168
Epoch: 24, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.353 Vali Acc: 0.904 Test Loss: 0.353 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7299869060516357
Epoch: 25, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6669371128082275
Epoch: 26, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 0.6542842388153076
Epoch: 27, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 28 cost time: 0.6375412940979004
Epoch: 28, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.6310772895812988
Epoch: 29, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5908622741699219
Epoch: 30, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7491867542266846
Epoch: 31, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7741835117340088
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7049741744995117
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7490038871765137
Epoch: 34, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6234254837036133
Epoch: 35, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7943181991577148
Epoch: 36, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.907 Test Loss: 0.225 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7184278964996338
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.224 Vali Acc: 0.915 Test Loss: 0.224 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6614108085632324
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 29320710
model size : 126.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.116825819015503
Epoch: 1, Steps: 2 | Train Loss: 1.982 Vali Loss: 1.861 Vali Acc: 0.159 Test Loss: 1.861 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.6235978603363037
Epoch: 2, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.788 Vali Acc: 0.204 Test Loss: 1.788 Test Acc: 0.204
Validation loss decreased (-0.159241 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.7404327392578125
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.725 Vali Acc: 0.307 Test Loss: 1.725 Test Acc: 0.307
Validation loss decreased (-0.203686 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.9550013542175293
Epoch: 4, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.631 Vali Acc: 0.415 Test Loss: 1.631 Test Acc: 0.415
Validation loss decreased (-0.307390 --> -0.414799).  Saving model ...
Epoch: 5 cost time: 0.5930347442626953
Epoch: 5, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.516 Vali Acc: 0.589 Test Loss: 1.516 Test Acc: 0.589
Validation loss decreased (-0.414799 --> -0.588874).  Saving model ...
Epoch: 6 cost time: 0.7083587646484375
Epoch: 6, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.390 Vali Acc: 0.678 Test Loss: 1.390 Test Acc: 0.678
Validation loss decreased (-0.588874 --> -0.677764).  Saving model ...
Epoch: 7 cost time: 0.6560201644897461
Epoch: 7, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.258 Vali Acc: 0.741 Test Loss: 1.258 Test Acc: 0.741
Validation loss decreased (-0.677764 --> -0.740728).  Saving model ...
Epoch: 8 cost time: 0.6568167209625244
Epoch: 8, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.131 Vali Acc: 0.767 Test Loss: 1.131 Test Acc: 0.767
Validation loss decreased (-0.740728 --> -0.766655).  Saving model ...
Epoch: 9 cost time: 0.8128652572631836
Epoch: 9, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.006 Vali Acc: 0.841 Test Loss: 1.006 Test Acc: 0.841
Validation loss decreased (-0.766655 --> -0.840731).  Saving model ...
Epoch: 10 cost time: 0.7714545726776123
Epoch: 10, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.892 Vali Acc: 0.867 Test Loss: 0.892 Test Acc: 0.867
Validation loss decreased (-0.840731 --> -0.866658).  Saving model ...
Epoch: 11 cost time: 0.7113139629364014
Epoch: 11, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.783 Vali Acc: 0.889 Test Loss: 0.783 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888881).  Saving model ...
Epoch: 12 cost time: 0.7335128784179688
Epoch: 12, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.684 Vali Acc: 0.915 Test Loss: 0.684 Test Acc: 0.915
Validation loss decreased (-0.888881 --> -0.914808).  Saving model ...
Epoch: 13 cost time: 0.5634028911590576
Epoch: 13, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.598 Vali Acc: 0.919 Test Loss: 0.598 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.7520959377288818
Epoch: 14, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.524 Vali Acc: 0.926 Test Loss: 0.524 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 15 cost time: 0.7987749576568604
Epoch: 15, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.462 Vali Acc: 0.926 Test Loss: 0.462 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.7724676132202148
Epoch: 16, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.414 Vali Acc: 0.915 Test Loss: 0.414 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.792086124420166
Epoch: 17, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.381 Vali Acc: 0.896 Test Loss: 0.381 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7033491134643555
Epoch: 18, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7210371494293213
Epoch: 19, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.60030198097229
Epoch: 20, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 21 cost time: 0.7157626152038574
Epoch: 21, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.6091845035552979
Epoch: 22, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.222 Vali Acc: 0.915 Test Loss: 0.222 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7353997230529785
Epoch: 23, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.908616304397583
Epoch: 24, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.189 Vali Acc: 0.926 Test Loss: 0.189 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7810189723968506
Epoch: 25, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7517645359039307
Epoch: 26, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.7657148838043213
Epoch: 27, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.168 Vali Acc: 0.933 Test Loss: 0.168 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6547858715057373
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.919 Test Loss: 0.190 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6091461181640625
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.907 Test Loss: 0.212 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8671474456787109
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.919 Test Loss: 0.202 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6410129070281982
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5563669204711914
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.751255989074707
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.7220239639282227
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5694177150726318
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6393404006958008
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6638400554656982
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7937488555908203
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7391183376312256
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7620012760162354
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.817626953125
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7004618644714355
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7174136638641357
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 29452806
model size : 127.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.877527952194214
Epoch: 1, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.741 Vali Acc: 0.293 Test Loss: 1.741 Test Acc: 0.293
Validation loss decreased (inf --> -0.292575).  Saving model ...
Epoch: 2 cost time: 0.6194427013397217
Epoch: 2, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.703 Vali Acc: 0.178 Test Loss: 1.703 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6471624374389648
Epoch: 3, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.670 Vali Acc: 0.233 Test Loss: 1.670 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5936455726623535
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.624 Vali Acc: 0.363 Test Loss: 1.624 Test Acc: 0.363
Validation loss decreased (-0.292575 --> -0.362947).  Saving model ...
Epoch: 5 cost time: 0.6870763301849365
Epoch: 5, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.568 Vali Acc: 0.489 Test Loss: 1.568 Test Acc: 0.489
Validation loss decreased (-0.362947 --> -0.488873).  Saving model ...
Epoch: 6 cost time: 0.7961380481719971
Epoch: 6, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.498 Vali Acc: 0.589 Test Loss: 1.498 Test Acc: 0.589
Validation loss decreased (-0.488873 --> -0.588874).  Saving model ...
Epoch: 7 cost time: 0.6403017044067383
Epoch: 7, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.420 Vali Acc: 0.681 Test Loss: 1.420 Test Acc: 0.681
Validation loss decreased (-0.588874 --> -0.681467).  Saving model ...
Epoch: 8 cost time: 0.6598529815673828
Epoch: 8, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.338 Vali Acc: 0.781 Test Loss: 1.338 Test Acc: 0.781
Validation loss decreased (-0.681467 --> -0.781468).  Saving model ...
Epoch: 9 cost time: 0.6850039958953857
Epoch: 9, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.252 Vali Acc: 0.833 Test Loss: 1.252 Test Acc: 0.833
Validation loss decreased (-0.781468 --> -0.833321).  Saving model ...
Epoch: 10 cost time: 0.6561038494110107
Epoch: 10, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.162 Vali Acc: 0.848 Test Loss: 1.162 Test Acc: 0.848
Validation loss decreased (-0.833321 --> -0.848137).  Saving model ...
Epoch: 11 cost time: 0.6606483459472656
Epoch: 11, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.071 Vali Acc: 0.859 Test Loss: 1.071 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859249).  Saving model ...
Epoch: 12 cost time: 0.7102234363555908
Epoch: 12, Steps: 2 | Train Loss: 0.955 Vali Loss: 0.980 Vali Acc: 0.859 Test Loss: 0.980 Test Acc: 0.859
Validation loss decreased (-0.859249 --> -0.859249).  Saving model ...
Epoch: 13 cost time: 0.934274435043335
Epoch: 13, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.892 Vali Acc: 0.881 Test Loss: 0.892 Test Acc: 0.881
Validation loss decreased (-0.859249 --> -0.881473).  Saving model ...
Epoch: 14 cost time: 0.7355790138244629
Epoch: 14, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.810 Vali Acc: 0.907 Test Loss: 0.810 Test Acc: 0.907
Validation loss decreased (-0.881473 --> -0.907399).  Saving model ...
Epoch: 15 cost time: 0.758824348449707
Epoch: 15, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.733 Vali Acc: 0.911 Test Loss: 0.733 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911104).  Saving model ...
Epoch: 16 cost time: 0.6337060928344727
Epoch: 16, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.663 Vali Acc: 0.933 Test Loss: 0.663 Test Acc: 0.933
Validation loss decreased (-0.911104 --> -0.933327).  Saving model ...
Epoch: 17 cost time: 0.5501792430877686
Epoch: 17, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.598 Vali Acc: 0.937 Test Loss: 0.598 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 18 cost time: 0.8001570701599121
Epoch: 18, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.534 Vali Acc: 0.937 Test Loss: 0.534 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 19 cost time: 0.8648858070373535
Epoch: 19, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.476 Vali Acc: 0.952 Test Loss: 0.476 Test Acc: 0.952
Validation loss decreased (-0.937032 --> -0.951847).  Saving model ...
Epoch: 20 cost time: 0.6483404636383057
Epoch: 20, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.422 Vali Acc: 0.944 Test Loss: 0.422 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7370121479034424
Epoch: 21, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.377 Vali Acc: 0.933 Test Loss: 0.377 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6740913391113281
Epoch: 22, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7593026161193848
Epoch: 23, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5992441177368164
Epoch: 24, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7407481670379639
Epoch: 25, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7152230739593506
Epoch: 26, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6292898654937744
Epoch: 27, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7754743099212646
Epoch: 28, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7273561954498291
Epoch: 29, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 29360646
model size : 126.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6125848293304443
Epoch: 1, Steps: 2 | Train Loss: 1.980 Vali Loss: 1.907 Vali Acc: 0.156 Test Loss: 1.907 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.6253044605255127
Epoch: 2, Steps: 2 | Train Loss: 1.951 Vali Loss: 1.837 Vali Acc: 0.137 Test Loss: 1.837 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.633286714553833
Epoch: 3, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.795 Vali Acc: 0.130 Test Loss: 1.795 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7271275520324707
Epoch: 4, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.755 Vali Acc: 0.137 Test Loss: 1.755 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6318399906158447
Epoch: 5, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.706 Vali Acc: 0.189 Test Loss: 1.706 Test Acc: 0.189
Validation loss decreased (-0.155536 --> -0.188872).  Saving model ...
Epoch: 6 cost time: 0.7401225566864014
Epoch: 6, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.652 Vali Acc: 0.333 Test Loss: 1.652 Test Acc: 0.333
Validation loss decreased (-0.188872 --> -0.333317).  Saving model ...
Epoch: 7 cost time: 0.696021318435669
Epoch: 7, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.595 Vali Acc: 0.522 Test Loss: 1.595 Test Acc: 0.522
Validation loss decreased (-0.333317 --> -0.522206).  Saving model ...
Epoch: 8 cost time: 0.6266648769378662
Epoch: 8, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.535 Vali Acc: 0.596 Test Loss: 1.535 Test Acc: 0.596
Validation loss decreased (-0.522206 --> -0.596281).  Saving model ...
Epoch: 9 cost time: 0.6453659534454346
Epoch: 9, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.470 Vali Acc: 0.685 Test Loss: 1.470 Test Acc: 0.685
Validation loss decreased (-0.596281 --> -0.685170).  Saving model ...
Epoch: 10 cost time: 0.7491848468780518
Epoch: 10, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.403 Vali Acc: 0.744 Test Loss: 1.403 Test Acc: 0.744
Validation loss decreased (-0.685170 --> -0.744430).  Saving model ...
Epoch: 11 cost time: 0.6790292263031006
Epoch: 11, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.330 Vali Acc: 0.785 Test Loss: 1.330 Test Acc: 0.785
Validation loss decreased (-0.744430 --> -0.785172).  Saving model ...
Epoch: 12 cost time: 0.8095278739929199
Epoch: 12, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.252 Vali Acc: 0.804 Test Loss: 1.252 Test Acc: 0.804
Validation loss decreased (-0.785172 --> -0.803691).  Saving model ...
Epoch: 13 cost time: 0.5833942890167236
Epoch: 13, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.175 Vali Acc: 0.841 Test Loss: 1.175 Test Acc: 0.841
Validation loss decreased (-0.803691 --> -0.840729).  Saving model ...
Epoch: 14 cost time: 0.7730815410614014
Epoch: 14, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.098 Vali Acc: 0.848 Test Loss: 1.098 Test Acc: 0.848
Validation loss decreased (-0.840729 --> -0.848137).  Saving model ...
Epoch: 15 cost time: 0.7429132461547852
Epoch: 15, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.022 Vali Acc: 0.863 Test Loss: 1.022 Test Acc: 0.863
Validation loss decreased (-0.848137 --> -0.862953).  Saving model ...
Epoch: 16 cost time: 0.7002463340759277
Epoch: 16, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.947 Vali Acc: 0.900 Test Loss: 0.947 Test Acc: 0.900
Validation loss decreased (-0.862953 --> -0.899991).  Saving model ...
Epoch: 17 cost time: 0.7551839351654053
Epoch: 17, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.874 Vali Acc: 0.919 Test Loss: 0.874 Test Acc: 0.919
Validation loss decreased (-0.899991 --> -0.918510).  Saving model ...
Epoch: 18 cost time: 0.6612329483032227
Epoch: 18, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.804 Vali Acc: 0.919 Test Loss: 0.804 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918510).  Saving model ...
Epoch: 19 cost time: 0.645982027053833
Epoch: 19, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.738 Vali Acc: 0.915 Test Loss: 0.738 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7362136840820312
Epoch: 20, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.674 Vali Acc: 0.919 Test Loss: 0.674 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918512).  Saving model ...
Epoch: 21 cost time: 0.7529892921447754
Epoch: 21, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.611 Vali Acc: 0.926 Test Loss: 0.611 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 22 cost time: 0.7081878185272217
Epoch: 22, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.551 Vali Acc: 0.915 Test Loss: 0.551 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5768947601318359
Epoch: 23, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.491 Vali Acc: 0.915 Test Loss: 0.491 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6355562210083008
Epoch: 24, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.438 Vali Acc: 0.915 Test Loss: 0.438 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0353631973266602
Epoch: 25, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.386 Vali Acc: 0.926 Test Loss: 0.386 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925922).  Saving model ...
Epoch: 26 cost time: 0.6229152679443359
Epoch: 26, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.336 Vali Acc: 0.944 Test Loss: 0.336 Test Acc: 0.944
Validation loss decreased (-0.925922 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 0.6273136138916016
Epoch: 27, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951849).  Saving model ...
Epoch: 28 cost time: 0.6817505359649658
Epoch: 28, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7024097442626953
Epoch: 29, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6330146789550781
Epoch: 30, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7132096290588379
Epoch: 31, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7737061977386475
Epoch: 32, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8635540008544922
Epoch: 33, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6517691612243652
Epoch: 34, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7741589546203613
Epoch: 35, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6455132961273193
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.171 Vali Acc: 0.930 Test Loss: 0.171 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.657780647277832
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 29323782
model size : 126.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8319385051727295
Epoch: 1, Steps: 2 | Train Loss: 2.034 Vali Loss: 1.931 Vali Acc: 0.107 Test Loss: 1.931 Test Acc: 0.107
Validation loss decreased (inf --> -0.107388).  Saving model ...
Epoch: 2 cost time: 0.6860389709472656
Epoch: 2, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.848 Vali Acc: 0.152 Test Loss: 1.848 Test Acc: 0.152
Validation loss decreased (-0.107388 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.6254382133483887
Epoch: 3, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.779 Vali Acc: 0.159 Test Loss: 1.779 Test Acc: 0.159
Validation loss decreased (-0.151833 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.7600479125976562
Epoch: 4, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.681 Vali Acc: 0.289 Test Loss: 1.681 Test Acc: 0.289
Validation loss decreased (-0.159241 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.7904248237609863
Epoch: 5, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.562 Vali Acc: 0.519 Test Loss: 1.562 Test Acc: 0.519
Validation loss decreased (-0.288872 --> -0.518503).  Saving model ...
Epoch: 6 cost time: 0.7609467506408691
Epoch: 6, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.425 Vali Acc: 0.659 Test Loss: 1.425 Test Acc: 0.659
Validation loss decreased (-0.518503 --> -0.659245).  Saving model ...
Epoch: 7 cost time: 0.7286286354064941
Epoch: 7, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.283 Vali Acc: 0.715 Test Loss: 1.283 Test Acc: 0.715
Validation loss decreased (-0.659245 --> -0.714802).  Saving model ...
Epoch: 8 cost time: 0.6547431945800781
Epoch: 8, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.147 Vali Acc: 0.778 Test Loss: 1.147 Test Acc: 0.778
Validation loss decreased (-0.714802 --> -0.777766).  Saving model ...
Epoch: 9 cost time: 0.6512701511383057
Epoch: 9, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.014 Vali Acc: 0.819 Test Loss: 1.014 Test Acc: 0.819
Validation loss decreased (-0.777766 --> -0.818508).  Saving model ...
Epoch: 10 cost time: 0.8285517692565918
Epoch: 10, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.891 Vali Acc: 0.859 Test Loss: 0.891 Test Acc: 0.859
Validation loss decreased (-0.818508 --> -0.859250).  Saving model ...
Epoch: 11 cost time: 0.7151980400085449
Epoch: 11, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.777 Vali Acc: 0.881 Test Loss: 0.777 Test Acc: 0.881
Validation loss decreased (-0.859250 --> -0.881474).  Saving model ...
Epoch: 12 cost time: 0.7850449085235596
Epoch: 12, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.682 Vali Acc: 0.878 Test Loss: 0.682 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7698318958282471
Epoch: 13, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.591 Vali Acc: 0.885 Test Loss: 0.591 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885179).  Saving model ...
Epoch: 14 cost time: 0.6713197231292725
Epoch: 14, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.511 Vali Acc: 0.907 Test Loss: 0.511 Test Acc: 0.907
Validation loss decreased (-0.885179 --> -0.907402).  Saving model ...
Epoch: 15 cost time: 0.6376111507415771
Epoch: 15, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.434 Vali Acc: 0.922 Test Loss: 0.434 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 16 cost time: 0.6151018142700195
Epoch: 16, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.7729780673980713
Epoch: 17, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.325 Vali Acc: 0.933 Test Loss: 0.325 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.7600841522216797
Epoch: 18, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7201292514801025
Epoch: 19, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6796457767486572
Epoch: 20, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6665084362030029
Epoch: 21, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.245 Vali Acc: 0.907 Test Loss: 0.245 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6742303371429443
Epoch: 22, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6719706058502197
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6748843193054199
Epoch: 24, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.907 Test Loss: 0.237 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6770985126495361
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5899536609649658
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.279 Vali Acc: 0.919 Test Loss: 0.279 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8527801036834717
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 29455878
model size : 127.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.681321382522583
Epoch: 1, Steps: 2 | Train Loss: 1.964 Vali Loss: 1.855 Vali Acc: 0.148 Test Loss: 1.855 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.681654691696167
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.796 Vali Acc: 0.233 Test Loss: 1.796 Test Acc: 0.233
Validation loss decreased (-0.148130 --> -0.233315).  Saving model ...
Epoch: 3 cost time: 0.6263730525970459
Epoch: 3, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.756 Vali Acc: 0.274 Test Loss: 1.756 Test Acc: 0.274
Validation loss decreased (-0.233315 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.5315654277801514
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.702 Vali Acc: 0.378 Test Loss: 1.702 Test Acc: 0.378
Validation loss decreased (-0.274057 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 0.7971129417419434
Epoch: 5, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.635 Vali Acc: 0.515 Test Loss: 1.635 Test Acc: 0.515
Validation loss decreased (-0.377761 --> -0.514798).  Saving model ...
Epoch: 6 cost time: 0.7276473045349121
Epoch: 6, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.559 Vali Acc: 0.607 Test Loss: 1.559 Test Acc: 0.607
Validation loss decreased (-0.514798 --> -0.607392).  Saving model ...
Epoch: 7 cost time: 0.6854748725891113
Epoch: 7, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.471 Vali Acc: 0.696 Test Loss: 1.471 Test Acc: 0.696
Validation loss decreased (-0.607392 --> -0.696282).  Saving model ...
Epoch: 8 cost time: 0.8221108913421631
Epoch: 8, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.378 Vali Acc: 0.730 Test Loss: 1.378 Test Acc: 0.730
Validation loss decreased (-0.696282 --> -0.729616).  Saving model ...
Epoch: 9 cost time: 0.8399183750152588
Epoch: 9, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.279 Vali Acc: 0.774 Test Loss: 1.279 Test Acc: 0.774
Validation loss decreased (-0.729616 --> -0.774061).  Saving model ...
Epoch: 10 cost time: 0.8386189937591553
Epoch: 10, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.179 Vali Acc: 0.811 Test Loss: 1.179 Test Acc: 0.811
Validation loss decreased (-0.774061 --> -0.811099).  Saving model ...
Epoch: 11 cost time: 0.7217321395874023
Epoch: 11, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.082 Vali Acc: 0.848 Test Loss: 1.082 Test Acc: 0.848
Validation loss decreased (-0.811099 --> -0.848137).  Saving model ...
Epoch: 12 cost time: 0.6316177845001221
Epoch: 12, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.990 Vali Acc: 0.859 Test Loss: 0.990 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859249).  Saving model ...
Epoch: 13 cost time: 0.7294683456420898
Epoch: 13, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.900 Vali Acc: 0.889 Test Loss: 0.900 Test Acc: 0.889
Validation loss decreased (-0.859249 --> -0.888880).  Saving model ...
Epoch: 14 cost time: 0.5780329704284668
Epoch: 14, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.812 Vali Acc: 0.904 Test Loss: 0.812 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903696).  Saving model ...
Epoch: 15 cost time: 0.8384239673614502
Epoch: 15, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.723 Vali Acc: 0.915 Test Loss: 0.723 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 16 cost time: 0.547964334487915
Epoch: 16, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.643 Vali Acc: 0.930 Test Loss: 0.643 Test Acc: 0.930
Validation loss decreased (-0.914808 --> -0.929623).  Saving model ...
Epoch: 17 cost time: 0.6867630481719971
Epoch: 17, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.571 Vali Acc: 0.919 Test Loss: 0.571 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6035070419311523
Epoch: 18, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.503 Vali Acc: 0.919 Test Loss: 0.503 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6239168643951416
Epoch: 19, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.448 Vali Acc: 0.907 Test Loss: 0.448 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6873335838317871
Epoch: 20, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.79970383644104
Epoch: 21, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.368 Vali Acc: 0.904 Test Loss: 0.368 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6536900997161865
Epoch: 22, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7406504154205322
Epoch: 23, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.7306900024414062
Epoch: 24, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6771056652069092
Epoch: 25, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6858978271484375
Epoch: 26, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6230576038360596
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.685309648513794
Epoch: 28, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.257 Vali Acc: 0.904 Test Loss: 0.257 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6752486228942871
Epoch: 29, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.257 Vali Acc: 0.904 Test Loss: 0.257 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.746168851852417
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.252 Vali Acc: 0.904 Test Loss: 0.252 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.679966926574707
Epoch: 31, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.907 Test Loss: 0.243 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7366154193878174
Epoch: 32, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.233 Vali Acc: 0.904 Test Loss: 0.233 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6773624420166016
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 29369862
model size : 126.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.476841449737549
Epoch: 1, Steps: 2 | Train Loss: 2.017 Vali Loss: 1.887 Vali Acc: 0.170 Test Loss: 1.887 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.6376645565032959
Epoch: 2, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.815 Vali Acc: 0.174 Test Loss: 1.815 Test Acc: 0.174
Validation loss decreased (-0.170351 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.6211583614349365
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.771 Vali Acc: 0.178 Test Loss: 1.771 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.5948712825775146
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.730 Vali Acc: 0.211 Test Loss: 1.730 Test Acc: 0.211
Validation loss decreased (-0.177760 --> -0.211094).  Saving model ...
Epoch: 5 cost time: 0.6534035205841064
Epoch: 5, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.683 Vali Acc: 0.307 Test Loss: 1.683 Test Acc: 0.307
Validation loss decreased (-0.211094 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 0.64739990234375
Epoch: 6, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.632 Vali Acc: 0.522 Test Loss: 1.632 Test Acc: 0.522
Validation loss decreased (-0.307391 --> -0.522206).  Saving model ...
Epoch: 7 cost time: 0.6238715648651123
Epoch: 7, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.579 Vali Acc: 0.556 Test Loss: 1.579 Test Acc: 0.556
Validation loss decreased (-0.522206 --> -0.555540).  Saving model ...
Epoch: 8 cost time: 0.5656619071960449
Epoch: 8, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.523 Vali Acc: 0.615 Test Loss: 1.523 Test Acc: 0.615
Validation loss decreased (-0.555540 --> -0.614800).  Saving model ...
Epoch: 9 cost time: 0.820605993270874
Epoch: 9, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.465 Vali Acc: 0.648 Test Loss: 1.465 Test Acc: 0.648
Validation loss decreased (-0.614800 --> -0.648133).  Saving model ...
Epoch: 10 cost time: 0.6187396049499512
Epoch: 10, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.403 Vali Acc: 0.689 Test Loss: 1.403 Test Acc: 0.689
Validation loss decreased (-0.648133 --> -0.688875).  Saving model ...
Epoch: 11 cost time: 0.7839086055755615
Epoch: 11, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.335 Vali Acc: 0.756 Test Loss: 1.335 Test Acc: 0.756
Validation loss decreased (-0.688875 --> -0.755542).  Saving model ...
Epoch: 12 cost time: 0.6802346706390381
Epoch: 12, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.265 Vali Acc: 0.804 Test Loss: 1.265 Test Acc: 0.804
Validation loss decreased (-0.755542 --> -0.803691).  Saving model ...
Epoch: 13 cost time: 0.6279270648956299
Epoch: 13, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.190 Vali Acc: 0.852 Test Loss: 1.190 Test Acc: 0.852
Validation loss decreased (-0.803691 --> -0.851840).  Saving model ...
Epoch: 14 cost time: 0.8497388362884521
Epoch: 14, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.112 Vali Acc: 0.867 Test Loss: 1.112 Test Acc: 0.867
Validation loss decreased (-0.851840 --> -0.866656).  Saving model ...
Epoch: 15 cost time: 0.6508622169494629
Epoch: 15, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.032 Vali Acc: 0.896 Test Loss: 1.032 Test Acc: 0.896
Validation loss decreased (-0.866656 --> -0.896286).  Saving model ...
Epoch: 16 cost time: 0.6419763565063477
Epoch: 16, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.951 Vali Acc: 0.907 Test Loss: 0.951 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907398).  Saving model ...
Epoch: 17 cost time: 0.6334259510040283
Epoch: 17, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.871 Vali Acc: 0.911 Test Loss: 0.871 Test Acc: 0.911
Validation loss decreased (-0.907398 --> -0.911102).  Saving model ...
Epoch: 18 cost time: 0.5465044975280762
Epoch: 18, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.791 Vali Acc: 0.919 Test Loss: 0.791 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918511).  Saving model ...
Epoch: 19 cost time: 0.7173624038696289
Epoch: 19, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.717 Vali Acc: 0.926 Test Loss: 0.717 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 20 cost time: 0.701570987701416
Epoch: 20, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.650 Vali Acc: 0.933 Test Loss: 0.650 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 21 cost time: 0.6570560932159424
Epoch: 21, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.581 Vali Acc: 0.933 Test Loss: 0.581 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 22 cost time: 0.6399164199829102
Epoch: 22, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.516 Vali Acc: 0.941 Test Loss: 0.516 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 23 cost time: 0.584972620010376
Epoch: 23, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.452 Vali Acc: 0.941 Test Loss: 0.452 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 24 cost time: 0.716804027557373
Epoch: 24, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.396 Vali Acc: 0.941 Test Loss: 0.396 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 25 cost time: 0.5880141258239746
Epoch: 25, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.352 Vali Acc: 0.948 Test Loss: 0.352 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 26 cost time: 0.900749683380127
Epoch: 26, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.748821496963501
Epoch: 27, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6320233345031738
Epoch: 28, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6879372596740723
Epoch: 29, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.6840980052947998
Epoch: 30, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6066429615020752
Epoch: 31, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7436954975128174
Epoch: 32, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.557060956954956
Epoch: 33, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6350805759429932
Epoch: 34, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5776572227478027
Epoch: 35, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6112487316131592
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.926 Test Loss: 0.189 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5688931941986084
Epoch: 37, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6623172760009766
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6866626739501953
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 29326854
model size : 126.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.160818099975586
Epoch: 1, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.758 Vali Acc: 0.237 Test Loss: 1.758 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.6908462047576904
Epoch: 2, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.716 Vali Acc: 0.259 Test Loss: 1.716 Test Acc: 0.259
Validation loss decreased (-0.237019 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.759605884552002
Epoch: 3, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.683 Vali Acc: 0.352 Test Loss: 1.683 Test Acc: 0.352
Validation loss decreased (-0.259242 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.6626582145690918
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.623 Vali Acc: 0.530 Test Loss: 1.623 Test Acc: 0.530
Validation loss decreased (-0.351835 --> -0.529613).  Saving model ...
Epoch: 5 cost time: 0.742607593536377
Epoch: 5, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.545 Vali Acc: 0.637 Test Loss: 1.545 Test Acc: 0.637
Validation loss decreased (-0.529613 --> -0.637022).  Saving model ...
Epoch: 6 cost time: 0.7286784648895264
Epoch: 6, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.455 Vali Acc: 0.744 Test Loss: 1.455 Test Acc: 0.744
Validation loss decreased (-0.637022 --> -0.744430).  Saving model ...
Epoch: 7 cost time: 0.6916203498840332
Epoch: 7, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.359 Vali Acc: 0.807 Test Loss: 1.359 Test Acc: 0.807
Validation loss decreased (-0.744430 --> -0.807394).  Saving model ...
Epoch: 8 cost time: 0.9095454216003418
Epoch: 8, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.256 Vali Acc: 0.844 Test Loss: 1.256 Test Acc: 0.844
Validation loss decreased (-0.807394 --> -0.844432).  Saving model ...
Epoch: 9 cost time: 0.8075661659240723
Epoch: 9, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.150 Vali Acc: 0.863 Test Loss: 1.150 Test Acc: 0.863
Validation loss decreased (-0.844432 --> -0.862951).  Saving model ...
Epoch: 10 cost time: 1.0174362659454346
Epoch: 10, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.042 Vali Acc: 0.859 Test Loss: 1.042 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0761065483093262
Epoch: 11, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.942 Vali Acc: 0.867 Test Loss: 0.942 Test Acc: 0.867
Validation loss decreased (-0.862951 --> -0.866657).  Saving model ...
Epoch: 12 cost time: 0.9524884223937988
Epoch: 12, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.841 Vali Acc: 0.885 Test Loss: 0.841 Test Acc: 0.885
Validation loss decreased (-0.866657 --> -0.885177).  Saving model ...
Epoch: 13 cost time: 0.9621198177337646
Epoch: 13, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.746 Vali Acc: 0.889 Test Loss: 0.746 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 0.85591721534729
Epoch: 14, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.660 Vali Acc: 0.896 Test Loss: 0.660 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896290).  Saving model ...
Epoch: 15 cost time: 1.027665376663208
Epoch: 15, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.581 Vali Acc: 0.911 Test Loss: 0.581 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 16 cost time: 0.8943791389465332
Epoch: 16, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 1.001905918121338
Epoch: 17, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.452 Vali Acc: 0.907 Test Loss: 0.452 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8045196533203125
Epoch: 18, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.8788707256317139
Epoch: 19, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.348 Vali Acc: 0.915 Test Loss: 0.348 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.8791654109954834
Epoch: 20, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.8783318996429443
Epoch: 21, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.893695592880249
Epoch: 22, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9715366363525391
Epoch: 23, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9030728340148926
Epoch: 24, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0341644287109375
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.223 Vali Acc: 0.915 Test Loss: 0.223 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7746353149414062
Epoch: 26, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.919 Test Loss: 0.212 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8160901069641113
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929628).  Saving model ...
Epoch: 28 cost time: 0.9581434726715088
Epoch: 28, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7656052112579346
Epoch: 29, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8963243961334229
Epoch: 30, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8159730434417725
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8320133686065674
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.915 Test Loss: 0.213 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8287978172302246
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.915 Test Loss: 0.217 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8267717361450195
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.915 Test Loss: 0.221 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8700053691864014
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7981786727905273
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.230 Vali Acc: 0.911 Test Loss: 0.230 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7485406398773193
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 29403654
model size : 126.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0431694984436035
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.774 Vali Acc: 0.189 Test Loss: 1.774 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.73468017578125
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.724 Vali Acc: 0.259 Test Loss: 1.724 Test Acc: 0.259
Validation loss decreased (-0.188871 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.7160992622375488
Epoch: 3, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.694 Vali Acc: 0.378 Test Loss: 1.694 Test Acc: 0.378
Validation loss decreased (-0.259242 --> -0.377761).  Saving model ...
Epoch: 4 cost time: 0.6560459136962891
Epoch: 4, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.653 Vali Acc: 0.478 Test Loss: 1.653 Test Acc: 0.478
Validation loss decreased (-0.377761 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 0.668292760848999
Epoch: 5, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.603 Vali Acc: 0.563 Test Loss: 1.603 Test Acc: 0.563
Validation loss decreased (-0.477761 --> -0.562947).  Saving model ...
Epoch: 6 cost time: 0.6505203247070312
Epoch: 6, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.543 Vali Acc: 0.637 Test Loss: 1.543 Test Acc: 0.637
Validation loss decreased (-0.562947 --> -0.637022).  Saving model ...
Epoch: 7 cost time: 0.5409352779388428
Epoch: 7, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.477 Vali Acc: 0.704 Test Loss: 1.477 Test Acc: 0.704
Validation loss decreased (-0.637022 --> -0.703689).  Saving model ...
Epoch: 8 cost time: 0.604053258895874
Epoch: 8, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.403 Vali Acc: 0.752 Test Loss: 1.403 Test Acc: 0.752
Validation loss decreased (-0.703689 --> -0.751838).  Saving model ...
Epoch: 9 cost time: 0.6292901039123535
Epoch: 9, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.323 Vali Acc: 0.807 Test Loss: 1.323 Test Acc: 0.807
Validation loss decreased (-0.751838 --> -0.807394).  Saving model ...
Epoch: 10 cost time: 0.6805777549743652
Epoch: 10, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.238 Vali Acc: 0.859 Test Loss: 1.238 Test Acc: 0.859
Validation loss decreased (-0.807394 --> -0.859247).  Saving model ...
Epoch: 11 cost time: 0.657189130783081
Epoch: 11, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.154 Vali Acc: 0.889 Test Loss: 1.154 Test Acc: 0.889
Validation loss decreased (-0.859247 --> -0.888877).  Saving model ...
Epoch: 12 cost time: 0.7842154502868652
Epoch: 12, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.070 Vali Acc: 0.904 Test Loss: 1.070 Test Acc: 0.904
Validation loss decreased (-0.888877 --> -0.903693).  Saving model ...
Epoch: 13 cost time: 0.87286376953125
Epoch: 13, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.987 Vali Acc: 0.915 Test Loss: 0.987 Test Acc: 0.915
Validation loss decreased (-0.903693 --> -0.914805).  Saving model ...
Epoch: 14 cost time: 0.7712562084197998
Epoch: 14, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.907 Vali Acc: 0.922 Test Loss: 0.907 Test Acc: 0.922
Validation loss decreased (-0.914805 --> -0.922213).  Saving model ...
Epoch: 15 cost time: 0.7033154964447021
Epoch: 15, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.829 Vali Acc: 0.915 Test Loss: 0.829 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6409478187561035
Epoch: 16, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.752 Vali Acc: 0.930 Test Loss: 0.752 Test Acc: 0.930
Validation loss decreased (-0.922213 --> -0.929622).  Saving model ...
Epoch: 17 cost time: 0.6576254367828369
Epoch: 17, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.672 Vali Acc: 0.941 Test Loss: 0.672 Test Acc: 0.941
Validation loss decreased (-0.929622 --> -0.940734).  Saving model ...
Epoch: 18 cost time: 0.7284383773803711
Epoch: 18, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.600 Vali Acc: 0.944 Test Loss: 0.600 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 19 cost time: 0.6518344879150391
Epoch: 19, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.534 Vali Acc: 0.948 Test Loss: 0.534 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948143).  Saving model ...
Epoch: 20 cost time: 0.7477014064788818
Epoch: 20, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.475 Vali Acc: 0.944 Test Loss: 0.475 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7221510410308838
Epoch: 21, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.422 Vali Acc: 0.933 Test Loss: 0.422 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7237880229949951
Epoch: 22, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.376 Vali Acc: 0.926 Test Loss: 0.376 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6147494316101074
Epoch: 23, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.335 Vali Acc: 0.926 Test Loss: 0.335 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6405155658721924
Epoch: 24, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5920958518981934
Epoch: 25, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7530312538146973
Epoch: 26, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8009743690490723
Epoch: 27, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7643153667449951
Epoch: 28, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.578577995300293
Epoch: 29, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 29360646
model size : 126.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0497641563415527
Epoch: 1, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.873 Vali Acc: 0.241 Test Loss: 1.873 Test Acc: 0.241
Validation loss decreased (inf --> -0.240722).  Saving model ...
Epoch: 2 cost time: 0.561854362487793
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.827 Vali Acc: 0.226 Test Loss: 1.827 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6054515838623047
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.800 Vali Acc: 0.233 Test Loss: 1.800 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6996681690216064
Epoch: 4, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.770 Vali Acc: 0.241 Test Loss: 1.770 Test Acc: 0.241
Validation loss decreased (-0.240722 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.62054443359375
Epoch: 5, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.732 Vali Acc: 0.274 Test Loss: 1.732 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 0.8228764533996582
Epoch: 6, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.686 Vali Acc: 0.359 Test Loss: 1.686 Test Acc: 0.359
Validation loss decreased (-0.274057 --> -0.359242).  Saving model ...
Epoch: 7 cost time: 0.6776914596557617
Epoch: 7, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.634 Vali Acc: 0.493 Test Loss: 1.634 Test Acc: 0.493
Validation loss decreased (-0.359242 --> -0.492576).  Saving model ...
Epoch: 8 cost time: 0.6853063106536865
Epoch: 8, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.579 Vali Acc: 0.541 Test Loss: 1.579 Test Acc: 0.541
Validation loss decreased (-0.492576 --> -0.540725).  Saving model ...
Epoch: 9 cost time: 0.7399427890777588
Epoch: 9, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.521 Vali Acc: 0.619 Test Loss: 1.521 Test Acc: 0.619
Validation loss decreased (-0.540725 --> -0.618503).  Saving model ...
Epoch: 10 cost time: 0.5356028079986572
Epoch: 10, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.459 Vali Acc: 0.711 Test Loss: 1.459 Test Acc: 0.711
Validation loss decreased (-0.618503 --> -0.711097).  Saving model ...
Epoch: 11 cost time: 0.5732395648956299
Epoch: 11, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.393 Vali Acc: 0.774 Test Loss: 1.393 Test Acc: 0.774
Validation loss decreased (-0.711097 --> -0.774060).  Saving model ...
Epoch: 12 cost time: 0.657630205154419
Epoch: 12, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.326 Vali Acc: 0.789 Test Loss: 1.326 Test Acc: 0.789
Validation loss decreased (-0.774060 --> -0.788876).  Saving model ...
Epoch: 13 cost time: 0.6012394428253174
Epoch: 13, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.255 Vali Acc: 0.841 Test Loss: 1.255 Test Acc: 0.841
Validation loss decreased (-0.788876 --> -0.840728).  Saving model ...
Epoch: 14 cost time: 0.7089707851409912
Epoch: 14, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.185 Vali Acc: 0.863 Test Loss: 1.185 Test Acc: 0.863
Validation loss decreased (-0.840728 --> -0.862951).  Saving model ...
Epoch: 15 cost time: 0.7832193374633789
Epoch: 15, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.114 Vali Acc: 0.859 Test Loss: 1.114 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5749638080596924
Epoch: 16, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.043 Vali Acc: 0.859 Test Loss: 1.043 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6522505283355713
Epoch: 17, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.970 Vali Acc: 0.881 Test Loss: 0.970 Test Acc: 0.881
Validation loss decreased (-0.862951 --> -0.881472).  Saving model ...
Epoch: 18 cost time: 0.6595163345336914
Epoch: 18, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.893 Vali Acc: 0.911 Test Loss: 0.893 Test Acc: 0.911
Validation loss decreased (-0.881472 --> -0.911102).  Saving model ...
Epoch: 19 cost time: 0.6273772716522217
Epoch: 19, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.817 Vali Acc: 0.944 Test Loss: 0.817 Test Acc: 0.944
Validation loss decreased (-0.911102 --> -0.944436).  Saving model ...
Epoch: 20 cost time: 0.6652877330780029
Epoch: 20, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.741 Vali Acc: 0.944 Test Loss: 0.741 Test Acc: 0.944
Validation loss decreased (-0.944436 --> -0.944437).  Saving model ...
Epoch: 21 cost time: 0.6133129596710205
Epoch: 21, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.668 Vali Acc: 0.948 Test Loss: 0.668 Test Acc: 0.948
Validation loss decreased (-0.944437 --> -0.948141).  Saving model ...
Epoch: 22 cost time: 0.6090428829193115
Epoch: 22, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.599 Vali Acc: 0.956 Test Loss: 0.599 Test Acc: 0.956
Validation loss decreased (-0.948141 --> -0.955550).  Saving model ...
Epoch: 23 cost time: 0.8737196922302246
Epoch: 23, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.532 Vali Acc: 0.944 Test Loss: 0.532 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7900271415710449
Epoch: 24, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.473 Vali Acc: 0.937 Test Loss: 0.473 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6883842945098877
Epoch: 25, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.422 Vali Acc: 0.930 Test Loss: 0.422 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6714155673980713
Epoch: 26, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8173601627349854
Epoch: 27, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7600951194763184
Epoch: 28, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.683828592300415
Epoch: 29, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6690127849578857
Epoch: 30, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6809413433074951
Epoch: 31, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7290952205657959
Epoch: 32, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 29329926
model size : 126.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6075427532196045
Epoch: 1, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.880 Vali Acc: 0.048 Test Loss: 1.880 Test Acc: 0.048
Validation loss decreased (inf --> -0.048129).  Saving model ...
Epoch: 2 cost time: 0.7060267925262451
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.823 Vali Acc: 0.215 Test Loss: 1.823 Test Acc: 0.215
Validation loss decreased (-0.048129 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.6572592258453369
Epoch: 3, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.771 Vali Acc: 0.352 Test Loss: 1.771 Test Acc: 0.352
Validation loss decreased (-0.214797 --> -0.351834).  Saving model ...
Epoch: 4 cost time: 0.6847963333129883
Epoch: 4, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.705 Vali Acc: 0.411 Test Loss: 1.705 Test Acc: 0.411
Validation loss decreased (-0.351834 --> -0.411094).  Saving model ...
Epoch: 5 cost time: 0.6920735836029053
Epoch: 5, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.621 Vali Acc: 0.478 Test Loss: 1.621 Test Acc: 0.478
Validation loss decreased (-0.411094 --> -0.477762).  Saving model ...
Epoch: 6 cost time: 0.700939416885376
Epoch: 6, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.526 Vali Acc: 0.556 Test Loss: 1.526 Test Acc: 0.556
Validation loss decreased (-0.477762 --> -0.555540).  Saving model ...
Epoch: 7 cost time: 0.7118558883666992
Epoch: 7, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.418 Vali Acc: 0.615 Test Loss: 1.418 Test Acc: 0.615
Validation loss decreased (-0.555540 --> -0.614801).  Saving model ...
Epoch: 8 cost time: 0.6606869697570801
Epoch: 8, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.305 Vali Acc: 0.689 Test Loss: 1.305 Test Acc: 0.689
Validation loss decreased (-0.614801 --> -0.688876).  Saving model ...
Epoch: 9 cost time: 0.645704984664917
Epoch: 9, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.188 Vali Acc: 0.752 Test Loss: 1.188 Test Acc: 0.752
Validation loss decreased (-0.688876 --> -0.751840).  Saving model ...
Epoch: 10 cost time: 0.7919347286224365
Epoch: 10, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.070 Vali Acc: 0.819 Test Loss: 1.070 Test Acc: 0.819
Validation loss decreased (-0.751840 --> -0.818508).  Saving model ...
Epoch: 11 cost time: 0.6291389465332031
Epoch: 11, Steps: 2 | Train Loss: 0.971 Vali Loss: 0.958 Vali Acc: 0.841 Test Loss: 0.958 Test Acc: 0.841
Validation loss decreased (-0.818508 --> -0.840731).  Saving model ...
Epoch: 12 cost time: 0.6634647846221924
Epoch: 12, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.857 Vali Acc: 0.848 Test Loss: 0.857 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848140).  Saving model ...
Epoch: 13 cost time: 0.781557559967041
Epoch: 13, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.761 Vali Acc: 0.867 Test Loss: 0.761 Test Acc: 0.867
Validation loss decreased (-0.848140 --> -0.866659).  Saving model ...
Epoch: 14 cost time: 0.664980411529541
Epoch: 14, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.674 Vali Acc: 0.889 Test Loss: 0.674 Test Acc: 0.889
Validation loss decreased (-0.866659 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 0.6906440258026123
Epoch: 15, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.594 Vali Acc: 0.907 Test Loss: 0.594 Test Acc: 0.907
Validation loss decreased (-0.888882 --> -0.907401).  Saving model ...
Epoch: 16 cost time: 0.6781165599822998
Epoch: 16, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.523 Vali Acc: 0.911 Test Loss: 0.523 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 0.8023285865783691
Epoch: 17, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.466 Vali Acc: 0.919 Test Loss: 0.466 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.9351308345794678
Epoch: 18, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8645668029785156
Epoch: 19, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.9071226119995117
Epoch: 20, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.9110543727874756
Epoch: 21, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.7552776336669922
Epoch: 22, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8280377388000488
Epoch: 23, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.904 Test Loss: 0.258 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9876158237457275
Epoch: 24, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.252 Vali Acc: 0.900 Test Loss: 0.252 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8697240352630615
Epoch: 25, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.228 Vali Acc: 0.915 Test Loss: 0.228 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8675312995910645
Epoch: 26, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9850821495056152
Epoch: 27, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8048727512359619
Epoch: 28, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.915 Test Loss: 0.235 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8263990879058838
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.915 Test Loss: 0.240 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8958995342254639
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.915 Test Loss: 0.235 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8397715091705322
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 29412870
model size : 126.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3584043979644775
Epoch: 1, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.809 Vali Acc: 0.200 Test Loss: 1.809 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.691756010055542
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.766 Vali Acc: 0.259 Test Loss: 1.766 Test Acc: 0.259
Validation loss decreased (-0.199982 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.6362426280975342
Epoch: 3, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.731 Vali Acc: 0.300 Test Loss: 1.731 Test Acc: 0.300
Validation loss decreased (-0.259242 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.8237497806549072
Epoch: 4, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.687 Vali Acc: 0.330 Test Loss: 1.687 Test Acc: 0.330
Validation loss decreased (-0.299983 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.6729509830474854
Epoch: 5, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.631 Vali Acc: 0.396 Test Loss: 1.631 Test Acc: 0.396
Validation loss decreased (-0.329613 --> -0.396280).  Saving model ...
Epoch: 6 cost time: 0.640160083770752
Epoch: 6, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.569 Vali Acc: 0.441 Test Loss: 1.569 Test Acc: 0.441
Validation loss decreased (-0.396280 --> -0.440725).  Saving model ...
Epoch: 7 cost time: 0.6278502941131592
Epoch: 7, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.502 Vali Acc: 0.500 Test Loss: 1.502 Test Acc: 0.500
Validation loss decreased (-0.440725 --> -0.499985).  Saving model ...
Epoch: 8 cost time: 0.659672737121582
Epoch: 8, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.430 Vali Acc: 0.537 Test Loss: 1.430 Test Acc: 0.537
Validation loss decreased (-0.499985 --> -0.537023).  Saving model ...
Epoch: 9 cost time: 0.7423141002655029
Epoch: 9, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.353 Vali Acc: 0.615 Test Loss: 1.353 Test Acc: 0.615
Validation loss decreased (-0.537023 --> -0.614801).  Saving model ...
Epoch: 10 cost time: 0.6173646450042725
Epoch: 10, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.267 Vali Acc: 0.685 Test Loss: 1.267 Test Acc: 0.685
Validation loss decreased (-0.614801 --> -0.685173).  Saving model ...
Epoch: 11 cost time: 0.7910804748535156
Epoch: 11, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.180 Vali Acc: 0.756 Test Loss: 1.180 Test Acc: 0.756
Validation loss decreased (-0.685173 --> -0.755544).  Saving model ...
Epoch: 12 cost time: 0.6424319744110107
Epoch: 12, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.093 Vali Acc: 0.781 Test Loss: 1.093 Test Acc: 0.781
Validation loss decreased (-0.755544 --> -0.781471).  Saving model ...
Epoch: 13 cost time: 0.7492387294769287
Epoch: 13, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.006 Vali Acc: 0.819 Test Loss: 1.006 Test Acc: 0.819
Validation loss decreased (-0.781471 --> -0.818508).  Saving model ...
Epoch: 14 cost time: 0.6425771713256836
Epoch: 14, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.919 Vali Acc: 0.844 Test Loss: 0.919 Test Acc: 0.844
Validation loss decreased (-0.818508 --> -0.844435).  Saving model ...
Epoch: 15 cost time: 0.6838364601135254
Epoch: 15, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.834 Vali Acc: 0.881 Test Loss: 0.834 Test Acc: 0.881
Validation loss decreased (-0.844435 --> -0.881473).  Saving model ...
Epoch: 16 cost time: 0.636218786239624
Epoch: 16, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.750 Vali Acc: 0.904 Test Loss: 0.750 Test Acc: 0.904
Validation loss decreased (-0.881473 --> -0.903696).  Saving model ...
Epoch: 17 cost time: 0.7867481708526611
Epoch: 17, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.670 Vali Acc: 0.919 Test Loss: 0.670 Test Acc: 0.919
Validation loss decreased (-0.903696 --> -0.918512).  Saving model ...
Epoch: 18 cost time: 0.7881200313568115
Epoch: 18, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.591 Vali Acc: 0.919 Test Loss: 0.591 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 19 cost time: 0.7876005172729492
Epoch: 19, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 20 cost time: 0.767913818359375
Epoch: 20, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.458 Vali Acc: 0.919 Test Loss: 0.458 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6325197219848633
Epoch: 21, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.400 Vali Acc: 0.930 Test Loss: 0.400 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929626).  Saving model ...
Epoch: 22 cost time: 0.667658805847168
Epoch: 22, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5610086917877197
Epoch: 23, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.307 Vali Acc: 0.915 Test Loss: 0.307 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7042498588562012
Epoch: 24, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6679596900939941
Epoch: 25, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.257 Vali Acc: 0.907 Test Loss: 0.257 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.851062536239624
Epoch: 26, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7799830436706543
Epoch: 27, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.5880076885223389
Epoch: 28, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.803511381149292
Epoch: 29, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.7649216651916504
Epoch: 30, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6481955051422119
Epoch: 31, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.618889331817627
Epoch: 32, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.919 Test Loss: 0.199 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7016665935516357
Epoch: 33, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.915 Test Loss: 0.197 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8324341773986816
Epoch: 34, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7181785106658936
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7128608226776123
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.724623441696167
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.706446647644043
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.631291389465332
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 29369862
model size : 126.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2977476119995117
Epoch: 1, Steps: 2 | Train Loss: 2.060 Vali Loss: 1.909 Vali Acc: 0.163 Test Loss: 1.909 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.6223788261413574
Epoch: 2, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.847 Vali Acc: 0.144 Test Loss: 1.847 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.535999059677124
Epoch: 3, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.810 Vali Acc: 0.152 Test Loss: 1.810 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6259181499481201
Epoch: 4, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.778 Vali Acc: 0.159 Test Loss: 1.778 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.655383825302124
Epoch: 5, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.739 Vali Acc: 0.189 Test Loss: 1.739 Test Acc: 0.189
Validation loss decreased (-0.162944 --> -0.188871).  Saving model ...
Epoch: 6 cost time: 0.6203188896179199
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.694 Vali Acc: 0.296 Test Loss: 1.694 Test Acc: 0.296
Validation loss decreased (-0.188871 --> -0.296279).  Saving model ...
Epoch: 7 cost time: 0.6579389572143555
Epoch: 7, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.645 Vali Acc: 0.437 Test Loss: 1.645 Test Acc: 0.437
Validation loss decreased (-0.296279 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 0.5750715732574463
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.595 Vali Acc: 0.570 Test Loss: 1.595 Test Acc: 0.570
Validation loss decreased (-0.437021 --> -0.570354).  Saving model ...
Epoch: 9 cost time: 0.581639289855957
Epoch: 9, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.544 Vali Acc: 0.685 Test Loss: 1.544 Test Acc: 0.685
Validation loss decreased (-0.570354 --> -0.685170).  Saving model ...
Epoch: 10 cost time: 0.5944476127624512
Epoch: 10, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.491 Vali Acc: 0.711 Test Loss: 1.491 Test Acc: 0.711
Validation loss decreased (-0.685170 --> -0.711096).  Saving model ...
Epoch: 11 cost time: 0.6381552219390869
Epoch: 11, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.434 Vali Acc: 0.730 Test Loss: 1.434 Test Acc: 0.730
Validation loss decreased (-0.711096 --> -0.729615).  Saving model ...
Epoch: 12 cost time: 0.6494345664978027
Epoch: 12, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.374 Vali Acc: 0.744 Test Loss: 1.374 Test Acc: 0.744
Validation loss decreased (-0.729615 --> -0.744431).  Saving model ...
Epoch: 13 cost time: 0.6193459033966064
Epoch: 13, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.311 Vali Acc: 0.770 Test Loss: 1.311 Test Acc: 0.770
Validation loss decreased (-0.744431 --> -0.770357).  Saving model ...
Epoch: 14 cost time: 0.7190132141113281
Epoch: 14, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.242 Vali Acc: 0.796 Test Loss: 1.242 Test Acc: 0.796
Validation loss decreased (-0.770357 --> -0.796284).  Saving model ...
Epoch: 15 cost time: 0.5413022041320801
Epoch: 15, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.171 Vali Acc: 0.826 Test Loss: 1.171 Test Acc: 0.826
Validation loss decreased (-0.796284 --> -0.825914).  Saving model ...
Epoch: 16 cost time: 0.7234253883361816
Epoch: 16, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.099 Vali Acc: 0.844 Test Loss: 1.099 Test Acc: 0.844
Validation loss decreased (-0.825914 --> -0.844433).  Saving model ...
Epoch: 17 cost time: 0.7161905765533447
Epoch: 17, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.023 Vali Acc: 0.859 Test Loss: 1.023 Test Acc: 0.859
Validation loss decreased (-0.844433 --> -0.859249).  Saving model ...
Epoch: 18 cost time: 0.5311894416809082
Epoch: 18, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.945 Vali Acc: 0.881 Test Loss: 0.945 Test Acc: 0.881
Validation loss decreased (-0.859249 --> -0.881472).  Saving model ...
Epoch: 19 cost time: 0.6102108955383301
Epoch: 19, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.867 Vali Acc: 0.896 Test Loss: 0.867 Test Acc: 0.896
Validation loss decreased (-0.881472 --> -0.896288).  Saving model ...
Epoch: 20 cost time: 0.6323361396789551
Epoch: 20, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.787 Vali Acc: 0.900 Test Loss: 0.787 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.6773324012756348
Epoch: 21, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.709 Vali Acc: 0.911 Test Loss: 0.709 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.7090263366699219
Epoch: 22, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.632 Vali Acc: 0.915 Test Loss: 0.632 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 23 cost time: 0.6007585525512695
Epoch: 23, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.559 Vali Acc: 0.919 Test Loss: 0.559 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.5574719905853271
Epoch: 24, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.492 Vali Acc: 0.926 Test Loss: 0.492 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 25 cost time: 0.6067898273468018
Epoch: 25, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.432 Vali Acc: 0.926 Test Loss: 0.432 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 26 cost time: 0.7554583549499512
Epoch: 26, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.378 Vali Acc: 0.926 Test Loss: 0.378 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 27 cost time: 0.6772964000701904
Epoch: 27, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.338 Vali Acc: 0.922 Test Loss: 0.338 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6707141399383545
Epoch: 28, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.683027982711792
Epoch: 29, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.6100015640258789
Epoch: 30, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.6684591770172119
Epoch: 31, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.6518571376800537
Epoch: 32, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.597663164138794
Epoch: 33, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6078011989593506
Epoch: 34, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7421071529388428
Epoch: 35, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7487449645996094
Epoch: 36, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5724482536315918
Epoch: 37, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.6632802486419678
Epoch: 38, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.6238265037536621
Epoch: 39, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.6936490535736084
Epoch: 40, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.6275937557220459
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.7063333988189697
Epoch: 42, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.7106888294219971
Epoch: 43, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.6604723930358887
Epoch: 44, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5613932609558105
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.7374417781829834
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 47 cost time: 0.6000950336456299
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.6990211009979248
Epoch: 48, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.7095382213592529
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.5207028388977051
Epoch: 50, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 29332998
model size : 126.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.577578067779541
Epoch: 1, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.867 Vali Acc: 0.130 Test Loss: 1.867 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.5987651348114014
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.806 Vali Acc: 0.241 Test Loss: 1.806 Test Acc: 0.241
Validation loss decreased (-0.129611 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.6150391101837158
Epoch: 3, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.764 Vali Acc: 0.285 Test Loss: 1.764 Test Acc: 0.285
Validation loss decreased (-0.240723 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.6048340797424316
Epoch: 4, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.706 Vali Acc: 0.378 Test Loss: 1.706 Test Acc: 0.378
Validation loss decreased (-0.285168 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 0.6506426334381104
Epoch: 5, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.634 Vali Acc: 0.493 Test Loss: 1.634 Test Acc: 0.493
Validation loss decreased (-0.377761 --> -0.492576).  Saving model ...
Epoch: 6 cost time: 0.7280011177062988
Epoch: 6, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.555 Vali Acc: 0.637 Test Loss: 1.555 Test Acc: 0.637
Validation loss decreased (-0.492576 --> -0.637021).  Saving model ...
Epoch: 7 cost time: 0.7104225158691406
Epoch: 7, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.463 Vali Acc: 0.685 Test Loss: 1.463 Test Acc: 0.685
Validation loss decreased (-0.637021 --> -0.685171).  Saving model ...
Epoch: 8 cost time: 0.6617889404296875
Epoch: 8, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.362 Vali Acc: 0.763 Test Loss: 1.362 Test Acc: 0.763
Validation loss decreased (-0.685171 --> -0.762949).  Saving model ...
Epoch: 9 cost time: 0.6961324214935303
Epoch: 9, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.259 Vali Acc: 0.844 Test Loss: 1.259 Test Acc: 0.844
Validation loss decreased (-0.762949 --> -0.844432).  Saving model ...
Epoch: 10 cost time: 0.694556713104248
Epoch: 10, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.157 Vali Acc: 0.881 Test Loss: 1.157 Test Acc: 0.881
Validation loss decreased (-0.844432 --> -0.881470).  Saving model ...
Epoch: 11 cost time: 0.6574103832244873
Epoch: 11, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.058 Vali Acc: 0.881 Test Loss: 1.058 Test Acc: 0.881
Validation loss decreased (-0.881470 --> -0.881471).  Saving model ...
Epoch: 12 cost time: 0.6553213596343994
Epoch: 12, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.958 Vali Acc: 0.878 Test Loss: 0.958 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7614076137542725
Epoch: 13, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.853 Vali Acc: 0.893 Test Loss: 0.853 Test Acc: 0.893
Validation loss decreased (-0.881471 --> -0.892584).  Saving model ...
Epoch: 14 cost time: 0.6337025165557861
Epoch: 14, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.756 Vali Acc: 0.904 Test Loss: 0.756 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903696).  Saving model ...
Epoch: 15 cost time: 0.6528174877166748
Epoch: 15, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.670 Vali Acc: 0.900 Test Loss: 0.670 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6672048568725586
Epoch: 16, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.592 Vali Acc: 0.911 Test Loss: 0.592 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 0.6217861175537109
Epoch: 17, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.520 Vali Acc: 0.911 Test Loss: 0.520 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.7502646446228027
Epoch: 18, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.454 Vali Acc: 0.904 Test Loss: 0.454 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6069314479827881
Epoch: 19, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 0.7042534351348877
Epoch: 20, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.344 Vali Acc: 0.904 Test Loss: 0.344 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7486181259155273
Epoch: 21, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.305 Vali Acc: 0.915 Test Loss: 0.305 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 0.6286482810974121
Epoch: 22, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 23 cost time: 0.6015501022338867
Epoch: 23, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 24 cost time: 0.6683399677276611
Epoch: 24, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 0.6707608699798584
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.214 Vali Acc: 0.919 Test Loss: 0.214 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7925205230712891
Epoch: 26, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.915 Test Loss: 0.215 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6798539161682129
Epoch: 27, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.919 Test Loss: 0.207 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6738977432250977
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.6512563228607178
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.7489941120147705
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6533234119415283
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6206841468811035
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7274110317230225
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.721243143081665
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.915 Test Loss: 0.239 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6326460838317871
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.248 Vali Acc: 0.915 Test Loss: 0.248 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7431900501251221
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7465150356292725
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5755155086517334
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.6324694156646729
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 29422086
model size : 126.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6328110694885254
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.755 Vali Acc: 0.185 Test Loss: 1.755 Test Acc: 0.185
Validation loss decreased (inf --> -0.185168).  Saving model ...
Epoch: 2 cost time: 0.6150274276733398
Epoch: 2, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.712 Vali Acc: 0.237 Test Loss: 1.712 Test Acc: 0.237
Validation loss decreased (-0.185168 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.5921308994293213
Epoch: 3, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.686 Vali Acc: 0.400 Test Loss: 1.686 Test Acc: 0.400
Validation loss decreased (-0.237020 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 0.7348489761352539
Epoch: 4, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.651 Vali Acc: 0.463 Test Loss: 1.651 Test Acc: 0.463
Validation loss decreased (-0.399983 --> -0.462946).  Saving model ...
Epoch: 5 cost time: 0.562706470489502
Epoch: 5, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.607 Vali Acc: 0.533 Test Loss: 1.607 Test Acc: 0.533
Validation loss decreased (-0.462946 --> -0.533317).  Saving model ...
Epoch: 6 cost time: 0.6560201644897461
Epoch: 6, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.555 Vali Acc: 0.604 Test Loss: 1.555 Test Acc: 0.604
Validation loss decreased (-0.533317 --> -0.603688).  Saving model ...
Epoch: 7 cost time: 0.7754917144775391
Epoch: 7, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.495 Vali Acc: 0.678 Test Loss: 1.495 Test Acc: 0.678
Validation loss decreased (-0.603688 --> -0.677763).  Saving model ...
Epoch: 8 cost time: 0.8246128559112549
Epoch: 8, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.431 Vali Acc: 0.737 Test Loss: 1.431 Test Acc: 0.737
Validation loss decreased (-0.677763 --> -0.737023).  Saving model ...
Epoch: 9 cost time: 0.6571805477142334
Epoch: 9, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.363 Vali Acc: 0.785 Test Loss: 1.363 Test Acc: 0.785
Validation loss decreased (-0.737023 --> -0.785172).  Saving model ...
Epoch: 10 cost time: 0.4927184581756592
Epoch: 10, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.289 Vali Acc: 0.833 Test Loss: 1.289 Test Acc: 0.833
Validation loss decreased (-0.785172 --> -0.833320).  Saving model ...
Epoch: 11 cost time: 0.6818912029266357
Epoch: 11, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.212 Vali Acc: 0.885 Test Loss: 1.212 Test Acc: 0.885
Validation loss decreased (-0.833320 --> -0.885173).  Saving model ...
Epoch: 12 cost time: 0.5728464126586914
Epoch: 12, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.133 Vali Acc: 0.896 Test Loss: 1.133 Test Acc: 0.896
Validation loss decreased (-0.885173 --> -0.896285).  Saving model ...
Epoch: 13 cost time: 0.5814321041107178
Epoch: 13, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.053 Vali Acc: 0.911 Test Loss: 1.053 Test Acc: 0.911
Validation loss decreased (-0.896285 --> -0.911101).  Saving model ...
Epoch: 14 cost time: 0.7190952301025391
Epoch: 14, Steps: 2 | Train Loss: 1.021 Vali Loss: 0.973 Vali Acc: 0.922 Test Loss: 0.973 Test Acc: 0.922
Validation loss decreased (-0.911101 --> -0.922212).  Saving model ...
Epoch: 15 cost time: 0.5960969924926758
Epoch: 15, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.893 Vali Acc: 0.930 Test Loss: 0.893 Test Acc: 0.930
Validation loss decreased (-0.922212 --> -0.929621).  Saving model ...
Epoch: 16 cost time: 0.6657717227935791
Epoch: 16, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.814 Vali Acc: 0.930 Test Loss: 0.814 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929621).  Saving model ...
Epoch: 17 cost time: 0.6861591339111328
Epoch: 17, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.739 Vali Acc: 0.930 Test Loss: 0.739 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929622).  Saving model ...
Epoch: 18 cost time: 0.5650284290313721
Epoch: 18, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.666 Vali Acc: 0.933 Test Loss: 0.666 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933327).  Saving model ...
Epoch: 19 cost time: 0.6740105152130127
Epoch: 19, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.598 Vali Acc: 0.941 Test Loss: 0.598 Test Acc: 0.941
Validation loss decreased (-0.933327 --> -0.940735).  Saving model ...
Epoch: 20 cost time: 0.6252691745758057
Epoch: 20, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.530 Vali Acc: 0.948 Test Loss: 0.530 Test Acc: 0.948
Validation loss decreased (-0.940735 --> -0.948143).  Saving model ...
Epoch: 21 cost time: 0.5732307434082031
Epoch: 21, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.465 Vali Acc: 0.948 Test Loss: 0.465 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 22 cost time: 0.5577871799468994
Epoch: 22, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.404 Vali Acc: 0.956 Test Loss: 0.404 Test Acc: 0.956
Validation loss decreased (-0.948143 --> -0.955552).  Saving model ...
Epoch: 23 cost time: 0.6551127433776855
Epoch: 23, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.353 Vali Acc: 0.952 Test Loss: 0.353 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5718061923980713
Epoch: 24, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.307 Vali Acc: 0.952 Test Loss: 0.307 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.636237621307373
Epoch: 25, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.271 Vali Acc: 0.952 Test Loss: 0.271 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8191728591918945
Epoch: 26, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5118222236633301
Epoch: 27, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5597290992736816
Epoch: 28, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.652702808380127
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6013562679290771
Epoch: 30, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5235283374786377
Epoch: 31, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7431070804595947
Epoch: 32, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.948 Test Loss: 0.155 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 29366790
model size : 126.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0977725982666016
Epoch: 1, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.802 Vali Acc: 0.289 Test Loss: 1.802 Test Acc: 0.289
Validation loss decreased (inf --> -0.288871).  Saving model ...
Epoch: 2 cost time: 0.7026259899139404
Epoch: 2, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.763 Vali Acc: 0.252 Test Loss: 1.763 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5990657806396484
Epoch: 3, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.741 Vali Acc: 0.252 Test Loss: 1.741 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7388925552368164
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.718 Vali Acc: 0.293 Test Loss: 1.718 Test Acc: 0.293
Validation loss decreased (-0.288871 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.5825483798980713
Epoch: 5, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.690 Vali Acc: 0.330 Test Loss: 1.690 Test Acc: 0.330
Validation loss decreased (-0.292575 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 0.600261926651001
Epoch: 6, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.658 Vali Acc: 0.363 Test Loss: 1.658 Test Acc: 0.363
Validation loss decreased (-0.329613 --> -0.362946).  Saving model ...
Epoch: 7 cost time: 0.5898566246032715
Epoch: 7, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.621 Vali Acc: 0.422 Test Loss: 1.621 Test Acc: 0.422
Validation loss decreased (-0.362946 --> -0.422206).  Saving model ...
Epoch: 8 cost time: 0.6036739349365234
Epoch: 8, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.581 Vali Acc: 0.463 Test Loss: 1.581 Test Acc: 0.463
Validation loss decreased (-0.422206 --> -0.462947).  Saving model ...
Epoch: 9 cost time: 0.5668222904205322
Epoch: 9, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.537 Vali Acc: 0.511 Test Loss: 1.537 Test Acc: 0.511
Validation loss decreased (-0.462947 --> -0.511096).  Saving model ...
Epoch: 10 cost time: 0.6164994239807129
Epoch: 10, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.492 Vali Acc: 0.533 Test Loss: 1.492 Test Acc: 0.533
Validation loss decreased (-0.511096 --> -0.533318).  Saving model ...
Epoch: 11 cost time: 0.5932199954986572
Epoch: 11, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.445 Vali Acc: 0.552 Test Loss: 1.445 Test Acc: 0.552
Validation loss decreased (-0.533318 --> -0.551837).  Saving model ...
Epoch: 12 cost time: 0.59116530418396
Epoch: 12, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.396 Vali Acc: 0.630 Test Loss: 1.396 Test Acc: 0.630
Validation loss decreased (-0.551837 --> -0.629616).  Saving model ...
Epoch: 13 cost time: 0.6232120990753174
Epoch: 13, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.345 Vali Acc: 0.678 Test Loss: 1.345 Test Acc: 0.678
Validation loss decreased (-0.629616 --> -0.677764).  Saving model ...
Epoch: 14 cost time: 0.7741913795471191
Epoch: 14, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.291 Vali Acc: 0.722 Test Loss: 1.291 Test Acc: 0.722
Validation loss decreased (-0.677764 --> -0.722209).  Saving model ...
Epoch: 15 cost time: 0.5397763252258301
Epoch: 15, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.235 Vali Acc: 0.759 Test Loss: 1.235 Test Acc: 0.759
Validation loss decreased (-0.722209 --> -0.759247).  Saving model ...
Epoch: 16 cost time: 0.6798009872436523
Epoch: 16, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.175 Vali Acc: 0.789 Test Loss: 1.175 Test Acc: 0.789
Validation loss decreased (-0.759247 --> -0.788877).  Saving model ...
Epoch: 17 cost time: 0.7372369766235352
Epoch: 17, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.113 Vali Acc: 0.807 Test Loss: 1.113 Test Acc: 0.807
Validation loss decreased (-0.788877 --> -0.807396).  Saving model ...
Epoch: 18 cost time: 0.6095366477966309
Epoch: 18, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.048 Vali Acc: 0.837 Test Loss: 1.048 Test Acc: 0.837
Validation loss decreased (-0.807396 --> -0.837027).  Saving model ...
Epoch: 19 cost time: 0.5826690196990967
Epoch: 19, Steps: 2 | Train Loss: 0.943 Vali Loss: 0.981 Vali Acc: 0.859 Test Loss: 0.981 Test Acc: 0.859
Validation loss decreased (-0.837027 --> -0.859249).  Saving model ...
Epoch: 20 cost time: 0.6939496994018555
Epoch: 20, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.915 Vali Acc: 0.867 Test Loss: 0.915 Test Acc: 0.867
Validation loss decreased (-0.859249 --> -0.866658).  Saving model ...
Epoch: 21 cost time: 0.5334627628326416
Epoch: 21, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.848 Vali Acc: 0.878 Test Loss: 0.848 Test Acc: 0.878
Validation loss decreased (-0.866658 --> -0.877769).  Saving model ...
Epoch: 22 cost time: 0.7660446166992188
Epoch: 22, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.782 Vali Acc: 0.885 Test Loss: 0.782 Test Acc: 0.885
Validation loss decreased (-0.877769 --> -0.885177).  Saving model ...
Epoch: 23 cost time: 0.6830649375915527
Epoch: 23, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.717 Vali Acc: 0.893 Test Loss: 0.717 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892585).  Saving model ...
Epoch: 24 cost time: 0.6303386688232422
Epoch: 24, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.652 Vali Acc: 0.907 Test Loss: 0.652 Test Acc: 0.907
Validation loss decreased (-0.892585 --> -0.907401).  Saving model ...
Epoch: 25 cost time: 0.5867068767547607
Epoch: 25, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.593 Vali Acc: 0.915 Test Loss: 0.593 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 26 cost time: 0.5930986404418945
Epoch: 26, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.538 Vali Acc: 0.907 Test Loss: 0.538 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6121060848236084
Epoch: 27, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.484 Vali Acc: 0.911 Test Loss: 0.484 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.567180871963501
Epoch: 28, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.435 Vali Acc: 0.907 Test Loss: 0.435 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5434455871582031
Epoch: 29, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.582216739654541
Epoch: 30, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922219).  Saving model ...
Epoch: 31 cost time: 0.7009727954864502
Epoch: 31, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933330).  Saving model ...
Epoch: 32 cost time: 0.5787522792816162
Epoch: 32, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5812065601348877
Epoch: 33, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6429908275604248
Epoch: 34, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.243 Vali Acc: 0.915 Test Loss: 0.243 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6836004257202148
Epoch: 35, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6202311515808105
Epoch: 36, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6201572418212891
Epoch: 37, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6854965686798096
Epoch: 38, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6547822952270508
Epoch: 39, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.5919864177703857
Epoch: 40, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.64524245262146
Epoch: 41, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.6057572364807129
Epoch: 42, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.6043086051940918
Epoch: 43, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.6384608745574951
Epoch: 44, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.5653693675994873
Epoch: 45, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.5429515838623047
Epoch: 46, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6728606224060059
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6720306873321533
Epoch: 48, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7980613708496094
Epoch: 49, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7492654323577881
Epoch: 50, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 29336070
model size : 126.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4226341247558594
Epoch: 1, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.774 Vali Acc: 0.233 Test Loss: 1.774 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.622725248336792
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.737 Vali Acc: 0.370 Test Loss: 1.737 Test Acc: 0.370
Validation loss decreased (-0.233316 --> -0.370353).  Saving model ...
Epoch: 3 cost time: 0.6248517036437988
Epoch: 3, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.707 Vali Acc: 0.411 Test Loss: 1.707 Test Acc: 0.411
Validation loss decreased (-0.370353 --> -0.411094).  Saving model ...
Epoch: 4 cost time: 0.6413509845733643
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.663 Vali Acc: 0.456 Test Loss: 1.663 Test Acc: 0.456
Validation loss decreased (-0.411094 --> -0.455539).  Saving model ...
Epoch: 5 cost time: 0.6856074333190918
Epoch: 5, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.607 Vali Acc: 0.526 Test Loss: 1.607 Test Acc: 0.526
Validation loss decreased (-0.455539 --> -0.525910).  Saving model ...
Epoch: 6 cost time: 0.6537251472473145
Epoch: 6, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.539 Vali Acc: 0.630 Test Loss: 1.539 Test Acc: 0.630
Validation loss decreased (-0.525910 --> -0.629614).  Saving model ...
Epoch: 7 cost time: 0.603400468826294
Epoch: 7, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.463 Vali Acc: 0.693 Test Loss: 1.463 Test Acc: 0.693
Validation loss decreased (-0.629614 --> -0.692578).  Saving model ...
Epoch: 8 cost time: 0.6194064617156982
Epoch: 8, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.382 Vali Acc: 0.733 Test Loss: 1.382 Test Acc: 0.733
Validation loss decreased (-0.692578 --> -0.733320).  Saving model ...
Epoch: 9 cost time: 0.6153643131256104
Epoch: 9, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.296 Vali Acc: 0.778 Test Loss: 1.296 Test Acc: 0.778
Validation loss decreased (-0.733320 --> -0.777765).  Saving model ...
Epoch: 10 cost time: 0.5979166030883789
Epoch: 10, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.208 Vali Acc: 0.811 Test Loss: 1.208 Test Acc: 0.811
Validation loss decreased (-0.777765 --> -0.811099).  Saving model ...
Epoch: 11 cost time: 0.6287534236907959
Epoch: 11, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.119 Vali Acc: 0.837 Test Loss: 1.119 Test Acc: 0.837
Validation loss decreased (-0.811099 --> -0.837026).  Saving model ...
Epoch: 12 cost time: 0.6534948348999023
Epoch: 12, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.029 Vali Acc: 0.863 Test Loss: 1.029 Test Acc: 0.863
Validation loss decreased (-0.837026 --> -0.862953).  Saving model ...
Epoch: 13 cost time: 0.6349637508392334
Epoch: 13, Steps: 2 | Train Loss: 0.967 Vali Loss: 0.941 Vali Acc: 0.889 Test Loss: 0.941 Test Acc: 0.889
Validation loss decreased (-0.862953 --> -0.888879).  Saving model ...
Epoch: 14 cost time: 0.563835859298706
Epoch: 14, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.857 Vali Acc: 0.893 Test Loss: 0.857 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892584).  Saving model ...
Epoch: 15 cost time: 0.6202099323272705
Epoch: 15, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.774 Vali Acc: 0.896 Test Loss: 0.774 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896289).  Saving model ...
Epoch: 16 cost time: 0.6629011631011963
Epoch: 16, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.691 Vali Acc: 0.911 Test Loss: 0.691 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911104).  Saving model ...
Epoch: 17 cost time: 0.639331579208374
Epoch: 17, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.617 Vali Acc: 0.915 Test Loss: 0.617 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914809).  Saving model ...
Epoch: 18 cost time: 0.634436845779419
Epoch: 18, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.546 Vali Acc: 0.915 Test Loss: 0.546 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 19 cost time: 0.6964719295501709
Epoch: 19, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.483 Vali Acc: 0.911 Test Loss: 0.483 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6916677951812744
Epoch: 20, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918514).  Saving model ...
Epoch: 21 cost time: 0.6886999607086182
Epoch: 21, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 22 cost time: 0.644404411315918
Epoch: 22, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.929626 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.6396691799163818
Epoch: 23, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6990630626678467
Epoch: 24, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.6034016609191895
Epoch: 25, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6663274765014648
Epoch: 26, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.658503532409668
Epoch: 27, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6085505485534668
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7560725212097168
Epoch: 29, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.80623459815979
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.695765495300293
Epoch: 31, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7268650531768799
Epoch: 32, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7095654010772705
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5785255432128906
Epoch: 34, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 29409798
model size : 126.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5820350646972656
Epoch: 1, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.908 Vali Acc: 0.089 Test Loss: 1.908 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 0.5180881023406982
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.844 Vali Acc: 0.141 Test Loss: 1.844 Test Acc: 0.141
Validation loss decreased (-0.088870 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 0.6628072261810303
Epoch: 3, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.804 Vali Acc: 0.244 Test Loss: 1.804 Test Acc: 0.244
Validation loss decreased (-0.140722 --> -0.244426).  Saving model ...
Epoch: 4 cost time: 0.6214346885681152
Epoch: 4, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.769 Vali Acc: 0.307 Test Loss: 1.769 Test Acc: 0.307
Validation loss decreased (-0.244426 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.7114884853363037
Epoch: 5, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.725 Vali Acc: 0.378 Test Loss: 1.725 Test Acc: 0.378
Validation loss decreased (-0.307390 --> -0.377761).  Saving model ...
Epoch: 6 cost time: 0.5852291584014893
Epoch: 6, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.676 Vali Acc: 0.426 Test Loss: 1.676 Test Acc: 0.426
Validation loss decreased (-0.377761 --> -0.425909).  Saving model ...
Epoch: 7 cost time: 0.5970010757446289
Epoch: 7, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.624 Vali Acc: 0.493 Test Loss: 1.624 Test Acc: 0.493
Validation loss decreased (-0.425909 --> -0.492576).  Saving model ...
Epoch: 8 cost time: 0.6457216739654541
Epoch: 8, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.567 Vali Acc: 0.548 Test Loss: 1.567 Test Acc: 0.548
Validation loss decreased (-0.492576 --> -0.548132).  Saving model ...
Epoch: 9 cost time: 0.5686383247375488
Epoch: 9, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.507 Vali Acc: 0.563 Test Loss: 1.507 Test Acc: 0.563
Validation loss decreased (-0.548132 --> -0.562948).  Saving model ...
Epoch: 10 cost time: 0.6561903953552246
Epoch: 10, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.444 Vali Acc: 0.607 Test Loss: 1.444 Test Acc: 0.607
Validation loss decreased (-0.562948 --> -0.607393).  Saving model ...
Epoch: 11 cost time: 0.7427318096160889
Epoch: 11, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.380 Vali Acc: 0.633 Test Loss: 1.380 Test Acc: 0.633
Validation loss decreased (-0.607393 --> -0.633320).  Saving model ...
Epoch: 12 cost time: 0.6765315532684326
Epoch: 12, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.314 Vali Acc: 0.670 Test Loss: 1.314 Test Acc: 0.670
Validation loss decreased (-0.633320 --> -0.670357).  Saving model ...
Epoch: 13 cost time: 0.5186634063720703
Epoch: 13, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.247 Vali Acc: 0.700 Test Loss: 1.247 Test Acc: 0.700
Validation loss decreased (-0.670357 --> -0.699988).  Saving model ...
Epoch: 14 cost time: 0.6234080791473389
Epoch: 14, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.173 Vali Acc: 0.763 Test Loss: 1.173 Test Acc: 0.763
Validation loss decreased (-0.699988 --> -0.762951).  Saving model ...
Epoch: 15 cost time: 0.6653048992156982
Epoch: 15, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.097 Vali Acc: 0.844 Test Loss: 1.097 Test Acc: 0.844
Validation loss decreased (-0.762951 --> -0.844433).  Saving model ...
Epoch: 16 cost time: 0.6666507720947266
Epoch: 16, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.019 Vali Acc: 0.859 Test Loss: 1.019 Test Acc: 0.859
Validation loss decreased (-0.844433 --> -0.859249).  Saving model ...
Epoch: 17 cost time: 0.6564068794250488
Epoch: 17, Steps: 2 | Train Loss: 0.942 Vali Loss: 0.942 Vali Acc: 0.878 Test Loss: 0.942 Test Acc: 0.878
Validation loss decreased (-0.859249 --> -0.877768).  Saving model ...
Epoch: 18 cost time: 0.6205096244812012
Epoch: 18, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.869 Vali Acc: 0.881 Test Loss: 0.869 Test Acc: 0.881
Validation loss decreased (-0.877768 --> -0.881473).  Saving model ...
Epoch: 19 cost time: 0.6290102005004883
Epoch: 19, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.800 Vali Acc: 0.881 Test Loss: 0.800 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 20 cost time: 0.5611052513122559
Epoch: 20, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.732 Vali Acc: 0.900 Test Loss: 0.732 Test Acc: 0.900
Validation loss decreased (-0.881473 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.730527400970459
Epoch: 21, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.667 Vali Acc: 0.900 Test Loss: 0.667 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.6485092639923096
Epoch: 22, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.605 Vali Acc: 0.915 Test Loss: 0.605 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914809).  Saving model ...
Epoch: 23 cost time: 0.5361318588256836
Epoch: 23, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.546 Vali Acc: 0.922 Test Loss: 0.546 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.5340726375579834
Epoch: 24, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.491 Vali Acc: 0.922 Test Loss: 0.491 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.5813155174255371
Epoch: 25, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.442 Vali Acc: 0.926 Test Loss: 0.442 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 26 cost time: 0.5720551013946533
Epoch: 26, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.393 Vali Acc: 0.930 Test Loss: 0.393 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 27 cost time: 0.7607967853546143
Epoch: 27, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.349 Vali Acc: 0.933 Test Loss: 0.349 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.5797841548919678
Epoch: 28, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.670236349105835
Epoch: 29, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8206262588500977
Epoch: 30, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.529921293258667
Epoch: 31, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6924748420715332
Epoch: 32, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5358123779296875
Epoch: 33, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6289899349212646
Epoch: 34, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5912821292877197
Epoch: 35, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5579047203063965
Epoch: 36, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5377521514892578
Epoch: 37, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 29372934
model size : 126.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.412755250930786
Epoch: 1, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.887 Vali Acc: 0.119 Test Loss: 1.887 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.5523481369018555
Epoch: 2, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.850 Vali Acc: 0.107 Test Loss: 1.850 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5675129890441895
Epoch: 3, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.825 Vali Acc: 0.141 Test Loss: 1.825 Test Acc: 0.141
Validation loss decreased (-0.118500 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 0.667588472366333
Epoch: 4, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.800 Vali Acc: 0.167 Test Loss: 1.800 Test Acc: 0.167
Validation loss decreased (-0.140722 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.6256155967712402
Epoch: 5, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.769 Vali Acc: 0.185 Test Loss: 1.769 Test Acc: 0.185
Validation loss decreased (-0.166649 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.6282792091369629
Epoch: 6, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.734 Vali Acc: 0.248 Test Loss: 1.734 Test Acc: 0.248
Validation loss decreased (-0.185167 --> -0.248131).  Saving model ...
Epoch: 7 cost time: 0.5980627536773682
Epoch: 7, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.696 Vali Acc: 0.393 Test Loss: 1.696 Test Acc: 0.393
Validation loss decreased (-0.248131 --> -0.392576).  Saving model ...
Epoch: 8 cost time: 0.5092711448669434
Epoch: 8, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.654 Vali Acc: 0.526 Test Loss: 1.654 Test Acc: 0.526
Validation loss decreased (-0.392576 --> -0.525909).  Saving model ...
Epoch: 9 cost time: 0.6336183547973633
Epoch: 9, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.612 Vali Acc: 0.626 Test Loss: 1.612 Test Acc: 0.626
Validation loss decreased (-0.525909 --> -0.625910).  Saving model ...
Epoch: 10 cost time: 0.6592161655426025
Epoch: 10, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.566 Vali Acc: 0.674 Test Loss: 1.566 Test Acc: 0.674
Validation loss decreased (-0.625910 --> -0.674058).  Saving model ...
Epoch: 11 cost time: 0.564129114151001
Epoch: 11, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.516 Vali Acc: 0.711 Test Loss: 1.516 Test Acc: 0.711
Validation loss decreased (-0.674058 --> -0.711096).  Saving model ...
Epoch: 12 cost time: 0.7033734321594238
Epoch: 12, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.465 Vali Acc: 0.752 Test Loss: 1.465 Test Acc: 0.752
Validation loss decreased (-0.711096 --> -0.751837).  Saving model ...
Epoch: 13 cost time: 0.637042760848999
Epoch: 13, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.411 Vali Acc: 0.796 Test Loss: 1.411 Test Acc: 0.796
Validation loss decreased (-0.751837 --> -0.796282).  Saving model ...
Epoch: 14 cost time: 0.6092226505279541
Epoch: 14, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.355 Vali Acc: 0.826 Test Loss: 1.355 Test Acc: 0.826
Validation loss decreased (-0.796282 --> -0.825912).  Saving model ...
Epoch: 15 cost time: 0.5374574661254883
Epoch: 15, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.299 Vali Acc: 0.852 Test Loss: 1.299 Test Acc: 0.852
Validation loss decreased (-0.825912 --> -0.851839).  Saving model ...
Epoch: 16 cost time: 0.6253018379211426
Epoch: 16, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.241 Vali Acc: 0.859 Test Loss: 1.241 Test Acc: 0.859
Validation loss decreased (-0.851839 --> -0.859247).  Saving model ...
Epoch: 17 cost time: 0.6590371131896973
Epoch: 17, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.180 Vali Acc: 0.870 Test Loss: 1.180 Test Acc: 0.870
Validation loss decreased (-0.859247 --> -0.870359).  Saving model ...
Epoch: 18 cost time: 0.6265122890472412
Epoch: 18, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.115 Vali Acc: 0.893 Test Loss: 1.115 Test Acc: 0.893
Validation loss decreased (-0.870359 --> -0.892581).  Saving model ...
Epoch: 19 cost time: 0.7250020503997803
Epoch: 19, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.045 Vali Acc: 0.919 Test Loss: 1.045 Test Acc: 0.919
Validation loss decreased (-0.892581 --> -0.918508).  Saving model ...
Epoch: 20 cost time: 0.5851991176605225
Epoch: 20, Steps: 2 | Train Loss: 0.979 Vali Loss: 0.972 Vali Acc: 0.926 Test Loss: 0.972 Test Acc: 0.926
Validation loss decreased (-0.918508 --> -0.925916).  Saving model ...
Epoch: 21 cost time: 0.6152787208557129
Epoch: 21, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.897 Vali Acc: 0.937 Test Loss: 0.897 Test Acc: 0.937
Validation loss decreased (-0.925916 --> -0.937028).  Saving model ...
Epoch: 22 cost time: 0.5892958641052246
Epoch: 22, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.825 Vali Acc: 0.933 Test Loss: 0.825 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7311501502990723
Epoch: 23, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.755 Vali Acc: 0.944 Test Loss: 0.755 Test Acc: 0.944
Validation loss decreased (-0.937028 --> -0.944437).  Saving model ...
Epoch: 24 cost time: 0.7265067100524902
Epoch: 24, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.688 Vali Acc: 0.948 Test Loss: 0.688 Test Acc: 0.948
Validation loss decreased (-0.944437 --> -0.948141).  Saving model ...
Epoch: 25 cost time: 0.6787197589874268
Epoch: 25, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.622 Vali Acc: 0.952 Test Loss: 0.622 Test Acc: 0.952
Validation loss decreased (-0.948141 --> -0.951846).  Saving model ...
Epoch: 26 cost time: 0.6425049304962158
Epoch: 26, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.559 Vali Acc: 0.948 Test Loss: 0.559 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5835776329040527
Epoch: 27, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.499 Vali Acc: 0.948 Test Loss: 0.499 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.682131290435791
Epoch: 28, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.444 Vali Acc: 0.944 Test Loss: 0.444 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6827080249786377
Epoch: 29, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.395 Vali Acc: 0.941 Test Loss: 0.395 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6975564956665039
Epoch: 30, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.351 Vali Acc: 0.952 Test Loss: 0.351 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951848).  Saving model ...
Epoch: 31 cost time: 0.6779739856719971
Epoch: 31, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.310 Vali Acc: 0.956 Test Loss: 0.310 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 32 cost time: 0.6432065963745117
Epoch: 32, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.276 Vali Acc: 0.959 Test Loss: 0.276 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 33 cost time: 0.7610418796539307
Epoch: 33, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.250 Vali Acc: 0.956 Test Loss: 0.250 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5594229698181152
Epoch: 34, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5962047576904297
Epoch: 35, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5609936714172363
Epoch: 36, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5890407562255859
Epoch: 37, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7720034122467041
Epoch: 38, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6020913124084473
Epoch: 39, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5737905502319336
Epoch: 40, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6375389099121094
Epoch: 41, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5929510593414307
Epoch: 42, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 29354502
model size : 126.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.742838144302368
Epoch: 1, Steps: 2 | Train Loss: 1.995 Vali Loss: 1.830 Vali Acc: 0.252 Test Loss: 1.830 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 0.6743783950805664
Epoch: 2, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.769 Vali Acc: 0.274 Test Loss: 1.769 Test Acc: 0.274
Validation loss decreased (-0.251834 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 0.8906800746917725
Epoch: 3, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.688 Vali Acc: 0.300 Test Loss: 1.688 Test Acc: 0.300
Validation loss decreased (-0.274056 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.7829275131225586
Epoch: 4, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.543 Vali Acc: 0.459 Test Loss: 1.543 Test Acc: 0.459
Validation loss decreased (-0.299983 --> -0.459244).  Saving model ...
Epoch: 5 cost time: 0.7898159027099609
Epoch: 5, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.375 Vali Acc: 0.652 Test Loss: 1.375 Test Acc: 0.652
Validation loss decreased (-0.459244 --> -0.651838).  Saving model ...
Epoch: 6 cost time: 0.8003106117248535
Epoch: 6, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.207 Vali Acc: 0.730 Test Loss: 1.207 Test Acc: 0.730
Validation loss decreased (-0.651838 --> -0.729618).  Saving model ...
Epoch: 7 cost time: 0.7670340538024902
Epoch: 7, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.048 Vali Acc: 0.752 Test Loss: 1.048 Test Acc: 0.752
Validation loss decreased (-0.729618 --> -0.751841).  Saving model ...
Epoch: 8 cost time: 0.8098094463348389
Epoch: 8, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.875 Vali Acc: 0.885 Test Loss: 0.875 Test Acc: 0.885
Validation loss decreased (-0.751841 --> -0.885176).  Saving model ...
Epoch: 9 cost time: 0.7947235107421875
Epoch: 9, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.734 Vali Acc: 0.911 Test Loss: 0.734 Test Acc: 0.911
Validation loss decreased (-0.885176 --> -0.911104).  Saving model ...
Epoch: 10 cost time: 0.6976370811462402
Epoch: 10, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.627 Vali Acc: 0.867 Test Loss: 0.627 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6923055648803711
Epoch: 11, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.533 Vali Acc: 0.907 Test Loss: 0.533 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8073482513427734
Epoch: 12, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.449 Vali Acc: 0.926 Test Loss: 0.449 Test Acc: 0.926
Validation loss decreased (-0.911104 --> -0.925921).  Saving model ...
Epoch: 13 cost time: 0.7283375263214111
Epoch: 13, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.400 Vali Acc: 0.922 Test Loss: 0.400 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6360073089599609
Epoch: 14, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929626).  Saving model ...
Epoch: 15 cost time: 0.8518142700195312
Epoch: 15, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.6742615699768066
Epoch: 16, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.268 Vali Acc: 0.915 Test Loss: 0.268 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5913453102111816
Epoch: 17, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7089352607727051
Epoch: 18, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7357909679412842
Epoch: 19, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.896 Test Loss: 0.252 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7435569763183594
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8073141574859619
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.7000055313110352
Epoch: 22, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7566399574279785
Epoch: 23, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0369584560394287
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7812073230743408
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.915 Test Loss: 0.214 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6678049564361572
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.915 Test Loss: 0.209 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7566628456115723
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8244345188140869
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.930079460144043
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9628350734710693
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.8202309608459473
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.7185225486755371
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.751899003982544
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.705211877822876
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.774599552154541
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7709977626800537
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7662596702575684
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7014834880828857
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7372515201568604
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8675744533538818
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7144689559936523
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22530822
model size : 100.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.599644899368286
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.736 Vali Acc: 0.130 Test Loss: 1.736 Test Acc: 0.130
Validation loss decreased (inf --> -0.129612).  Saving model ...
Epoch: 2 cost time: 0.5547752380371094
Epoch: 2, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.679 Vali Acc: 0.374 Test Loss: 1.679 Test Acc: 0.374
Validation loss decreased (-0.129612 --> -0.374057).  Saving model ...
Epoch: 3 cost time: 0.6356034278869629
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.626 Vali Acc: 0.533 Test Loss: 1.626 Test Acc: 0.533
Validation loss decreased (-0.374057 --> -0.533317).  Saving model ...
Epoch: 4 cost time: 0.6720921993255615
Epoch: 4, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.542 Vali Acc: 0.644 Test Loss: 1.542 Test Acc: 0.644
Validation loss decreased (-0.533317 --> -0.644429).  Saving model ...
Epoch: 5 cost time: 0.6519594192504883
Epoch: 5, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.436 Vali Acc: 0.722 Test Loss: 1.436 Test Acc: 0.722
Validation loss decreased (-0.644429 --> -0.722208).  Saving model ...
Epoch: 6 cost time: 0.5696911811828613
Epoch: 6, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.319 Vali Acc: 0.781 Test Loss: 1.319 Test Acc: 0.781
Validation loss decreased (-0.722208 --> -0.781468).  Saving model ...
Epoch: 7 cost time: 0.5883324146270752
Epoch: 7, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.200 Vali Acc: 0.826 Test Loss: 1.200 Test Acc: 0.826
Validation loss decreased (-0.781468 --> -0.825914).  Saving model ...
Epoch: 8 cost time: 0.6103036403656006
Epoch: 8, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.079 Vali Acc: 0.907 Test Loss: 1.079 Test Acc: 0.907
Validation loss decreased (-0.825914 --> -0.907397).  Saving model ...
Epoch: 9 cost time: 0.6293089389801025
Epoch: 9, Steps: 2 | Train Loss: 1.050 Vali Loss: 0.957 Vali Acc: 0.915 Test Loss: 0.957 Test Acc: 0.915
Validation loss decreased (-0.907397 --> -0.914805).  Saving model ...
Epoch: 10 cost time: 0.7283346652984619
Epoch: 10, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.845 Vali Acc: 0.930 Test Loss: 0.845 Test Acc: 0.930
Validation loss decreased (-0.914805 --> -0.929621).  Saving model ...
Epoch: 11 cost time: 0.6274511814117432
Epoch: 11, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.747 Vali Acc: 0.915 Test Loss: 0.747 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6614739894866943
Epoch: 12, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6533253192901611
Epoch: 13, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.581 Vali Acc: 0.926 Test Loss: 0.581 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6513345241546631
Epoch: 14, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.503 Vali Acc: 0.948 Test Loss: 0.503 Test Acc: 0.948
Validation loss decreased (-0.929621 --> -0.948143).  Saving model ...
Epoch: 15 cost time: 0.5756757259368896
Epoch: 15, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.442 Vali Acc: 0.944 Test Loss: 0.442 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6350843906402588
Epoch: 16, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.389 Vali Acc: 0.937 Test Loss: 0.389 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7801773548126221
Epoch: 17, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.347 Vali Acc: 0.941 Test Loss: 0.347 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.612626314163208
Epoch: 18, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5508449077606201
Epoch: 19, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6441540718078613
Epoch: 20, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7456417083740234
Epoch: 21, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7945280075073242
Epoch: 22, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6269888877868652
Epoch: 23, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6721527576446533
Epoch: 24, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.212 Vali Acc: 0.919 Test Loss: 0.212 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22340358
model size : 99.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5696117877960205
Epoch: 1, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.713 Vali Acc: 0.156 Test Loss: 1.713 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.8084590435028076
Epoch: 2, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.664 Vali Acc: 0.337 Test Loss: 1.664 Test Acc: 0.337
Validation loss decreased (-0.155538 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.6573495864868164
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.623 Vali Acc: 0.437 Test Loss: 1.623 Test Acc: 0.437
Validation loss decreased (-0.337020 --> -0.437021).  Saving model ...
Epoch: 4 cost time: 0.5887932777404785
Epoch: 4, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.569 Vali Acc: 0.504 Test Loss: 1.569 Test Acc: 0.504
Validation loss decreased (-0.437021 --> -0.503688).  Saving model ...
Epoch: 5 cost time: 0.5849394798278809
Epoch: 5, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.498 Vali Acc: 0.667 Test Loss: 1.498 Test Acc: 0.667
Validation loss decreased (-0.503688 --> -0.666652).  Saving model ...
Epoch: 6 cost time: 0.643773078918457
Epoch: 6, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.416 Vali Acc: 0.737 Test Loss: 1.416 Test Acc: 0.737
Validation loss decreased (-0.666652 --> -0.737023).  Saving model ...
Epoch: 7 cost time: 0.5906243324279785
Epoch: 7, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.325 Vali Acc: 0.733 Test Loss: 1.325 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7320084571838379
Epoch: 8, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.231 Vali Acc: 0.741 Test Loss: 1.231 Test Acc: 0.741
Validation loss decreased (-0.737023 --> -0.740728).  Saving model ...
Epoch: 9 cost time: 0.6348884105682373
Epoch: 9, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.134 Vali Acc: 0.781 Test Loss: 1.134 Test Acc: 0.781
Validation loss decreased (-0.740728 --> -0.781470).  Saving model ...
Epoch: 10 cost time: 0.6657462120056152
Epoch: 10, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.039 Vali Acc: 0.819 Test Loss: 1.039 Test Acc: 0.819
Validation loss decreased (-0.781470 --> -0.818508).  Saving model ...
Epoch: 11 cost time: 0.508763313293457
Epoch: 11, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.944 Vali Acc: 0.833 Test Loss: 0.944 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833324).  Saving model ...
Epoch: 12 cost time: 0.740234375
Epoch: 12, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.851 Vali Acc: 0.852 Test Loss: 0.851 Test Acc: 0.852
Validation loss decreased (-0.833324 --> -0.851843).  Saving model ...
Epoch: 13 cost time: 0.7600090503692627
Epoch: 13, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.763 Vali Acc: 0.889 Test Loss: 0.763 Test Acc: 0.889
Validation loss decreased (-0.851843 --> -0.888881).  Saving model ...
Epoch: 14 cost time: 0.6860594749450684
Epoch: 14, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.684 Vali Acc: 0.904 Test Loss: 0.684 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903697).  Saving model ...
Epoch: 15 cost time: 0.8437309265136719
Epoch: 15, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.613 Vali Acc: 0.911 Test Loss: 0.613 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 16 cost time: 0.7365608215332031
Epoch: 16, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.553 Vali Acc: 0.907 Test Loss: 0.553 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7544403076171875
Epoch: 17, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8294925689697266
Epoch: 18, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.445 Vali Acc: 0.919 Test Loss: 0.445 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.6455440521240234
Epoch: 19, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.397 Vali Acc: 0.926 Test Loss: 0.397 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 20 cost time: 0.9928445816040039
Epoch: 20, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 0.8283867835998535
Epoch: 21, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 22 cost time: 0.9712924957275391
Epoch: 22, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 0.6994657516479492
Epoch: 23, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8546426296234131
Epoch: 24, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8563439846038818
Epoch: 25, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8029623031616211
Epoch: 26, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8402044773101807
Epoch: 27, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.592968225479126
Epoch: 28, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 29 cost time: 0.653583288192749
Epoch: 29, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.930 Test Loss: 0.174 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6907434463500977
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.6738994121551514
Epoch: 31, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.937 Test Loss: 0.162 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.7274463176727295
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.163 Vali Acc: 0.933 Test Loss: 0.163 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8313593864440918
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.930 Test Loss: 0.164 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7006516456604004
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.926 Test Loss: 0.164 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.710512638092041
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.930 Test Loss: 0.164 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6961798667907715
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.930 Test Loss: 0.162 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6547331809997559
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.160 Vali Acc: 0.930 Test Loss: 0.160 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7836413383483887
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.930 Test Loss: 0.161 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5955042839050293
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.930 Test Loss: 0.162 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6947476863861084
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.926 Test Loss: 0.164 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6704452037811279
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.926 Test Loss: 0.164 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 22272774
model size : 99.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.906036615371704
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.799 Vali Acc: 0.241 Test Loss: 1.799 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.7324357032775879
Epoch: 2, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.752 Vali Acc: 0.252 Test Loss: 1.752 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.7267308235168457
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.704 Vali Acc: 0.337 Test Loss: 1.704 Test Acc: 0.337
Validation loss decreased (-0.251834 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 0.8222639560699463
Epoch: 4, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.562 Vali Acc: 0.389 Test Loss: 1.562 Test Acc: 0.389
Validation loss decreased (-0.337020 --> -0.388873).  Saving model ...
Epoch: 5 cost time: 0.677335262298584
Epoch: 5, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.384 Vali Acc: 0.522 Test Loss: 1.384 Test Acc: 0.522
Validation loss decreased (-0.388873 --> -0.522208).  Saving model ...
Epoch: 6 cost time: 0.6871695518493652
Epoch: 6, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.195 Vali Acc: 0.848 Test Loss: 1.195 Test Acc: 0.848
Validation loss decreased (-0.522208 --> -0.848136).  Saving model ...
Epoch: 7 cost time: 0.6768014430999756
Epoch: 7, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.031 Vali Acc: 0.841 Test Loss: 1.031 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6882731914520264
Epoch: 8, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.886 Vali Acc: 0.837 Test Loss: 0.886 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.743563175201416
Epoch: 9, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.751 Vali Acc: 0.900 Test Loss: 0.751 Test Acc: 0.900
Validation loss decreased (-0.848136 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.6388397216796875
Epoch: 10, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.643 Vali Acc: 0.930 Test Loss: 0.643 Test Acc: 0.930
Validation loss decreased (-0.899992 --> -0.929623).  Saving model ...
Epoch: 11 cost time: 0.6488800048828125
Epoch: 11, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.565 Vali Acc: 0.907 Test Loss: 0.565 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7298407554626465
Epoch: 12, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.495 Vali Acc: 0.911 Test Loss: 0.495 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6649091243743896
Epoch: 13, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8068177700042725
Epoch: 14, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.374 Vali Acc: 0.937 Test Loss: 0.374 Test Acc: 0.937
Validation loss decreased (-0.929623 --> -0.937033).  Saving model ...
Epoch: 15 cost time: 0.8378918170928955
Epoch: 15, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.333 Vali Acc: 0.930 Test Loss: 0.333 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7847723960876465
Epoch: 16, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.291 Vali Acc: 0.948 Test Loss: 0.291 Test Acc: 0.948
Validation loss decreased (-0.937033 --> -0.948145).  Saving model ...
Epoch: 17 cost time: 0.6593520641326904
Epoch: 17, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.776268482208252
Epoch: 18, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.725496768951416
Epoch: 19, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6953084468841553
Epoch: 20, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8420653343200684
Epoch: 21, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7138073444366455
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7078859806060791
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.919 Test Loss: 0.225 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8038289546966553
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.911 Test Loss: 0.210 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8870904445648193
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7680683135986328
Epoch: 26, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22533894
model size : 100.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6907219886779785
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.874 Vali Acc: 0.015 Test Loss: 1.874 Test Acc: 0.015
Validation loss decreased (inf --> -0.014796).  Saving model ...
Epoch: 2 cost time: 0.681424617767334
Epoch: 2, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.818 Vali Acc: 0.185 Test Loss: 1.818 Test Acc: 0.185
Validation loss decreased (-0.014796 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.7072646617889404
Epoch: 3, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.768 Vali Acc: 0.285 Test Loss: 1.768 Test Acc: 0.285
Validation loss decreased (-0.185167 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.6021220684051514
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.683 Vali Acc: 0.507 Test Loss: 1.683 Test Acc: 0.507
Validation loss decreased (-0.285168 --> -0.507391).  Saving model ...
Epoch: 5 cost time: 0.6484975814819336
Epoch: 5, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.577 Vali Acc: 0.600 Test Loss: 1.577 Test Acc: 0.600
Validation loss decreased (-0.507391 --> -0.599984).  Saving model ...
Epoch: 6 cost time: 0.7005352973937988
Epoch: 6, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.453 Vali Acc: 0.652 Test Loss: 1.453 Test Acc: 0.652
Validation loss decreased (-0.599984 --> -0.651837).  Saving model ...
Epoch: 7 cost time: 0.6738498210906982
Epoch: 7, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.323 Vali Acc: 0.767 Test Loss: 1.323 Test Acc: 0.767
Validation loss decreased (-0.651837 --> -0.766653).  Saving model ...
Epoch: 8 cost time: 0.7195863723754883
Epoch: 8, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.195 Vali Acc: 0.874 Test Loss: 1.195 Test Acc: 0.874
Validation loss decreased (-0.766653 --> -0.874062).  Saving model ...
Epoch: 9 cost time: 0.7987871170043945
Epoch: 9, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.073 Vali Acc: 0.878 Test Loss: 1.073 Test Acc: 0.878
Validation loss decreased (-0.874062 --> -0.877767).  Saving model ...
Epoch: 10 cost time: 0.6463479995727539
Epoch: 10, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.955 Vali Acc: 0.889 Test Loss: 0.955 Test Acc: 0.889
Validation loss decreased (-0.877767 --> -0.888879).  Saving model ...
Epoch: 11 cost time: 0.6131961345672607
Epoch: 11, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.851 Vali Acc: 0.893 Test Loss: 0.851 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892584).  Saving model ...
Epoch: 12 cost time: 0.6542444229125977
Epoch: 12, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.753 Vali Acc: 0.922 Test Loss: 0.753 Test Acc: 0.922
Validation loss decreased (-0.892584 --> -0.922215).  Saving model ...
Epoch: 13 cost time: 0.6064355373382568
Epoch: 13, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.667 Vali Acc: 0.926 Test Loss: 0.667 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 14 cost time: 0.6799161434173584
Epoch: 14, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.592 Vali Acc: 0.922 Test Loss: 0.592 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7492129802703857
Epoch: 15, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.524 Vali Acc: 0.919 Test Loss: 0.524 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7257609367370605
Epoch: 16, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.469 Vali Acc: 0.926 Test Loss: 0.469 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925921).  Saving model ...
Epoch: 17 cost time: 0.7364192008972168
Epoch: 17, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.418 Vali Acc: 0.926 Test Loss: 0.418 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 18 cost time: 0.710932731628418
Epoch: 18, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 19 cost time: 0.6715826988220215
Epoch: 19, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.337 Vali Acc: 0.933 Test Loss: 0.337 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 20 cost time: 0.6911118030548096
Epoch: 20, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7362780570983887
Epoch: 21, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.304 Vali Acc: 0.907 Test Loss: 0.304 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7878220081329346
Epoch: 22, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.7608354091644287
Epoch: 23, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7378542423248291
Epoch: 24, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7622857093811035
Epoch: 25, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7365987300872803
Epoch: 26, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6381025314331055
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.640495777130127
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7813029289245605
Epoch: 29, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6807444095611572
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.7194607257843018
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.8641841411590576
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.6351399421691895
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.7597875595092773
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7488789558410645
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6722381114959717
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7139265537261963
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.6956436634063721
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6352016925811768
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7564914226531982
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7354781627655029
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7892963886260986
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6469752788543701
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6248903274536133
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6819453239440918
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6455683708190918
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7128849029541016
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 22343430
model size : 99.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7474632263183594
Epoch: 1, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.825 Vali Acc: 0.119 Test Loss: 1.825 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.7112216949462891
Epoch: 2, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.786 Vali Acc: 0.163 Test Loss: 1.786 Test Acc: 0.163
Validation loss decreased (-0.118500 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.7479851245880127
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.753 Vali Acc: 0.248 Test Loss: 1.753 Test Acc: 0.248
Validation loss decreased (-0.162945 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.6590251922607422
Epoch: 4, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.708 Vali Acc: 0.393 Test Loss: 1.708 Test Acc: 0.393
Validation loss decreased (-0.248131 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.6976580619812012
Epoch: 5, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.651 Vali Acc: 0.470 Test Loss: 1.651 Test Acc: 0.470
Validation loss decreased (-0.392576 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.9304764270782471
Epoch: 6, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.586 Vali Acc: 0.567 Test Loss: 1.586 Test Acc: 0.567
Validation loss decreased (-0.470354 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 0.7950398921966553
Epoch: 7, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.515 Vali Acc: 0.637 Test Loss: 1.515 Test Acc: 0.637
Validation loss decreased (-0.566651 --> -0.637022).  Saving model ...
Epoch: 8 cost time: 0.629528284072876
Epoch: 8, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.436 Vali Acc: 0.707 Test Loss: 1.436 Test Acc: 0.707
Validation loss decreased (-0.637022 --> -0.707393).  Saving model ...
Epoch: 9 cost time: 0.7330608367919922
Epoch: 9, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.355 Vali Acc: 0.741 Test Loss: 1.355 Test Acc: 0.741
Validation loss decreased (-0.707393 --> -0.740727).  Saving model ...
Epoch: 10 cost time: 0.7418444156646729
Epoch: 10, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.272 Vali Acc: 0.796 Test Loss: 1.272 Test Acc: 0.796
Validation loss decreased (-0.740727 --> -0.796284).  Saving model ...
Epoch: 11 cost time: 0.5714905261993408
Epoch: 11, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.189 Vali Acc: 0.837 Test Loss: 1.189 Test Acc: 0.837
Validation loss decreased (-0.796284 --> -0.837025).  Saving model ...
Epoch: 12 cost time: 0.7054369449615479
Epoch: 12, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.106 Vali Acc: 0.867 Test Loss: 1.106 Test Acc: 0.867
Validation loss decreased (-0.837025 --> -0.866656).  Saving model ...
Epoch: 13 cost time: 0.7641823291778564
Epoch: 13, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.023 Vali Acc: 0.863 Test Loss: 1.023 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7618803977966309
Epoch: 14, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.942 Vali Acc: 0.900 Test Loss: 0.942 Test Acc: 0.900
Validation loss decreased (-0.866656 --> -0.899991).  Saving model ...
Epoch: 15 cost time: 0.7004225254058838
Epoch: 15, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.863 Vali Acc: 0.900 Test Loss: 0.863 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 16 cost time: 0.797694206237793
Epoch: 16, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.785 Vali Acc: 0.904 Test Loss: 0.785 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903696).  Saving model ...
Epoch: 17 cost time: 0.7421126365661621
Epoch: 17, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.715 Vali Acc: 0.911 Test Loss: 0.715 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 18 cost time: 0.7731056213378906
Epoch: 18, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.646 Vali Acc: 0.926 Test Loss: 0.646 Test Acc: 0.926
Validation loss decreased (-0.911104 --> -0.925919).  Saving model ...
Epoch: 19 cost time: 0.8053267002105713
Epoch: 19, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.586 Vali Acc: 0.926 Test Loss: 0.586 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925920).  Saving model ...
Epoch: 20 cost time: 0.6757020950317383
Epoch: 20, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.532 Vali Acc: 0.922 Test Loss: 0.532 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6292240619659424
Epoch: 21, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.485 Vali Acc: 0.922 Test Loss: 0.485 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6171963214874268
Epoch: 22, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.438 Vali Acc: 0.926 Test Loss: 0.438 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.7002148628234863
Epoch: 23, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.396 Vali Acc: 0.922 Test Loss: 0.396 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6756942272186279
Epoch: 24, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.360 Vali Acc: 0.926 Test Loss: 0.360 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 25 cost time: 0.7327139377593994
Epoch: 25, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 0.743659257888794
Epoch: 26, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8149747848510742
Epoch: 27, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6831910610198975
Epoch: 28, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5809502601623535
Epoch: 29, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6707994937896729
Epoch: 30, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.797339677810669
Epoch: 31, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.7246687412261963
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.6197693347930908
Epoch: 33, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.5897605419158936
Epoch: 34, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.7193584442138672
Epoch: 35, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.584312915802002
Epoch: 36, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5609147548675537
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.65525221824646
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6660428047180176
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.598578929901123
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.6017251014709473
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7430989742279053
Epoch: 42, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6465678215026855
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7470295429229736
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7357461452484131
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7754855155944824
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6006193161010742
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7063665390014648
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6287856101989746
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5817458629608154
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 22251270
model size : 99.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.984600067138672
Epoch: 1, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.769 Vali Acc: 0.363 Test Loss: 1.769 Test Acc: 0.363
Validation loss decreased (inf --> -0.362945).  Saving model ...
Epoch: 2 cost time: 0.6629488468170166
Epoch: 2, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.660 Vali Acc: 0.459 Test Loss: 1.660 Test Acc: 0.459
Validation loss decreased (-0.362945 --> -0.459243).  Saving model ...
Epoch: 3 cost time: 0.5890829563140869
Epoch: 3, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.583 Vali Acc: 0.463 Test Loss: 1.583 Test Acc: 0.463
Validation loss decreased (-0.459243 --> -0.462947).  Saving model ...
Epoch: 4 cost time: 0.567786455154419
Epoch: 4, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.502 Vali Acc: 0.622 Test Loss: 1.502 Test Acc: 0.622
Validation loss decreased (-0.462947 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 0.5920937061309814
Epoch: 5, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.399 Vali Acc: 0.685 Test Loss: 1.399 Test Acc: 0.685
Validation loss decreased (-0.622207 --> -0.685171).  Saving model ...
Epoch: 6 cost time: 0.6758403778076172
Epoch: 6, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.289 Vali Acc: 0.737 Test Loss: 1.289 Test Acc: 0.737
Validation loss decreased (-0.685171 --> -0.737024).  Saving model ...
Epoch: 7 cost time: 0.7598328590393066
Epoch: 7, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.175 Vali Acc: 0.763 Test Loss: 1.175 Test Acc: 0.763
Validation loss decreased (-0.737024 --> -0.762951).  Saving model ...
Epoch: 8 cost time: 0.8799595832824707
Epoch: 8, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.063 Vali Acc: 0.778 Test Loss: 1.063 Test Acc: 0.778
Validation loss decreased (-0.762951 --> -0.777767).  Saving model ...
Epoch: 9 cost time: 0.7818915843963623
Epoch: 9, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.952 Vali Acc: 0.841 Test Loss: 0.952 Test Acc: 0.841
Validation loss decreased (-0.777767 --> -0.840731).  Saving model ...
Epoch: 10 cost time: 0.9765565395355225
Epoch: 10, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.848 Vali Acc: 0.870 Test Loss: 0.848 Test Acc: 0.870
Validation loss decreased (-0.840731 --> -0.870362).  Saving model ...
Epoch: 11 cost time: 0.8443114757537842
Epoch: 11, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.756 Vali Acc: 0.874 Test Loss: 0.756 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874067).  Saving model ...
Epoch: 12 cost time: 0.7203290462493896
Epoch: 12, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.671 Vali Acc: 0.893 Test Loss: 0.671 Test Acc: 0.893
Validation loss decreased (-0.874067 --> -0.892586).  Saving model ...
Epoch: 13 cost time: 0.678577184677124
Epoch: 13, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.592 Vali Acc: 0.904 Test Loss: 0.592 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903698).  Saving model ...
Epoch: 14 cost time: 0.6857552528381348
Epoch: 14, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.530 Vali Acc: 0.878 Test Loss: 0.530 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.667076587677002
Epoch: 15, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.467 Vali Acc: 0.907 Test Loss: 0.467 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907403).  Saving model ...
Epoch: 16 cost time: 0.834714412689209
Epoch: 16, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 17 cost time: 0.6178545951843262
Epoch: 17, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.380 Vali Acc: 0.904 Test Loss: 0.380 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6795377731323242
Epoch: 18, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.344 Vali Acc: 0.911 Test Loss: 0.344 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.6042943000793457
Epoch: 19, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 20 cost time: 0.6343433856964111
Epoch: 20, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.6442980766296387
Epoch: 21, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.6741383075714111
Epoch: 22, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.7435092926025391
Epoch: 23, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 24 cost time: 0.6548316478729248
Epoch: 24, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7944450378417969
Epoch: 25, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 26 cost time: 0.7010035514831543
Epoch: 26, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5829472541809082
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 28 cost time: 0.6819376945495605
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.925924 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.7149264812469482
Epoch: 29, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.6678993701934814
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.937 Test Loss: 0.167 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8243472576141357
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6418254375457764
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7478039264678955
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7789623737335205
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7614398002624512
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.619175910949707
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7127315998077393
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7475860118865967
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7598438262939453
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22352646
model size : 99.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.959740400314331
Epoch: 1, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.707 Vali Acc: 0.259 Test Loss: 1.707 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.6196811199188232
Epoch: 2, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.631 Vali Acc: 0.333 Test Loss: 1.631 Test Acc: 0.333
Validation loss decreased (-0.259242 --> -0.333317).  Saving model ...
Epoch: 3 cost time: 0.680382251739502
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.572 Vali Acc: 0.496 Test Loss: 1.572 Test Acc: 0.496
Validation loss decreased (-0.333317 --> -0.496281).  Saving model ...
Epoch: 4 cost time: 0.6863753795623779
Epoch: 4, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.512 Vali Acc: 0.589 Test Loss: 1.512 Test Acc: 0.589
Validation loss decreased (-0.496281 --> -0.588874).  Saving model ...
Epoch: 5 cost time: 0.6497130393981934
Epoch: 5, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.439 Vali Acc: 0.696 Test Loss: 1.439 Test Acc: 0.696
Validation loss decreased (-0.588874 --> -0.696282).  Saving model ...
Epoch: 6 cost time: 0.6708319187164307
Epoch: 6, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.357 Vali Acc: 0.759 Test Loss: 1.357 Test Acc: 0.759
Validation loss decreased (-0.696282 --> -0.759246).  Saving model ...
Epoch: 7 cost time: 0.5797450542449951
Epoch: 7, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.266 Vali Acc: 0.811 Test Loss: 1.266 Test Acc: 0.811
Validation loss decreased (-0.759246 --> -0.811098).  Saving model ...
Epoch: 8 cost time: 0.66469407081604
Epoch: 8, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.172 Vali Acc: 0.833 Test Loss: 1.172 Test Acc: 0.833
Validation loss decreased (-0.811098 --> -0.833322).  Saving model ...
Epoch: 9 cost time: 0.6828403472900391
Epoch: 9, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.077 Vali Acc: 0.848 Test Loss: 1.077 Test Acc: 0.848
Validation loss decreased (-0.833322 --> -0.848137).  Saving model ...
Epoch: 10 cost time: 0.5773122310638428
Epoch: 10, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.985 Vali Acc: 0.863 Test Loss: 0.985 Test Acc: 0.863
Validation loss decreased (-0.848137 --> -0.862953).  Saving model ...
Epoch: 11 cost time: 0.8042914867401123
Epoch: 11, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.898 Vali Acc: 0.859 Test Loss: 0.898 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.826042890548706
Epoch: 12, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.812 Vali Acc: 0.885 Test Loss: 0.812 Test Acc: 0.885
Validation loss decreased (-0.862953 --> -0.885177).  Saving model ...
Epoch: 13 cost time: 0.6214332580566406
Epoch: 13, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.730 Vali Acc: 0.896 Test Loss: 0.730 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 14 cost time: 0.6204054355621338
Epoch: 14, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.654 Vali Acc: 0.926 Test Loss: 0.654 Test Acc: 0.926
Validation loss decreased (-0.896289 --> -0.925919).  Saving model ...
Epoch: 15 cost time: 0.7426629066467285
Epoch: 15, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.588 Vali Acc: 0.922 Test Loss: 0.588 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6998882293701172
Epoch: 16, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.531 Vali Acc: 0.911 Test Loss: 0.531 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6045022010803223
Epoch: 17, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.486 Vali Acc: 0.915 Test Loss: 0.486 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7045326232910156
Epoch: 18, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.442 Vali Acc: 0.919 Test Loss: 0.442 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7129716873168945
Epoch: 19, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.397 Vali Acc: 0.926 Test Loss: 0.397 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925922).  Saving model ...
Epoch: 20 cost time: 0.8384857177734375
Epoch: 20, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.351 Vali Acc: 0.926 Test Loss: 0.351 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.6346533298492432
Epoch: 21, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
Validation loss decreased (-0.925922 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.5960180759429932
Epoch: 22, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9186854362487793
Epoch: 23, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7334401607513428
Epoch: 24, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6758842468261719
Epoch: 25, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5725948810577393
Epoch: 26, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.61887526512146
Epoch: 27, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7209901809692383
Epoch: 28, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7621526718139648
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.926 Test Loss: 0.188 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.683413028717041
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5713050365447998
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.933 Test Loss: 0.168 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22291206
model size : 99.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1118946075439453
Epoch: 1, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.843 Vali Acc: 0.167 Test Loss: 1.843 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.6200923919677734
Epoch: 2, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.761 Vali Acc: 0.222 Test Loss: 1.761 Test Acc: 0.222
Validation loss decreased (-0.166648 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.6708786487579346
Epoch: 3, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.709 Vali Acc: 0.281 Test Loss: 1.709 Test Acc: 0.281
Validation loss decreased (-0.222205 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.5970137119293213
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.661 Vali Acc: 0.381 Test Loss: 1.661 Test Acc: 0.381
Validation loss decreased (-0.281464 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 0.5060701370239258
Epoch: 5, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.603 Vali Acc: 0.474 Test Loss: 1.603 Test Acc: 0.474
Validation loss decreased (-0.381465 --> -0.474058).  Saving model ...
Epoch: 6 cost time: 0.5759458541870117
Epoch: 6, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.539 Vali Acc: 0.556 Test Loss: 1.539 Test Acc: 0.556
Validation loss decreased (-0.474058 --> -0.555540).  Saving model ...
Epoch: 7 cost time: 0.5522160530090332
Epoch: 7, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.470 Vali Acc: 0.648 Test Loss: 1.470 Test Acc: 0.648
Validation loss decreased (-0.555540 --> -0.648133).  Saving model ...
Epoch: 8 cost time: 0.5178406238555908
Epoch: 8, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.399 Vali Acc: 0.715 Test Loss: 1.399 Test Acc: 0.715
Validation loss decreased (-0.648133 --> -0.714801).  Saving model ...
Epoch: 9 cost time: 0.6117904186248779
Epoch: 9, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.322 Vali Acc: 0.770 Test Loss: 1.322 Test Acc: 0.770
Validation loss decreased (-0.714801 --> -0.770357).  Saving model ...
Epoch: 10 cost time: 0.6713869571685791
Epoch: 10, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.243 Vali Acc: 0.833 Test Loss: 1.243 Test Acc: 0.833
Validation loss decreased (-0.770357 --> -0.833321).  Saving model ...
Epoch: 11 cost time: 0.5150718688964844
Epoch: 11, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.159 Vali Acc: 0.867 Test Loss: 1.159 Test Acc: 0.867
Validation loss decreased (-0.833321 --> -0.866655).  Saving model ...
Epoch: 12 cost time: 0.7054107189178467
Epoch: 12, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.073 Vali Acc: 0.881 Test Loss: 1.073 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881471).  Saving model ...
Epoch: 13 cost time: 0.602400541305542
Epoch: 13, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.990 Vali Acc: 0.900 Test Loss: 0.990 Test Acc: 0.900
Validation loss decreased (-0.881471 --> -0.899990).  Saving model ...
Epoch: 14 cost time: 0.5254502296447754
Epoch: 14, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.910 Vali Acc: 0.926 Test Loss: 0.910 Test Acc: 0.926
Validation loss decreased (-0.899990 --> -0.925917).  Saving model ...
Epoch: 15 cost time: 0.6295714378356934
Epoch: 15, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.834 Vali Acc: 0.933 Test Loss: 0.834 Test Acc: 0.933
Validation loss decreased (-0.925917 --> -0.933325).  Saving model ...
Epoch: 16 cost time: 0.6380553245544434
Epoch: 16, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.758 Vali Acc: 0.930 Test Loss: 0.758 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.49399805068969727
Epoch: 17, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.688 Vali Acc: 0.941 Test Loss: 0.688 Test Acc: 0.941
Validation loss decreased (-0.933325 --> -0.940734).  Saving model ...
Epoch: 18 cost time: 0.6257302761077881
Epoch: 18, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.622 Vali Acc: 0.944 Test Loss: 0.622 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 19 cost time: 0.7412641048431396
Epoch: 19, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.563 Vali Acc: 0.956 Test Loss: 0.563 Test Acc: 0.956
Validation loss decreased (-0.944438 --> -0.955550).  Saving model ...
Epoch: 20 cost time: 0.6443779468536377
Epoch: 20, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.508 Vali Acc: 0.941 Test Loss: 0.508 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6373996734619141
Epoch: 21, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.458 Vali Acc: 0.941 Test Loss: 0.458 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6798903942108154
Epoch: 22, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.418 Vali Acc: 0.919 Test Loss: 0.418 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6499700546264648
Epoch: 23, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6469907760620117
Epoch: 24, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.341 Vali Acc: 0.948 Test Loss: 0.341 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7278378009796143
Epoch: 25, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.311 Vali Acc: 0.948 Test Loss: 0.311 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6087968349456787
Epoch: 26, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.728020191192627
Epoch: 27, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6548738479614258
Epoch: 28, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5926258563995361
Epoch: 29, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 22242054
model size : 99.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.365051031112671
Epoch: 1, Steps: 2 | Train Loss: 1.970 Vali Loss: 1.933 Vali Acc: 0.137 Test Loss: 1.933 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 0.5807094573974609
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.864 Vali Acc: 0.156 Test Loss: 1.864 Test Acc: 0.156
Validation loss decreased (-0.137018 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 0.7555654048919678
Epoch: 3, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.812 Vali Acc: 0.156 Test Loss: 1.812 Test Acc: 0.156
Validation loss decreased (-0.155537 --> -0.155537).  Saving model ...
Epoch: 4 cost time: 0.6806175708770752
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.728 Vali Acc: 0.219 Test Loss: 1.728 Test Acc: 0.219
Validation loss decreased (-0.155537 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 0.7344143390655518
Epoch: 5, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.624 Vali Acc: 0.356 Test Loss: 1.624 Test Acc: 0.356
Validation loss decreased (-0.218501 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.6573407649993896
Epoch: 6, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.504 Vali Acc: 0.604 Test Loss: 1.504 Test Acc: 0.604
Validation loss decreased (-0.355539 --> -0.603689).  Saving model ...
Epoch: 7 cost time: 0.637824535369873
Epoch: 7, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.369 Vali Acc: 0.748 Test Loss: 1.369 Test Acc: 0.748
Validation loss decreased (-0.603689 --> -0.748134).  Saving model ...
Epoch: 8 cost time: 0.6644737720489502
Epoch: 8, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.233 Vali Acc: 0.833 Test Loss: 1.233 Test Acc: 0.833
Validation loss decreased (-0.748134 --> -0.833321).  Saving model ...
Epoch: 9 cost time: 0.7314987182617188
Epoch: 9, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.104 Vali Acc: 0.893 Test Loss: 1.104 Test Acc: 0.893
Validation loss decreased (-0.833321 --> -0.892582).  Saving model ...
Epoch: 10 cost time: 0.7423617839813232
Epoch: 10, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.982 Vali Acc: 0.878 Test Loss: 0.982 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7424719333648682
Epoch: 11, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.868 Vali Acc: 0.870 Test Loss: 0.868 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7047891616821289
Epoch: 12, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.754 Vali Acc: 0.878 Test Loss: 0.754 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5602376461029053
Epoch: 13, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.656 Vali Acc: 0.878 Test Loss: 0.656 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6080021858215332
Epoch: 14, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.569 Vali Acc: 0.922 Test Loss: 0.569 Test Acc: 0.922
Validation loss decreased (-0.892582 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.761455774307251
Epoch: 15, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.495 Vali Acc: 0.933 Test Loss: 0.495 Test Acc: 0.933
Validation loss decreased (-0.922217 --> -0.933328).  Saving model ...
Epoch: 16 cost time: 0.6020245552062988
Epoch: 16, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.436 Vali Acc: 0.922 Test Loss: 0.436 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.758476972579956
Epoch: 17, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.386 Vali Acc: 0.933 Test Loss: 0.386 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 18 cost time: 0.7113528251647949
Epoch: 18, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.339 Vali Acc: 0.933 Test Loss: 0.339 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 0.6178638935089111
Epoch: 19, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6037993431091309
Epoch: 20, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.7006957530975342
Epoch: 21, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7212929725646973
Epoch: 22, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5983271598815918
Epoch: 23, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6872637271881104
Epoch: 24, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7178962230682373
Epoch: 25, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.915 Test Loss: 0.199 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6275620460510254
Epoch: 26, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5711638927459717
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.915 Test Loss: 0.247 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7199058532714844
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7432212829589844
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7497909069061279
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 22355718
model size : 99.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.540231466293335
Epoch: 1, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.838 Vali Acc: 0.196 Test Loss: 1.838 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.8396131992340088
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.807 Vali Acc: 0.219 Test Loss: 1.807 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218500).  Saving model ...
Epoch: 3 cost time: 0.6667356491088867
Epoch: 3, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.767 Vali Acc: 0.252 Test Loss: 1.767 Test Acc: 0.252
Validation loss decreased (-0.218500 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 0.6181879043579102
Epoch: 4, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.705 Vali Acc: 0.315 Test Loss: 1.705 Test Acc: 0.315
Validation loss decreased (-0.251834 --> -0.314798).  Saving model ...
Epoch: 5 cost time: 0.6615827083587646
Epoch: 5, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.628 Vali Acc: 0.411 Test Loss: 1.628 Test Acc: 0.411
Validation loss decreased (-0.314798 --> -0.411095).  Saving model ...
Epoch: 6 cost time: 0.6732733249664307
Epoch: 6, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.544 Vali Acc: 0.507 Test Loss: 1.544 Test Acc: 0.507
Validation loss decreased (-0.411095 --> -0.507392).  Saving model ...
Epoch: 7 cost time: 0.7546706199645996
Epoch: 7, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.458 Vali Acc: 0.607 Test Loss: 1.458 Test Acc: 0.607
Validation loss decreased (-0.507392 --> -0.607393).  Saving model ...
Epoch: 8 cost time: 0.7225675582885742
Epoch: 8, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.362 Vali Acc: 0.778 Test Loss: 1.362 Test Acc: 0.778
Validation loss decreased (-0.607393 --> -0.777764).  Saving model ...
Epoch: 9 cost time: 0.6386358737945557
Epoch: 9, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.257 Vali Acc: 0.830 Test Loss: 1.257 Test Acc: 0.830
Validation loss decreased (-0.777764 --> -0.829617).  Saving model ...
Epoch: 10 cost time: 0.6277365684509277
Epoch: 10, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.156 Vali Acc: 0.859 Test Loss: 1.156 Test Acc: 0.859
Validation loss decreased (-0.829617 --> -0.859248).  Saving model ...
Epoch: 11 cost time: 0.713712215423584
Epoch: 11, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.059 Vali Acc: 0.852 Test Loss: 1.059 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.663682222366333
Epoch: 12, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.967 Vali Acc: 0.844 Test Loss: 0.967 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6761252880096436
Epoch: 13, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.880 Vali Acc: 0.833 Test Loss: 0.880 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6633608341217041
Epoch: 14, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.792 Vali Acc: 0.852 Test Loss: 0.792 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6209878921508789
Epoch: 15, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.710 Vali Acc: 0.874 Test Loss: 0.710 Test Acc: 0.874
Validation loss decreased (-0.859248 --> -0.874067).  Saving model ...
Epoch: 16 cost time: 0.6682476997375488
Epoch: 16, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
Validation loss decreased (-0.874067 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.729175329208374
Epoch: 17, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.564 Vali Acc: 0.911 Test Loss: 0.564 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911105).  Saving model ...
Epoch: 18 cost time: 0.6522560119628906
Epoch: 18, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.506 Vali Acc: 0.919 Test Loss: 0.506 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 19 cost time: 0.9317116737365723
Epoch: 19, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.451 Vali Acc: 0.915 Test Loss: 0.451 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8739955425262451
Epoch: 20, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.402 Vali Acc: 0.922 Test Loss: 0.402 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.6514036655426025
Epoch: 21, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.6681563854217529
Epoch: 22, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.7039940357208252
Epoch: 23, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7348275184631348
Epoch: 24, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7925395965576172
Epoch: 25, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.711848258972168
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7005915641784668
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6836018562316895
Epoch: 28, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.250 Vali Acc: 0.904 Test Loss: 0.250 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5987114906311035
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.264 Vali Acc: 0.900 Test Loss: 0.264 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5597920417785645
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.265 Vali Acc: 0.904 Test Loss: 0.265 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7120170593261719
Epoch: 31, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.265 Vali Acc: 0.904 Test Loss: 0.265 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8994948863983154
Epoch: 32, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.278 Vali Acc: 0.904 Test Loss: 0.278 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 22294278
model size : 99.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2528843879699707
Epoch: 1, Steps: 2 | Train Loss: 2.024 Vali Loss: 1.952 Vali Acc: 0.167 Test Loss: 1.952 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6490428447723389
Epoch: 2, Steps: 2 | Train Loss: 1.943 Vali Loss: 1.848 Vali Acc: 0.159 Test Loss: 1.848 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6454963684082031
Epoch: 3, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.798 Vali Acc: 0.159 Test Loss: 1.798 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6650619506835938
Epoch: 4, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.757 Vali Acc: 0.267 Test Loss: 1.757 Test Acc: 0.267
Validation loss decreased (-0.166647 --> -0.266649).  Saving model ...
Epoch: 5 cost time: 0.534895658493042
Epoch: 5, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.709 Vali Acc: 0.422 Test Loss: 1.709 Test Acc: 0.422
Validation loss decreased (-0.266649 --> -0.422205).  Saving model ...
Epoch: 6 cost time: 0.5985770225524902
Epoch: 6, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.655 Vali Acc: 0.511 Test Loss: 1.655 Test Acc: 0.511
Validation loss decreased (-0.422205 --> -0.511095).  Saving model ...
Epoch: 7 cost time: 0.6874270439147949
Epoch: 7, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.598 Vali Acc: 0.570 Test Loss: 1.598 Test Acc: 0.570
Validation loss decreased (-0.511095 --> -0.570354).  Saving model ...
Epoch: 8 cost time: 0.6429769992828369
Epoch: 8, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.538 Vali Acc: 0.648 Test Loss: 1.538 Test Acc: 0.648
Validation loss decreased (-0.570354 --> -0.648133).  Saving model ...
Epoch: 9 cost time: 0.6528415679931641
Epoch: 9, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.474 Vali Acc: 0.722 Test Loss: 1.474 Test Acc: 0.722
Validation loss decreased (-0.648133 --> -0.722207).  Saving model ...
Epoch: 10 cost time: 0.5339722633361816
Epoch: 10, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.406 Vali Acc: 0.770 Test Loss: 1.406 Test Acc: 0.770
Validation loss decreased (-0.722207 --> -0.770356).  Saving model ...
Epoch: 11 cost time: 0.6194124221801758
Epoch: 11, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.334 Vali Acc: 0.819 Test Loss: 1.334 Test Acc: 0.819
Validation loss decreased (-0.770356 --> -0.818505).  Saving model ...
Epoch: 12 cost time: 0.552217960357666
Epoch: 12, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.262 Vali Acc: 0.830 Test Loss: 1.262 Test Acc: 0.830
Validation loss decreased (-0.818505 --> -0.829617).  Saving model ...
Epoch: 13 cost time: 0.6170239448547363
Epoch: 13, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.189 Vali Acc: 0.844 Test Loss: 1.189 Test Acc: 0.844
Validation loss decreased (-0.829617 --> -0.844433).  Saving model ...
Epoch: 14 cost time: 0.5741143226623535
Epoch: 14, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.114 Vali Acc: 0.841 Test Loss: 1.114 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6673860549926758
Epoch: 15, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.039 Vali Acc: 0.852 Test Loss: 1.039 Test Acc: 0.852
Validation loss decreased (-0.844433 --> -0.851841).  Saving model ...
Epoch: 16 cost time: 0.5814552307128906
Epoch: 16, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.965 Vali Acc: 0.852 Test Loss: 0.965 Test Acc: 0.852
Validation loss decreased (-0.851841 --> -0.851842).  Saving model ...
Epoch: 17 cost time: 0.574176549911499
Epoch: 17, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.890 Vali Acc: 0.874 Test Loss: 0.890 Test Acc: 0.874
Validation loss decreased (-0.851842 --> -0.874065).  Saving model ...
Epoch: 18 cost time: 0.5679564476013184
Epoch: 18, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.814 Vali Acc: 0.889 Test Loss: 0.814 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888881).  Saving model ...
Epoch: 19 cost time: 0.5994646549224854
Epoch: 19, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.741 Vali Acc: 0.904 Test Loss: 0.741 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903696).  Saving model ...
Epoch: 20 cost time: 0.6234033107757568
Epoch: 20, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.666 Vali Acc: 0.919 Test Loss: 0.666 Test Acc: 0.919
Validation loss decreased (-0.903696 --> -0.918512).  Saving model ...
Epoch: 21 cost time: 0.633643627166748
Epoch: 21, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.593 Vali Acc: 0.911 Test Loss: 0.593 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.727891206741333
Epoch: 22, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.527 Vali Acc: 0.911 Test Loss: 0.527 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6481192111968994
Epoch: 23, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.463 Vali Acc: 0.904 Test Loss: 0.463 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7345559597015381
Epoch: 24, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.406 Vali Acc: 0.911 Test Loss: 0.406 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7555215358734131
Epoch: 25, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 0.543846607208252
Epoch: 26, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5570402145385742
Epoch: 27, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6295642852783203
Epoch: 28, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.75217604637146
Epoch: 29, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6437296867370605
Epoch: 30, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.251 Vali Acc: 0.907 Test Loss: 0.251 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6679530143737793
Epoch: 31, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.6304800510406494
Epoch: 32, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6504952907562256
Epoch: 33, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.231 Vali Acc: 0.911 Test Loss: 0.231 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.572023868560791
Epoch: 34, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.222 Vali Acc: 0.915 Test Loss: 0.222 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6086769104003906
Epoch: 35, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.589444637298584
Epoch: 36, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.915 Test Loss: 0.216 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6128649711608887
Epoch: 37, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.915 Test Loss: 0.218 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6625442504882812
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.630096435546875
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.907 Test Loss: 0.227 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6524004936218262
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5495345592498779
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 22232838
model size : 99.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6027028560638428
Epoch: 1, Steps: 2 | Train Loss: 2.021 Vali Loss: 1.865 Vali Acc: 0.156 Test Loss: 1.865 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.5659265518188477
Epoch: 2, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.790 Vali Acc: 0.200 Test Loss: 1.790 Test Acc: 0.200
Validation loss decreased (-0.155537 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6567065715789795
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.721 Vali Acc: 0.281 Test Loss: 1.721 Test Acc: 0.281
Validation loss decreased (-0.199982 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.9177448749542236
Epoch: 4, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.629 Vali Acc: 0.411 Test Loss: 1.629 Test Acc: 0.411
Validation loss decreased (-0.281464 --> -0.411095).  Saving model ...
Epoch: 5 cost time: 0.6203322410583496
Epoch: 5, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.520 Vali Acc: 0.589 Test Loss: 1.520 Test Acc: 0.589
Validation loss decreased (-0.411095 --> -0.588874).  Saving model ...
Epoch: 6 cost time: 0.7701668739318848
Epoch: 6, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.400 Vali Acc: 0.670 Test Loss: 1.400 Test Acc: 0.670
Validation loss decreased (-0.588874 --> -0.670356).  Saving model ...
Epoch: 7 cost time: 0.7554996013641357
Epoch: 7, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.272 Vali Acc: 0.733 Test Loss: 1.272 Test Acc: 0.733
Validation loss decreased (-0.670356 --> -0.733321).  Saving model ...
Epoch: 8 cost time: 0.6811895370483398
Epoch: 8, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.146 Vali Acc: 0.756 Test Loss: 1.146 Test Acc: 0.756
Validation loss decreased (-0.733321 --> -0.755544).  Saving model ...
Epoch: 9 cost time: 0.7366070747375488
Epoch: 9, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.026 Vali Acc: 0.811 Test Loss: 1.026 Test Acc: 0.811
Validation loss decreased (-0.755544 --> -0.811101).  Saving model ...
Epoch: 10 cost time: 0.8192880153656006
Epoch: 10, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.916 Vali Acc: 0.852 Test Loss: 0.916 Test Acc: 0.852
Validation loss decreased (-0.811101 --> -0.851843).  Saving model ...
Epoch: 11 cost time: 0.9611496925354004
Epoch: 11, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.809 Vali Acc: 0.878 Test Loss: 0.809 Test Acc: 0.878
Validation loss decreased (-0.851843 --> -0.877770).  Saving model ...
Epoch: 12 cost time: 0.6607112884521484
Epoch: 12, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.712 Vali Acc: 0.881 Test Loss: 0.712 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 13 cost time: 0.6986284255981445
Epoch: 13, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.628 Vali Acc: 0.885 Test Loss: 0.628 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885179).  Saving model ...
Epoch: 14 cost time: 0.7298405170440674
Epoch: 14, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.556 Vali Acc: 0.904 Test Loss: 0.556 Test Acc: 0.904
Validation loss decreased (-0.885179 --> -0.903698).  Saving model ...
Epoch: 15 cost time: 0.6041300296783447
Epoch: 15, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.492 Vali Acc: 0.919 Test Loss: 0.492 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918514).  Saving model ...
Epoch: 16 cost time: 0.7262647151947021
Epoch: 16, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.443 Vali Acc: 0.907 Test Loss: 0.443 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8691465854644775
Epoch: 17, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.410 Vali Acc: 0.893 Test Loss: 0.410 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7321653366088867
Epoch: 18, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.365 Vali Acc: 0.907 Test Loss: 0.365 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6389544010162354
Epoch: 19, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6653439998626709
Epoch: 20, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.6856861114501953
Epoch: 21, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.5835151672363281
Epoch: 22, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.6001596450805664
Epoch: 23, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7673273086547852
Epoch: 24, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6330251693725586
Epoch: 25, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.6600563526153564
Epoch: 26, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.926 Test Loss: 0.189 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6370584964752197
Epoch: 27, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.926 Test Loss: 0.177 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7112722396850586
Epoch: 28, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.167 Vali Acc: 0.930 Test Loss: 0.167 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.568584680557251
Epoch: 29, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.937 Test Loss: 0.162 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.5134437084197998
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.933 Test Loss: 0.166 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.617586612701416
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6009151935577393
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.163 Vali Acc: 0.937 Test Loss: 0.163 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5474209785461426
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.937 Test Loss: 0.163 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6970722675323486
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.919 Test Loss: 0.170 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6556651592254639
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.922 Test Loss: 0.176 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6920464038848877
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5806050300598145
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6760039329528809
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.637911319732666
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 22364934
model size : 99.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.648676872253418
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.738 Vali Acc: 0.267 Test Loss: 1.738 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.6493158340454102
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.695 Vali Acc: 0.174 Test Loss: 1.695 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6761181354522705
Epoch: 3, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.659 Vali Acc: 0.263 Test Loss: 1.659 Test Acc: 0.263
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7098245620727539
Epoch: 4, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.615 Vali Acc: 0.411 Test Loss: 1.615 Test Acc: 0.411
Validation loss decreased (-0.266649 --> -0.411095).  Saving model ...
Epoch: 5 cost time: 0.7479836940765381
Epoch: 5, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.560 Vali Acc: 0.493 Test Loss: 1.560 Test Acc: 0.493
Validation loss decreased (-0.411095 --> -0.492577).  Saving model ...
Epoch: 6 cost time: 0.8069703578948975
Epoch: 6, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.494 Vali Acc: 0.574 Test Loss: 1.494 Test Acc: 0.574
Validation loss decreased (-0.492577 --> -0.574059).  Saving model ...
Epoch: 7 cost time: 0.6634070873260498
Epoch: 7, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.421 Vali Acc: 0.644 Test Loss: 1.421 Test Acc: 0.644
Validation loss decreased (-0.574059 --> -0.644430).  Saving model ...
Epoch: 8 cost time: 0.6040971279144287
Epoch: 8, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.342 Vali Acc: 0.726 Test Loss: 1.342 Test Acc: 0.726
Validation loss decreased (-0.644430 --> -0.725913).  Saving model ...
Epoch: 9 cost time: 0.45330190658569336
Epoch: 9, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.257 Vali Acc: 0.819 Test Loss: 1.257 Test Acc: 0.819
Validation loss decreased (-0.725913 --> -0.818506).  Saving model ...
Epoch: 10 cost time: 0.6777982711791992
Epoch: 10, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.169 Vali Acc: 0.848 Test Loss: 1.169 Test Acc: 0.848
Validation loss decreased (-0.818506 --> -0.848136).  Saving model ...
Epoch: 11 cost time: 0.7652311325073242
Epoch: 11, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.083 Vali Acc: 0.856 Test Loss: 1.083 Test Acc: 0.856
Validation loss decreased (-0.848136 --> -0.855545).  Saving model ...
Epoch: 12 cost time: 0.806971549987793
Epoch: 12, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.999 Vali Acc: 0.844 Test Loss: 0.999 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6020710468292236
Epoch: 13, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.920 Vali Acc: 0.863 Test Loss: 0.920 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862954).  Saving model ...
Epoch: 14 cost time: 0.7010576725006104
Epoch: 14, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.845 Vali Acc: 0.881 Test Loss: 0.845 Test Acc: 0.881
Validation loss decreased (-0.862954 --> -0.881473).  Saving model ...
Epoch: 15 cost time: 0.6435792446136475
Epoch: 15, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.775 Vali Acc: 0.885 Test Loss: 0.775 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885177).  Saving model ...
Epoch: 16 cost time: 0.7045819759368896
Epoch: 16, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.709 Vali Acc: 0.896 Test Loss: 0.709 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 17 cost time: 0.5955648422241211
Epoch: 17, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.643 Vali Acc: 0.915 Test Loss: 0.643 Test Acc: 0.915
Validation loss decreased (-0.896289 --> -0.914808).  Saving model ...
Epoch: 18 cost time: 0.6384656429290771
Epoch: 18, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.580 Vali Acc: 0.948 Test Loss: 0.580 Test Acc: 0.948
Validation loss decreased (-0.914808 --> -0.948142).  Saving model ...
Epoch: 19 cost time: 0.6333603858947754
Epoch: 19, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.525 Vali Acc: 0.941 Test Loss: 0.525 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6083126068115234
Epoch: 20, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.472 Vali Acc: 0.941 Test Loss: 0.472 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5655605792999268
Epoch: 21, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.426 Vali Acc: 0.944 Test Loss: 0.426 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6086254119873047
Epoch: 22, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.390 Vali Acc: 0.933 Test Loss: 0.390 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6604266166687012
Epoch: 23, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5732834339141846
Epoch: 24, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6176173686981201
Epoch: 25, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6949973106384277
Epoch: 26, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6053433418273926
Epoch: 27, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6600489616394043
Epoch: 28, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22272774
model size : 99.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3023037910461426
Epoch: 1, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.914 Vali Acc: 0.159 Test Loss: 1.914 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.5912332534790039
Epoch: 2, Steps: 2 | Train Loss: 2.022 Vali Loss: 1.845 Vali Acc: 0.144 Test Loss: 1.845 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6348774433135986
Epoch: 3, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.800 Vali Acc: 0.148 Test Loss: 1.800 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5211808681488037
Epoch: 4, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.760 Vali Acc: 0.148 Test Loss: 1.760 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48531341552734375
Epoch: 5, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.712 Vali Acc: 0.181 Test Loss: 1.712 Test Acc: 0.181
Validation loss decreased (-0.159240 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.616797924041748
Epoch: 6, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.657 Vali Acc: 0.270 Test Loss: 1.657 Test Acc: 0.270
Validation loss decreased (-0.181464 --> -0.270354).  Saving model ...
Epoch: 7 cost time: 0.6482341289520264
Epoch: 7, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.602 Vali Acc: 0.444 Test Loss: 1.602 Test Acc: 0.444
Validation loss decreased (-0.270354 --> -0.444428).  Saving model ...
Epoch: 8 cost time: 0.6745688915252686
Epoch: 8, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.542 Vali Acc: 0.581 Test Loss: 1.542 Test Acc: 0.581
Validation loss decreased (-0.444428 --> -0.581466).  Saving model ...
Epoch: 9 cost time: 0.5414979457855225
Epoch: 9, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.480 Vali Acc: 0.652 Test Loss: 1.480 Test Acc: 0.652
Validation loss decreased (-0.581466 --> -0.651837).  Saving model ...
Epoch: 10 cost time: 0.7249648571014404
Epoch: 10, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.415 Vali Acc: 0.730 Test Loss: 1.415 Test Acc: 0.730
Validation loss decreased (-0.651837 --> -0.729615).  Saving model ...
Epoch: 11 cost time: 0.5928583145141602
Epoch: 11, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.345 Vali Acc: 0.752 Test Loss: 1.345 Test Acc: 0.752
Validation loss decreased (-0.729615 --> -0.751838).  Saving model ...
Epoch: 12 cost time: 0.5092597007751465
Epoch: 12, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.273 Vali Acc: 0.770 Test Loss: 1.273 Test Acc: 0.770
Validation loss decreased (-0.751838 --> -0.770358).  Saving model ...
Epoch: 13 cost time: 0.5456693172454834
Epoch: 13, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.201 Vali Acc: 0.800 Test Loss: 1.201 Test Acc: 0.800
Validation loss decreased (-0.770358 --> -0.799988).  Saving model ...
Epoch: 14 cost time: 0.623274564743042
Epoch: 14, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.131 Vali Acc: 0.815 Test Loss: 1.131 Test Acc: 0.815
Validation loss decreased (-0.799988 --> -0.814804).  Saving model ...
Epoch: 15 cost time: 0.806602954864502
Epoch: 15, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.062 Vali Acc: 0.815 Test Loss: 1.062 Test Acc: 0.815
Validation loss decreased (-0.814804 --> -0.814804).  Saving model ...
Epoch: 16 cost time: 0.7034027576446533
Epoch: 16, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.994 Vali Acc: 0.856 Test Loss: 0.994 Test Acc: 0.856
Validation loss decreased (-0.814804 --> -0.855546).  Saving model ...
Epoch: 17 cost time: 0.6089296340942383
Epoch: 17, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.927 Vali Acc: 0.874 Test Loss: 0.927 Test Acc: 0.874
Validation loss decreased (-0.855546 --> -0.874065).  Saving model ...
Epoch: 18 cost time: 0.6506056785583496
Epoch: 18, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.863 Vali Acc: 0.863 Test Loss: 0.863 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6027436256408691
Epoch: 19, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.801 Vali Acc: 0.881 Test Loss: 0.801 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 20 cost time: 0.6889023780822754
Epoch: 20, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.739 Vali Acc: 0.893 Test Loss: 0.739 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892585).  Saving model ...
Epoch: 21 cost time: 0.6605737209320068
Epoch: 21, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.676 Vali Acc: 0.919 Test Loss: 0.676 Test Acc: 0.919
Validation loss decreased (-0.892585 --> -0.918512).  Saving model ...
Epoch: 22 cost time: 0.784090518951416
Epoch: 22, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.615 Vali Acc: 0.930 Test Loss: 0.615 Test Acc: 0.930
Validation loss decreased (-0.918512 --> -0.929623).  Saving model ...
Epoch: 23 cost time: 0.6952123641967773
Epoch: 23, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.553 Vali Acc: 0.919 Test Loss: 0.553 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5563385486602783
Epoch: 24, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.498 Vali Acc: 0.911 Test Loss: 0.498 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5324203968048096
Epoch: 25, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.445 Vali Acc: 0.919 Test Loss: 0.445 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6788003444671631
Epoch: 26, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.393 Vali Acc: 0.944 Test Loss: 0.393 Test Acc: 0.944
Validation loss decreased (-0.929623 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 0.7630560398101807
Epoch: 27, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 28 cost time: 0.7674708366394043
Epoch: 28, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6459178924560547
Epoch: 29, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.660973072052002
Epoch: 30, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7627980709075928
Epoch: 31, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6428954601287842
Epoch: 32, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5767865180969238
Epoch: 33, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7615878582000732
Epoch: 34, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7034199237823486
Epoch: 35, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.619041919708252
Epoch: 36, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.756629228591919
Epoch: 37, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6309409141540527
Epoch: 38, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8191108703613281
Epoch: 39, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.933 Test Loss: 0.166 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7092206478118896
Epoch: 40, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4944303035736084
Epoch: 41, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5724959373474121
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.184 Vali Acc: 0.926 Test Loss: 0.184 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5138387680053711
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6747438907623291
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7805113792419434
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.922 Test Loss: 0.180 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 22235910
model size : 99.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.340459108352661
Epoch: 1, Steps: 2 | Train Loss: 1.996 Vali Loss: 1.946 Vali Acc: 0.104 Test Loss: 1.946 Test Acc: 0.104
Validation loss decreased (inf --> -0.103684).  Saving model ...
Epoch: 2 cost time: 0.6616420745849609
Epoch: 2, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.861 Vali Acc: 0.126 Test Loss: 1.861 Test Acc: 0.126
Validation loss decreased (-0.103684 --> -0.125907).  Saving model ...
Epoch: 3 cost time: 0.7383458614349365
Epoch: 3, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.784 Vali Acc: 0.200 Test Loss: 1.784 Test Acc: 0.200
Validation loss decreased (-0.125907 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.7779092788696289
Epoch: 4, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.681 Vali Acc: 0.319 Test Loss: 1.681 Test Acc: 0.319
Validation loss decreased (-0.199982 --> -0.318502).  Saving model ...
Epoch: 5 cost time: 0.6922397613525391
Epoch: 5, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.561 Vali Acc: 0.537 Test Loss: 1.561 Test Acc: 0.537
Validation loss decreased (-0.318502 --> -0.537021).  Saving model ...
Epoch: 6 cost time: 0.7814552783966064
Epoch: 6, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.429 Vali Acc: 0.630 Test Loss: 1.429 Test Acc: 0.630
Validation loss decreased (-0.537021 --> -0.629615).  Saving model ...
Epoch: 7 cost time: 0.6393632888793945
Epoch: 7, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.294 Vali Acc: 0.700 Test Loss: 1.294 Test Acc: 0.700
Validation loss decreased (-0.629615 --> -0.699987).  Saving model ...
Epoch: 8 cost time: 0.6688032150268555
Epoch: 8, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.165 Vali Acc: 0.767 Test Loss: 1.165 Test Acc: 0.767
Validation loss decreased (-0.699987 --> -0.766655).  Saving model ...
Epoch: 9 cost time: 0.7276113033294678
Epoch: 9, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.036 Vali Acc: 0.811 Test Loss: 1.036 Test Acc: 0.811
Validation loss decreased (-0.766655 --> -0.811101).  Saving model ...
Epoch: 10 cost time: 0.6230571269989014
Epoch: 10, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.914 Vali Acc: 0.837 Test Loss: 0.914 Test Acc: 0.837
Validation loss decreased (-0.811101 --> -0.837028).  Saving model ...
Epoch: 11 cost time: 0.6510858535766602
Epoch: 11, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.799 Vali Acc: 0.878 Test Loss: 0.799 Test Acc: 0.878
Validation loss decreased (-0.837028 --> -0.877770).  Saving model ...
Epoch: 12 cost time: 0.6614987850189209
Epoch: 12, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.698 Vali Acc: 0.900 Test Loss: 0.698 Test Acc: 0.900
Validation loss decreased (-0.877770 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.6193497180938721
Epoch: 13, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.611 Vali Acc: 0.893 Test Loss: 0.611 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6077110767364502
Epoch: 14, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.533 Vali Acc: 0.911 Test Loss: 0.533 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911106).  Saving model ...
Epoch: 15 cost time: 0.7535171508789062
Epoch: 15, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.467 Vali Acc: 0.922 Test Loss: 0.467 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 16 cost time: 0.7462601661682129
Epoch: 16, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.411 Vali Acc: 0.919 Test Loss: 0.411 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6505763530731201
Epoch: 17, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.368 Vali Acc: 0.922 Test Loss: 0.368 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.6507222652435303
Epoch: 18, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7092411518096924
Epoch: 19, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 20 cost time: 0.6624655723571777
Epoch: 20, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.7125048637390137
Epoch: 21, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.6500999927520752
Epoch: 22, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6551969051361084
Epoch: 23, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6397783756256104
Epoch: 24, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6915855407714844
Epoch: 25, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5926086902618408
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.601538896560669
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.71185302734375
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5232458114624023
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5240523815155029
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7762274742126465
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 22368006
model size : 99.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4832003116607666
Epoch: 1, Steps: 2 | Train Loss: 2.023 Vali Loss: 1.856 Vali Acc: 0.130 Test Loss: 1.856 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.5329413414001465
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.795 Vali Acc: 0.196 Test Loss: 1.795 Test Acc: 0.196
Validation loss decreased (-0.129611 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6311259269714355
Epoch: 3, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.753 Vali Acc: 0.285 Test Loss: 1.753 Test Acc: 0.285
Validation loss decreased (-0.196278 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.5363969802856445
Epoch: 4, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.700 Vali Acc: 0.370 Test Loss: 1.700 Test Acc: 0.370
Validation loss decreased (-0.285168 --> -0.370353).  Saving model ...
Epoch: 5 cost time: 0.5204451084136963
Epoch: 5, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.635 Vali Acc: 0.504 Test Loss: 1.635 Test Acc: 0.504
Validation loss decreased (-0.370353 --> -0.503687).  Saving model ...
Epoch: 6 cost time: 0.5462400913238525
Epoch: 6, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.561 Vali Acc: 0.600 Test Loss: 1.561 Test Acc: 0.600
Validation loss decreased (-0.503687 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 0.7657303810119629
Epoch: 7, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.477 Vali Acc: 0.685 Test Loss: 1.477 Test Acc: 0.685
Validation loss decreased (-0.599984 --> -0.685170).  Saving model ...
Epoch: 8 cost time: 0.5948281288146973
Epoch: 8, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.388 Vali Acc: 0.726 Test Loss: 1.388 Test Acc: 0.726
Validation loss decreased (-0.685170 --> -0.725912).  Saving model ...
Epoch: 9 cost time: 0.5572307109832764
Epoch: 9, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.293 Vali Acc: 0.752 Test Loss: 1.293 Test Acc: 0.752
Validation loss decreased (-0.725912 --> -0.751839).  Saving model ...
Epoch: 10 cost time: 0.6326606273651123
Epoch: 10, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.197 Vali Acc: 0.796 Test Loss: 1.197 Test Acc: 0.796
Validation loss decreased (-0.751839 --> -0.796284).  Saving model ...
Epoch: 11 cost time: 0.6009037494659424
Epoch: 11, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.103 Vali Acc: 0.833 Test Loss: 1.103 Test Acc: 0.833
Validation loss decreased (-0.796284 --> -0.833322).  Saving model ...
Epoch: 12 cost time: 0.5611603260040283
Epoch: 12, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.014 Vali Acc: 0.852 Test Loss: 1.014 Test Acc: 0.852
Validation loss decreased (-0.833322 --> -0.851842).  Saving model ...
Epoch: 13 cost time: 0.634368896484375
Epoch: 13, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.928 Vali Acc: 0.859 Test Loss: 0.928 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859250).  Saving model ...
Epoch: 14 cost time: 0.6462256908416748
Epoch: 14, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.845 Vali Acc: 0.900 Test Loss: 0.845 Test Acc: 0.900
Validation loss decreased (-0.859250 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.543154239654541
Epoch: 15, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.762 Vali Acc: 0.911 Test Loss: 0.762 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911103).  Saving model ...
Epoch: 16 cost time: 0.6859130859375
Epoch: 16, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.684 Vali Acc: 0.919 Test Loss: 0.684 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918512).  Saving model ...
Epoch: 17 cost time: 0.5177710056304932
Epoch: 17, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.612 Vali Acc: 0.915 Test Loss: 0.612 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5229413509368896
Epoch: 18, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.543 Vali Acc: 0.922 Test Loss: 0.543 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922217).  Saving model ...
Epoch: 19 cost time: 0.6377780437469482
Epoch: 19, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.483 Vali Acc: 0.930 Test Loss: 0.483 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 20 cost time: 0.6737411022186279
Epoch: 20, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.433 Vali Acc: 0.926 Test Loss: 0.433 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5795242786407471
Epoch: 21, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.531013011932373
Epoch: 22, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5389456748962402
Epoch: 23, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.6854112148284912
Epoch: 24, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.5150930881500244
Epoch: 25, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5073554515838623
Epoch: 26, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5942673683166504
Epoch: 27, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6826763153076172
Epoch: 28, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.55727219581604
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.239 Vali Acc: 0.907 Test Loss: 0.239 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5855770111083984
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.907 Test Loss: 0.232 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5200281143188477
Epoch: 31, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.904 Test Loss: 0.229 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7335801124572754
Epoch: 32, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.907 Test Loss: 0.227 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6157748699188232
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5559232234954834
Epoch: 34, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 22281990
model size : 99.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.77864146232605
Epoch: 1, Steps: 2 | Train Loss: 2.015 Vali Loss: 1.888 Vali Acc: 0.181 Test Loss: 1.888 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.583303689956665
Epoch: 2, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.816 Vali Acc: 0.200 Test Loss: 1.816 Test Acc: 0.200
Validation loss decreased (-0.181463 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6777198314666748
Epoch: 3, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.770 Vali Acc: 0.178 Test Loss: 1.770 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5756244659423828
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.730 Vali Acc: 0.204 Test Loss: 1.730 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.5587713718414307
Epoch: 5, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.682 Vali Acc: 0.289 Test Loss: 1.682 Test Acc: 0.289
Validation loss decreased (-0.203686 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.5892734527587891
Epoch: 6, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.631 Vali Acc: 0.500 Test Loss: 1.631 Test Acc: 0.500
Validation loss decreased (-0.288872 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 0.6079165935516357
Epoch: 7, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.577 Vali Acc: 0.578 Test Loss: 1.577 Test Acc: 0.578
Validation loss decreased (-0.499984 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.5389297008514404
Epoch: 8, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.519 Vali Acc: 0.622 Test Loss: 1.519 Test Acc: 0.622
Validation loss decreased (-0.577762 --> -0.622207).  Saving model ...
Epoch: 9 cost time: 0.5432922840118408
Epoch: 9, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.461 Vali Acc: 0.678 Test Loss: 1.461 Test Acc: 0.678
Validation loss decreased (-0.622207 --> -0.677763).  Saving model ...
Epoch: 10 cost time: 0.5912919044494629
Epoch: 10, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.399 Vali Acc: 0.700 Test Loss: 1.399 Test Acc: 0.700
Validation loss decreased (-0.677763 --> -0.699986).  Saving model ...
Epoch: 11 cost time: 0.6081390380859375
Epoch: 11, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.334 Vali Acc: 0.756 Test Loss: 1.334 Test Acc: 0.756
Validation loss decreased (-0.699986 --> -0.755542).  Saving model ...
Epoch: 12 cost time: 0.6079585552215576
Epoch: 12, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.267 Vali Acc: 0.793 Test Loss: 1.267 Test Acc: 0.793
Validation loss decreased (-0.755542 --> -0.792580).  Saving model ...
Epoch: 13 cost time: 0.6292920112609863
Epoch: 13, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.197 Vali Acc: 0.841 Test Loss: 1.197 Test Acc: 0.841
Validation loss decreased (-0.792580 --> -0.840729).  Saving model ...
Epoch: 14 cost time: 0.8683640956878662
Epoch: 14, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.125 Vali Acc: 0.863 Test Loss: 1.125 Test Acc: 0.863
Validation loss decreased (-0.840729 --> -0.862952).  Saving model ...
Epoch: 15 cost time: 0.6826825141906738
Epoch: 15, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.050 Vali Acc: 0.885 Test Loss: 1.050 Test Acc: 0.885
Validation loss decreased (-0.862952 --> -0.885175).  Saving model ...
Epoch: 16 cost time: 0.5480766296386719
Epoch: 16, Steps: 2 | Train Loss: 1.002 Vali Loss: 0.975 Vali Acc: 0.904 Test Loss: 0.975 Test Acc: 0.904
Validation loss decreased (-0.885175 --> -0.903694).  Saving model ...
Epoch: 17 cost time: 0.5276172161102295
Epoch: 17, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.901 Vali Acc: 0.915 Test Loss: 0.901 Test Acc: 0.915
Validation loss decreased (-0.903694 --> -0.914806).  Saving model ...
Epoch: 18 cost time: 0.506568193435669
Epoch: 18, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.828 Vali Acc: 0.926 Test Loss: 0.828 Test Acc: 0.926
Validation loss decreased (-0.914806 --> -0.925918).  Saving model ...
Epoch: 19 cost time: 0.6343710422515869
Epoch: 19, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.759 Vali Acc: 0.937 Test Loss: 0.759 Test Acc: 0.937
Validation loss decreased (-0.925918 --> -0.937029).  Saving model ...
Epoch: 20 cost time: 0.6071336269378662
Epoch: 20, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.694 Vali Acc: 0.933 Test Loss: 0.694 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6122181415557861
Epoch: 21, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.630 Vali Acc: 0.937 Test Loss: 0.630 Test Acc: 0.937
Validation loss decreased (-0.937029 --> -0.937031).  Saving model ...
Epoch: 22 cost time: 0.6218442916870117
Epoch: 22, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.569 Vali Acc: 0.941 Test Loss: 0.569 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 23 cost time: 0.5413870811462402
Epoch: 23, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.507 Vali Acc: 0.944 Test Loss: 0.507 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 24 cost time: 0.5391888618469238
Epoch: 24, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.451 Vali Acc: 0.956 Test Loss: 0.451 Test Acc: 0.956
Validation loss decreased (-0.944439 --> -0.955551).  Saving model ...
Epoch: 25 cost time: 0.579016923904419
Epoch: 25, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.401 Vali Acc: 0.959 Test Loss: 0.401 Test Acc: 0.959
Validation loss decreased (-0.955551 --> -0.959255).  Saving model ...
Epoch: 26 cost time: 0.6622183322906494
Epoch: 26, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.355 Vali Acc: 0.956 Test Loss: 0.355 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6536166667938232
Epoch: 27, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.313 Vali Acc: 0.956 Test Loss: 0.313 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6308345794677734
Epoch: 28, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959256).  Saving model ...
Epoch: 29 cost time: 0.6019175052642822
Epoch: 29, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6426265239715576
Epoch: 30, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6070127487182617
Epoch: 31, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5347764492034912
Epoch: 32, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.707097053527832
Epoch: 33, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6786715984344482
Epoch: 34, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6531274318695068
Epoch: 35, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7291712760925293
Epoch: 36, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6280689239501953
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5323336124420166
Epoch: 38, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 22238982
model size : 99.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.675609827041626
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.757 Vali Acc: 0.237 Test Loss: 1.757 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.6363956928253174
Epoch: 2, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.711 Vali Acc: 0.278 Test Loss: 1.711 Test Acc: 0.278
Validation loss decreased (-0.237019 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.5830485820770264
Epoch: 3, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.674 Vali Acc: 0.348 Test Loss: 1.674 Test Acc: 0.348
Validation loss decreased (-0.277761 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.6777114868164062
Epoch: 4, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.615 Vali Acc: 0.507 Test Loss: 1.615 Test Acc: 0.507
Validation loss decreased (-0.348131 --> -0.507391).  Saving model ...
Epoch: 5 cost time: 0.6774444580078125
Epoch: 5, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.539 Vali Acc: 0.678 Test Loss: 1.539 Test Acc: 0.678
Validation loss decreased (-0.507391 --> -0.677762).  Saving model ...
Epoch: 6 cost time: 0.5073304176330566
Epoch: 6, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.453 Vali Acc: 0.744 Test Loss: 1.453 Test Acc: 0.744
Validation loss decreased (-0.677762 --> -0.744430).  Saving model ...
Epoch: 7 cost time: 0.6563687324523926
Epoch: 7, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.359 Vali Acc: 0.770 Test Loss: 1.359 Test Acc: 0.770
Validation loss decreased (-0.744430 --> -0.770357).  Saving model ...
Epoch: 8 cost time: 0.6295821666717529
Epoch: 8, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.262 Vali Acc: 0.807 Test Loss: 1.262 Test Acc: 0.807
Validation loss decreased (-0.770357 --> -0.807395).  Saving model ...
Epoch: 9 cost time: 0.6019043922424316
Epoch: 9, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.162 Vali Acc: 0.848 Test Loss: 1.162 Test Acc: 0.848
Validation loss decreased (-0.807395 --> -0.848137).  Saving model ...
Epoch: 10 cost time: 0.7259948253631592
Epoch: 10, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.061 Vali Acc: 0.859 Test Loss: 1.061 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859249).  Saving model ...
Epoch: 11 cost time: 0.6393938064575195
Epoch: 11, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.963 Vali Acc: 0.874 Test Loss: 0.963 Test Acc: 0.874
Validation loss decreased (-0.859249 --> -0.874064).  Saving model ...
Epoch: 12 cost time: 0.5844554901123047
Epoch: 12, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.868 Vali Acc: 0.889 Test Loss: 0.868 Test Acc: 0.889
Validation loss decreased (-0.874064 --> -0.888880).  Saving model ...
Epoch: 13 cost time: 0.7106993198394775
Epoch: 13, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.778 Vali Acc: 0.900 Test Loss: 0.778 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.5730273723602295
Epoch: 14, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.703 Vali Acc: 0.885 Test Loss: 0.703 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6768202781677246
Epoch: 15, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.630 Vali Acc: 0.896 Test Loss: 0.630 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6094882488250732
Epoch: 16, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.5601184368133545
Epoch: 17, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.496 Vali Acc: 0.907 Test Loss: 0.496 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 18 cost time: 0.603069543838501
Epoch: 18, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
Validation loss decreased (-0.907402 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.6678757667541504
Epoch: 19, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.385 Vali Acc: 0.930 Test Loss: 0.385 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 0.6132149696350098
Epoch: 20, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.344 Vali Acc: 0.937 Test Loss: 0.344 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 21 cost time: 0.738300085067749
Epoch: 21, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6084423065185547
Epoch: 22, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6277141571044922
Epoch: 23, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6592557430267334
Epoch: 24, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6892824172973633
Epoch: 25, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7123551368713379
Epoch: 26, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7124366760253906
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6146292686462402
Epoch: 28, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.915 Test Loss: 0.218 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6790251731872559
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.907 Test Loss: 0.216 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6212935447692871
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.915 Test Loss: 0.214 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 22315782
model size : 99.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5240602493286133
Epoch: 1, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.776 Vali Acc: 0.185 Test Loss: 1.776 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.571897029876709
Epoch: 2, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.723 Vali Acc: 0.237 Test Loss: 1.723 Test Acc: 0.237
Validation loss decreased (-0.185167 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.680180549621582
Epoch: 3, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.690 Vali Acc: 0.315 Test Loss: 1.690 Test Acc: 0.315
Validation loss decreased (-0.237020 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.5483443737030029
Epoch: 4, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.649 Vali Acc: 0.481 Test Loss: 1.649 Test Acc: 0.481
Validation loss decreased (-0.314798 --> -0.481465).  Saving model ...
Epoch: 5 cost time: 0.606250524520874
Epoch: 5, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.599 Vali Acc: 0.548 Test Loss: 1.599 Test Acc: 0.548
Validation loss decreased (-0.481465 --> -0.548132).  Saving model ...
Epoch: 6 cost time: 0.6409432888031006
Epoch: 6, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.540 Vali Acc: 0.600 Test Loss: 1.540 Test Acc: 0.600
Validation loss decreased (-0.548132 --> -0.599985).  Saving model ...
Epoch: 7 cost time: 0.5360355377197266
Epoch: 7, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.476 Vali Acc: 0.678 Test Loss: 1.476 Test Acc: 0.678
Validation loss decreased (-0.599985 --> -0.677763).  Saving model ...
Epoch: 8 cost time: 0.7067196369171143
Epoch: 8, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.406 Vali Acc: 0.726 Test Loss: 1.406 Test Acc: 0.726
Validation loss decreased (-0.677763 --> -0.725912).  Saving model ...
Epoch: 9 cost time: 0.7047455310821533
Epoch: 9, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.329 Vali Acc: 0.770 Test Loss: 1.329 Test Acc: 0.770
Validation loss decreased (-0.725912 --> -0.770357).  Saving model ...
Epoch: 10 cost time: 0.499558687210083
Epoch: 10, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.248 Vali Acc: 0.819 Test Loss: 1.248 Test Acc: 0.819
Validation loss decreased (-0.770357 --> -0.818506).  Saving model ...
Epoch: 11 cost time: 0.6533207893371582
Epoch: 11, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.167 Vali Acc: 0.856 Test Loss: 1.167 Test Acc: 0.856
Validation loss decreased (-0.818506 --> -0.855544).  Saving model ...
Epoch: 12 cost time: 0.6968939304351807
Epoch: 12, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.087 Vali Acc: 0.889 Test Loss: 1.087 Test Acc: 0.889
Validation loss decreased (-0.855544 --> -0.888878).  Saving model ...
Epoch: 13 cost time: 0.566093921661377
Epoch: 13, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.007 Vali Acc: 0.907 Test Loss: 1.007 Test Acc: 0.907
Validation loss decreased (-0.888878 --> -0.907397).  Saving model ...
Epoch: 14 cost time: 0.6172845363616943
Epoch: 14, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.929 Vali Acc: 0.900 Test Loss: 0.929 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5623648166656494
Epoch: 15, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.852 Vali Acc: 0.911 Test Loss: 0.852 Test Acc: 0.911
Validation loss decreased (-0.907397 --> -0.911103).  Saving model ...
Epoch: 16 cost time: 0.6559481620788574
Epoch: 16, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.777 Vali Acc: 0.919 Test Loss: 0.777 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918511).  Saving model ...
Epoch: 17 cost time: 0.6292328834533691
Epoch: 17, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.705 Vali Acc: 0.926 Test Loss: 0.705 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 18 cost time: 0.658616304397583
Epoch: 18, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.638 Vali Acc: 0.948 Test Loss: 0.638 Test Acc: 0.948
Validation loss decreased (-0.925919 --> -0.948142).  Saving model ...
Epoch: 19 cost time: 0.6905033588409424
Epoch: 19, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.579 Vali Acc: 0.944 Test Loss: 0.579 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.700838565826416
Epoch: 20, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.521 Vali Acc: 0.941 Test Loss: 0.521 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6099977493286133
Epoch: 21, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.465 Vali Acc: 0.941 Test Loss: 0.465 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7352981567382812
Epoch: 22, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.416 Vali Acc: 0.941 Test Loss: 0.416 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7074182033538818
Epoch: 23, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.376 Vali Acc: 0.933 Test Loss: 0.376 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6652603149414062
Epoch: 24, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.341 Vali Acc: 0.933 Test Loss: 0.341 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6095762252807617
Epoch: 25, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.591740608215332
Epoch: 26, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6351296901702881
Epoch: 27, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6702075004577637
Epoch: 28, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 22272774
model size : 99.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.970020294189453
Epoch: 1, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.875 Vali Acc: 0.237 Test Loss: 1.875 Test Acc: 0.237
Validation loss decreased (inf --> -0.237018).  Saving model ...
Epoch: 2 cost time: 0.6862587928771973
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.829 Vali Acc: 0.222 Test Loss: 1.829 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5882079601287842
Epoch: 3, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.800 Vali Acc: 0.219 Test Loss: 1.800 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6300649642944336
Epoch: 4, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.768 Vali Acc: 0.248 Test Loss: 1.768 Test Acc: 0.248
Validation loss decreased (-0.237018 --> -0.248130).  Saving model ...
Epoch: 5 cost time: 0.6418449878692627
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.730 Vali Acc: 0.281 Test Loss: 1.730 Test Acc: 0.281
Validation loss decreased (-0.248130 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 0.6187736988067627
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.683 Vali Acc: 0.356 Test Loss: 1.683 Test Acc: 0.356
Validation loss decreased (-0.281464 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.49589085578918457
Epoch: 7, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.631 Vali Acc: 0.478 Test Loss: 1.631 Test Acc: 0.478
Validation loss decreased (-0.355539 --> -0.477761).  Saving model ...
Epoch: 8 cost time: 0.6336290836334229
Epoch: 8, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.577 Vali Acc: 0.552 Test Loss: 1.577 Test Acc: 0.552
Validation loss decreased (-0.477761 --> -0.551836).  Saving model ...
Epoch: 9 cost time: 0.6324107646942139
Epoch: 9, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.520 Vali Acc: 0.611 Test Loss: 1.520 Test Acc: 0.611
Validation loss decreased (-0.551836 --> -0.611096).  Saving model ...
Epoch: 10 cost time: 0.6631267070770264
Epoch: 10, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.460 Vali Acc: 0.652 Test Loss: 1.460 Test Acc: 0.652
Validation loss decreased (-0.611096 --> -0.651837).  Saving model ...
Epoch: 11 cost time: 0.6681134700775146
Epoch: 11, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.396 Vali Acc: 0.707 Test Loss: 1.396 Test Acc: 0.707
Validation loss decreased (-0.651837 --> -0.707393).  Saving model ...
Epoch: 12 cost time: 0.5765092372894287
Epoch: 12, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.332 Vali Acc: 0.770 Test Loss: 1.332 Test Acc: 0.770
Validation loss decreased (-0.707393 --> -0.770357).  Saving model ...
Epoch: 13 cost time: 0.6224620342254639
Epoch: 13, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.264 Vali Acc: 0.830 Test Loss: 1.264 Test Acc: 0.830
Validation loss decreased (-0.770357 --> -0.829617).  Saving model ...
Epoch: 14 cost time: 0.5215258598327637
Epoch: 14, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.197 Vali Acc: 0.870 Test Loss: 1.197 Test Acc: 0.870
Validation loss decreased (-0.829617 --> -0.870358).  Saving model ...
Epoch: 15 cost time: 0.5543243885040283
Epoch: 15, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.129 Vali Acc: 0.870 Test Loss: 1.129 Test Acc: 0.870
Validation loss decreased (-0.870358 --> -0.870359).  Saving model ...
Epoch: 16 cost time: 0.7079761028289795
Epoch: 16, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.061 Vali Acc: 0.874 Test Loss: 1.061 Test Acc: 0.874
Validation loss decreased (-0.870359 --> -0.874063).  Saving model ...
Epoch: 17 cost time: 0.6740217208862305
Epoch: 17, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.992 Vali Acc: 0.885 Test Loss: 0.992 Test Acc: 0.885
Validation loss decreased (-0.874063 --> -0.885175).  Saving model ...
Epoch: 18 cost time: 0.6559510231018066
Epoch: 18, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.919 Vali Acc: 0.904 Test Loss: 0.919 Test Acc: 0.904
Validation loss decreased (-0.885175 --> -0.903695).  Saving model ...
Epoch: 19 cost time: 0.6138961315155029
Epoch: 19, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.845 Vali Acc: 0.915 Test Loss: 0.845 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914806).  Saving model ...
Epoch: 20 cost time: 0.6986808776855469
Epoch: 20, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.772 Vali Acc: 0.919 Test Loss: 0.772 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918511).  Saving model ...
Epoch: 21 cost time: 0.7234740257263184
Epoch: 21, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.703 Vali Acc: 0.919 Test Loss: 0.703 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 22 cost time: 0.644599437713623
Epoch: 22, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.639 Vali Acc: 0.926 Test Loss: 0.639 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925920).  Saving model ...
Epoch: 23 cost time: 0.6015458106994629
Epoch: 23, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.575 Vali Acc: 0.937 Test Loss: 0.575 Test Acc: 0.937
Validation loss decreased (-0.925920 --> -0.937031).  Saving model ...
Epoch: 24 cost time: 0.7070791721343994
Epoch: 24, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.516 Vali Acc: 0.952 Test Loss: 0.516 Test Acc: 0.952
Validation loss decreased (-0.937031 --> -0.951847).  Saving model ...
Epoch: 25 cost time: 0.7162928581237793
Epoch: 25, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.462 Vali Acc: 0.944 Test Loss: 0.462 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7152984142303467
Epoch: 26, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.415 Vali Acc: 0.948 Test Loss: 0.415 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5854175090789795
Epoch: 27, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.372 Vali Acc: 0.948 Test Loss: 0.372 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6965844631195068
Epoch: 28, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.335 Vali Acc: 0.948 Test Loss: 0.335 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8428308963775635
Epoch: 29, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8234012126922607
Epoch: 30, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5396971702575684
Epoch: 31, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5755839347839355
Epoch: 32, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6243689060211182
Epoch: 33, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6914832592010498
Epoch: 34, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 22242054
model size : 99.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.658562421798706
Epoch: 1, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.889 Vali Acc: 0.044 Test Loss: 1.889 Test Acc: 0.044
Validation loss decreased (inf --> -0.044426).  Saving model ...
Epoch: 2 cost time: 0.5772886276245117
Epoch: 2, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.828 Vali Acc: 0.141 Test Loss: 1.828 Test Acc: 0.141
Validation loss decreased (-0.044426 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 0.5999712944030762
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.772 Vali Acc: 0.256 Test Loss: 1.772 Test Acc: 0.256
Validation loss decreased (-0.140722 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.7251238822937012
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.704 Vali Acc: 0.415 Test Loss: 1.704 Test Acc: 0.415
Validation loss decreased (-0.255538 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.6572971343994141
Epoch: 5, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.621 Vali Acc: 0.437 Test Loss: 1.621 Test Acc: 0.437
Validation loss decreased (-0.414798 --> -0.437021).  Saving model ...
Epoch: 6 cost time: 0.5668976306915283
Epoch: 6, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.530 Vali Acc: 0.530 Test Loss: 1.530 Test Acc: 0.530
Validation loss decreased (-0.437021 --> -0.529614).  Saving model ...
Epoch: 7 cost time: 0.578906774520874
Epoch: 7, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.428 Vali Acc: 0.611 Test Loss: 1.428 Test Acc: 0.611
Validation loss decreased (-0.529614 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 0.6764543056488037
Epoch: 8, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.320 Vali Acc: 0.685 Test Loss: 1.320 Test Acc: 0.685
Validation loss decreased (-0.611097 --> -0.685172).  Saving model ...
Epoch: 9 cost time: 0.6441938877105713
Epoch: 9, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.210 Vali Acc: 0.748 Test Loss: 1.210 Test Acc: 0.748
Validation loss decreased (-0.685172 --> -0.748136).  Saving model ...
Epoch: 10 cost time: 0.7178096771240234
Epoch: 10, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.100 Vali Acc: 0.811 Test Loss: 1.100 Test Acc: 0.811
Validation loss decreased (-0.748136 --> -0.811100).  Saving model ...
Epoch: 11 cost time: 0.5107674598693848
Epoch: 11, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.995 Vali Acc: 0.826 Test Loss: 0.995 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825916).  Saving model ...
Epoch: 12 cost time: 0.6799454689025879
Epoch: 12, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.898 Vali Acc: 0.833 Test Loss: 0.898 Test Acc: 0.833
Validation loss decreased (-0.825916 --> -0.833324).  Saving model ...
Epoch: 13 cost time: 0.750274658203125
Epoch: 13, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.805 Vali Acc: 0.856 Test Loss: 0.805 Test Acc: 0.856
Validation loss decreased (-0.833324 --> -0.855548).  Saving model ...
Epoch: 14 cost time: 0.7105865478515625
Epoch: 14, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.721 Vali Acc: 0.856 Test Loss: 0.721 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 15 cost time: 0.6434564590454102
Epoch: 15, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.644 Vali Acc: 0.874 Test Loss: 0.644 Test Acc: 0.874
Validation loss decreased (-0.855548 --> -0.874068).  Saving model ...
Epoch: 16 cost time: 0.694138765335083
Epoch: 16, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.572 Vali Acc: 0.881 Test Loss: 0.572 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 17 cost time: 0.6770179271697998
Epoch: 17, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.509 Vali Acc: 0.911 Test Loss: 0.509 Test Acc: 0.911
Validation loss decreased (-0.881476 --> -0.911106).  Saving model ...
Epoch: 18 cost time: 0.6375646591186523
Epoch: 18, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7718594074249268
Epoch: 19, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.405 Vali Acc: 0.919 Test Loss: 0.405 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 20 cost time: 0.6606142520904541
Epoch: 20, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.355 Vali Acc: 0.919 Test Loss: 0.355 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.8277051448822021
Epoch: 21, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.7006673812866211
Epoch: 22, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.591496467590332
Epoch: 23, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.284 Vali Acc: 0.889 Test Loss: 0.284 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6328704357147217
Epoch: 24, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.256 Vali Acc: 0.900 Test Loss: 0.256 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6970038414001465
Epoch: 25, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6871247291564941
Epoch: 26, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.904 Test Loss: 0.240 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7265443801879883
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.242 Vali Acc: 0.904 Test Loss: 0.242 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7123856544494629
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7535254955291748
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.77614426612854
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 31 cost time: 0.8307607173919678
Epoch: 31, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6879603862762451
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.915 Test Loss: 0.220 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.701465368270874
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.907 Test Loss: 0.232 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5819928646087646
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.915 Test Loss: 0.239 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7415902614593506
Epoch: 35, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.669863224029541
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.915 Test Loss: 0.230 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6304419040679932
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6678686141967773
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6624789237976074
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6700012683868408
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.8018684387207031
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6923518180847168
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7122135162353516
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.748103141784668
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7598788738250732
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6634190082550049
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7002136707305908
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7371821403503418
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7426323890686035
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.905994176864624
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.240 Vali Acc: 0.919 Test Loss: 0.240 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 22324998
model size : 99.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6817173957824707
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.811 Vali Acc: 0.193 Test Loss: 1.811 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.6910278797149658
Epoch: 2, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.765 Vali Acc: 0.241 Test Loss: 1.765 Test Acc: 0.241
Validation loss decreased (-0.192574 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.7780797481536865
Epoch: 3, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.729 Vali Acc: 0.293 Test Loss: 1.729 Test Acc: 0.293
Validation loss decreased (-0.240723 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.6734321117401123
Epoch: 4, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.685 Vali Acc: 0.319 Test Loss: 1.685 Test Acc: 0.319
Validation loss decreased (-0.292575 --> -0.318502).  Saving model ...
Epoch: 5 cost time: 0.6891372203826904
Epoch: 5, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.629 Vali Acc: 0.370 Test Loss: 1.629 Test Acc: 0.370
Validation loss decreased (-0.318502 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 0.6661081314086914
Epoch: 6, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.568 Vali Acc: 0.404 Test Loss: 1.568 Test Acc: 0.404
Validation loss decreased (-0.370354 --> -0.403688).  Saving model ...
Epoch: 7 cost time: 0.5826423168182373
Epoch: 7, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.501 Vali Acc: 0.474 Test Loss: 1.501 Test Acc: 0.474
Validation loss decreased (-0.403688 --> -0.474059).  Saving model ...
Epoch: 8 cost time: 0.607598066329956
Epoch: 8, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
Validation loss decreased (-0.474059 --> -0.518504).  Saving model ...
Epoch: 9 cost time: 0.6678063869476318
Epoch: 9, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.352 Vali Acc: 0.578 Test Loss: 1.352 Test Acc: 0.578
Validation loss decreased (-0.518504 --> -0.577764).  Saving model ...
Epoch: 10 cost time: 0.7250998020172119
Epoch: 10, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.270 Vali Acc: 0.652 Test Loss: 1.270 Test Acc: 0.652
Validation loss decreased (-0.577764 --> -0.651839).  Saving model ...
Epoch: 11 cost time: 0.5592470169067383
Epoch: 11, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.185 Vali Acc: 0.711 Test Loss: 1.185 Test Acc: 0.711
Validation loss decreased (-0.651839 --> -0.711099).  Saving model ...
Epoch: 12 cost time: 0.6861832141876221
Epoch: 12, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.101 Vali Acc: 0.748 Test Loss: 1.101 Test Acc: 0.748
Validation loss decreased (-0.711099 --> -0.748137).  Saving model ...
Epoch: 13 cost time: 0.7854037284851074
Epoch: 13, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.018 Vali Acc: 0.796 Test Loss: 1.018 Test Acc: 0.796
Validation loss decreased (-0.748137 --> -0.796286).  Saving model ...
Epoch: 14 cost time: 0.5955390930175781
Epoch: 14, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.936 Vali Acc: 0.837 Test Loss: 0.936 Test Acc: 0.837
Validation loss decreased (-0.796286 --> -0.837028).  Saving model ...
Epoch: 15 cost time: 0.6369173526763916
Epoch: 15, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.856 Vali Acc: 0.870 Test Loss: 0.856 Test Acc: 0.870
Validation loss decreased (-0.837028 --> -0.870362).  Saving model ...
Epoch: 16 cost time: 0.6425430774688721
Epoch: 16, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.777 Vali Acc: 0.893 Test Loss: 0.777 Test Acc: 0.893
Validation loss decreased (-0.870362 --> -0.892585).  Saving model ...
Epoch: 17 cost time: 0.5748550891876221
Epoch: 17, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.703 Vali Acc: 0.911 Test Loss: 0.703 Test Acc: 0.911
Validation loss decreased (-0.892585 --> -0.911104).  Saving model ...
Epoch: 18 cost time: 0.6093833446502686
Epoch: 18, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.632 Vali Acc: 0.915 Test Loss: 0.632 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 19 cost time: 0.6794934272766113
Epoch: 19, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.567 Vali Acc: 0.915 Test Loss: 0.567 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 20 cost time: 0.6046195030212402
Epoch: 20, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.506 Vali Acc: 0.919 Test Loss: 0.506 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 21 cost time: 0.7720940113067627
Epoch: 21, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 22 cost time: 0.7015554904937744
Epoch: 22, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.395 Vali Acc: 0.930 Test Loss: 0.395 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.6733200550079346
Epoch: 23, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.346 Vali Acc: 0.937 Test Loss: 0.346 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 0.5963099002838135
Epoch: 24, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6619799137115479
Epoch: 25, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4542236328125
Epoch: 26, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5484135150909424
Epoch: 27, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6850399971008301
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.594672679901123
Epoch: 29, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.235 Vali Acc: 0.907 Test Loss: 0.235 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5333535671234131
Epoch: 30, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5830721855163574
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7520291805267334
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7318944931030273
Epoch: 33, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 22281990
model size : 99.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.657134532928467
Epoch: 1, Steps: 2 | Train Loss: 2.087 Vali Loss: 1.912 Vali Acc: 0.163 Test Loss: 1.912 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.660330057144165
Epoch: 2, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.849 Vali Acc: 0.144 Test Loss: 1.849 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7086713314056396
Epoch: 3, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.811 Vali Acc: 0.152 Test Loss: 1.811 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49298787117004395
Epoch: 4, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.778 Vali Acc: 0.163 Test Loss: 1.778 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.7169275283813477
Epoch: 5, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.738 Vali Acc: 0.193 Test Loss: 1.738 Test Acc: 0.193
Validation loss decreased (-0.162945 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.5882687568664551
Epoch: 6, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.693 Vali Acc: 0.289 Test Loss: 1.693 Test Acc: 0.289
Validation loss decreased (-0.192575 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.6927947998046875
Epoch: 7, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.644 Vali Acc: 0.407 Test Loss: 1.644 Test Acc: 0.407
Validation loss decreased (-0.288872 --> -0.407391).  Saving model ...
Epoch: 8 cost time: 0.659867525100708
Epoch: 8, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.594 Vali Acc: 0.537 Test Loss: 1.594 Test Acc: 0.537
Validation loss decreased (-0.407391 --> -0.537021).  Saving model ...
Epoch: 9 cost time: 0.521235466003418
Epoch: 9, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.544 Vali Acc: 0.648 Test Loss: 1.544 Test Acc: 0.648
Validation loss decreased (-0.537021 --> -0.648133).  Saving model ...
Epoch: 10 cost time: 0.7547380924224854
Epoch: 10, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.492 Vali Acc: 0.726 Test Loss: 1.492 Test Acc: 0.726
Validation loss decreased (-0.648133 --> -0.725911).  Saving model ...
Epoch: 11 cost time: 0.5248682498931885
Epoch: 11, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.437 Vali Acc: 0.741 Test Loss: 1.437 Test Acc: 0.741
Validation loss decreased (-0.725911 --> -0.740726).  Saving model ...
Epoch: 12 cost time: 0.6489269733428955
Epoch: 12, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.379 Vali Acc: 0.756 Test Loss: 1.379 Test Acc: 0.756
Validation loss decreased (-0.740726 --> -0.755542).  Saving model ...
Epoch: 13 cost time: 0.5628855228424072
Epoch: 13, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.319 Vali Acc: 0.774 Test Loss: 1.319 Test Acc: 0.774
Validation loss decreased (-0.755542 --> -0.774061).  Saving model ...
Epoch: 14 cost time: 0.545285701751709
Epoch: 14, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.254 Vali Acc: 0.811 Test Loss: 1.254 Test Acc: 0.811
Validation loss decreased (-0.774061 --> -0.811099).  Saving model ...
Epoch: 15 cost time: 0.6779541969299316
Epoch: 15, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.188 Vali Acc: 0.830 Test Loss: 1.188 Test Acc: 0.830
Validation loss decreased (-0.811099 --> -0.829618).  Saving model ...
Epoch: 16 cost time: 0.7410793304443359
Epoch: 16, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.120 Vali Acc: 0.852 Test Loss: 1.120 Test Acc: 0.852
Validation loss decreased (-0.829618 --> -0.851841).  Saving model ...
Epoch: 17 cost time: 0.6209611892700195
Epoch: 17, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.050 Vali Acc: 0.863 Test Loss: 1.050 Test Acc: 0.863
Validation loss decreased (-0.851841 --> -0.862952).  Saving model ...
Epoch: 18 cost time: 0.6572153568267822
Epoch: 18, Steps: 2 | Train Loss: 0.976 Vali Loss: 0.981 Vali Acc: 0.889 Test Loss: 0.981 Test Acc: 0.889
Validation loss decreased (-0.862952 --> -0.888879).  Saving model ...
Epoch: 19 cost time: 0.7843856811523438
Epoch: 19, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.912 Vali Acc: 0.911 Test Loss: 0.912 Test Acc: 0.911
Validation loss decreased (-0.888879 --> -0.911102).  Saving model ...
Epoch: 20 cost time: 0.5622334480285645
Epoch: 20, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.841 Vali Acc: 0.915 Test Loss: 0.841 Test Acc: 0.915
Validation loss decreased (-0.911102 --> -0.914806).  Saving model ...
Epoch: 21 cost time: 0.5703713893890381
Epoch: 21, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.771 Vali Acc: 0.922 Test Loss: 0.771 Test Acc: 0.922
Validation loss decreased (-0.914806 --> -0.922215).  Saving model ...
Epoch: 22 cost time: 0.5849728584289551
Epoch: 22, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.698 Vali Acc: 0.933 Test Loss: 0.698 Test Acc: 0.933
Validation loss decreased (-0.922215 --> -0.933326).  Saving model ...
Epoch: 23 cost time: 0.5413801670074463
Epoch: 23, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.627 Vali Acc: 0.941 Test Loss: 0.627 Test Acc: 0.941
Validation loss decreased (-0.933326 --> -0.940734).  Saving model ...
Epoch: 24 cost time: 0.7014894485473633
Epoch: 24, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.560 Vali Acc: 0.944 Test Loss: 0.560 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944439).  Saving model ...
Epoch: 25 cost time: 0.7076277732849121
Epoch: 25, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.499 Vali Acc: 0.941 Test Loss: 0.499 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5799574851989746
Epoch: 26, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.443 Vali Acc: 0.937 Test Loss: 0.443 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5695457458496094
Epoch: 27, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6839251518249512
Epoch: 28, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7027411460876465
Epoch: 29, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5631961822509766
Epoch: 30, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5811374187469482
Epoch: 31, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7844815254211426
Epoch: 32, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6797065734863281
Epoch: 33, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6019930839538574
Epoch: 34, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 22245126
model size : 99.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1376211643218994
Epoch: 1, Steps: 2 | Train Loss: 2.063 Vali Loss: 1.877 Vali Acc: 0.152 Test Loss: 1.877 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.5711541175842285
Epoch: 2, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.812 Vali Acc: 0.241 Test Loss: 1.812 Test Acc: 0.241
Validation loss decreased (-0.151833 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.6890926361083984
Epoch: 3, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.768 Vali Acc: 0.274 Test Loss: 1.768 Test Acc: 0.274
Validation loss decreased (-0.240723 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 0.6210675239562988
Epoch: 4, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.709 Vali Acc: 0.278 Test Loss: 1.709 Test Acc: 0.278
Validation loss decreased (-0.274056 --> -0.277761).  Saving model ...
Epoch: 5 cost time: 0.6541953086853027
Epoch: 5, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.637 Vali Acc: 0.422 Test Loss: 1.637 Test Acc: 0.422
Validation loss decreased (-0.277761 --> -0.422206).  Saving model ...
Epoch: 6 cost time: 0.5439815521240234
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.559 Vali Acc: 0.537 Test Loss: 1.559 Test Acc: 0.537
Validation loss decreased (-0.422206 --> -0.537021).  Saving model ...
Epoch: 7 cost time: 0.6611018180847168
Epoch: 7, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.469 Vali Acc: 0.700 Test Loss: 1.469 Test Acc: 0.700
Validation loss decreased (-0.537021 --> -0.699985).  Saving model ...
Epoch: 8 cost time: 0.5473082065582275
Epoch: 8, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.370 Vali Acc: 0.767 Test Loss: 1.370 Test Acc: 0.767
Validation loss decreased (-0.699985 --> -0.766653).  Saving model ...
Epoch: 9 cost time: 0.6088714599609375
Epoch: 9, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.270 Vali Acc: 0.819 Test Loss: 1.270 Test Acc: 0.819
Validation loss decreased (-0.766653 --> -0.818506).  Saving model ...
Epoch: 10 cost time: 0.585932731628418
Epoch: 10, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.171 Vali Acc: 0.859 Test Loss: 1.171 Test Acc: 0.859
Validation loss decreased (-0.818506 --> -0.859248).  Saving model ...
Epoch: 11 cost time: 0.6647830009460449
Epoch: 11, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.074 Vali Acc: 0.885 Test Loss: 1.074 Test Acc: 0.885
Validation loss decreased (-0.859248 --> -0.885174).  Saving model ...
Epoch: 12 cost time: 0.7509291172027588
Epoch: 12, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.977 Vali Acc: 0.900 Test Loss: 0.977 Test Acc: 0.900
Validation loss decreased (-0.885174 --> -0.899990).  Saving model ...
Epoch: 13 cost time: 0.7369623184204102
Epoch: 13, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.881 Vali Acc: 0.900 Test Loss: 0.881 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.5496697425842285
Epoch: 14, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.790 Vali Acc: 0.911 Test Loss: 0.790 Test Acc: 0.911
Validation loss decreased (-0.899991 --> -0.911103).  Saving model ...
Epoch: 15 cost time: 0.6760671138763428
Epoch: 15, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.710 Vali Acc: 0.926 Test Loss: 0.710 Test Acc: 0.926
Validation loss decreased (-0.911103 --> -0.925919).  Saving model ...
Epoch: 16 cost time: 0.5452454090118408
Epoch: 16, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.632 Vali Acc: 0.896 Test Loss: 0.632 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5311076641082764
Epoch: 17, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.556 Vali Acc: 0.915 Test Loss: 0.556 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6014747619628906
Epoch: 18, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.496 Vali Acc: 0.907 Test Loss: 0.496 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7867851257324219
Epoch: 19, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.455 Vali Acc: 0.885 Test Loss: 0.455 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7107155323028564
Epoch: 20, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.707991361618042
Epoch: 21, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.363 Vali Acc: 0.896 Test Loss: 0.363 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7627971172332764
Epoch: 22, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.315 Vali Acc: 0.915 Test Loss: 0.315 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5700106620788574
Epoch: 23, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6329658031463623
Epoch: 24, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7177419662475586
Epoch: 25, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 22334214
model size : 99.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5214056968688965
Epoch: 1, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.755 Vali Acc: 0.181 Test Loss: 1.755 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.6046814918518066
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.710 Vali Acc: 0.237 Test Loss: 1.710 Test Acc: 0.237
Validation loss decreased (-0.181464 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.5760369300842285
Epoch: 3, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.681 Vali Acc: 0.326 Test Loss: 1.681 Test Acc: 0.326
Validation loss decreased (-0.237020 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.5565898418426514
Epoch: 4, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.647 Vali Acc: 0.474 Test Loss: 1.647 Test Acc: 0.474
Validation loss decreased (-0.325909 --> -0.474058).  Saving model ...
Epoch: 5 cost time: 0.6725702285766602
Epoch: 5, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.603 Vali Acc: 0.596 Test Loss: 1.603 Test Acc: 0.596
Validation loss decreased (-0.474058 --> -0.596280).  Saving model ...
Epoch: 6 cost time: 0.5439248085021973
Epoch: 6, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.553 Vali Acc: 0.667 Test Loss: 1.553 Test Acc: 0.667
Validation loss decreased (-0.596280 --> -0.666651).  Saving model ...
Epoch: 7 cost time: 0.5925109386444092
Epoch: 7, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.496 Vali Acc: 0.715 Test Loss: 1.496 Test Acc: 0.715
Validation loss decreased (-0.666651 --> -0.714800).  Saving model ...
Epoch: 8 cost time: 0.6337168216705322
Epoch: 8, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.435 Vali Acc: 0.733 Test Loss: 1.435 Test Acc: 0.733
Validation loss decreased (-0.714800 --> -0.733319).  Saving model ...
Epoch: 9 cost time: 0.5149688720703125
Epoch: 9, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.370 Vali Acc: 0.785 Test Loss: 1.370 Test Acc: 0.785
Validation loss decreased (-0.733319 --> -0.785171).  Saving model ...
Epoch: 10 cost time: 0.6714389324188232
Epoch: 10, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.300 Vali Acc: 0.830 Test Loss: 1.300 Test Acc: 0.830
Validation loss decreased (-0.785171 --> -0.829617).  Saving model ...
Epoch: 11 cost time: 0.5425002574920654
Epoch: 11, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.228 Vali Acc: 0.856 Test Loss: 1.228 Test Acc: 0.856
Validation loss decreased (-0.829617 --> -0.855543).  Saving model ...
Epoch: 12 cost time: 0.5931587219238281
Epoch: 12, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.154 Vali Acc: 0.885 Test Loss: 1.154 Test Acc: 0.885
Validation loss decreased (-0.855543 --> -0.885174).  Saving model ...
Epoch: 13 cost time: 0.6744217872619629
Epoch: 13, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.079 Vali Acc: 0.885 Test Loss: 1.079 Test Acc: 0.885
Validation loss decreased (-0.885174 --> -0.885174).  Saving model ...
Epoch: 14 cost time: 0.5523293018341064
Epoch: 14, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.004 Vali Acc: 0.885 Test Loss: 1.004 Test Acc: 0.885
Validation loss decreased (-0.885174 --> -0.885175).  Saving model ...
Epoch: 15 cost time: 0.6300075054168701
Epoch: 15, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.929 Vali Acc: 0.896 Test Loss: 0.929 Test Acc: 0.896
Validation loss decreased (-0.885175 --> -0.896287).  Saving model ...
Epoch: 16 cost time: 0.674781322479248
Epoch: 16, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.855 Vali Acc: 0.911 Test Loss: 0.855 Test Acc: 0.911
Validation loss decreased (-0.896287 --> -0.911103).  Saving model ...
Epoch: 17 cost time: 0.5780110359191895
Epoch: 17, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.782 Vali Acc: 0.926 Test Loss: 0.782 Test Acc: 0.926
Validation loss decreased (-0.911103 --> -0.925918).  Saving model ...
Epoch: 18 cost time: 0.5041995048522949
Epoch: 18, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.711 Vali Acc: 0.930 Test Loss: 0.711 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929623).  Saving model ...
Epoch: 19 cost time: 0.6937804222106934
Epoch: 19, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.643 Vali Acc: 0.941 Test Loss: 0.643 Test Acc: 0.941
Validation loss decreased (-0.929623 --> -0.940734).  Saving model ...
Epoch: 20 cost time: 0.6092052459716797
Epoch: 20, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.577 Vali Acc: 0.944 Test Loss: 0.577 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944439).  Saving model ...
Epoch: 21 cost time: 0.6222829818725586
Epoch: 21, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.517 Vali Acc: 0.948 Test Loss: 0.517 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 22 cost time: 0.6249873638153076
Epoch: 22, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.461 Vali Acc: 0.956 Test Loss: 0.461 Test Acc: 0.956
Validation loss decreased (-0.948143 --> -0.955551).  Saving model ...
Epoch: 23 cost time: 0.5549583435058594
Epoch: 23, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.412 Vali Acc: 0.956 Test Loss: 0.412 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 24 cost time: 0.7893059253692627
Epoch: 24, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.367 Vali Acc: 0.948 Test Loss: 0.367 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.789508581161499
Epoch: 25, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7565255165100098
Epoch: 26, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.307 Vali Acc: 0.937 Test Loss: 0.307 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.55507493019104
Epoch: 27, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6761519908905029
Epoch: 28, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8359525203704834
Epoch: 29, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6941080093383789
Epoch: 30, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6730055809020996
Epoch: 31, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6476173400878906
Epoch: 32, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6933126449584961
Epoch: 33, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 22278918
model size : 99.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3609626293182373
Epoch: 1, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.811 Vali Acc: 0.281 Test Loss: 1.811 Test Acc: 0.281
Validation loss decreased (inf --> -0.281463).  Saving model ...
Epoch: 2 cost time: 0.5898902416229248
Epoch: 2, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.770 Vali Acc: 0.270 Test Loss: 1.770 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6155109405517578
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.746 Vali Acc: 0.274 Test Loss: 1.746 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5151271820068359
Epoch: 4, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.723 Vali Acc: 0.300 Test Loss: 1.723 Test Acc: 0.300
Validation loss decreased (-0.281463 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.45910191535949707
Epoch: 5, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.695 Vali Acc: 0.337 Test Loss: 1.695 Test Acc: 0.337
Validation loss decreased (-0.299983 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.6121175289154053
Epoch: 6, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.663 Vali Acc: 0.363 Test Loss: 1.663 Test Acc: 0.363
Validation loss decreased (-0.337020 --> -0.362946).  Saving model ...
Epoch: 7 cost time: 0.6151793003082275
Epoch: 7, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.627 Vali Acc: 0.411 Test Loss: 1.627 Test Acc: 0.411
Validation loss decreased (-0.362946 --> -0.411095).  Saving model ...
Epoch: 8 cost time: 0.6332962512969971
Epoch: 8, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.587 Vali Acc: 0.463 Test Loss: 1.587 Test Acc: 0.463
Validation loss decreased (-0.411095 --> -0.462947).  Saving model ...
Epoch: 9 cost time: 0.6006805896759033
Epoch: 9, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.545 Vali Acc: 0.504 Test Loss: 1.545 Test Acc: 0.504
Validation loss decreased (-0.462947 --> -0.503688).  Saving model ...
Epoch: 10 cost time: 0.5374515056610107
Epoch: 10, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.501 Vali Acc: 0.530 Test Loss: 1.501 Test Acc: 0.530
Validation loss decreased (-0.503688 --> -0.529615).  Saving model ...
Epoch: 11 cost time: 0.5816032886505127
Epoch: 11, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.455 Vali Acc: 0.548 Test Loss: 1.455 Test Acc: 0.548
Validation loss decreased (-0.529615 --> -0.548134).  Saving model ...
Epoch: 12 cost time: 0.635812520980835
Epoch: 12, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.409 Vali Acc: 0.604 Test Loss: 1.409 Test Acc: 0.604
Validation loss decreased (-0.548134 --> -0.603690).  Saving model ...
Epoch: 13 cost time: 0.5675909519195557
Epoch: 13, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.359 Vali Acc: 0.648 Test Loss: 1.359 Test Acc: 0.648
Validation loss decreased (-0.603690 --> -0.648135).  Saving model ...
Epoch: 14 cost time: 0.5830721855163574
Epoch: 14, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.308 Vali Acc: 0.700 Test Loss: 1.308 Test Acc: 0.700
Validation loss decreased (-0.648135 --> -0.699987).  Saving model ...
Epoch: 15 cost time: 0.5176513195037842
Epoch: 15, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.255 Vali Acc: 0.719 Test Loss: 1.255 Test Acc: 0.719
Validation loss decreased (-0.699987 --> -0.718506).  Saving model ...
Epoch: 16 cost time: 0.5748863220214844
Epoch: 16, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.198 Vali Acc: 0.785 Test Loss: 1.198 Test Acc: 0.785
Validation loss decreased (-0.718506 --> -0.785173).  Saving model ...
Epoch: 17 cost time: 0.62196946144104
Epoch: 17, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.139 Vali Acc: 0.796 Test Loss: 1.139 Test Acc: 0.796
Validation loss decreased (-0.785173 --> -0.796285).  Saving model ...
Epoch: 18 cost time: 0.5620744228363037
Epoch: 18, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.079 Vali Acc: 0.830 Test Loss: 1.079 Test Acc: 0.830
Validation loss decreased (-0.796285 --> -0.829619).  Saving model ...
Epoch: 19 cost time: 0.7010869979858398
Epoch: 19, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.018 Vali Acc: 0.852 Test Loss: 1.018 Test Acc: 0.852
Validation loss decreased (-0.829619 --> -0.851842).  Saving model ...
Epoch: 20 cost time: 0.6373076438903809
Epoch: 20, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.957 Vali Acc: 0.859 Test Loss: 0.957 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859250).  Saving model ...
Epoch: 21 cost time: 0.586646556854248
Epoch: 21, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.897 Vali Acc: 0.867 Test Loss: 0.897 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 22 cost time: 0.5829195976257324
Epoch: 22, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.836 Vali Acc: 0.874 Test Loss: 0.836 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 23 cost time: 0.490739107131958
Epoch: 23, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.776 Vali Acc: 0.885 Test Loss: 0.776 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885177).  Saving model ...
Epoch: 24 cost time: 0.640143632888794
Epoch: 24, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.717 Vali Acc: 0.893 Test Loss: 0.717 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892585).  Saving model ...
Epoch: 25 cost time: 0.7096157073974609
Epoch: 25, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.662 Vali Acc: 0.904 Test Loss: 0.662 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903697).  Saving model ...
Epoch: 26 cost time: 0.5602715015411377
Epoch: 26, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.608 Vali Acc: 0.907 Test Loss: 0.608 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 27 cost time: 0.5761909484863281
Epoch: 27, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.552 Vali Acc: 0.907 Test Loss: 0.552 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 28 cost time: 0.6775197982788086
Epoch: 28, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.500 Vali Acc: 0.904 Test Loss: 0.500 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6623201370239258
Epoch: 29, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.452 Vali Acc: 0.904 Test Loss: 0.452 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6376404762268066
Epoch: 30, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.408 Vali Acc: 0.915 Test Loss: 0.408 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.6116821765899658
Epoch: 31, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.5748989582061768
Epoch: 32, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 33 cost time: 0.5563478469848633
Epoch: 33, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 0.6254477500915527
Epoch: 34, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.5980274677276611
Epoch: 35, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 0.6309816837310791
Epoch: 36, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 37 cost time: 0.6258769035339355
Epoch: 37, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 38 cost time: 0.7838008403778076
Epoch: 38, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 39 cost time: 0.5956661701202393
Epoch: 39, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 40 cost time: 0.5809917449951172
Epoch: 40, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6216278076171875
Epoch: 41, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 42 cost time: 0.6108443737030029
Epoch: 42, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.6446192264556885
Epoch: 43, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.7413499355316162
Epoch: 44, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.6595311164855957
Epoch: 45, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.5824129581451416
Epoch: 46, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.6384491920471191
Epoch: 47, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.5274276733398438
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.5571889877319336
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.5957326889038086
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 22248198
model size : 99.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.438511371612549
Epoch: 1, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.777 Vali Acc: 0.211 Test Loss: 1.777 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.6594855785369873
Epoch: 2, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.735 Vali Acc: 0.281 Test Loss: 1.735 Test Acc: 0.281
Validation loss decreased (-0.211093 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.625732421875
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.701 Vali Acc: 0.396 Test Loss: 1.701 Test Acc: 0.396
Validation loss decreased (-0.281464 --> -0.396279).  Saving model ...
Epoch: 4 cost time: 0.6575243473052979
Epoch: 4, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.658 Vali Acc: 0.426 Test Loss: 1.658 Test Acc: 0.426
Validation loss decreased (-0.396279 --> -0.425909).  Saving model ...
Epoch: 5 cost time: 0.6596693992614746
Epoch: 5, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.604 Vali Acc: 0.504 Test Loss: 1.604 Test Acc: 0.504
Validation loss decreased (-0.425909 --> -0.503688).  Saving model ...
Epoch: 6 cost time: 0.6278681755065918
Epoch: 6, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.538 Vali Acc: 0.596 Test Loss: 1.538 Test Acc: 0.596
Validation loss decreased (-0.503688 --> -0.596281).  Saving model ...
Epoch: 7 cost time: 0.5401561260223389
Epoch: 7, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.465 Vali Acc: 0.656 Test Loss: 1.465 Test Acc: 0.656
Validation loss decreased (-0.596281 --> -0.655541).  Saving model ...
Epoch: 8 cost time: 0.5750381946563721
Epoch: 8, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.387 Vali Acc: 0.715 Test Loss: 1.387 Test Acc: 0.715
Validation loss decreased (-0.655541 --> -0.714801).  Saving model ...
Epoch: 9 cost time: 0.6337215900421143
Epoch: 9, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.306 Vali Acc: 0.763 Test Loss: 1.306 Test Acc: 0.763
Validation loss decreased (-0.714801 --> -0.762950).  Saving model ...
Epoch: 10 cost time: 0.5931816101074219
Epoch: 10, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.222 Vali Acc: 0.793 Test Loss: 1.222 Test Acc: 0.793
Validation loss decreased (-0.762950 --> -0.792580).  Saving model ...
Epoch: 11 cost time: 0.6705226898193359
Epoch: 11, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.136 Vali Acc: 0.819 Test Loss: 1.136 Test Acc: 0.819
Validation loss decreased (-0.792580 --> -0.818507).  Saving model ...
Epoch: 12 cost time: 0.626828670501709
Epoch: 12, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.052 Vali Acc: 0.833 Test Loss: 1.052 Test Acc: 0.833
Validation loss decreased (-0.818507 --> -0.833323).  Saving model ...
Epoch: 13 cost time: 0.5789618492126465
Epoch: 13, Steps: 2 | Train Loss: 0.995 Vali Loss: 0.969 Vali Acc: 0.870 Test Loss: 0.969 Test Acc: 0.870
Validation loss decreased (-0.833323 --> -0.870361).  Saving model ...
Epoch: 14 cost time: 0.6543633937835693
Epoch: 14, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.890 Vali Acc: 0.878 Test Loss: 0.890 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 15 cost time: 0.5256435871124268
Epoch: 15, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.812 Vali Acc: 0.889 Test Loss: 0.812 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888881).  Saving model ...
Epoch: 16 cost time: 0.5930061340332031
Epoch: 16, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.734 Vali Acc: 0.889 Test Loss: 0.734 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 17 cost time: 0.6464672088623047
Epoch: 17, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.6101222038269043
Epoch: 18, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.552943229675293
Epoch: 19, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.533 Vali Acc: 0.896 Test Loss: 0.533 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6079130172729492
Epoch: 20, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.474 Vali Acc: 0.919 Test Loss: 0.474 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918514).  Saving model ...
Epoch: 21 cost time: 0.5917787551879883
Epoch: 21, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.421 Vali Acc: 0.919 Test Loss: 0.421 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 22 cost time: 0.6737475395202637
Epoch: 22, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.6047935485839844
Epoch: 23, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.334 Vali Acc: 0.933 Test Loss: 0.334 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.630483865737915
Epoch: 24, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.651616096496582
Epoch: 25, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.7450098991394043
Epoch: 26, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.6865642070770264
Epoch: 27, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6345522403717041
Epoch: 28, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9147605895996094
Epoch: 29, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7132956981658936
Epoch: 30, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.6679060459136963
Epoch: 31, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6768324375152588
Epoch: 32, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7076461315155029
Epoch: 33, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6202752590179443
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7160282135009766
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7825007438659668
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7240886688232422
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6483259201049805
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6109426021575928
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6353297233581543
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 22321926
model size : 99.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6967549324035645
Epoch: 1, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.914 Vali Acc: 0.096 Test Loss: 1.914 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.6908588409423828
Epoch: 2, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.851 Vali Acc: 0.152 Test Loss: 1.851 Test Acc: 0.152
Validation loss decreased (-0.096277 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.6669473648071289
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.809 Vali Acc: 0.215 Test Loss: 1.809 Test Acc: 0.215
Validation loss decreased (-0.151833 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.5539915561676025
Epoch: 4, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.773 Vali Acc: 0.289 Test Loss: 1.773 Test Acc: 0.289
Validation loss decreased (-0.214797 --> -0.288871).  Saving model ...
Epoch: 5 cost time: 0.6429016590118408
Epoch: 5, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.727 Vali Acc: 0.381 Test Loss: 1.727 Test Acc: 0.381
Validation loss decreased (-0.288871 --> -0.381464).  Saving model ...
Epoch: 6 cost time: 0.460817813873291
Epoch: 6, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.678 Vali Acc: 0.422 Test Loss: 1.678 Test Acc: 0.422
Validation loss decreased (-0.381464 --> -0.422205).  Saving model ...
Epoch: 7 cost time: 0.675229549407959
Epoch: 7, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.625 Vali Acc: 0.456 Test Loss: 1.625 Test Acc: 0.456
Validation loss decreased (-0.422205 --> -0.455539).  Saving model ...
Epoch: 8 cost time: 0.8238027095794678
Epoch: 8, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.570 Vali Acc: 0.530 Test Loss: 1.570 Test Acc: 0.530
Validation loss decreased (-0.455539 --> -0.529614).  Saving model ...
Epoch: 9 cost time: 0.6505224704742432
Epoch: 9, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.512 Vali Acc: 0.563 Test Loss: 1.512 Test Acc: 0.563
Validation loss decreased (-0.529614 --> -0.562948).  Saving model ...
Epoch: 10 cost time: 0.6217420101165771
Epoch: 10, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.451 Vali Acc: 0.596 Test Loss: 1.451 Test Acc: 0.596
Validation loss decreased (-0.562948 --> -0.596282).  Saving model ...
Epoch: 11 cost time: 0.8713281154632568
Epoch: 11, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.389 Vali Acc: 0.626 Test Loss: 1.389 Test Acc: 0.626
Validation loss decreased (-0.596282 --> -0.625912).  Saving model ...
Epoch: 12 cost time: 0.6084301471710205
Epoch: 12, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.326 Vali Acc: 0.652 Test Loss: 1.326 Test Acc: 0.652
Validation loss decreased (-0.625912 --> -0.651839).  Saving model ...
Epoch: 13 cost time: 0.6880273818969727
Epoch: 13, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.260 Vali Acc: 0.693 Test Loss: 1.260 Test Acc: 0.693
Validation loss decreased (-0.651839 --> -0.692580).  Saving model ...
Epoch: 14 cost time: 0.5688772201538086
Epoch: 14, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.189 Vali Acc: 0.774 Test Loss: 1.189 Test Acc: 0.774
Validation loss decreased (-0.692580 --> -0.774062).  Saving model ...
Epoch: 15 cost time: 0.6068384647369385
Epoch: 15, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.117 Vali Acc: 0.833 Test Loss: 1.117 Test Acc: 0.833
Validation loss decreased (-0.774062 --> -0.833322).  Saving model ...
Epoch: 16 cost time: 0.7035911083221436
Epoch: 16, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.043 Vali Acc: 0.863 Test Loss: 1.043 Test Acc: 0.863
Validation loss decreased (-0.833322 --> -0.862953).  Saving model ...
Epoch: 17 cost time: 0.5558514595031738
Epoch: 17, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.968 Vali Acc: 0.874 Test Loss: 0.968 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874064).  Saving model ...
Epoch: 18 cost time: 0.6194014549255371
Epoch: 18, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.899 Vali Acc: 0.881 Test Loss: 0.899 Test Acc: 0.881
Validation loss decreased (-0.874064 --> -0.881472).  Saving model ...
Epoch: 19 cost time: 0.606475830078125
Epoch: 19, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.833 Vali Acc: 0.881 Test Loss: 0.833 Test Acc: 0.881
Validation loss decreased (-0.881472 --> -0.881473).  Saving model ...
Epoch: 20 cost time: 0.6168434619903564
Epoch: 20, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.767 Vali Acc: 0.900 Test Loss: 0.767 Test Acc: 0.900
Validation loss decreased (-0.881473 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.5357050895690918
Epoch: 21, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.702 Vali Acc: 0.911 Test Loss: 0.702 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.5589315891265869
Epoch: 22, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.639 Vali Acc: 0.911 Test Loss: 0.639 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.6610903739929199
Epoch: 23, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.582 Vali Acc: 0.915 Test Loss: 0.582 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 24 cost time: 0.5338687896728516
Epoch: 24, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.528 Vali Acc: 0.922 Test Loss: 0.528 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.7158229351043701
Epoch: 25, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.483 Vali Acc: 0.922 Test Loss: 0.483 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.6455576419830322
Epoch: 26, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.441 Vali Acc: 0.919 Test Loss: 0.441 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6060428619384766
Epoch: 27, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6195523738861084
Epoch: 28, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.367 Vali Acc: 0.904 Test Loss: 0.367 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6706538200378418
Epoch: 29, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.332 Vali Acc: 0.907 Test Loss: 0.332 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.56418776512146
Epoch: 30, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
Validation loss decreased (-0.922217 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.5624203681945801
Epoch: 31, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.571861743927002
Epoch: 32, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.5848386287689209
Epoch: 33, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.6480414867401123
Epoch: 34, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.560755729675293
Epoch: 35, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.672837495803833
Epoch: 36, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7522046566009521
Epoch: 37, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.623445987701416
Epoch: 38, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.205 Vali Acc: 0.919 Test Loss: 0.205 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7154748439788818
Epoch: 39, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.66652512550354
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7290704250335693
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6090602874755859
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.567551851272583
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 22285062
model size : 99.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4248993396759033
Epoch: 1, Steps: 2 | Train Loss: 2.029 Vali Loss: 1.898 Vali Acc: 0.119 Test Loss: 1.898 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.8208391666412354
Epoch: 2, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.862 Vali Acc: 0.096 Test Loss: 1.862 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6735098361968994
Epoch: 3, Steps: 2 | Train Loss: 1.973 Vali Loss: 1.837 Vali Acc: 0.130 Test Loss: 1.837 Test Acc: 0.130
Validation loss decreased (-0.118500 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 0.5530252456665039
Epoch: 4, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.811 Vali Acc: 0.137 Test Loss: 1.811 Test Acc: 0.137
Validation loss decreased (-0.129611 --> -0.137019).  Saving model ...
Epoch: 5 cost time: 0.6474170684814453
Epoch: 5, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.779 Vali Acc: 0.159 Test Loss: 1.779 Test Acc: 0.159
Validation loss decreased (-0.137019 --> -0.159241).  Saving model ...
Epoch: 6 cost time: 0.7633953094482422
Epoch: 6, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.743 Vali Acc: 0.185 Test Loss: 1.743 Test Acc: 0.185
Validation loss decreased (-0.159241 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.6696188449859619
Epoch: 7, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.705 Vali Acc: 0.296 Test Loss: 1.705 Test Acc: 0.296
Validation loss decreased (-0.185168 --> -0.296279).  Saving model ...
Epoch: 8 cost time: 0.5363900661468506
Epoch: 8, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.664 Vali Acc: 0.415 Test Loss: 1.664 Test Acc: 0.415
Validation loss decreased (-0.296279 --> -0.414798).  Saving model ...
Epoch: 9 cost time: 0.6459865570068359
Epoch: 9, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.622 Vali Acc: 0.541 Test Loss: 1.622 Test Acc: 0.541
Validation loss decreased (-0.414798 --> -0.540725).  Saving model ...
Epoch: 10 cost time: 0.5990533828735352
Epoch: 10, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.577 Vali Acc: 0.585 Test Loss: 1.577 Test Acc: 0.585
Validation loss decreased (-0.540725 --> -0.585169).  Saving model ...
Epoch: 11 cost time: 0.6084861755371094
Epoch: 11, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.528 Vali Acc: 0.652 Test Loss: 1.528 Test Acc: 0.652
Validation loss decreased (-0.585169 --> -0.651837).  Saving model ...
Epoch: 12 cost time: 0.6170477867126465
Epoch: 12, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.478 Vali Acc: 0.696 Test Loss: 1.478 Test Acc: 0.696
Validation loss decreased (-0.651837 --> -0.696282).  Saving model ...
Epoch: 13 cost time: 0.6135294437408447
Epoch: 13, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.426 Vali Acc: 0.748 Test Loss: 1.426 Test Acc: 0.748
Validation loss decreased (-0.696282 --> -0.748134).  Saving model ...
Epoch: 14 cost time: 0.7627506256103516
Epoch: 14, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.372 Vali Acc: 0.793 Test Loss: 1.372 Test Acc: 0.793
Validation loss decreased (-0.748134 --> -0.792579).  Saving model ...
Epoch: 15 cost time: 0.659947395324707
Epoch: 15, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.318 Vali Acc: 0.826 Test Loss: 1.318 Test Acc: 0.826
Validation loss decreased (-0.792579 --> -0.825913).  Saving model ...
Epoch: 16 cost time: 0.5966942310333252
Epoch: 16, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.261 Vali Acc: 0.856 Test Loss: 1.261 Test Acc: 0.856
Validation loss decreased (-0.825913 --> -0.855543).  Saving model ...
Epoch: 17 cost time: 0.5812845230102539
Epoch: 17, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.202 Vali Acc: 0.870 Test Loss: 1.202 Test Acc: 0.870
Validation loss decreased (-0.855543 --> -0.870358).  Saving model ...
Epoch: 18 cost time: 0.6907258033752441
Epoch: 18, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.140 Vali Acc: 0.881 Test Loss: 1.140 Test Acc: 0.881
Validation loss decreased (-0.870358 --> -0.881470).  Saving model ...
Epoch: 19 cost time: 0.7100818157196045
Epoch: 19, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.075 Vali Acc: 0.896 Test Loss: 1.075 Test Acc: 0.896
Validation loss decreased (-0.881470 --> -0.896286).  Saving model ...
Epoch: 20 cost time: 0.6805410385131836
Epoch: 20, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.010 Vali Acc: 0.907 Test Loss: 1.010 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907397).  Saving model ...
Epoch: 21 cost time: 0.63844895362854
Epoch: 21, Steps: 2 | Train Loss: 0.927 Vali Loss: 0.942 Vali Acc: 0.922 Test Loss: 0.942 Test Acc: 0.922
Validation loss decreased (-0.907397 --> -0.922213).  Saving model ...
Epoch: 22 cost time: 0.6622424125671387
Epoch: 22, Steps: 2 | Train Loss: 0.848 Vali Loss: 0.876 Vali Acc: 0.933 Test Loss: 0.876 Test Acc: 0.933
Validation loss decreased (-0.922213 --> -0.933325).  Saving model ...
Epoch: 23 cost time: 0.5768642425537109
Epoch: 23, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.812 Vali Acc: 0.937 Test Loss: 0.812 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937029).  Saving model ...
Epoch: 24 cost time: 0.5683722496032715
Epoch: 24, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.750 Vali Acc: 0.941 Test Loss: 0.750 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940733).  Saving model ...
Epoch: 25 cost time: 0.719451904296875
Epoch: 25, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.689 Vali Acc: 0.937 Test Loss: 0.689 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6165013313293457
Epoch: 26, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.629 Vali Acc: 0.933 Test Loss: 0.629 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6686460971832275
Epoch: 27, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.571 Vali Acc: 0.944 Test Loss: 0.571 Test Acc: 0.944
Validation loss decreased (-0.940733 --> -0.944439).  Saving model ...
Epoch: 28 cost time: 0.5530884265899658
Epoch: 28, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.515 Vali Acc: 0.941 Test Loss: 0.515 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.558983325958252
Epoch: 29, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.462 Vali Acc: 0.933 Test Loss: 0.462 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.558793306350708
Epoch: 30, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.410 Vali Acc: 0.952 Test Loss: 0.410 Test Acc: 0.952
Validation loss decreased (-0.944439 --> -0.951848).  Saving model ...
Epoch: 31 cost time: 0.657151460647583
Epoch: 31, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.363 Vali Acc: 0.959 Test Loss: 0.363 Test Acc: 0.959
Validation loss decreased (-0.951848 --> -0.959256).  Saving model ...
Epoch: 32 cost time: 0.5863561630249023
Epoch: 32, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.323 Vali Acc: 0.956 Test Loss: 0.323 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5481998920440674
Epoch: 33, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.292 Vali Acc: 0.952 Test Loss: 0.292 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6498818397521973
Epoch: 34, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8338325023651123
Epoch: 35, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5528473854064941
Epoch: 36, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5354568958282471
Epoch: 37, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7650661468505859
Epoch: 38, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6549110412597656
Epoch: 39, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.606804609298706
Epoch: 40, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6352078914642334
Epoch: 41, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_GPT4TS_UEA_ftM_sl65_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 22266630
model size : 99.61MB
