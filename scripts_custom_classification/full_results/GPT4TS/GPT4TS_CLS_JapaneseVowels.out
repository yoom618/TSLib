Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5950112342834473
Epoch: 1, Steps: 17 | Train Loss: 2.155 Vali Loss: 1.948 Vali Acc: 0.376 Test Loss: 1.948 Test Acc: 0.376
Validation loss decreased (inf --> -0.375656).  Saving model ...
Epoch: 2 cost time: 1.8845610618591309
Epoch: 2, Steps: 17 | Train Loss: 1.657 Vali Loss: 1.151 Vali Acc: 0.786 Test Loss: 1.151 Test Acc: 0.786
Validation loss decreased (-0.375656 --> -0.786475).  Saving model ...
Epoch: 3 cost time: 3.588726282119751
Epoch: 3, Steps: 17 | Train Loss: 0.946 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.177865505218506
Epoch: 4, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
Validation loss decreased (-0.786475 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 2.6856439113616943
Epoch: 5, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.306 Vali Acc: 0.892 Test Loss: 0.306 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7900125980377197
Epoch: 6, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.187 Vali Acc: 0.938 Test Loss: 0.187 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 3.142890453338623
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.218 Vali Acc: 0.932 Test Loss: 0.218 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.768768310546875
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
Validation loss decreased (-0.937836 --> -0.954053).  Saving model ...
Epoch: 9 cost time: 3.2704808712005615
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 3.251314640045166
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.323395013809204
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5283260345458984
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.238264560699463
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5585885047912598
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 3.0751290321350098
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0394527912139893
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2048656940460205
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 3.705292224884033
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9085822105407715
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.078540325164795
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.6211912631988525
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 3.6938557624816895
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 3.0800232887268066
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975674).  Saving model ...
Epoch: 24 cost time: 3.5375752449035645
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5402541160583496
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5402426719665527
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.504577398300171
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.4284512996673584
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0366835594177246
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0902175903320312
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.688791275024414
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.6641645431518555
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.083916187286377
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 43673865
model size : 181.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1867523193359375
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.013 Vali Acc: 0.346 Test Loss: 2.013 Test Acc: 0.346
Validation loss decreased (inf --> -0.345926).  Saving model ...
Epoch: 2 cost time: 1.7026567459106445
Epoch: 2, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.542 Vali Acc: 0.776 Test Loss: 1.542 Test Acc: 0.776
Validation loss decreased (-0.345926 --> -0.775660).  Saving model ...
Epoch: 3 cost time: 2.1478962898254395
Epoch: 3, Steps: 17 | Train Loss: 1.286 Vali Loss: 0.888 Vali Acc: 0.857 Test Loss: 0.888 Test Acc: 0.857
Validation loss decreased (-0.775660 --> -0.856748).  Saving model ...
Epoch: 4 cost time: 2.1485910415649414
Epoch: 4, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.856748 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 2.1411027908325195
Epoch: 5, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.929727 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 2.1213438510894775
Epoch: 6, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.065559148788452
Epoch: 7, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1738595962524414
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.123 Vali Acc: 0.951 Test Loss: 0.123 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 2.078399181365967
Epoch: 9, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 1.1458837985992432
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 11 cost time: 1.3490259647369385
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 1.1136023998260498
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5284695625305176
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5718936920166016
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.440810203552246
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.036539316177368
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1776559352874756
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.9309532642364502
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1548643112182617
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.908682107925415
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6319057941436768
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.754291296005249
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.195937156677246
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1214196681976318
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.949995756149292
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2246053218841553
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1588480472564697
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 43555593
model size : 180.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.333529233932495
Epoch: 1, Steps: 17 | Train Loss: 2.156 Vali Loss: 1.860 Vali Acc: 0.581 Test Loss: 1.860 Test Acc: 0.581
Validation loss decreased (inf --> -0.581062).  Saving model ...
Epoch: 2 cost time: 2.79620361328125
Epoch: 2, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.167 Vali Acc: 0.776 Test Loss: 1.167 Test Acc: 0.776
Validation loss decreased (-0.581062 --> -0.775664).  Saving model ...
Epoch: 3 cost time: 3.3232483863830566
Epoch: 3, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.407 Vali Acc: 0.927 Test Loss: 0.407 Test Acc: 0.927
Validation loss decreased (-0.775664 --> -0.927023).  Saving model ...
Epoch: 4 cost time: 2.186234951019287
Epoch: 4, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.650432586669922
Epoch: 5, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.927023 --> -0.962161).  Saving model ...
Epoch: 6 cost time: 2.428539752960205
Epoch: 6, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1633894443511963
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3863844871520996
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1441965103149414
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1688392162323
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6746175289154053
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3909168243408203
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 2.7046806812286377
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4952969551086426
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.534996747970581
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6977035999298096
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 2.622295618057251
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.016932964324951
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9525554180145264
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 20 cost time: 2.5343122482299805
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.228775978088379
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4473109245300293
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.514866590499878
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9205200672149658
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 25 cost time: 2.2230477333068848
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.459627389907837
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.21421480178833
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.519 Vali Acc: 0.938 Test Loss: 0.519 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0699949264526367
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.477729082107544
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 30 cost time: 2.2739462852478027
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.5536744594573975
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.241 Vali Acc: 0.978 Test Loss: 0.241 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.2313640117645264
Epoch: 32, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.311 Vali Acc: 0.951 Test Loss: 0.311 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.3390562534332275
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.3598034381866455
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.246791362762451
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.7802841663360596
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.353118896484375
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.976 Test Loss: 0.161 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.9594979286193848
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.014045000076294
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 43693065
model size : 181.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.596245527267456
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.054 Vali Acc: 0.343 Test Loss: 2.054 Test Acc: 0.343
Validation loss decreased (inf --> -0.343223).  Saving model ...
Epoch: 2 cost time: 1.76959228515625
Epoch: 2, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.607 Vali Acc: 0.868 Test Loss: 1.607 Test Acc: 0.868
Validation loss decreased (-0.343223 --> -0.867551).  Saving model ...
Epoch: 3 cost time: 1.140441656112671
Epoch: 3, Steps: 17 | Train Loss: 1.285 Vali Loss: 0.864 Vali Acc: 0.897 Test Loss: 0.864 Test Acc: 0.897
Validation loss decreased (-0.867551 --> -0.897289).  Saving model ...
Epoch: 4 cost time: 1.7057466506958008
Epoch: 4, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
Validation loss decreased (-0.897289 --> -0.948646).  Saving model ...
Epoch: 5 cost time: 1.965423345565796
Epoch: 5, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.134 Vali Acc: 0.949 Test Loss: 0.134 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 2.0058300495147705
Epoch: 6, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.948647 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 2.2409229278564453
Epoch: 7, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 8 cost time: 1.8109915256500244
Epoch: 8, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8550570011138916
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9687483310699463
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.935394048690796
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6223244667053223
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4094438552856445
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.387613296508789
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.910674810409546
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.973695993423462
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8606586456298828
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 18 cost time: 1.7514011859893799
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7400338649749756
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 20 cost time: 1.9399023056030273
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0211589336395264
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9198951721191406
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9064555168151855
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8690950870513916
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9762279987335205
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1217422485351562
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5188744068145752
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5985608100891113
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4897286891937256
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 43583241
model size : 180.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8755626678466797
Epoch: 1, Steps: 17 | Train Loss: 2.202 Vali Loss: 2.052 Vali Acc: 0.373 Test Loss: 2.052 Test Acc: 0.373
Validation loss decreased (inf --> -0.372952).  Saving model ...
Epoch: 2 cost time: 0.9727034568786621
Epoch: 2, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.732 Vali Acc: 0.784 Test Loss: 1.732 Test Acc: 0.784
Validation loss decreased (-0.372952 --> -0.783766).  Saving model ...
Epoch: 3 cost time: 1.2803311347961426
Epoch: 3, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.149 Vali Acc: 0.865 Test Loss: 1.149 Test Acc: 0.865
Validation loss decreased (-0.783766 --> -0.864853).  Saving model ...
Epoch: 4 cost time: 1.3569252490997314
Epoch: 4, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.388 Vali Acc: 0.930 Test Loss: 0.388 Test Acc: 0.930
Validation loss decreased (-0.864853 --> -0.929726).  Saving model ...
Epoch: 5 cost time: 1.1653685569763184
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.929726 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.150346279144287
Epoch: 6, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 1.457639217376709
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1840572357177734
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 1.5851032733917236
Epoch: 9, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.339235782623291
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4000272750854492
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.2646350860595703
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0253467559814453
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 1.009922981262207
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.2250268459320068
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 16 cost time: 1.1055362224578857
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3502230644226074
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4436964988708496
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0189063549041748
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5499091148376465
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1469948291778564
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 1.4884026050567627
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6069831848144531
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.525439739227295
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3869292736053467
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.477473258972168
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4664287567138672
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8689465522766113
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.332096815109253
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6998169422149658
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.630021572113037
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 43541001
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.761666297912598
Epoch: 1, Steps: 17 | Train Loss: 2.171 Vali Loss: 1.837 Vali Acc: 0.562 Test Loss: 1.837 Test Acc: 0.562
Validation loss decreased (inf --> -0.562144).  Saving model ...
Epoch: 2 cost time: 3.3701624870300293
Epoch: 2, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.123 Vali Acc: 0.846 Test Loss: 1.123 Test Acc: 0.846
Validation loss decreased (-0.562144 --> -0.845935).  Saving model ...
Epoch: 3 cost time: 2.2023329734802246
Epoch: 3, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.421 Vali Acc: 0.908 Test Loss: 0.421 Test Acc: 0.908
Validation loss decreased (-0.845935 --> -0.908104).  Saving model ...
Epoch: 4 cost time: 2.3969480991363525
Epoch: 4, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.182 Vali Acc: 0.935 Test Loss: 0.182 Test Acc: 0.935
Validation loss decreased (-0.908104 --> -0.935133).  Saving model ...
Epoch: 5 cost time: 1.9494600296020508
Epoch: 5, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.935133 --> -0.962161).  Saving model ...
Epoch: 6 cost time: 2.1113452911376953
Epoch: 6, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 7 cost time: 2.6310670375823975
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5753319263458252
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
Validation loss decreased (-0.964864 --> -0.978378).  Saving model ...
Epoch: 9 cost time: 2.541745662689209
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.693087100982666
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2018229961395264
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.501547336578369
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0617902278900146
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1122686862945557
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.951 Test Loss: 0.114 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2615625858306885
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.946 Test Loss: 0.129 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2567319869995117
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.099601984024048
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.1570844650268555
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 43712265
model size : 181.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.447235584259033
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 1.974 Vali Acc: 0.595 Test Loss: 1.974 Test Acc: 0.595
Validation loss decreased (inf --> -0.594575).  Saving model ...
Epoch: 2 cost time: 1.9459121227264404
Epoch: 2, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.505 Vali Acc: 0.832 Test Loss: 1.505 Test Acc: 0.832
Validation loss decreased (-0.594575 --> -0.832417).  Saving model ...
Epoch: 3 cost time: 1.6935439109802246
Epoch: 3, Steps: 17 | Train Loss: 1.220 Vali Loss: 0.724 Vali Acc: 0.916 Test Loss: 0.724 Test Acc: 0.916
Validation loss decreased (-0.832417 --> -0.916209).  Saving model ...
Epoch: 4 cost time: 1.695554494857788
Epoch: 4, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.285 Vali Acc: 0.924 Test Loss: 0.285 Test Acc: 0.924
Validation loss decreased (-0.916209 --> -0.924321).  Saving model ...
Epoch: 5 cost time: 1.8736441135406494
Epoch: 5, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.160 Vali Acc: 0.932 Test Loss: 0.160 Test Acc: 0.932
Validation loss decreased (-0.924321 --> -0.932431).  Saving model ...
Epoch: 6 cost time: 1.5845270156860352
Epoch: 6, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
Validation loss decreased (-0.932431 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 1.6743099689483643
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5341663360595703
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.612363338470459
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.082 Vali Acc: 0.959 Test Loss: 0.082 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3677408695220947
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 1.4921152591705322
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.968 Test Loss: 0.081 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 1.742938756942749
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.965 Test Loss: 0.078 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9018912315368652
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970270).  Saving model ...
Epoch: 14 cost time: 1.4965870380401611
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.973 Test Loss: 0.071 Test Acc: 0.973
Validation loss decreased (-0.970270 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.748891830444336
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.970 Test Loss: 0.073 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7167980670928955
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.8616647720336914
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6129982471466064
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.965 Test Loss: 0.076 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0588366985321045
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.973 Test Loss: 0.068 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2134311199188232
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.970 Test Loss: 0.069 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1247713565826416
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.973 Test Loss: 0.066 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1303133964538574
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.970 Test Loss: 0.067 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.573669672012329
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.968 Test Loss: 0.079 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2420620918273926
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.968 Test Loss: 0.076 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2088770866394043
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.932304859161377
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 43602441
model size : 181.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.365013599395752
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.029 Vali Acc: 0.378 Test Loss: 2.029 Test Acc: 0.378
Validation loss decreased (inf --> -0.378358).  Saving model ...
Epoch: 2 cost time: 1.6524953842163086
Epoch: 2, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.734 Vali Acc: 0.700 Test Loss: 1.734 Test Acc: 0.700
Validation loss decreased (-0.378358 --> -0.699983).  Saving model ...
Epoch: 3 cost time: 1.5647072792053223
Epoch: 3, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.186 Vali Acc: 0.884 Test Loss: 1.186 Test Acc: 0.884
Validation loss decreased (-0.699983 --> -0.883772).  Saving model ...
Epoch: 4 cost time: 1.5631511211395264
Epoch: 4, Steps: 17 | Train Loss: 0.990 Vali Loss: 0.494 Vali Acc: 0.908 Test Loss: 0.494 Test Acc: 0.908
Validation loss decreased (-0.883772 --> -0.908103).  Saving model ...
Epoch: 5 cost time: 1.229560375213623
Epoch: 5, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.303 Vali Acc: 0.916 Test Loss: 0.303 Test Acc: 0.916
Validation loss decreased (-0.908103 --> -0.916213).  Saving model ...
Epoch: 6 cost time: 1.3674283027648926
Epoch: 6, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.157 Vali Acc: 0.949 Test Loss: 0.157 Test Acc: 0.949
Validation loss decreased (-0.916213 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.3117072582244873
Epoch: 7, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.377378225326538
Epoch: 8, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 9 cost time: 1.295656681060791
Epoch: 9, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 10 cost time: 1.5640168190002441
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.957 Test Loss: 0.106 Test Acc: 0.957
Validation loss decreased (-0.956756 --> -0.956756).  Saving model ...
Epoch: 11 cost time: 1.4809980392456055
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 1.5641875267028809
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 13 cost time: 1.2195580005645752
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 1.3577122688293457
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 1.6614351272583008
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.613729476928711
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5143780708312988
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.2009601593017578
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 1.6468515396118164
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.688631296157837
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.469966173171997
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5327188968658447
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4691548347473145
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4859366416931152
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.567026138305664
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.4655513763427734
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4390389919281006
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4111566543579102
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1309401988983154
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.254093885421753
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.263244390487671
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.322728157043457
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1842865943908691
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.060408353805542
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4048206806182861
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 43551753
model size : 180.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2515010833740234
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 1.941 Vali Acc: 0.503 Test Loss: 1.941 Test Acc: 0.503
Validation loss decreased (inf --> -0.502683).  Saving model ...
Epoch: 2 cost time: 1.7908892631530762
Epoch: 2, Steps: 17 | Train Loss: 1.794 Vali Loss: 1.470 Vali Acc: 0.795 Test Loss: 1.470 Test Acc: 0.795
Validation loss decreased (-0.502683 --> -0.794580).  Saving model ...
Epoch: 3 cost time: 1.7832648754119873
Epoch: 3, Steps: 17 | Train Loss: 1.223 Vali Loss: 0.812 Vali Acc: 0.924 Test Loss: 0.812 Test Acc: 0.924
Validation loss decreased (-0.794580 --> -0.924316).  Saving model ...
Epoch: 4 cost time: 1.727074384689331
Epoch: 4, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.924316 --> -0.929726).  Saving model ...
Epoch: 5 cost time: 2.0617849826812744
Epoch: 5, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.180 Vali Acc: 0.938 Test Loss: 0.180 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.9720211029052734
Epoch: 6, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
Validation loss decreased (-0.937836 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 2.081455707550049
Epoch: 7, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0572738647460938
Epoch: 8, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.134 Vali Acc: 0.954 Test Loss: 0.134 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.042999505996704
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.9114758968353271
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.6145563125610352
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 1.6941454410552979
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.962 Test Loss: 0.082 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9190244674682617
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0097978115081787
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.968 Test Loss: 0.083 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.013514518737793
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0808441638946533
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6153597831726074
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1489014625549316
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4816126823425293
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7127859592437744
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7618284225463867
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 43630089
model size : 181.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8481180667877197
Epoch: 1, Steps: 17 | Train Loss: 2.230 Vali Loss: 2.080 Vali Acc: 0.335 Test Loss: 2.080 Test Acc: 0.335
Validation loss decreased (inf --> -0.335114).  Saving model ...
Epoch: 2 cost time: 1.3514301776885986
Epoch: 2, Steps: 17 | Train Loss: 1.930 Vali Loss: 1.707 Vali Acc: 0.684 Test Loss: 1.707 Test Acc: 0.684
Validation loss decreased (-0.335114 --> -0.683767).  Saving model ...
Epoch: 3 cost time: 1.4956128597259521
Epoch: 3, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.004 Vali Acc: 0.878 Test Loss: 1.004 Test Acc: 0.878
Validation loss decreased (-0.683767 --> -0.878368).  Saving model ...
Epoch: 4 cost time: 1.171274185180664
Epoch: 4, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.307 Vali Acc: 0.938 Test Loss: 0.307 Test Acc: 0.938
Validation loss decreased (-0.878368 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.3984196186065674
Epoch: 5, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 1.1111648082733154
Epoch: 6, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 1.5125067234039307
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.954053 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 1.3146634101867676
Epoch: 8, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 0.9199843406677246
Epoch: 9, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.274876356124878
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9964733123779297
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2917289733886719
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3275823593139648
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4278459548950195
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2526230812072754
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4948625564575195
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5309114456176758
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3684349060058594
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 43596297
model size : 180.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.720987558364868
Epoch: 1, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.070 Vali Acc: 0.384 Test Loss: 2.070 Test Acc: 0.384
Validation loss decreased (inf --> -0.383763).  Saving model ...
Epoch: 2 cost time: 1.2198786735534668
Epoch: 2, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.823 Vali Acc: 0.678 Test Loss: 1.823 Test Acc: 0.678
Validation loss decreased (-0.383763 --> -0.678360).  Saving model ...
Epoch: 3 cost time: 0.9122409820556641
Epoch: 3, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.313 Vali Acc: 0.884 Test Loss: 1.313 Test Acc: 0.884
Validation loss decreased (-0.678360 --> -0.883771).  Saving model ...
Epoch: 4 cost time: 1.0745189189910889
Epoch: 4, Steps: 17 | Train Loss: 1.063 Vali Loss: 0.613 Vali Acc: 0.895 Test Loss: 0.613 Test Acc: 0.895
Validation loss decreased (-0.883771 --> -0.894588).  Saving model ...
Epoch: 5 cost time: 1.1234135627746582
Epoch: 5, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.298 Vali Acc: 0.927 Test Loss: 0.298 Test Acc: 0.927
Validation loss decreased (-0.894588 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.1617085933685303
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.927024 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 1.0268561840057373
Epoch: 7, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 8 cost time: 1.0957794189453125
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0734009742736816
Epoch: 9, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.954053 --> -0.978378).  Saving model ...
Epoch: 10 cost time: 1.4165380001068115
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9486300945281982
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7244892120361328
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 13 cost time: 1.1448681354522705
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2774126529693604
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1684656143188477
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.219865083694458
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2738571166992188
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3504140377044678
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3082866668701172
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2290775775909424
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.246189832687378
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.286222219467163
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 43562505
model size : 180.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6177937984466553
Epoch: 1, Steps: 17 | Train Loss: 2.284 Vali Loss: 2.044 Vali Acc: 0.365 Test Loss: 2.044 Test Acc: 0.365
Validation loss decreased (inf --> -0.364844).  Saving model ...
Epoch: 2 cost time: 1.296555519104004
Epoch: 2, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.669 Vali Acc: 0.792 Test Loss: 1.669 Test Acc: 0.792
Validation loss decreased (-0.364844 --> -0.791875).  Saving model ...
Epoch: 3 cost time: 1.3154265880584717
Epoch: 3, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.002 Vali Acc: 0.851 Test Loss: 1.002 Test Acc: 0.851
Validation loss decreased (-0.791875 --> -0.851341).  Saving model ...
Epoch: 4 cost time: 1.4129152297973633
Epoch: 4, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.337 Vali Acc: 0.905 Test Loss: 0.337 Test Acc: 0.905
Validation loss decreased (-0.851341 --> -0.905402).  Saving model ...
Epoch: 5 cost time: 1.452519416809082
Epoch: 5, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.163 Vali Acc: 0.946 Test Loss: 0.163 Test Acc: 0.946
Validation loss decreased (-0.905402 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 0.9683837890625
Epoch: 6, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 1.890747308731079
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7266497611999512
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 1.6943855285644531
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 1.3515441417694092
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 2.125697612762451
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8083806037902832
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8868696689605713
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7076036930084229
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 1.8815851211547852
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4754347801208496
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 1.0977256298065186
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5308899879455566
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3827149868011475
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6191165447235107
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.7409908771514893
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6141064167022705
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5702564716339111
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5828092098236084
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3845500946044922
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.779797077178955
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2367208003997803
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.693619966506958
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7849342823028564
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9750912189483643
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 43649289
model size : 181.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0369460582733154
Epoch: 1, Steps: 17 | Train Loss: 2.224 Vali Loss: 2.067 Vali Acc: 0.297 Test Loss: 2.067 Test Acc: 0.297
Validation loss decreased (inf --> -0.297277).  Saving model ...
Epoch: 2 cost time: 1.4760105609893799
Epoch: 2, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.703 Vali Acc: 0.657 Test Loss: 1.703 Test Acc: 0.657
Validation loss decreased (-0.297277 --> -0.656740).  Saving model ...
Epoch: 3 cost time: 1.2640793323516846
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.047 Vali Acc: 0.881 Test Loss: 1.047 Test Acc: 0.881
Validation loss decreased (-0.656740 --> -0.881071).  Saving model ...
Epoch: 4 cost time: 1.3547453880310059
Epoch: 4, Steps: 17 | Train Loss: 0.803 Vali Loss: 0.403 Vali Acc: 0.905 Test Loss: 0.403 Test Acc: 0.905
Validation loss decreased (-0.881071 --> -0.905401).  Saving model ...
Epoch: 5 cost time: 1.2473199367523193
Epoch: 5, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.905401 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 0.7982141971588135
Epoch: 6, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.0568630695343018
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.945944 --> -0.967567).  Saving model ...
Epoch: 8 cost time: 1.2929444313049316
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9541134834289551
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9380269050598145
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 11 cost time: 1.3262159824371338
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0183687210083008
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9906191825866699
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.423330307006836
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.4223716259002686
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3767411708831787
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3416216373443604
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4347507953643799
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 1.4522192478179932
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4111826419830322
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.298954725265503
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4680323600769043
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 1.1038055419921875
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3484618663787842
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0402097702026367
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2922983169555664
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0967826843261719
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1238582134246826
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2405095100402832
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9255590438842773
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1385111808776855
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1437766551971436
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 43615497
model size : 181.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.635450601577759
Epoch: 1, Steps: 17 | Train Loss: 2.342 Vali Loss: 2.239 Vali Acc: 0.127 Test Loss: 2.239 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 1.038142442703247
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.861 Vali Acc: 0.722 Test Loss: 1.861 Test Acc: 0.722
Validation loss decreased (-0.127005 --> -0.721603).  Saving model ...
Epoch: 3 cost time: 1.2538325786590576
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.408 Vali Acc: 0.841 Test Loss: 1.408 Test Acc: 0.841
Validation loss decreased (-0.721603 --> -0.840526).  Saving model ...
Epoch: 4 cost time: 1.2185907363891602
Epoch: 4, Steps: 17 | Train Loss: 1.184 Vali Loss: 0.687 Vali Acc: 0.897 Test Loss: 0.687 Test Acc: 0.897
Validation loss decreased (-0.840526 --> -0.897290).  Saving model ...
Epoch: 5 cost time: 1.1208178997039795
Epoch: 5, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
Validation loss decreased (-0.897290 --> -0.918916).  Saving model ...
Epoch: 6 cost time: 1.2398622035980225
Epoch: 6, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.918916 --> -0.929728).  Saving model ...
Epoch: 7 cost time: 1.3053090572357178
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.929728 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 0.951080322265625
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0963144302368164
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.264648675918579
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 11 cost time: 1.2139782905578613
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2189855575561523
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 13 cost time: 1.1301956176757812
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.3587360382080078
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 15 cost time: 1.05019211769104
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0162827968597412
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0124702453613281
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8645455837249756
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.001236915588379
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9352519512176514
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0858538150787354
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0482611656188965
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9735326766967773
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0457797050476074
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 43581705
model size : 180.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.586420774459839
Epoch: 1, Steps: 17 | Train Loss: 2.167 Vali Loss: 1.930 Vali Acc: 0.386 Test Loss: 1.930 Test Acc: 0.386
Validation loss decreased (inf --> -0.386467).  Saving model ...
Epoch: 2 cost time: 2.356593132019043
Epoch: 2, Steps: 17 | Train Loss: 1.613 Vali Loss: 1.109 Vali Acc: 0.835 Test Loss: 1.109 Test Acc: 0.835
Validation loss decreased (-0.386467 --> -0.835124).  Saving model ...
Epoch: 3 cost time: 2.179908037185669
Epoch: 3, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.726 Vali Acc: 0.762 Test Loss: 0.726 Test Acc: 0.762
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.060230016708374
Epoch: 4, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.835124 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 2.080176830291748
Epoch: 5, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.921619 --> -0.921620).  Saving model ...
Epoch: 6 cost time: 1.6503901481628418
Epoch: 6, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.228 Vali Acc: 0.916 Test Loss: 0.228 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8809995651245117
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.921620 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.844740390777588
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5473177433013916
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.579270601272583
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3674256801605225
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0891530513763428
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.6663172245025635
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7182002067565918
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2469375133514404
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7310104370117188
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.047222852706909
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.5636155605316162
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0146903991699219
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9347312450408936
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0196523666381836
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0481531620025635
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9715759754180908
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6055097579956055
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8533790111541748
Epoch: 25, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.267 Vali Acc: 0.957 Test Loss: 0.267 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9414002895355225
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6844427585601807
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.397 Vali Acc: 0.932 Test Loss: 0.397 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 36585993
model size : 154.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5737509727478027
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.006 Vali Acc: 0.357 Test Loss: 2.006 Test Acc: 0.357
Validation loss decreased (inf --> -0.356737).  Saving model ...
Epoch: 2 cost time: 1.1607928276062012
Epoch: 2, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.521 Vali Acc: 0.754 Test Loss: 1.521 Test Acc: 0.754
Validation loss decreased (-0.356737 --> -0.754039).  Saving model ...
Epoch: 3 cost time: 1.1634268760681152
Epoch: 3, Steps: 17 | Train Loss: 1.256 Vali Loss: 0.878 Vali Acc: 0.876 Test Loss: 0.878 Test Acc: 0.876
Validation loss decreased (-0.754039 --> -0.875667).  Saving model ...
Epoch: 4 cost time: 1.0749890804290771
Epoch: 4, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.875667 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.2402887344360352
Epoch: 5, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.929727 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 1.3506700992584229
Epoch: 6, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.131 Vali Acc: 0.946 Test Loss: 0.131 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3381268978118896
Epoch: 7, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.197 Vali Acc: 0.935 Test Loss: 0.197 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2330586910247803
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967567).  Saving model ...
Epoch: 9 cost time: 1.2886247634887695
Epoch: 9, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.212792158126831
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9672760963439941
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2538816928863525
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 13 cost time: 0.9802680015563965
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.116072416305542
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2646119594573975
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 16 cost time: 0.8307602405548096
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 1.273378849029541
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.970269 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 1.1445493698120117
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0109128952026367
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.33778715133667
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.104975700378418
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1970133781433105
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4463512897491455
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2071902751922607
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.429231882095337
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3509459495544434
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.280837059020996
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 36467721
model size : 153.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6002142429351807
Epoch: 1, Steps: 17 | Train Loss: 2.151 Vali Loss: 1.848 Vali Acc: 0.557 Test Loss: 1.848 Test Acc: 0.557
Validation loss decreased (inf --> -0.556738).  Saving model ...
Epoch: 2 cost time: 1.5292251110076904
Epoch: 2, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.136 Vali Acc: 0.781 Test Loss: 1.136 Test Acc: 0.781
Validation loss decreased (-0.556738 --> -0.781070).  Saving model ...
Epoch: 3 cost time: 1.4133288860321045
Epoch: 3, Steps: 17 | Train Loss: 0.768 Vali Loss: 0.409 Vali Acc: 0.919 Test Loss: 0.409 Test Acc: 0.919
Validation loss decreased (-0.781070 --> -0.918915).  Saving model ...
Epoch: 4 cost time: 1.1463110446929932
Epoch: 4, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.254 Vali Acc: 0.903 Test Loss: 0.254 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1793863773345947
Epoch: 5, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (-0.918915 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.5119421482086182
Epoch: 6, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.948647 --> -0.967567).  Saving model ...
Epoch: 7 cost time: 0.9403584003448486
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6433546543121338
Epoch: 8, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4055171012878418
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.5398626327514648
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2338204383850098
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3547608852386475
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.762042760848999
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.3027546405792236
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.991014003753662
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.935 Test Loss: 0.196 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6524298191070557
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7590320110321045
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7938554286956787
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6871693134307861
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4682719707489014
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.673980712890625
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5853097438812256
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6510872840881348
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 36605193
model size : 154.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3050332069396973
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.049 Vali Acc: 0.314 Test Loss: 2.049 Test Acc: 0.314
Validation loss decreased (inf --> -0.313493).  Saving model ...
Epoch: 2 cost time: 1.032895803451538
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.591 Vali Acc: 0.862 Test Loss: 1.591 Test Acc: 0.862
Validation loss decreased (-0.313493 --> -0.862146).  Saving model ...
Epoch: 3 cost time: 1.1111645698547363
Epoch: 3, Steps: 17 | Train Loss: 1.277 Vali Loss: 0.872 Vali Acc: 0.889 Test Loss: 0.872 Test Acc: 0.889
Validation loss decreased (-0.862146 --> -0.889180).  Saving model ...
Epoch: 4 cost time: 1.036651849746704
Epoch: 4, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.230 Vali Acc: 0.946 Test Loss: 0.230 Test Acc: 0.946
Validation loss decreased (-0.889180 --> -0.945944).  Saving model ...
Epoch: 5 cost time: 1.1895537376403809
Epoch: 5, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.945944 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 1.3068537712097168
Epoch: 6, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 7 cost time: 1.120903730392456
Epoch: 7, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.964864 --> -0.978378).  Saving model ...
Epoch: 8 cost time: 1.349161148071289
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1303224563598633
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.773369550704956
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0227022171020508
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9107253551483154
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2040736675262451
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3573825359344482
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1477735042572021
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8493397235870361
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2306880950927734
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 36495369
model size : 153.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.533071994781494
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.044 Vali Acc: 0.373 Test Loss: 2.044 Test Acc: 0.373
Validation loss decreased (inf --> -0.372953).  Saving model ...
Epoch: 2 cost time: 1.0921204090118408
Epoch: 2, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.722 Vali Acc: 0.795 Test Loss: 1.722 Test Acc: 0.795
Validation loss decreased (-0.372953 --> -0.794577).  Saving model ...
Epoch: 3 cost time: 1.0854747295379639
Epoch: 3, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.144 Vali Acc: 0.859 Test Loss: 1.144 Test Acc: 0.859
Validation loss decreased (-0.794577 --> -0.859448).  Saving model ...
Epoch: 4 cost time: 0.9213037490844727
Epoch: 4, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.361 Vali Acc: 0.924 Test Loss: 0.361 Test Acc: 0.924
Validation loss decreased (-0.859448 --> -0.924321).  Saving model ...
Epoch: 5 cost time: 1.005401849746704
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.924321 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 1.0175232887268066
Epoch: 6, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.1455779075622559
Epoch: 7, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 1.1277618408203125
Epoch: 8, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.0495669841766357
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0231800079345703
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7656924724578857
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0096371173858643
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 1.008967638015747
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9489681720733643
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9117143154144287
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0070092678070068
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8621578216552734
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6973960399627686
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7899529933929443
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9464788436889648
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6712918281555176
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7926867008209229
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 36453129
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3802709579467773
Epoch: 1, Steps: 17 | Train Loss: 2.149 Vali Loss: 1.815 Vali Acc: 0.581 Test Loss: 1.815 Test Acc: 0.581
Validation loss decreased (inf --> -0.581063).  Saving model ...
Epoch: 2 cost time: 0.8552541732788086
Epoch: 2, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.082 Vali Acc: 0.859 Test Loss: 1.082 Test Acc: 0.859
Validation loss decreased (-0.581063 --> -0.859449).  Saving model ...
Epoch: 3 cost time: 0.8426816463470459
Epoch: 3, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.404 Vali Acc: 0.911 Test Loss: 0.404 Test Acc: 0.911
Validation loss decreased (-0.859449 --> -0.910807).  Saving model ...
Epoch: 4 cost time: 1.3260018825531006
Epoch: 4, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
Validation loss decreased (-0.910807 --> -0.948647).  Saving model ...
Epoch: 5 cost time: 1.2255828380584717
Epoch: 5, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 1.3126463890075684
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 0.9191396236419678
Epoch: 7, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 1.3469879627227783
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6847858428955078
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4434030055999756
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3763067722320557
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 1.3213756084442139
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 1.6317262649536133
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 1.0942628383636475
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.394042730331421
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.271665334701538
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8241925239562988
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.126335859298706
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1233189105987549
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1841349601745605
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0740818977355957
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.6148393154144287
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 1.5600311756134033
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.1442203521728516
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0582878589630127
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 1.47629714012146
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5020642280578613
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.962 Test Loss: 0.085 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.356318712234497
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.553002119064331
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.962 Test Loss: 0.088 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.482325792312622
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.4140279293060303
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 32 cost time: 1.330371379852295
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2019500732421875
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2579810619354248
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2300934791564941
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2424242496490479
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3730461597442627
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2520508766174316
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3877167701721191
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2789068222045898
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.382554054260254
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 36624393
model size : 154.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6287312507629395
Epoch: 1, Steps: 17 | Train Loss: 2.206 Vali Loss: 1.957 Vali Acc: 0.643 Test Loss: 1.957 Test Acc: 0.643
Validation loss decreased (inf --> -0.643224).  Saving model ...
Epoch: 2 cost time: 0.9088711738586426
Epoch: 2, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.473 Vali Acc: 0.830 Test Loss: 1.473 Test Acc: 0.830
Validation loss decreased (-0.643224 --> -0.829715).  Saving model ...
Epoch: 3 cost time: 0.9667134284973145
Epoch: 3, Steps: 17 | Train Loss: 1.171 Vali Loss: 0.677 Vali Acc: 0.922 Test Loss: 0.677 Test Acc: 0.922
Validation loss decreased (-0.829715 --> -0.921615).  Saving model ...
Epoch: 4 cost time: 1.0125365257263184
Epoch: 4, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.248 Vali Acc: 0.924 Test Loss: 0.248 Test Acc: 0.924
Validation loss decreased (-0.921615 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 0.7925846576690674
Epoch: 5, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.159 Vali Acc: 0.943 Test Loss: 0.159 Test Acc: 0.943
Validation loss decreased (-0.924322 --> -0.943242).  Saving model ...
Epoch: 6 cost time: 0.9583230018615723
Epoch: 6, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.943242 --> -0.972972).  Saving model ...
Epoch: 7 cost time: 0.8209612369537354
Epoch: 7, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.115 Vali Acc: 0.954 Test Loss: 0.115 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7567572593688965
Epoch: 8, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8684074878692627
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9837281703948975
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.0592646598815918
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.840662956237793
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.968 Test Loss: 0.078 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9309918880462646
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.064 Vali Acc: 0.973 Test Loss: 0.064 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0342988967895508
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8987610340118408
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8387670516967773
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.968 Test Loss: 0.085 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0680346488952637
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9847586154937744
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.965 Test Loss: 0.076 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0432512760162354
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9433612823486328
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 36514569
model size : 153.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 1.9838957786560059
Epoch: 1, Steps: 17 | Train Loss: 2.149 Vali Loss: 2.016 Vali Acc: 0.397 Test Loss: 2.016 Test Acc: 0.397
Validation loss decreased (inf --> -0.397277).  Saving model ...
Epoch: 2 cost time: 0.7713265419006348
Epoch: 2, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.698 Vali Acc: 0.743 Test Loss: 1.698 Test Acc: 0.743
Validation loss decreased (-0.397277 --> -0.743226).  Saving model ...
Epoch: 3 cost time: 0.8194818496704102
Epoch: 3, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.130 Vali Acc: 0.892 Test Loss: 1.130 Test Acc: 0.892
Validation loss decreased (-0.743226 --> -0.891881).  Saving model ...
Epoch: 4 cost time: 0.901209831237793
Epoch: 4, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.470 Vali Acc: 0.914 Test Loss: 0.470 Test Acc: 0.914
Validation loss decreased (-0.891881 --> -0.913509).  Saving model ...
Epoch: 5 cost time: 0.9217064380645752
Epoch: 5, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.301 Vali Acc: 0.908 Test Loss: 0.301 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8826415538787842
Epoch: 6, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.913509 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 1.139003038406372
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9065353870391846
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.1017003059387207
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9450867176055908
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.953859806060791
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.959458 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.052690029144287
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0483803749084473
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8394825458526611
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.794593334197998
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9274406433105469
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0877540111541748
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.006345272064209
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7976808547973633
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0349864959716797
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1083295345306396
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 36463881
model size : 153.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6467955112457275
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 1.920 Vali Acc: 0.511 Test Loss: 1.920 Test Acc: 0.511
Validation loss decreased (inf --> -0.510792).  Saving model ...
Epoch: 2 cost time: 0.9238028526306152
Epoch: 2, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.407 Vali Acc: 0.830 Test Loss: 1.407 Test Acc: 0.830
Validation loss decreased (-0.510792 --> -0.829716).  Saving model ...
Epoch: 3 cost time: 1.268834114074707
Epoch: 3, Steps: 17 | Train Loss: 1.117 Vali Loss: 0.675 Vali Acc: 0.938 Test Loss: 0.675 Test Acc: 0.938
Validation loss decreased (-0.829716 --> -0.937831).  Saving model ...
Epoch: 4 cost time: 0.8755550384521484
Epoch: 4, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.319 Vali Acc: 0.889 Test Loss: 0.319 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0637505054473877
Epoch: 5, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
Validation loss decreased (-0.937831 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 0.9152541160583496
Epoch: 6, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
Validation loss decreased (-0.940539 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 0.7325928211212158
Epoch: 7, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9923272132873535
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.147 Vali Acc: 0.949 Test Loss: 0.147 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7945020198822021
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 0.9590544700622559
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8633670806884766
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 0.7513980865478516
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 0.9795551300048828
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0538935661315918
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0755577087402344
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2845163345336914
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0866186618804932
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0469591617584229
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.236539602279663
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0846385955810547
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2323358058929443
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.035416841506958
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 36542217
model size : 154.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3437657356262207
Epoch: 1, Steps: 17 | Train Loss: 2.257 Vali Loss: 2.072 Vali Acc: 0.362 Test Loss: 2.072 Test Acc: 0.362
Validation loss decreased (inf --> -0.362141).  Saving model ...
Epoch: 2 cost time: 0.9818727970123291
Epoch: 2, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.684 Vali Acc: 0.681 Test Loss: 1.684 Test Acc: 0.681
Validation loss decreased (-0.362141 --> -0.681064).  Saving model ...
Epoch: 3 cost time: 0.9178423881530762
Epoch: 3, Steps: 17 | Train Loss: 1.395 Vali Loss: 0.970 Vali Acc: 0.900 Test Loss: 0.970 Test Acc: 0.900
Validation loss decreased (-0.681064 --> -0.899990).  Saving model ...
Epoch: 4 cost time: 0.9650418758392334
Epoch: 4, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.302 Vali Acc: 0.932 Test Loss: 0.302 Test Acc: 0.932
Validation loss decreased (-0.899990 --> -0.932429).  Saving model ...
Epoch: 5 cost time: 0.9208803176879883
Epoch: 5, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 1.01999831199646
Epoch: 6, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.937836 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 0.8834991455078125
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 0.91339111328125
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 0.8912181854248047
Epoch: 9, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8698279857635498
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8135900497436523
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 1.0953168869018555
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9499685764312744
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0524218082427979
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8816256523132324
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9898257255554199
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1205785274505615
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1002519130706787
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 0.9469387531280518
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7916524410247803
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9490680694580078
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9367368221282959
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9173996448516846
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8728744983673096
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.770923376083374
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8279647827148438
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9280366897583008
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.84283447265625
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 36508425
model size : 153.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.118309259414673
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.066 Vali Acc: 0.381 Test Loss: 2.066 Test Acc: 0.381
Validation loss decreased (inf --> -0.381060).  Saving model ...
Epoch: 2 cost time: 0.904731035232544
Epoch: 2, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.800 Vali Acc: 0.695 Test Loss: 1.800 Test Acc: 0.695
Validation loss decreased (-0.381060 --> -0.694577).  Saving model ...
Epoch: 3 cost time: 0.8728005886077881
Epoch: 3, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.273 Vali Acc: 0.881 Test Loss: 1.273 Test Acc: 0.881
Validation loss decreased (-0.694577 --> -0.881068).  Saving model ...
Epoch: 4 cost time: 0.7684907913208008
Epoch: 4, Steps: 17 | Train Loss: 1.038 Vali Loss: 0.583 Vali Acc: 0.914 Test Loss: 0.583 Test Acc: 0.914
Validation loss decreased (-0.881068 --> -0.913508).  Saving model ...
Epoch: 5 cost time: 1.1195898056030273
Epoch: 5, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
Validation loss decreased (-0.913508 --> -0.918916).  Saving model ...
Epoch: 6 cost time: 1.0634095668792725
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.918916 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 0.6926522254943848
Epoch: 7, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 0.9587666988372803
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 0.9680159091949463
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.0970098972320557
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1547236442565918
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9917011260986328
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0647342205047607
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9856884479522705
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.990283727645874
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1154284477233887
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9391875267028809
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7656137943267822
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7126328945159912
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 36474633
model size : 153.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3544118404388428
Epoch: 1, Steps: 17 | Train Loss: 2.267 Vali Loss: 2.033 Vali Acc: 0.389 Test Loss: 2.033 Test Acc: 0.389
Validation loss decreased (inf --> -0.389169).  Saving model ...
Epoch: 2 cost time: 0.857764482498169
Epoch: 2, Steps: 17 | Train Loss: 1.910 Vali Loss: 1.619 Vali Acc: 0.797 Test Loss: 1.619 Test Acc: 0.797
Validation loss decreased (-0.389169 --> -0.797281).  Saving model ...
Epoch: 3 cost time: 0.9468863010406494
Epoch: 3, Steps: 17 | Train Loss: 1.320 Vali Loss: 0.877 Vali Acc: 0.868 Test Loss: 0.877 Test Acc: 0.868
Validation loss decreased (-0.797281 --> -0.867559).  Saving model ...
Epoch: 4 cost time: 0.9457967281341553
Epoch: 4, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.315 Vali Acc: 0.908 Test Loss: 0.315 Test Acc: 0.908
Validation loss decreased (-0.867559 --> -0.908105).  Saving model ...
Epoch: 5 cost time: 0.8948216438293457
Epoch: 5, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.908105 --> -0.954053).  Saving model ...
Epoch: 6 cost time: 1.2481257915496826
Epoch: 6, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 0.8917672634124756
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9688773155212402
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 0.8584239482879639
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 10 cost time: 1.0968902111053467
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.157886266708374
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 0.9673292636871338
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9970376491546631
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8094918727874756
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9167635440826416
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.909930944442749
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5946929454803467
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0471060276031494
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.748624324798584
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.80722975730896
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7613451480865479
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 36561417
model size : 154.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4496994018554688
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.064 Vali Acc: 0.297 Test Loss: 2.064 Test Acc: 0.297
Validation loss decreased (inf --> -0.297277).  Saving model ...
Epoch: 2 cost time: 0.8379566669464111
Epoch: 2, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.684 Vali Acc: 0.659 Test Loss: 1.684 Test Acc: 0.659
Validation loss decreased (-0.297277 --> -0.659443).  Saving model ...
Epoch: 3 cost time: 0.8524074554443359
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.049 Vali Acc: 0.881 Test Loss: 1.049 Test Acc: 0.881
Validation loss decreased (-0.659443 --> -0.881071).  Saving model ...
Epoch: 4 cost time: 0.9321150779724121
Epoch: 4, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
Validation loss decreased (-0.881071 --> -0.899996).  Saving model ...
Epoch: 5 cost time: 0.9764297008514404
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
Validation loss decreased (-0.899996 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 0.9314732551574707
Epoch: 6, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 1.0430655479431152
Epoch: 7, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.117 Vali Acc: 0.951 Test Loss: 0.117 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8629913330078125
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 0.9599392414093018
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9987514019012451
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1044785976409912
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.959458 --> -0.978378).  Saving model ...
Epoch: 12 cost time: 0.8402092456817627
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1369142532348633
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0782842636108398
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9474387168884277
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8713021278381348
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 0.9971661567687988
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8702139854431152
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9224584102630615
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9805264472961426
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7341077327728271
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8988351821899414
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8822989463806152
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8578586578369141
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9540550708770752
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7043850421905518
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 36527625
model size : 154.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5061750411987305
Epoch: 1, Steps: 17 | Train Loss: 2.317 Vali Loss: 2.231 Vali Acc: 0.141 Test Loss: 2.231 Test Acc: 0.141
Validation loss decreased (inf --> -0.140518).  Saving model ...
Epoch: 2 cost time: 0.9438409805297852
Epoch: 2, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.836 Vali Acc: 0.732 Test Loss: 1.836 Test Acc: 0.732
Validation loss decreased (-0.140518 --> -0.732414).  Saving model ...
Epoch: 3 cost time: 1.1740968227386475
Epoch: 3, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.391 Vali Acc: 0.857 Test Loss: 1.391 Test Acc: 0.857
Validation loss decreased (-0.732414 --> -0.856743).  Saving model ...
Epoch: 4 cost time: 1.0177404880523682
Epoch: 4, Steps: 17 | Train Loss: 1.185 Vali Loss: 0.698 Vali Acc: 0.908 Test Loss: 0.698 Test Acc: 0.908
Validation loss decreased (-0.856743 --> -0.908101).  Saving model ...
Epoch: 5 cost time: 1.028653860092163
Epoch: 5, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.908101 --> -0.929727).  Saving model ...
Epoch: 6 cost time: 0.940291166305542
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.198 Vali Acc: 0.938 Test Loss: 0.198 Test Acc: 0.938
Validation loss decreased (-0.929727 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 0.9690723419189453
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.937836 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 0.9948081970214844
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7565088272094727
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 0.9515595436096191
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8749871253967285
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 0.8494617938995361
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 0.997556209564209
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8132922649383545
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 0.9047365188598633
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 0.7691900730133057
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7954428195953369
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0996310710906982
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 19 cost time: 1.0071074962615967
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7978320121765137
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8540232181549072
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8691349029541016
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.03764009475708
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1543292999267578
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9090237617492676
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1377487182617188
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9164814949035645
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9229588508605957
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 36493833
model size : 153.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6236860752105713
Epoch: 1, Steps: 17 | Train Loss: 2.146 Vali Loss: 1.915 Vali Acc: 0.400 Test Loss: 1.915 Test Acc: 0.400
Validation loss decreased (inf --> -0.399981).  Saving model ...
Epoch: 2 cost time: 1.1225414276123047
Epoch: 2, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.111 Vali Acc: 0.814 Test Loss: 1.111 Test Acc: 0.814
Validation loss decreased (-0.399981 --> -0.813502).  Saving model ...
Epoch: 3 cost time: 1.180976152420044
Epoch: 3, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.765 Vali Acc: 0.711 Test Loss: 0.765 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3898661136627197
Epoch: 4, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.230 Vali Acc: 0.924 Test Loss: 0.230 Test Acc: 0.924
Validation loss decreased (-0.813502 --> -0.924322).  Saving model ...
Epoch: 5 cost time: 1.4386236667633057
Epoch: 5, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.221 Vali Acc: 0.927 Test Loss: 0.221 Test Acc: 0.927
Validation loss decreased (-0.924322 --> -0.927025).  Saving model ...
Epoch: 6 cost time: 1.4825267791748047
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.301 Vali Acc: 0.892 Test Loss: 0.301 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.792226791381836
Epoch: 7, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.927025 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 1.2059168815612793
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4652879238128662
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.951350 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.766460657119751
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.1127362251281738
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4761226177215576
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4560894966125488
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5753390789031982
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2463407516479492
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3409652709960938
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1082065105438232
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.33697509765625
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9759688377380371
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.432955265045166
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29498121
model size : 127.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5554909706115723
Epoch: 1, Steps: 17 | Train Loss: 2.199 Vali Loss: 1.996 Vali Acc: 0.376 Test Loss: 1.996 Test Acc: 0.376
Validation loss decreased (inf --> -0.375656).  Saving model ...
Epoch: 2 cost time: 1.219078540802002
Epoch: 2, Steps: 17 | Train Loss: 1.817 Vali Loss: 1.502 Vali Acc: 0.759 Test Loss: 1.502 Test Acc: 0.759
Validation loss decreased (-0.375656 --> -0.759444).  Saving model ...
Epoch: 3 cost time: 1.1775951385498047
Epoch: 3, Steps: 17 | Train Loss: 1.270 Vali Loss: 0.899 Vali Acc: 0.849 Test Loss: 0.899 Test Acc: 0.849
Validation loss decreased (-0.759444 --> -0.848640).  Saving model ...
Epoch: 4 cost time: 1.0312325954437256
Epoch: 4, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.318 Vali Acc: 0.932 Test Loss: 0.318 Test Acc: 0.932
Validation loss decreased (-0.848640 --> -0.932429).  Saving model ...
Epoch: 5 cost time: 1.1009480953216553
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.932429 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 0.64984130859375
Epoch: 6, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.125 Vali Acc: 0.951 Test Loss: 0.125 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 0.8654618263244629
Epoch: 7, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.113 Vali Acc: 0.957 Test Loss: 0.113 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 8 cost time: 0.8287301063537598
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.956756 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 0.8119165897369385
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8534340858459473
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9809184074401855
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.949554443359375
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9877486228942871
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 0.9360935688018799
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7979059219360352
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8034405708312988
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 0.8638384342193604
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7916431427001953
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9410426616668701
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9715681076049805
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9663424491882324
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 1.0184121131896973
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8642058372497559
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.950005292892456
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 25 cost time: 1.0455212593078613
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0864911079406738
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0078725814819336
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0084872245788574
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.99936842918396
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9947671890258789
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6705942153930664
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.002211570739746
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.006349802017212
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9543797969818115
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29379849
model size : 126.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4448275566101074
Epoch: 1, Steps: 17 | Train Loss: 2.158 Vali Loss: 1.830 Vali Acc: 0.589 Test Loss: 1.830 Test Acc: 0.589
Validation loss decreased (inf --> -0.589171).  Saving model ...
Epoch: 2 cost time: 1.4244589805603027
Epoch: 2, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.130 Vali Acc: 0.776 Test Loss: 1.130 Test Acc: 0.776
Validation loss decreased (-0.589171 --> -0.775664).  Saving model ...
Epoch: 3 cost time: 1.4580163955688477
Epoch: 3, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.427 Vali Acc: 0.919 Test Loss: 0.427 Test Acc: 0.919
Validation loss decreased (-0.775664 --> -0.918915).  Saving model ...
Epoch: 4 cost time: 1.355513572692871
Epoch: 4, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.220 Vali Acc: 0.927 Test Loss: 0.220 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927025).  Saving model ...
Epoch: 5 cost time: 1.1184682846069336
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.168 Vali Acc: 0.949 Test Loss: 0.168 Test Acc: 0.949
Validation loss decreased (-0.927025 --> -0.948647).  Saving model ...
Epoch: 6 cost time: 1.448721170425415
Epoch: 6, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.7852559089660645
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 1.6683683395385742
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8070845603942871
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 1.3744831085205078
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3993377685546875
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.6021103858947754
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 1.4070866107940674
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2328505516052246
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.332320213317871
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3885514736175537
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4944376945495605
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1666152477264404
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.221564531326294
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9246461391448975
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2346789836883545
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.573207139968872
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29517321
model size : 127.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.770531177520752
Epoch: 1, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.041 Vali Acc: 0.322 Test Loss: 2.041 Test Acc: 0.322
Validation loss decreased (inf --> -0.321601).  Saving model ...
Epoch: 2 cost time: 1.2984554767608643
Epoch: 2, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.576 Vali Acc: 0.849 Test Loss: 1.576 Test Acc: 0.849
Validation loss decreased (-0.321601 --> -0.848633).  Saving model ...
Epoch: 3 cost time: 1.4241952896118164
Epoch: 3, Steps: 17 | Train Loss: 1.281 Vali Loss: 0.900 Vali Acc: 0.886 Test Loss: 0.900 Test Acc: 0.886
Validation loss decreased (-0.848633 --> -0.886477).  Saving model ...
Epoch: 4 cost time: 1.087860345840454
Epoch: 4, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.304 Vali Acc: 0.935 Test Loss: 0.304 Test Acc: 0.935
Validation loss decreased (-0.886477 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.2055816650390625
Epoch: 5, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.935132 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 0.9982805252075195
Epoch: 6, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.951350 --> -0.967567).  Saving model ...
Epoch: 7 cost time: 1.2142012119293213
Epoch: 7, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1780500411987305
Epoch: 8, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.0446312427520752
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.2122790813446045
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.065929889678955
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2438063621520996
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1853020191192627
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 14 cost time: 1.3570988178253174
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 0.9930744171142578
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.093261957168579
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0085399150848389
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1221566200256348
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.144514560699463
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1701698303222656
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.929969072341919
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0778825283050537
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1541783809661865
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9298114776611328
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29407497
model size : 126.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.1323204040527344
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 2.037 Vali Acc: 0.386 Test Loss: 2.037 Test Acc: 0.386
Validation loss decreased (inf --> -0.386466).  Saving model ...
Epoch: 2 cost time: 0.9584193229675293
Epoch: 2, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.697 Vali Acc: 0.816 Test Loss: 1.697 Test Acc: 0.816
Validation loss decreased (-0.386466 --> -0.816199).  Saving model ...
Epoch: 3 cost time: 0.8474702835083008
Epoch: 3, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.125 Vali Acc: 0.862 Test Loss: 1.125 Test Acc: 0.862
Validation loss decreased (-0.816199 --> -0.862151).  Saving model ...
Epoch: 4 cost time: 0.851083517074585
Epoch: 4, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.410 Vali Acc: 0.924 Test Loss: 0.410 Test Acc: 0.924
Validation loss decreased (-0.862151 --> -0.924320).  Saving model ...
Epoch: 5 cost time: 0.736238956451416
Epoch: 5, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.924320 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 0.9761545658111572
Epoch: 6, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.951350 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 0.9703118801116943
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0846514701843262
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 1.03682279586792
Epoch: 9, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7838122844696045
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0028936862945557
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0024409294128418
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0037508010864258
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7344975471496582
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 0.9367060661315918
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7987086772918701
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
Validation loss decreased (-0.978378 --> -0.978378).  Saving model ...
Epoch: 17 cost time: 0.7453556060791016
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7106966972351074
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8311970233917236
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9214818477630615
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8157217502593994
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7542948722839355
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9587156772613525
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8801262378692627
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0768976211547852
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7519354820251465
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29365257
model size : 126.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.092275381088257
Epoch: 1, Steps: 17 | Train Loss: 2.156 Vali Loss: 1.805 Vali Acc: 0.600 Test Loss: 1.805 Test Acc: 0.600
Validation loss decreased (inf --> -0.599982).  Saving model ...
Epoch: 2 cost time: 1.6209375858306885
Epoch: 2, Steps: 17 | Train Loss: 1.550 Vali Loss: 1.075 Vali Acc: 0.859 Test Loss: 1.075 Test Acc: 0.859
Validation loss decreased (-0.599982 --> -0.859449).  Saving model ...
Epoch: 3 cost time: 1.885383129119873
Epoch: 3, Steps: 17 | Train Loss: 0.801 Vali Loss: 0.451 Vali Acc: 0.905 Test Loss: 0.451 Test Acc: 0.905
Validation loss decreased (-0.859449 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 1.7455482482910156
Epoch: 4, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.212 Vali Acc: 0.932 Test Loss: 0.212 Test Acc: 0.932
Validation loss decreased (-0.905401 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 1.494070291519165
Epoch: 5, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.932430 --> -0.964864).  Saving model ...
Epoch: 6 cost time: 1.2948110103607178
Epoch: 6, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.109 Vali Acc: 0.957 Test Loss: 0.109 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6129627227783203
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.957 Test Loss: 0.088 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.667135238647461
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.932 Test Loss: 0.159 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.652245283126831
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5303981304168701
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.964864 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.4907424449920654
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.774568796157837
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7909231185913086
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.962 Test Loss: 0.077 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5086469650268555
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.062645435333252
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 16 cost time: 1.802333116531372
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.989677906036377
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9036304950714111
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6011598110198975
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2776315212249756
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6182808876037598
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.308788537979126
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9733984470367432
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0936901569366455
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0319490432739258
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29536521
model size : 127.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.407090902328491
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 1.953 Vali Acc: 0.605 Test Loss: 1.953 Test Acc: 0.605
Validation loss decreased (inf --> -0.605386).  Saving model ...
Epoch: 2 cost time: 1.0313184261322021
Epoch: 2, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.466 Vali Acc: 0.843 Test Loss: 1.466 Test Acc: 0.843
Validation loss decreased (-0.605386 --> -0.843229).  Saving model ...
Epoch: 3 cost time: 0.9406757354736328
Epoch: 3, Steps: 17 | Train Loss: 1.206 Vali Loss: 0.749 Vali Acc: 0.927 Test Loss: 0.749 Test Acc: 0.927
Validation loss decreased (-0.843229 --> -0.927020).  Saving model ...
Epoch: 4 cost time: 0.8611586093902588
Epoch: 4, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.311 Vali Acc: 0.916 Test Loss: 0.311 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1560568809509277
Epoch: 5, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.927020 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 0.9684524536132812
Epoch: 6, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.940539 --> -0.964864).  Saving model ...
Epoch: 7 cost time: 1.2528281211853027
Epoch: 7, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.104 Vali Acc: 0.957 Test Loss: 0.104 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.123351812362671
Epoch: 8, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.957 Test Loss: 0.101 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8350114822387695
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.962 Test Loss: 0.089 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0478930473327637
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.965 Test Loss: 0.087 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 0.889413595199585
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.959 Test Loss: 0.092 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8852794170379639
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9799249172210693
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 14 cost time: 0.9784595966339111
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 0.9118251800537109
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9456453323364258
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.965 Test Loss: 0.077 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2415313720703125
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.965 Test Loss: 0.082 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9778914451599121
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.970 Test Loss: 0.076 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.164961338043213
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1328442096710205
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.968 Test Loss: 0.082 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0878891944885254
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.968 Test Loss: 0.078 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0704801082611084
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.970 Test Loss: 0.077 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.192664623260498
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.305798053741455
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 29426697
model size : 126.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.2813327312469482
Epoch: 1, Steps: 17 | Train Loss: 2.143 Vali Loss: 2.006 Vali Acc: 0.430 Test Loss: 2.006 Test Acc: 0.430
Validation loss decreased (inf --> -0.429710).  Saving model ...
Epoch: 2 cost time: 0.7623617649078369
Epoch: 2, Steps: 17 | Train Loss: 1.910 Vali Loss: 1.685 Vali Acc: 0.770 Test Loss: 1.685 Test Acc: 0.770
Validation loss decreased (-0.429710 --> -0.770253).  Saving model ...
Epoch: 3 cost time: 0.9098780155181885
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.162 Vali Acc: 0.903 Test Loss: 1.162 Test Acc: 0.903
Validation loss decreased (-0.770253 --> -0.902691).  Saving model ...
Epoch: 4 cost time: 0.8823068141937256
Epoch: 4, Steps: 17 | Train Loss: 0.983 Vali Loss: 0.557 Vali Acc: 0.916 Test Loss: 0.557 Test Acc: 0.916
Validation loss decreased (-0.902691 --> -0.916211).  Saving model ...
Epoch: 5 cost time: 1.1054821014404297
Epoch: 5, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.322 Vali Acc: 0.914 Test Loss: 0.322 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7757182121276855
Epoch: 6, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
Validation loss decreased (-0.916211 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 0.813633918762207
Epoch: 7, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 0.9692668914794922
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 0.9603338241577148
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.951350 --> -0.967567).  Saving model ...
Epoch: 10 cost time: 0.9301378726959229
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9524755477905273
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9643359184265137
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9062225818634033
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9630179405212402
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8484058380126953
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9384784698486328
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8400981426239014
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9049801826477051
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 19 cost time: 1.010399341583252
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8647513389587402
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.954 Test Loss: 0.117 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7222039699554443
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8635663986206055
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.956341028213501
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8082733154296875
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7066941261291504
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6906516551971436
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9846105575561523
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8736841678619385
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 29376009
model size : 126.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5072972774505615
Epoch: 1, Steps: 17 | Train Loss: 2.160 Vali Loss: 1.909 Vali Acc: 0.503 Test Loss: 1.909 Test Acc: 0.503
Validation loss decreased (inf --> -0.502684).  Saving model ...
Epoch: 2 cost time: 0.7803678512573242
Epoch: 2, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.412 Vali Acc: 0.822 Test Loss: 1.412 Test Acc: 0.822
Validation loss decreased (-0.502684 --> -0.821608).  Saving model ...
Epoch: 3 cost time: 1.0632522106170654
Epoch: 3, Steps: 17 | Train Loss: 1.158 Vali Loss: 0.738 Vali Acc: 0.941 Test Loss: 0.738 Test Acc: 0.941
Validation loss decreased (-0.821608 --> -0.940533).  Saving model ...
Epoch: 4 cost time: 1.0139482021331787
Epoch: 4, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8637971878051758
Epoch: 5, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940533 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 0.9553894996643066
Epoch: 6, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
Validation loss decreased (-0.940539 --> -0.956756).  Saving model ...
Epoch: 7 cost time: 0.8227779865264893
Epoch: 7, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 0.9894561767578125
Epoch: 8, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 0.985692024230957
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.954 Test Loss: 0.108 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8551056385040283
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.153308391571045
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 0.8245053291320801
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9047589302062988
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 14 cost time: 1.153320074081421
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7525448799133301
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6910016536712646
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2360551357269287
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.763662576675415
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2422029972076416
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0759732723236084
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0112197399139404
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 22 cost time: 1.221313238143921
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2644391059875488
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9829390048980713
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0113730430603027
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1791136264801025
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7390627861022949
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6631143093109131
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8698525428771973
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8549118041992188
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0692601203918457
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 29454345
model size : 127.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.262697458267212
Epoch: 1, Steps: 17 | Train Loss: 2.245 Vali Loss: 2.066 Vali Acc: 0.370 Test Loss: 2.066 Test Acc: 0.370
Validation loss decreased (inf --> -0.370250).  Saving model ...
Epoch: 2 cost time: 0.7728321552276611
Epoch: 2, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.672 Vali Acc: 0.703 Test Loss: 1.672 Test Acc: 0.703
Validation loss decreased (-0.370250 --> -0.702686).  Saving model ...
Epoch: 3 cost time: 0.9885666370391846
Epoch: 3, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.006 Vali Acc: 0.892 Test Loss: 1.006 Test Acc: 0.892
Validation loss decreased (-0.702686 --> -0.891882).  Saving model ...
Epoch: 4 cost time: 0.8389365673065186
Epoch: 4, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.335 Vali Acc: 0.935 Test Loss: 0.335 Test Acc: 0.935
Validation loss decreased (-0.891882 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 0.8758583068847656
Epoch: 5, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940539).  Saving model ...
Epoch: 6 cost time: 0.8057079315185547
Epoch: 6, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 0.8610846996307373
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.948647 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 0.6758756637573242
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6327493190765381
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 0.7761554718017578
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7889981269836426
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8858428001403809
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.764411211013794
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8537414073944092
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9032204151153564
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8750267028808594
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8634316921234131
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8036289215087891
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7274086475372314
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29420553
model size : 126.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.285148859024048
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.059 Vali Acc: 0.397 Test Loss: 2.059 Test Acc: 0.397
Validation loss decreased (inf --> -0.397277).  Saving model ...
Epoch: 2 cost time: 0.7025930881500244
Epoch: 2, Steps: 17 | Train Loss: 1.963 Vali Loss: 1.788 Vali Acc: 0.692 Test Loss: 1.788 Test Acc: 0.692
Validation loss decreased (-0.397277 --> -0.691874).  Saving model ...
Epoch: 3 cost time: 0.7766239643096924
Epoch: 3, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.283 Vali Acc: 0.886 Test Loss: 1.283 Test Acc: 0.886
Validation loss decreased (-0.691874 --> -0.886474).  Saving model ...
Epoch: 4 cost time: 0.9082591533660889
Epoch: 4, Steps: 17 | Train Loss: 1.077 Vali Loss: 0.622 Vali Acc: 0.919 Test Loss: 0.622 Test Acc: 0.919
Validation loss decreased (-0.886474 --> -0.918913).  Saving model ...
Epoch: 5 cost time: 0.705862283706665
Epoch: 5, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.310 Vali Acc: 0.924 Test Loss: 0.310 Test Acc: 0.924
Validation loss decreased (-0.918913 --> -0.924321).  Saving model ...
Epoch: 6 cost time: 0.9419519901275635
Epoch: 6, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.181 Vali Acc: 0.943 Test Loss: 0.181 Test Acc: 0.943
Validation loss decreased (-0.924321 --> -0.943241).  Saving model ...
Epoch: 7 cost time: 0.8842456340789795
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.943241 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 0.9866483211517334
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 0.9152145385742188
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8217577934265137
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7009835243225098
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6580333709716797
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8468673229217529
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 1.032416820526123
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 0.7818920612335205
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7040948867797852
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7990145683288574
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.809396505355835
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9147439002990723
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8484106063842773
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9299435615539551
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8725829124450684
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8153777122497559
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.771406888961792
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 29386761
model size : 126.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.166898488998413
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 2.026 Vali Acc: 0.376 Test Loss: 2.026 Test Acc: 0.376
Validation loss decreased (inf --> -0.375655).  Saving model ...
Epoch: 2 cost time: 0.7839035987854004
Epoch: 2, Steps: 17 | Train Loss: 1.894 Vali Loss: 1.581 Vali Acc: 0.805 Test Loss: 1.581 Test Acc: 0.805
Validation loss decreased (-0.375655 --> -0.805390).  Saving model ...
Epoch: 3 cost time: 1.0430126190185547
Epoch: 3, Steps: 17 | Train Loss: 1.289 Vali Loss: 0.843 Vali Acc: 0.873 Test Loss: 0.843 Test Acc: 0.873
Validation loss decreased (-0.805390 --> -0.872965).  Saving model ...
Epoch: 4 cost time: 0.9592976570129395
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.337 Vali Acc: 0.916 Test Loss: 0.337 Test Acc: 0.916
Validation loss decreased (-0.872965 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 0.9322576522827148
Epoch: 5, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.916213 --> -0.962161).  Saving model ...
Epoch: 6 cost time: 0.9142880439758301
Epoch: 6, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2599682807922363
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1960020065307617
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8297543525695801
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.269611120223999
Epoch: 10, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0395681858062744
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9214925765991211
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8072240352630615
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.859194278717041
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7975938320159912
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9394621849060059
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0300345420837402
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9152095317840576
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0995731353759766
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 29473545
model size : 127.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4868171215057373
Epoch: 1, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.055 Vali Acc: 0.308 Test Loss: 2.055 Test Acc: 0.308
Validation loss decreased (inf --> -0.308088).  Saving model ...
Epoch: 2 cost time: 0.8860840797424316
Epoch: 2, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.682 Vali Acc: 0.649 Test Loss: 1.682 Test Acc: 0.649
Validation loss decreased (-0.308088 --> -0.648632).  Saving model ...
Epoch: 3 cost time: 0.7457597255706787
Epoch: 3, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.078 Vali Acc: 0.862 Test Loss: 1.078 Test Acc: 0.862
Validation loss decreased (-0.648632 --> -0.862151).  Saving model ...
Epoch: 4 cost time: 0.9151148796081543
Epoch: 4, Steps: 17 | Train Loss: 0.830 Vali Loss: 0.480 Vali Acc: 0.897 Test Loss: 0.480 Test Acc: 0.897
Validation loss decreased (-0.862151 --> -0.897293).  Saving model ...
Epoch: 5 cost time: 0.7323429584503174
Epoch: 5, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.185 Vali Acc: 0.946 Test Loss: 0.185 Test Acc: 0.946
Validation loss decreased (-0.897293 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 0.5788681507110596
Epoch: 6, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.151 Vali Acc: 0.943 Test Loss: 0.151 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7833116054534912
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.945944 --> -0.967567).  Saving model ...
Epoch: 8 cost time: 1.0585172176361084
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0450844764709473
Epoch: 9, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8927547931671143
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.030226707458496
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 1.0158872604370117
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.843123197555542
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.0030336380004883
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 0.7330138683319092
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8020486831665039
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8284566402435303
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6666707992553711
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7865550518035889
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8863601684570312
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8379960060119629
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8162558078765869
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6675488948822021
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.104872226715088
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9519169330596924
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8423154354095459
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9655752182006836
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7367744445800781
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8544723987579346
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8099985122680664
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.055485725402832
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1281843185424805
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 33 cost time: 0.8924033641815186
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9441571235656738
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8485682010650635
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9383831024169922
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0811755657196045
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.68914794921875
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.030540943145752
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0506563186645508
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9870085716247559
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8793394565582275
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 29439753
model size : 126.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3064541816711426
Epoch: 1, Steps: 17 | Train Loss: 2.342 Vali Loss: 2.225 Vali Acc: 0.135 Test Loss: 2.225 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 1.0412967205047607
Epoch: 2, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.840 Vali Acc: 0.735 Test Loss: 1.840 Test Acc: 0.735
Validation loss decreased (-0.135113 --> -0.735117).  Saving model ...
Epoch: 3 cost time: 0.99515700340271
Epoch: 3, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.403 Vali Acc: 0.841 Test Loss: 1.403 Test Acc: 0.841
Validation loss decreased (-0.735117 --> -0.840527).  Saving model ...
Epoch: 4 cost time: 1.196021318435669
Epoch: 4, Steps: 17 | Train Loss: 1.224 Vali Loss: 0.716 Vali Acc: 0.908 Test Loss: 0.716 Test Acc: 0.908
Validation loss decreased (-0.840527 --> -0.908101).  Saving model ...
Epoch: 5 cost time: 0.985236406326294
Epoch: 5, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.328 Vali Acc: 0.938 Test Loss: 0.328 Test Acc: 0.938
Validation loss decreased (-0.908101 --> -0.937835).  Saving model ...
Epoch: 6 cost time: 1.052184820175171
Epoch: 6, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 0.8520143032073975
Epoch: 7, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.951349 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 0.9047236442565918
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 0.8160645961761475
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 0.7805607318878174
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8568549156188965
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.018315315246582
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.941807746887207
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.0473449230194092
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 0.7693135738372803
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 0.8775424957275391
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.685408353805542
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.678013801574707
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 0.8977925777435303
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 0.7286355495452881
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9345965385437012
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9385890960693359
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8312051296234131
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8390312194824219
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7165000438690186
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.62408447265625
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 27 cost time: 0.9126713275909424
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8945910930633545
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7540631294250488
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7890963554382324
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9087271690368652
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7734899520874023
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8295364379882812
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8093798160552979
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8064327239990234
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9317951202392578
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 29405961
model size : 126.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4683573246002197
Epoch: 1, Steps: 17 | Train Loss: 2.163 Vali Loss: 1.909 Vali Acc: 0.381 Test Loss: 1.909 Test Acc: 0.381
Validation loss decreased (inf --> -0.381062).  Saving model ...
Epoch: 2 cost time: 0.9201223850250244
Epoch: 2, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.154 Vali Acc: 0.770 Test Loss: 1.154 Test Acc: 0.770
Validation loss decreased (-0.381062 --> -0.770259).  Saving model ...
Epoch: 3 cost time: 1.2027006149291992
Epoch: 3, Steps: 17 | Train Loss: 0.917 Vali Loss: 0.775 Vali Acc: 0.759 Test Loss: 0.775 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9844322204589844
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
Validation loss decreased (-0.770259 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 0.9083247184753418
Epoch: 5, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7586522102355957
Epoch: 6, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.235 Vali Acc: 0.916 Test Loss: 0.235 Test Acc: 0.916
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0654270648956299
Epoch: 7, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.921619 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 0.8660783767700195
Epoch: 8, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 1.0113089084625244
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.232271671295166
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.199422836303711
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3112363815307617
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9420773983001709
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0786402225494385
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0736260414123535
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.2394275665283203
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.107682228088379
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 0.9736652374267578
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0816144943237305
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0738191604614258
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8918185234069824
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6661934852600098
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8462545871734619
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5933816432952881
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5222799777984619
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5568063259124756
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5899994373321533
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 22410249
model size : 100.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5033297538757324
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.021 Vali Acc: 0.292 Test Loss: 2.021 Test Acc: 0.292
Validation loss decreased (inf --> -0.291872).  Saving model ...
Epoch: 2 cost time: 0.8721280097961426
Epoch: 2, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.566 Vali Acc: 0.765 Test Loss: 1.566 Test Acc: 0.765
Validation loss decreased (-0.291872 --> -0.764849).  Saving model ...
Epoch: 3 cost time: 0.6584262847900391
Epoch: 3, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.083 Vali Acc: 0.789 Test Loss: 1.083 Test Acc: 0.789
Validation loss decreased (-0.764849 --> -0.789178).  Saving model ...
Epoch: 4 cost time: 0.9034383296966553
Epoch: 4, Steps: 17 | Train Loss: 0.801 Vali Loss: 0.470 Vali Acc: 0.927 Test Loss: 0.470 Test Acc: 0.927
Validation loss decreased (-0.789178 --> -0.927022).  Saving model ...
Epoch: 5 cost time: 0.7381138801574707
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 0.7520017623901367
Epoch: 6, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.163 Vali Acc: 0.941 Test Loss: 0.163 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7262601852416992
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.0077810287475586
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 9 cost time: 1.0860316753387451
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.951 Test Loss: 0.114 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0505974292755127
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 0.9428350925445557
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.974581241607666
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0796451568603516
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 0.9329996109008789
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 0.9844565391540527
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 0.8029680252075195
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 0.8367185592651367
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8545815944671631
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7728385925292969
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6899192333221436
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0219523906707764
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7427659034729004
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8667056560516357
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8619680404663086
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8013491630554199
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6356761455535889
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22291977
model size : 99.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4007444381713867
Epoch: 1, Steps: 17 | Train Loss: 2.161 Vali Loss: 1.824 Vali Acc: 0.573 Test Loss: 1.824 Test Acc: 0.573
Validation loss decreased (inf --> -0.572955).  Saving model ...
Epoch: 2 cost time: 1.1107900142669678
Epoch: 2, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.207 Vali Acc: 0.768 Test Loss: 1.207 Test Acc: 0.768
Validation loss decreased (-0.572955 --> -0.767555).  Saving model ...
Epoch: 3 cost time: 1.0349462032318115
Epoch: 3, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.519 Vali Acc: 0.892 Test Loss: 0.519 Test Acc: 0.892
Validation loss decreased (-0.767555 --> -0.891887).  Saving model ...
Epoch: 4 cost time: 1.1111235618591309
Epoch: 4, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
Validation loss decreased (-0.891887 --> -0.929728).  Saving model ...
Epoch: 5 cost time: 0.5993177890777588
Epoch: 5, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.929728 --> -0.967566).  Saving model ...
Epoch: 6 cost time: 0.8587114810943604
Epoch: 6, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8182752132415771
Epoch: 7, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9767863750457764
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9474775791168213
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 0.7747879028320312
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8776075839996338
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7324841022491455
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 0.5723764896392822
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7831757068634033
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 15 cost time: 1.1512947082519531
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7392256259918213
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0674664974212646
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9602956771850586
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9153008460998535
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8424413204193115
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8690600395202637
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.96872878074646
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0802464485168457
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8142261505126953
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 22429449
model size : 100.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.0098557472229004
Epoch: 1, Steps: 17 | Train Loss: 2.219 Vali Loss: 2.045 Vali Acc: 0.341 Test Loss: 2.045 Test Acc: 0.341
Validation loss decreased (inf --> -0.340520).  Saving model ...
Epoch: 2 cost time: 0.6615846157073975
Epoch: 2, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.621 Vali Acc: 0.865 Test Loss: 1.621 Test Acc: 0.865
Validation loss decreased (-0.340520 --> -0.864849).  Saving model ...
Epoch: 3 cost time: 0.6622717380523682
Epoch: 3, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.021 Vali Acc: 0.897 Test Loss: 1.021 Test Acc: 0.897
Validation loss decreased (-0.864849 --> -0.897287).  Saving model ...
Epoch: 4 cost time: 0.7188692092895508
Epoch: 4, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.373 Vali Acc: 0.938 Test Loss: 0.373 Test Acc: 0.938
Validation loss decreased (-0.897287 --> -0.937834).  Saving model ...
Epoch: 5 cost time: 0.8055205345153809
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7651994228363037
Epoch: 6, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.937834 --> -0.978377).  Saving model ...
Epoch: 7 cost time: 0.7862935066223145
Epoch: 7, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1825757026672363
Epoch: 8, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.065098762512207
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.951 Test Loss: 0.122 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.956110954284668
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6277141571044922
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0211198329925537
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0289783477783203
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8919937610626221
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 15 cost time: 1.0266757011413574
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9561436176300049
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1367318630218506
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.978378 --> -0.981080).  Saving model ...
Epoch: 18 cost time: 0.8251798152923584
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6727745532989502
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7570090293884277
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7388577461242676
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7782258987426758
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7556793689727783
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6106934547424316
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7973182201385498
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7193057537078857
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8543779850006104
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 22319625
model size : 99.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.058269739151001
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.049 Vali Acc: 0.376 Test Loss: 2.049 Test Acc: 0.376
Validation loss decreased (inf --> -0.375655).  Saving model ...
Epoch: 2 cost time: 0.7822422981262207
Epoch: 2, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.729 Vali Acc: 0.741 Test Loss: 1.729 Test Acc: 0.741
Validation loss decreased (-0.375655 --> -0.740523).  Saving model ...
Epoch: 3 cost time: 0.7073783874511719
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.238 Vali Acc: 0.803 Test Loss: 1.238 Test Acc: 0.803
Validation loss decreased (-0.740523 --> -0.802690).  Saving model ...
Epoch: 4 cost time: 0.6707828044891357
Epoch: 4, Steps: 17 | Train Loss: 0.947 Vali Loss: 0.529 Vali Acc: 0.919 Test Loss: 0.529 Test Acc: 0.919
Validation loss decreased (-0.802690 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 0.6810908317565918
Epoch: 5, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.918914 --> -0.940538).  Saving model ...
Epoch: 6 cost time: 0.7912609577178955
Epoch: 6, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 0.8043580055236816
Epoch: 7, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 0.7736787796020508
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.956755 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 0.7689967155456543
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.651862621307373
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6088912487030029
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.799065351486206
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 13 cost time: 0.6634049415588379
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7684507369995117
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8168559074401855
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7615833282470703
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7723467350006104
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.630359411239624
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6177833080291748
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6748075485229492
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5952143669128418
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6807849407196045
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 22277385
model size : 99.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5386264324188232
Epoch: 1, Steps: 17 | Train Loss: 2.153 Vali Loss: 1.812 Vali Acc: 0.646 Test Loss: 1.812 Test Acc: 0.646
Validation loss decreased (inf --> -0.645928).  Saving model ...
Epoch: 2 cost time: 0.8288681507110596
Epoch: 2, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.140 Vali Acc: 0.843 Test Loss: 1.140 Test Acc: 0.843
Validation loss decreased (-0.645928 --> -0.843232).  Saving model ...
Epoch: 3 cost time: 0.7999153137207031
Epoch: 3, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
Validation loss decreased (-0.843232 --> -0.878373).  Saving model ...
Epoch: 4 cost time: 1.2623722553253174
Epoch: 4, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.221 Vali Acc: 0.932 Test Loss: 0.221 Test Acc: 0.932
Validation loss decreased (-0.878373 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 0.9279515743255615
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.932430 --> -0.962161).  Saving model ...
Epoch: 6 cost time: 1.403996467590332
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1893432140350342
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 0.9985806941986084
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1679377555847168
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9192066192626953
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8231592178344727
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.907783031463623
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 1.0294411182403564
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 0.616818904876709
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.964864 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.031710147857666
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8495759963989258
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4105501174926758
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0442299842834473
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3010823726654053
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8035249710083008
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9061732292175293
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4013047218322754
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0370194911956787
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8647100925445557
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22448649
model size : 100.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.031836986541748
Epoch: 1, Steps: 17 | Train Loss: 2.216 Vali Loss: 1.951 Vali Acc: 0.524 Test Loss: 1.951 Test Acc: 0.524
Validation loss decreased (inf --> -0.524305).  Saving model ...
Epoch: 2 cost time: 0.8894217014312744
Epoch: 2, Steps: 17 | Train Loss: 1.794 Vali Loss: 1.519 Vali Acc: 0.803 Test Loss: 1.519 Test Acc: 0.803
Validation loss decreased (-0.524305 --> -0.802688).  Saving model ...
Epoch: 3 cost time: 0.6369588375091553
Epoch: 3, Steps: 17 | Train Loss: 1.234 Vali Loss: 0.885 Vali Acc: 0.922 Test Loss: 0.885 Test Acc: 0.922
Validation loss decreased (-0.802688 --> -0.921613).  Saving model ...
Epoch: 4 cost time: 0.9488911628723145
Epoch: 4, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.384 Vali Acc: 0.916 Test Loss: 0.384 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8756158351898193
Epoch: 5, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
Validation loss decreased (-0.921613 --> -0.932431).  Saving model ...
Epoch: 6 cost time: 0.9537837505340576
Epoch: 6, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (-0.932431 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.0859041213989258
Epoch: 7, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 8 cost time: 0.8442964553833008
Epoch: 8, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.949 Test Loss: 0.108 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6559031009674072
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 0.8694286346435547
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 11 cost time: 0.6764748096466064
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 0.9051282405853271
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 0.7882356643676758
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.645458459854126
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 0.8233644962310791
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 1.058039903640747
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9442651271820068
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8828864097595215
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7797451019287109
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6648213863372803
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0258281230926514
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6601705551147461
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9507427215576172
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.073317289352417
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6746933460235596
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22338825
model size : 99.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.1686086654663086
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 1.999 Vali Acc: 0.459 Test Loss: 1.999 Test Acc: 0.459
Validation loss decreased (inf --> -0.459439).  Saving model ...
Epoch: 2 cost time: 0.8622522354125977
Epoch: 2, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.711 Vali Acc: 0.811 Test Loss: 1.711 Test Acc: 0.811
Validation loss decreased (-0.459439 --> -0.810794).  Saving model ...
Epoch: 3 cost time: 0.7462024688720703
Epoch: 3, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.269 Vali Acc: 0.900 Test Loss: 1.269 Test Acc: 0.900
Validation loss decreased (-0.810794 --> -0.899987).  Saving model ...
Epoch: 4 cost time: 0.8575935363769531
Epoch: 4, Steps: 17 | Train Loss: 1.072 Vali Loss: 0.722 Vali Acc: 0.895 Test Loss: 0.722 Test Acc: 0.895
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7036945819854736
Epoch: 5, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.346 Vali Acc: 0.886 Test Loss: 0.346 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6890006065368652
Epoch: 6, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.203 Vali Acc: 0.927 Test Loss: 0.203 Test Acc: 0.927
Validation loss decreased (-0.899987 --> -0.927025).  Saving model ...
Epoch: 7 cost time: 0.8128788471221924
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
Validation loss decreased (-0.927025 --> -0.943242).  Saving model ...
Epoch: 8 cost time: 0.8932552337646484
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.943242 --> -0.954053).  Saving model ...
Epoch: 9 cost time: 0.7939355373382568
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.954053 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 0.7404983043670654
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.792910099029541
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7461686134338379
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6745657920837402
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 0.9037082195281982
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6001055240631104
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7155475616455078
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 0.6460845470428467
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6448054313659668
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6359415054321289
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7860722541809082
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7546765804290771
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8524208068847656
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7007637023925781
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6380412578582764
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7955992221832275
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.834618330001831
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22288137
model size : 99.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.0745632648468018
Epoch: 1, Steps: 17 | Train Loss: 2.143 Vali Loss: 1.905 Vali Acc: 0.497 Test Loss: 1.905 Test Acc: 0.497
Validation loss decreased (inf --> -0.497278).  Saving model ...
Epoch: 2 cost time: 0.8239941596984863
Epoch: 2, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.453 Vali Acc: 0.803 Test Loss: 1.453 Test Acc: 0.803
Validation loss decreased (-0.497278 --> -0.802688).  Saving model ...
Epoch: 3 cost time: 0.6702749729156494
Epoch: 3, Steps: 17 | Train Loss: 1.193 Vali Loss: 0.856 Vali Acc: 0.930 Test Loss: 0.856 Test Acc: 0.930
Validation loss decreased (-0.802688 --> -0.929721).  Saving model ...
Epoch: 4 cost time: 1.100783348083496
Epoch: 4, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0462405681610107
Epoch: 5, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.222 Vali Acc: 0.914 Test Loss: 0.222 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6517176628112793
Epoch: 6, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.929721 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 0.8378946781158447
Epoch: 7, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6589605808258057
Epoch: 8, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7298047542572021
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 10 cost time: 1.0167772769927979
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 0.7413508892059326
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7586417198181152
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0876708030700684
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8478326797485352
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8293018341064453
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8005473613739014
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9362630844116211
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8914539813995361
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.858903169631958
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8190748691558838
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22366473
model size : 99.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.156055212020874
Epoch: 1, Steps: 17 | Train Loss: 2.249 Vali Loss: 2.063 Vali Acc: 0.381 Test Loss: 2.063 Test Acc: 0.381
Validation loss decreased (inf --> -0.381060).  Saving model ...
Epoch: 2 cost time: 0.5962378978729248
Epoch: 2, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.708 Vali Acc: 0.678 Test Loss: 1.708 Test Acc: 0.678
Validation loss decreased (-0.381060 --> -0.678361).  Saving model ...
Epoch: 3 cost time: 0.7906577587127686
Epoch: 3, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.133 Vali Acc: 0.895 Test Loss: 1.133 Test Acc: 0.895
Validation loss decreased (-0.678361 --> -0.894583).  Saving model ...
Epoch: 4 cost time: 0.7665660381317139
Epoch: 4, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.466 Vali Acc: 0.938 Test Loss: 0.466 Test Acc: 0.938
Validation loss decreased (-0.894583 --> -0.937833).  Saving model ...
Epoch: 5 cost time: 0.5875017642974854
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
Validation loss decreased (-0.937833 --> -0.943241).  Saving model ...
Epoch: 6 cost time: 0.6647193431854248
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 7 cost time: 0.6675751209259033
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
Validation loss decreased (-0.948647 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 0.5923027992248535
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 9 cost time: 0.6474099159240723
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 0.6563682556152344
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 0.6062753200531006
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7713639736175537
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6925899982452393
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 0.9350299835205078
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7892045974731445
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9204750061035156
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8927803039550781
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.834991455078125
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 0.8218545913696289
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9853668212890625
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7835237979888916
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 22 cost time: 0.8933355808258057
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8006956577301025
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8213667869567871
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7989962100982666
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8708758354187012
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7256972789764404
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7862520217895508
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6366674900054932
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7528412342071533
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8042643070220947
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 22332681
model size : 99.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3341410160064697
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.062 Vali Acc: 0.351 Test Loss: 2.062 Test Acc: 0.351
Validation loss decreased (inf --> -0.351331).  Saving model ...
Epoch: 2 cost time: 0.7023203372955322
Epoch: 2, Steps: 17 | Train Loss: 1.942 Vali Loss: 1.805 Vali Acc: 0.714 Test Loss: 1.805 Test Acc: 0.714
Validation loss decreased (-0.351331 --> -0.713495).  Saving model ...
Epoch: 3 cost time: 0.7325127124786377
Epoch: 3, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.378 Vali Acc: 0.865 Test Loss: 1.378 Test Acc: 0.865
Validation loss decreased (-0.713495 --> -0.864851).  Saving model ...
Epoch: 4 cost time: 0.5606355667114258
Epoch: 4, Steps: 17 | Train Loss: 1.156 Vali Loss: 0.746 Vali Acc: 0.916 Test Loss: 0.746 Test Acc: 0.916
Validation loss decreased (-0.864851 --> -0.916209).  Saving model ...
Epoch: 5 cost time: 0.601914644241333
Epoch: 5, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.340 Vali Acc: 0.932 Test Loss: 0.340 Test Acc: 0.932
Validation loss decreased (-0.916209 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 0.559150218963623
Epoch: 6, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 0.6989912986755371
Epoch: 7, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 0.6796896457672119
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 0.6809639930725098
Epoch: 9, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 0.6942799091339111
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6520900726318359
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 0.7599444389343262
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6911132335662842
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 0.7132701873779297
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7529866695404053
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5403285026550293
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5443933010101318
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5544958114624023
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6767411231994629
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7728397846221924
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7080633640289307
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.649388313293457
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.663456916809082
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22298889
model size : 99.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.2063064575195312
Epoch: 1, Steps: 17 | Train Loss: 2.255 Vali Loss: 2.023 Vali Acc: 0.430 Test Loss: 2.023 Test Acc: 0.430
Validation loss decreased (inf --> -0.429709).  Saving model ...
Epoch: 2 cost time: 0.9697175025939941
Epoch: 2, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.625 Vali Acc: 0.773 Test Loss: 1.625 Test Acc: 0.773
Validation loss decreased (-0.429709 --> -0.772957).  Saving model ...
Epoch: 3 cost time: 1.0234181880950928
Epoch: 3, Steps: 17 | Train Loss: 1.296 Vali Loss: 0.984 Vali Acc: 0.865 Test Loss: 0.984 Test Acc: 0.865
Validation loss decreased (-0.772957 --> -0.864855).  Saving model ...
Epoch: 4 cost time: 0.7377493381500244
Epoch: 4, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.405 Vali Acc: 0.916 Test Loss: 0.405 Test Acc: 0.916
Validation loss decreased (-0.864855 --> -0.916212).  Saving model ...
Epoch: 5 cost time: 0.8710510730743408
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.180 Vali Acc: 0.938 Test Loss: 0.180 Test Acc: 0.938
Validation loss decreased (-0.916212 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 0.8318819999694824
Epoch: 6, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
Validation loss decreased (-0.937836 --> -0.954053).  Saving model ...
Epoch: 7 cost time: 0.9173934459686279
Epoch: 7, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956756).  Saving model ...
Epoch: 8 cost time: 1.0413548946380615
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 0.8463356494903564
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967567).  Saving model ...
Epoch: 10 cost time: 0.8947405815124512
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8476161956787109
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7467048168182373
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8044989109039307
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8683509826660156
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 0.7537057399749756
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7240173816680908
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5139379501342773
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5703885555267334
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5786516666412354
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 0.8586795330047607
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.873136043548584
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9966142177581787
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7708933353424072
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8842394351959229
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7883985042572021
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8871500492095947
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8221185207366943
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9658019542694092
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8540217876434326
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 22385673
model size : 100.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.2794013023376465
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.076 Vali Acc: 0.281 Test Loss: 2.076 Test Acc: 0.281
Validation loss decreased (inf --> -0.281060).  Saving model ...
Epoch: 2 cost time: 0.7313287258148193
Epoch: 2, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.733 Vali Acc: 0.619 Test Loss: 1.733 Test Acc: 0.619
Validation loss decreased (-0.281060 --> -0.618902).  Saving model ...
Epoch: 3 cost time: 0.7315456867218018
Epoch: 3, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.244 Vali Acc: 0.819 Test Loss: 1.244 Test Acc: 0.819
Validation loss decreased (-0.618902 --> -0.818906).  Saving model ...
Epoch: 4 cost time: 0.7784063816070557
Epoch: 4, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.621 Vali Acc: 0.892 Test Loss: 0.621 Test Acc: 0.892
Validation loss decreased (-0.818906 --> -0.891886).  Saving model ...
Epoch: 5 cost time: 0.799616813659668
Epoch: 5, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.243 Vali Acc: 0.935 Test Loss: 0.243 Test Acc: 0.935
Validation loss decreased (-0.891886 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 0.8994007110595703
Epoch: 6, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 7 cost time: 0.902512788772583
Epoch: 7, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.940539 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 0.6408958435058594
Epoch: 8, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 0.6042647361755371
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5668501853942871
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 0.7231059074401855
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 0.7400462627410889
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7674829959869385
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7467865943908691
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 0.8379998207092285
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6434767246246338
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 0.7796361446380615
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9141619205474854
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9818089008331299
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7368736267089844
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8001439571380615
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9677937030792236
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8762373924255371
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.582772970199585
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7307171821594238
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8074800968170166
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 22351881
model size : 99.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.322794198989868
Epoch: 1, Steps: 17 | Train Loss: 2.331 Vali Loss: 2.236 Vali Acc: 0.130 Test Loss: 2.236 Test Acc: 0.130
Validation loss decreased (inf --> -0.129707).  Saving model ...
Epoch: 2 cost time: 0.8681340217590332
Epoch: 2, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.868 Vali Acc: 0.659 Test Loss: 1.868 Test Acc: 0.659
Validation loss decreased (-0.129707 --> -0.659441).  Saving model ...
Epoch: 3 cost time: 0.8518657684326172
Epoch: 3, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.487 Vali Acc: 0.800 Test Loss: 1.487 Test Acc: 0.800
Validation loss decreased (-0.659441 --> -0.799985).  Saving model ...
Epoch: 4 cost time: 0.9984712600708008
Epoch: 4, Steps: 17 | Train Loss: 1.268 Vali Loss: 0.860 Vali Acc: 0.905 Test Loss: 0.860 Test Acc: 0.905
Validation loss decreased (-0.799985 --> -0.905397).  Saving model ...
Epoch: 5 cost time: 0.840688943862915
Epoch: 5, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
Validation loss decreased (-0.905397 --> -0.929726).  Saving model ...
Epoch: 6 cost time: 0.799720287322998
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.201 Vali Acc: 0.938 Test Loss: 0.201 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937836).  Saving model ...
Epoch: 7 cost time: 0.7671270370483398
Epoch: 7, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.937836 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 0.8332967758178711
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 0.7977919578552246
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 0.9240217208862305
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8388702869415283
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8841736316680908
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9464097023010254
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6887576580047607
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8229148387908936
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 0.8358972072601318
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 0.8352797031402588
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7252655029296875
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8384089469909668
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 20 cost time: 0.7220888137817383
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 21 cost time: 0.8173830509185791
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7984821796417236
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6463186740875244
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 24 cost time: 0.7054038047790527
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7319400310516357
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8136658668518066
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8847997188568115
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6635289192199707
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7984085083007812
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6899383068084717
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9505581855773926
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8614075183868408
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7854359149932861
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_GPT4TS_UEA_ftM_sl29_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 22318089
model size : 99.80MB
