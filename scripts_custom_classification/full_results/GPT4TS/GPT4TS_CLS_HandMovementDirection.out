Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2754814624786377
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.439 Vali Acc: 0.216 Test Loss: 1.439 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.9096083641052246
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.315 Vali Acc: 0.392 Test Loss: 1.315 Test Acc: 0.392
Validation loss decreased (-0.216202 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.5639030933380127
Epoch: 3, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.443 Vali Acc: 0.392 Test Loss: 1.443 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.62945556640625
Epoch: 4, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.396 Vali Acc: 0.378 Test Loss: 1.396 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4261994361877441
Epoch: 5, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.1142895221710205
Epoch: 6, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.262 Vali Acc: 0.581 Test Loss: 1.262 Test Acc: 0.581
Validation loss decreased (-0.472961 --> -0.581068).  Saving model ...
Epoch: 7 cost time: 1.1270313262939453
Epoch: 7, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4130897521972656
Epoch: 8, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.622 Vali Acc: 0.554 Test Loss: 1.622 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4972009658813477
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.066 Vali Acc: 0.486 Test Loss: 3.066 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3370344638824463
Epoch: 10, Steps: 10 | Train Loss: 0.098 Vali Loss: 2.052 Vali Acc: 0.568 Test Loss: 2.052 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1898086071014404
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.388 Vali Acc: 0.527 Test Loss: 2.388 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.532419204711914
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.411 Vali Acc: 0.378 Test Loss: 4.411 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2588276863098145
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.511 Vali Acc: 0.554 Test Loss: 2.511 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.478872537612915
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.750 Vali Acc: 0.554 Test Loss: 2.750 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.451124906539917
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.624 Vali Acc: 0.541 Test Loss: 2.624 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8340048789978027
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.968 Vali Acc: 0.486 Test Loss: 2.968 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 44193796
model size : 183.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6881470680236816
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.381 Vali Acc: 0.392 Test Loss: 1.381 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.2652349472045898
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.424 Vali Acc: 0.297 Test Loss: 1.424 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9778571128845215
Epoch: 3, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.293 Vali Acc: 0.446 Test Loss: 1.293 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.733896017074585
Epoch: 4, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4542312622070312
Epoch: 5, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.307 Vali Acc: 0.459 Test Loss: 1.307 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459446).  Saving model ...
Epoch: 6 cost time: 1.3870878219604492
Epoch: 6, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.7215611934661865
Epoch: 7, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.219 Vali Acc: 0.446 Test Loss: 1.219 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2719135284423828
Epoch: 8, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.339 Vali Acc: 0.486 Test Loss: 1.339 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.19435715675354
Epoch: 9, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.484 Vali Acc: 0.514 Test Loss: 1.484 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513499).  Saving model ...
Epoch: 10 cost time: 0.9837324619293213
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.701 Vali Acc: 0.500 Test Loss: 1.701 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.985313892364502
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.869 Vali Acc: 0.473 Test Loss: 1.869 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.672255516052246
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.937 Vali Acc: 0.459 Test Loss: 1.937 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4058966636657715
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.822 Vali Acc: 0.568 Test Loss: 1.822 Test Acc: 0.568
Validation loss decreased (-0.513499 --> -0.567549).  Saving model ...
Epoch: 14 cost time: 1.7593979835510254
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.144 Vali Acc: 0.527 Test Loss: 2.144 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4309773445129395
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.141 Vali Acc: 0.500 Test Loss: 2.141 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.195141077041626
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.021 Vali Acc: 0.514 Test Loss: 2.021 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9678490161895752
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.081 Vali Acc: 0.527 Test Loss: 2.081 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0707728862762451
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.041 Vali Acc: 0.514 Test Loss: 2.041 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5116126537322998
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.894 Vali Acc: 0.554 Test Loss: 1.894 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4519100189208984
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.915 Vali Acc: 0.554 Test Loss: 1.915 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.385890007019043
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.947 Vali Acc: 0.568 Test Loss: 1.947 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.432417631149292
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.961 Vali Acc: 0.581 Test Loss: 1.961 Test Acc: 0.581
Validation loss decreased (-0.567549 --> -0.581061).  Saving model ...
Epoch: 23 cost time: 1.4963312149047852
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.581 Test Loss: 1.951 Test Acc: 0.581
Validation loss decreased (-0.581061 --> -0.581062).  Saving model ...
Epoch: 24 cost time: 1.4098014831542969
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.921 Vali Acc: 0.581 Test Loss: 1.921 Test Acc: 0.581
Validation loss decreased (-0.581062 --> -0.581062).  Saving model ...
Epoch: 25 cost time: 1.2737488746643066
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.568 Test Loss: 1.910 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5691022872924805
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.568 Test Loss: 1.919 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8663716316223145
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.581 Test Loss: 1.931 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8718361854553223
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.581 Test Loss: 1.931 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4526221752166748
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.581 Test Loss: 1.930 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4903812408447266
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.568 Test Loss: 1.934 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3606457710266113
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.568 Test Loss: 1.952 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1341819763183594
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.568 Test Loss: 1.962 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.33203125
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.568 Test Loss: 1.969 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3649113178253174
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.568 Test Loss: 1.952 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 43972612
model size : 182.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7563090324401855
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.390 Vali Acc: 0.284 Test Loss: 1.390 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9072144031524658
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.371 Vali Acc: 0.257 Test Loss: 1.371 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1555874347686768
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.328 Vali Acc: 0.297 Test Loss: 1.328 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.0721876621246338
Epoch: 4, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.259 Vali Acc: 0.419 Test Loss: 1.259 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.0514190196990967
Epoch: 5, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.225 Vali Acc: 0.446 Test Loss: 1.225 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.8267743587493896
Epoch: 6, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.085529088973999
Epoch: 7, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.179 Vali Acc: 0.432 Test Loss: 1.179 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0282623767852783
Epoch: 8, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.176 Vali Acc: 0.459 Test Loss: 1.176 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.037797451019287
Epoch: 9, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.236 Vali Acc: 0.419 Test Loss: 1.236 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4814958572387695
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.289 Vali Acc: 0.459 Test Loss: 1.289 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9917135238647461
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.197065830230713
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.334 Vali Acc: 0.459 Test Loss: 1.334 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2895102500915527
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.416 Vali Acc: 0.527 Test Loss: 1.416 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527013).  Saving model ...
Epoch: 14 cost time: 0.9680805206298828
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.355 Vali Acc: 0.473 Test Loss: 1.355 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.957556962966919
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.389 Vali Acc: 0.486 Test Loss: 1.389 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9842159748077393
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.466 Vali Acc: 0.473 Test Loss: 1.466 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8992364406585693
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.453 Vali Acc: 0.486 Test Loss: 1.453 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2422595024108887
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.475 Vali Acc: 0.486 Test Loss: 1.475 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0292930603027344
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.450 Vali Acc: 0.486 Test Loss: 1.450 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9370517730712891
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3470571041107178
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.458 Vali Acc: 0.514 Test Loss: 1.458 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9591238498687744
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.444 Vali Acc: 0.486 Test Loss: 1.444 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9384088516235352
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.460 Vali Acc: 0.514 Test Loss: 1.460 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 43862020
model size : 182.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5212135314941406
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.393 Vali Acc: 0.392 Test Loss: 1.393 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 1.383363962173462
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.501 Vali Acc: 0.284 Test Loss: 1.501 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5950191020965576
Epoch: 3, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.467 Vali Acc: 0.459 Test Loss: 1.467 Test Acc: 0.459
Validation loss decreased (-0.391878 --> -0.459445).  Saving model ...
Epoch: 4 cost time: 1.4783055782318115
Epoch: 4, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.653 Vali Acc: 0.216 Test Loss: 1.653 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2621817588806152
Epoch: 5, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
Validation loss decreased (-0.459445 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.9819071292877197
Epoch: 6, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.473 Vali Acc: 0.473 Test Loss: 1.473 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3605091571807861
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.440 Vali Acc: 0.514 Test Loss: 1.440 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513499).  Saving model ...
Epoch: 8 cost time: 1.5022306442260742
Epoch: 8, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.685 Vali Acc: 0.459 Test Loss: 1.685 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5787153244018555
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.779 Vali Acc: 0.527 Test Loss: 1.779 Test Acc: 0.527
Validation loss decreased (-0.513499 --> -0.527009).  Saving model ...
Epoch: 10 cost time: 1.8711979389190674
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.200 Vali Acc: 0.527 Test Loss: 2.200 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3954312801361084
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.014 Vali Acc: 0.446 Test Loss: 2.014 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2586750984191895
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.201 Vali Acc: 0.486 Test Loss: 2.201 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8268001079559326
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.162 Vali Acc: 0.500 Test Loss: 2.162 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5995643138885498
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.224 Vali Acc: 0.514 Test Loss: 2.224 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6427407264709473
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.327 Vali Acc: 0.459 Test Loss: 2.327 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4793152809143066
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.311 Vali Acc: 0.514 Test Loss: 2.311 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8978919982910156
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.284 Vali Acc: 0.541 Test Loss: 2.284 Test Acc: 0.541
Validation loss decreased (-0.527009 --> -0.540518).  Saving model ...
Epoch: 18 cost time: 1.6816751956939697
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.241 Vali Acc: 0.554 Test Loss: 2.241 Test Acc: 0.554
Validation loss decreased (-0.540518 --> -0.554032).  Saving model ...
Epoch: 19 cost time: 1.2692835330963135
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.568 Test Loss: 2.233 Test Acc: 0.568
Validation loss decreased (-0.554032 --> -0.567545).  Saving model ...
Epoch: 20 cost time: 1.4275648593902588
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.187 Vali Acc: 0.554 Test Loss: 2.187 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5600411891937256
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.527 Test Loss: 2.172 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5300273895263672
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.134 Vali Acc: 0.554 Test Loss: 2.134 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0163161754608154
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.541 Test Loss: 2.129 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1293387413024902
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.143 Vali Acc: 0.514 Test Loss: 2.143 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7152361869812012
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.500 Test Loss: 2.146 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2234766483306885
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.500 Test Loss: 2.136 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7193338871002197
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.128 Vali Acc: 0.514 Test Loss: 2.128 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2138471603393555
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.527 Test Loss: 2.132 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4801323413848877
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.117 Vali Acc: 0.541 Test Loss: 2.117 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44124676
model size : 183.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7873525619506836
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.442 Vali Acc: 0.176 Test Loss: 1.442 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.2800896167755127
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (-0.175661 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.2447307109832764
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.328 Vali Acc: 0.324 Test Loss: 1.328 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.5037469863891602
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.279 Vali Acc: 0.473 Test Loss: 1.279 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.5340855121612549
Epoch: 5, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.206 Vali Acc: 0.378 Test Loss: 1.206 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7028236389160156
Epoch: 6, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.855987548828125
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.196 Vali Acc: 0.419 Test Loss: 1.196 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5005836486816406
Epoch: 8, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.434 Vali Acc: 0.486 Test Loss: 1.434 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.624650001525879
Epoch: 9, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.290 Vali Acc: 0.554 Test Loss: 1.290 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 1.454003095626831
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.328 Vali Acc: 0.581 Test Loss: 1.328 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581068).  Saving model ...
Epoch: 11 cost time: 1.5395927429199219
Epoch: 11, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.437 Vali Acc: 0.581 Test Loss: 1.437 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4735157489776611
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.560 Vali Acc: 0.554 Test Loss: 1.560 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.66672945022583
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.611 Vali Acc: 0.554 Test Loss: 1.611 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5122888088226318
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.666 Vali Acc: 0.541 Test Loss: 1.666 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3547050952911377
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.861 Vali Acc: 0.568 Test Loss: 1.861 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2293493747711182
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.640 Vali Acc: 0.541 Test Loss: 1.640 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0170905590057373
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.757 Vali Acc: 0.581 Test Loss: 1.757 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2484080791473389
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.767 Vali Acc: 0.459 Test Loss: 1.767 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3921763896942139
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.884 Vali Acc: 0.446 Test Loss: 1.884 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.522547960281372
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.781 Vali Acc: 0.554 Test Loss: 1.781 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 43968004
model size : 182.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8376708030700684
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.403 Vali Acc: 0.230 Test Loss: 1.403 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.6138882637023926
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.374 Vali Acc: 0.419 Test Loss: 1.374 Test Acc: 0.419
Validation loss decreased (-0.229716 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.1997458934783936
Epoch: 3, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.412 Vali Acc: 0.311 Test Loss: 1.412 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3708171844482422
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.280 Vali Acc: 0.432 Test Loss: 1.280 Test Acc: 0.432
Validation loss decreased (-0.418905 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.0090820789337158
Epoch: 5, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.285 Vali Acc: 0.405 Test Loss: 1.285 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2902536392211914
Epoch: 6, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.049220085144043
Epoch: 7, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9567828178405762
Epoch: 8, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.212 Vali Acc: 0.419 Test Loss: 1.212 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1296873092651367
Epoch: 9, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.328 Vali Acc: 0.554 Test Loss: 1.328 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554041).  Saving model ...
Epoch: 10 cost time: 0.7971909046173096
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.420 Vali Acc: 0.432 Test Loss: 1.420 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0195846557617188
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.472 Vali Acc: 0.432 Test Loss: 1.472 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9288835525512695
Epoch: 12, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.373 Vali Acc: 0.473 Test Loss: 1.373 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8459117412567139
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.373 Vali Acc: 0.514 Test Loss: 1.373 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0637478828430176
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.350 Vali Acc: 0.527 Test Loss: 1.350 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5957539081573486
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8548822402954102
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.483 Vali Acc: 0.541 Test Loss: 1.483 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8975117206573486
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.477 Vali Acc: 0.514 Test Loss: 1.477 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9115118980407715
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9420437812805176
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.481 Vali Acc: 0.486 Test Loss: 1.481 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 43875844
model size : 182.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0275254249572754
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.454 Vali Acc: 0.230 Test Loss: 1.454 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.5106182098388672
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.417 Vali Acc: 0.297 Test Loss: 1.417 Test Acc: 0.297
Validation loss decreased (-0.229715 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 1.45574951171875
Epoch: 3, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.299 Vali Acc: 0.432 Test Loss: 1.299 Test Acc: 0.432
Validation loss decreased (-0.297283 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.23280668258667
Epoch: 4, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.228 Vali Acc: 0.419 Test Loss: 1.228 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0150771141052246
Epoch: 5, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.324 Vali Acc: 0.486 Test Loss: 1.324 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486473).  Saving model ...
Epoch: 6 cost time: 1.5687274932861328
Epoch: 6, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.423 Vali Acc: 0.486 Test Loss: 1.423 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1836490631103516
Epoch: 7, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.809 Vali Acc: 0.486 Test Loss: 1.809 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.488633632659912
Epoch: 8, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.636 Vali Acc: 0.473 Test Loss: 1.636 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4236934185028076
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.883 Vali Acc: 0.432 Test Loss: 1.883 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1270086765289307
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 2.703 Vali Acc: 0.446 Test Loss: 2.703 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.391219139099121
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.943 Vali Acc: 0.446 Test Loss: 1.943 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3975894451141357
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.479 Vali Acc: 0.432 Test Loss: 2.479 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3016047477722168
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.812 Vali Acc: 0.446 Test Loss: 2.812 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2218594551086426
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.428 Vali Acc: 0.486 Test Loss: 2.428 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6832067966461182
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.535 Vali Acc: 0.500 Test Loss: 2.535 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499975).  Saving model ...
Epoch: 16 cost time: 1.5330054759979248
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.653 Vali Acc: 0.554 Test Loss: 2.653 Test Acc: 0.554
Validation loss decreased (-0.499975 --> -0.554028).  Saving model ...
Epoch: 17 cost time: 1.4412963390350342
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.693 Vali Acc: 0.527 Test Loss: 2.693 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4271583557128906
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.889 Vali Acc: 0.568 Test Loss: 2.889 Test Acc: 0.568
Validation loss decreased (-0.554028 --> -0.567539).  Saving model ...
Epoch: 19 cost time: 1.641096830368042
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.314 Vali Acc: 0.554 Test Loss: 2.314 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4078598022460938
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.012 Vali Acc: 0.500 Test Loss: 3.012 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.645472764968872
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.100 Vali Acc: 0.473 Test Loss: 3.100 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2136247158050537
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.849 Vali Acc: 0.500 Test Loss: 2.849 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.223069190979004
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.881 Vali Acc: 0.500 Test Loss: 2.881 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.355694055557251
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.880 Vali Acc: 0.500 Test Loss: 2.880 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7339451313018799
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.879 Vali Acc: 0.500 Test Loss: 2.879 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5343306064605713
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.880 Vali Acc: 0.514 Test Loss: 2.880 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7156267166137695
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.848 Vali Acc: 0.514 Test Loss: 2.848 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7532587051391602
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.514 Test Loss: 2.828 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44147716
model size : 183.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.116276264190674
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.219691276550293
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.337 Vali Acc: 0.324 Test Loss: 1.337 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3671057224273682
Epoch: 3, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.279 Vali Acc: 0.378 Test Loss: 1.279 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 1.2543013095855713
Epoch: 4, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.223 Vali Acc: 0.446 Test Loss: 1.223 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.28304123878479
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.2827370166778564
Epoch: 6, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.2985751628875732
Epoch: 7, Steps: 10 | Train Loss: 0.483 Vali Loss: 1.468 Vali Acc: 0.500 Test Loss: 1.468 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2933378219604492
Epoch: 8, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.434 Vali Acc: 0.554 Test Loss: 1.434 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554040).  Saving model ...
Epoch: 9 cost time: 1.2179243564605713
Epoch: 9, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1091945171356201
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.269 Vali Acc: 0.554 Test Loss: 1.269 Test Acc: 0.554
Validation loss decreased (-0.554040 --> -0.554041).  Saving model ...
Epoch: 11 cost time: 1.2015268802642822
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.379 Vali Acc: 0.541 Test Loss: 1.379 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1620404720306396
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.653 Vali Acc: 0.554 Test Loss: 1.653 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.221947431564331
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.352 Vali Acc: 0.595 Test Loss: 1.352 Test Acc: 0.595
Validation loss decreased (-0.554041 --> -0.594581).  Saving model ...
Epoch: 14 cost time: 0.6614835262298584
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.401 Vali Acc: 0.608 Test Loss: 1.401 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608094).  Saving model ...
Epoch: 15 cost time: 1.294933557510376
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.431 Vali Acc: 0.608 Test Loss: 1.431 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0558626651763916
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.462 Vali Acc: 0.622 Test Loss: 1.462 Test Acc: 0.622
Validation loss decreased (-0.608094 --> -0.621607).  Saving model ...
Epoch: 17 cost time: 1.7441773414611816
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.608 Test Loss: 1.567 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3401014804840088
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.420 Vali Acc: 0.595 Test Loss: 1.420 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.178985834121704
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.470 Vali Acc: 0.608 Test Loss: 1.470 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8703138828277588
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.581 Test Loss: 1.566 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3229331970214844
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.595 Test Loss: 1.508 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0814380645751953
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.608 Test Loss: 1.467 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0867400169372559
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.595 Test Loss: 1.464 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1145904064178467
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.595 Test Loss: 1.477 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.129025936126709
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.595 Test Loss: 1.482 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9703934192657471
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.608 Test Loss: 1.476 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 43991044
model size : 182.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0789239406585693
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.389 Vali Acc: 0.338 Test Loss: 1.389 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.1694045066833496
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.434 Vali Acc: 0.297 Test Loss: 1.434 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9176886081695557
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.299 Vali Acc: 0.486 Test Loss: 1.299 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.7878365516662598
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.355 Vali Acc: 0.297 Test Loss: 1.355 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0570154190063477
Epoch: 5, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.7842411994934082
Epoch: 6, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8780021667480469
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.6922757625579834
Epoch: 8, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8493630886077881
Epoch: 9, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7291240692138672
Epoch: 10, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.220 Vali Acc: 0.554 Test Loss: 1.220 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 0.8360843658447266
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8411633968353271
Epoch: 12, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.255 Vali Acc: 0.459 Test Loss: 1.255 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0803258419036865
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.326 Vali Acc: 0.527 Test Loss: 1.326 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9792599678039551
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.260 Vali Acc: 0.527 Test Loss: 1.260 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8932409286499023
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.234 Vali Acc: 0.568 Test Loss: 1.234 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 16 cost time: 0.6829614639282227
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.220 Vali Acc: 0.527 Test Loss: 1.220 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2000548839569092
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.239 Vali Acc: 0.527 Test Loss: 1.239 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0077135562896729
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.204 Vali Acc: 0.581 Test Loss: 1.204 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581069).  Saving model ...
Epoch: 19 cost time: 1.2006230354309082
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.259 Vali Acc: 0.595 Test Loss: 1.259 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 20 cost time: 0.9282917976379395
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.218 Vali Acc: 0.595 Test Loss: 1.218 Test Acc: 0.595
Validation loss decreased (-0.594582 --> -0.594582).  Saving model ...
Epoch: 21 cost time: 0.9456844329833984
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.242 Vali Acc: 0.608 Test Loss: 1.242 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608096).  Saving model ...
Epoch: 22 cost time: 0.9884629249572754
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.224 Vali Acc: 0.622 Test Loss: 1.224 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621609).  Saving model ...
Epoch: 23 cost time: 0.655444860458374
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.231 Vali Acc: 0.622 Test Loss: 1.231 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6786859035491943
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.255 Vali Acc: 0.622 Test Loss: 1.255 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8421344757080078
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.242 Vali Acc: 0.608 Test Loss: 1.242 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8169651031494141
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.252 Vali Acc: 0.608 Test Loss: 1.252 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7233307361602783
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.595 Test Loss: 1.263 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6135914325714111
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.622 Test Loss: 1.273 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1467382907867432
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.622 Test Loss: 1.296 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7151370048522949
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.608 Test Loss: 1.294 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7617442607879639
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.622 Test Loss: 1.282 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6970508098602295
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.595 Test Loss: 1.289 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 43894276
model size : 182.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.503546714782715
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.440 Vali Acc: 0.189 Test Loss: 1.440 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.6743886470794678
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.544 Vali Acc: 0.230 Test Loss: 1.544 Test Acc: 0.230
Validation loss decreased (-0.189175 --> -0.229714).  Saving model ...
Epoch: 3 cost time: 1.338402271270752
Epoch: 3, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.508 Vali Acc: 0.270 Test Loss: 1.508 Test Acc: 0.270
Validation loss decreased (-0.229714 --> -0.270255).  Saving model ...
Epoch: 4 cost time: 1.5784428119659424
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.198 Vali Acc: 0.432 Test Loss: 1.198 Test Acc: 0.432
Validation loss decreased (-0.270255 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.1114158630371094
Epoch: 5, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.6366572380065918
Epoch: 6, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.646909475326538
Epoch: 7, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.650 Vali Acc: 0.459 Test Loss: 1.650 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7563812732696533
Epoch: 8, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.497 Vali Acc: 0.527 Test Loss: 1.497 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3963351249694824
Epoch: 9, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.929 Vali Acc: 0.486 Test Loss: 1.929 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8217880725860596
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.174 Vali Acc: 0.473 Test Loss: 2.174 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3309621810913086
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.791 Vali Acc: 0.473 Test Loss: 2.791 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5825605392456055
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.820 Vali Acc: 0.541 Test Loss: 1.820 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3010377883911133
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.610 Vali Acc: 0.581 Test Loss: 2.610 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581055).  Saving model ...
Epoch: 14 cost time: 1.372978687286377
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.393 Vali Acc: 0.541 Test Loss: 2.393 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.43941068649292
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.567 Vali Acc: 0.500 Test Loss: 2.567 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4832029342651367
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.913 Vali Acc: 0.527 Test Loss: 2.913 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.613405704498291
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.180 Vali Acc: 0.527 Test Loss: 3.180 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4609558582305908
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 2.578 Vali Acc: 0.486 Test Loss: 2.578 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5256133079528809
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.238 Vali Acc: 0.459 Test Loss: 3.238 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.487518072128296
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.517 Vali Acc: 0.486 Test Loss: 2.517 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6346633434295654
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.772 Vali Acc: 0.486 Test Loss: 3.772 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4057161808013916
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.786 Vali Acc: 0.541 Test Loss: 2.786 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6625921726226807
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.590 Vali Acc: 0.554 Test Loss: 2.590 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 44170756
model size : 183.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5869617462158203
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.408 Vali Acc: 0.203 Test Loss: 1.408 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.9764246940612793
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.365 Vali Acc: 0.270 Test Loss: 1.365 Test Acc: 0.270
Validation loss decreased (-0.202689 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 1.2216267585754395
Epoch: 3, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.308 Vali Acc: 0.432 Test Loss: 1.308 Test Acc: 0.432
Validation loss decreased (-0.270257 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.0544416904449463
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.354 Vali Acc: 0.351 Test Loss: 1.354 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9486136436462402
Epoch: 5, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.196 Vali Acc: 0.541 Test Loss: 1.196 Test Acc: 0.541
Validation loss decreased (-0.432419 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9993469715118408
Epoch: 6, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8514719009399414
Epoch: 7, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.581 Vali Acc: 0.473 Test Loss: 1.581 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9383437633514404
Epoch: 8, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.273 Vali Acc: 0.568 Test Loss: 1.273 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567555).  Saving model ...
Epoch: 9 cost time: 0.9006369113922119
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.185 Vali Acc: 0.595 Test Loss: 1.185 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 0.9161241054534912
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.389 Vali Acc: 0.568 Test Loss: 1.389 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.356642484664917
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.705 Vali Acc: 0.541 Test Loss: 1.705 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8855035305023193
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.284 Vali Acc: 0.541 Test Loss: 1.284 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1374433040618896
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.447 Vali Acc: 0.527 Test Loss: 1.447 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.007079839706421
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.457 Vali Acc: 0.500 Test Loss: 1.457 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8277058601379395
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.423 Vali Acc: 0.541 Test Loss: 1.423 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1391713619232178
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.563 Vali Acc: 0.527 Test Loss: 1.563 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1972694396972656
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.436 Vali Acc: 0.554 Test Loss: 1.436 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8910911083221436
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.572 Vali Acc: 0.541 Test Loss: 1.572 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0783085823059082
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.541 Test Loss: 1.592 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 43995652
model size : 182.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.33305025100708
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.9874842166900635
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.326 Vali Acc: 0.351 Test Loss: 1.326 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.9330353736877441
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.304 Vali Acc: 0.378 Test Loss: 1.304 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.8201334476470947
Epoch: 4, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.272 Vali Acc: 0.392 Test Loss: 1.272 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.0021207332611084
Epoch: 5, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8124802112579346
Epoch: 6, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.7189106941223145
Epoch: 7, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.049 Vali Acc: 0.527 Test Loss: 1.049 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527017).  Saving model ...
Epoch: 8 cost time: 0.6680271625518799
Epoch: 8, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
Validation loss decreased (-0.527017 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 0.6866457462310791
Epoch: 9, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0850746631622314
Epoch: 10, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.202 Vali Acc: 0.527 Test Loss: 1.202 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2868623733520508
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.234 Vali Acc: 0.541 Test Loss: 1.234 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7448253631591797
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6447172164916992
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.476 Vali Acc: 0.595 Test Loss: 1.476 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594580).  Saving model ...
Epoch: 14 cost time: 0.6011645793914795
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.187 Vali Acc: 0.581 Test Loss: 1.187 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5725395679473877
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.461 Vali Acc: 0.581 Test Loss: 1.461 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6278965473175049
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.274 Vali Acc: 0.622 Test Loss: 1.274 Test Acc: 0.622
Validation loss decreased (-0.594580 --> -0.621609).  Saving model ...
Epoch: 17 cost time: 1.1153805255889893
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.432 Vali Acc: 0.581 Test Loss: 1.432 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8973174095153809
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.493 Vali Acc: 0.595 Test Loss: 1.493 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1743066310882568
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.467 Vali Acc: 0.568 Test Loss: 1.467 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4147515296936035
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.291 Vali Acc: 0.608 Test Loss: 1.291 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6300227642059326
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.392 Vali Acc: 0.568 Test Loss: 1.392 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8553023338317871
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.448 Vali Acc: 0.568 Test Loss: 1.448 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5400710105895996
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.378 Vali Acc: 0.568 Test Loss: 1.378 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5639677047729492
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.324 Vali Acc: 0.568 Test Loss: 1.324 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6946821212768555
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.390 Vali Acc: 0.568 Test Loss: 1.390 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4729273319244385
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.444 Vali Acc: 0.568 Test Loss: 1.444 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 43912708
model size : 182.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.297518491744995
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.414 Vali Acc: 0.162 Test Loss: 1.414 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 2.2055270671844482
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.250 Vali Acc: 0.432 Test Loss: 1.250 Test Acc: 0.432
Validation loss decreased (-0.162148 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.8029556274414062
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.283 Vali Acc: 0.405 Test Loss: 1.283 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.19235897064209
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.361 Vali Acc: 0.392 Test Loss: 1.361 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6852760314941406
Epoch: 5, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.5962059497833252
Epoch: 6, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.318 Vali Acc: 0.514 Test Loss: 1.318 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513500).  Saving model ...
Epoch: 7 cost time: 1.524916648864746
Epoch: 7, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.586 Vali Acc: 0.527 Test Loss: 1.586 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527011).  Saving model ...
Epoch: 8 cost time: 1.6469628810882568
Epoch: 8, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.702 Vali Acc: 0.514 Test Loss: 1.702 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0237531661987305
Epoch: 9, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.855 Vali Acc: 0.541 Test Loss: 1.855 Test Acc: 0.541
Validation loss decreased (-0.527011 --> -0.540522).  Saving model ...
Epoch: 10 cost time: 1.3094820976257324
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 2.358 Vali Acc: 0.432 Test Loss: 2.358 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.343998670578003
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.089 Vali Acc: 0.554 Test Loss: 2.089 Test Acc: 0.554
Validation loss decreased (-0.540522 --> -0.554033).  Saving model ...
Epoch: 12 cost time: 1.3506927490234375
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.341 Vali Acc: 0.500 Test Loss: 2.341 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5850200653076172
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.397 Vali Acc: 0.500 Test Loss: 2.397 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4706549644470215
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.471 Vali Acc: 0.486 Test Loss: 2.471 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2489945888519287
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.321 Vali Acc: 0.527 Test Loss: 2.321 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3607664108276367
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.312 Vali Acc: 0.500 Test Loss: 2.312 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1874051094055176
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.410 Vali Acc: 0.527 Test Loss: 2.410 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.301712989807129
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.286 Vali Acc: 0.500 Test Loss: 2.286 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6065313816070557
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.366 Vali Acc: 0.473 Test Loss: 2.366 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4490878582000732
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.500 Test Loss: 2.447 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4249379634857178
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.484 Vali Acc: 0.500 Test Loss: 2.484 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 44193796
model size : 183.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.459559917449951
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.390 Vali Acc: 0.338 Test Loss: 1.390 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.8311061859130859
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.383 Vali Acc: 0.284 Test Loss: 1.383 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2622950077056885
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.289 Vali Acc: 0.473 Test Loss: 1.289 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.0724515914916992
Epoch: 4, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.283 Vali Acc: 0.419 Test Loss: 1.283 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8177590370178223
Epoch: 5, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.3479206562042236
Epoch: 6, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.300 Vali Acc: 0.405 Test Loss: 1.300 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0328924655914307
Epoch: 7, Steps: 10 | Train Loss: 0.638 Vali Loss: 1.222 Vali Acc: 0.473 Test Loss: 1.222 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2435190677642822
Epoch: 8, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.286 Vali Acc: 0.541 Test Loss: 1.286 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8657505512237549
Epoch: 9, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.321 Vali Acc: 0.541 Test Loss: 1.321 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1300642490386963
Epoch: 10, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.580 Vali Acc: 0.500 Test Loss: 1.580 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2666804790496826
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.708 Vali Acc: 0.486 Test Loss: 1.708 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9400315284729004
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.632 Vali Acc: 0.541 Test Loss: 1.632 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.136101484298706
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.739 Vali Acc: 0.486 Test Loss: 1.739 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.090933084487915
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.605 Vali Acc: 0.527 Test Loss: 1.605 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3237760066986084
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.846 Vali Acc: 0.446 Test Loss: 1.846 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 44018692
model size : 182.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2464282512664795
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.6761729717254639
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.351 Vali Acc: 0.392 Test Loss: 1.351 Test Acc: 0.392
Validation loss decreased (-0.243229 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 0.5404367446899414
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
Validation loss decreased (-0.391878 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.6038482189178467
Epoch: 4, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.306 Vali Acc: 0.432 Test Loss: 1.306 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8771059513092041
Epoch: 5, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6285710334777832
Epoch: 6, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.221 Vali Acc: 0.514 Test Loss: 1.221 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 0.8151438236236572
Epoch: 7, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.129 Vali Acc: 0.514 Test Loss: 1.129 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.8139052391052246
Epoch: 8, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.242 Vali Acc: 0.486 Test Loss: 1.242 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.77691650390625
Epoch: 9, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6302211284637451
Epoch: 10, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.548 Vali Acc: 0.459 Test Loss: 1.548 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6272406578063965
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.408 Vali Acc: 0.486 Test Loss: 1.408 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6832513809204102
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.478 Vali Acc: 0.514 Test Loss: 1.478 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9319536685943604
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.448 Vali Acc: 0.486 Test Loss: 1.448 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1678972244262695
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.393 Vali Acc: 0.541 Test Loss: 1.393 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540527).  Saving model ...
Epoch: 15 cost time: 0.8486759662628174
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.379 Vali Acc: 0.514 Test Loss: 1.379 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9987659454345703
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.434 Vali Acc: 0.541 Test Loss: 1.434 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0067534446716309
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.316 Vali Acc: 0.527 Test Loss: 1.316 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8503282070159912
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.294 Vali Acc: 0.527 Test Loss: 1.294 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8145108222961426
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.344 Vali Acc: 0.568 Test Loss: 1.344 Test Acc: 0.568
Validation loss decreased (-0.540527 --> -0.567554).  Saving model ...
Epoch: 20 cost time: 0.7850682735443115
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.376 Vali Acc: 0.581 Test Loss: 1.376 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 21 cost time: 0.8448350429534912
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.330 Vali Acc: 0.527 Test Loss: 1.330 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7008543014526367
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.325 Vali Acc: 0.554 Test Loss: 1.325 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.788992166519165
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.348 Vali Acc: 0.554 Test Loss: 1.348 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.943603515625
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.366 Vali Acc: 0.541 Test Loss: 1.366 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8328323364257812
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.527 Test Loss: 1.347 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6919214725494385
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.360 Vali Acc: 0.541 Test Loss: 1.360 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.670844554901123
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.568 Test Loss: 1.394 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6251745223999023
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.388 Vali Acc: 0.554 Test Loss: 1.388 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7256581783294678
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7460713386535645
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.541 Test Loss: 1.398 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 43931140
model size : 182.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.493913412094116
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.316 Vali Acc: 0.459 Test Loss: 1.316 Test Acc: 0.459
Validation loss decreased (inf --> -0.459446).  Saving model ...
Epoch: 2 cost time: 0.9928188323974609
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.323 Vali Acc: 0.311 Test Loss: 1.323 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9676532745361328
Epoch: 3, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.300 Vali Acc: 0.351 Test Loss: 1.300 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0844969749450684
Epoch: 4, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
Validation loss decreased (-0.459446 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 1.001220703125
Epoch: 5, Steps: 10 | Train Loss: 0.897 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0011992454528809
Epoch: 6, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.095 Vali Acc: 0.486 Test Loss: 1.095 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1279807090759277
Epoch: 7, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2133238315582275
Epoch: 8, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.306 Vali Acc: 0.554 Test Loss: 1.306 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5911839008331299
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.419 Vali Acc: 0.595 Test Loss: 1.419 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594580).  Saving model ...
Epoch: 10 cost time: 1.4188933372497559
Epoch: 10, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.863 Vali Acc: 0.554 Test Loss: 1.863 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.452242374420166
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.830 Vali Acc: 0.554 Test Loss: 1.830 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.157482624053955
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.864 Vali Acc: 0.608 Test Loss: 1.864 Test Acc: 0.608
Validation loss decreased (-0.594580 --> -0.608089).  Saving model ...
Epoch: 13 cost time: 0.9933774471282959
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.201 Vali Acc: 0.568 Test Loss: 2.201 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5690653324127197
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.982 Vali Acc: 0.581 Test Loss: 1.982 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5260508060455322
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.135 Vali Acc: 0.635 Test Loss: 2.135 Test Acc: 0.635
Validation loss decreased (-0.608089 --> -0.635114).  Saving model ...
Epoch: 16 cost time: 1.1290555000305176
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.032 Vali Acc: 0.608 Test Loss: 2.032 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.00126051902771
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.024 Vali Acc: 0.622 Test Loss: 2.024 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.290588617324829
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.112 Vali Acc: 0.595 Test Loss: 2.112 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2585933208465576
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.028 Vali Acc: 0.568 Test Loss: 2.028 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.682368278503418
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.024 Vali Acc: 0.568 Test Loss: 2.024 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2161164283752441
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.032 Vali Acc: 0.595 Test Loss: 2.032 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.000190019607544
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.608 Test Loss: 2.107 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.971477746963501
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.127 Vali Acc: 0.608 Test Loss: 2.127 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.106637954711914
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.117 Vali Acc: 0.595 Test Loss: 2.117 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6441538333892822
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.581 Test Loss: 2.075 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 44179972
model size : 183.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.138814926147461
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.413 Vali Acc: 0.257 Test Loss: 1.413 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.3084983825683594
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.327 Vali Acc: 0.419 Test Loss: 1.327 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8783218860626221
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.331 Vali Acc: 0.486 Test Loss: 1.331 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 1.4642174243927002
Epoch: 4, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.211 Vali Acc: 0.608 Test Loss: 1.211 Test Acc: 0.608
Validation loss decreased (-0.486473 --> -0.608096).  Saving model ...
Epoch: 5 cost time: 0.9816968441009521
Epoch: 5, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.147 Vali Acc: 0.446 Test Loss: 1.147 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5099329948425293
Epoch: 6, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1392886638641357
Epoch: 7, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0976426601409912
Epoch: 8, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.206 Vali Acc: 0.486 Test Loss: 1.206 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6134872436523438
Epoch: 9, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.504 Vali Acc: 0.446 Test Loss: 1.504 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0312602519989014
Epoch: 10, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.538 Vali Acc: 0.541 Test Loss: 1.538 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3194994926452637
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.467 Vali Acc: 0.514 Test Loss: 1.467 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0521085262298584
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.819 Vali Acc: 0.500 Test Loss: 1.819 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9421882629394531
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.817 Vali Acc: 0.473 Test Loss: 1.817 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.967637300491333
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.676 Vali Acc: 0.514 Test Loss: 1.676 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 44046340
model size : 182.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.04262113571167
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.406 Vali Acc: 0.203 Test Loss: 1.406 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.7239973545074463
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.404 Vali Acc: 0.203 Test Loss: 1.404 Test Acc: 0.203
Validation loss decreased (-0.202689 --> -0.202689).  Saving model ...
Epoch: 3 cost time: 0.6364736557006836
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.358 Vali Acc: 0.311 Test Loss: 1.358 Test Acc: 0.311
Validation loss decreased (-0.202689 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.7219545841217041
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.301 Vali Acc: 0.446 Test Loss: 1.301 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.0708208084106445
Epoch: 5, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.321 Vali Acc: 0.351 Test Loss: 1.321 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0614397525787354
Epoch: 6, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.8423147201538086
Epoch: 7, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.308 Vali Acc: 0.365 Test Loss: 1.308 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6538326740264893
Epoch: 8, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5234417915344238
Epoch: 9, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8912897109985352
Epoch: 10, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6377706527709961
Epoch: 11, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.239 Vali Acc: 0.527 Test Loss: 1.239 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 0.6311841011047363
Epoch: 12, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.401 Vali Acc: 0.500 Test Loss: 1.401 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8316032886505127
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.370 Vali Acc: 0.541 Test Loss: 1.370 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 14 cost time: 0.9627532958984375
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8033711910247803
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.511 Vali Acc: 0.527 Test Loss: 1.511 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5336544513702393
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.622 Vali Acc: 0.473 Test Loss: 1.622 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5675106048583984
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.468 Vali Acc: 0.568 Test Loss: 1.468 Test Acc: 0.568
Validation loss decreased (-0.540527 --> -0.567553).  Saving model ...
Epoch: 18 cost time: 0.9010062217712402
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9007143974304199
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.578 Vali Acc: 0.527 Test Loss: 1.578 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7041604518890381
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.596 Vali Acc: 0.527 Test Loss: 1.596 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6760189533233643
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.573 Vali Acc: 0.541 Test Loss: 1.573 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6074519157409668
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.575 Vali Acc: 0.541 Test Loss: 1.575 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7700433731079102
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.575 Vali Acc: 0.541 Test Loss: 1.575 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8652174472808838
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.564 Vali Acc: 0.541 Test Loss: 1.564 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.827749490737915
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.572 Vali Acc: 0.554 Test Loss: 1.572 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8226780891418457
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.589 Vali Acc: 0.554 Test Loss: 1.589 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4194824695587158
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.594 Vali Acc: 0.541 Test Loss: 1.594 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 43968004
model size : 182.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7745347023010254
Epoch: 1, Steps: 10 | Train Loss: 1.581 Vali Loss: 1.413 Vali Acc: 0.338 Test Loss: 1.413 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 2.0361623764038086
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.424 Vali Acc: 0.203 Test Loss: 1.424 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9177374839782715
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.339 Vali Acc: 0.459 Test Loss: 1.339 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 1.8032972812652588
Epoch: 4, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.207 Vali Acc: 0.378 Test Loss: 1.207 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2147345542907715
Epoch: 5, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.250 Vali Acc: 0.514 Test Loss: 1.250 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 0.836479663848877
Epoch: 6, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.357 Vali Acc: 0.554 Test Loss: 1.357 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554040).  Saving model ...
Epoch: 7 cost time: 1.2927942276000977
Epoch: 7, Steps: 10 | Train Loss: 0.326 Vali Loss: 2.001 Vali Acc: 0.446 Test Loss: 2.001 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8604726791381836
Epoch: 8, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.411 Vali Acc: 0.568 Test Loss: 1.411 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567553).  Saving model ...
Epoch: 9 cost time: 1.839449167251587
Epoch: 9, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.550 Vali Acc: 0.459 Test Loss: 1.550 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7828774452209473
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.392 Vali Acc: 0.500 Test Loss: 2.392 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4537205696105957
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 2.166 Vali Acc: 0.486 Test Loss: 2.166 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7117409706115723
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.375 Vali Acc: 0.500 Test Loss: 2.375 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5390312671661377
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.201 Vali Acc: 0.459 Test Loss: 2.201 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.566098928451538
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.054 Vali Acc: 0.527 Test Loss: 2.054 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3765335083007812
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.126 Vali Acc: 0.514 Test Loss: 2.126 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.559291124343872
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.306 Vali Acc: 0.514 Test Loss: 2.306 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2942473888397217
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.212 Vali Acc: 0.541 Test Loss: 2.212 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4983768463134766
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.568 Test Loss: 1.986 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44198404
model size : 183.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6521124839782715
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.382 Vali Acc: 0.324 Test Loss: 1.382 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.0650720596313477
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.335 Vali Acc: 0.311 Test Loss: 1.335 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2840838432312012
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.253 Vali Acc: 0.514 Test Loss: 1.253 Test Acc: 0.514
Validation loss decreased (-0.324311 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.1475965976715088
Epoch: 4, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3458139896392822
Epoch: 5, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.151 Vali Acc: 0.581 Test Loss: 1.151 Test Acc: 0.581
Validation loss decreased (-0.513501 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.9232170581817627
Epoch: 6, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0641837120056152
Epoch: 7, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.387 Vali Acc: 0.473 Test Loss: 1.387 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.091282844543457
Epoch: 8, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9467124938964844
Epoch: 9, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.637 Vali Acc: 0.541 Test Loss: 1.637 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5158767700195312
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.406 Vali Acc: 0.541 Test Loss: 1.406 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1882028579711914
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.364 Vali Acc: 0.541 Test Loss: 1.364 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6835167407989502
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.380 Vali Acc: 0.608 Test Loss: 1.380 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608094).  Saving model ...
Epoch: 13 cost time: 1.4952051639556885
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.374 Vali Acc: 0.581 Test Loss: 1.374 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3721089363098145
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.490 Vali Acc: 0.595 Test Loss: 1.490 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.124068021774292
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.556 Vali Acc: 0.568 Test Loss: 1.556 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5367515087127686
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.514 Vali Acc: 0.554 Test Loss: 1.514 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5900838375091553
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.486 Vali Acc: 0.608 Test Loss: 1.486 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5339186191558838
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.517 Vali Acc: 0.581 Test Loss: 1.517 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.302171230316162
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.525 Vali Acc: 0.595 Test Loss: 1.525 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2943978309631348
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.520 Vali Acc: 0.581 Test Loss: 1.520 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1030635833740234
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.581 Test Loss: 1.545 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.076220989227295
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.581 Test Loss: 1.536 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 44055556
model size : 182.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.873228073120117
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.384 Vali Acc: 0.405 Test Loss: 1.384 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 0.6086771488189697
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.376 Vali Acc: 0.243 Test Loss: 1.376 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5394923686981201
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.328 Vali Acc: 0.378 Test Loss: 1.328 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.047616958618164
Epoch: 4, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.299 Vali Acc: 0.419 Test Loss: 1.299 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.1638789176940918
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.237 Vali Acc: 0.432 Test Loss: 1.237 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.7805893421173096
Epoch: 6, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.213 Vali Acc: 0.419 Test Loss: 1.213 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8550143241882324
Epoch: 7, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.155 Vali Acc: 0.446 Test Loss: 1.155 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.9434792995452881
Epoch: 8, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.253 Vali Acc: 0.514 Test Loss: 1.253 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 0.6799111366271973
Epoch: 9, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8634591102600098
Epoch: 10, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.276 Vali Acc: 0.419 Test Loss: 1.276 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0334804058074951
Epoch: 11, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.482 Vali Acc: 0.432 Test Loss: 1.482 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0276079177856445
Epoch: 12, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.539689540863037
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.493 Vali Acc: 0.419 Test Loss: 1.493 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.246314287185669
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3041694164276123
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.430 Vali Acc: 0.446 Test Loss: 1.430 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.522554874420166
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.503 Vali Acc: 0.446 Test Loss: 1.503 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4845912456512451
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.510 Vali Acc: 0.473 Test Loss: 1.510 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.137634038925171
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.474 Vali Acc: 0.486 Test Loss: 1.474 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 43986436
model size : 182.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0336666107177734
Epoch: 1, Steps: 10 | Train Loss: 1.551 Vali Loss: 1.384 Vali Acc: 0.351 Test Loss: 1.384 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.3428153991699219
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.274 Vali Acc: 0.432 Test Loss: 1.274 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.4395627975463867
Epoch: 3, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.304081916809082
Epoch: 4, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4274699687957764
Epoch: 5, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.272 Vali Acc: 0.486 Test Loss: 1.272 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7685449123382568
Epoch: 6, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.774 Vali Acc: 0.392 Test Loss: 1.774 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8969476222991943
Epoch: 7, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.510 Vali Acc: 0.446 Test Loss: 1.510 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8874530792236328
Epoch: 8, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.721 Vali Acc: 0.446 Test Loss: 1.721 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8111159801483154
Epoch: 9, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.309497356414795
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.820 Vali Acc: 0.500 Test Loss: 1.820 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5457491874694824
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.163 Vali Acc: 0.446 Test Loss: 2.163 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4974584579467773
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.100 Vali Acc: 0.459 Test Loss: 2.100 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2909467220306396
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.149 Vali Acc: 0.459 Test Loss: 2.149 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 44221444
model size : 183.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7411718368530273
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.395 Vali Acc: 0.311 Test Loss: 1.395 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9787728786468506
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.346 Vali Acc: 0.311 Test Loss: 1.346 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.2670254707336426
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.274 Vali Acc: 0.459 Test Loss: 1.274 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.8666863441467285
Epoch: 4, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.287 Vali Acc: 0.405 Test Loss: 1.287 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2219007015228271
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.188 Vali Acc: 0.473 Test Loss: 1.188 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.0165574550628662
Epoch: 6, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.344 Vali Acc: 0.473 Test Loss: 1.344 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5667469501495361
Epoch: 7, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.386 Vali Acc: 0.473 Test Loss: 1.386 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3640234470367432
Epoch: 8, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567555).  Saving model ...
Epoch: 9 cost time: 1.3726263046264648
Epoch: 9, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.370 Vali Acc: 0.568 Test Loss: 1.370 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2374579906463623
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.600 Vali Acc: 0.459 Test Loss: 1.600 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3068897724151611
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.501 Vali Acc: 0.554 Test Loss: 1.501 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1111133098602295
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.566 Vali Acc: 0.541 Test Loss: 1.566 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0994040966033936
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.500 Vali Acc: 0.608 Test Loss: 1.500 Test Acc: 0.608
Validation loss decreased (-0.567555 --> -0.608093).  Saving model ...
Epoch: 14 cost time: 0.9058387279510498
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.434 Vali Acc: 0.568 Test Loss: 1.434 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.028881549835205
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.543 Vali Acc: 0.595 Test Loss: 1.543 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0991709232330322
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.585 Vali Acc: 0.595 Test Loss: 1.585 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.301527738571167
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.524 Vali Acc: 0.595 Test Loss: 1.524 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0933444499969482
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.500 Vali Acc: 0.595 Test Loss: 1.500 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9987936019897461
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.544 Vali Acc: 0.595 Test Loss: 1.544 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.281080961227417
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.636 Vali Acc: 0.608 Test Loss: 1.636 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.017122745513916
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.622 Test Loss: 1.648 Test Acc: 0.622
Validation loss decreased (-0.608093 --> -0.621605).  Saving model ...
Epoch: 22 cost time: 1.044954776763916
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.595 Test Loss: 1.578 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.113288164138794
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.622 Test Loss: 1.527 Test Acc: 0.622
Validation loss decreased (-0.621605 --> -0.621606).  Saving model ...
Epoch: 24 cost time: 1.0392239093780518
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.538 Vali Acc: 0.635 Test Loss: 1.538 Test Acc: 0.635
Validation loss decreased (-0.621606 --> -0.635120).  Saving model ...
Epoch: 25 cost time: 1.0310161113739014
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.635 Test Loss: 1.565 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0156316757202148
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.622 Test Loss: 1.593 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9996359348297119
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.608 Test Loss: 1.600 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1918423175811768
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.595 Test Loss: 1.585 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0526728630065918
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.595 Test Loss: 1.592 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9127748012542725
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.581 Test Loss: 1.630 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9181230068206787
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.659 Vali Acc: 0.595 Test Loss: 1.659 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1539394855499268
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.595 Test Loss: 1.672 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2974088191986084
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.673 Vali Acc: 0.595 Test Loss: 1.673 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7597298622131348
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.595 Test Loss: 1.655 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 44078596
model size : 182.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.070633888244629
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.9644076824188232
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.391 Vali Acc: 0.230 Test Loss: 1.391 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.031853437423706
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.363 Vali Acc: 0.311 Test Loss: 1.363 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.868980884552002
Epoch: 4, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.291 Vali Acc: 0.392 Test Loss: 1.291 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.007054090499878
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.273 Vali Acc: 0.473 Test Loss: 1.273 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 0.9990320205688477
Epoch: 6, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.235 Vali Acc: 0.473 Test Loss: 1.235 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.3612074851989746
Epoch: 7, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0200591087341309
Epoch: 8, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.9868907928466797
Epoch: 9, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1488728523254395
Epoch: 10, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.221 Vali Acc: 0.541 Test Loss: 1.221 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 11 cost time: 0.9711625576019287
Epoch: 11, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.233 Vali Acc: 0.581 Test Loss: 1.233 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 0.9668633937835693
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.261 Vali Acc: 0.554 Test Loss: 1.261 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9208493232727051
Epoch: 13, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9300928115844727
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.249 Vali Acc: 0.581 Test Loss: 1.249 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.021146297454834
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.320 Vali Acc: 0.554 Test Loss: 1.320 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.901176929473877
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.429 Vali Acc: 0.581 Test Loss: 1.429 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0071430206298828
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.515 Vali Acc: 0.541 Test Loss: 1.515 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.512272834777832
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5387301445007324
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.398 Vali Acc: 0.554 Test Loss: 1.398 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.559424638748169
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.416 Vali Acc: 0.541 Test Loss: 1.416 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5623049736022949
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.437 Vali Acc: 0.541 Test Loss: 1.437 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 44004868
model size : 182.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2734639644622803
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.405 Vali Acc: 0.257 Test Loss: 1.405 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.4889461994171143
Epoch: 2, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.430 Vali Acc: 0.216 Test Loss: 1.430 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4037208557128906
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
Validation loss decreased (-0.256743 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.9780025482177734
Epoch: 4, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.322 Vali Acc: 0.378 Test Loss: 1.322 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7230877876281738
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.9771997928619385
Epoch: 6, Steps: 10 | Train Loss: 0.739 Vali Loss: 1.261 Vali Acc: 0.405 Test Loss: 1.261 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.310706615447998
Epoch: 7, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.3847856521606445
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 1.904388189315796
Epoch: 9, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.471 Vali Acc: 0.541 Test Loss: 1.471 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4212443828582764
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3696622848510742
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.509 Vali Acc: 0.568 Test Loss: 1.509 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.896512508392334
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.542 Vali Acc: 0.622 Test Loss: 1.542 Test Acc: 0.622
Validation loss decreased (-0.581069 --> -0.621606).  Saving model ...
Epoch: 13 cost time: 1.2863450050354004
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.444 Vali Acc: 0.649 Test Loss: 1.444 Test Acc: 0.649
Validation loss decreased (-0.621606 --> -0.648634).  Saving model ...
Epoch: 14 cost time: 1.4377567768096924
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.622 Test Loss: 1.551 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2877144813537598
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.649 Test Loss: 1.340 Test Acc: 0.649
Validation loss decreased (-0.648634 --> -0.648635).  Saving model ...
Epoch: 16 cost time: 1.4003016948699951
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.579 Vali Acc: 0.622 Test Loss: 1.579 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8663880825042725
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.496 Vali Acc: 0.649 Test Loss: 1.496 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6467957496643066
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.511 Vali Acc: 0.649 Test Loss: 1.511 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2674846649169922
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.635 Test Loss: 1.544 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.03049898147583
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.635 Test Loss: 1.619 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.026829719543457
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.635 Test Loss: 1.617 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2641263008117676
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.635 Test Loss: 1.576 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2653753757476807
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.635 Test Loss: 1.536 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2152059078216553
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.622 Test Loss: 1.523 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.488781213760376
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.622 Test Loss: 1.518 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 44203012
model size : 183.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8341457843780518
Epoch: 1, Steps: 10 | Train Loss: 1.509 Vali Loss: 1.336 Vali Acc: 0.338 Test Loss: 1.336 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0609056949615479
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.370 Vali Acc: 0.257 Test Loss: 1.370 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3744795322418213
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.270 Vali Acc: 0.473 Test Loss: 1.270 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 1.11281156539917
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.215940237045288
Epoch: 5, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.130 Vali Acc: 0.486 Test Loss: 1.130 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.88130784034729
Epoch: 6, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.072 Vali Acc: 0.514 Test Loss: 1.072 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 0.9723172187805176
Epoch: 7, Steps: 10 | Train Loss: 0.526 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3037772178649902
Epoch: 8, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0937886238098145
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527014).  Saving model ...
Epoch: 10 cost time: 1.2376415729522705
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.292 Vali Acc: 0.514 Test Loss: 1.292 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1242225170135498
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.503 Vali Acc: 0.554 Test Loss: 1.503 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554039).  Saving model ...
Epoch: 12 cost time: 0.9048821926116943
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.575 Vali Acc: 0.554 Test Loss: 1.575 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1360971927642822
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.601 Vali Acc: 0.541 Test Loss: 1.601 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.058779239654541
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.524 Vali Acc: 0.541 Test Loss: 1.524 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0087873935699463
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.585 Vali Acc: 0.514 Test Loss: 1.585 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8678600788116455
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.567 Vali Acc: 0.541 Test Loss: 1.567 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1576552391052246
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.575 Vali Acc: 0.568 Test Loss: 1.575 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567552).  Saving model ...
Epoch: 18 cost time: 0.8743712902069092
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.699 Vali Acc: 0.554 Test Loss: 1.699 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2520232200622559
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.723 Vali Acc: 0.554 Test Loss: 1.723 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.146082878112793
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.640 Vali Acc: 0.554 Test Loss: 1.640 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.066413164138794
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.554 Test Loss: 1.615 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8137240409851074
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.541 Test Loss: 1.649 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1508219242095947
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.527 Test Loss: 1.677 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2754926681518555
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.670 Vali Acc: 0.541 Test Loss: 1.670 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9993155002593994
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.656 Vali Acc: 0.541 Test Loss: 1.656 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0863661766052246
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.541 Test Loss: 1.658 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.177685022354126
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.527 Test Loss: 1.698 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44087812
model size : 182.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2151899337768555
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.026179552078247
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.365 Vali Acc: 0.297 Test Loss: 1.365 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.8729922771453857
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.362 Vali Acc: 0.365 Test Loss: 1.362 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.182244062423706
Epoch: 4, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.282 Vali Acc: 0.392 Test Loss: 1.282 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.0156126022338867
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.277 Vali Acc: 0.378 Test Loss: 1.277 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1859350204467773
Epoch: 6, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.5873715877532959
Epoch: 7, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5635030269622803
Epoch: 8, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6282811164855957
Epoch: 9, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.251 Vali Acc: 0.486 Test Loss: 1.251 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6727232933044434
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527013).  Saving model ...
Epoch: 11 cost time: 0.7042984962463379
Epoch: 11, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.342 Vali Acc: 0.568 Test Loss: 1.342 Test Acc: 0.568
Validation loss decreased (-0.527013 --> -0.567554).  Saving model ...
Epoch: 12 cost time: 0.6109933853149414
Epoch: 12, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.378 Vali Acc: 0.514 Test Loss: 1.378 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5273089408874512
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.475 Vali Acc: 0.622 Test Loss: 1.475 Test Acc: 0.622
Validation loss decreased (-0.567554 --> -0.621607).  Saving model ...
Epoch: 14 cost time: 0.5203733444213867
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.445 Vali Acc: 0.595 Test Loss: 1.445 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6786501407623291
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.473 Vali Acc: 0.595 Test Loss: 1.473 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8352704048156738
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.529 Vali Acc: 0.541 Test Loss: 1.529 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7343709468841553
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.484 Vali Acc: 0.568 Test Loss: 1.484 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5933897495269775
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.598 Vali Acc: 0.608 Test Loss: 1.598 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7622461318969727
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.653 Vali Acc: 0.595 Test Loss: 1.653 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9136888980865479
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.595 Test Loss: 1.630 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8272678852081299
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.643 Vali Acc: 0.608 Test Loss: 1.643 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0132124423980713
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.661 Vali Acc: 0.581 Test Loss: 1.661 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8003180027008057
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.663 Vali Acc: 0.622 Test Loss: 1.663 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 44027908
model size : 182.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9555535316467285
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.517 Vali Acc: 0.189 Test Loss: 1.517 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 1.1597888469696045
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.331 Vali Acc: 0.419 Test Loss: 1.331 Test Acc: 0.419
Validation loss decreased (-0.189174 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.3804752826690674
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.376 Vali Acc: 0.243 Test Loss: 1.376 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3764820098876953
Epoch: 4, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.237 Vali Acc: 0.419 Test Loss: 1.237 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 1.1185824871063232
Epoch: 5, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.418907 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9655201435089111
Epoch: 6, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.000575065612793
Epoch: 7, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.486 Vali Acc: 0.432 Test Loss: 1.486 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2260370254516602
Epoch: 8, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.604 Vali Acc: 0.473 Test Loss: 1.604 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0772013664245605
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.697 Vali Acc: 0.486 Test Loss: 1.697 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3989367485046387
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.670 Vali Acc: 0.473 Test Loss: 1.670 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1020572185516357
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 2.075 Vali Acc: 0.554 Test Loss: 2.075 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554033).  Saving model ...
Epoch: 12 cost time: 1.195030689239502
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.203 Vali Acc: 0.500 Test Loss: 2.203 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2180144786834717
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.926 Vali Acc: 0.541 Test Loss: 1.926 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1410694122314453
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.968 Vali Acc: 0.541 Test Loss: 1.968 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2807223796844482
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.990 Vali Acc: 0.541 Test Loss: 1.990 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7250723838806152
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.965 Vali Acc: 0.554 Test Loss: 1.965 Test Acc: 0.554
Validation loss decreased (-0.554033 --> -0.554034).  Saving model ...
Epoch: 17 cost time: 0.9818639755249023
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.901 Vali Acc: 0.541 Test Loss: 1.901 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9223742485046387
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.568 Test Loss: 1.852 Test Acc: 0.568
Validation loss decreased (-0.554034 --> -0.567549).  Saving model ...
Epoch: 19 cost time: 1.1816349029541016
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.842 Vali Acc: 0.554 Test Loss: 1.842 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9669783115386963
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.554 Test Loss: 1.865 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8943576812744141
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.554 Test Loss: 1.886 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9201207160949707
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.568 Test Loss: 1.903 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8650367259979248
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.554 Test Loss: 1.923 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8507552146911621
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.554 Test Loss: 1.911 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3863146305084229
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.554 Test Loss: 1.912 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2918391227722168
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.907 Vali Acc: 0.568 Test Loss: 1.907 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.989130973815918
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.568 Test Loss: 1.895 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1383280754089355
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.568 Test Loss: 1.897 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44249092
model size : 183.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8954181671142578
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.351 Vali Acc: 0.378 Test Loss: 1.351 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.1751971244812012
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.367 Vali Acc: 0.324 Test Loss: 1.367 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9865610599517822
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.9641375541687012
Epoch: 4, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0644474029541016
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.8747050762176514
Epoch: 6, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8927078247070312
Epoch: 7, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.218 Vali Acc: 0.432 Test Loss: 1.218 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7472295761108398
Epoch: 8, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0681366920471191
Epoch: 9, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 0.9072487354278564
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8322079181671143
Epoch: 11, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.483 Vali Acc: 0.473 Test Loss: 1.483 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.089242696762085
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.453 Vali Acc: 0.473 Test Loss: 1.453 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7371609210968018
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.463 Vali Acc: 0.500 Test Loss: 1.463 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.859891414642334
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.600 Vali Acc: 0.473 Test Loss: 1.600 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8026738166809082
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.585 Vali Acc: 0.554 Test Loss: 1.585 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554038).  Saving model ...
Epoch: 16 cost time: 0.7656388282775879
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.485 Vali Acc: 0.541 Test Loss: 1.485 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7511165142059326
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.617 Vali Acc: 0.514 Test Loss: 1.617 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7064337730407715
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8204514980316162
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.493 Vali Acc: 0.554 Test Loss: 1.493 Test Acc: 0.554
Validation loss decreased (-0.554038 --> -0.554039).  Saving model ...
Epoch: 20 cost time: 0.7410366535186768
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.534 Vali Acc: 0.554 Test Loss: 1.534 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.783728837966919
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.570 Vali Acc: 0.541 Test Loss: 1.570 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7224948406219482
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.516 Vali Acc: 0.554 Test Loss: 1.516 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0721964836120605
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.568 Test Loss: 1.482 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567553).  Saving model ...
Epoch: 24 cost time: 0.8474864959716797
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.512 Vali Acc: 0.568 Test Loss: 1.512 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7078540325164795
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.595 Test Loss: 1.480 Test Acc: 0.595
Validation loss decreased (-0.567553 --> -0.594580).  Saving model ...
Epoch: 26 cost time: 1.3662424087524414
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.581 Test Loss: 1.492 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.045344591140747
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.495 Vali Acc: 0.595 Test Loss: 1.495 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7725784778594971
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.522 Vali Acc: 0.581 Test Loss: 1.522 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7052502632141113
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7130756378173828
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.541 Test Loss: 1.579 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7152965068817139
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.574 Vali Acc: 0.554 Test Loss: 1.574 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6269409656524658
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.554 Test Loss: 1.559 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0080540180206299
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.568 Test Loss: 1.569 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8621513843536377
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.568 Test Loss: 1.551 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8673880100250244
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.568 Test Loss: 1.554 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 44124676
model size : 183.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1798877716064453
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.6957113742828369
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.335 Vali Acc: 0.419 Test Loss: 1.335 Test Acc: 0.419
Validation loss decreased (-0.270256 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.7287166118621826
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.328 Vali Acc: 0.351 Test Loss: 1.328 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.676306962966919
Epoch: 4, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.330 Vali Acc: 0.311 Test Loss: 1.330 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.790764570236206
Epoch: 5, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.668327808380127
Epoch: 6, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.234 Vali Acc: 0.446 Test Loss: 1.234 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8547201156616211
Epoch: 7, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.130 Vali Acc: 0.459 Test Loss: 1.130 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 8 cost time: 0.753483772277832
Epoch: 8, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.158 Vali Acc: 0.446 Test Loss: 1.158 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5567452907562256
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.217 Vali Acc: 0.419 Test Loss: 1.217 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6171464920043945
Epoch: 10, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 0.7172298431396484
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.203 Vali Acc: 0.568 Test Loss: 1.203 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 0.6544601917266846
Epoch: 12, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.190 Vali Acc: 0.554 Test Loss: 1.190 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7022652626037598
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.240 Vali Acc: 0.527 Test Loss: 1.240 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6655967235565186
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.423 Vali Acc: 0.514 Test Loss: 1.423 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5160079002380371
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.405 Vali Acc: 0.486 Test Loss: 1.405 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5081949234008789
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.466 Vali Acc: 0.500 Test Loss: 1.466 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5620934963226318
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.450 Vali Acc: 0.527 Test Loss: 1.450 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.622833251953125
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.389 Vali Acc: 0.541 Test Loss: 1.389 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6200430393218994
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.462 Vali Acc: 0.541 Test Loss: 1.462 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5782220363616943
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.488 Vali Acc: 0.554 Test Loss: 1.488 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5736620426177979
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.405 Vali Acc: 0.568 Test Loss: 1.405 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44064772
model size : 182.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5953011512756348
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.363 Vali Acc: 0.365 Test Loss: 1.363 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.0007603168487549
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.462 Vali Acc: 0.216 Test Loss: 1.462 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8729045391082764
Epoch: 3, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
Validation loss decreased (-0.364851 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.0455267429351807
Epoch: 4, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0604984760284424
Epoch: 5, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.188 Vali Acc: 0.527 Test Loss: 1.188 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.9128053188323975
Epoch: 6, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7967314720153809
Epoch: 7, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.478 Vali Acc: 0.473 Test Loss: 1.478 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8243346214294434
Epoch: 8, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.820 Vali Acc: 0.500 Test Loss: 1.820 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.943640947341919
Epoch: 9, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.625 Vali Acc: 0.527 Test Loss: 1.625 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0065765380859375
Epoch: 10, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.941 Vali Acc: 0.473 Test Loss: 1.941 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0842628479003906
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.034 Vali Acc: 0.500 Test Loss: 2.034 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0506954193115234
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.019 Vali Acc: 0.514 Test Loss: 2.019 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9379839897155762
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.871 Vali Acc: 0.527 Test Loss: 1.871 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2386701107025146
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.205 Vali Acc: 0.568 Test Loss: 2.205 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567546).  Saving model ...
Epoch: 15 cost time: 1.110459566116333
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.041 Vali Acc: 0.554 Test Loss: 2.041 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0860559940338135
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.998 Vali Acc: 0.568 Test Loss: 1.998 Test Acc: 0.568
Validation loss decreased (-0.567546 --> -0.567548).  Saving model ...
Epoch: 17 cost time: 1.5206668376922607
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.065 Vali Acc: 0.541 Test Loss: 2.065 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0223257541656494
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.152 Vali Acc: 0.554 Test Loss: 2.152 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.043341875076294
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.110 Vali Acc: 0.581 Test Loss: 2.110 Test Acc: 0.581
Validation loss decreased (-0.567548 --> -0.581060).  Saving model ...
Epoch: 20 cost time: 1.5850870609283447
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.059 Vali Acc: 0.568 Test Loss: 2.059 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2354753017425537
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.080 Vali Acc: 0.568 Test Loss: 2.080 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2020840644836426
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.581 Test Loss: 2.086 Test Acc: 0.581
Validation loss decreased (-0.581060 --> -0.581060).  Saving model ...
Epoch: 23 cost time: 0.9662661552429199
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.104 Vali Acc: 0.581 Test Loss: 2.104 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5699717998504639
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.568 Test Loss: 2.136 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1656999588012695
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.124 Vali Acc: 0.581 Test Loss: 2.124 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.795863151550293
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.125 Vali Acc: 0.581 Test Loss: 2.125 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3704988956451416
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.128 Vali Acc: 0.581 Test Loss: 2.128 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.372873067855835
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.151 Vali Acc: 0.581 Test Loss: 2.151 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2227466106414795
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.170 Vali Acc: 0.595 Test Loss: 2.170 Test Acc: 0.595
Validation loss decreased (-0.581060 --> -0.594573).  Saving model ...
Epoch: 30 cost time: 1.149195909500122
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.177 Vali Acc: 0.568 Test Loss: 2.177 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.023059368133545
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.139 Vali Acc: 0.568 Test Loss: 2.139 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.361499309539795
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.137 Vali Acc: 0.568 Test Loss: 2.137 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2314143180847168
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.148 Vali Acc: 0.581 Test Loss: 2.148 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0048882961273193
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.170 Vali Acc: 0.581 Test Loss: 2.170 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0899648666381836
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.153 Vali Acc: 0.595 Test Loss: 2.153 Test Acc: 0.595
Validation loss decreased (-0.594573 --> -0.594573).  Saving model ...
Epoch: 36 cost time: 0.882582426071167
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.154 Vali Acc: 0.595 Test Loss: 2.154 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9687404632568359
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.595 Test Loss: 2.165 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3697044849395752
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.595 Test Loss: 2.194 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2176053524017334
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.207 Vali Acc: 0.595 Test Loss: 2.207 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.967522144317627
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.205 Vali Acc: 0.595 Test Loss: 2.205 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7517077922821045
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.595 Test Loss: 2.171 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1069674491882324
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.595 Test Loss: 2.150 Test Acc: 0.595
Validation loss decreased (-0.594573 --> -0.594573).  Saving model ...
Epoch: 43 cost time: 1.0185861587524414
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.595 Test Loss: 2.146 Test Acc: 0.595
Validation loss decreased (-0.594573 --> -0.594573).  Saving model ...
Epoch: 44 cost time: 1.0334053039550781
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.595 Test Loss: 2.149 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9603116512298584
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.595 Test Loss: 2.158 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8488447666168213
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.167 Vali Acc: 0.595 Test Loss: 2.167 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6171019077301025
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.176 Vali Acc: 0.595 Test Loss: 2.176 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6919808387756348
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.174 Vali Acc: 0.595 Test Loss: 2.174 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9626600742340088
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.184 Vali Acc: 0.581 Test Loss: 2.184 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.009218454360962
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.581 Test Loss: 2.191 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 44262916
model size : 183.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1173136234283447
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.422 Vali Acc: 0.189 Test Loss: 1.422 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.8031375408172607
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.334 Vali Acc: 0.392 Test Loss: 1.334 Test Acc: 0.392
Validation loss decreased (-0.189175 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.9088025093078613
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.336 Vali Acc: 0.419 Test Loss: 1.336 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.6934890747070312
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.223 Vali Acc: 0.527 Test Loss: 1.223 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.7816638946533203
Epoch: 5, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.245 Vali Acc: 0.405 Test Loss: 1.245 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9234907627105713
Epoch: 6, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7570595741271973
Epoch: 7, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.190 Vali Acc: 0.432 Test Loss: 1.190 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7139854431152344
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.243 Vali Acc: 0.554 Test Loss: 1.243 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 0.6346826553344727
Epoch: 9, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.482 Vali Acc: 0.446 Test Loss: 1.482 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6478605270385742
Epoch: 10, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6472184658050537
Epoch: 11, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.302 Vali Acc: 0.486 Test Loss: 1.302 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.650130033493042
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.650 Vali Acc: 0.541 Test Loss: 1.650 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9882326126098633
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.819143533706665
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7366654872894287
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.584 Vali Acc: 0.514 Test Loss: 1.584 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7266390323638916
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.601 Vali Acc: 0.554 Test Loss: 1.601 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6946241855621338
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.507 Vali Acc: 0.568 Test Loss: 1.507 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567552).  Saving model ...
Epoch: 18 cost time: 1.1503422260284424
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1582415103912354
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.605 Vali Acc: 0.527 Test Loss: 1.605 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.901263952255249
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.592 Vali Acc: 0.541 Test Loss: 1.592 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9994118213653564
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.570 Vali Acc: 0.514 Test Loss: 1.570 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5744943618774414
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.578 Vali Acc: 0.514 Test Loss: 1.578 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0161683559417725
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.514 Test Loss: 1.595 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0221562385559082
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.541 Test Loss: 1.600 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5863707065582275
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.614 Vali Acc: 0.527 Test Loss: 1.614 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7844250202178955
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.922947883605957
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.514 Test Loss: 1.648 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44161540
model size : 183.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.295443296432495
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.371 Vali Acc: 0.284 Test Loss: 1.371 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7521731853485107
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.410 Vali Acc: 0.189 Test Loss: 1.410 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8372719287872314
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.354 Vali Acc: 0.338 Test Loss: 1.354 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.7087311744689941
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.299 Vali Acc: 0.365 Test Loss: 1.299 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.7382521629333496
Epoch: 5, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.285 Vali Acc: 0.419 Test Loss: 1.285 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.8174476623535156
Epoch: 6, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.205 Vali Acc: 0.446 Test Loss: 1.205 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.8972105979919434
Epoch: 7, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.201 Vali Acc: 0.432 Test Loss: 1.201 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6319026947021484
Epoch: 8, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.220 Vali Acc: 0.446 Test Loss: 1.220 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6356899738311768
Epoch: 9, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.280 Vali Acc: 0.527 Test Loss: 1.280 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527014).  Saving model ...
Epoch: 10 cost time: 0.8067562580108643
Epoch: 10, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
Validation loss decreased (-0.527014 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 0.8444967269897461
Epoch: 11, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7399168014526367
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.270 Vali Acc: 0.514 Test Loss: 1.270 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6384069919586182
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.312 Vali Acc: 0.486 Test Loss: 1.312 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.600712776184082
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.299 Vali Acc: 0.541 Test Loss: 1.299 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 15 cost time: 0.7320103645324707
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 16 cost time: 0.6525084972381592
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.323 Vali Acc: 0.554 Test Loss: 1.323 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 17 cost time: 0.784259557723999
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.315 Vali Acc: 0.581 Test Loss: 1.315 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581068).  Saving model ...
Epoch: 18 cost time: 0.676856279373169
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6792514324188232
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.370 Vali Acc: 0.595 Test Loss: 1.370 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594581).  Saving model ...
Epoch: 20 cost time: 0.6464846134185791
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.403 Vali Acc: 0.568 Test Loss: 1.403 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6583199501037598
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.377 Vali Acc: 0.581 Test Loss: 1.377 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7004096508026123
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.398 Vali Acc: 0.581 Test Loss: 1.398 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6805691719055176
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.431 Vali Acc: 0.568 Test Loss: 1.431 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.592010498046875
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.380 Vali Acc: 0.581 Test Loss: 1.380 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6868011951446533
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.360 Vali Acc: 0.568 Test Loss: 1.360 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6403694152832031
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.554 Test Loss: 1.357 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8202621936798096
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.333 Vali Acc: 0.581 Test Loss: 1.333 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.715080738067627
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.365 Vali Acc: 0.568 Test Loss: 1.365 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6962659358978271
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.430 Vali Acc: 0.568 Test Loss: 1.430 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 44106244
model size : 182.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3854079246520996
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.469 Vali Acc: 0.230 Test Loss: 1.469 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.9090287685394287
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.362 Vali Acc: 0.378 Test Loss: 1.362 Test Acc: 0.378
Validation loss decreased (-0.229715 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.4676010608673096
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 1.462073802947998
Epoch: 4, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.138 Vali Acc: 0.527 Test Loss: 1.138 Test Acc: 0.527
Validation loss decreased (-0.405393 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 0.9874320030212402
Epoch: 5, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0353293418884277
Epoch: 6, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.370 Vali Acc: 0.459 Test Loss: 1.370 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1831865310668945
Epoch: 7, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.399 Vali Acc: 0.486 Test Loss: 1.399 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1648292541503906
Epoch: 8, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.355 Vali Acc: 0.554 Test Loss: 1.355 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554041).  Saving model ...
Epoch: 9 cost time: 1.0463979244232178
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.544 Vali Acc: 0.459 Test Loss: 1.544 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8016374111175537
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.802192211151123
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.796 Vali Acc: 0.419 Test Loss: 1.796 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3777399063110352
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.821 Vali Acc: 0.500 Test Loss: 1.821 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.001215934753418
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.828 Vali Acc: 0.541 Test Loss: 1.828 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1479871273040771
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.798 Vali Acc: 0.541 Test Loss: 1.798 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1975040435791016
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.790 Vali Acc: 0.527 Test Loss: 1.790 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0350418090820312
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.818 Vali Acc: 0.514 Test Loss: 1.818 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1069765090942383
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.514 Test Loss: 1.830 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2252743244171143
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.514 Test Loss: 1.841 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 44308996
model size : 183.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.10878324508667
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.390 Vali Acc: 0.243 Test Loss: 1.390 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.085663080215454
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.366 Vali Acc: 0.284 Test Loss: 1.366 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.8980631828308105
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.9319634437561035
Epoch: 4, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.271 Vali Acc: 0.459 Test Loss: 1.271 Test Acc: 0.459
Validation loss decreased (-0.337825 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.6045608520507812
Epoch: 5, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.380 Vali Acc: 0.338 Test Loss: 1.380 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7505576610565186
Epoch: 6, Steps: 10 | Train Loss: 0.748 Vali Loss: 1.436 Vali Acc: 0.378 Test Loss: 1.436 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9083075523376465
Epoch: 7, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.292 Vali Acc: 0.459 Test Loss: 1.292 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9268929958343506
Epoch: 8, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.526 Vali Acc: 0.338 Test Loss: 1.526 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.071575403213501
Epoch: 9, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.314 Vali Acc: 0.459 Test Loss: 1.314 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9129891395568848
Epoch: 10, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.438 Vali Acc: 0.405 Test Loss: 1.438 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1647191047668457
Epoch: 11, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.273 Vali Acc: 0.554 Test Loss: 1.273 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554041).  Saving model ...
Epoch: 12 cost time: 0.9184780120849609
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.299 Vali Acc: 0.568 Test Loss: 1.299 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567555).  Saving model ...
Epoch: 13 cost time: 0.8918681144714355
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.543 Vali Acc: 0.568 Test Loss: 1.543 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.049485683441162
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.021735429763794
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.648 Vali Acc: 0.527 Test Loss: 1.648 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7796170711517334
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.698 Vali Acc: 0.514 Test Loss: 1.698 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1859402656555176
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.598 Vali Acc: 0.514 Test Loss: 1.598 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6503078937530518
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7355616092681885
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.632 Vali Acc: 0.500 Test Loss: 1.632 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8034002780914307
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.647 Vali Acc: 0.541 Test Loss: 1.647 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8737342357635498
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.677 Vali Acc: 0.527 Test Loss: 1.677 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7171776294708252
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.554 Test Loss: 1.667 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44203012
model size : 183.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0081562995910645
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.358 Vali Acc: 0.351 Test Loss: 1.358 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.7564783096313477
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.393 Vali Acc: 0.230 Test Loss: 1.393 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6803514957427979
Epoch: 3, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.6567873954772949
Epoch: 4, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.274 Vali Acc: 0.486 Test Loss: 1.274 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.6370556354522705
Epoch: 5, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 0.6655557155609131
Epoch: 6, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.200 Vali Acc: 0.432 Test Loss: 1.200 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7761631011962891
Epoch: 7, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.160 Vali Acc: 0.473 Test Loss: 1.160 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6841292381286621
Epoch: 8, Steps: 10 | Train Loss: 0.633 Vali Loss: 1.177 Vali Acc: 0.432 Test Loss: 1.177 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6176881790161133
Epoch: 9, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.223 Vali Acc: 0.473 Test Loss: 1.223 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6330554485321045
Epoch: 10, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.300 Vali Acc: 0.432 Test Loss: 1.300 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5845019817352295
Epoch: 11, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.281 Vali Acc: 0.514 Test Loss: 1.281 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6271064281463623
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.428 Vali Acc: 0.459 Test Loss: 1.428 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7600147724151611
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.543 Vali Acc: 0.473 Test Loss: 1.543 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6986298561096191
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.427 Vali Acc: 0.514 Test Loss: 1.427 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5890686511993408
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 44147716
model size : 183.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.569580554962158
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.328 Vali Acc: 0.392 Test Loss: 1.328 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.562974452972412
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.375 Vali Acc: 0.257 Test Loss: 1.375 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3875453472137451
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.241 Vali Acc: 0.514 Test Loss: 1.241 Test Acc: 0.514
Validation loss decreased (-0.391879 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 1.527512788772583
Epoch: 4, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 1.075322151184082
Epoch: 5, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7562947273254395
Epoch: 6, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.147 Vali Acc: 0.459 Test Loss: 1.147 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2561438083648682
Epoch: 7, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.616 Vali Acc: 0.419 Test Loss: 1.616 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7481870651245117
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.348 Vali Acc: 0.500 Test Loss: 1.348 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3396379947662354
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.462 Vali Acc: 0.595 Test Loss: 1.462 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594580).  Saving model ...
Epoch: 10 cost time: 1.0946269035339355
Epoch: 10, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.838 Vali Acc: 0.446 Test Loss: 1.838 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3482120037078857
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.628 Vali Acc: 0.527 Test Loss: 1.628 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2506511211395264
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.785 Vali Acc: 0.541 Test Loss: 1.785 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1929190158843994
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.629 Vali Acc: 0.514 Test Loss: 1.629 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.255143165588379
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.933 Vali Acc: 0.500 Test Loss: 1.933 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0319571495056152
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.909 Vali Acc: 0.541 Test Loss: 1.909 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9101808071136475
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.913 Vali Acc: 0.527 Test Loss: 1.913 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4018919467926025
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.945 Vali Acc: 0.568 Test Loss: 1.945 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2323153018951416
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.554 Test Loss: 1.867 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8504941463470459
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.527 Test Loss: 1.898 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 44350468
model size : 183.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4895827770233154
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.397 Vali Acc: 0.230 Test Loss: 1.397 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.7966458797454834
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
Validation loss decreased (-0.229716 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.0683505535125732
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9496102333068848
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.195 Vali Acc: 0.459 Test Loss: 1.195 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8309676647186279
Epoch: 5, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.277 Vali Acc: 0.459 Test Loss: 1.277 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9560165405273438
Epoch: 6, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.080 Vali Acc: 0.541 Test Loss: 1.080 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.8324999809265137
Epoch: 7, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.262 Vali Acc: 0.473 Test Loss: 1.262 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.912700891494751
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.129 Vali Acc: 0.541 Test Loss: 1.129 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7692310810089111
Epoch: 9, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.195 Vali Acc: 0.541 Test Loss: 1.195 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8521950244903564
Epoch: 10, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.141 Vali Acc: 0.595 Test Loss: 1.141 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594583).  Saving model ...
Epoch: 11 cost time: 0.7942197322845459
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.284 Vali Acc: 0.581 Test Loss: 1.284 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0982959270477295
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.255 Vali Acc: 0.568 Test Loss: 1.255 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.018207311630249
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.277 Vali Acc: 0.581 Test Loss: 1.277 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.845289945602417
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.161 Vali Acc: 0.635 Test Loss: 1.161 Test Acc: 0.635
Validation loss decreased (-0.594583 --> -0.635124).  Saving model ...
Epoch: 15 cost time: 1.0825724601745605
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.268 Vali Acc: 0.622 Test Loss: 1.268 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7114729881286621
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.156 Vali Acc: 0.635 Test Loss: 1.156 Test Acc: 0.635
Validation loss decreased (-0.635124 --> -0.635124).  Saving model ...
Epoch: 17 cost time: 0.9167933464050293
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.219 Vali Acc: 0.635 Test Loss: 1.219 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8575425148010254
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.270 Vali Acc: 0.649 Test Loss: 1.270 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648636).  Saving model ...
Epoch: 19 cost time: 1.0022122859954834
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.334 Vali Acc: 0.622 Test Loss: 1.334 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9900870323181152
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.622 Test Loss: 1.357 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5581185817718506
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.334 Vali Acc: 0.622 Test Loss: 1.334 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8452932834625244
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.314 Vali Acc: 0.635 Test Loss: 1.314 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0042774677276611
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.307 Vali Acc: 0.608 Test Loss: 1.307 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.957711935043335
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.608 Test Loss: 1.347 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.377662181854248
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.360 Vali Acc: 0.581 Test Loss: 1.360 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0335309505462646
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.595 Test Loss: 1.368 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1571977138519287
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.622 Test Loss: 1.391 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6903717517852783
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.635 Test Loss: 1.390 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 44262916
model size : 183.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.238863945007324
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.454 Vali Acc: 0.257 Test Loss: 1.454 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.7078168392181396
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.385 Vali Acc: 0.324 Test Loss: 1.385 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 0.7374379634857178
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7252745628356934
Epoch: 4, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.344 Vali Acc: 0.378 Test Loss: 1.344 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.7972643375396729
Epoch: 5, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.231 Vali Acc: 0.568 Test Loss: 1.231 Test Acc: 0.568
Validation loss decreased (-0.378365 --> -0.567555).  Saving model ...
Epoch: 6 cost time: 0.7725989818572998
Epoch: 6, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7020008563995361
Epoch: 7, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.640343189239502
Epoch: 8, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6355464458465576
Epoch: 9, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.191 Vali Acc: 0.554 Test Loss: 1.191 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6645774841308594
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.226 Vali Acc: 0.527 Test Loss: 1.226 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8979480266571045
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.236 Vali Acc: 0.541 Test Loss: 1.236 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9439127445220947
Epoch: 12, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.390 Vali Acc: 0.527 Test Loss: 1.390 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2145435810089111
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.412 Vali Acc: 0.554 Test Loss: 1.412 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.815039873123169
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.485 Vali Acc: 0.500 Test Loss: 1.485 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7886033058166504
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.563 Vali Acc: 0.500 Test Loss: 1.563 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 44212228
model size : 183.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4127631187438965
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.362 Vali Acc: 0.243 Test Loss: 1.362 Test Acc: 0.243
Validation loss decreased (inf --> -0.243230).  Saving model ...
Epoch: 2 cost time: 1.3056914806365967
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.317 Vali Acc: 0.324 Test Loss: 1.317 Test Acc: 0.324
Validation loss decreased (-0.243230 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.473088264465332
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.245 Vali Acc: 0.392 Test Loss: 1.245 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.2282679080963135
Epoch: 4, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
Validation loss decreased (-0.391879 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.0617375373840332
Epoch: 5, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.254 Vali Acc: 0.378 Test Loss: 1.254 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5546867847442627
Epoch: 6, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 7 cost time: 1.1381008625030518
Epoch: 7, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.335 Vali Acc: 0.459 Test Loss: 1.335 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8700711727142334
Epoch: 8, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5102157592773438
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.217 Vali Acc: 0.514 Test Loss: 1.217 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8895912170410156
Epoch: 10, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.267 Vali Acc: 0.541 Test Loss: 1.267 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0519146919250488
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.334 Vali Acc: 0.568 Test Loss: 1.334 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567554).  Saving model ...
Epoch: 12 cost time: 1.6284875869750977
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.405442237854004
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.433 Vali Acc: 0.500 Test Loss: 1.433 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6081323623657227
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.479 Vali Acc: 0.595 Test Loss: 1.479 Test Acc: 0.595
Validation loss decreased (-0.567554 --> -0.594580).  Saving model ...
Epoch: 15 cost time: 1.0506401062011719
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.553 Vali Acc: 0.595 Test Loss: 1.553 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0453104972839355
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.574 Vali Acc: 0.622 Test Loss: 1.574 Test Acc: 0.622
Validation loss decreased (-0.594580 --> -0.621606).  Saving model ...
Epoch: 17 cost time: 1.3651704788208008
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.464 Vali Acc: 0.608 Test Loss: 1.464 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4539272785186768
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.554 Test Loss: 1.515 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.586822748184204
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.622 Test Loss: 1.524 Test Acc: 0.622
Validation loss decreased (-0.621606 --> -0.621606).  Saving model ...
Epoch: 20 cost time: 1.132972240447998
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.635 Test Loss: 1.530 Test Acc: 0.635
Validation loss decreased (-0.621606 --> -0.635120).  Saving model ...
Epoch: 21 cost time: 1.5735244750976562
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.635 Test Loss: 1.542 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8631799221038818
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.622 Test Loss: 1.553 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9399259090423584
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.622 Test Loss: 1.556 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3376131057739258
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.531 Vali Acc: 0.622 Test Loss: 1.531 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5746872425079346
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.608 Test Loss: 1.500 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1988537311553955
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.608 Test Loss: 1.539 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3239011764526367
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.608 Test Loss: 1.586 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.416914701461792
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.608 Test Loss: 1.584 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1551146507263184
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.608 Test Loss: 1.566 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7971124649047852
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.622 Test Loss: 1.558 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 44401156
model size : 184.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.748575448989868
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.470 Vali Acc: 0.203 Test Loss: 1.470 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.2228312492370605
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.359 Vali Acc: 0.284 Test Loss: 1.359 Test Acc: 0.284
Validation loss decreased (-0.202688 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.1770451068878174
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.335 Vali Acc: 0.324 Test Loss: 1.335 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.7799246311187744
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.274 Vali Acc: 0.419 Test Loss: 1.274 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.0620591640472412
Epoch: 5, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.5343213081359863
Epoch: 6, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.252 Vali Acc: 0.378 Test Loss: 1.252 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.306300163269043
Epoch: 7, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.251 Vali Acc: 0.554 Test Loss: 1.251 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.2288203239440918
Epoch: 8, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.264 Vali Acc: 0.473 Test Loss: 1.264 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4842963218688965
Epoch: 9, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.393 Vali Acc: 0.405 Test Loss: 1.393 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5815684795379639
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.137 Vali Acc: 0.581 Test Loss: 1.137 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 1.4780254364013672
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.276 Vali Acc: 0.541 Test Loss: 1.276 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0262260437011719
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.435 Vali Acc: 0.486 Test Loss: 1.435 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1372592449188232
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.361 Vali Acc: 0.595 Test Loss: 1.361 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594581).  Saving model ...
Epoch: 14 cost time: 0.8191611766815186
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.446 Vali Acc: 0.554 Test Loss: 1.446 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1721348762512207
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.595 Vali Acc: 0.473 Test Loss: 1.595 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9009394645690918
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2869679927825928
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.425 Vali Acc: 0.554 Test Loss: 1.425 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9387831687927246
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.487 Vali Acc: 0.514 Test Loss: 1.487 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9770123958587646
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.472 Vali Acc: 0.581 Test Loss: 1.472 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.945122480392456
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.493 Vali Acc: 0.541 Test Loss: 1.493 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8977363109588623
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.548 Vali Acc: 0.541 Test Loss: 1.548 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9882476329803467
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.493 Vali Acc: 0.514 Test Loss: 1.493 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9339051246643066
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.477 Vali Acc: 0.554 Test Loss: 1.477 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 44322820
model size : 183.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6617536544799805
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.409 Vali Acc: 0.176 Test Loss: 1.409 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 0.8165378570556641
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.327 Vali Acc: 0.311 Test Loss: 1.327 Test Acc: 0.311
Validation loss decreased (-0.175662 --> -0.310798).  Saving model ...
Epoch: 3 cost time: 0.7827575206756592
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.382 Vali Acc: 0.324 Test Loss: 1.382 Test Acc: 0.324
Validation loss decreased (-0.310798 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.7166361808776855
Epoch: 4, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.282 Vali Acc: 0.378 Test Loss: 1.282 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 0.6999962329864502
Epoch: 5, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.256 Vali Acc: 0.432 Test Loss: 1.256 Test Acc: 0.432
Validation loss decreased (-0.378366 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.5483686923980713
Epoch: 6, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.237 Vali Acc: 0.473 Test Loss: 1.237 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 0.5506374835968018
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.219 Vali Acc: 0.541 Test Loss: 1.219 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 0.7390601634979248
Epoch: 8, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.264 Vali Acc: 0.419 Test Loss: 1.264 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6949000358581543
Epoch: 9, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7637245655059814
Epoch: 10, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7134363651275635
Epoch: 11, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.333 Vali Acc: 0.486 Test Loss: 1.333 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8178966045379639
Epoch: 12, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.385 Vali Acc: 0.514 Test Loss: 1.385 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8238804340362549
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.330 Vali Acc: 0.486 Test Loss: 1.330 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7165288925170898
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.468 Vali Acc: 0.514 Test Loss: 1.468 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.632732629776001
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.522 Vali Acc: 0.514 Test Loss: 1.522 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6874065399169922
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.567 Vali Acc: 0.514 Test Loss: 1.567 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6532995700836182
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.569 Vali Acc: 0.541 Test Loss: 1.569 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 44276740
model size : 183.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2176339626312256
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.457 Vali Acc: 0.176 Test Loss: 1.457 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 0.8247873783111572
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.325 Vali Acc: 0.378 Test Loss: 1.325 Test Acc: 0.378
Validation loss decreased (-0.175661 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.2018866539001465
Epoch: 3, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.310 Vali Acc: 0.405 Test Loss: 1.310 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.0312340259552002
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.197 Vali Acc: 0.446 Test Loss: 1.197 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.823138952255249
Epoch: 5, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.276 Vali Acc: 0.432 Test Loss: 1.276 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8601229190826416
Epoch: 6, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.131 Vali Acc: 0.432 Test Loss: 1.131 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3769543170928955
Epoch: 7, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
Validation loss decreased (-0.445934 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 1.1979405879974365
Epoch: 8, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.321 Vali Acc: 0.514 Test Loss: 1.321 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0085361003875732
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.603 Vali Acc: 0.541 Test Loss: 1.603 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8798096179962158
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.607 Vali Acc: 0.527 Test Loss: 1.607 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1534528732299805
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.456 Vali Acc: 0.514 Test Loss: 1.456 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3099913597106934
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.566 Vali Acc: 0.622 Test Loss: 1.566 Test Acc: 0.622
Validation loss decreased (-0.540529 --> -0.621606).  Saving model ...
Epoch: 13 cost time: 1.161543607711792
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.672 Vali Acc: 0.554 Test Loss: 1.672 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9620544910430908
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.699 Vali Acc: 0.541 Test Loss: 1.699 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3988029956817627
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.568 Test Loss: 1.675 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1102790832519531
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.792 Vali Acc: 0.541 Test Loss: 1.792 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1219615936279297
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.939 Vali Acc: 0.568 Test Loss: 1.939 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.189201831817627
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.700 Vali Acc: 0.554 Test Loss: 1.700 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9931261539459229
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.554 Test Loss: 1.658 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.046262502670288
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.581 Test Loss: 1.740 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0772383213043213
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.541 Test Loss: 1.790 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5048129558563232
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.541 Test Loss: 1.776 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 44470276
model size : 184.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.316526412963867
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.389 Vali Acc: 0.311 Test Loss: 1.389 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.5820174217224121
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.9167704582214355
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.284 Vali Acc: 0.473 Test Loss: 1.284 Test Acc: 0.473
Validation loss decreased (-0.310797 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.6177668571472168
Epoch: 4, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6309027671813965
Epoch: 5, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.204 Vali Acc: 0.514 Test Loss: 1.204 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 0.7244198322296143
Epoch: 6, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.2497870922088623
Epoch: 7, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.306 Vali Acc: 0.446 Test Loss: 1.306 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8253204822540283
Epoch: 8, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.270 Vali Acc: 0.446 Test Loss: 1.270 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.505666971206665
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.291 Vali Acc: 0.541 Test Loss: 1.291 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 0.8092555999755859
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.422 Vali Acc: 0.486 Test Loss: 1.422 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.044743537902832
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.352 Vali Acc: 0.514 Test Loss: 1.352 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1566236019134521
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.678 Vali Acc: 0.473 Test Loss: 1.678 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3301162719726562
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.472 Vali Acc: 0.500 Test Loss: 1.472 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7002687454223633
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.555 Vali Acc: 0.527 Test Loss: 1.555 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8425366878509521
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.770275354385376
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.499 Vali Acc: 0.541 Test Loss: 1.499 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7209968566894531
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.590 Vali Acc: 0.514 Test Loss: 1.590 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0925612449645996
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.560 Vali Acc: 0.541 Test Loss: 1.560 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8921663761138916
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.524 Vali Acc: 0.527 Test Loss: 1.524 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 44387332
model size : 184.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.117319107055664
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.398 Vali Acc: 0.270 Test Loss: 1.398 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.6120302677154541
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5639359951019287
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.358 Vali Acc: 0.284 Test Loss: 1.358 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 0.6325118541717529
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.7281820774078369
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.261 Vali Acc: 0.446 Test Loss: 1.261 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.7521336078643799
Epoch: 6, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.235 Vali Acc: 0.378 Test Loss: 1.235 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.534752607345581
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.194 Vali Acc: 0.446 Test Loss: 1.194 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 0.8771286010742188
Epoch: 8, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.187 Vali Acc: 0.419 Test Loss: 1.187 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7236156463623047
Epoch: 9, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 10 cost time: 0.6355776786804199
Epoch: 10, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.232 Vali Acc: 0.459 Test Loss: 1.232 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8167464733123779
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.178 Vali Acc: 0.541 Test Loss: 1.178 Test Acc: 0.541
Validation loss decreased (-0.459448 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 0.6994128227233887
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7198281288146973
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6193900108337402
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.141 Vali Acc: 0.568 Test Loss: 1.141 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 0.72505784034729
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.206 Vali Acc: 0.554 Test Loss: 1.206 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5981149673461914
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.283 Vali Acc: 0.568 Test Loss: 1.283 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7991721630096436
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.537285566329956
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.260 Vali Acc: 0.554 Test Loss: 1.260 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8478481769561768
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.282 Vali Acc: 0.554 Test Loss: 1.282 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6625442504882812
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.296 Vali Acc: 0.581 Test Loss: 1.296 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 21 cost time: 0.6907322406768799
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.276 Vali Acc: 0.581 Test Loss: 1.276 Test Acc: 0.581
Validation loss decreased (-0.581068 --> -0.581068).  Saving model ...
Epoch: 22 cost time: 0.6512815952301025
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.320 Vali Acc: 0.581 Test Loss: 1.320 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5659668445587158
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.376 Vali Acc: 0.581 Test Loss: 1.376 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6895477771759033
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.362 Vali Acc: 0.595 Test Loss: 1.362 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594581).  Saving model ...
Epoch: 25 cost time: 0.752892017364502
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.335 Vali Acc: 0.595 Test Loss: 1.335 Test Acc: 0.595
Validation loss decreased (-0.594581 --> -0.594581).  Saving model ...
Epoch: 26 cost time: 0.7055742740631104
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.347 Vali Acc: 0.581 Test Loss: 1.347 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4931776523590088
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.581 Test Loss: 1.350 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6693215370178223
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.595 Test Loss: 1.349 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7476437091827393
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.360 Vali Acc: 0.595 Test Loss: 1.360 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7071239948272705
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.368 Vali Acc: 0.595 Test Loss: 1.368 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5734257698059082
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.595 Test Loss: 1.394 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8075051307678223
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.405 Vali Acc: 0.595 Test Loss: 1.405 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5980994701385498
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.595 Test Loss: 1.394 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7382485866546631
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.381 Vali Acc: 0.595 Test Loss: 1.381 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7589645385742188
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.396 Vali Acc: 0.581 Test Loss: 1.396 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 44345860
model size : 183.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.759579658508301
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.373 Vali Acc: 0.270 Test Loss: 1.373 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 1.3170816898345947
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.286 Vali Acc: 0.446 Test Loss: 1.286 Test Acc: 0.446
Validation loss decreased (-0.270257 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.8245794773101807
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.293 Vali Acc: 0.405 Test Loss: 1.293 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1097455024719238
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.2893869876861572
Epoch: 5, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5692191123962402
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.077 Vali Acc: 0.541 Test Loss: 1.077 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 1.1531550884246826
Epoch: 7, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.045863151550293
Epoch: 8, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.354 Vali Acc: 0.459 Test Loss: 1.354 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1150126457214355
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.132 Vali Acc: 0.554 Test Loss: 1.132 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.009460210800171
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.452 Vali Acc: 0.514 Test Loss: 1.452 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4366652965545654
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.249 Vali Acc: 0.581 Test Loss: 1.249 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 0.7795958518981934
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.569 Vali Acc: 0.541 Test Loss: 1.569 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3441846370697021
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.414 Vali Acc: 0.581 Test Loss: 1.414 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.387460470199585
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.457 Vali Acc: 0.527 Test Loss: 1.457 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1683619022369385
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.513 Vali Acc: 0.541 Test Loss: 1.513 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6080412864685059
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.594 Vali Acc: 0.568 Test Loss: 1.594 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4854629039764404
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.578 Vali Acc: 0.541 Test Loss: 1.578 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.369446039199829
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.554 Test Loss: 1.587 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.150580644607544
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.554 Test Loss: 1.606 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1066226959228516
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.568 Test Loss: 1.600 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3987243175506592
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.581 Test Loss: 1.565 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 44553220
model size : 184.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.488137722015381
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.387 Vali Acc: 0.324 Test Loss: 1.387 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.0662355422973633
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.370 Vali Acc: 0.338 Test Loss: 1.370 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.9987871646881104
Epoch: 3, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.304 Vali Acc: 0.405 Test Loss: 1.304 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.339878797531128
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1526930332183838
Epoch: 5, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.244 Vali Acc: 0.392 Test Loss: 1.244 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0334203243255615
Epoch: 6, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.214 Vali Acc: 0.459 Test Loss: 1.214 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.310180425643921
Epoch: 7, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.204 Vali Acc: 0.486 Test Loss: 1.204 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 0.9528946876525879
Epoch: 8, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.282 Vali Acc: 0.473 Test Loss: 1.282 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0041632652282715
Epoch: 9, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.329 Vali Acc: 0.473 Test Loss: 1.329 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.573192834854126
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.477 Vali Acc: 0.446 Test Loss: 1.477 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.206596851348877
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.143589973449707
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.676 Vali Acc: 0.473 Test Loss: 1.676 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0880258083343506
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.743 Vali Acc: 0.432 Test Loss: 1.743 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0338342189788818
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.692 Vali Acc: 0.473 Test Loss: 1.692 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0479469299316406
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.739 Vali Acc: 0.432 Test Loss: 1.739 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.711275577545166
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.738 Vali Acc: 0.473 Test Loss: 1.738 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7705256938934326
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.562 Vali Acc: 0.419 Test Loss: 1.562 Test Acc: 0.419
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 44488708
model size : 184.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1761209964752197
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.600813627243042
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.324 Vali Acc: 0.405 Test Loss: 1.324 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.7072339057922363
Epoch: 3, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.286 Vali Acc: 0.446 Test Loss: 1.286 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.8663742542266846
Epoch: 4, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.252 Vali Acc: 0.405 Test Loss: 1.252 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7775037288665771
Epoch: 5, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.6831269264221191
Epoch: 6, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.5392804145812988
Epoch: 7, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.118 Vali Acc: 0.446 Test Loss: 1.118 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5496561527252197
Epoch: 8, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.122 Vali Acc: 0.473 Test Loss: 1.122 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5664002895355225
Epoch: 9, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.100 Vali Acc: 0.473 Test Loss: 1.100 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5781364440917969
Epoch: 10, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.133 Vali Acc: 0.486 Test Loss: 1.133 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5778980255126953
Epoch: 11, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.141 Vali Acc: 0.541 Test Loss: 1.141 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 0.590935230255127
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7265481948852539
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6048274040222168
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8900597095489502
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6463813781738281
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.224 Vali Acc: 0.527 Test Loss: 1.224 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8982822895050049
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.265 Vali Acc: 0.581 Test Loss: 1.265 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581068).  Saving model ...
Epoch: 18 cost time: 0.8729748725891113
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.260 Vali Acc: 0.608 Test Loss: 1.260 Test Acc: 0.608
Validation loss decreased (-0.581068 --> -0.608096).  Saving model ...
Epoch: 19 cost time: 0.9054934978485107
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.273 Vali Acc: 0.581 Test Loss: 1.273 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.909116268157959
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.321 Vali Acc: 0.581 Test Loss: 1.321 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0053744316101074
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.297 Vali Acc: 0.541 Test Loss: 1.297 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6191079616546631
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.292 Vali Acc: 0.541 Test Loss: 1.292 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7070956230163574
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.349 Vali Acc: 0.554 Test Loss: 1.349 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7746562957763672
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.317 Vali Acc: 0.568 Test Loss: 1.317 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7481818199157715
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.290 Vali Acc: 0.554 Test Loss: 1.290 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8322515487670898
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.284 Vali Acc: 0.554 Test Loss: 1.284 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8056941032409668
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.302 Vali Acc: 0.554 Test Loss: 1.302 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6602025032043457
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 44451844
model size : 184.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2966525554656982
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.399 Vali Acc: 0.297 Test Loss: 1.399 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.6086876392364502
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.331 Vali Acc: 0.311 Test Loss: 1.331 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.5890297889709473
Epoch: 3, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.258 Vali Acc: 0.459 Test Loss: 1.258 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.828214168548584
Epoch: 4, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8393092155456543
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7546820640563965
Epoch: 6, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.317 Vali Acc: 0.446 Test Loss: 1.317 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.681663990020752
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7608764171600342
Epoch: 8, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9397153854370117
Epoch: 9, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.307 Vali Acc: 0.459 Test Loss: 1.307 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5744383335113525
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6777775287628174
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7387001514434814
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.515 Vali Acc: 0.473 Test Loss: 1.515 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5867457389831543
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.345 Vali Acc: 0.568 Test Loss: 1.345 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567554).  Saving model ...
Epoch: 14 cost time: 1.5259227752685547
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9916114807128906
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.475 Vali Acc: 0.554 Test Loss: 1.475 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8097591400146484
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.422 Vali Acc: 0.568 Test Loss: 1.422 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6788628101348877
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.365 Vali Acc: 0.581 Test Loss: 1.365 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 18 cost time: 0.7235162258148193
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.360 Vali Acc: 0.568 Test Loss: 1.360 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6907908916473389
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.581 Test Loss: 1.396 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7170889377593994
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.453 Vali Acc: 0.568 Test Loss: 1.453 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9578793048858643
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.554 Test Loss: 1.485 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9531445503234863
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.568 Test Loss: 1.489 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3014745712280273
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.473 Vali Acc: 0.554 Test Loss: 1.473 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9539780616760254
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.581 Test Loss: 1.463 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3266618251800537
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.472 Vali Acc: 0.568 Test Loss: 1.472 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8611719608306885
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.456 Vali Acc: 0.568 Test Loss: 1.456 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8131189346313477
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.568 Test Loss: 1.471 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 44654596
model size : 185.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4071290493011475
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.426 Vali Acc: 0.270 Test Loss: 1.426 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0801289081573486
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.325 Vali Acc: 0.446 Test Loss: 1.325 Test Acc: 0.446
Validation loss decreased (-0.270256 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.9308204650878906
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.307 Vali Acc: 0.432 Test Loss: 1.307 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9796600341796875
Epoch: 4, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.229 Vali Acc: 0.459 Test Loss: 1.229 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.8210160732269287
Epoch: 5, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.7584235668182373
Epoch: 6, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.6505036354064941
Epoch: 7, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.076 Vali Acc: 0.514 Test Loss: 1.076 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5671951770782471
Epoch: 8, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.8667869567871094
Epoch: 9, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.195 Vali Acc: 0.568 Test Loss: 1.195 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6087846755981445
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.179 Vali Acc: 0.568 Test Loss: 1.179 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.733818769454956
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.074 Vali Acc: 0.622 Test Loss: 1.074 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 0.9005069732666016
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7757439613342285
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7040507793426514
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.247 Vali Acc: 0.473 Test Loss: 1.247 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8326709270477295
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.292 Vali Acc: 0.514 Test Loss: 1.292 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7835876941680908
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.315 Vali Acc: 0.514 Test Loss: 1.315 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.692845344543457
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.276 Vali Acc: 0.568 Test Loss: 1.276 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7816572189331055
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.282 Vali Acc: 0.541 Test Loss: 1.282 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7925729751586914
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.278 Vali Acc: 0.541 Test Loss: 1.278 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.597053050994873
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.284 Vali Acc: 0.514 Test Loss: 1.284 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7177565097808838
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.284 Vali Acc: 0.514 Test Loss: 1.284 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 44599300
model size : 184.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.909048080444336
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.353 Vali Acc: 0.270 Test Loss: 1.353 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.603264331817627
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.351 Vali Acc: 0.338 Test Loss: 1.351 Test Acc: 0.338
Validation loss decreased (-0.270257 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.6446471214294434
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
Validation loss decreased (-0.337824 --> -0.527014).  Saving model ...
Epoch: 4 cost time: 0.6509613990783691
Epoch: 4, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.642890214920044
Epoch: 5, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
Validation loss decreased (-0.527014 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.6106791496276855
Epoch: 6, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.147 Vali Acc: 0.541 Test Loss: 1.147 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.6607120037078857
Epoch: 7, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.6554100513458252
Epoch: 8, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 0.6106243133544922
Epoch: 9, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7118003368377686
Epoch: 10, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.141 Vali Acc: 0.581 Test Loss: 1.141 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.721503734588623
Epoch: 11, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6560750007629395
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.134 Vali Acc: 0.595 Test Loss: 1.134 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6274511814117432
Epoch: 13, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.246 Vali Acc: 0.568 Test Loss: 1.246 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9477064609527588
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.354 Vali Acc: 0.541 Test Loss: 1.354 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7683331966400146
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.225 Vali Acc: 0.608 Test Loss: 1.225 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8240633010864258
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.203 Vali Acc: 0.622 Test Loss: 1.203 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7289319038391113
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.282 Vali Acc: 0.581 Test Loss: 1.282 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6612570285797119
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.309 Vali Acc: 0.568 Test Loss: 1.309 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 44567044
model size : 184.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4051241874694824
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.450 Vali Acc: 0.257 Test Loss: 1.450 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.0719943046569824
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.326 Vali Acc: 0.473 Test Loss: 1.326 Test Acc: 0.473
Validation loss decreased (-0.256742 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.9867866039276123
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.0367133617401123
Epoch: 4, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8206179141998291
Epoch: 5, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7143585681915283
Epoch: 6, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7882571220397949
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.291 Vali Acc: 0.473 Test Loss: 1.291 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.739680290222168
Epoch: 8, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7631447315216064
Epoch: 9, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.223515272140503
Epoch: 10, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.339 Vali Acc: 0.486 Test Loss: 1.339 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8993353843688965
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.473 Vali Acc: 0.486 Test Loss: 1.473 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.784144401550293
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.316 Vali Acc: 0.581 Test Loss: 1.316 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581068).  Saving model ...
Epoch: 13 cost time: 0.7796862125396729
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8072340488433838
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.403 Vali Acc: 0.595 Test Loss: 1.403 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594581).  Saving model ...
Epoch: 15 cost time: 0.7554278373718262
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.459 Vali Acc: 0.568 Test Loss: 1.459 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.803642988204956
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.552 Vali Acc: 0.581 Test Loss: 1.552 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8375723361968994
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.608 Test Loss: 1.542 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608093).  Saving model ...
Epoch: 18 cost time: 0.6976816654205322
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.538 Vali Acc: 0.595 Test Loss: 1.538 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.688422679901123
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.513 Vali Acc: 0.608 Test Loss: 1.513 Test Acc: 0.608
Validation loss decreased (-0.608093 --> -0.608093).  Saving model ...
Epoch: 20 cost time: 0.7092158794403076
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.510 Vali Acc: 0.595 Test Loss: 1.510 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7094526290893555
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.595 Test Loss: 1.530 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8612625598907471
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.608 Test Loss: 1.544 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7131056785583496
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.608 Test Loss: 1.535 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5819065570831299
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.608 Test Loss: 1.529 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6785125732421875
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.608 Test Loss: 1.519 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7703495025634766
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.608 Test Loss: 1.503 Test Acc: 0.608
Validation loss decreased (-0.608093 --> -0.608093).  Saving model ...
Epoch: 27 cost time: 0.9535083770751953
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.518 Vali Acc: 0.622 Test Loss: 1.518 Test Acc: 0.622
Validation loss decreased (-0.608093 --> -0.621606).  Saving model ...
Epoch: 28 cost time: 0.6511545181274414
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.622 Test Loss: 1.527 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6948282718658447
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.622 Test Loss: 1.536 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6842362880706787
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.608 Test Loss: 1.547 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6981658935546875
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.540 Vali Acc: 0.635 Test Loss: 1.540 Test Acc: 0.635
Validation loss decreased (-0.621606 --> -0.635120).  Saving model ...
Epoch: 32 cost time: 0.8327109813690186
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.635 Test Loss: 1.545 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8519864082336426
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.635 Test Loss: 1.547 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6968271732330322
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.608 Test Loss: 1.557 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7799723148345947
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.622 Test Loss: 1.567 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5898985862731934
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.622 Test Loss: 1.575 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.668367862701416
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.622 Test Loss: 1.578 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0762362480163574
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.622 Test Loss: 1.580 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7688338756561279
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.622 Test Loss: 1.574 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6681950092315674
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.635 Test Loss: 1.554 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6880588531494141
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.649 Test Loss: 1.527 Test Acc: 0.649
Validation loss decreased (-0.635120 --> -0.648633).  Saving model ...
Epoch: 42 cost time: 0.8322134017944336
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.649 Test Loss: 1.530 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7139551639556885
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.649 Test Loss: 1.552 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6861960887908936
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.635 Test Loss: 1.571 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6607167720794678
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.635 Test Loss: 1.587 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6640768051147461
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.635 Test Loss: 1.596 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.085540771484375
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.635 Test Loss: 1.594 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.775632381439209
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.635 Test Loss: 1.594 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9854247570037842
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.649 Test Loss: 1.597 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.757178783416748
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.649 Test Loss: 1.602 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 44820484
model size : 185.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4352831840515137
Epoch: 1, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.379 Vali Acc: 0.338 Test Loss: 1.379 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.8722779750823975
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6333684921264648
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.351 Vali Acc: 0.338 Test Loss: 1.351 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.5912632942199707
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.242 Vali Acc: 0.486 Test Loss: 1.242 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.7017240524291992
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.288 Vali Acc: 0.405 Test Loss: 1.288 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8369045257568359
Epoch: 6, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.6801416873931885
Epoch: 7, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.163 Vali Acc: 0.568 Test Loss: 1.163 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.7089395523071289
Epoch: 8, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.213 Vali Acc: 0.581 Test Loss: 1.213 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 0.8153820037841797
Epoch: 9, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.122 Vali Acc: 0.649 Test Loss: 1.122 Test Acc: 0.649
Validation loss decreased (-0.581069 --> -0.648637).  Saving model ...
Epoch: 10 cost time: 1.0147409439086914
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.332 Vali Acc: 0.581 Test Loss: 1.332 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9046962261199951
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.284 Vali Acc: 0.581 Test Loss: 1.284 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6773943901062012
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.267 Vali Acc: 0.581 Test Loss: 1.267 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2799513339996338
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.318 Vali Acc: 0.595 Test Loss: 1.318 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9258301258087158
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.264 Vali Acc: 0.622 Test Loss: 1.264 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8770389556884766
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.293 Vali Acc: 0.622 Test Loss: 1.293 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.785811185836792
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.345 Vali Acc: 0.608 Test Loss: 1.345 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1418933868408203
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.361 Vali Acc: 0.622 Test Loss: 1.361 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8134396076202393
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.335 Vali Acc: 0.622 Test Loss: 1.335 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8881363868713379
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.360 Vali Acc: 0.622 Test Loss: 1.360 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 44769796
model size : 185.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1441149711608887
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.406 Vali Acc: 0.230 Test Loss: 1.406 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.7973802089691162
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.379 Vali Acc: 0.378 Test Loss: 1.379 Test Acc: 0.378
Validation loss decreased (-0.229716 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.6786184310913086
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.351 Vali Acc: 0.378 Test Loss: 1.351 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.5859405994415283
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.326 Vali Acc: 0.392 Test Loss: 1.326 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.8086483478546143
Epoch: 5, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.6948037147521973
Epoch: 6, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.7663722038269043
Epoch: 7, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.203 Vali Acc: 0.486 Test Loss: 1.203 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 0.7192244529724121
Epoch: 8, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.89475417137146
Epoch: 9, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.707636833190918
Epoch: 10, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 0.7413942813873291
Epoch: 11, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6774816513061523
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0053646564483643
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.257 Vali Acc: 0.554 Test Loss: 1.257 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7001564502716064
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8553311824798584
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.248 Vali Acc: 0.527 Test Loss: 1.248 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5254497528076172
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.313 Vali Acc: 0.514 Test Loss: 1.313 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6403138637542725
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.312 Vali Acc: 0.541 Test Loss: 1.312 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8045499324798584
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.297 Vali Acc: 0.541 Test Loss: 1.297 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7248904705047607
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7182958126068115
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.316 Vali Acc: 0.541 Test Loss: 1.316 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 44742148
model size : 185.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.449500799179077
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.388 Vali Acc: 0.270 Test Loss: 1.388 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.6177899837493896
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.345 Vali Acc: 0.392 Test Loss: 1.345 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.1631360054016113
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.267 Vali Acc: 0.446 Test Loss: 1.267 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.4776456356048584
Epoch: 4, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.216 Vali Acc: 0.432 Test Loss: 1.216 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5426149368286133
Epoch: 5, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.146 Vali Acc: 0.446 Test Loss: 1.146 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.3495750427246094
Epoch: 6, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.1846380233764648
Epoch: 7, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.230 Vali Acc: 0.541 Test Loss: 1.230 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 1.1397888660430908
Epoch: 8, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.6228289604187012
Epoch: 9, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581069).  Saving model ...
Epoch: 10 cost time: 0.8781437873840332
Epoch: 10, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.450 Vali Acc: 0.527 Test Loss: 1.450 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9772469997406006
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.306 Vali Acc: 0.541 Test Loss: 1.306 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4865729808807373
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.483 Vali Acc: 0.581 Test Loss: 1.483 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.696068525314331
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.504 Vali Acc: 0.527 Test Loss: 1.504 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0126585960388184
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.554 Vali Acc: 0.500 Test Loss: 1.554 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3554515838623047
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.569 Vali Acc: 0.541 Test Loss: 1.569 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7328252792358398
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.580 Vali Acc: 0.554 Test Loss: 1.580 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.06095552444458
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.618 Vali Acc: 0.541 Test Loss: 1.618 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2953433990478516
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.640 Vali Acc: 0.514 Test Loss: 1.640 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3710167407989502
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.695 Vali Acc: 0.527 Test Loss: 1.695 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 45014020
model size : 186.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.062565565109253
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.413 Vali Acc: 0.189 Test Loss: 1.413 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.7994296550750732
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.351 Vali Acc: 0.338 Test Loss: 1.351 Test Acc: 0.338
Validation loss decreased (-0.189175 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.8085992336273193
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.333 Vali Acc: 0.378 Test Loss: 1.333 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.6960418224334717
Epoch: 4, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 0.6772799491882324
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.204 Vali Acc: 0.459 Test Loss: 1.204 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8222010135650635
Epoch: 6, Steps: 10 | Train Loss: 0.800 Vali Loss: 1.225 Vali Acc: 0.405 Test Loss: 1.225 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3619434833526611
Epoch: 7, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.120 Vali Acc: 0.486 Test Loss: 1.120 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.7847862243652344
Epoch: 8, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.149 Vali Acc: 0.432 Test Loss: 1.149 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6387724876403809
Epoch: 9, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 0.7540404796600342
Epoch: 10, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8925991058349609
Epoch: 11, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.273 Vali Acc: 0.459 Test Loss: 1.273 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6739804744720459
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.287 Vali Acc: 0.514 Test Loss: 1.287 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7816305160522461
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.270 Vali Acc: 0.514 Test Loss: 1.270 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9351406097412109
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.334 Vali Acc: 0.486 Test Loss: 1.334 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8795955181121826
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.236 Vali Acc: 0.554 Test Loss: 1.236 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 16 cost time: 1.058539867401123
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.231 Vali Acc: 0.554 Test Loss: 1.231 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 17 cost time: 0.8796489238739014
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.217 Vali Acc: 0.581 Test Loss: 1.217 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 18 cost time: 1.1619510650634766
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.242 Vali Acc: 0.568 Test Loss: 1.242 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0745415687561035
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.267 Vali Acc: 0.541 Test Loss: 1.267 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8408923149108887
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.292 Vali Acc: 0.527 Test Loss: 1.292 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7753803730010986
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.296 Vali Acc: 0.514 Test Loss: 1.296 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8172245025634766
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6707727909088135
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.302 Vali Acc: 0.541 Test Loss: 1.302 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0428543090820312
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.287 Vali Acc: 0.554 Test Loss: 1.287 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8110909461975098
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7679617404937744
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.275 Vali Acc: 0.514 Test Loss: 1.275 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9576280117034912
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.281 Vali Acc: 0.541 Test Loss: 1.281 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 44967940
model size : 186.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9474296569824219
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.896918535232544
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.315 Vali Acc: 0.392 Test Loss: 1.315 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7059602737426758
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527014).  Saving model ...
Epoch: 4 cost time: 0.774832010269165
Epoch: 4, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
Validation loss decreased (-0.527014 --> -0.567555).  Saving model ...
Epoch: 5 cost time: 0.8269174098968506
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7360918521881104
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.651045560836792
Epoch: 7, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
Validation loss decreased (-0.567555 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.8000154495239258
Epoch: 8, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.123 Vali Acc: 0.486 Test Loss: 1.123 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8346445560455322
Epoch: 9, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6327841281890869
Epoch: 10, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7529127597808838
Epoch: 11, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.622847318649292
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6539702415466309
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.103 Vali Acc: 0.581 Test Loss: 1.103 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 0.8481276035308838
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6226997375488281
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.201 Vali Acc: 0.568 Test Loss: 1.201 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7888104915618896
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.210 Vali Acc: 0.581 Test Loss: 1.210 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7143874168395996
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6543984413146973
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.180 Vali Acc: 0.581 Test Loss: 1.180 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6265826225280762
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.200 Vali Acc: 0.581 Test Loss: 1.200 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6540842056274414
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.223 Vali Acc: 0.595 Test Loss: 1.223 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 21 cost time: 0.7946290969848633
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.230 Vali Acc: 0.595 Test Loss: 1.230 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7352850437164307
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.223 Vali Acc: 0.581 Test Loss: 1.223 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8868212699890137
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.214 Vali Acc: 0.595 Test Loss: 1.214 Test Acc: 0.595
Validation loss decreased (-0.594582 --> -0.594582).  Saving model ...
Epoch: 24 cost time: 1.0520930290222168
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.206 Vali Acc: 0.608 Test Loss: 1.206 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608096).  Saving model ...
Epoch: 25 cost time: 0.8269922733306885
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.217 Vali Acc: 0.595 Test Loss: 1.217 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7729480266571045
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.232 Vali Acc: 0.622 Test Loss: 1.232 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621609).  Saving model ...
Epoch: 27 cost time: 0.7314753532409668
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.252 Vali Acc: 0.622 Test Loss: 1.252 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7492759227752686
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.258 Vali Acc: 0.608 Test Loss: 1.258 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7705321311950684
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.253 Vali Acc: 0.595 Test Loss: 1.253 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7345666885375977
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.265 Vali Acc: 0.581 Test Loss: 1.265 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7342212200164795
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.265 Vali Acc: 0.595 Test Loss: 1.265 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.88321852684021
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.268 Vali Acc: 0.595 Test Loss: 1.268 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8579216003417969
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.280 Vali Acc: 0.595 Test Loss: 1.280 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9210176467895508
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.595 Test Loss: 1.288 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8255565166473389
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.595 Test Loss: 1.293 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6417903900146484
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 44944900
model size : 186.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3009939193725586
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.404 Vali Acc: 0.230 Test Loss: 1.404 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.7569799423217773
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.340 Vali Acc: 0.311 Test Loss: 1.340 Test Acc: 0.311
Validation loss decreased (-0.229716 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.8455572128295898
Epoch: 3, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.309 Vali Acc: 0.338 Test Loss: 1.309 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.8731873035430908
Epoch: 4, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.225 Vali Acc: 0.392 Test Loss: 1.225 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391880).  Saving model ...
Epoch: 5 cost time: 0.917482852935791
Epoch: 5, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.191 Vali Acc: 0.446 Test Loss: 1.191 Test Acc: 0.446
Validation loss decreased (-0.391880 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.4382476806640625
Epoch: 6, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.180 Vali Acc: 0.486 Test Loss: 1.180 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.9688842296600342
Epoch: 7, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.078446388244629
Epoch: 8, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.196 Vali Acc: 0.486 Test Loss: 1.196 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.815654993057251
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.240 Vali Acc: 0.541 Test Loss: 1.240 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 0.8309087753295898
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.312 Vali Acc: 0.608 Test Loss: 1.312 Test Acc: 0.608
Validation loss decreased (-0.540528 --> -0.608095).  Saving model ...
Epoch: 11 cost time: 1.0626516342163086
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.181 Vali Acc: 0.595 Test Loss: 1.181 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4508779048919678
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.196 Vali Acc: 0.595 Test Loss: 1.196 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2403926849365234
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.372 Vali Acc: 0.581 Test Loss: 1.372 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9626510143280029
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.377 Vali Acc: 0.568 Test Loss: 1.377 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.889220952987671
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.330 Vali Acc: 0.568 Test Loss: 1.330 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0450429916381836
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.323 Vali Acc: 0.595 Test Loss: 1.323 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0271902084350586
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9366114139556885
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0886938571929932
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.287 Vali Acc: 0.568 Test Loss: 1.287 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1383309364318848
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.581 Test Loss: 1.291 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 45299716
model size : 187.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.271735191345215
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.7702732086181641
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.321 Vali Acc: 0.459 Test Loss: 1.321 Test Acc: 0.459
Validation loss decreased (-0.243229 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.7259752750396729
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.279 Vali Acc: 0.473 Test Loss: 1.279 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.7130353450775146
Epoch: 4, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.281 Vali Acc: 0.459 Test Loss: 1.281 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7315635681152344
Epoch: 5, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.158 Vali Acc: 0.568 Test Loss: 1.158 Test Acc: 0.568
Validation loss decreased (-0.472960 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.6999819278717041
Epoch: 6, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6624040603637695
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8155779838562012
Epoch: 8, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.111 Vali Acc: 0.527 Test Loss: 1.111 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7382471561431885
Epoch: 9, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6308982372283936
Epoch: 10, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6485211849212646
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.109 Vali Acc: 0.581 Test Loss: 1.109 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 0.7867498397827148
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 0.7535839080810547
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.192 Vali Acc: 0.595 Test Loss: 1.192 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8992733955383301
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.282 Vali Acc: 0.514 Test Loss: 1.282 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7165567874908447
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6709191799163818
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.271 Vali Acc: 0.541 Test Loss: 1.271 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6618692874908447
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.328 Vali Acc: 0.554 Test Loss: 1.328 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7319080829620361
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.321 Vali Acc: 0.527 Test Loss: 1.321 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7296922206878662
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.329 Vali Acc: 0.514 Test Loss: 1.329 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8580741882324219
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.351 Vali Acc: 0.527 Test Loss: 1.351 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6754171848297119
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.360 Vali Acc: 0.554 Test Loss: 1.360 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8583991527557373
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.345 Vali Acc: 0.554 Test Loss: 1.345 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 45262852
model size : 187.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3100290298461914
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.407 Vali Acc: 0.176 Test Loss: 1.407 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 0.8447108268737793
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.333 Vali Acc: 0.324 Test Loss: 1.333 Test Acc: 0.324
Validation loss decreased (-0.175662 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.6778278350830078
Epoch: 3, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.281 Vali Acc: 0.432 Test Loss: 1.281 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.6325321197509766
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.249 Vali Acc: 0.459 Test Loss: 1.249 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.6920483112335205
Epoch: 5, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
Validation loss decreased (-0.459447 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.9040839672088623
Epoch: 6, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6270251274108887
Epoch: 7, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.082 Vali Acc: 0.527 Test Loss: 1.082 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5415730476379395
Epoch: 8, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.055 Vali Acc: 0.527 Test Loss: 1.055 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5528726577758789
Epoch: 9, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.054 Vali Acc: 0.581 Test Loss: 1.054 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.6493504047393799
Epoch: 10, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.029 Vali Acc: 0.649 Test Loss: 1.029 Test Acc: 0.649
Validation loss decreased (-0.581071 --> -0.648638).  Saving model ...
Epoch: 11 cost time: 0.7268581390380859
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7999515533447266
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.977 Vali Acc: 0.608 Test Loss: 0.977 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6140046119689941
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6308550834655762
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5580859184265137
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.145 Vali Acc: 0.622 Test Loss: 1.145 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7335171699523926
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.159 Vali Acc: 0.608 Test Loss: 1.159 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.564795970916748
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.144 Vali Acc: 0.635 Test Loss: 1.144 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6880958080291748
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.135 Vali Acc: 0.635 Test Loss: 1.135 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6579551696777344
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.137 Vali Acc: 0.622 Test Loss: 1.137 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6688947677612305
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.150 Vali Acc: 0.608 Test Loss: 1.150 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el6_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 45244420
model size : 187.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5189270973205566
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.7687020301818848
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.305 Vali Acc: 0.405 Test Loss: 1.305 Test Acc: 0.405
Validation loss decreased (-0.243229 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.464336633682251
Epoch: 3, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.503 Vali Acc: 0.365 Test Loss: 1.503 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4823112487792969
Epoch: 4, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.514 Vali Acc: 0.284 Test Loss: 1.514 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1540172100067139
Epoch: 5, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.111 Vali Acc: 0.514 Test Loss: 1.111 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.362163782119751
Epoch: 6, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.243 Vali Acc: 0.486 Test Loss: 1.243 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.287442922592163
Epoch: 7, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.484 Vali Acc: 0.500 Test Loss: 1.484 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0058939456939697
Epoch: 8, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.580 Vali Acc: 0.486 Test Loss: 1.580 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9530162811279297
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 2.660 Vali Acc: 0.500 Test Loss: 2.660 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0540196895599365
Epoch: 10, Steps: 10 | Train Loss: 0.087 Vali Loss: 2.078 Vali Acc: 0.527 Test Loss: 2.078 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527006).  Saving model ...
Epoch: 11 cost time: 1.1743381023406982
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.989 Vali Acc: 0.568 Test Loss: 1.989 Test Acc: 0.568
Validation loss decreased (-0.527006 --> -0.567548).  Saving model ...
Epoch: 12 cost time: 1.0355064868927002
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 2.637 Vali Acc: 0.486 Test Loss: 2.637 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.106137990951538
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.138 Vali Acc: 0.500 Test Loss: 3.138 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9218940734863281
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.827 Vali Acc: 0.541 Test Loss: 2.827 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0844526290893555
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.924 Vali Acc: 0.514 Test Loss: 2.924 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.237156391143799
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.720 Vali Acc: 0.527 Test Loss: 2.720 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5534656047821045
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.821 Vali Acc: 0.541 Test Loss: 2.821 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1797409057617188
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.922 Vali Acc: 0.514 Test Loss: 2.922 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4699962139129639
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.270 Vali Acc: 0.554 Test Loss: 3.270 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4916794300079346
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.398 Vali Acc: 0.541 Test Loss: 3.398 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.159534454345703
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.951 Vali Acc: 0.473 Test Loss: 3.951 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 37105924
model size : 156.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7245852947235107
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.382 Vali Acc: 0.378 Test Loss: 1.382 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.2323994636535645
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.413 Vali Acc: 0.297 Test Loss: 1.413 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5170044898986816
Epoch: 3, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.292 Vali Acc: 0.419 Test Loss: 1.292 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.9664795398712158
Epoch: 4, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.009403944015503
Epoch: 5, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9069418907165527
Epoch: 6, Steps: 10 | Train Loss: 0.816 Vali Loss: 1.116 Vali Acc: 0.473 Test Loss: 1.116 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.273207664489746
Epoch: 7, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.204 Vali Acc: 0.473 Test Loss: 1.204 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9745588302612305
Epoch: 8, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.344 Vali Acc: 0.459 Test Loss: 1.344 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7047173976898193
Epoch: 9, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.604 Vali Acc: 0.500 Test Loss: 1.604 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499984).  Saving model ...
Epoch: 10 cost time: 1.5465781688690186
Epoch: 10, Steps: 10 | Train Loss: 0.122 Vali Loss: 2.058 Vali Acc: 0.446 Test Loss: 2.058 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.395155429840088
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.648 Vali Acc: 0.541 Test Loss: 1.648 Test Acc: 0.541
Validation loss decreased (-0.499984 --> -0.540524).  Saving model ...
Epoch: 12 cost time: 1.0485374927520752
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.741 Vali Acc: 0.541 Test Loss: 1.741 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9172520637512207
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.865 Vali Acc: 0.541 Test Loss: 1.865 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1896212100982666
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.635 Vali Acc: 0.568 Test Loss: 1.635 Test Acc: 0.568
Validation loss decreased (-0.540524 --> -0.567551).  Saving model ...
Epoch: 15 cost time: 1.4474191665649414
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.468 Vali Acc: 0.568 Test Loss: 1.468 Test Acc: 0.568
Validation loss decreased (-0.567551 --> -0.567553).  Saving model ...
Epoch: 16 cost time: 1.1364033222198486
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.604 Vali Acc: 0.622 Test Loss: 1.604 Test Acc: 0.622
Validation loss decreased (-0.567553 --> -0.621606).  Saving model ...
Epoch: 17 cost time: 1.054471731185913
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.726 Vali Acc: 0.595 Test Loss: 1.726 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.017117977142334
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.461 Vali Acc: 0.527 Test Loss: 1.461 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1446096897125244
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.841 Vali Acc: 0.595 Test Loss: 1.841 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0875554084777832
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.635 Test Loss: 1.815 Test Acc: 0.635
Validation loss decreased (-0.621606 --> -0.635117).  Saving model ...
Epoch: 21 cost time: 1.0136141777038574
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.581 Test Loss: 1.653 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4896984100341797
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.581 Test Loss: 1.685 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9807844161987305
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.581 Test Loss: 1.689 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0584633350372314
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.608 Test Loss: 1.705 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7973790168762207
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.608 Test Loss: 1.727 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4302191734313965
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.595 Test Loss: 1.770 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.026228666305542
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.581 Test Loss: 1.784 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2507190704345703
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.581 Test Loss: 1.780 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0355985164642334
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.595 Test Loss: 1.777 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.278557300567627
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.595 Test Loss: 1.771 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 36884740
model size : 155.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.509216547012329
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.8540949821472168
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.370 Vali Acc: 0.230 Test Loss: 1.370 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1937065124511719
Epoch: 3, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.331 Vali Acc: 0.311 Test Loss: 1.331 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310798).  Saving model ...
Epoch: 4 cost time: 0.8495757579803467
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.262 Vali Acc: 0.351 Test Loss: 1.262 Test Acc: 0.351
Validation loss decreased (-0.310798 --> -0.351339).  Saving model ...
Epoch: 5 cost time: 0.8058269023895264
Epoch: 5, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
Validation loss decreased (-0.351339 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.0493738651275635
Epoch: 6, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.162 Vali Acc: 0.554 Test Loss: 1.162 Test Acc: 0.554
Validation loss decreased (-0.432420 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.8837192058563232
Epoch: 7, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.211 Vali Acc: 0.419 Test Loss: 1.211 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.566962480545044
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.176 Vali Acc: 0.486 Test Loss: 1.176 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7286961078643799
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.329 Vali Acc: 0.446 Test Loss: 1.329 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9226629734039307
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.281 Vali Acc: 0.527 Test Loss: 1.281 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2463414669036865
Epoch: 11, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.341 Vali Acc: 0.486 Test Loss: 1.341 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1075406074523926
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.361 Vali Acc: 0.527 Test Loss: 1.361 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0589096546173096
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.732 Vali Acc: 0.486 Test Loss: 1.732 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1415657997131348
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.414 Vali Acc: 0.541 Test Loss: 1.414 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9424176216125488
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7115497589111328
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.231 Vali Acc: 0.514 Test Loss: 1.231 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 36774148
model size : 154.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.872053384780884
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.404 Vali Acc: 0.378 Test Loss: 1.404 Test Acc: 0.378
Validation loss decreased (inf --> -0.378364).  Saving model ...
Epoch: 2 cost time: 1.384251594543457
Epoch: 2, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.456 Vali Acc: 0.284 Test Loss: 1.456 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.40594482421875
Epoch: 3, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.426 Vali Acc: 0.459 Test Loss: 1.426 Test Acc: 0.459
Validation loss decreased (-0.378364 --> -0.459445).  Saving model ...
Epoch: 4 cost time: 1.0621025562286377
Epoch: 4, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.667 Vali Acc: 0.230 Test Loss: 1.667 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1247978210449219
Epoch: 5, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.251 Vali Acc: 0.486 Test Loss: 1.251 Test Acc: 0.486
Validation loss decreased (-0.459445 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.8738105297088623
Epoch: 6, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.505 Vali Acc: 0.500 Test Loss: 1.505 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499985).  Saving model ...
Epoch: 7 cost time: 1.1439545154571533
Epoch: 7, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
Validation loss decreased (-0.499985 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.3205323219299316
Epoch: 8, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.650 Vali Acc: 0.473 Test Loss: 1.650 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8988566398620605
Epoch: 9, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.672 Vali Acc: 0.514 Test Loss: 1.672 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2770147323608398
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 2.108 Vali Acc: 0.446 Test Loss: 2.108 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2623157501220703
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.292 Vali Acc: 0.527 Test Loss: 2.292 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527004).  Saving model ...
Epoch: 12 cost time: 1.2020454406738281
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.740 Vali Acc: 0.459 Test Loss: 2.740 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8334574699401855
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.093 Vali Acc: 0.581 Test Loss: 2.093 Test Acc: 0.581
Validation loss decreased (-0.527004 --> -0.581060).  Saving model ...
Epoch: 14 cost time: 1.5631177425384521
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.708 Vali Acc: 0.554 Test Loss: 2.708 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5916962623596191
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.396 Vali Acc: 0.554 Test Loss: 2.396 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0681920051574707
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.667 Vali Acc: 0.514 Test Loss: 2.667 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4212677478790283
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.585 Vali Acc: 0.568 Test Loss: 2.585 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.493422031402588
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.501 Vali Acc: 0.568 Test Loss: 2.501 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.047743320465088
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.543 Vali Acc: 0.568 Test Loss: 2.543 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0782802104949951
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.591 Vali Acc: 0.595 Test Loss: 2.591 Test Acc: 0.595
Validation loss decreased (-0.581060 --> -0.594569).  Saving model ...
Epoch: 21 cost time: 1.2386555671691895
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.634 Vali Acc: 0.581 Test Loss: 2.634 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.368812084197998
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.603 Vali Acc: 0.568 Test Loss: 2.603 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6893775463104248
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.593 Vali Acc: 0.581 Test Loss: 2.593 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3172309398651123
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.585 Vali Acc: 0.568 Test Loss: 2.585 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7421491146087646
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.574 Vali Acc: 0.568 Test Loss: 2.574 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4853787422180176
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.568 Vali Acc: 0.568 Test Loss: 2.568 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3707754611968994
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.548 Vali Acc: 0.581 Test Loss: 2.548 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1585853099822998
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.544 Vali Acc: 0.568 Test Loss: 2.544 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.287125825881958
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.546 Vali Acc: 0.568 Test Loss: 2.546 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2984638214111328
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.550 Vali Acc: 0.568 Test Loss: 2.550 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 37036804
model size : 155.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3719427585601807
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.450 Vali Acc: 0.216 Test Loss: 1.450 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.9216032028198242
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 0.6191177368164062
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.798412561416626
Epoch: 4, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.322 Vali Acc: 0.405 Test Loss: 1.322 Test Acc: 0.405
Validation loss decreased (-0.337825 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.9361062049865723
Epoch: 5, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.212 Vali Acc: 0.405 Test Loss: 1.212 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.9305546283721924
Epoch: 6, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.4762935638427734
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.267 Vali Acc: 0.473 Test Loss: 1.267 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0247714519500732
Epoch: 8, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.825 Vali Acc: 0.378 Test Loss: 1.825 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7404937744140625
Epoch: 9, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.477 Vali Acc: 0.473 Test Loss: 1.477 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8386147022247314
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.437 Vali Acc: 0.514 Test Loss: 1.437 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513499).  Saving model ...
Epoch: 11 cost time: 0.6239910125732422
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
Validation loss decreased (-0.513499 --> -0.527012).  Saving model ...
Epoch: 12 cost time: 1.0088531970977783
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.689 Vali Acc: 0.514 Test Loss: 1.689 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1230437755584717
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.632 Vali Acc: 0.514 Test Loss: 1.632 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.943286657333374
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.746 Vali Acc: 0.486 Test Loss: 1.746 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6320970058441162
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.781 Vali Acc: 0.527 Test Loss: 1.781 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7480363845825195
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.859 Vali Acc: 0.514 Test Loss: 1.859 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7311813831329346
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.091 Vali Acc: 0.527 Test Loss: 2.091 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8585023880004883
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.964 Vali Acc: 0.514 Test Loss: 1.964 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.670212984085083
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.071 Vali Acc: 0.541 Test Loss: 2.071 Test Acc: 0.541
Validation loss decreased (-0.527012 --> -0.540520).  Saving model ...
Epoch: 20 cost time: 0.8314170837402344
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.046 Vali Acc: 0.541 Test Loss: 2.046 Test Acc: 0.541
Validation loss decreased (-0.540520 --> -0.540520).  Saving model ...
Epoch: 21 cost time: 0.9532101154327393
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.045 Vali Acc: 0.514 Test Loss: 2.045 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7242140769958496
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.997 Vali Acc: 0.527 Test Loss: 1.997 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7531938552856445
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.010 Vali Acc: 0.554 Test Loss: 2.010 Test Acc: 0.554
Validation loss decreased (-0.540520 --> -0.554034).  Saving model ...
Epoch: 24 cost time: 0.6097817420959473
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.007 Vali Acc: 0.527 Test Loss: 2.007 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7976677417755127
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.527 Test Loss: 1.966 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9422345161437988
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.541 Test Loss: 1.964 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7573494911193848
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.514 Test Loss: 1.967 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0718989372253418
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.992 Vali Acc: 0.514 Test Loss: 1.992 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5124897956848145
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.514 Test Loss: 2.012 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9131314754486084
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.514 Test Loss: 1.990 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2275300025939941
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.527 Test Loss: 1.972 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2818489074707031
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.976 Vali Acc: 0.527 Test Loss: 1.976 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0559265613555908
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.527 Test Loss: 1.990 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 36880132
model size : 155.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.33376407623291
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.402 Vali Acc: 0.216 Test Loss: 1.402 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.0704395771026611
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.380 Vali Acc: 0.392 Test Loss: 1.380 Test Acc: 0.392
Validation loss decreased (-0.216202 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 0.8264908790588379
Epoch: 3, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.399 Vali Acc: 0.324 Test Loss: 1.399 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6813864707946777
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.285 Vali Acc: 0.392 Test Loss: 1.285 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.6895551681518555
Epoch: 5, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.311 Vali Acc: 0.378 Test Loss: 1.311 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8069047927856445
Epoch: 6, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.6794648170471191
Epoch: 7, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.261 Vali Acc: 0.459 Test Loss: 1.261 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6612410545349121
Epoch: 8, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6877341270446777
Epoch: 9, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.416 Vali Acc: 0.514 Test Loss: 1.416 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513499).  Saving model ...
Epoch: 10 cost time: 0.8062856197357178
Epoch: 10, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.788128137588501
Epoch: 11, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.275 Vali Acc: 0.541 Test Loss: 1.275 Test Acc: 0.541
Validation loss decreased (-0.513499 --> -0.540528).  Saving model ...
Epoch: 12 cost time: 0.5527184009552002
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.282 Vali Acc: 0.473 Test Loss: 1.282 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5277891159057617
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5396308898925781
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.465 Vali Acc: 0.514 Test Loss: 1.465 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6080143451690674
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.366 Vali Acc: 0.568 Test Loss: 1.366 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567554).  Saving model ...
Epoch: 16 cost time: 1.070857048034668
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.536 Vali Acc: 0.541 Test Loss: 1.536 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7492349147796631
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.541 Vali Acc: 0.554 Test Loss: 1.541 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6351916790008545
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.480 Vali Acc: 0.568 Test Loss: 1.480 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6312518119812012
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.507 Vali Acc: 0.581 Test Loss: 1.507 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581066).  Saving model ...
Epoch: 20 cost time: 0.5678489208221436
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.475 Vali Acc: 0.595 Test Loss: 1.475 Test Acc: 0.595
Validation loss decreased (-0.581066 --> -0.594580).  Saving model ...
Epoch: 21 cost time: 0.8992586135864258
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.464 Vali Acc: 0.581 Test Loss: 1.464 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7114741802215576
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.527 Vali Acc: 0.568 Test Loss: 1.527 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6513605117797852
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.503 Vali Acc: 0.581 Test Loss: 1.503 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7701115608215332
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.554 Test Loss: 1.492 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.754976749420166
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.531 Vali Acc: 0.568 Test Loss: 1.531 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7287693023681641
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.556 Vali Acc: 0.554 Test Loss: 1.556 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4905669689178467
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.581 Test Loss: 1.524 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6760642528533936
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.581 Test Loss: 1.530 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6720519065856934
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.523 Vali Acc: 0.568 Test Loss: 1.523 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7882676124572754
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.568 Test Loss: 1.544 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 36787972
model size : 155.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6127917766571045
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.455 Vali Acc: 0.216 Test Loss: 1.455 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.3698458671569824
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.426 Vali Acc: 0.311 Test Loss: 1.426 Test Acc: 0.311
Validation loss decreased (-0.216202 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.2020111083984375
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.4044981002807617
Epoch: 4, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.222 Vali Acc: 0.419 Test Loss: 1.222 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0475337505340576
Epoch: 5, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.8745639324188232
Epoch: 6, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.401 Vali Acc: 0.514 Test Loss: 1.401 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513500).  Saving model ...
Epoch: 7 cost time: 1.3987348079681396
Epoch: 7, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.839 Vali Acc: 0.459 Test Loss: 1.839 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5052332878112793
Epoch: 8, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.590 Vali Acc: 0.459 Test Loss: 1.590 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2274713516235352
Epoch: 9, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.700 Vali Acc: 0.595 Test Loss: 1.700 Test Acc: 0.595
Validation loss decreased (-0.513500 --> -0.594578).  Saving model ...
Epoch: 10 cost time: 1.0769596099853516
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.703 Vali Acc: 0.568 Test Loss: 1.703 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4080531597137451
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.728 Vali Acc: 0.527 Test Loss: 1.728 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.551954984664917
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.890 Vali Acc: 0.486 Test Loss: 2.890 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.744816780090332
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.075 Vali Acc: 0.568 Test Loss: 2.075 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3014531135559082
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.355 Vali Acc: 0.514 Test Loss: 2.355 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1018280982971191
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.636 Vali Acc: 0.500 Test Loss: 2.636 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5230164527893066
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.419 Vali Acc: 0.500 Test Loss: 2.419 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1523306369781494
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.305 Vali Acc: 0.527 Test Loss: 2.305 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.613067626953125
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.300 Vali Acc: 0.541 Test Loss: 2.300 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4538943767547607
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.527 Test Loss: 2.331 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 37059844
model size : 156.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.193101167678833
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.354 Vali Acc: 0.365 Test Loss: 1.354 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 0.9564957618713379
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.338 Vali Acc: 0.311 Test Loss: 1.338 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2050490379333496
Epoch: 3, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.281 Vali Acc: 0.365 Test Loss: 1.281 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.088003158569336
Epoch: 4, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.218 Vali Acc: 0.419 Test Loss: 1.218 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 0.6917448043823242
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.194 Vali Acc: 0.459 Test Loss: 1.194 Test Acc: 0.459
Validation loss decreased (-0.418907 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 1.1195719242095947
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.9554822444915771
Epoch: 7, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.339 Vali Acc: 0.459 Test Loss: 1.339 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0249462127685547
Epoch: 8, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.475 Vali Acc: 0.500 Test Loss: 1.475 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7344381809234619
Epoch: 9, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.404 Vali Acc: 0.459 Test Loss: 1.404 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8018453121185303
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.302 Vali Acc: 0.514 Test Loss: 1.302 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8831512928009033
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.423 Vali Acc: 0.568 Test Loss: 1.423 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567553).  Saving model ...
Epoch: 12 cost time: 0.9061355590820312
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.682 Vali Acc: 0.527 Test Loss: 1.682 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0748631954193115
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.354801893234253
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.573 Vali Acc: 0.581 Test Loss: 1.573 Test Acc: 0.581
Validation loss decreased (-0.567553 --> -0.581065).  Saving model ...
Epoch: 15 cost time: 1.0219395160675049
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.618 Vali Acc: 0.554 Test Loss: 1.618 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6160500049591064
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.481 Vali Acc: 0.581 Test Loss: 1.481 Test Acc: 0.581
Validation loss decreased (-0.581065 --> -0.581066).  Saving model ...
Epoch: 17 cost time: 0.6580727100372314
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.518 Vali Acc: 0.568 Test Loss: 1.518 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0592105388641357
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.560 Vali Acc: 0.608 Test Loss: 1.560 Test Acc: 0.608
Validation loss decreased (-0.581066 --> -0.608093).  Saving model ...
Epoch: 19 cost time: 1.1401450634002686
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.608 Test Loss: 1.576 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.583728551864624
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.546 Vali Acc: 0.595 Test Loss: 1.546 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0968093872070312
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.533 Vali Acc: 0.622 Test Loss: 1.533 Test Acc: 0.622
Validation loss decreased (-0.608093 --> -0.621606).  Saving model ...
Epoch: 22 cost time: 1.0070347785949707
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.608 Test Loss: 1.557 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3051419258117676
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.608 Test Loss: 1.601 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.840139389038086
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.595 Test Loss: 1.625 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2846980094909668
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.581 Test Loss: 1.616 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4333257675170898
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.622 Test Loss: 1.579 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4803273677825928
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.635 Test Loss: 1.562 Test Acc: 0.635
Validation loss decreased (-0.621606 --> -0.635120).  Saving model ...
Epoch: 28 cost time: 1.6499886512756348
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.622 Test Loss: 1.563 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4830117225646973
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.566 Vali Acc: 0.635 Test Loss: 1.566 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0959904193878174
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.635 Test Loss: 1.567 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.38240647315979
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.594 Vali Acc: 0.635 Test Loss: 1.594 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0236384868621826
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.622 Test Loss: 1.607 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.074599027633667
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.608 Test Loss: 1.610 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.6253325939178467
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.635 Test Loss: 1.607 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8441150188446045
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.635 Test Loss: 1.579 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1156468391418457
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.635 Test Loss: 1.579 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.575031042098999
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.608 Test Loss: 1.591 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 36903172
model size : 155.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.424196720123291
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.390 Vali Acc: 0.338 Test Loss: 1.390 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.7088241577148438
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.447 Vali Acc: 0.297 Test Loss: 1.447 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7118411064147949
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.299 Vali Acc: 0.486 Test Loss: 1.299 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 0.7164318561553955
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.339 Vali Acc: 0.351 Test Loss: 1.339 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8503684997558594
Epoch: 5, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.486473 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8112294673919678
Epoch: 6, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.187 Vali Acc: 0.473 Test Loss: 1.187 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9665489196777344
Epoch: 7, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.107 Vali Acc: 0.486 Test Loss: 1.107 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7046380043029785
Epoch: 8, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.118 Vali Acc: 0.486 Test Loss: 1.118 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6480667591094971
Epoch: 9, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.6325817108154297
Epoch: 10, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.8176932334899902
Epoch: 11, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6646978855133057
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7798323631286621
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.329 Vali Acc: 0.568 Test Loss: 1.329 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567554).  Saving model ...
Epoch: 14 cost time: 0.8498115539550781
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6585409641265869
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.263 Vali Acc: 0.581 Test Loss: 1.263 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581068).  Saving model ...
Epoch: 16 cost time: 0.5829212665557861
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.295 Vali Acc: 0.554 Test Loss: 1.295 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5990927219390869
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.327 Vali Acc: 0.554 Test Loss: 1.327 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5050396919250488
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.331 Vali Acc: 0.554 Test Loss: 1.331 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.542489767074585
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.273 Vali Acc: 0.581 Test Loss: 1.273 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5072708129882812
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.286 Vali Acc: 0.581 Test Loss: 1.286 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5080554485321045
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.349 Vali Acc: 0.568 Test Loss: 1.349 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6094436645507812
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.334 Vali Acc: 0.554 Test Loss: 1.334 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7080671787261963
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.304 Vali Acc: 0.608 Test Loss: 1.304 Test Acc: 0.608
Validation loss decreased (-0.581068 --> -0.608095).  Saving model ...
Epoch: 24 cost time: 0.5254719257354736
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.339 Vali Acc: 0.595 Test Loss: 1.339 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5228495597839355
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.364 Vali Acc: 0.595 Test Loss: 1.364 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6400234699249268
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.352 Vali Acc: 0.581 Test Loss: 1.352 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7023468017578125
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.595 Test Loss: 1.392 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.812608003616333
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.608 Test Loss: 1.379 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2972009181976318
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.356 Vali Acc: 0.595 Test Loss: 1.356 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7700684070587158
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.595 Test Loss: 1.336 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6587371826171875
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.347 Vali Acc: 0.595 Test Loss: 1.347 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.873589277267456
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.581 Test Loss: 1.366 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7295119762420654
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.595 Test Loss: 1.401 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 36806404
model size : 155.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.859666585922241
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.432 Vali Acc: 0.203 Test Loss: 1.432 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.414022445678711
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.532 Vali Acc: 0.230 Test Loss: 1.532 Test Acc: 0.230
Validation loss decreased (-0.202688 --> -0.229714).  Saving model ...
Epoch: 3 cost time: 1.5589919090270996
Epoch: 3, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.477 Vali Acc: 0.324 Test Loss: 1.477 Test Acc: 0.324
Validation loss decreased (-0.229714 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.6659417152404785
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.186 Vali Acc: 0.446 Test Loss: 1.186 Test Acc: 0.446
Validation loss decreased (-0.324310 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.5885231494903564
Epoch: 5, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.7098610401153564
Epoch: 6, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.6796379089355469
Epoch: 7, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.488 Vali Acc: 0.500 Test Loss: 1.488 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1488237380981445
Epoch: 8, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.652 Vali Acc: 0.500 Test Loss: 1.652 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.26633620262146
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.541 Vali Acc: 0.554 Test Loss: 1.541 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554039).  Saving model ...
Epoch: 10 cost time: 1.1107044219970703
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.794 Vali Acc: 0.514 Test Loss: 1.794 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0955588817596436
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.220 Vali Acc: 0.473 Test Loss: 2.220 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9078099727630615
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.842 Vali Acc: 0.568 Test Loss: 1.842 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567549).  Saving model ...
Epoch: 13 cost time: 1.395162582397461
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.131 Vali Acc: 0.514 Test Loss: 2.131 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1527228355407715
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.868 Vali Acc: 0.527 Test Loss: 1.868 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1116607189178467
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.927 Vali Acc: 0.500 Test Loss: 1.927 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0706255435943604
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.905 Vali Acc: 0.514 Test Loss: 1.905 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.280151605606079
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.196 Vali Acc: 0.527 Test Loss: 2.196 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0147349834442139
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.112 Vali Acc: 0.541 Test Loss: 2.112 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1771998405456543
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.554 Test Loss: 1.967 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4648847579956055
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.907 Vali Acc: 0.554 Test Loss: 1.907 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6688003540039062
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.500 Test Loss: 1.986 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2935664653778076
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.514 Test Loss: 1.958 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 37082884
model size : 156.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0867531299591064
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.400 Vali Acc: 0.230 Test Loss: 1.400 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.6051750183105469
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.356 Vali Acc: 0.284 Test Loss: 1.356 Test Acc: 0.284
Validation loss decreased (-0.229716 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.792534589767456
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.307 Vali Acc: 0.432 Test Loss: 1.307 Test Acc: 0.432
Validation loss decreased (-0.283770 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 1.2978272438049316
Epoch: 4, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.363 Vali Acc: 0.392 Test Loss: 1.363 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7025809288024902
Epoch: 5, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.9671711921691895
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.158 Vali Acc: 0.446 Test Loss: 1.158 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8996210098266602
Epoch: 7, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.684 Vali Acc: 0.419 Test Loss: 1.684 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1774802207946777
Epoch: 8, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527013).  Saving model ...
Epoch: 9 cost time: 0.9250509738922119
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 0.9420907497406006
Epoch: 10, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.403 Vali Acc: 0.514 Test Loss: 1.403 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9064006805419922
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.488 Vali Acc: 0.514 Test Loss: 1.488 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1530683040618896
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.612 Vali Acc: 0.527 Test Loss: 1.612 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2765130996704102
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.511 Vali Acc: 0.527 Test Loss: 1.511 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9845380783081055
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.586 Vali Acc: 0.595 Test Loss: 1.586 Test Acc: 0.595
Validation loss decreased (-0.540528 --> -0.594579).  Saving model ...
Epoch: 15 cost time: 0.9108211994171143
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.519 Vali Acc: 0.595 Test Loss: 1.519 Test Acc: 0.595
Validation loss decreased (-0.594579 --> -0.594579).  Saving model ...
Epoch: 16 cost time: 1.172785997390747
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.546 Vali Acc: 0.568 Test Loss: 1.546 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8482303619384766
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.581 Test Loss: 1.585 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7794144153594971
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.582 Vali Acc: 0.568 Test Loss: 1.582 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8194160461425781
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.554 Test Loss: 1.543 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.937136173248291
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.568 Test Loss: 1.552 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6016671657562256
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.581 Test Loss: 1.620 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.798924446105957
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.650 Vali Acc: 0.581 Test Loss: 1.650 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4284870624542236
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.581 Test Loss: 1.615 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2643449306488037
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.568 Test Loss: 1.602 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9045114517211914
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.607 Vali Acc: 0.581 Test Loss: 1.607 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 36907780
model size : 155.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0764005184173584
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.338 Vali Acc: 0.392 Test Loss: 1.338 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 0.8978486061096191
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8577609062194824
Epoch: 3, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.314 Vali Acc: 0.392 Test Loss: 1.314 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8885226249694824
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.249 Vali Acc: 0.446 Test Loss: 1.249 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.112410306930542
Epoch: 5, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.6927344799041748
Epoch: 6, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.114 Vali Acc: 0.486 Test Loss: 1.114 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7819805145263672
Epoch: 7, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.133 Vali Acc: 0.514 Test Loss: 1.133 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.970606803894043
Epoch: 8, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.252 Vali Acc: 0.554 Test Loss: 1.252 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 0.7332398891448975
Epoch: 9, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6707851886749268
Epoch: 10, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.245 Vali Acc: 0.473 Test Loss: 1.245 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9476816654205322
Epoch: 11, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 12 cost time: 1.1092100143432617
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.195 Vali Acc: 0.554 Test Loss: 1.195 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8039062023162842
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.150 Vali Acc: 0.608 Test Loss: 1.150 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 0.7447161674499512
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.376 Vali Acc: 0.514 Test Loss: 1.376 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8240649700164795
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.180 Vali Acc: 0.581 Test Loss: 1.180 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9789571762084961
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.360 Vali Acc: 0.541 Test Loss: 1.360 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7235267162322998
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.343 Vali Acc: 0.622 Test Loss: 1.343 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621608).  Saving model ...
Epoch: 18 cost time: 1.1448590755462646
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.252 Vali Acc: 0.595 Test Loss: 1.252 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9476504325866699
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.314 Vali Acc: 0.568 Test Loss: 1.314 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0461125373840332
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.322 Vali Acc: 0.608 Test Loss: 1.322 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6208231449127197
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.247 Vali Acc: 0.608 Test Loss: 1.247 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9000911712646484
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.254 Vali Acc: 0.622 Test Loss: 1.254 Test Acc: 0.622
Validation loss decreased (-0.621608 --> -0.621609).  Saving model ...
Epoch: 23 cost time: 0.7349205017089844
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.327 Vali Acc: 0.581 Test Loss: 1.327 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6985599994659424
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.595 Test Loss: 1.293 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9015803337097168
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.304 Vali Acc: 0.608 Test Loss: 1.304 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.480712890625
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.302 Vali Acc: 0.608 Test Loss: 1.302 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8175568580627441
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.290 Vali Acc: 0.595 Test Loss: 1.290 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7211589813232422
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.253 Vali Acc: 0.581 Test Loss: 1.253 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7191619873046875
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.622 Test Loss: 1.240 Test Acc: 0.622
Validation loss decreased (-0.621609 --> -0.621609).  Saving model ...
Epoch: 30 cost time: 0.9116647243499756
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.635 Test Loss: 1.243 Test Acc: 0.635
Validation loss decreased (-0.621609 --> -0.635123).  Saving model ...
Epoch: 31 cost time: 0.8450617790222168
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.260 Vali Acc: 0.622 Test Loss: 1.260 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6115589141845703
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.286 Vali Acc: 0.608 Test Loss: 1.286 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8071186542510986
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.608 Test Loss: 1.307 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6960206031799316
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.303 Vali Acc: 0.608 Test Loss: 1.303 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7592246532440186
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.608 Test Loss: 1.296 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.847278356552124
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.312 Vali Acc: 0.595 Test Loss: 1.312 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1663093566894531
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.595 Test Loss: 1.292 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7967226505279541
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.595 Test Loss: 1.281 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6604316234588623
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.277 Vali Acc: 0.608 Test Loss: 1.277 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6296534538269043
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.595 Test Loss: 1.322 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 36824836
model size : 155.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1184263229370117
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.400 Vali Acc: 0.176 Test Loss: 1.400 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 2.075840473175049
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.244 Vali Acc: 0.446 Test Loss: 1.244 Test Acc: 0.446
Validation loss decreased (-0.175662 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 1.4320671558380127
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.269 Vali Acc: 0.446 Test Loss: 1.269 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1568076610565186
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.405 Vali Acc: 0.338 Test Loss: 1.405 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.763601303100586
Epoch: 5, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.239 Vali Acc: 0.527 Test Loss: 1.239 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.6821939945220947
Epoch: 6, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.390 Vali Acc: 0.500 Test Loss: 1.390 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6532204151153564
Epoch: 7, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.587 Vali Acc: 0.554 Test Loss: 1.587 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554038).  Saving model ...
Epoch: 8 cost time: 1.4151554107666016
Epoch: 8, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.774 Vali Acc: 0.500 Test Loss: 1.774 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2058639526367188
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.546 Vali Acc: 0.554 Test Loss: 1.546 Test Acc: 0.554
Validation loss decreased (-0.554038 --> -0.554039).  Saving model ...
Epoch: 10 cost time: 1.2919106483459473
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 2.456 Vali Acc: 0.500 Test Loss: 2.456 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4363484382629395
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.571 Vali Acc: 0.486 Test Loss: 1.571 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4108638763427734
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.042 Vali Acc: 0.581 Test Loss: 2.042 Test Acc: 0.581
Validation loss decreased (-0.554039 --> -0.581061).  Saving model ...
Epoch: 13 cost time: 1.9307949542999268
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 2.271 Vali Acc: 0.554 Test Loss: 2.271 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.573632001876831
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.767 Vali Acc: 0.500 Test Loss: 2.767 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3102116584777832
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.509 Vali Acc: 0.541 Test Loss: 2.509 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8571505546569824
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.780 Vali Acc: 0.514 Test Loss: 2.780 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.728395938873291
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.743 Vali Acc: 0.541 Test Loss: 2.743 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1797256469726562
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.521 Vali Acc: 0.486 Test Loss: 2.521 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3288931846618652
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.692 Vali Acc: 0.500 Test Loss: 2.692 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.571744441986084
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.733 Vali Acc: 0.541 Test Loss: 2.733 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6535444259643555
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.574 Vali Acc: 0.527 Test Loss: 2.574 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2125449180603027
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.554 Test Loss: 2.528 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 37105924
model size : 156.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9605941772460938
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.392 Vali Acc: 0.284 Test Loss: 1.392 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1625878810882568
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.378 Vali Acc: 0.351 Test Loss: 1.378 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8432984352111816
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.284 Vali Acc: 0.486 Test Loss: 1.284 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.2333788871765137
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.271 Vali Acc: 0.419 Test Loss: 1.271 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0487823486328125
Epoch: 5, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.9129102230072021
Epoch: 6, Steps: 10 | Train Loss: 0.811 Vali Loss: 1.311 Vali Acc: 0.405 Test Loss: 1.311 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9289178848266602
Epoch: 7, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.448185920715332
Epoch: 8, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7615177631378174
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.386 Vali Acc: 0.514 Test Loss: 1.386 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0409834384918213
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.455 Vali Acc: 0.541 Test Loss: 1.455 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9477736949920654
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.606 Vali Acc: 0.446 Test Loss: 1.606 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7006430625915527
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.907 Vali Acc: 0.486 Test Loss: 1.907 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6403217315673828
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.554 Vali Acc: 0.459 Test Loss: 1.554 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1656060218811035
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.491 Vali Acc: 0.500 Test Loss: 1.491 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8178195953369141
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.465 Vali Acc: 0.554 Test Loss: 1.465 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 36930820
model size : 155.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9475963115692139
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.409 Vali Acc: 0.203 Test Loss: 1.409 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.7380523681640625
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.361 Vali Acc: 0.365 Test Loss: 1.361 Test Acc: 0.365
Validation loss decreased (-0.202689 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 0.6118853092193604
Epoch: 3, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.317 Vali Acc: 0.459 Test Loss: 1.317 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 0.6033852100372314
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.310 Vali Acc: 0.432 Test Loss: 1.310 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0567975044250488
Epoch: 5, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.5931727886199951
Epoch: 6, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.6571528911590576
Epoch: 7, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.5589141845703125
Epoch: 8, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4990983009338379
Epoch: 9, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.327 Vali Acc: 0.486 Test Loss: 1.327 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5296847820281982
Epoch: 10, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.418 Vali Acc: 0.446 Test Loss: 1.418 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7754166126251221
Epoch: 11, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.338 Vali Acc: 0.459 Test Loss: 1.338 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6437673568725586
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.467 Vali Acc: 0.405 Test Loss: 1.467 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.648815393447876
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.542 Vali Acc: 0.486 Test Loss: 1.542 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7049829959869385
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.484 Vali Acc: 0.486 Test Loss: 1.484 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6803972721099854
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.406 Vali Acc: 0.527 Test Loss: 1.406 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527013).  Saving model ...
Epoch: 16 cost time: 0.8972959518432617
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
Validation loss decreased (-0.527013 --> -0.527013).  Saving model ...
Epoch: 17 cost time: 0.8172891139984131
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.428 Vali Acc: 0.568 Test Loss: 1.428 Test Acc: 0.568
Validation loss decreased (-0.527013 --> -0.567553).  Saving model ...
Epoch: 18 cost time: 0.8259720802307129
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.456 Vali Acc: 0.554 Test Loss: 1.456 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0492970943450928
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.415 Vali Acc: 0.568 Test Loss: 1.415 Test Acc: 0.568
Validation loss decreased (-0.567553 --> -0.567553).  Saving model ...
Epoch: 20 cost time: 0.5881516933441162
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.448 Vali Acc: 0.541 Test Loss: 1.448 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2614374160766602
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.443 Vali Acc: 0.541 Test Loss: 1.443 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9462339878082275
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.869347333908081
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.462 Vali Acc: 0.541 Test Loss: 1.462 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7740888595581055
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.462 Vali Acc: 0.554 Test Loss: 1.462 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8584983348846436
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.462 Vali Acc: 0.541 Test Loss: 1.462 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0739514827728271
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.475 Vali Acc: 0.541 Test Loss: 1.475 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8207638263702393
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.554 Test Loss: 1.492 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9650177955627441
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.504 Vali Acc: 0.514 Test Loss: 1.504 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7708308696746826
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.516 Vali Acc: 0.514 Test Loss: 1.516 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 36843268
model size : 155.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2423758506774902
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.308 Vali Acc: 0.473 Test Loss: 1.308 Test Acc: 0.473
Validation loss decreased (inf --> -0.472960).  Saving model ...
Epoch: 2 cost time: 1.1191890239715576
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.323 Vali Acc: 0.270 Test Loss: 1.323 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5253565311431885
Epoch: 3, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.319 Vali Acc: 0.338 Test Loss: 1.319 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.277308702468872
Epoch: 4, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.7840502262115479
Epoch: 5, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.0318634510040283
Epoch: 6, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.7217578887939453
Epoch: 7, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7319216728210449
Epoch: 8, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.322 Vali Acc: 0.554 Test Loss: 1.322 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7614634037017822
Epoch: 9, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.387 Vali Acc: 0.608 Test Loss: 1.387 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608094).  Saving model ...
Epoch: 10 cost time: 1.2360730171203613
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.520 Vali Acc: 0.541 Test Loss: 1.520 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2248413562774658
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.634 Vali Acc: 0.527 Test Loss: 1.634 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9812147617340088
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.569 Vali Acc: 0.514 Test Loss: 2.569 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1632537841796875
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.996 Vali Acc: 0.635 Test Loss: 1.996 Test Acc: 0.635
Validation loss decreased (-0.608094 --> -0.635115).  Saving model ...
Epoch: 14 cost time: 1.57487154006958
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.394 Vali Acc: 0.527 Test Loss: 2.394 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7326219081878662
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.899 Vali Acc: 0.541 Test Loss: 1.899 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.204728603363037
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.490 Vali Acc: 0.568 Test Loss: 2.490 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.02345609664917
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.926 Vali Acc: 0.541 Test Loss: 1.926 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6331579685211182
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.129 Vali Acc: 0.541 Test Loss: 2.129 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.349048376083374
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.563 Vali Acc: 0.541 Test Loss: 2.563 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.318878412246704
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.408 Vali Acc: 0.581 Test Loss: 2.408 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2904844284057617
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.269 Vali Acc: 0.554 Test Loss: 2.269 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6939735412597656
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.294 Vali Acc: 0.568 Test Loss: 2.294 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3797965049743652
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.290 Vali Acc: 0.568 Test Loss: 2.290 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 37092100
model size : 156.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2045257091522217
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.7713751792907715
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.321 Vali Acc: 0.392 Test Loss: 1.321 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.34501051902771
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.330 Vali Acc: 0.446 Test Loss: 1.330 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.7395741939544678
Epoch: 4, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.206 Vali Acc: 0.486 Test Loss: 1.206 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.7859020233154297
Epoch: 5, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.0646007061004639
Epoch: 6, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.259 Vali Acc: 0.432 Test Loss: 1.259 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7912623882293701
Epoch: 7, Steps: 10 | Train Loss: 0.498 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.846893310546875
Epoch: 8, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.112410545349121
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7535183429718018
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.493 Vali Acc: 0.554 Test Loss: 1.493 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554039).  Saving model ...
Epoch: 11 cost time: 0.8076708316802979
Epoch: 11, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1483278274536133
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.662 Vali Acc: 0.514 Test Loss: 1.662 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.790316104888916
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.509 Vali Acc: 0.514 Test Loss: 1.509 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.796424388885498
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.623 Vali Acc: 0.486 Test Loss: 1.623 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7301225662231445
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.756981611251831
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.522 Vali Acc: 0.500 Test Loss: 1.522 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6872620582580566
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.560 Vali Acc: 0.527 Test Loss: 1.560 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6658542156219482
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.486 Test Loss: 1.468 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7155914306640625
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.541 Test Loss: 1.471 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6322102546691895
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.514 Test Loss: 1.526 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 36958468
model size : 155.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.097669839859009
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.405 Vali Acc: 0.203 Test Loss: 1.405 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.7327315807342529
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.407 Vali Acc: 0.203 Test Loss: 1.407 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.87815260887146
Epoch: 3, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.354 Vali Acc: 0.270 Test Loss: 1.354 Test Acc: 0.270
Validation loss decreased (-0.202689 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 0.652580976486206
Epoch: 4, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
Validation loss decreased (-0.270257 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.8615741729736328
Epoch: 5, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.314 Vali Acc: 0.378 Test Loss: 1.314 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7056994438171387
Epoch: 6, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
Validation loss decreased (-0.499987 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 1.1626076698303223
Epoch: 7, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.232 Vali Acc: 0.419 Test Loss: 1.232 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0541629791259766
Epoch: 8, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6913833618164062
Epoch: 9, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3544085025787354
Epoch: 10, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.353 Vali Acc: 0.419 Test Loss: 1.353 Test Acc: 0.419
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5928716659545898
Epoch: 11, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5228197574615479
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.383 Vali Acc: 0.514 Test Loss: 1.383 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.73569655418396
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.253 Vali Acc: 0.541 Test Loss: 1.253 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7716245651245117
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.364 Vali Acc: 0.554 Test Loss: 1.364 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8850502967834473
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.419 Vali Acc: 0.527 Test Loss: 1.419 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.168074131011963
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.329 Vali Acc: 0.554 Test Loss: 1.329 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 36880132
model size : 155.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.023005485534668
Epoch: 1, Steps: 10 | Train Loss: 1.603 Vali Loss: 1.412 Vali Acc: 0.351 Test Loss: 1.412 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 1.897993564605713
Epoch: 2, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.418 Vali Acc: 0.230 Test Loss: 1.418 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.302497386932373
Epoch: 3, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.387 Vali Acc: 0.351 Test Loss: 1.387 Test Acc: 0.351
Validation loss decreased (-0.351337 --> -0.351337).  Saving model ...
Epoch: 4 cost time: 0.8632462024688721
Epoch: 4, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.218 Vali Acc: 0.392 Test Loss: 1.218 Test Acc: 0.392
Validation loss decreased (-0.351337 --> -0.391880).  Saving model ...
Epoch: 5 cost time: 0.962355375289917
Epoch: 5, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.391880 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.065009355545044
Epoch: 6, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.311 Vali Acc: 0.486 Test Loss: 1.311 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.249084234237671
Epoch: 7, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.620 Vali Acc: 0.446 Test Loss: 1.620 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.784055233001709
Epoch: 8, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.783 Vali Acc: 0.473 Test Loss: 1.783 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8377056121826172
Epoch: 9, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.520 Vali Acc: 0.514 Test Loss: 1.520 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513498).  Saving model ...
Epoch: 10 cost time: 1.128161907196045
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.976 Vali Acc: 0.554 Test Loss: 1.976 Test Acc: 0.554
Validation loss decreased (-0.513498 --> -0.554034).  Saving model ...
Epoch: 11 cost time: 1.0723342895507812
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 2.135 Vali Acc: 0.500 Test Loss: 2.135 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9307959079742432
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.951 Vali Acc: 0.514 Test Loss: 1.951 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1604821681976318
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 2.316 Vali Acc: 0.459 Test Loss: 2.316 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8034582138061523
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.790 Vali Acc: 0.568 Test Loss: 1.790 Test Acc: 0.568
Validation loss decreased (-0.554034 --> -0.567550).  Saving model ...
Epoch: 15 cost time: 1.0267999172210693
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.828 Vali Acc: 0.568 Test Loss: 1.828 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8784263134002686
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.855 Vali Acc: 0.595 Test Loss: 1.855 Test Acc: 0.595
Validation loss decreased (-0.567550 --> -0.594576).  Saving model ...
Epoch: 17 cost time: 2.1726129055023193
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.608 Test Loss: 1.852 Test Acc: 0.608
Validation loss decreased (-0.594576 --> -0.608090).  Saving model ...
Epoch: 18 cost time: 1.1029064655303955
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.832 Vali Acc: 0.581 Test Loss: 1.832 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4872968196868896
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.527 Test Loss: 1.835 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4609253406524658
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.527 Test Loss: 1.849 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5008175373077393
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.541 Test Loss: 1.851 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2621231079101562
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.568 Test Loss: 1.854 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2694282531738281
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.568 Test Loss: 1.854 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3948142528533936
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.581 Test Loss: 1.858 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7130451202392578
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.581 Test Loss: 1.853 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2144408226013184
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.581 Test Loss: 1.844 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9050490856170654
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.581 Test Loss: 1.843 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 37110532
model size : 156.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.5759367942810059
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.4119720458984375
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.324 Vali Acc: 0.324 Test Loss: 1.324 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.4616062641143799
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.251 Vali Acc: 0.527 Test Loss: 1.251 Test Acc: 0.527
Validation loss decreased (-0.324311 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 1.5541937351226807
Epoch: 4, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9094488620758057
Epoch: 5, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.183 Vali Acc: 0.541 Test Loss: 1.183 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9567797183990479
Epoch: 6, Steps: 10 | Train Loss: 0.659 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.547149658203125
Epoch: 7, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.537 Vali Acc: 0.459 Test Loss: 1.537 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9137051105499268
Epoch: 8, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.359 Vali Acc: 0.473 Test Loss: 1.359 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5379910469055176
Epoch: 9, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.425 Vali Acc: 0.486 Test Loss: 1.425 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1127538681030273
Epoch: 10, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.584 Vali Acc: 0.486 Test Loss: 1.584 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4283180236816406
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.507 Vali Acc: 0.541 Test Loss: 1.507 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1672062873840332
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.546 Vali Acc: 0.595 Test Loss: 1.546 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594579).  Saving model ...
Epoch: 13 cost time: 1.031282901763916
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.602 Vali Acc: 0.554 Test Loss: 1.602 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4882304668426514
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.703 Vali Acc: 0.554 Test Loss: 1.703 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8857817649841309
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.693 Vali Acc: 0.554 Test Loss: 1.693 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2556066513061523
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.679 Vali Acc: 0.527 Test Loss: 1.679 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9597842693328857
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.694 Vali Acc: 0.581 Test Loss: 1.694 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8374757766723633
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.581 Test Loss: 1.724 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0412952899932861
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.714 Vali Acc: 0.581 Test Loss: 1.714 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7845199108123779
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.568 Test Loss: 1.658 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7046427726745605
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.581 Test Loss: 1.682 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7976808547973633
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.581 Test Loss: 1.695 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 36967684
model size : 155.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.219744920730591
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.382 Vali Acc: 0.405 Test Loss: 1.382 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 0.7648270130157471
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.368 Vali Acc: 0.270 Test Loss: 1.368 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1037564277648926
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.328 Vali Acc: 0.392 Test Loss: 1.328 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9113867282867432
Epoch: 4, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.297 Vali Acc: 0.405 Test Loss: 1.297 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.7811613082885742
Epoch: 5, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.045030117034912
Epoch: 6, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.213 Vali Acc: 0.446 Test Loss: 1.213 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.6942310333251953
Epoch: 7, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.158 Vali Acc: 0.486 Test Loss: 1.158 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.8939769268035889
Epoch: 8, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.0113189220428467
Epoch: 9, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.169 Vali Acc: 0.473 Test Loss: 1.169 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2656922340393066
Epoch: 10, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.199 Vali Acc: 0.459 Test Loss: 1.199 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9326536655426025
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.333 Vali Acc: 0.459 Test Loss: 1.333 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4864332675933838
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 0.6295375823974609
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.418 Vali Acc: 0.473 Test Loss: 1.418 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3868334293365479
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.261 Vali Acc: 0.568 Test Loss: 1.261 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7001798152923584
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.353 Vali Acc: 0.514 Test Loss: 1.353 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9619054794311523
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.349 Vali Acc: 0.527 Test Loss: 1.349 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.709388256072998
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.356 Vali Acc: 0.554 Test Loss: 1.356 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1614961624145508
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.303 Vali Acc: 0.541 Test Loss: 1.303 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8720064163208008
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.346 Vali Acc: 0.527 Test Loss: 1.346 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2668347358703613
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.372 Vali Acc: 0.541 Test Loss: 1.372 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.352038860321045
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.350 Vali Acc: 0.541 Test Loss: 1.350 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.332160472869873
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.440 Vali Acc: 0.541 Test Loss: 1.440 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 36898564
model size : 155.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7547762393951416
Epoch: 1, Steps: 10 | Train Loss: 1.534 Vali Loss: 1.386 Vali Acc: 0.338 Test Loss: 1.386 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.038517951965332
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.0866591930389404
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.214 Vali Acc: 0.486 Test Loss: 1.214 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.0496580600738525
Epoch: 4, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.237 Vali Acc: 0.473 Test Loss: 1.237 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5052378177642822
Epoch: 5, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.427 Vali Acc: 0.514 Test Loss: 1.427 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513499).  Saving model ...
Epoch: 6 cost time: 1.4687118530273438
Epoch: 6, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.957 Vali Acc: 0.338 Test Loss: 1.957 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1864502429962158
Epoch: 7, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.440 Vali Acc: 0.486 Test Loss: 1.440 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3194301128387451
Epoch: 8, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.597 Vali Acc: 0.500 Test Loss: 1.597 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4064302444458008
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.641 Vali Acc: 0.446 Test Loss: 1.641 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7088146209716797
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.209 Vali Acc: 0.419 Test Loss: 2.209 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3864333629608154
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.594 Vali Acc: 0.568 Test Loss: 1.594 Test Acc: 0.568
Validation loss decreased (-0.513499 --> -0.567552).  Saving model ...
Epoch: 12 cost time: 2.121614694595337
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.890 Vali Acc: 0.554 Test Loss: 1.890 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.847032070159912
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.939 Vali Acc: 0.581 Test Loss: 1.939 Test Acc: 0.581
Validation loss decreased (-0.567552 --> -0.581062).  Saving model ...
Epoch: 14 cost time: 1.104288101196289
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.948 Vali Acc: 0.541 Test Loss: 1.948 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0735576152801514
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.130 Vali Acc: 0.514 Test Loss: 2.130 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3402714729309082
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.088 Vali Acc: 0.500 Test Loss: 2.088 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0607819557189941
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.026 Vali Acc: 0.527 Test Loss: 2.026 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1802501678466797
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.177 Vali Acc: 0.446 Test Loss: 2.177 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1330478191375732
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.514 Test Loss: 1.970 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.281540870666504
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.002 Vali Acc: 0.486 Test Loss: 2.002 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7276864051818848
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.046 Vali Acc: 0.514 Test Loss: 2.046 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.959991455078125
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.514 Test Loss: 2.049 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3963956832885742
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.514 Test Loss: 2.038 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 37133572
model size : 156.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.372965097427368
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.398 Vali Acc: 0.324 Test Loss: 1.398 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.1714704036712646
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.332 Vali Acc: 0.351 Test Loss: 1.332 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.2254276275634766
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.282 Vali Acc: 0.459 Test Loss: 1.282 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.0271868705749512
Epoch: 4, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.266 Vali Acc: 0.459 Test Loss: 1.266 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.6697723865509033
Epoch: 5, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.172 Vali Acc: 0.473 Test Loss: 1.172 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.385129690170288
Epoch: 6, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.222 Vali Acc: 0.527 Test Loss: 1.222 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.7944149971008301
Epoch: 7, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.337 Vali Acc: 0.486 Test Loss: 1.337 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6221203804016113
Epoch: 8, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.270 Vali Acc: 0.554 Test Loss: 1.270 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554041).  Saving model ...
Epoch: 9 cost time: 0.7369475364685059
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.295 Vali Acc: 0.581 Test Loss: 1.295 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581068).  Saving model ...
Epoch: 10 cost time: 0.581524133682251
Epoch: 10, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.640 Vali Acc: 0.432 Test Loss: 1.640 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5599286556243896
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.478 Vali Acc: 0.527 Test Loss: 1.478 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9202866554260254
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.466 Vali Acc: 0.514 Test Loss: 1.466 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.757765531539917
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.497 Vali Acc: 0.473 Test Loss: 1.497 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9745323657989502
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.545 Vali Acc: 0.473 Test Loss: 1.545 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6236152648925781
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.550 Vali Acc: 0.486 Test Loss: 1.550 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8616781234741211
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.491 Vali Acc: 0.500 Test Loss: 1.491 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8004839420318604
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.548 Vali Acc: 0.541 Test Loss: 1.548 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8995194435119629
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.530 Vali Acc: 0.514 Test Loss: 1.530 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.684406042098999
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.523 Vali Acc: 0.541 Test Loss: 1.523 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 36990724
model size : 155.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6884524822235107
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.404 Vali Acc: 0.257 Test Loss: 1.404 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.7658290863037109
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.387 Vali Acc: 0.230 Test Loss: 1.387 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.634429931640625
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.353 Vali Acc: 0.338 Test Loss: 1.353 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.7798042297363281
Epoch: 4, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.286 Vali Acc: 0.392 Test Loss: 1.286 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.7903461456298828
Epoch: 5, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.262 Vali Acc: 0.459 Test Loss: 1.262 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8306608200073242
Epoch: 6, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.218 Vali Acc: 0.405 Test Loss: 1.218 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.20961332321167
Epoch: 7, Steps: 10 | Train Loss: 0.760 Vali Loss: 1.233 Vali Acc: 0.419 Test Loss: 1.233 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.097059965133667
Epoch: 8, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.1934900283813477
Epoch: 9, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.222271203994751
Epoch: 10, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7302794456481934
Epoch: 11, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2945985794067383
Epoch: 12, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.273 Vali Acc: 0.459 Test Loss: 1.273 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6136276721954346
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.288 Vali Acc: 0.486 Test Loss: 1.288 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2073626518249512
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.408 Vali Acc: 0.486 Test Loss: 1.408 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9439249038696289
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.376 Vali Acc: 0.568 Test Loss: 1.376 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567554).  Saving model ...
Epoch: 16 cost time: 1.454287052154541
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.432 Vali Acc: 0.541 Test Loss: 1.432 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7394425868988037
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.412 Vali Acc: 0.514 Test Loss: 1.412 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4443068504333496
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.456 Vali Acc: 0.527 Test Loss: 1.456 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7898044586181641
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.450 Vali Acc: 0.554 Test Loss: 1.450 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2072412967681885
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.458 Vali Acc: 0.541 Test Loss: 1.458 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6719534397125244
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.491 Vali Acc: 0.486 Test Loss: 1.491 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6681373119354248
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.492 Vali Acc: 0.514 Test Loss: 1.492 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8139264583587646
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6196825504302979
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.552 Vali Acc: 0.486 Test Loss: 1.552 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5997049808502197
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.554 Test Loss: 1.535 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 36916996
model size : 155.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6217234134674072
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.396 Vali Acc: 0.243 Test Loss: 1.396 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.4472293853759766
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.472 Vali Acc: 0.216 Test Loss: 1.472 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9601247310638428
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.234 Vali Acc: 0.432 Test Loss: 1.234 Test Acc: 0.432
Validation loss decreased (-0.243229 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.2125096321105957
Epoch: 4, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.295 Vali Acc: 0.419 Test Loss: 1.295 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9461443424224854
Epoch: 5, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.206 Vali Acc: 0.446 Test Loss: 1.206 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.0223207473754883
Epoch: 6, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.232 Vali Acc: 0.446 Test Loss: 1.232 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9999752044677734
Epoch: 7, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.358 Vali Acc: 0.514 Test Loss: 1.358 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513500).  Saving model ...
Epoch: 8 cost time: 0.933241605758667
Epoch: 8, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.579 Vali Acc: 0.514 Test Loss: 1.579 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.304305076599121
Epoch: 9, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.965 Vali Acc: 0.500 Test Loss: 1.965 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2445569038391113
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.390 Vali Acc: 0.554 Test Loss: 1.390 Test Acc: 0.554
Validation loss decreased (-0.513500 --> -0.554040).  Saving model ...
Epoch: 11 cost time: 0.9053232669830322
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 2.165 Vali Acc: 0.554 Test Loss: 2.165 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9618439674377441
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.868 Vali Acc: 0.514 Test Loss: 1.868 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.030043601989746
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.467 Vali Acc: 0.554 Test Loss: 1.467 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8694219589233398
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 2.251 Vali Acc: 0.514 Test Loss: 2.251 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0294573307037354
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.888 Vali Acc: 0.568 Test Loss: 1.888 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567549).  Saving model ...
Epoch: 16 cost time: 0.895357608795166
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.988 Vali Acc: 0.554 Test Loss: 1.988 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9697444438934326
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.215 Vali Acc: 0.568 Test Loss: 2.215 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8224561214447021
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.117 Vali Acc: 0.568 Test Loss: 2.117 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0633032321929932
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.974 Vali Acc: 0.554 Test Loss: 1.974 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1846766471862793
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.047 Vali Acc: 0.568 Test Loss: 2.047 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9949338436126709
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.091 Vali Acc: 0.554 Test Loss: 2.091 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0381712913513184
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.095 Vali Acc: 0.554 Test Loss: 2.095 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3236711025238037
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.109 Vali Acc: 0.541 Test Loss: 2.109 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3892335891723633
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.094 Vali Acc: 0.554 Test Loss: 2.094 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0954005718231201
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.061 Vali Acc: 0.554 Test Loss: 2.061 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 37115140
model size : 156.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.203864336013794
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.333 Vali Acc: 0.365 Test Loss: 1.333 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 0.6991782188415527
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.368 Vali Acc: 0.257 Test Loss: 1.368 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8486380577087402
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.269 Vali Acc: 0.446 Test Loss: 1.269 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.7975831031799316
Epoch: 4, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.8025171756744385
Epoch: 5, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.9371316432952881
Epoch: 6, Steps: 10 | Train Loss: 0.730 Vali Loss: 1.059 Vali Acc: 0.486 Test Loss: 1.059 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7678873538970947
Epoch: 7, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.821601152420044
Epoch: 8, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.207 Vali Acc: 0.473 Test Loss: 1.207 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6690292358398438
Epoch: 9, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.369 Vali Acc: 0.514 Test Loss: 1.369 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513500).  Saving model ...
Epoch: 10 cost time: 0.6392598152160645
Epoch: 10, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.399 Vali Acc: 0.500 Test Loss: 1.399 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4970793724060059
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.428 Vali Acc: 0.527 Test Loss: 1.428 Test Acc: 0.527
Validation loss decreased (-0.513500 --> -0.527013).  Saving model ...
Epoch: 12 cost time: 0.6019899845123291
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.403 Vali Acc: 0.568 Test Loss: 1.403 Test Acc: 0.568
Validation loss decreased (-0.527013 --> -0.567554).  Saving model ...
Epoch: 13 cost time: 0.7993941307067871
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.506 Vali Acc: 0.514 Test Loss: 1.506 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5884594917297363
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.615 Vali Acc: 0.541 Test Loss: 1.615 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6085793972015381
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.584 Vali Acc: 0.514 Test Loss: 1.584 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6290950775146484
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.549 Vali Acc: 0.541 Test Loss: 1.549 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6261129379272461
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.533 Vali Acc: 0.568 Test Loss: 1.533 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7465884685516357
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.556 Vali Acc: 0.527 Test Loss: 1.556 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7846853733062744
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.557 Vali Acc: 0.541 Test Loss: 1.557 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6377129554748535
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.573 Vali Acc: 0.554 Test Loss: 1.573 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6197214126586914
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.580 Vali Acc: 0.514 Test Loss: 1.580 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7813215255737305
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.554 Test Loss: 1.587 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 36999940
model size : 155.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2485437393188477
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.393 Vali Acc: 0.243 Test Loss: 1.393 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.546342134475708
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.359 Vali Acc: 0.297 Test Loss: 1.359 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.4219038486480713
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.368 Vali Acc: 0.378 Test Loss: 1.368 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.7674121856689453
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.285 Vali Acc: 0.419 Test Loss: 1.285 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.662693738937378
Epoch: 5, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.284 Vali Acc: 0.338 Test Loss: 1.284 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.261704444885254
Epoch: 6, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.0579760074615479
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.215 Vali Acc: 0.446 Test Loss: 1.215 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1707539558410645
Epoch: 8, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.65824294090271
Epoch: 9, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9213242530822754
Epoch: 10, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.323 Vali Acc: 0.554 Test Loss: 1.323 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554041).  Saving model ...
Epoch: 11 cost time: 0.8669123649597168
Epoch: 11, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.239 Vali Acc: 0.541 Test Loss: 1.239 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7390050888061523
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.191 Vali Acc: 0.581 Test Loss: 1.191 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581069).  Saving model ...
Epoch: 13 cost time: 1.2947323322296143
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.369 Vali Acc: 0.595 Test Loss: 1.369 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594581).  Saving model ...
Epoch: 14 cost time: 1.3474605083465576
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.173 Vali Acc: 0.581 Test Loss: 1.173 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0403382778167725
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.299 Vali Acc: 0.554 Test Loss: 1.299 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.111837387084961
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.257 Vali Acc: 0.595 Test Loss: 1.257 Test Acc: 0.595
Validation loss decreased (-0.594581 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 0.9412052631378174
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.342 Vali Acc: 0.662 Test Loss: 1.342 Test Acc: 0.662
Validation loss decreased (-0.594582 --> -0.662149).  Saving model ...
Epoch: 18 cost time: 0.9107654094696045
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.291 Vali Acc: 0.635 Test Loss: 1.291 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7007477283477783
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.271 Vali Acc: 0.635 Test Loss: 1.271 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7072374820709229
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.315 Vali Acc: 0.635 Test Loss: 1.315 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6983425617218018
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.344 Vali Acc: 0.622 Test Loss: 1.344 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7296442985534668
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.360 Vali Acc: 0.635 Test Loss: 1.360 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7224714756011963
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.349 Vali Acc: 0.649 Test Loss: 1.349 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9483661651611328
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.311 Vali Acc: 0.622 Test Loss: 1.311 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9391312599182129
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.622 Test Loss: 1.321 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.573310136795044
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.371 Vali Acc: 0.649 Test Loss: 1.371 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8825845718383789
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.635 Test Loss: 1.378 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 36940036
model size : 155.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7572219371795654
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.499 Vali Acc: 0.189 Test Loss: 1.499 Test Acc: 0.189
Validation loss decreased (inf --> -0.189174).  Saving model ...
Epoch: 2 cost time: 1.6117103099822998
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.322 Vali Acc: 0.378 Test Loss: 1.322 Test Acc: 0.378
Validation loss decreased (-0.189174 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.372673749923706
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.365 Vali Acc: 0.243 Test Loss: 1.365 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9127638339996338
Epoch: 4, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.250 Vali Acc: 0.338 Test Loss: 1.250 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3616690635681152
Epoch: 5, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.8941650390625
Epoch: 6, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.224 Vali Acc: 0.432 Test Loss: 1.224 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5624275207519531
Epoch: 7, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.474 Vali Acc: 0.405 Test Loss: 1.474 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9659295082092285
Epoch: 8, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.691 Vali Acc: 0.405 Test Loss: 1.691 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9308161735534668
Epoch: 9, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.520 Vali Acc: 0.554 Test Loss: 1.520 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554039).  Saving model ...
Epoch: 10 cost time: 0.9558463096618652
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.581 Vali Acc: 0.541 Test Loss: 1.581 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.255040168762207
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.734 Vali Acc: 0.527 Test Loss: 1.734 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.996258020401001
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.056 Vali Acc: 0.514 Test Loss: 2.056 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.307854175567627
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.220 Vali Acc: 0.500 Test Loss: 2.220 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1679127216339111
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.211 Vali Acc: 0.500 Test Loss: 2.211 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2042160034179688
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.209 Vali Acc: 0.554 Test Loss: 2.209 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.278090238571167
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.086 Vali Acc: 0.527 Test Loss: 2.086 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1869430541992188
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.099 Vali Acc: 0.554 Test Loss: 2.099 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2568793296813965
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.061 Vali Acc: 0.541 Test Loss: 2.061 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4238381385803223
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.098 Vali Acc: 0.568 Test Loss: 2.098 Test Acc: 0.568
Validation loss decreased (-0.554039 --> -0.567547).  Saving model ...
Epoch: 20 cost time: 1.2647731304168701
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.115 Vali Acc: 0.581 Test Loss: 2.115 Test Acc: 0.581
Validation loss decreased (-0.567547 --> -0.581060).  Saving model ...
Epoch: 21 cost time: 1.4698522090911865
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.541 Test Loss: 2.129 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2921717166900635
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.104 Vali Acc: 0.554 Test Loss: 2.104 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2760531902313232
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.099 Vali Acc: 0.568 Test Loss: 2.099 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2314088344573975
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.102 Vali Acc: 0.581 Test Loss: 2.102 Test Acc: 0.581
Validation loss decreased (-0.581060 --> -0.581060).  Saving model ...
Epoch: 25 cost time: 1.1330015659332275
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.097 Vali Acc: 0.554 Test Loss: 2.097 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9664795398712158
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.104 Vali Acc: 0.541 Test Loss: 2.104 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9977900981903076
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.101 Vali Acc: 0.541 Test Loss: 2.101 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7870285511016846
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.091 Vali Acc: 0.581 Test Loss: 2.091 Test Acc: 0.581
Validation loss decreased (-0.581060 --> -0.581060).  Saving model ...
Epoch: 29 cost time: 1.0281734466552734
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.541 Test Loss: 2.092 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1123251914978027
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.101 Vali Acc: 0.527 Test Loss: 2.101 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1300077438354492
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.112 Vali Acc: 0.527 Test Loss: 2.112 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.084312915802002
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.541 Test Loss: 2.120 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9622366428375244
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.119 Vali Acc: 0.541 Test Loss: 2.119 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2002837657928467
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.114 Vali Acc: 0.527 Test Loss: 2.114 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6515684127807617
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.527 Test Loss: 2.111 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8532273769378662
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.118 Vali Acc: 0.541 Test Loss: 2.118 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.903855562210083
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.126 Vali Acc: 0.527 Test Loss: 2.126 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8135173320770264
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.554 Test Loss: 2.141 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 37161220
model size : 156.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.093529462814331
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.356 Vali Acc: 0.378 Test Loss: 1.356 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.7829084396362305
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.356 Vali Acc: 0.324 Test Loss: 1.356 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8259906768798828
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.287 Vali Acc: 0.514 Test Loss: 1.287 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.8417801856994629
Epoch: 4, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48348259925842285
Epoch: 5, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.162 Vali Acc: 0.446 Test Loss: 1.162 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1230874061584473
Epoch: 6, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.093435525894165
Epoch: 7, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2527756690979004
Epoch: 8, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9573745727539062
Epoch: 9, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1941869258880615
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.281 Vali Acc: 0.486 Test Loss: 1.281 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7771680355072021
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.310 Vali Acc: 0.541 Test Loss: 1.310 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540527).  Saving model ...
Epoch: 12 cost time: 0.9848120212554932
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.402 Vali Acc: 0.500 Test Loss: 1.402 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1234021186828613
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.751 Vali Acc: 0.473 Test Loss: 1.751 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9596560001373291
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.694 Vali Acc: 0.486 Test Loss: 1.694 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8701293468475342
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.746 Vali Acc: 0.527 Test Loss: 1.746 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3493211269378662
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.723 Vali Acc: 0.486 Test Loss: 1.723 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1319544315338135
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.702 Vali Acc: 0.554 Test Loss: 1.702 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554037).  Saving model ...
Epoch: 18 cost time: 0.5352077484130859
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.699 Vali Acc: 0.541 Test Loss: 1.699 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9535682201385498
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.675 Vali Acc: 0.554 Test Loss: 1.675 Test Acc: 0.554
Validation loss decreased (-0.554037 --> -0.554037).  Saving model ...
Epoch: 20 cost time: 0.9523270130157471
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.568 Test Loss: 1.704 Test Acc: 0.568
Validation loss decreased (-0.554037 --> -0.567551).  Saving model ...
Epoch: 21 cost time: 0.8057479858398438
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.554 Test Loss: 1.711 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7967269420623779
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.554 Test Loss: 1.684 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7034165859222412
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.541 Test Loss: 1.678 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8375723361968994
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.514 Test Loss: 1.699 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.807929277420044
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.527 Test Loss: 1.717 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8121926784515381
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.568 Test Loss: 1.730 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8008229732513428
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.568 Test Loss: 1.723 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7833592891693115
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.554 Test Loss: 1.708 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9031088352203369
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.527 Test Loss: 1.697 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6971867084503174
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.554 Test Loss: 1.705 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 37036804
model size : 155.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.944596529006958
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.415 Vali Acc: 0.257 Test Loss: 1.415 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.904172420501709
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.333 Vali Acc: 0.419 Test Loss: 1.333 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8866312503814697
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.325 Vali Acc: 0.365 Test Loss: 1.325 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6630985736846924
Epoch: 4, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.314 Vali Acc: 0.338 Test Loss: 1.314 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9028398990631104
Epoch: 5, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.222 Vali Acc: 0.446 Test Loss: 1.222 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.9349799156188965
Epoch: 6, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.228 Vali Acc: 0.419 Test Loss: 1.228 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1202442646026611
Epoch: 7, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.5932340621948242
Epoch: 8, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.709883451461792
Epoch: 9, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.7143588066101074
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.135 Vali Acc: 0.486 Test Loss: 1.135 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6747379302978516
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.187 Vali Acc: 0.608 Test Loss: 1.187 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608096).  Saving model ...
Epoch: 12 cost time: 0.9416298866271973
Epoch: 12, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.144 Vali Acc: 0.568 Test Loss: 1.144 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7243528366088867
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7196543216705322
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.228 Vali Acc: 0.595 Test Loss: 1.228 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6078696250915527
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.296 Vali Acc: 0.554 Test Loss: 1.296 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6627790927886963
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.319 Vali Acc: 0.568 Test Loss: 1.319 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5839579105377197
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.325 Vali Acc: 0.622 Test Loss: 1.325 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621608).  Saving model ...
Epoch: 18 cost time: 0.6728799343109131
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.312 Vali Acc: 0.608 Test Loss: 1.312 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0428197383880615
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.250 Vali Acc: 0.622 Test Loss: 1.250 Test Acc: 0.622
Validation loss decreased (-0.621608 --> -0.621609).  Saving model ...
Epoch: 20 cost time: 0.8719899654388428
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.293 Vali Acc: 0.649 Test Loss: 1.293 Test Acc: 0.649
Validation loss decreased (-0.621609 --> -0.648636).  Saving model ...
Epoch: 21 cost time: 1.0411686897277832
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.319 Vali Acc: 0.649 Test Loss: 1.319 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9388697147369385
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.282 Vali Acc: 0.635 Test Loss: 1.282 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.026902675628662
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.309 Vali Acc: 0.635 Test Loss: 1.309 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6824779510498047
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.364 Vali Acc: 0.649 Test Loss: 1.364 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9176998138427734
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.341 Vali Acc: 0.649 Test Loss: 1.341 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.901421070098877
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.346 Vali Acc: 0.649 Test Loss: 1.346 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.845355749130249
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.356 Vali Acc: 0.649 Test Loss: 1.356 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.171504259109497
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.376 Vali Acc: 0.649 Test Loss: 1.376 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.671083927154541
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.390 Vali Acc: 0.649 Test Loss: 1.390 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2474119663238525
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.635 Test Loss: 1.425 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 36976900
model size : 155.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6892130374908447
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.361 Vali Acc: 0.351 Test Loss: 1.361 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.1063611507415771
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.424 Vali Acc: 0.230 Test Loss: 1.424 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1564171314239502
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.247 Vali Acc: 0.514 Test Loss: 1.247 Test Acc: 0.514
Validation loss decreased (-0.351338 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 2.058079719543457
Epoch: 4, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.137 Vali Acc: 0.473 Test Loss: 1.137 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6100502014160156
Epoch: 5, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9807047843933105
Epoch: 6, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.373 Vali Acc: 0.446 Test Loss: 1.373 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.685523271560669
Epoch: 7, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.726 Vali Acc: 0.459 Test Loss: 1.726 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9738807678222656
Epoch: 8, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.693 Vali Acc: 0.527 Test Loss: 1.693 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527010).  Saving model ...
Epoch: 9 cost time: 1.0635368824005127
Epoch: 9, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.605 Vali Acc: 0.568 Test Loss: 1.605 Test Acc: 0.568
Validation loss decreased (-0.527010 --> -0.567552).  Saving model ...
Epoch: 10 cost time: 1.377838134765625
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.844 Vali Acc: 0.514 Test Loss: 1.844 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.94038987159729
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.910 Vali Acc: 0.541 Test Loss: 1.910 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.565720796585083
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.932 Vali Acc: 0.514 Test Loss: 1.932 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0561504364013672
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.803 Vali Acc: 0.541 Test Loss: 1.803 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8969540596008301
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.949 Vali Acc: 0.527 Test Loss: 1.949 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4606497287750244
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.913 Vali Acc: 0.527 Test Loss: 1.913 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3773024082183838
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.958 Vali Acc: 0.514 Test Loss: 1.958 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1111698150634766
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.975 Vali Acc: 0.527 Test Loss: 1.975 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8920104503631592
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.994 Vali Acc: 0.486 Test Loss: 1.994 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9912033081054688
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.998 Vali Acc: 0.500 Test Loss: 1.998 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 37175044
model size : 156.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0368173122406006
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.421 Vali Acc: 0.189 Test Loss: 1.421 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.6496994495391846
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.337 Vali Acc: 0.405 Test Loss: 1.337 Test Acc: 0.405
Validation loss decreased (-0.189175 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.6964671611785889
Epoch: 3, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.328 Vali Acc: 0.405 Test Loss: 1.328 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.6459884643554688
Epoch: 4, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
Validation loss decreased (-0.405392 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.7614386081695557
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.245 Vali Acc: 0.392 Test Loss: 1.245 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6598308086395264
Epoch: 6, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 0.6494462490081787
Epoch: 7, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6645052433013916
Epoch: 8, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.209 Vali Acc: 0.568 Test Loss: 1.209 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9758989810943604
Epoch: 9, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.314 Vali Acc: 0.500 Test Loss: 1.314 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7614355087280273
Epoch: 10, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9128751754760742
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.286 Vali Acc: 0.581 Test Loss: 1.286 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5014128684997559
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.390 Vali Acc: 0.595 Test Loss: 1.390 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594581).  Saving model ...
Epoch: 13 cost time: 0.7884926795959473
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.514 Vali Acc: 0.581 Test Loss: 1.514 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7881951332092285
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.501 Vali Acc: 0.581 Test Loss: 1.501 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.047332763671875
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.608 Vali Acc: 0.541 Test Loss: 1.608 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6984624862670898
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.643 Vali Acc: 0.541 Test Loss: 1.643 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6646738052368164
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.590 Vali Acc: 0.541 Test Loss: 1.590 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0600481033325195
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.579 Vali Acc: 0.554 Test Loss: 1.579 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7696912288665771
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.565 Vali Acc: 0.554 Test Loss: 1.565 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8031353950500488
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.568 Test Loss: 1.561 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7346737384796143
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.568 Test Loss: 1.567 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6038234233856201
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.541 Test Loss: 1.603 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 37073668
model size : 156.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1273107528686523
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.370 Vali Acc: 0.284 Test Loss: 1.370 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.5338304042816162
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.405 Vali Acc: 0.216 Test Loss: 1.405 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.872809886932373
Epoch: 3, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.341 Vali Acc: 0.324 Test Loss: 1.341 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.5919427871704102
Epoch: 4, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.299 Vali Acc: 0.432 Test Loss: 1.299 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 0.7111258506774902
Epoch: 5, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.262 Vali Acc: 0.378 Test Loss: 1.262 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5532855987548828
Epoch: 6, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.202 Vali Acc: 0.432 Test Loss: 1.202 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 0.5853826999664307
Epoch: 7, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.239 Vali Acc: 0.419 Test Loss: 1.239 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5474667549133301
Epoch: 8, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.255 Vali Acc: 0.419 Test Loss: 1.255 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6921486854553223
Epoch: 9, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.328 Vali Acc: 0.432 Test Loss: 1.328 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5455665588378906
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.292 Vali Acc: 0.446 Test Loss: 1.292 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 11 cost time: 0.5587403774261475
Epoch: 11, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.382 Vali Acc: 0.486 Test Loss: 1.382 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486473).  Saving model ...
Epoch: 12 cost time: 0.8037436008453369
Epoch: 12, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.297 Vali Acc: 0.486 Test Loss: 1.297 Test Acc: 0.486
Validation loss decreased (-0.486473 --> -0.486474).  Saving model ...
Epoch: 13 cost time: 0.7448821067810059
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 0.5765326023101807
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.248 Vali Acc: 0.554 Test Loss: 1.248 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554042).  Saving model ...
Epoch: 15 cost time: 0.5142860412597656
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.311 Vali Acc: 0.514 Test Loss: 1.311 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.522629976272583
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.301 Vali Acc: 0.514 Test Loss: 1.301 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.47495388984680176
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.221 Vali Acc: 0.608 Test Loss: 1.221 Test Acc: 0.608
Validation loss decreased (-0.554042 --> -0.608096).  Saving model ...
Epoch: 18 cost time: 0.642798662185669
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.217 Vali Acc: 0.568 Test Loss: 1.217 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9131646156311035
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9231381416320801
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.333 Vali Acc: 0.608 Test Loss: 1.333 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7044944763183594
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.344 Vali Acc: 0.581 Test Loss: 1.344 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0056228637695312
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.351 Vali Acc: 0.568 Test Loss: 1.351 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7958111763000488
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.335 Vali Acc: 0.568 Test Loss: 1.335 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6397862434387207
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.323 Vali Acc: 0.568 Test Loss: 1.323 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6124811172485352
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.349 Vali Acc: 0.554 Test Loss: 1.349 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6216559410095215
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.409 Vali Acc: 0.541 Test Loss: 1.409 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.596076488494873
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 37018372
model size : 155.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1271066665649414
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.464 Vali Acc: 0.230 Test Loss: 1.464 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.564791202545166
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.380 Vali Acc: 0.311 Test Loss: 1.380 Test Acc: 0.311
Validation loss decreased (-0.229715 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.8230624198913574
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.258 Vali Acc: 0.365 Test Loss: 1.258 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.7592644691467285
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
Validation loss decreased (-0.364852 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 0.6460452079772949
Epoch: 5, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9149465560913086
Epoch: 6, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.365 Vali Acc: 0.459 Test Loss: 1.365 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3920705318450928
Epoch: 7, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.366 Vali Acc: 0.514 Test Loss: 1.366 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9505615234375
Epoch: 8, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.624 Vali Acc: 0.486 Test Loss: 1.624 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5133113861083984
Epoch: 9, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.654 Vali Acc: 0.500 Test Loss: 1.654 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0093953609466553
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.671 Vali Acc: 0.527 Test Loss: 1.671 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4916768074035645
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.818 Vali Acc: 0.514 Test Loss: 1.818 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1721539497375488
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.932 Vali Acc: 0.473 Test Loss: 1.932 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8973593711853027
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.864 Vali Acc: 0.500 Test Loss: 1.864 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0377895832061768
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.763 Vali Acc: 0.514 Test Loss: 1.763 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 37221124
model size : 156.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.877298593521118
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.2895479202270508
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.3727641105651855
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.336 Vali Acc: 0.351 Test Loss: 1.336 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7906043529510498
Epoch: 4, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
Validation loss decreased (-0.351338 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9586305618286133
Epoch: 5, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.296 Vali Acc: 0.405 Test Loss: 1.296 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6061968803405762
Epoch: 6, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.393 Vali Acc: 0.392 Test Loss: 1.393 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7154231071472168
Epoch: 7, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.319 Vali Acc: 0.473 Test Loss: 1.319 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6056060791015625
Epoch: 8, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.475 Vali Acc: 0.351 Test Loss: 1.475 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9268186092376709
Epoch: 9, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.296 Vali Acc: 0.459 Test Loss: 1.296 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6582889556884766
Epoch: 10, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.565 Vali Acc: 0.459 Test Loss: 1.565 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9541354179382324
Epoch: 11, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.299 Vali Acc: 0.473 Test Loss: 1.299 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2536590099334717
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.494 Vali Acc: 0.473 Test Loss: 1.494 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.09932279586792
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.682 Vali Acc: 0.446 Test Loss: 1.682 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9655537605285645
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 37115140
model size : 156.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.227281093597412
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.356 Vali Acc: 0.365 Test Loss: 1.356 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 0.6565656661987305
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.401 Vali Acc: 0.230 Test Loss: 1.401 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6202671527862549
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.311 Vali Acc: 0.378 Test Loss: 1.311 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.9276425838470459
Epoch: 4, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.272 Vali Acc: 0.473 Test Loss: 1.272 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 0.5349550247192383
Epoch: 5, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.244 Vali Acc: 0.459 Test Loss: 1.244 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5897057056427002
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.6901741027832031
Epoch: 7, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.168 Vali Acc: 0.432 Test Loss: 1.168 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6638648509979248
Epoch: 8, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.107 Vali Acc: 0.446 Test Loss: 1.107 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4854145050048828
Epoch: 9, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.5812602043151855
Epoch: 10, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5990190505981445
Epoch: 11, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5988032817840576
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.282 Vali Acc: 0.554 Test Loss: 1.282 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554041).  Saving model ...
Epoch: 13 cost time: 0.5671510696411133
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.441 Vali Acc: 0.500 Test Loss: 1.441 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5237624645233154
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.448 Vali Acc: 0.541 Test Loss: 1.448 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6471092700958252
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.349 Vali Acc: 0.541 Test Loss: 1.349 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9742519855499268
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.481 Vali Acc: 0.473 Test Loss: 1.481 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8732423782348633
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5941534042358398
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.549 Vali Acc: 0.432 Test Loss: 1.549 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.547426700592041
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.614 Vali Acc: 0.432 Test Loss: 1.614 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6495652198791504
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.576 Vali Acc: 0.459 Test Loss: 1.576 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.651059627532959
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.555 Vali Acc: 0.446 Test Loss: 1.555 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5781798362731934
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.578 Vali Acc: 0.514 Test Loss: 1.578 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 37059844
model size : 156.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.372020721435547
Epoch: 1, Steps: 10 | Train Loss: 1.529 Vali Loss: 1.328 Vali Acc: 0.405 Test Loss: 1.328 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 0.9514956474304199
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.384 Vali Acc: 0.243 Test Loss: 1.384 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2832303047180176
Epoch: 3, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.240 Vali Acc: 0.541 Test Loss: 1.240 Test Acc: 0.541
Validation loss decreased (-0.405392 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.0047905445098877
Epoch: 4, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.168 Vali Acc: 0.568 Test Loss: 1.168 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 0.9185776710510254
Epoch: 5, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3440203666687012
Epoch: 6, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7298550605773926
Epoch: 7, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.564 Vali Acc: 0.392 Test Loss: 1.564 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.088360071182251
Epoch: 8, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.812633752822876
Epoch: 9, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.309 Vali Acc: 0.554 Test Loss: 1.309 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8174648284912109
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.732 Vali Acc: 0.527 Test Loss: 1.732 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7874572277069092
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.484 Vali Acc: 0.486 Test Loss: 1.484 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9600811004638672
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8238058090209961
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.509 Vali Acc: 0.527 Test Loss: 1.509 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8321480751037598
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.546 Vali Acc: 0.568 Test Loss: 1.546 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 37262596
model size : 156.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.713491678237915
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.401 Vali Acc: 0.216 Test Loss: 1.401 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.9305863380432129
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.295 Vali Acc: 0.473 Test Loss: 1.295 Test Acc: 0.473
Validation loss decreased (-0.216202 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.6665792465209961
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9593889713287354
Epoch: 4, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8414509296417236
Epoch: 5, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.270 Vali Acc: 0.473 Test Loss: 1.270 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 0.6560163497924805
Epoch: 6, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.472960 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.8684914112091064
Epoch: 7, Steps: 10 | Train Loss: 0.638 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1042406558990479
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.208 Vali Acc: 0.527 Test Loss: 1.208 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2657339572906494
Epoch: 9, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.314 Vali Acc: 0.486 Test Loss: 1.314 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8106465339660645
Epoch: 10, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.285 Vali Acc: 0.541 Test Loss: 1.285 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1950247287750244
Epoch: 11, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.413 Vali Acc: 0.514 Test Loss: 1.413 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0058462619781494
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.542 Vali Acc: 0.554 Test Loss: 1.542 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3490219116210938
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.685 Vali Acc: 0.514 Test Loss: 1.685 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9296829700469971
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.679 Vali Acc: 0.541 Test Loss: 1.679 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2220335006713867
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.799 Vali Acc: 0.541 Test Loss: 1.799 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7597484588623047
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.796 Vali Acc: 0.527 Test Loss: 1.796 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 37175044
model size : 156.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.406757116317749
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.446 Vali Acc: 0.230 Test Loss: 1.446 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.954481840133667
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.383 Vali Acc: 0.284 Test Loss: 1.383 Test Acc: 0.284
Validation loss decreased (-0.229715 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.6499087810516357
Epoch: 3, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.338 Vali Acc: 0.351 Test Loss: 1.338 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7759833335876465
Epoch: 4, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.357 Vali Acc: 0.338 Test Loss: 1.357 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6247549057006836
Epoch: 5, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.249 Vali Acc: 0.554 Test Loss: 1.249 Test Acc: 0.554
Validation loss decreased (-0.351338 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 0.6056866645812988
Epoch: 6, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.205 Vali Acc: 0.541 Test Loss: 1.205 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6629576683044434
Epoch: 7, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5078723430633545
Epoch: 8, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.144 Vali Acc: 0.568 Test Loss: 1.144 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 0.6956825256347656
Epoch: 9, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.224 Vali Acc: 0.514 Test Loss: 1.224 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.563377857208252
Epoch: 10, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.266 Vali Acc: 0.568 Test Loss: 1.266 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.630730152130127
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.335 Vali Acc: 0.500 Test Loss: 1.335 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6266746520996094
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.398 Vali Acc: 0.514 Test Loss: 1.398 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6468396186828613
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.360 Vali Acc: 0.568 Test Loss: 1.360 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6002633571624756
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.391 Vali Acc: 0.541 Test Loss: 1.391 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6673934459686279
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.462 Vali Acc: 0.581 Test Loss: 1.462 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581066).  Saving model ...
Epoch: 16 cost time: 0.7176315784454346
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.485 Vali Acc: 0.541 Test Loss: 1.485 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6804826259613037
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.480 Vali Acc: 0.568 Test Loss: 1.480 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6717956066131592
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.500 Vali Acc: 0.554 Test Loss: 1.500 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5937471389770508
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.505 Vali Acc: 0.541 Test Loss: 1.505 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7234876155853271
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.541 Vali Acc: 0.554 Test Loss: 1.541 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7201018333435059
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.589 Vali Acc: 0.568 Test Loss: 1.589 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5422360897064209
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.564 Vali Acc: 0.554 Test Loss: 1.564 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6116659641265869
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.580 Vali Acc: 0.527 Test Loss: 1.580 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5678079128265381
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.605 Vali Acc: 0.541 Test Loss: 1.605 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.586517333984375
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.635 Vali Acc: 0.554 Test Loss: 1.635 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 37124356
model size : 156.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.989917278289795
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.356 Vali Acc: 0.270 Test Loss: 1.356 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.7605268955230713
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.306 Vali Acc: 0.324 Test Loss: 1.306 Test Acc: 0.324
Validation loss decreased (-0.270257 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.6163594722747803
Epoch: 3, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.230 Vali Acc: 0.419 Test Loss: 1.230 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 0.7223720550537109
Epoch: 4, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
Validation loss decreased (-0.418907 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 0.637946367263794
Epoch: 5, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.214 Vali Acc: 0.405 Test Loss: 1.214 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5515320301055908
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.201 Vali Acc: 0.459 Test Loss: 1.201 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5776069164276123
Epoch: 7, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5639913082122803
Epoch: 8, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.54538893699646
Epoch: 9, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.248 Vali Acc: 0.568 Test Loss: 1.248 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 10 cost time: 0.6334145069122314
Epoch: 10, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.288 Vali Acc: 0.541 Test Loss: 1.288 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6088483333587646
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.423 Vali Acc: 0.568 Test Loss: 1.423 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5539999008178711
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.277 Vali Acc: 0.568 Test Loss: 1.277 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9102165699005127
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.419 Vali Acc: 0.568 Test Loss: 1.419 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8768215179443359
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.421 Vali Acc: 0.554 Test Loss: 1.421 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7470214366912842
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.430 Vali Acc: 0.568 Test Loss: 1.430 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8456504344940186
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.581 Test Loss: 1.397 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581067).  Saving model ...
Epoch: 17 cost time: 0.8077847957611084
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.382 Vali Acc: 0.568 Test Loss: 1.382 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6557085514068604
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.554 Test Loss: 1.418 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9554111957550049
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.595 Test Loss: 1.398 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594581).  Saving model ...
Epoch: 20 cost time: 0.916452169418335
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.608 Test Loss: 1.423 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608094).  Saving model ...
Epoch: 21 cost time: 0.6031577587127686
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.595 Test Loss: 1.398 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5938122272491455
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.581 Test Loss: 1.427 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7150473594665527
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.595 Test Loss: 1.444 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5837225914001465
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.608 Test Loss: 1.440 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6961469650268555
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.595 Test Loss: 1.424 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.821070671081543
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.568 Test Loss: 1.420 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0596520900726318
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.595 Test Loss: 1.424 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5867929458618164
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.608 Test Loss: 1.445 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7864465713500977
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.595 Test Loss: 1.435 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.836143970489502
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.595 Test Loss: 1.434 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 37313284
model size : 157.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.6974313259124756
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.466 Vali Acc: 0.216 Test Loss: 1.466 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.892282247543335
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (-0.216202 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.2411623001098633
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.336 Vali Acc: 0.351 Test Loss: 1.336 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7599763870239258
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 1.048766851425171
Epoch: 5, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.6458275318145752
Epoch: 6, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.232 Vali Acc: 0.338 Test Loss: 1.232 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9120123386383057
Epoch: 7, Steps: 10 | Train Loss: 0.633 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5472376346588135
Epoch: 8, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.637371301651001
Epoch: 9, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.324 Vali Acc: 0.446 Test Loss: 1.324 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4700329303741455
Epoch: 10, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.211 Vali Acc: 0.514 Test Loss: 1.211 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 11 cost time: 1.0993664264678955
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3288564682006836
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.423 Vali Acc: 0.486 Test Loss: 1.423 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6647777557373047
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.271 Vali Acc: 0.581 Test Loss: 1.271 Test Acc: 0.581
Validation loss decreased (-0.513501 --> -0.581068).  Saving model ...
Epoch: 14 cost time: 0.9197509288787842
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.200 Vali Acc: 0.581 Test Loss: 1.200 Test Acc: 0.581
Validation loss decreased (-0.581068 --> -0.581069).  Saving model ...
Epoch: 15 cost time: 0.5283832550048828
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.318 Vali Acc: 0.527 Test Loss: 1.318 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6054584980010986
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.291 Vali Acc: 0.541 Test Loss: 1.291 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6794195175170898
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.346 Vali Acc: 0.514 Test Loss: 1.346 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5154702663421631
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5407404899597168
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.383 Vali Acc: 0.527 Test Loss: 1.383 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5184199810028076
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.401 Vali Acc: 0.514 Test Loss: 1.401 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6067533493041992
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.529740571975708
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6776361465454102
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.406 Vali Acc: 0.527 Test Loss: 1.406 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5648128986358643
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 37234948
model size : 156.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0164897441864014
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.413 Vali Acc: 0.189 Test Loss: 1.413 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.5046508312225342
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.327 Vali Acc: 0.324 Test Loss: 1.327 Test Acc: 0.324
Validation loss decreased (-0.189175 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.5579521656036377
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.380 Vali Acc: 0.311 Test Loss: 1.380 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5757949352264404
Epoch: 4, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.284 Vali Acc: 0.392 Test Loss: 1.284 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.5672330856323242
Epoch: 5, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.265 Vali Acc: 0.446 Test Loss: 1.265 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.5850117206573486
Epoch: 6, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7846164703369141
Epoch: 7, Steps: 10 | Train Loss: 0.817 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.714853048324585
Epoch: 8, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.190917730331421
Epoch: 9, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.9801557064056396
Epoch: 10, Steps: 10 | Train Loss: 0.277 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.154979944229126
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.278 Vali Acc: 0.554 Test Loss: 1.278 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7162611484527588
Epoch: 12, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.200 Vali Acc: 0.568 Test Loss: 1.200 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 0.8358883857727051
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.284 Vali Acc: 0.541 Test Loss: 1.284 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0728847980499268
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.245 Vali Acc: 0.554 Test Loss: 1.245 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1570122241973877
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.354 Vali Acc: 0.595 Test Loss: 1.354 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594581).  Saving model ...
Epoch: 16 cost time: 0.9526805877685547
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.350 Vali Acc: 0.622 Test Loss: 1.350 Test Acc: 0.622
Validation loss decreased (-0.594581 --> -0.621608).  Saving model ...
Epoch: 17 cost time: 0.7241759300231934
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.331 Vali Acc: 0.595 Test Loss: 1.331 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5877773761749268
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.367 Vali Acc: 0.622 Test Loss: 1.367 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5827462673187256
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.437 Vali Acc: 0.608 Test Loss: 1.437 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8270471096038818
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.424 Vali Acc: 0.608 Test Loss: 1.424 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7921743392944336
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.622 Test Loss: 1.400 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5753815174102783
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.415 Vali Acc: 0.595 Test Loss: 1.415 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7779312133789062
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.471 Vali Acc: 0.608 Test Loss: 1.471 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5619134902954102
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.466 Vali Acc: 0.608 Test Loss: 1.466 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5527186393737793
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.460 Vali Acc: 0.595 Test Loss: 1.460 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6120610237121582
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.463 Vali Acc: 0.608 Test Loss: 1.463 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 37188868
model size : 156.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5222837924957275
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.468 Vali Acc: 0.176 Test Loss: 1.468 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 0.836310625076294
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (-0.175661 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.2962064743041992
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.307 Vali Acc: 0.419 Test Loss: 1.307 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.478416919708252
Epoch: 4, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.188 Vali Acc: 0.446 Test Loss: 1.188 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.5521719455718994
Epoch: 5, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.274 Vali Acc: 0.459 Test Loss: 1.274 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.1267890930175781
Epoch: 6, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.143 Vali Acc: 0.459 Test Loss: 1.143 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 0.9357080459594727
Epoch: 7, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.069 Vali Acc: 0.514 Test Loss: 1.069 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 0.8648872375488281
Epoch: 8, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.327 Vali Acc: 0.541 Test Loss: 1.327 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540527).  Saving model ...
Epoch: 9 cost time: 0.7388896942138672
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7899954319000244
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.200 Vali Acc: 0.568 Test Loss: 1.200 Test Acc: 0.568
Validation loss decreased (-0.540527 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 0.8481569290161133
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.277 Vali Acc: 0.514 Test Loss: 1.277 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8282301425933838
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.413 Vali Acc: 0.554 Test Loss: 1.413 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.734997034072876
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.487 Vali Acc: 0.527 Test Loss: 1.487 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9661154747009277
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.729 Vali Acc: 0.581 Test Loss: 1.729 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581064).  Saving model ...
Epoch: 15 cost time: 0.762559175491333
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.584 Vali Acc: 0.608 Test Loss: 1.584 Test Acc: 0.608
Validation loss decreased (-0.581064 --> -0.608092).  Saving model ...
Epoch: 16 cost time: 1.0692059993743896
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.552 Vali Acc: 0.595 Test Loss: 1.552 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2327659130096436
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.555 Vali Acc: 0.554 Test Loss: 1.555 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7770833969116211
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.581 Test Loss: 1.679 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1670446395874023
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.541 Test Loss: 1.883 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9750993251800537
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.904 Vali Acc: 0.554 Test Loss: 1.904 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8413004875183105
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.765 Vali Acc: 0.581 Test Loss: 1.765 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8433225154876709
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.595 Test Loss: 1.717 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.456409215927124
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.595 Test Loss: 1.716 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8910703659057617
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.581 Test Loss: 1.762 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7127087116241455
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.759 Vali Acc: 0.595 Test Loss: 1.759 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 37382404
model size : 157.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0759243965148926
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.386 Vali Acc: 0.284 Test Loss: 1.386 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9453401565551758
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.382 Vali Acc: 0.297 Test Loss: 1.382 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.7280077934265137
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.277 Vali Acc: 0.459 Test Loss: 1.277 Test Acc: 0.459
Validation loss decreased (-0.297283 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.812476396560669
Epoch: 4, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.240 Vali Acc: 0.446 Test Loss: 1.240 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6558225154876709
Epoch: 5, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.205 Vali Acc: 0.459 Test Loss: 1.205 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.6279196739196777
Epoch: 6, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.169 Vali Acc: 0.581 Test Loss: 1.169 Test Acc: 0.581
Validation loss decreased (-0.459447 --> -0.581069).  Saving model ...
Epoch: 7 cost time: 1.4108350276947021
Epoch: 7, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.245 Vali Acc: 0.541 Test Loss: 1.245 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8510992527008057
Epoch: 8, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8464157581329346
Epoch: 9, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0001685619354248
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.333 Vali Acc: 0.527 Test Loss: 1.333 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2344319820404053
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.404 Vali Acc: 0.554 Test Loss: 1.404 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1881680488586426
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.294 Vali Acc: 0.568 Test Loss: 1.294 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9517500400543213
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6384239196777344
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.422 Vali Acc: 0.541 Test Loss: 1.422 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.48641204833984375
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.469 Vali Acc: 0.541 Test Loss: 1.469 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6719212532043457
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.449 Vali Acc: 0.541 Test Loss: 1.449 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 37299460
model size : 156.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.050922393798828
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.398 Vali Acc: 0.270 Test Loss: 1.398 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.866274356842041
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.408 Vali Acc: 0.257 Test Loss: 1.408 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.851996660232544
Epoch: 3, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.356 Vali Acc: 0.311 Test Loss: 1.356 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.0425622463226318
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.297 Vali Acc: 0.365 Test Loss: 1.297 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.0814697742462158
Epoch: 5, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.5613412857055664
Epoch: 6, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.231 Vali Acc: 0.378 Test Loss: 1.231 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.272291660308838
Epoch: 7, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.181 Vali Acc: 0.432 Test Loss: 1.181 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7295610904693604
Epoch: 8, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.216 Vali Acc: 0.405 Test Loss: 1.216 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9114034175872803
Epoch: 9, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.9507877826690674
Epoch: 10, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.8915259838104248
Epoch: 11, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.097 Vali Acc: 0.568 Test Loss: 1.097 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 0.7706682682037354
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8949615955352783
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 0.8585283756256104
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.162 Vali Acc: 0.622 Test Loss: 1.162 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621610).  Saving model ...
Epoch: 15 cost time: 0.639765739440918
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.178 Vali Acc: 0.622 Test Loss: 1.178 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6674754619598389
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.167 Vali Acc: 0.581 Test Loss: 1.167 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9030191898345947
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.201 Vali Acc: 0.595 Test Loss: 1.201 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9656579494476318
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.200 Vali Acc: 0.581 Test Loss: 1.200 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7142622470855713
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.155 Vali Acc: 0.608 Test Loss: 1.155 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8811137676239014
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.174 Vali Acc: 0.608 Test Loss: 1.174 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9006099700927734
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.196 Vali Acc: 0.595 Test Loss: 1.196 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7956490516662598
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.213 Vali Acc: 0.595 Test Loss: 1.213 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7434773445129395
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.233 Vali Acc: 0.608 Test Loss: 1.233 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8628873825073242
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.242 Vali Acc: 0.581 Test Loss: 1.242 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 37257988
model size : 156.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2461137771606445
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.370 Vali Acc: 0.284 Test Loss: 1.370 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.2318313121795654
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.286 Vali Acc: 0.486 Test Loss: 1.286 Test Acc: 0.486
Validation loss decreased (-0.283770 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.213146448135376
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1098275184631348
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.170 Vali Acc: 0.514 Test Loss: 1.170 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.3838794231414795
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.9437294006347656
Epoch: 6, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.961336612701416
Epoch: 7, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.226 Vali Acc: 0.554 Test Loss: 1.226 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 0.8339970111846924
Epoch: 8, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.286 Vali Acc: 0.581 Test Loss: 1.286 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581068).  Saving model ...
Epoch: 9 cost time: 0.9254910945892334
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7235689163208008
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.468 Vali Acc: 0.581 Test Loss: 1.468 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6134860515594482
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.491 Vali Acc: 0.514 Test Loss: 1.491 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1970386505126953
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.579 Vali Acc: 0.554 Test Loss: 1.579 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.188408613204956
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.580 Vali Acc: 0.541 Test Loss: 1.580 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8613584041595459
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.617 Vali Acc: 0.541 Test Loss: 1.617 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4244787693023682
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.658 Vali Acc: 0.527 Test Loss: 1.658 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1709003448486328
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.541 Test Loss: 1.617 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3697459697723389
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.541 Test Loss: 1.642 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8075151443481445
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.541 Test Loss: 1.665 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 37465348
model size : 157.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.506675958633423
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.386 Vali Acc: 0.365 Test Loss: 1.386 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.3635540008544922
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.363 Vali Acc: 0.338 Test Loss: 1.363 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.73638916015625
Epoch: 3, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.306 Vali Acc: 0.392 Test Loss: 1.306 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.806084156036377
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.288 Vali Acc: 0.405 Test Loss: 1.288 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 0.8722610473632812
Epoch: 5, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.6965799331665039
Epoch: 6, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.8658397197723389
Epoch: 7, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.7266466617584229
Epoch: 8, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.281 Vali Acc: 0.514 Test Loss: 1.281 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 0.9051213264465332
Epoch: 9, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.251 Vali Acc: 0.514 Test Loss: 1.251 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 10 cost time: 0.6904158592224121
Epoch: 10, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.483 Vali Acc: 0.527 Test Loss: 1.483 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527012).  Saving model ...
Epoch: 11 cost time: 0.7890892028808594
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.231 Vali Acc: 0.459 Test Loss: 1.231 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7092204093933105
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.493 Vali Acc: 0.486 Test Loss: 1.493 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1515004634857178
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.799429178237915
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.462 Vali Acc: 0.473 Test Loss: 1.462 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2114901542663574
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.396 Vali Acc: 0.541 Test Loss: 1.396 Test Acc: 0.541
Validation loss decreased (-0.527012 --> -0.540527).  Saving model ...
Epoch: 16 cost time: 0.9450433254241943
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.398 Vali Acc: 0.554 Test Loss: 1.398 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 17 cost time: 0.7083730697631836
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.381 Vali Acc: 0.541 Test Loss: 1.381 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7303998470306396
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.381 Vali Acc: 0.527 Test Loss: 1.381 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8713736534118652
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.403 Vali Acc: 0.568 Test Loss: 1.403 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567554).  Saving model ...
Epoch: 20 cost time: 0.9490983486175537
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.418 Vali Acc: 0.568 Test Loss: 1.418 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9782290458679199
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.443 Vali Acc: 0.554 Test Loss: 1.443 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8274581432342529
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.464 Vali Acc: 0.568 Test Loss: 1.464 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.86606764793396
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.568 Test Loss: 1.469 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.725801944732666
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.470 Vali Acc: 0.568 Test Loss: 1.470 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7473435401916504
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.486 Vali Acc: 0.568 Test Loss: 1.486 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8484642505645752
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.502 Vali Acc: 0.568 Test Loss: 1.502 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5550696849822998
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.507 Vali Acc: 0.554 Test Loss: 1.507 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.943091869354248
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.541 Test Loss: 1.492 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8403916358947754
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.554 Test Loss: 1.474 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 37400836
model size : 157.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.836829423904419
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.352 Vali Acc: 0.378 Test Loss: 1.352 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.6123480796813965
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.321 Vali Acc: 0.405 Test Loss: 1.321 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.7032768726348877
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.285 Vali Acc: 0.459 Test Loss: 1.285 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.5745854377746582
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6410658359527588
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.170 Vali Acc: 0.514 Test Loss: 1.170 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.7426083087921143
Epoch: 6, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.8113126754760742
Epoch: 7, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.083 Vali Acc: 0.486 Test Loss: 1.083 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.649155855178833
Epoch: 8, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6872646808624268
Epoch: 9, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.155 Vali Acc: 0.432 Test Loss: 1.155 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.55379319190979
Epoch: 10, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.090 Vali Acc: 0.514 Test Loss: 1.090 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.855543851852417
Epoch: 11, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.071 Vali Acc: 0.514 Test Loss: 1.071 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6993284225463867
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.618065595626831
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5788593292236328
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5444514751434326
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5793392658233643
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 37363972
model size : 157.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.595578670501709
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.397 Vali Acc: 0.297 Test Loss: 1.397 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.989262580871582
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.341 Vali Acc: 0.311 Test Loss: 1.341 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.0645363330841064
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.259 Vali Acc: 0.432 Test Loss: 1.259 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.437568187713623
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.903223991394043
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540528).  Saving model ...
Epoch: 6 cost time: 0.9029085636138916
Epoch: 6, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.313 Vali Acc: 0.459 Test Loss: 1.313 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9634308815002441
Epoch: 7, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.316 Vali Acc: 0.541 Test Loss: 1.316 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1392416954040527
Epoch: 8, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.480 Vali Acc: 0.365 Test Loss: 1.480 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9307150840759277
Epoch: 9, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.382 Vali Acc: 0.459 Test Loss: 1.382 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0270941257476807
Epoch: 10, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.614 Vali Acc: 0.527 Test Loss: 1.614 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0750555992126465
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.386 Vali Acc: 0.486 Test Loss: 1.386 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6132886409759521
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.669 Vali Acc: 0.500 Test Loss: 1.669 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0364229679107666
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.551 Vali Acc: 0.473 Test Loss: 1.551 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7800824642181396
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.604 Vali Acc: 0.514 Test Loss: 1.604 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8802406787872314
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 37566724
model size : 157.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2151455879211426
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.5945167541503906
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.317 Vali Acc: 0.459 Test Loss: 1.317 Test Acc: 0.459
Validation loss decreased (-0.270256 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.6691317558288574
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.307 Vali Acc: 0.392 Test Loss: 1.307 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6995506286621094
Epoch: 4, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.6969552040100098
Epoch: 5, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7211408615112305
Epoch: 6, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.8381969928741455
Epoch: 7, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.106 Vali Acc: 0.581 Test Loss: 1.106 Test Acc: 0.581
Validation loss decreased (-0.499989 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.5668246746063232
Epoch: 8, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7569870948791504
Epoch: 9, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.217 Vali Acc: 0.595 Test Loss: 1.217 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 10 cost time: 0.77376389503479
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.208 Vali Acc: 0.527 Test Loss: 1.208 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8738696575164795
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8137133121490479
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.210 Vali Acc: 0.581 Test Loss: 1.210 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6489179134368896
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.214 Vali Acc: 0.568 Test Loss: 1.214 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7210447788238525
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.235 Vali Acc: 0.541 Test Loss: 1.235 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8040256500244141
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.225 Vali Acc: 0.568 Test Loss: 1.225 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7237503528594971
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.221 Vali Acc: 0.581 Test Loss: 1.221 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9599158763885498
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.276 Vali Acc: 0.554 Test Loss: 1.276 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7383279800415039
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.275 Vali Acc: 0.554 Test Loss: 1.275 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8009138107299805
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.259 Vali Acc: 0.568 Test Loss: 1.259 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 37511428
model size : 157.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.614124298095703
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.353 Vali Acc: 0.270 Test Loss: 1.353 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.6392812728881836
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.349 Vali Acc: 0.324 Test Loss: 1.349 Test Acc: 0.324
Validation loss decreased (-0.270257 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.6097180843353271
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.324311 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.6673941612243652
Epoch: 4, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.236 Vali Acc: 0.419 Test Loss: 1.236 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.558490514755249
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6174483299255371
Epoch: 6, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7224936485290527
Epoch: 7, Steps: 10 | Train Loss: 0.728 Vali Loss: 1.061 Vali Acc: 0.527 Test Loss: 1.061 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.8242611885070801
Epoch: 8, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 0.6395576000213623
Epoch: 9, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.6472196578979492
Epoch: 10, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.112 Vali Acc: 0.581 Test Loss: 1.112 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 0.788118839263916
Epoch: 11, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6949045658111572
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.219 Vali Acc: 0.568 Test Loss: 1.219 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6561377048492432
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.190 Vali Acc: 0.568 Test Loss: 1.190 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7632880210876465
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.212 Vali Acc: 0.554 Test Loss: 1.212 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6903431415557861
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6498208045959473
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.205 Vali Acc: 0.554 Test Loss: 1.205 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.594491720199585
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.184 Vali Acc: 0.635 Test Loss: 1.184 Test Acc: 0.635
Validation loss decreased (-0.581070 --> -0.635123).  Saving model ...
Epoch: 18 cost time: 0.7675392627716064
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.221 Vali Acc: 0.608 Test Loss: 1.221 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6246337890625
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.257 Vali Acc: 0.622 Test Loss: 1.257 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6556856632232666
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.269 Vali Acc: 0.622 Test Loss: 1.269 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5483238697052002
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.283 Vali Acc: 0.622 Test Loss: 1.283 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6757338047027588
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.290 Vali Acc: 0.635 Test Loss: 1.290 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6086294651031494
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.332 Vali Acc: 0.595 Test Loss: 1.332 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8170182704925537
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.350 Vali Acc: 0.595 Test Loss: 1.350 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6781823635101318
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.339 Vali Acc: 0.608 Test Loss: 1.339 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5472216606140137
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.343 Vali Acc: 0.608 Test Loss: 1.343 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6066505908966064
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.337 Vali Acc: 0.595 Test Loss: 1.337 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 37479172
model size : 157.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8886265754699707
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.453 Vali Acc: 0.257 Test Loss: 1.453 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.6822049617767334
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.330 Vali Acc: 0.432 Test Loss: 1.330 Test Acc: 0.432
Validation loss decreased (-0.256742 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.5375046730041504
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.8805441856384277
Epoch: 4, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.7521424293518066
Epoch: 5, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.6284830570220947
Epoch: 6, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.789466142654419
Epoch: 7, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.852287769317627
Epoch: 8, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.236283540725708
Epoch: 9, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.487 Vali Acc: 0.554 Test Loss: 1.487 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554039).  Saving model ...
Epoch: 10 cost time: 0.7912781238555908
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.195 Vali Acc: 0.622 Test Loss: 1.195 Test Acc: 0.622
Validation loss decreased (-0.554039 --> -0.621610).  Saving model ...
Epoch: 11 cost time: 0.7539060115814209
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.417 Vali Acc: 0.541 Test Loss: 1.417 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6582283973693848
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.222 Vali Acc: 0.568 Test Loss: 1.222 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6383016109466553
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.372 Vali Acc: 0.595 Test Loss: 1.372 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7371861934661865
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.357 Vali Acc: 0.581 Test Loss: 1.357 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.946660041809082
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.322 Vali Acc: 0.581 Test Loss: 1.322 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.196152687072754
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9198637008666992
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.364 Vali Acc: 0.568 Test Loss: 1.364 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8861398696899414
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.360 Vali Acc: 0.568 Test Loss: 1.360 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7594566345214844
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.357 Vali Acc: 0.581 Test Loss: 1.357 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8828728199005127
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.595 Test Loss: 1.386 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 37732612
model size : 158.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2734827995300293
Epoch: 1, Steps: 10 | Train Loss: 1.533 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.7178554534912109
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.417 Vali Acc: 0.203 Test Loss: 1.417 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.621159553527832
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.350 Vali Acc: 0.365 Test Loss: 1.350 Test Acc: 0.365
Validation loss decreased (-0.270256 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.6021554470062256
Epoch: 4, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.6595845222473145
Epoch: 5, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.298 Vali Acc: 0.392 Test Loss: 1.298 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.66377854347229
Epoch: 6, Steps: 10 | Train Loss: 0.763 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.5750699043273926
Epoch: 7, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.242 Vali Acc: 0.459 Test Loss: 1.242 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.635831356048584
Epoch: 8, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.262 Vali Acc: 0.554 Test Loss: 1.262 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554041).  Saving model ...
Epoch: 9 cost time: 0.544633150100708
Epoch: 9, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.190 Vali Acc: 0.554 Test Loss: 1.190 Test Acc: 0.554
Validation loss decreased (-0.554041 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 0.6132113933563232
Epoch: 10, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.343 Vali Acc: 0.541 Test Loss: 1.343 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.49276256561279297
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.359 Vali Acc: 0.554 Test Loss: 1.359 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.550438642501831
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.428 Vali Acc: 0.554 Test Loss: 1.428 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6222217082977295
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.482 Vali Acc: 0.608 Test Loss: 1.482 Test Acc: 0.608
Validation loss decreased (-0.554042 --> -0.608093).  Saving model ...
Epoch: 14 cost time: 0.6771578788757324
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.362 Vali Acc: 0.581 Test Loss: 1.362 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6077196598052979
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.417 Vali Acc: 0.595 Test Loss: 1.417 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5552051067352295
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.482 Vali Acc: 0.595 Test Loss: 1.482 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5873305797576904
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.516 Vali Acc: 0.595 Test Loss: 1.516 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6049737930297852
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.482 Vali Acc: 0.608 Test Loss: 1.482 Test Acc: 0.608
Validation loss decreased (-0.608093 --> -0.608093).  Saving model ...
Epoch: 19 cost time: 0.6099514961242676
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.482 Vali Acc: 0.608 Test Loss: 1.482 Test Acc: 0.608
Validation loss decreased (-0.608093 --> -0.608093).  Saving model ...
Epoch: 20 cost time: 0.6661200523376465
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.502 Vali Acc: 0.595 Test Loss: 1.502 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7362444400787354
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.523 Vali Acc: 0.595 Test Loss: 1.523 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7712562084197998
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.608 Test Loss: 1.535 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5944082736968994
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.583 Vali Acc: 0.595 Test Loss: 1.583 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5773835182189941
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.608 Vali Acc: 0.581 Test Loss: 1.608 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6305098533630371
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.622 Vali Acc: 0.595 Test Loss: 1.622 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7694559097290039
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.633 Vali Acc: 0.581 Test Loss: 1.633 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6400296688079834
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.635 Vali Acc: 0.608 Test Loss: 1.635 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7119135856628418
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.608 Test Loss: 1.641 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8287873268127441
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.649 Vali Acc: 0.608 Test Loss: 1.649 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 37681924
model size : 158.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.339858293533325
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.406 Vali Acc: 0.216 Test Loss: 1.406 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.6929471492767334
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.382 Vali Acc: 0.378 Test Loss: 1.382 Test Acc: 0.378
Validation loss decreased (-0.216202 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.756890058517456
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.357 Vali Acc: 0.378 Test Loss: 1.357 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.654644250869751
Epoch: 4, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.334 Vali Acc: 0.351 Test Loss: 1.334 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6916329860687256
Epoch: 5, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.283 Vali Acc: 0.392 Test Loss: 1.283 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.5391566753387451
Epoch: 6, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.5898776054382324
Epoch: 7, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.190 Vali Acc: 0.432 Test Loss: 1.190 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7399883270263672
Epoch: 8, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.138 Vali Acc: 0.486 Test Loss: 1.138 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 0.7011098861694336
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6860239505767822
Epoch: 10, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.174 Vali Acc: 0.581 Test Loss: 1.174 Test Acc: 0.581
Validation loss decreased (-0.486475 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 0.6938707828521729
Epoch: 11, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.166 Vali Acc: 0.581 Test Loss: 1.166 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 0.5641579627990723
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5578694343566895
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.193 Vali Acc: 0.581 Test Loss: 1.193 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6297931671142578
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.190 Vali Acc: 0.568 Test Loss: 1.190 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7695176601409912
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.243 Vali Acc: 0.554 Test Loss: 1.243 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8032562732696533
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.242 Vali Acc: 0.581 Test Loss: 1.242 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6245591640472412
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.272 Vali Acc: 0.568 Test Loss: 1.272 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.783315896987915
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.281 Vali Acc: 0.581 Test Loss: 1.281 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7346878051757812
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.306 Vali Acc: 0.595 Test Loss: 1.306 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 20 cost time: 0.7057573795318604
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.332 Vali Acc: 0.568 Test Loss: 1.332 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7767407894134521
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.349 Vali Acc: 0.541 Test Loss: 1.349 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6042053699493408
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.351 Vali Acc: 0.541 Test Loss: 1.351 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7655489444732666
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.363 Vali Acc: 0.568 Test Loss: 1.363 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5806524753570557
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.360 Vali Acc: 0.595 Test Loss: 1.360 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7276480197906494
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.369 Vali Acc: 0.581 Test Loss: 1.369 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6507415771484375
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.372 Vali Acc: 0.581 Test Loss: 1.372 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6787772178649902
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.581 Test Loss: 1.373 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6748197078704834
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.379 Vali Acc: 0.581 Test Loss: 1.379 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6414375305175781
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.403 Vali Acc: 0.568 Test Loss: 1.403 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 37654276
model size : 158.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4580256938934326
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.392 Vali Acc: 0.257 Test Loss: 1.392 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.7043681144714355
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.345 Vali Acc: 0.392 Test Loss: 1.345 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 0.6355485916137695
Epoch: 3, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.265 Vali Acc: 0.459 Test Loss: 1.265 Test Acc: 0.459
Validation loss decreased (-0.391878 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.8060922622680664
Epoch: 4, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.214 Vali Acc: 0.473 Test Loss: 1.214 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.6325185298919678
Epoch: 5, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.126 Vali Acc: 0.527 Test Loss: 1.126 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.8090791702270508
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6833226680755615
Epoch: 7, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.178 Vali Acc: 0.527 Test Loss: 1.178 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5032637119293213
Epoch: 8, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.135 Vali Acc: 0.554 Test Loss: 1.135 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.9954490661621094
Epoch: 9, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.290 Vali Acc: 0.514 Test Loss: 1.290 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8690311908721924
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.477 Vali Acc: 0.486 Test Loss: 1.477 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5821011066436768
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.346 Vali Acc: 0.568 Test Loss: 1.346 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567554).  Saving model ...
Epoch: 12 cost time: 0.6581645011901855
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.376 Vali Acc: 0.622 Test Loss: 1.376 Test Acc: 0.622
Validation loss decreased (-0.567554 --> -0.621608).  Saving model ...
Epoch: 13 cost time: 0.7103188037872314
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.408 Vali Acc: 0.622 Test Loss: 1.408 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6765992641448975
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.385 Vali Acc: 0.595 Test Loss: 1.385 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7885520458221436
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.333 Vali Acc: 0.568 Test Loss: 1.333 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8669130802154541
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.358 Vali Acc: 0.581 Test Loss: 1.358 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6236555576324463
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.393 Vali Acc: 0.622 Test Loss: 1.393 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1512181758880615
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.439 Vali Acc: 0.622 Test Loss: 1.439 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5707869529724121
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.449 Vali Acc: 0.622 Test Loss: 1.449 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5956997871398926
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.463 Vali Acc: 0.608 Test Loss: 1.463 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5938947200775146
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.450 Vali Acc: 0.608 Test Loss: 1.450 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6260128021240234
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.446 Vali Acc: 0.595 Test Loss: 1.446 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 37926148
model size : 159.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1284751892089844
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.416 Vali Acc: 0.203 Test Loss: 1.416 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.8167469501495361
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.346 Vali Acc: 0.324 Test Loss: 1.346 Test Acc: 0.324
Validation loss decreased (-0.202689 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.752784013748169
Epoch: 3, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.326 Vali Acc: 0.432 Test Loss: 1.326 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.915480375289917
Epoch: 4, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6980128288269043
Epoch: 5, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.210 Vali Acc: 0.432 Test Loss: 1.210 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.673445463180542
Epoch: 6, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.262 Vali Acc: 0.378 Test Loss: 1.262 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6271188259124756
Epoch: 7, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.224 Vali Acc: 0.405 Test Loss: 1.224 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6115670204162598
Epoch: 8, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.227 Vali Acc: 0.432 Test Loss: 1.227 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7906453609466553
Epoch: 9, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.169 Vali Acc: 0.486 Test Loss: 1.169 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 0.6122570037841797
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6500296592712402
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 0.7937915325164795
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.403 Vali Acc: 0.446 Test Loss: 1.403 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7745614051818848
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.404 Vali Acc: 0.459 Test Loss: 1.404 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6739559173583984
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.465 Vali Acc: 0.486 Test Loss: 1.465 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8091461658477783
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.469 Vali Acc: 0.459 Test Loss: 1.469 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6949985027313232
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.439 Vali Acc: 0.541 Test Loss: 1.439 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540526).  Saving model ...
Epoch: 17 cost time: 0.7719466686248779
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8064355850219727
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.496 Vali Acc: 0.486 Test Loss: 1.496 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9113192558288574
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8300740718841553
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.512 Vali Acc: 0.514 Test Loss: 1.512 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.714040994644165
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.524 Vali Acc: 0.514 Test Loss: 1.524 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6341748237609863
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.469 Vali Acc: 0.554 Test Loss: 1.469 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554039).  Saving model ...
Epoch: 23 cost time: 0.8293983936309814
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.458 Vali Acc: 0.541 Test Loss: 1.458 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6034047603607178
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.474 Vali Acc: 0.554 Test Loss: 1.474 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.72269606590271
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.484 Vali Acc: 0.541 Test Loss: 1.484 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6944332122802734
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.506 Vali Acc: 0.554 Test Loss: 1.506 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6458663940429688
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.522 Vali Acc: 0.486 Test Loss: 1.522 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8136250972747803
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.530 Vali Acc: 0.473 Test Loss: 1.530 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7434985637664795
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.542 Vali Acc: 0.486 Test Loss: 1.542 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.615558385848999
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.486 Test Loss: 1.524 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8033342361450195
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.499 Vali Acc: 0.514 Test Loss: 1.499 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7176642417907715
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.516 Vali Acc: 0.527 Test Loss: 1.516 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 37880068
model size : 159.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1526901721954346
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.356 Vali Acc: 0.311 Test Loss: 1.356 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.6166503429412842
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.309 Vali Acc: 0.446 Test Loss: 1.309 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.5637087821960449
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.6126174926757812
Epoch: 4, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.235 Vali Acc: 0.568 Test Loss: 1.235 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567555).  Saving model ...
Epoch: 5 cost time: 0.5961899757385254
Epoch: 5, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6560542583465576
Epoch: 6, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6761884689331055
Epoch: 7, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.7133986949920654
Epoch: 8, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6835663318634033
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6339495182037354
Epoch: 10, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.130 Vali Acc: 0.581 Test Loss: 1.130 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7635233402252197
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.124 Vali Acc: 0.608 Test Loss: 1.124 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 0.6103980541229248
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.131 Vali Acc: 0.608 Test Loss: 1.131 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.612316370010376
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.119 Vali Acc: 0.581 Test Loss: 1.119 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6941437721252441
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.150 Vali Acc: 0.581 Test Loss: 1.150 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6077303886413574
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.200 Vali Acc: 0.622 Test Loss: 1.200 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 16 cost time: 0.6314346790313721
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.193 Vali Acc: 0.595 Test Loss: 1.193 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5821993350982666
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.199 Vali Acc: 0.568 Test Loss: 1.199 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5617618560791016
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.211 Vali Acc: 0.554 Test Loss: 1.211 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5853395462036133
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.219 Vali Acc: 0.568 Test Loss: 1.219 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6630618572235107
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.217 Vali Acc: 0.608 Test Loss: 1.217 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5635433197021484
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.235 Vali Acc: 0.622 Test Loss: 1.235 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5586605072021484
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.257 Vali Acc: 0.635 Test Loss: 1.257 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635123).  Saving model ...
Epoch: 23 cost time: 0.5782027244567871
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.276 Vali Acc: 0.622 Test Loss: 1.276 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.591235876083374
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.305 Vali Acc: 0.635 Test Loss: 1.305 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7500901222229004
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.320 Vali Acc: 0.635 Test Loss: 1.320 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6460103988647461
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.324 Vali Acc: 0.635 Test Loss: 1.324 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6013450622558594
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.325 Vali Acc: 0.622 Test Loss: 1.325 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6618528366088867
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.332 Vali Acc: 0.622 Test Loss: 1.332 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5974032878875732
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.351 Vali Acc: 0.635 Test Loss: 1.351 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6246578693389893
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.374 Vali Acc: 0.635 Test Loss: 1.374 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5467240810394287
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.401 Vali Acc: 0.622 Test Loss: 1.401 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5824301242828369
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.392 Vali Acc: 0.635 Test Loss: 1.392 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 37857028
model size : 159.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.000727653503418
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.410 Vali Acc: 0.257 Test Loss: 1.410 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0003995895385742
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.345 Vali Acc: 0.338 Test Loss: 1.345 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.6542305946350098
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.296 Vali Acc: 0.338 Test Loss: 1.296 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.513664722442627
Epoch: 4, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.211 Vali Acc: 0.405 Test Loss: 1.211 Test Acc: 0.405
Validation loss decreased (-0.337825 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.3927993774414062
Epoch: 5, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.168 Vali Acc: 0.541 Test Loss: 1.168 Test Acc: 0.541
Validation loss decreased (-0.405393 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9354658126831055
Epoch: 6, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1898529529571533
Epoch: 7, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.150 Vali Acc: 0.554 Test Loss: 1.150 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.8579821586608887
Epoch: 8, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7206180095672607
Epoch: 9, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.208 Vali Acc: 0.514 Test Loss: 1.208 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7721199989318848
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.282 Vali Acc: 0.514 Test Loss: 1.282 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8859226703643799
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.137 Vali Acc: 0.622 Test Loss: 1.137 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621610).  Saving model ...
Epoch: 12 cost time: 0.6866474151611328
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.817385196685791
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.486 Vali Acc: 0.541 Test Loss: 1.486 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6749684810638428
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.320 Vali Acc: 0.581 Test Loss: 1.320 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7754480838775635
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7206563949584961
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.431 Vali Acc: 0.554 Test Loss: 1.431 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6376168727874756
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.370 Vali Acc: 0.568 Test Loss: 1.370 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7300047874450684
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.340 Vali Acc: 0.568 Test Loss: 1.340 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5006020069122314
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.401 Vali Acc: 0.554 Test Loss: 1.401 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6324412822723389
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.435 Vali Acc: 0.568 Test Loss: 1.435 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7346625328063965
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.407 Vali Acc: 0.568 Test Loss: 1.407 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 38211844
model size : 160.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0661633014678955
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.446 Vali Acc: 0.243 Test Loss: 1.446 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.6149628162384033
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.328 Vali Acc: 0.432 Test Loss: 1.328 Test Acc: 0.432
Validation loss decreased (-0.243229 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.577359676361084
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.7381107807159424
Epoch: 4, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.280 Vali Acc: 0.514 Test Loss: 1.280 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 0.6880576610565186
Epoch: 5, Steps: 10 | Train Loss: 0.944 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.5508589744567871
Epoch: 6, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.6732690334320068
Epoch: 7, Steps: 10 | Train Loss: 0.488 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6219363212585449
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.6020030975341797
Epoch: 9, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6309397220611572
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.668701171875
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.631220817565918
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.252 Vali Acc: 0.514 Test Loss: 1.252 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6919634342193604
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.199 Vali Acc: 0.541 Test Loss: 1.199 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5800416469573975
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.215 Vali Acc: 0.554 Test Loss: 1.215 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7052443027496338
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.242 Vali Acc: 0.541 Test Loss: 1.242 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.55788254737854
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.250 Vali Acc: 0.527 Test Loss: 1.250 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6322956085205078
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.238 Vali Acc: 0.568 Test Loss: 1.238 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567555).  Saving model ...
Epoch: 18 cost time: 0.7383956909179688
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581069).  Saving model ...
Epoch: 19 cost time: 0.7184133529663086
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.256 Vali Acc: 0.568 Test Loss: 1.256 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5909111499786377
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6401541233062744
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7255730628967285
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.348 Vali Acc: 0.541 Test Loss: 1.348 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.874284029006958
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.368 Vali Acc: 0.541 Test Loss: 1.368 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5547788143157959
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.355 Vali Acc: 0.568 Test Loss: 1.355 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5862789154052734
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.346 Vali Acc: 0.568 Test Loss: 1.346 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6685667037963867
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.568 Test Loss: 1.334 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6621901988983154
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7227292060852051
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 38174980
model size : 160.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9661824703216553
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.408 Vali Acc: 0.189 Test Loss: 1.408 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.6324222087860107
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.328 Vali Acc: 0.365 Test Loss: 1.328 Test Acc: 0.365
Validation loss decreased (-0.189175 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.7366392612457275
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.5897424221038818
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.5881247520446777
Epoch: 5, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.6370449066162109
Epoch: 6, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.5174698829650879
Epoch: 7, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.6567080020904541
Epoch: 8, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 0.6288926601409912
Epoch: 9, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.045 Vali Acc: 0.568 Test Loss: 1.045 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6699166297912598
Epoch: 10, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6624424457550049
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.992 Vali Acc: 0.608 Test Loss: 0.992 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 0.668039083480835
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.922 Vali Acc: 0.649 Test Loss: 0.922 Test Acc: 0.649
Validation loss decreased (-0.608098 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 0.5827183723449707
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.948 Vali Acc: 0.622 Test Loss: 0.948 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6159796714782715
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.940 Vali Acc: 0.703 Test Loss: 0.940 Test Acc: 0.703
Validation loss decreased (-0.648639 --> -0.702693).  Saving model ...
Epoch: 15 cost time: 0.5756344795227051
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.948 Vali Acc: 0.689 Test Loss: 0.948 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6259617805480957
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.956 Vali Acc: 0.689 Test Loss: 0.956 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6314346790313721
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.944 Vali Acc: 0.689 Test Loss: 0.944 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6198005676269531
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.945 Vali Acc: 0.689 Test Loss: 0.945 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7335188388824463
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.963 Vali Acc: 0.689 Test Loss: 0.963 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6238019466400146
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.975 Vali Acc: 0.676 Test Loss: 0.975 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5636162757873535
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.995 Vali Acc: 0.689 Test Loss: 0.995 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5610864162445068
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.011 Vali Acc: 0.689 Test Loss: 1.011 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5388553142547607
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.009 Vali Acc: 0.689 Test Loss: 1.009 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6290216445922852
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.007 Vali Acc: 0.689 Test Loss: 1.007 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el5_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7027027027027027
model parameter : 38156548
model size : 160.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7426466941833496
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.407 Vali Acc: 0.257 Test Loss: 1.407 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.2970404624938965
Epoch: 2, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.292 Vali Acc: 0.392 Test Loss: 1.292 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.0560896396636963
Epoch: 3, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.501 Vali Acc: 0.365 Test Loss: 1.501 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3897960186004639
Epoch: 4, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.561 Vali Acc: 0.311 Test Loss: 1.561 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.245680570602417
Epoch: 5, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.155 Vali Acc: 0.486 Test Loss: 1.155 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.741891860961914
Epoch: 6, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.226 Vali Acc: 0.527 Test Loss: 1.226 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.4876797199249268
Epoch: 7, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.347 Vali Acc: 0.541 Test Loss: 1.347 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 8 cost time: 1.4503669738769531
Epoch: 8, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.505 Vali Acc: 0.486 Test Loss: 1.505 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3111071586608887
Epoch: 9, Steps: 10 | Train Loss: 0.075 Vali Loss: 2.624 Vali Acc: 0.446 Test Loss: 2.624 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2853703498840332
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 2.263 Vali Acc: 0.486 Test Loss: 2.263 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.20074462890625
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 2.555 Vali Acc: 0.500 Test Loss: 2.555 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.162327527999878
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 2.502 Vali Acc: 0.554 Test Loss: 2.502 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554029).  Saving model ...
Epoch: 13 cost time: 1.335089921951294
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.433 Vali Acc: 0.405 Test Loss: 3.433 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2052407264709473
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.979 Vali Acc: 0.527 Test Loss: 2.979 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9165678024291992
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 2.818 Vali Acc: 0.514 Test Loss: 2.818 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1045405864715576
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.075 Vali Acc: 0.500 Test Loss: 3.075 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1800391674041748
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.592 Vali Acc: 0.473 Test Loss: 3.592 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6391839981079102
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.330 Vali Acc: 0.432 Test Loss: 3.330 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1424522399902344
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.415 Vali Acc: 0.459 Test Loss: 3.415 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2232177257537842
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 2.906 Vali Acc: 0.541 Test Loss: 2.906 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4732253551483154
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.110 Vali Acc: 0.541 Test Loss: 3.110 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2301664352416992
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.198 Vali Acc: 0.554 Test Loss: 3.198 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 30018052
model size : 129.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5428144931793213
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.374 Vali Acc: 0.405 Test Loss: 1.374 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 1.0127615928649902
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.421 Vali Acc: 0.284 Test Loss: 1.421 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9625873565673828
Epoch: 3, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.296 Vali Acc: 0.459 Test Loss: 1.296 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 0.5909721851348877
Epoch: 4, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.763735294342041
Epoch: 5, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.7253830432891846
Epoch: 6, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.7718546390533447
Epoch: 7, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7922320365905762
Epoch: 8, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7064468860626221
Epoch: 9, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.439 Vali Acc: 0.527 Test Loss: 1.439 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527013).  Saving model ...
Epoch: 10 cost time: 1.1517984867095947
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.649 Vali Acc: 0.486 Test Loss: 1.649 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.760612964630127
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.661 Vali Acc: 0.486 Test Loss: 1.661 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6502170562744141
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 2.335 Vali Acc: 0.446 Test Loss: 2.335 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7700495719909668
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.915 Vali Acc: 0.541 Test Loss: 1.915 Test Acc: 0.541
Validation loss decreased (-0.527013 --> -0.540521).  Saving model ...
Epoch: 14 cost time: 0.8744544982910156
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.630 Vali Acc: 0.527 Test Loss: 1.630 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7210662364959717
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.979 Vali Acc: 0.554 Test Loss: 1.979 Test Acc: 0.554
Validation loss decreased (-0.540521 --> -0.554034).  Saving model ...
Epoch: 16 cost time: 0.7750585079193115
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.907 Vali Acc: 0.541 Test Loss: 1.907 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9403250217437744
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.739 Vali Acc: 0.500 Test Loss: 1.739 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8495159149169922
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.683 Vali Acc: 0.554 Test Loss: 1.683 Test Acc: 0.554
Validation loss decreased (-0.554034 --> -0.554037).  Saving model ...
Epoch: 19 cost time: 0.6347653865814209
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.541 Test Loss: 1.843 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6358184814453125
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.568 Test Loss: 1.778 Test Acc: 0.568
Validation loss decreased (-0.554037 --> -0.567550).  Saving model ...
Epoch: 21 cost time: 0.886805534362793
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.568 Test Loss: 1.726 Test Acc: 0.568
Validation loss decreased (-0.567550 --> -0.567550).  Saving model ...
Epoch: 22 cost time: 0.8456151485443115
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.581 Test Loss: 1.690 Test Acc: 0.581
Validation loss decreased (-0.567550 --> -0.581064).  Saving model ...
Epoch: 23 cost time: 0.875577449798584
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.568 Test Loss: 1.698 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8641598224639893
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.595 Test Loss: 1.725 Test Acc: 0.595
Validation loss decreased (-0.581064 --> -0.594577).  Saving model ...
Epoch: 25 cost time: 1.0880911350250244
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.595 Test Loss: 1.719 Test Acc: 0.595
Validation loss decreased (-0.594577 --> -0.594577).  Saving model ...
Epoch: 26 cost time: 0.7727313041687012
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.595 Test Loss: 1.718 Test Acc: 0.595
Validation loss decreased (-0.594577 --> -0.594577).  Saving model ...
Epoch: 27 cost time: 0.8234658241271973
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.595 Test Loss: 1.727 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2054648399353027
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.733 Vali Acc: 0.595 Test Loss: 1.733 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2643992900848389
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.595 Test Loss: 1.714 Test Acc: 0.595
Validation loss decreased (-0.594577 --> -0.594577).  Saving model ...
Epoch: 30 cost time: 1.154639482498169
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.581 Test Loss: 1.697 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9415574073791504
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.581 Test Loss: 1.706 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.100961446762085
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.581 Test Loss: 1.702 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9930276870727539
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.728 Vali Acc: 0.581 Test Loss: 1.728 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8770172595977783
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.608 Test Loss: 1.738 Test Acc: 0.608
Validation loss decreased (-0.594577 --> -0.608091).  Saving model ...
Epoch: 35 cost time: 1.2234981060028076
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.608 Test Loss: 1.738 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3052949905395508
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.595 Test Loss: 1.741 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0397663116455078
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.595 Test Loss: 1.742 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8909745216369629
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.595 Test Loss: 1.745 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9631571769714355
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.595 Test Loss: 1.752 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0070979595184326
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.595 Test Loss: 1.756 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8955233097076416
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.595 Test Loss: 1.742 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7674152851104736
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.595 Test Loss: 1.732 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0000395774841309
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.595 Test Loss: 1.734 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8602609634399414
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.595 Test Loss: 1.740 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 29796868
model size : 128.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.538341522216797
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.402 Vali Acc: 0.257 Test Loss: 1.402 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.680145263671875
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.366 Vali Acc: 0.257 Test Loss: 1.366 Test Acc: 0.257
Validation loss decreased (-0.256743 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 0.7965333461761475
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.324 Vali Acc: 0.324 Test Loss: 1.324 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.7865116596221924
Epoch: 4, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.257 Vali Acc: 0.392 Test Loss: 1.257 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.7041685581207275
Epoch: 5, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.231 Vali Acc: 0.419 Test Loss: 1.231 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418907).  Saving model ...
Epoch: 6 cost time: 0.6421322822570801
Epoch: 6, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.418907 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.6824636459350586
Epoch: 7, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9126174449920654
Epoch: 8, Steps: 10 | Train Loss: 0.505 Vali Loss: 1.163 Vali Acc: 0.432 Test Loss: 1.163 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7370975017547607
Epoch: 9, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.597095251083374
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.273 Vali Acc: 0.541 Test Loss: 1.273 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 11 cost time: 0.7736678123474121
Epoch: 11, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.378 Vali Acc: 0.514 Test Loss: 1.378 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.894005537033081
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.271 Vali Acc: 0.486 Test Loss: 1.271 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8373370170593262
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.709 Vali Acc: 0.473 Test Loss: 1.709 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7942190170288086
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6638450622558594
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.639 Vali Acc: 0.541 Test Loss: 1.639 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7024714946746826
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.339 Vali Acc: 0.581 Test Loss: 1.339 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581068).  Saving model ...
Epoch: 17 cost time: 0.6679093837738037
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.317 Vali Acc: 0.554 Test Loss: 1.317 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6675000190734863
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.348 Vali Acc: 0.568 Test Loss: 1.348 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6671669483184814
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.339 Vali Acc: 0.527 Test Loss: 1.339 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7919325828552246
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6311588287353516
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.581 Test Loss: 1.349 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.708143949508667
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.343 Vali Acc: 0.568 Test Loss: 1.343 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6227164268493652
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.341 Vali Acc: 0.554 Test Loss: 1.341 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6935181617736816
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.344 Vali Acc: 0.568 Test Loss: 1.344 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8050136566162109
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.527 Test Loss: 1.363 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7166728973388672
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.568 Test Loss: 1.357 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 29686276
model size : 127.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2129580974578857
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.417 Vali Acc: 0.365 Test Loss: 1.417 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.099752426147461
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.468 Vali Acc: 0.243 Test Loss: 1.468 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2387843132019043
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.430 Vali Acc: 0.459 Test Loss: 1.430 Test Acc: 0.459
Validation loss decreased (-0.364851 --> -0.459445).  Saving model ...
Epoch: 4 cost time: 1.13484525680542
Epoch: 4, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.725 Vali Acc: 0.243 Test Loss: 1.725 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5440435409545898
Epoch: 5, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.459445 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.1607913970947266
Epoch: 6, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.353 Vali Acc: 0.446 Test Loss: 1.353 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.280919075012207
Epoch: 7, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.330 Vali Acc: 0.527 Test Loss: 1.330 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 8 cost time: 1.2935967445373535
Epoch: 8, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.549 Vali Acc: 0.486 Test Loss: 1.549 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2489595413208008
Epoch: 9, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.717 Vali Acc: 0.541 Test Loss: 1.717 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540523).  Saving model ...
Epoch: 10 cost time: 1.3614699840545654
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.696 Vali Acc: 0.514 Test Loss: 1.696 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8570871353149414
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.939 Vali Acc: 0.568 Test Loss: 1.939 Test Acc: 0.568
Validation loss decreased (-0.540523 --> -0.567548).  Saving model ...
Epoch: 12 cost time: 0.7811775207519531
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.518 Vali Acc: 0.527 Test Loss: 2.518 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7463715076446533
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 2.321 Vali Acc: 0.541 Test Loss: 2.321 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6812705993652344
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 2.335 Vali Acc: 0.514 Test Loss: 2.335 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6635944843292236
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.579 Vali Acc: 0.527 Test Loss: 2.579 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7322626113891602
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.897 Vali Acc: 0.514 Test Loss: 2.897 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6725671291351318
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.300 Vali Acc: 0.554 Test Loss: 2.300 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7694826126098633
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.335 Vali Acc: 0.554 Test Loss: 2.335 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6796534061431885
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.368 Vali Acc: 0.527 Test Loss: 2.368 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6841325759887695
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.495 Vali Acc: 0.527 Test Loss: 2.495 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8238475322723389
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.640 Vali Acc: 0.514 Test Loss: 2.640 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 29948932
model size : 128.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1513614654541016
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.439 Vali Acc: 0.257 Test Loss: 1.439 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.5395236015319824
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.409 Vali Acc: 0.257 Test Loss: 1.409 Test Acc: 0.257
Validation loss decreased (-0.256742 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 0.5632436275482178
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.341 Vali Acc: 0.324 Test Loss: 1.341 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.6692371368408203
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.322 Vali Acc: 0.473 Test Loss: 1.322 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 0.8776605129241943
Epoch: 5, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.258 Vali Acc: 0.378 Test Loss: 1.258 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6785411834716797
Epoch: 6, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.662043571472168
Epoch: 7, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.7682504653930664
Epoch: 8, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.664 Vali Acc: 0.432 Test Loss: 1.664 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8527133464813232
Epoch: 9, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.217 Vali Acc: 0.514 Test Loss: 1.217 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.623690128326416
Epoch: 10, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.225 Vali Acc: 0.554 Test Loss: 1.225 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 0.5606832504272461
Epoch: 11, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.337 Vali Acc: 0.568 Test Loss: 1.337 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567554).  Saving model ...
Epoch: 12 cost time: 0.6906344890594482
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.409 Vali Acc: 0.581 Test Loss: 1.409 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 13 cost time: 0.6643569469451904
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.766 Vali Acc: 0.527 Test Loss: 1.766 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5483424663543701
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.672 Vali Acc: 0.486 Test Loss: 1.672 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9713022708892822
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.924 Vali Acc: 0.486 Test Loss: 1.924 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6381566524505615
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.910 Vali Acc: 0.500 Test Loss: 1.910 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8419709205627441
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.994 Vali Acc: 0.527 Test Loss: 1.994 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9394598007202148
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.020 Vali Acc: 0.541 Test Loss: 2.020 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.804032564163208
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.933 Vali Acc: 0.514 Test Loss: 1.933 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6455509662628174
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.759 Vali Acc: 0.527 Test Loss: 1.759 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6729624271392822
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.527 Test Loss: 1.718 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1053223609924316
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.527 Test Loss: 1.794 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 29792260
model size : 128.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9558486938476562
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.398 Vali Acc: 0.230 Test Loss: 1.398 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.48375368118286133
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.388 Vali Acc: 0.419 Test Loss: 1.388 Test Acc: 0.419
Validation loss decreased (-0.229716 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 0.8213222026824951
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.378 Vali Acc: 0.338 Test Loss: 1.378 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7474069595336914
Epoch: 4, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.276 Vali Acc: 0.446 Test Loss: 1.276 Test Acc: 0.446
Validation loss decreased (-0.418905 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.9877102375030518
Epoch: 5, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.311 Vali Acc: 0.365 Test Loss: 1.311 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0262842178344727
Epoch: 6, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.191 Vali Acc: 0.554 Test Loss: 1.191 Test Acc: 0.554
Validation loss decreased (-0.445933 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 0.5666875839233398
Epoch: 7, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7963523864746094
Epoch: 8, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.159 Vali Acc: 0.432 Test Loss: 1.159 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7317688465118408
Epoch: 9, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.284 Vali Acc: 0.527 Test Loss: 1.284 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9561436176300049
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.271 Vali Acc: 0.486 Test Loss: 1.271 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6582343578338623
Epoch: 11, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.296 Vali Acc: 0.459 Test Loss: 1.296 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5750315189361572
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.346 Vali Acc: 0.486 Test Loss: 1.346 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6965608596801758
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.443 Vali Acc: 0.500 Test Loss: 1.443 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9095726013183594
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.432 Vali Acc: 0.459 Test Loss: 1.432 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6468863487243652
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6443238258361816
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.406 Vali Acc: 0.554 Test Loss: 1.406 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 29700100
model size : 127.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4210031032562256
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.457 Vali Acc: 0.189 Test Loss: 1.457 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.0434398651123047
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.411 Vali Acc: 0.338 Test Loss: 1.411 Test Acc: 0.338
Validation loss decreased (-0.189175 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.000835657119751
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.262 Vali Acc: 0.392 Test Loss: 1.262 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.9037237167358398
Epoch: 4, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.274 Vali Acc: 0.365 Test Loss: 1.274 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.206618070602417
Epoch: 5, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.0217700004577637
Epoch: 6, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.246 Vali Acc: 0.527 Test Loss: 1.246 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.1365070343017578
Epoch: 7, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.727 Vali Acc: 0.459 Test Loss: 1.727 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1829147338867188
Epoch: 8, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.640 Vali Acc: 0.446 Test Loss: 1.640 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9188380241394043
Epoch: 9, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.496 Vali Acc: 0.486 Test Loss: 1.496 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1375951766967773
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.912 Vali Acc: 0.486 Test Loss: 1.912 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.046250820159912
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.876 Vali Acc: 0.554 Test Loss: 1.876 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554035).  Saving model ...
Epoch: 12 cost time: 0.8491747379302979
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 2.406 Vali Acc: 0.527 Test Loss: 2.406 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8679425716400146
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 2.498 Vali Acc: 0.527 Test Loss: 2.498 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0766074657440186
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.374 Vali Acc: 0.527 Test Loss: 2.374 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8782215118408203
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.368 Vali Acc: 0.527 Test Loss: 2.368 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.990175724029541
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.127 Vali Acc: 0.514 Test Loss: 2.127 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8825068473815918
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.430 Vali Acc: 0.541 Test Loss: 2.430 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0402858257293701
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.268 Vali Acc: 0.554 Test Loss: 2.268 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2880995273590088
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.259 Vali Acc: 0.554 Test Loss: 2.259 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8806068897247314
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.453 Vali Acc: 0.568 Test Loss: 2.453 Test Acc: 0.568
Validation loss decreased (-0.554035 --> -0.567543).  Saving model ...
Epoch: 21 cost time: 1.5115807056427002
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.568 Test Loss: 2.194 Test Acc: 0.568
Validation loss decreased (-0.567543 --> -0.567546).  Saving model ...
Epoch: 22 cost time: 0.9637985229492188
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.108 Vali Acc: 0.581 Test Loss: 2.108 Test Acc: 0.581
Validation loss decreased (-0.567546 --> -0.581060).  Saving model ...
Epoch: 23 cost time: 1.2186527252197266
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.112 Vali Acc: 0.568 Test Loss: 2.112 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0475704669952393
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.581 Test Loss: 2.150 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0222108364105225
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.568 Test Loss: 2.191 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5736525058746338
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.159 Vali Acc: 0.581 Test Loss: 2.159 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2840032577514648
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.581 Test Loss: 2.111 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2719545364379883
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.581 Test Loss: 2.135 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.076035976409912
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.581 Test Loss: 2.173 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8608295917510986
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.208 Vali Acc: 0.581 Test Loss: 2.208 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9092354774475098
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.581 Test Loss: 2.203 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.280808687210083
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.193 Vali Acc: 0.581 Test Loss: 2.193 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 29971972
model size : 129.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.285327911376953
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.353 Vali Acc: 0.338 Test Loss: 1.353 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.617917537689209
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.350 Vali Acc: 0.297 Test Loss: 1.350 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.880131721496582
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.286 Vali Acc: 0.392 Test Loss: 1.286 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.9885478019714355
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.250 Vali Acc: 0.419 Test Loss: 1.250 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.1777856349945068
Epoch: 5, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.079221487045288
Epoch: 6, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.1430540084838867
Epoch: 7, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.589 Vali Acc: 0.392 Test Loss: 1.589 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5960903167724609
Epoch: 8, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.426 Vali Acc: 0.500 Test Loss: 1.426 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8905177116394043
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.249 Vali Acc: 0.541 Test Loss: 1.249 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 0.899583101272583
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.213 Vali Acc: 0.541 Test Loss: 1.213 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 11 cost time: 0.7816617488861084
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.321 Vali Acc: 0.541 Test Loss: 1.321 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.85933518409729
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.155 Vali Acc: 0.662 Test Loss: 1.155 Test Acc: 0.662
Validation loss decreased (-0.540528 --> -0.662151).  Saving model ...
Epoch: 13 cost time: 0.7246510982513428
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.279 Vali Acc: 0.608 Test Loss: 1.279 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6771178245544434
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.350 Vali Acc: 0.581 Test Loss: 1.350 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7331547737121582
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.442 Vali Acc: 0.554 Test Loss: 1.442 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7198972702026367
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.336 Vali Acc: 0.595 Test Loss: 1.336 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7812104225158691
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.568 Test Loss: 1.349 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7487778663635254
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.608 Test Loss: 1.387 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.695967435836792
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.595 Test Loss: 1.403 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6669223308563232
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.608 Test Loss: 1.350 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1632189750671387
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.622 Test Loss: 1.298 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7078101634979248
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.581 Test Loss: 1.328 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 29815300
model size : 128.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.011974334716797
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.384 Vali Acc: 0.324 Test Loss: 1.384 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 0.8803761005401611
Epoch: 2, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6676843166351318
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.294 Vali Acc: 0.459 Test Loss: 1.294 Test Acc: 0.459
Validation loss decreased (-0.324310 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.9203894138336182
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.347 Vali Acc: 0.338 Test Loss: 1.347 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5467028617858887
Epoch: 5, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.6334366798400879
Epoch: 6, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.206 Vali Acc: 0.486 Test Loss: 1.206 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.6714074611663818
Epoch: 7, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.136 Vali Acc: 0.486 Test Loss: 1.136 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.1654706001281738
Epoch: 8, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.154 Vali Acc: 0.432 Test Loss: 1.154 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6644361019134521
Epoch: 9, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.133 Vali Acc: 0.446 Test Loss: 1.133 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7225151062011719
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.7176218032836914
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.305 Vali Acc: 0.486 Test Loss: 1.305 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6969449520111084
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9498209953308105
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6059165000915527
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7257449626922607
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.132 Vali Acc: 0.635 Test Loss: 1.132 Test Acc: 0.635
Validation loss decreased (-0.567557 --> -0.635124).  Saving model ...
Epoch: 16 cost time: 0.7086324691772461
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.232 Vali Acc: 0.608 Test Loss: 1.232 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6858189105987549
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.172 Vali Acc: 0.635 Test Loss: 1.172 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6553792953491211
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.165 Vali Acc: 0.649 Test Loss: 1.165 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648637).  Saving model ...
Epoch: 19 cost time: 0.5983328819274902
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.164 Vali Acc: 0.649 Test Loss: 1.164 Test Acc: 0.649
Validation loss decreased (-0.648637 --> -0.648637).  Saving model ...
Epoch: 20 cost time: 0.5979390144348145
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.171 Vali Acc: 0.649 Test Loss: 1.171 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.639979362487793
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.182 Vali Acc: 0.649 Test Loss: 1.182 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6274735927581787
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.186 Vali Acc: 0.649 Test Loss: 1.186 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8654530048370361
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.218 Vali Acc: 0.635 Test Loss: 1.218 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6793930530548096
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.246 Vali Acc: 0.649 Test Loss: 1.246 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6133041381835938
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.237 Vali Acc: 0.649 Test Loss: 1.237 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.058788776397705
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.229 Vali Acc: 0.662 Test Loss: 1.229 Test Acc: 0.662
Validation loss decreased (-0.648637 --> -0.662150).  Saving model ...
Epoch: 27 cost time: 0.6820595264434814
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.649 Test Loss: 1.258 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6653273105621338
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.274 Vali Acc: 0.649 Test Loss: 1.274 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6303584575653076
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.649 Test Loss: 1.282 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4857828617095947
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.649 Test Loss: 1.250 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6291475296020508
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.246 Vali Acc: 0.649 Test Loss: 1.246 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7420005798339844
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.649 Test Loss: 1.254 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7100002765655518
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.662 Test Loss: 1.282 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.579559326171875
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.283 Vali Acc: 0.649 Test Loss: 1.283 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5478825569152832
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.246 Vali Acc: 0.662 Test Loss: 1.246 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.008533239364624
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.244 Vali Acc: 0.662 Test Loss: 1.244 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 29718532
model size : 128.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2420003414154053
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.439 Vali Acc: 0.203 Test Loss: 1.439 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.9495019912719727
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.537 Vali Acc: 0.230 Test Loss: 1.537 Test Acc: 0.230
Validation loss decreased (-0.202688 --> -0.229714).  Saving model ...
Epoch: 3 cost time: 0.8572521209716797
Epoch: 3, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.485 Vali Acc: 0.297 Test Loss: 1.485 Test Acc: 0.297
Validation loss decreased (-0.229714 --> -0.297282).  Saving model ...
Epoch: 4 cost time: 0.9917938709259033
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.202 Vali Acc: 0.459 Test Loss: 1.202 Test Acc: 0.459
Validation loss decreased (-0.297282 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.2109770774841309
Epoch: 5, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.150 Vali Acc: 0.554 Test Loss: 1.150 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.263899564743042
Epoch: 6, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.290 Vali Acc: 0.581 Test Loss: 1.290 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581068).  Saving model ...
Epoch: 7 cost time: 1.2646865844726562
Epoch: 7, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.365 Vali Acc: 0.554 Test Loss: 1.365 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0458319187164307
Epoch: 8, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.432 Vali Acc: 0.527 Test Loss: 1.432 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3734540939331055
Epoch: 9, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.555 Vali Acc: 0.486 Test Loss: 1.555 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4314792156219482
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.799 Vali Acc: 0.554 Test Loss: 1.799 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1815853118896484
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.224 Vali Acc: 0.500 Test Loss: 2.224 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9200742244720459
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.991 Vali Acc: 0.459 Test Loss: 1.991 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9781398773193359
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.469 Vali Acc: 0.500 Test Loss: 2.469 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0261082649230957
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.009 Vali Acc: 0.554 Test Loss: 2.009 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3440430164337158
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.111 Vali Acc: 0.527 Test Loss: 2.111 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0643539428710938
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.192 Vali Acc: 0.554 Test Loss: 2.192 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 29995012
model size : 129.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2383790016174316
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.415 Vali Acc: 0.230 Test Loss: 1.415 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.6849544048309326
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.355 Vali Acc: 0.324 Test Loss: 1.355 Test Acc: 0.324
Validation loss decreased (-0.229716 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.6712074279785156
Epoch: 3, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.308 Vali Acc: 0.432 Test Loss: 1.308 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.6695170402526855
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.373 Vali Acc: 0.351 Test Loss: 1.373 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6536154747009277
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.5717306137084961
Epoch: 6, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.6518101692199707
Epoch: 7, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.558 Vali Acc: 0.459 Test Loss: 1.558 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6401481628417969
Epoch: 8, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.396 Vali Acc: 0.554 Test Loss: 1.396 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554040).  Saving model ...
Epoch: 9 cost time: 0.6265740394592285
Epoch: 9, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.322 Vali Acc: 0.541 Test Loss: 1.322 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7468016147613525
Epoch: 10, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.312 Vali Acc: 0.568 Test Loss: 1.312 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567554).  Saving model ...
Epoch: 11 cost time: 0.536229133605957
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.345 Vali Acc: 0.581 Test Loss: 1.345 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581068).  Saving model ...
Epoch: 12 cost time: 0.966926097869873
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.741 Vali Acc: 0.527 Test Loss: 1.741 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8231296539306641
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.618 Vali Acc: 0.595 Test Loss: 1.618 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594578).  Saving model ...
Epoch: 14 cost time: 0.6909511089324951
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.456 Vali Acc: 0.595 Test Loss: 1.456 Test Acc: 0.595
Validation loss decreased (-0.594578 --> -0.594580).  Saving model ...
Epoch: 15 cost time: 0.7378060817718506
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.450 Vali Acc: 0.581 Test Loss: 1.450 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8864932060241699
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.547 Vali Acc: 0.568 Test Loss: 1.547 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7715001106262207
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.486 Vali Acc: 0.581 Test Loss: 1.486 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5805387496948242
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.528 Vali Acc: 0.581 Test Loss: 1.528 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7779905796051025
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.588 Vali Acc: 0.581 Test Loss: 1.588 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9802956581115723
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.568 Test Loss: 1.579 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9066257476806641
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.581 Test Loss: 1.556 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6842210292816162
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.581 Test Loss: 1.579 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.709542989730835
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.581 Test Loss: 1.606 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9515674114227295
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.595 Test Loss: 1.558 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 29819908
model size : 128.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.246447801589966
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.335 Vali Acc: 0.378 Test Loss: 1.335 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.5523183345794678
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.318 Vali Acc: 0.378 Test Loss: 1.318 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.618959903717041
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.300 Vali Acc: 0.405 Test Loss: 1.300 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.592144250869751
Epoch: 4, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.9739210605621338
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.193 Vali Acc: 0.554 Test Loss: 1.193 Test Acc: 0.554
Validation loss decreased (-0.418906 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 0.5735881328582764
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.5816538333892822
Epoch: 7, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.070 Vali Acc: 0.473 Test Loss: 1.070 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5937237739562988
Epoch: 8, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7183794975280762
Epoch: 9, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6461894512176514
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.243 Vali Acc: 0.527 Test Loss: 1.243 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6047406196594238
Epoch: 11, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.232 Vali Acc: 0.541 Test Loss: 1.232 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8657732009887695
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5894906520843506
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5691511631011963
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.262 Vali Acc: 0.527 Test Loss: 1.262 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5488474369049072
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.425 Vali Acc: 0.554 Test Loss: 1.425 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7502198219299316
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.333 Vali Acc: 0.554 Test Loss: 1.333 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 29736964
model size : 128.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3018603324890137
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.430 Vali Acc: 0.189 Test Loss: 1.430 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.9455461502075195
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
Validation loss decreased (-0.189175 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.044020652770996
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.283 Vali Acc: 0.446 Test Loss: 1.283 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.8474850654602051
Epoch: 4, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.410 Vali Acc: 0.392 Test Loss: 1.410 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.545125961303711
Epoch: 5, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.218 Vali Acc: 0.514 Test Loss: 1.218 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.0176739692687988
Epoch: 6, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3648707866668701
Epoch: 7, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.606 Vali Acc: 0.473 Test Loss: 1.606 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9068484306335449
Epoch: 8, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.971 Vali Acc: 0.459 Test Loss: 1.971 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9773309230804443
Epoch: 9, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.835 Vali Acc: 0.459 Test Loss: 1.835 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0354194641113281
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 2.322 Vali Acc: 0.446 Test Loss: 2.322 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0264029502868652
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.112 Vali Acc: 0.527 Test Loss: 2.112 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527006).  Saving model ...
Epoch: 12 cost time: 0.9057915210723877
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 2.512 Vali Acc: 0.568 Test Loss: 2.512 Test Acc: 0.568
Validation loss decreased (-0.527006 --> -0.567542).  Saving model ...
Epoch: 13 cost time: 0.7421572208404541
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 2.358 Vali Acc: 0.500 Test Loss: 2.358 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8950152397155762
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 2.325 Vali Acc: 0.527 Test Loss: 2.325 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0568861961364746
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 2.106 Vali Acc: 0.595 Test Loss: 2.106 Test Acc: 0.595
Validation loss decreased (-0.567542 --> -0.594574).  Saving model ...
Epoch: 16 cost time: 0.8777213096618652
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.093 Vali Acc: 0.554 Test Loss: 2.093 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8549327850341797
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.185 Vali Acc: 0.541 Test Loss: 2.185 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8894317150115967
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.180 Vali Acc: 0.554 Test Loss: 2.180 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0316810607910156
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.554 Test Loss: 2.223 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3739960193634033
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.232 Vali Acc: 0.554 Test Loss: 2.232 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9079270362854004
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.554 Test Loss: 2.223 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9718730449676514
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.541 Test Loss: 2.203 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.149998664855957
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.193 Vali Acc: 0.541 Test Loss: 2.193 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2163987159729004
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.541 Test Loss: 2.194 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1210999488830566
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.193 Vali Acc: 0.541 Test Loss: 2.193 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 30018052
model size : 129.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.214057683944702
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.392 Vali Acc: 0.311 Test Loss: 1.392 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.805227518081665
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.376 Vali Acc: 0.351 Test Loss: 1.376 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.5831201076507568
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.282 Vali Acc: 0.486 Test Loss: 1.282 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.7654073238372803
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.302 Vali Acc: 0.419 Test Loss: 1.302 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0416271686553955
Epoch: 5, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9471695423126221
Epoch: 6, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5903007984161377
Epoch: 7, Steps: 10 | Train Loss: 0.636 Vali Loss: 1.219 Vali Acc: 0.459 Test Loss: 1.219 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6510603427886963
Epoch: 8, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 0.9976825714111328
Epoch: 9, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.431 Vali Acc: 0.432 Test Loss: 1.431 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8710222244262695
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.426 Vali Acc: 0.514 Test Loss: 1.426 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2901995182037354
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.638 Vali Acc: 0.500 Test Loss: 1.638 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8483915328979492
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.516 Vali Acc: 0.622 Test Loss: 1.516 Test Acc: 0.622
Validation loss decreased (-0.554042 --> -0.621606).  Saving model ...
Epoch: 13 cost time: 0.6837723255157471
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.514 Vali Acc: 0.486 Test Loss: 1.514 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6282281875610352
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.496 Vali Acc: 0.541 Test Loss: 1.496 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9311258792877197
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.784 Vali Acc: 0.446 Test Loss: 1.784 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7212827205657959
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7778224945068359
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.640 Vali Acc: 0.514 Test Loss: 1.640 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0373687744140625
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.427 Vali Acc: 0.581 Test Loss: 1.427 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8500089645385742
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.541 Test Loss: 1.469 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7132749557495117
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.554 Test Loss: 1.599 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7433102130889893
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.476 Vali Acc: 0.581 Test Loss: 1.476 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5913400650024414
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.581 Test Loss: 1.451 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 29842948
model size : 128.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9624698162078857
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.410 Vali Acc: 0.216 Test Loss: 1.410 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.5440948009490967
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.362 Vali Acc: 0.351 Test Loss: 1.362 Test Acc: 0.351
Validation loss decreased (-0.216202 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.5050656795501709
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.323 Vali Acc: 0.446 Test Loss: 1.323 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.5846199989318848
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.311 Vali Acc: 0.486 Test Loss: 1.311 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486473).  Saving model ...
Epoch: 5 cost time: 0.7030580043792725
Epoch: 5, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.225 Vali Acc: 0.514 Test Loss: 1.225 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 0.6734738349914551
Epoch: 6, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.235 Vali Acc: 0.432 Test Loss: 1.235 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5713210105895996
Epoch: 7, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.6078073978424072
Epoch: 8, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.176 Vali Acc: 0.541 Test Loss: 1.176 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5990200042724609
Epoch: 9, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6121635437011719
Epoch: 10, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.408 Vali Acc: 0.486 Test Loss: 1.408 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6064200401306152
Epoch: 11, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5777888298034668
Epoch: 12, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.654 Vali Acc: 0.432 Test Loss: 1.654 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5563297271728516
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.476 Vali Acc: 0.500 Test Loss: 1.476 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.509270191192627
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.446 Vali Acc: 0.541 Test Loss: 1.446 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5971500873565674
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.464 Vali Acc: 0.486 Test Loss: 1.464 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5631933212280273
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.527 Vali Acc: 0.500 Test Loss: 1.527 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6113741397857666
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.549 Vali Acc: 0.473 Test Loss: 1.549 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 29755396
model size : 128.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3097333908081055
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.313 Vali Acc: 0.459 Test Loss: 1.313 Test Acc: 0.459
Validation loss decreased (inf --> -0.459446).  Saving model ...
Epoch: 2 cost time: 0.7702929973602295
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.314 Vali Acc: 0.324 Test Loss: 1.314 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9237606525421143
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.312 Vali Acc: 0.351 Test Loss: 1.312 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7042174339294434
Epoch: 4, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.6521761417388916
Epoch: 5, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.123 Vali Acc: 0.527 Test Loss: 1.123 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.654909610748291
Epoch: 6, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.104 Vali Acc: 0.486 Test Loss: 1.104 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1234803199768066
Epoch: 7, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 0.8495228290557861
Epoch: 8, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.317 Vali Acc: 0.581 Test Loss: 1.317 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581068).  Saving model ...
Epoch: 9 cost time: 0.795515775680542
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.726 Vali Acc: 0.500 Test Loss: 1.726 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9932687282562256
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.576 Vali Acc: 0.568 Test Loss: 1.576 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9466397762298584
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.661 Vali Acc: 0.514 Test Loss: 1.661 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6148736476898193
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.614 Vali Acc: 0.554 Test Loss: 1.614 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6421482563018799
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.003 Vali Acc: 0.554 Test Loss: 2.003 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6265482902526855
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.753 Vali Acc: 0.568 Test Loss: 1.753 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5966763496398926
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.010 Vali Acc: 0.581 Test Loss: 2.010 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6022486686706543
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.024 Vali Acc: 0.514 Test Loss: 2.024 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7991762161254883
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.919 Vali Acc: 0.581 Test Loss: 1.919 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.892648458480835
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.820 Vali Acc: 0.473 Test Loss: 2.820 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 30004228
model size : 129.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.88029146194458
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.416 Vali Acc: 0.257 Test Loss: 1.416 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.644721269607544
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.332 Vali Acc: 0.405 Test Loss: 1.332 Test Acc: 0.405
Validation loss decreased (-0.256743 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.7068219184875488
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.343 Vali Acc: 0.432 Test Loss: 1.343 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.6867630481719971
Epoch: 4, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
Validation loss decreased (-0.432419 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 0.9383435249328613
Epoch: 5, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5124650001525879
Epoch: 6, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8486452102661133
Epoch: 7, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7663602828979492
Epoch: 8, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6709072589874268
Epoch: 9, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.382 Vali Acc: 0.473 Test Loss: 1.382 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.674067497253418
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.509 Vali Acc: 0.514 Test Loss: 1.509 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9662988185882568
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.115593671798706
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.965 Vali Acc: 0.541 Test Loss: 1.965 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2556755542755127
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.354 Vali Acc: 0.554 Test Loss: 1.354 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 14 cost time: 0.8846590518951416
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.723 Vali Acc: 0.459 Test Loss: 1.723 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9533758163452148
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.581 Vali Acc: 0.541 Test Loss: 1.581 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.367971658706665
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6649107933044434
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.418 Vali Acc: 0.500 Test Loss: 1.418 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5352356433868408
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.705 Vali Acc: 0.514 Test Loss: 1.705 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.622739315032959
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.627 Vali Acc: 0.527 Test Loss: 1.627 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7461245059967041
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.554 Test Loss: 1.466 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6519479751586914
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.514 Test Loss: 1.455 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0836141109466553
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.541 Test Loss: 1.485 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1717596054077148
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.541 Test Loss: 1.526 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 29870596
model size : 128.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4975180625915527
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.411 Vali Acc: 0.189 Test Loss: 1.411 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.6584005355834961
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.408 Vali Acc: 0.216 Test Loss: 1.408 Test Acc: 0.216
Validation loss decreased (-0.189175 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 1.0078787803649902
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.359 Vali Acc: 0.297 Test Loss: 1.359 Test Acc: 0.297
Validation loss decreased (-0.216202 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.1292591094970703
Epoch: 4, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.287 Vali Acc: 0.473 Test Loss: 1.287 Test Acc: 0.473
Validation loss decreased (-0.297284 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 0.8896129131317139
Epoch: 5, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.302 Vali Acc: 0.338 Test Loss: 1.302 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0151686668395996
Epoch: 6, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.9291157722473145
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.229 Vali Acc: 0.392 Test Loss: 1.229 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7988548278808594
Epoch: 8, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.8405971527099609
Epoch: 9, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.307 Vali Acc: 0.514 Test Loss: 1.307 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0578811168670654
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.369 Vali Acc: 0.419 Test Loss: 1.369 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7803678512573242
Epoch: 11, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7026653289794922
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554041).  Saving model ...
Epoch: 13 cost time: 0.8511703014373779
Epoch: 13, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.308 Vali Acc: 0.473 Test Loss: 1.308 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5512528419494629
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8089683055877686
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.391 Vali Acc: 0.541 Test Loss: 1.391 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7873384952545166
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.420 Vali Acc: 0.568 Test Loss: 1.420 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567553).  Saving model ...
Epoch: 17 cost time: 0.6871623992919922
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.405 Vali Acc: 0.595 Test Loss: 1.405 Test Acc: 0.595
Validation loss decreased (-0.567553 --> -0.594581).  Saving model ...
Epoch: 18 cost time: 0.8803501129150391
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.444 Vali Acc: 0.581 Test Loss: 1.444 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0701661109924316
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.440 Vali Acc: 0.581 Test Loss: 1.440 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6726152896881104
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.426 Vali Acc: 0.595 Test Loss: 1.426 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.473341703414917
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.502 Vali Acc: 0.568 Test Loss: 1.502 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5098912715911865
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.521 Vali Acc: 0.568 Test Loss: 1.521 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6500585079193115
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.463 Vali Acc: 0.568 Test Loss: 1.463 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0580928325653076
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.495 Vali Acc: 0.554 Test Loss: 1.495 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7038571834564209
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.531 Vali Acc: 0.581 Test Loss: 1.531 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6789095401763916
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.531 Vali Acc: 0.581 Test Loss: 1.531 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6738412380218506
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.523 Vali Acc: 0.568 Test Loss: 1.523 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 29792260
model size : 128.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.070519208908081
Epoch: 1, Steps: 10 | Train Loss: 1.605 Vali Loss: 1.423 Vali Acc: 0.297 Test Loss: 1.423 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.380223035812378
Epoch: 2, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.408 Vali Acc: 0.257 Test Loss: 1.408 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.236095666885376
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.350 Vali Acc: 0.419 Test Loss: 1.350 Test Acc: 0.419
Validation loss decreased (-0.297283 --> -0.418905).  Saving model ...
Epoch: 4 cost time: 1.8958311080932617
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.207 Vali Acc: 0.378 Test Loss: 1.207 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4973280429840088
Epoch: 5, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.418905 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.309685468673706
Epoch: 6, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 7 cost time: 0.8737201690673828
Epoch: 7, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.601 Vali Acc: 0.446 Test Loss: 1.601 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3892409801483154
Epoch: 8, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.739 Vali Acc: 0.486 Test Loss: 1.739 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9398994445800781
Epoch: 9, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.671 Vali Acc: 0.486 Test Loss: 1.671 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1325254440307617
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.906 Vali Acc: 0.500 Test Loss: 1.906 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2389960289001465
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.114 Vali Acc: 0.419 Test Loss: 2.114 Test Acc: 0.419
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0793209075927734
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.962 Vali Acc: 0.541 Test Loss: 1.962 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540521).  Saving model ...
Epoch: 13 cost time: 1.401315450668335
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.325 Vali Acc: 0.473 Test Loss: 2.325 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.147583246231079
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.271 Vali Acc: 0.500 Test Loss: 2.271 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.074554681777954
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.114 Vali Acc: 0.568 Test Loss: 2.114 Test Acc: 0.568
Validation loss decreased (-0.540521 --> -0.567546).  Saving model ...
Epoch: 16 cost time: 1.4455657005310059
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.361 Vali Acc: 0.446 Test Loss: 2.361 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9168517589569092
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.086 Vali Acc: 0.554 Test Loss: 2.086 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.921497106552124
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.015 Vali Acc: 0.527 Test Loss: 2.015 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4172356128692627
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.259 Vali Acc: 0.554 Test Loss: 2.259 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8492281436920166
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.387 Vali Acc: 0.527 Test Loss: 2.387 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.868767261505127
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.234 Vali Acc: 0.554 Test Loss: 2.234 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9096143245697021
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.541 Test Loss: 2.183 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.374619722366333
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.541 Test Loss: 2.164 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2117059230804443
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.541 Test Loss: 2.166 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2309250831604004
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.178 Vali Acc: 0.541 Test Loss: 2.178 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 30022660
model size : 129.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2584352493286133
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.369 Vali Acc: 0.311 Test Loss: 1.369 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9762651920318604
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.335 Vali Acc: 0.311 Test Loss: 1.335 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.6476709842681885
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.249 Vali Acc: 0.514 Test Loss: 1.249 Test Acc: 0.514
Validation loss decreased (-0.310797 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.7102231979370117
Epoch: 4, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.208 Vali Acc: 0.432 Test Loss: 1.208 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0874764919281006
Epoch: 5, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.135 Vali Acc: 0.568 Test Loss: 1.135 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.6756908893585205
Epoch: 6, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.099 Vali Acc: 0.541 Test Loss: 1.099 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6854710578918457
Epoch: 7, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1452314853668213
Epoch: 8, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.372 Vali Acc: 0.514 Test Loss: 1.372 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0684053897857666
Epoch: 9, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.481 Vali Acc: 0.446 Test Loss: 1.481 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7008280754089355
Epoch: 10, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.955 Vali Acc: 0.446 Test Loss: 1.955 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8339669704437256
Epoch: 11, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.536 Vali Acc: 0.541 Test Loss: 1.536 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7216610908508301
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.645 Vali Acc: 0.500 Test Loss: 1.645 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4862062931060791
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.487 Vali Acc: 0.514 Test Loss: 1.487 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5359313488006592
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.539 Vali Acc: 0.527 Test Loss: 1.539 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7478234767913818
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.537 Vali Acc: 0.554 Test Loss: 1.537 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 29879812
model size : 128.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.976167917251587
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.379 Vali Acc: 0.378 Test Loss: 1.379 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.712714433670044
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6508488655090332
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.319 Vali Acc: 0.378 Test Loss: 1.319 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.579721212387085
Epoch: 4, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.321 Vali Acc: 0.365 Test Loss: 1.321 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8234090805053711
Epoch: 5, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.251 Vali Acc: 0.405 Test Loss: 1.251 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.6731858253479004
Epoch: 6, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.205 Vali Acc: 0.446 Test Loss: 1.205 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.786937952041626
Epoch: 7, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.180 Vali Acc: 0.473 Test Loss: 1.180 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.8495254516601562
Epoch: 8, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 0.6353027820587158
Epoch: 9, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8368227481842041
Epoch: 10, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.337 Vali Acc: 0.473 Test Loss: 1.337 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6054134368896484
Epoch: 11, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.455 Vali Acc: 0.486 Test Loss: 1.455 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5278871059417725
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 0.7798845767974854
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.634 Vali Acc: 0.446 Test Loss: 1.634 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.602125883102417
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.226 Vali Acc: 0.527 Test Loss: 1.226 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7419054508209229
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.508 Vali Acc: 0.541 Test Loss: 1.508 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6980688571929932
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.443 Vali Acc: 0.554 Test Loss: 1.443 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554040).  Saving model ...
Epoch: 17 cost time: 0.7190027236938477
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.397 Vali Acc: 0.541 Test Loss: 1.397 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.620232105255127
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
Validation loss decreased (-0.554040 --> -0.581067).  Saving model ...
Epoch: 19 cost time: 0.7233288288116455
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.467 Vali Acc: 0.595 Test Loss: 1.467 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594580).  Saving model ...
Epoch: 20 cost time: 0.7352132797241211
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.478 Vali Acc: 0.595 Test Loss: 1.478 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6771938800811768
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.472 Vali Acc: 0.595 Test Loss: 1.472 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7865972518920898
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.495 Vali Acc: 0.581 Test Loss: 1.495 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7180297374725342
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.509 Vali Acc: 0.581 Test Loss: 1.509 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6937487125396729
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.500 Vali Acc: 0.581 Test Loss: 1.500 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8040335178375244
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.469 Vali Acc: 0.581 Test Loss: 1.469 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7559142112731934
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.445 Vali Acc: 0.581 Test Loss: 1.445 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5720901489257812
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.486 Vali Acc: 0.568 Test Loss: 1.486 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7263107299804688
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.521 Vali Acc: 0.568 Test Loss: 1.521 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9361872673034668
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.548 Vali Acc: 0.568 Test Loss: 1.548 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 29810692
model size : 128.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.903846025466919
Epoch: 1, Steps: 10 | Train Loss: 1.538 Vali Loss: 1.377 Vali Acc: 0.378 Test Loss: 1.377 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.8389654159545898
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.261 Vali Acc: 0.405 Test Loss: 1.261 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 0.8484761714935303
Epoch: 3, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.5101046562194824
Epoch: 4, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.160 Vali Acc: 0.473 Test Loss: 1.160 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.443880319595337
Epoch: 5, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.226 Vali Acc: 0.459 Test Loss: 1.226 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9503641128540039
Epoch: 6, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.809 Vali Acc: 0.338 Test Loss: 1.809 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3189177513122559
Epoch: 7, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.442 Vali Acc: 0.514 Test Loss: 1.442 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513499).  Saving model ...
Epoch: 8 cost time: 0.8537554740905762
Epoch: 8, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.644 Vali Acc: 0.459 Test Loss: 1.644 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7586171627044678
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 2.188 Vali Acc: 0.486 Test Loss: 2.188 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8456916809082031
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.730 Vali Acc: 0.527 Test Loss: 1.730 Test Acc: 0.527
Validation loss decreased (-0.513499 --> -0.527010).  Saving model ...
Epoch: 11 cost time: 0.9237310886383057
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.755 Vali Acc: 0.541 Test Loss: 1.755 Test Acc: 0.541
Validation loss decreased (-0.527010 --> -0.540523).  Saving model ...
Epoch: 12 cost time: 1.007516622543335
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.862 Vali Acc: 0.514 Test Loss: 1.862 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2984635829925537
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.049 Vali Acc: 0.486 Test Loss: 2.049 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.257430076599121
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.918 Vali Acc: 0.514 Test Loss: 1.918 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5138511657714844
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.107 Vali Acc: 0.527 Test Loss: 2.107 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5073349475860596
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.020 Vali Acc: 0.595 Test Loss: 2.020 Test Acc: 0.595
Validation loss decreased (-0.540523 --> -0.594574).  Saving model ...
Epoch: 17 cost time: 1.13846755027771
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.997 Vali Acc: 0.581 Test Loss: 1.997 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1255252361297607
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.000 Vali Acc: 0.581 Test Loss: 2.000 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0382075309753418
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.040 Vali Acc: 0.581 Test Loss: 2.040 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4518139362335205
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.095 Vali Acc: 0.568 Test Loss: 2.095 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7970788478851318
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.097 Vali Acc: 0.595 Test Loss: 2.097 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5147666931152344
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.051 Vali Acc: 0.608 Test Loss: 2.051 Test Acc: 0.608
Validation loss decreased (-0.594574 --> -0.608088).  Saving model ...
Epoch: 23 cost time: 0.9211204051971436
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.622 Test Loss: 2.016 Test Acc: 0.622
Validation loss decreased (-0.608088 --> -0.621601).  Saving model ...
Epoch: 24 cost time: 0.9925665855407715
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.622 Test Loss: 2.010 Test Acc: 0.622
Validation loss decreased (-0.621601 --> -0.621602).  Saving model ...
Epoch: 25 cost time: 1.0288701057434082
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.011 Vali Acc: 0.622 Test Loss: 2.011 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.326528787612915
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.622 Test Loss: 2.010 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0769011974334717
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.622 Test Loss: 2.010 Test Acc: 0.622
Validation loss decreased (-0.621602 --> -0.621602).  Saving model ...
Epoch: 28 cost time: 1.1787633895874023
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.622 Test Loss: 2.009 Test Acc: 0.622
Validation loss decreased (-0.621602 --> -0.621602).  Saving model ...
Epoch: 29 cost time: 0.8739736080169678
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.635 Test Loss: 2.009 Test Acc: 0.635
Validation loss decreased (-0.621602 --> -0.635115).  Saving model ...
Epoch: 30 cost time: 1.1399648189544678
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.622 Test Loss: 2.023 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.018557071685791
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.622 Test Loss: 2.026 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9151949882507324
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.022 Vali Acc: 0.622 Test Loss: 2.022 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3847265243530273
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.021 Vali Acc: 0.608 Test Loss: 2.021 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2460055351257324
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.595 Test Loss: 2.025 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9525222778320312
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.033 Vali Acc: 0.595 Test Loss: 2.033 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0219604969024658
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.595 Test Loss: 2.035 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1360721588134766
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.595 Test Loss: 2.029 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3808565139770508
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.595 Test Loss: 2.025 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3031928539276123
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.009 Vali Acc: 0.608 Test Loss: 2.009 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 30045700
model size : 129.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.539456844329834
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.393 Vali Acc: 0.311 Test Loss: 1.393 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.915560245513916
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.330 Vali Acc: 0.324 Test Loss: 1.330 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.002929449081421
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.281 Vali Acc: 0.446 Test Loss: 1.281 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.93792724609375
Epoch: 4, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.248 Vali Acc: 0.405 Test Loss: 1.248 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8452205657958984
Epoch: 5, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.7813849449157715
Epoch: 6, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9195988178253174
Epoch: 7, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7729485034942627
Epoch: 8, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.356 Vali Acc: 0.500 Test Loss: 1.356 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2317636013031006
Epoch: 9, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.314 Vali Acc: 0.608 Test Loss: 1.314 Test Acc: 0.608
Validation loss decreased (-0.499988 --> -0.608095).  Saving model ...
Epoch: 10 cost time: 0.8054165840148926
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.255 Vali Acc: 0.568 Test Loss: 1.255 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7302772998809814
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.581 Vali Acc: 0.486 Test Loss: 1.581 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7001755237579346
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.507 Vali Acc: 0.514 Test Loss: 1.507 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.015714168548584
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.673 Vali Acc: 0.459 Test Loss: 1.673 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6829242706298828
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.510 Vali Acc: 0.527 Test Loss: 1.510 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7273106575012207
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.629 Vali Acc: 0.514 Test Loss: 1.629 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5361745357513428
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.616 Vali Acc: 0.514 Test Loss: 1.616 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6572737693786621
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8136200904846191
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.514 Test Loss: 1.550 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7792236804962158
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.549 Vali Acc: 0.514 Test Loss: 1.549 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 29902852
model size : 128.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.157048463821411
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.411 Vali Acc: 0.257 Test Loss: 1.411 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.6936979293823242
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.384 Vali Acc: 0.230 Test Loss: 1.384 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6128318309783936
Epoch: 3, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.359 Vali Acc: 0.324 Test Loss: 1.359 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.6429595947265625
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.279 Vali Acc: 0.419 Test Loss: 1.279 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.9604682922363281
Epoch: 5, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.250 Vali Acc: 0.473 Test Loss: 1.250 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 0.6611766815185547
Epoch: 6, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0466115474700928
Epoch: 7, Steps: 10 | Train Loss: 0.746 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.6376035213470459
Epoch: 8, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.111 Vali Acc: 0.514 Test Loss: 1.111 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.9241428375244141
Epoch: 9, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.0457730293273926
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1228978633880615
Epoch: 11, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.681694746017456
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.191 Vali Acc: 0.459 Test Loss: 1.191 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1468181610107422
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8308315277099609
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 15 cost time: 0.7219524383544922
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.275 Vali Acc: 0.541 Test Loss: 1.275 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1914036273956299
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.325 Vali Acc: 0.541 Test Loss: 1.325 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8876163959503174
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.415 Vali Acc: 0.486 Test Loss: 1.415 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6023828983306885
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.392 Vali Acc: 0.541 Test Loss: 1.392 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8383455276489258
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.379 Vali Acc: 0.514 Test Loss: 1.379 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8979363441467285
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.387 Vali Acc: 0.568 Test Loss: 1.387 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567554).  Saving model ...
Epoch: 21 cost time: 0.6519057750701904
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.391 Vali Acc: 0.554 Test Loss: 1.391 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5501315593719482
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.410 Vali Acc: 0.541 Test Loss: 1.410 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5985333919525146
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.438 Vali Acc: 0.568 Test Loss: 1.438 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8856987953186035
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.430 Vali Acc: 0.554 Test Loss: 1.430 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8358190059661865
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.407 Vali Acc: 0.581 Test Loss: 1.407 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 26 cost time: 0.597435474395752
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.398 Vali Acc: 0.568 Test Loss: 1.398 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5935733318328857
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.568 Test Loss: 1.421 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9881110191345215
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.432 Vali Acc: 0.554 Test Loss: 1.432 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8912041187286377
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.454 Vali Acc: 0.554 Test Loss: 1.454 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6055915355682373
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.444 Vali Acc: 0.554 Test Loss: 1.444 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5623681545257568
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.554 Test Loss: 1.429 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1285080909729004
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.554 Test Loss: 1.424 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.848008394241333
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.568 Test Loss: 1.416 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4910595417022705
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.554 Test Loss: 1.417 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6425457000732422
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.581 Test Loss: 1.424 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 29829124
model size : 128.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1158132553100586
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.7052145004272461
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.473 Vali Acc: 0.230 Test Loss: 1.473 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5996763706207275
Epoch: 3, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
Validation loss decreased (-0.243229 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.1452312469482422
Epoch: 4, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.273 Vali Acc: 0.473 Test Loss: 1.273 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.2748403549194336
Epoch: 5, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.267 Vali Acc: 0.459 Test Loss: 1.267 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5164644718170166
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.9339375495910645
Epoch: 7, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.1069366931915283
Epoch: 8, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.413 Vali Acc: 0.568 Test Loss: 1.413 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567553).  Saving model ...
Epoch: 9 cost time: 1.0227007865905762
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.476 Vali Acc: 0.541 Test Loss: 1.476 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0057239532470703
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.917 Vali Acc: 0.541 Test Loss: 1.917 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8487300872802734
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.803 Vali Acc: 0.514 Test Loss: 1.803 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.413304328918457
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.952 Vali Acc: 0.541 Test Loss: 1.952 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9128842353820801
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.630 Vali Acc: 0.608 Test Loss: 1.630 Test Acc: 0.608
Validation loss decreased (-0.567553 --> -0.608092).  Saving model ...
Epoch: 14 cost time: 0.8174214363098145
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.703 Vali Acc: 0.622 Test Loss: 1.703 Test Acc: 0.622
Validation loss decreased (-0.608092 --> -0.621605).  Saving model ...
Epoch: 15 cost time: 1.0515611171722412
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.595 Test Loss: 1.669 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9738843441009521
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.581 Test Loss: 1.509 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8852419853210449
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.554 Test Loss: 1.630 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0194191932678223
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.581 Test Loss: 1.776 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9624261856079102
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.554 Test Loss: 1.676 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.444420576095581
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.572 Vali Acc: 0.608 Test Loss: 1.572 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0077698230743408
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.608 Test Loss: 1.606 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1611206531524658
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.656 Vali Acc: 0.581 Test Loss: 1.656 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4207394123077393
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.595 Test Loss: 1.641 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7953007221221924
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.595 Test Loss: 1.667 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 30027268
model size : 129.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0956313610076904
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.331 Vali Acc: 0.311 Test Loss: 1.331 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8070080280303955
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.365 Vali Acc: 0.257 Test Loss: 1.365 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9790081977844238
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
Validation loss decreased (-0.310797 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.127345085144043
Epoch: 4, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.232 Vali Acc: 0.432 Test Loss: 1.232 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6943864822387695
Epoch: 5, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.116 Vali Acc: 0.459 Test Loss: 1.116 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0854034423828125
Epoch: 6, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.064 Vali Acc: 0.473 Test Loss: 1.064 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9229426383972168
Epoch: 7, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.119 Vali Acc: 0.473 Test Loss: 1.119 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0188014507293701
Epoch: 8, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 0.9645321369171143
Epoch: 9, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8679540157318115
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.300 Vali Acc: 0.541 Test Loss: 1.300 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 11 cost time: 1.0999443531036377
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.445 Vali Acc: 0.554 Test Loss: 1.445 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554040).  Saving model ...
Epoch: 12 cost time: 1.1429784297943115
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.460 Vali Acc: 0.554 Test Loss: 1.460 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8929598331451416
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.569 Vali Acc: 0.568 Test Loss: 1.569 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567552).  Saving model ...
Epoch: 14 cost time: 0.891486406326294
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.495 Vali Acc: 0.541 Test Loss: 1.495 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8912296295166016
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.523 Vali Acc: 0.595 Test Loss: 1.523 Test Acc: 0.595
Validation loss decreased (-0.567552 --> -0.594579).  Saving model ...
Epoch: 16 cost time: 0.7940406799316406
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.710 Vali Acc: 0.527 Test Loss: 1.710 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0434937477111816
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.463 Vali Acc: 0.568 Test Loss: 1.463 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9222805500030518
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.520 Vali Acc: 0.554 Test Loss: 1.520 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6901113986968994
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.646 Vali Acc: 0.514 Test Loss: 1.646 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7690427303314209
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.612 Vali Acc: 0.568 Test Loss: 1.612 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.255826711654663
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.549 Vali Acc: 0.554 Test Loss: 1.549 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6694471836090088
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.554 Test Loss: 1.547 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.49276113510131836
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.568 Test Loss: 1.566 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.61151123046875
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.571 Vali Acc: 0.568 Test Loss: 1.571 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5636191368103027
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.568 Test Loss: 1.585 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 29912068
model size : 128.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5338687896728516
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.388 Vali Acc: 0.284 Test Loss: 1.388 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.3004555702209473
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.369 Vali Acc: 0.270 Test Loss: 1.369 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5708246231079102
Epoch: 3, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.357 Vali Acc: 0.365 Test Loss: 1.357 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.6126852035522461
Epoch: 4, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.291 Vali Acc: 0.405 Test Loss: 1.291 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.5029137134552002
Epoch: 5, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.276 Vali Acc: 0.378 Test Loss: 1.276 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5569281578063965
Epoch: 6, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.211 Vali Acc: 0.514 Test Loss: 1.211 Test Acc: 0.514
Validation loss decreased (-0.405392 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 0.8101952075958252
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.274 Vali Acc: 0.405 Test Loss: 1.274 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5948929786682129
Epoch: 8, Steps: 10 | Train Loss: 0.669 Vali Loss: 1.190 Vali Acc: 0.514 Test Loss: 1.190 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.5134055614471436
Epoch: 9, Steps: 10 | Train Loss: 0.482 Vali Loss: 1.210 Vali Acc: 0.486 Test Loss: 1.210 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5864827632904053
Epoch: 10, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.450 Vali Acc: 0.459 Test Loss: 1.450 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5702190399169922
Epoch: 11, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.220 Vali Acc: 0.527 Test Loss: 1.220 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 0.5338883399963379
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4865231513977051
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.368 Vali Acc: 0.514 Test Loss: 1.368 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4678995609283447
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.273 Vali Acc: 0.527 Test Loss: 1.273 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.47657179832458496
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.395 Vali Acc: 0.581 Test Loss: 1.395 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581067).  Saving model ...
Epoch: 16 cost time: 0.8867485523223877
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.331 Vali Acc: 0.568 Test Loss: 1.331 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5866482257843018
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.340 Vali Acc: 0.595 Test Loss: 1.340 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594581).  Saving model ...
Epoch: 18 cost time: 0.6789171695709229
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.492 Vali Acc: 0.581 Test Loss: 1.492 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4768564701080322
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.420 Vali Acc: 0.568 Test Loss: 1.420 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5742590427398682
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.449 Vali Acc: 0.581 Test Loss: 1.449 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4661102294921875
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.455 Vali Acc: 0.568 Test Loss: 1.455 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.48726820945739746
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.446 Vali Acc: 0.554 Test Loss: 1.446 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.46609926223754883
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.456 Vali Acc: 0.554 Test Loss: 1.456 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5490269660949707
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.468 Vali Acc: 0.554 Test Loss: 1.468 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.690457820892334
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.568 Test Loss: 1.487 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5843274593353271
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.472 Vali Acc: 0.568 Test Loss: 1.472 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5097854137420654
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.491 Vali Acc: 0.568 Test Loss: 1.491 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 29852164
model size : 128.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.412566900253296
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.520 Vali Acc: 0.203 Test Loss: 1.520 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.1870675086975098
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.320 Vali Acc: 0.405 Test Loss: 1.320 Test Acc: 0.405
Validation loss decreased (-0.202688 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.152259349822998
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.353 Vali Acc: 0.284 Test Loss: 1.353 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0742254257202148
Epoch: 4, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.256 Vali Acc: 0.338 Test Loss: 1.256 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5656304359436035
Epoch: 5, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.149 Vali Acc: 0.486 Test Loss: 1.149 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.5000603199005127
Epoch: 6, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.190 Vali Acc: 0.446 Test Loss: 1.190 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9487106800079346
Epoch: 7, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.327 Vali Acc: 0.459 Test Loss: 1.327 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7059152126312256
Epoch: 8, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.405 Vali Acc: 0.527 Test Loss: 1.405 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527013).  Saving model ...
Epoch: 9 cost time: 0.8501019477844238
Epoch: 9, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.544 Vali Acc: 0.595 Test Loss: 1.544 Test Acc: 0.595
Validation loss decreased (-0.527013 --> -0.594579).  Saving model ...
Epoch: 10 cost time: 1.1961798667907715
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.609 Vali Acc: 0.595 Test Loss: 1.609 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.877140998840332
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.893 Vali Acc: 0.514 Test Loss: 1.893 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8469765186309814
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.962 Vali Acc: 0.459 Test Loss: 1.962 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9313650131225586
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.815 Vali Acc: 0.554 Test Loss: 1.815 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3615524768829346
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.020 Vali Acc: 0.514 Test Loss: 2.020 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2378203868865967
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.050 Vali Acc: 0.595 Test Loss: 2.050 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0556831359863281
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.568 Test Loss: 1.773 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9936108589172363
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.784 Vali Acc: 0.541 Test Loss: 1.784 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0315258502960205
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.846 Vali Acc: 0.541 Test Loss: 1.846 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3598089218139648
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.554 Test Loss: 1.875 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 30073348
model size : 129.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.430928945541382
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.355 Vali Acc: 0.378 Test Loss: 1.355 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.8875925540924072
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.362 Vali Acc: 0.324 Test Loss: 1.362 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6658239364624023
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.287 Vali Acc: 0.486 Test Loss: 1.287 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.0196723937988281
Epoch: 4, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.6383295059204102
Epoch: 5, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.5188367366790771
Epoch: 6, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.7798223495483398
Epoch: 7, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.331 Vali Acc: 0.392 Test Loss: 1.331 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8600800037384033
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7433352470397949
Epoch: 9, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.53275465965271
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.212 Vali Acc: 0.581 Test Loss: 1.212 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 0.7402937412261963
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7474639415740967
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8817484378814697
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.259 Vali Acc: 0.581 Test Loss: 1.259 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1681227684020996
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7114191055297852
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.450 Vali Acc: 0.568 Test Loss: 1.450 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0376744270324707
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.215 Vali Acc: 0.568 Test Loss: 1.215 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8985223770141602
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7978506088256836
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.390 Vali Acc: 0.608 Test Loss: 1.390 Test Acc: 0.608
Validation loss decreased (-0.581069 --> -0.608094).  Saving model ...
Epoch: 19 cost time: 1.0071299076080322
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.353 Vali Acc: 0.595 Test Loss: 1.353 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6917381286621094
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.595 Test Loss: 1.350 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.765601634979248
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.388 Vali Acc: 0.595 Test Loss: 1.388 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.747185230255127
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.595 Test Loss: 1.402 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6423728466033936
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.595 Test Loss: 1.412 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0275187492370605
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.595 Test Loss: 1.386 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7936348915100098
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.595 Test Loss: 1.392 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8399813175201416
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.595 Test Loss: 1.410 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6484889984130859
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.399 Vali Acc: 0.581 Test Loss: 1.399 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9521961212158203
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.409 Vali Acc: 0.595 Test Loss: 1.409 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 29948932
model size : 128.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1399223804473877
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.417 Vali Acc: 0.284 Test Loss: 1.417 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.6373298168182373
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.333 Vali Acc: 0.419 Test Loss: 1.333 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.732093334197998
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.320 Vali Acc: 0.392 Test Loss: 1.320 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6162867546081543
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.317 Vali Acc: 0.365 Test Loss: 1.317 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6047053337097168
Epoch: 5, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.234 Vali Acc: 0.365 Test Loss: 1.234 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6858830451965332
Epoch: 6, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.247 Vali Acc: 0.486 Test Loss: 1.247 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.5650548934936523
Epoch: 7, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6734826564788818
Epoch: 8, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.202 Vali Acc: 0.419 Test Loss: 1.202 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5457561016082764
Epoch: 9, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.267 Vali Acc: 0.432 Test Loss: 1.267 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6078736782073975
Epoch: 10, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.144 Vali Acc: 0.568 Test Loss: 1.144 Test Acc: 0.568
Validation loss decreased (-0.486474 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 0.5516965389251709
Epoch: 11, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.247 Vali Acc: 0.554 Test Loss: 1.247 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5655462741851807
Epoch: 12, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.281 Vali Acc: 0.554 Test Loss: 1.281 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6725549697875977
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.161 Vali Acc: 0.595 Test Loss: 1.161 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 0.622769832611084
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.316 Vali Acc: 0.527 Test Loss: 1.316 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.604738712310791
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.221 Vali Acc: 0.527 Test Loss: 1.221 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8193216323852539
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.341 Vali Acc: 0.554 Test Loss: 1.341 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5313551425933838
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.363 Vali Acc: 0.568 Test Loss: 1.363 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5108325481414795
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.342 Vali Acc: 0.595 Test Loss: 1.342 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.594106912612915
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.408 Vali Acc: 0.568 Test Loss: 1.408 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6356618404388428
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.388 Vali Acc: 0.581 Test Loss: 1.388 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5984959602355957
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.359 Vali Acc: 0.568 Test Loss: 1.359 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6324167251586914
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.384 Vali Acc: 0.595 Test Loss: 1.384 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5504395961761475
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.414 Vali Acc: 0.581 Test Loss: 1.414 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 29889028
model size : 128.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9738149642944336
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.360 Vali Acc: 0.338 Test Loss: 1.360 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.7547495365142822
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.433 Vali Acc: 0.216 Test Loss: 1.433 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7433407306671143
Epoch: 3, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.234 Vali Acc: 0.527 Test Loss: 1.234 Test Acc: 0.527
Validation loss decreased (-0.337824 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.8540668487548828
Epoch: 4, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.138 Vali Acc: 0.486 Test Loss: 1.138 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8064060211181641
Epoch: 5, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.244 Vali Acc: 0.554 Test Loss: 1.244 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 6 cost time: 0.7755007743835449
Epoch: 6, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.291 Vali Acc: 0.446 Test Loss: 1.291 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8438632488250732
Epoch: 7, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.439 Vali Acc: 0.514 Test Loss: 1.439 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.807518720626831
Epoch: 8, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.571 Vali Acc: 0.568 Test Loss: 1.571 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567552).  Saving model ...
Epoch: 9 cost time: 1.2894086837768555
Epoch: 9, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.601 Vali Acc: 0.514 Test Loss: 1.601 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8486959934234619
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.575 Vali Acc: 0.486 Test Loss: 1.575 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8603808879852295
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.940 Vali Acc: 0.554 Test Loss: 1.940 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.267352819442749
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.757 Vali Acc: 0.514 Test Loss: 1.757 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9416100978851318
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.828 Vali Acc: 0.541 Test Loss: 1.828 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.900057315826416
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.763 Vali Acc: 0.554 Test Loss: 1.763 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8591623306274414
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.554 Test Loss: 1.764 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6233491897583008
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.554 Test Loss: 1.815 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9091877937316895
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.554 Test Loss: 1.771 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5726840496063232
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.759 Vali Acc: 0.568 Test Loss: 1.759 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 30087172
model size : 129.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5737814903259277
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.411 Vali Acc: 0.189 Test Loss: 1.411 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.6081695556640625
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.335 Vali Acc: 0.446 Test Loss: 1.335 Test Acc: 0.446
Validation loss decreased (-0.189175 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.6956079006195068
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.334 Vali Acc: 0.432 Test Loss: 1.334 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.681415319442749
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.225 Vali Acc: 0.527 Test Loss: 1.225 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.5907237529754639
Epoch: 5, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.239 Vali Acc: 0.405 Test Loss: 1.239 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7206470966339111
Epoch: 6, Steps: 10 | Train Loss: 0.878 Vali Loss: 1.143 Vali Acc: 0.486 Test Loss: 1.143 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.918806791305542
Epoch: 7, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6022818088531494
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.121 Vali Acc: 0.568 Test Loss: 1.121 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 0.6826977729797363
Epoch: 9, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.296 Vali Acc: 0.541 Test Loss: 1.296 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4384739398956299
Epoch: 10, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9783868789672852
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.255 Vali Acc: 0.541 Test Loss: 1.255 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6986441612243652
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.413 Vali Acc: 0.554 Test Loss: 1.413 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5341391563415527
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.520 Vali Acc: 0.500 Test Loss: 1.520 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1069841384887695
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1873979568481445
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.507 Vali Acc: 0.541 Test Loss: 1.507 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8733384609222412
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.547 Vali Acc: 0.568 Test Loss: 1.547 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8616952896118164
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581067).  Saving model ...
Epoch: 18 cost time: 0.9867782592773438
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.418 Vali Acc: 0.608 Test Loss: 1.418 Test Acc: 0.608
Validation loss decreased (-0.581067 --> -0.608094).  Saving model ...
Epoch: 19 cost time: 1.4380617141723633
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.478 Vali Acc: 0.608 Test Loss: 1.478 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9966702461242676
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.502 Vali Acc: 0.595 Test Loss: 1.502 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.661738395690918
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.472 Vali Acc: 0.595 Test Loss: 1.472 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7039878368377686
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.595 Test Loss: 1.477 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7878820896148682
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.581 Test Loss: 1.501 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6505732536315918
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.581 Test Loss: 1.474 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7967917919158936
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.495 Vali Acc: 0.568 Test Loss: 1.495 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8138267993927002
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.568 Test Loss: 1.527 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.890845775604248
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.555 Vali Acc: 0.595 Test Loss: 1.555 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7652487754821777
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.581 Test Loss: 1.532 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 29985796
model size : 129.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0288286209106445
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.375 Vali Acc: 0.284 Test Loss: 1.375 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8090128898620605
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6022489070892334
Epoch: 3, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.6509969234466553
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.6784951686859131
Epoch: 5, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.271 Vali Acc: 0.378 Test Loss: 1.271 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6729364395141602
Epoch: 6, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.204 Vali Acc: 0.432 Test Loss: 1.204 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 0.6684157848358154
Epoch: 7, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.214 Vali Acc: 0.405 Test Loss: 1.214 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6933104991912842
Epoch: 8, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.186 Vali Acc: 0.432 Test Loss: 1.186 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432421).  Saving model ...
Epoch: 9 cost time: 0.6336450576782227
Epoch: 9, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.304 Vali Acc: 0.419 Test Loss: 1.304 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5438547134399414
Epoch: 10, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.153 Vali Acc: 0.554 Test Loss: 1.153 Test Acc: 0.554
Validation loss decreased (-0.432421 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 0.588951826095581
Epoch: 11, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.342 Vali Acc: 0.486 Test Loss: 1.342 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7042222023010254
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6921107769012451
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6249382495880127
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.295 Vali Acc: 0.554 Test Loss: 1.295 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8161146640777588
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.339 Vali Acc: 0.527 Test Loss: 1.339 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5242865085601807
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.313 Vali Acc: 0.500 Test Loss: 1.313 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5182831287384033
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6033926010131836
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.309 Vali Acc: 0.541 Test Loss: 1.309 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5613181591033936
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.322 Vali Acc: 0.541 Test Loss: 1.322 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.514754056930542
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.352 Vali Acc: 0.527 Test Loss: 1.352 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 29930500
model size : 128.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.769132137298584
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.457 Vali Acc: 0.216 Test Loss: 1.457 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.466064453125
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.355 Vali Acc: 0.378 Test Loss: 1.355 Test Acc: 0.378
Validation loss decreased (-0.216202 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.8826191425323486
Epoch: 3, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.279 Vali Acc: 0.392 Test Loss: 1.279 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0681781768798828
Epoch: 4, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.1625525951385498
Epoch: 5, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.238 Vali Acc: 0.419 Test Loss: 1.238 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.591367244720459
Epoch: 6, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.435 Vali Acc: 0.392 Test Loss: 1.435 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6990625858306885
Epoch: 7, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.452 Vali Acc: 0.459 Test Loss: 1.452 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3116638660430908
Epoch: 8, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.475 Vali Acc: 0.473 Test Loss: 1.475 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9654545783996582
Epoch: 9, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.640 Vali Acc: 0.432 Test Loss: 1.640 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9590275287628174
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.656 Vali Acc: 0.432 Test Loss: 1.656 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.837885856628418
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.752 Vali Acc: 0.432 Test Loss: 1.752 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9060416221618652
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 2.174 Vali Acc: 0.378 Test Loss: 2.174 Test Acc: 0.378
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.921107292175293
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.978 Vali Acc: 0.473 Test Loss: 1.978 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8945596218109131
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.999 Vali Acc: 0.473 Test Loss: 1.999 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.4864864864864865
model parameter : 30133252
model size : 129.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0104405879974365
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.397 Vali Acc: 0.230 Test Loss: 1.397 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.1079185009002686
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.377 Vali Acc: 0.257 Test Loss: 1.377 Test Acc: 0.257
Validation loss decreased (-0.229716 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 0.6239097118377686
Epoch: 3, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.323 Vali Acc: 0.338 Test Loss: 1.323 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.7565934658050537
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
Validation loss decreased (-0.337825 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.028381586074829
Epoch: 5, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.297 Vali Acc: 0.378 Test Loss: 1.297 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6790368556976318
Epoch: 6, Steps: 10 | Train Loss: 0.751 Vali Loss: 1.276 Vali Acc: 0.446 Test Loss: 1.276 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7531962394714355
Epoch: 7, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.9763565063476562
Epoch: 8, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.510 Vali Acc: 0.351 Test Loss: 1.510 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7797651290893555
Epoch: 9, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.325 Vali Acc: 0.473 Test Loss: 1.325 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9804317951202393
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.380 Vali Acc: 0.514 Test Loss: 1.380 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5170159339904785
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.284 Vali Acc: 0.486 Test Loss: 1.284 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7266943454742432
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.412 Vali Acc: 0.486 Test Loss: 1.412 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7489907741546631
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.685 Vali Acc: 0.527 Test Loss: 1.685 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527010).  Saving model ...
Epoch: 14 cost time: 0.771906852722168
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.549 Vali Acc: 0.527 Test Loss: 1.549 Test Acc: 0.527
Validation loss decreased (-0.527010 --> -0.527012).  Saving model ...
Epoch: 15 cost time: 0.6229350566864014
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.692 Vali Acc: 0.514 Test Loss: 1.692 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1484441757202148
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.717 Vali Acc: 0.486 Test Loss: 1.717 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0534133911132812
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.658 Vali Acc: 0.473 Test Loss: 1.658 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8038277626037598
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.739 Vali Acc: 0.473 Test Loss: 1.739 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5249819755554199
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.741 Vali Acc: 0.500 Test Loss: 1.741 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9962913990020752
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.692 Vali Acc: 0.527 Test Loss: 1.692 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7851219177246094
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.665 Vali Acc: 0.527 Test Loss: 1.665 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.796332597732544
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.554 Test Loss: 1.681 Test Acc: 0.554
Validation loss decreased (-0.527012 --> -0.554037).  Saving model ...
Epoch: 23 cost time: 0.7329597473144531
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.554 Test Loss: 1.705 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5780982971191406
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.721 Vali Acc: 0.541 Test Loss: 1.721 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8749444484710693
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.541 Test Loss: 1.728 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.668358325958252
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.527 Test Loss: 1.723 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6566247940063477
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.541 Test Loss: 1.733 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5941717624664307
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.527 Test Loss: 1.731 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7104406356811523
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.527 Test Loss: 1.727 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.611393928527832
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.527 Test Loss: 1.723 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7376091480255127
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5414023399353027
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.541 Test Loss: 1.736 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 30027268
model size : 129.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2219862937927246
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.354 Vali Acc: 0.351 Test Loss: 1.354 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.9206910133361816
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.393 Vali Acc: 0.230 Test Loss: 1.393 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.647097110748291
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.5411760807037354
Epoch: 4, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.268 Vali Acc: 0.486 Test Loss: 1.268 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.6906478404998779
Epoch: 5, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.510103702545166
Epoch: 6, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.202 Vali Acc: 0.432 Test Loss: 1.202 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4852747917175293
Epoch: 7, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.191 Vali Acc: 0.432 Test Loss: 1.191 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.44229769706726074
Epoch: 8, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.150 Vali Acc: 0.473 Test Loss: 1.150 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.48005127906799316
Epoch: 9, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.6705632209777832
Epoch: 10, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6243224143981934
Epoch: 11, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 12 cost time: 0.4998180866241455
Epoch: 12, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.229 Vali Acc: 0.541 Test Loss: 1.229 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540528).  Saving model ...
Epoch: 13 cost time: 0.4940199851989746
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.318 Vali Acc: 0.514 Test Loss: 1.318 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5832865238189697
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.275 Vali Acc: 0.554 Test Loss: 1.275 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554041).  Saving model ...
Epoch: 15 cost time: 0.5988631248474121
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.304 Vali Acc: 0.595 Test Loss: 1.304 Test Acc: 0.595
Validation loss decreased (-0.554041 --> -0.594582).  Saving model ...
Epoch: 16 cost time: 0.516247034072876
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.368 Vali Acc: 0.486 Test Loss: 1.368 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6788990497589111
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.339 Vali Acc: 0.500 Test Loss: 1.339 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6297051906585693
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.395 Vali Acc: 0.514 Test Loss: 1.395 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.916022777557373
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.394 Vali Acc: 0.527 Test Loss: 1.394 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5804295539855957
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.417 Vali Acc: 0.527 Test Loss: 1.417 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5194604396820068
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5680665969848633
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.443 Vali Acc: 0.541 Test Loss: 1.443 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.617753267288208
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.458 Vali Acc: 0.486 Test Loss: 1.458 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9621741771697998
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.471 Vali Acc: 0.500 Test Loss: 1.471 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5963125228881836
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.489 Vali Acc: 0.473 Test Loss: 1.489 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 29971972
model size : 129.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.605283498764038
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.321 Vali Acc: 0.432 Test Loss: 1.321 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 0.9723808765411377
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.398 Vali Acc: 0.257 Test Loss: 1.398 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0922846794128418
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.8425850868225098
Epoch: 4, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 1.0275278091430664
Epoch: 5, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.8431360721588135
Epoch: 6, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.093 Vali Acc: 0.608 Test Loss: 1.093 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 7 cost time: 1.4119255542755127
Epoch: 7, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.491 Vali Acc: 0.446 Test Loss: 1.491 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8650391101837158
Epoch: 8, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.291 Vali Acc: 0.554 Test Loss: 1.291 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7340614795684814
Epoch: 9, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.341 Vali Acc: 0.554 Test Loss: 1.341 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6308391094207764
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.463 Vali Acc: 0.554 Test Loss: 1.463 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6529178619384766
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.613 Vali Acc: 0.595 Test Loss: 1.613 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6006169319152832
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.546 Vali Acc: 0.554 Test Loss: 1.546 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0953700542449951
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.844 Vali Acc: 0.568 Test Loss: 1.844 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8921515941619873
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.722 Vali Acc: 0.595 Test Loss: 1.722 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8721206188201904
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.799 Vali Acc: 0.595 Test Loss: 1.799 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6128277778625488
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.013 Vali Acc: 0.554 Test Loss: 2.013 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 30174724
model size : 129.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.050706148147583
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.396 Vali Acc: 0.230 Test Loss: 1.396 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.8492956161499023
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.295 Vali Acc: 0.473 Test Loss: 1.295 Test Acc: 0.473
Validation loss decreased (-0.229716 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.5342752933502197
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.312 Vali Acc: 0.392 Test Loss: 1.312 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6548516750335693
Epoch: 4, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.136533498764038
Epoch: 5, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.257 Vali Acc: 0.446 Test Loss: 1.257 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5819065570831299
Epoch: 6, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.093 Vali Acc: 0.581 Test Loss: 1.093 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 0.5421366691589355
Epoch: 7, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5796070098876953
Epoch: 8, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.115 Vali Acc: 0.595 Test Loss: 1.115 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 9 cost time: 0.5200281143188477
Epoch: 9, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5992255210876465
Epoch: 10, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.130 Vali Acc: 0.581 Test Loss: 1.130 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6184303760528564
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.663191556930542
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.300 Vali Acc: 0.595 Test Loss: 1.300 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7851419448852539
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4956700801849365
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.218 Vali Acc: 0.608 Test Loss: 1.218 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 15 cost time: 0.7258672714233398
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.346 Vali Acc: 0.608 Test Loss: 1.346 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6514699459075928
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.250 Vali Acc: 0.622 Test Loss: 1.250 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621609).  Saving model ...
Epoch: 17 cost time: 0.6029012203216553
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.271 Vali Acc: 0.622 Test Loss: 1.271 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9098613262176514
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.306 Vali Acc: 0.608 Test Loss: 1.306 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.730086088180542
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.323 Vali Acc: 0.608 Test Loss: 1.323 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8979582786560059
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.356 Vali Acc: 0.608 Test Loss: 1.356 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6781210899353027
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.608 Test Loss: 1.349 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8579440116882324
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.333 Vali Acc: 0.608 Test Loss: 1.333 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8771541118621826
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.608 Test Loss: 1.354 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0624899864196777
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.608 Test Loss: 1.387 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6173875331878662
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.608 Test Loss: 1.390 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9719245433807373
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.622 Test Loss: 1.379 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 30087172
model size : 129.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.026059150695801
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.458 Vali Acc: 0.230 Test Loss: 1.458 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.6451640129089355
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
Validation loss decreased (-0.229715 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.6093828678131104
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.336 Vali Acc: 0.378 Test Loss: 1.336 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.5032122135162354
Epoch: 4, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.358 Vali Acc: 0.324 Test Loss: 1.358 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4757556915283203
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.246 Vali Acc: 0.514 Test Loss: 1.246 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 0.5410470962524414
Epoch: 6, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7254679203033447
Epoch: 7, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.5862703323364258
Epoch: 8, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.171 Vali Acc: 0.527 Test Loss: 1.171 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5121092796325684
Epoch: 9, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5751771926879883
Epoch: 10, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.252 Vali Acc: 0.554 Test Loss: 1.252 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7585525512695312
Epoch: 11, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.278 Vali Acc: 0.581 Test Loss: 1.278 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 12 cost time: 0.568202018737793
Epoch: 12, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.369 Vali Acc: 0.473 Test Loss: 1.369 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4843778610229492
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.447 Vali Acc: 0.500 Test Loss: 1.447 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4952681064605713
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5220401287078857
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.468 Vali Acc: 0.527 Test Loss: 1.468 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5441217422485352
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.501 Vali Acc: 0.514 Test Loss: 1.501 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6216356754302979
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.511 Vali Acc: 0.514 Test Loss: 1.511 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7057511806488037
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.517 Vali Acc: 0.514 Test Loss: 1.517 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6424071788787842
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8194305896759033
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.590 Vali Acc: 0.500 Test Loss: 1.590 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6060059070587158
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.612 Vali Acc: 0.486 Test Loss: 1.612 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 30036484
model size : 129.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9713423252105713
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.356 Vali Acc: 0.230 Test Loss: 1.356 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.1968986988067627
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.309 Vali Acc: 0.351 Test Loss: 1.309 Test Acc: 0.351
Validation loss decreased (-0.229716 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.022752046585083
Epoch: 3, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.228 Vali Acc: 0.419 Test Loss: 1.228 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 0.6595056056976318
Epoch: 4, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
Validation loss decreased (-0.418907 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.6497163772583008
Epoch: 5, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.238 Vali Acc: 0.405 Test Loss: 1.238 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6640419960021973
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.7206149101257324
Epoch: 7, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.192 Vali Acc: 0.568 Test Loss: 1.192 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.556117057800293
Epoch: 8, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.181 Vali Acc: 0.527 Test Loss: 1.181 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5923821926116943
Epoch: 9, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.471 Vali Acc: 0.459 Test Loss: 1.471 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7399401664733887
Epoch: 10, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7540571689605713
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.405 Vali Acc: 0.568 Test Loss: 1.405 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1651902198791504
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.288 Vali Acc: 0.581 Test Loss: 1.288 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 13 cost time: 0.9943270683288574
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.410 Vali Acc: 0.595 Test Loss: 1.410 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594580).  Saving model ...
Epoch: 14 cost time: 0.6664798259735107
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.402 Vali Acc: 0.595 Test Loss: 1.402 Test Acc: 0.595
Validation loss decreased (-0.594580 --> -0.594581).  Saving model ...
Epoch: 15 cost time: 1.0352423191070557
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.439 Vali Acc: 0.608 Test Loss: 1.439 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608094).  Saving model ...
Epoch: 16 cost time: 0.6894187927246094
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.447 Vali Acc: 0.595 Test Loss: 1.447 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9203453063964844
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.449 Vali Acc: 0.554 Test Loss: 1.449 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2766478061676025
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.452 Vali Acc: 0.568 Test Loss: 1.452 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8659636974334717
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.568 Test Loss: 1.455 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6595604419708252
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.581 Test Loss: 1.490 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6549370288848877
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.478 Vali Acc: 0.568 Test Loss: 1.478 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7377278804779053
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.449 Vali Acc: 0.581 Test Loss: 1.449 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.636650562286377
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.568 Test Loss: 1.460 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9293248653411865
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.568 Test Loss: 1.454 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7233600616455078
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.470 Vali Acc: 0.568 Test Loss: 1.470 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 30225412
model size : 129.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9486067295074463
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.467 Vali Acc: 0.216 Test Loss: 1.467 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.3426330089569092
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.355 Vali Acc: 0.338 Test Loss: 1.355 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.0568287372589111
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.323 Vali Acc: 0.324 Test Loss: 1.323 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7182679176330566
Epoch: 4, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.259 Vali Acc: 0.459 Test Loss: 1.259 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.8783466815948486
Epoch: 5, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.2496812343597412
Epoch: 6, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.120617151260376
Epoch: 7, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7817337512969971
Epoch: 8, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7577552795410156
Epoch: 9, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.212 Vali Acc: 0.459 Test Loss: 1.212 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6592018604278564
Epoch: 10, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.7582807540893555
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6361885070800781
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.514 Vali Acc: 0.486 Test Loss: 1.514 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.722714900970459
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.339 Vali Acc: 0.568 Test Loss: 1.339 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7399358749389648
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.307 Vali Acc: 0.541 Test Loss: 1.307 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6622498035430908
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7392125129699707
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.367 Vali Acc: 0.568 Test Loss: 1.367 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9314262866973877
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7116973400115967
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.316 Vali Acc: 0.514 Test Loss: 1.316 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7537999153137207
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.298 Vali Acc: 0.514 Test Loss: 1.298 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0074448585510254
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.283 Vali Acc: 0.527 Test Loss: 1.283 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 30147076
model size : 129.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4194087982177734
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.407 Vali Acc: 0.176 Test Loss: 1.407 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 0.487743616104126
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.322 Vali Acc: 0.338 Test Loss: 1.322 Test Acc: 0.338
Validation loss decreased (-0.175662 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 0.5194346904754639
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.379 Vali Acc: 0.338 Test Loss: 1.379 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5819957256317139
Epoch: 4, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.279 Vali Acc: 0.392 Test Loss: 1.279 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.5635225772857666
Epoch: 5, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.254 Vali Acc: 0.432 Test Loss: 1.254 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.6417522430419922
Epoch: 6, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.244 Vali Acc: 0.419 Test Loss: 1.244 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5541026592254639
Epoch: 7, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.7607307434082031
Epoch: 8, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 0.8196382522583008
Epoch: 9, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.241 Vali Acc: 0.473 Test Loss: 1.241 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6127028465270996
Epoch: 10, Steps: 10 | Train Loss: 0.302 Vali Loss: 1.217 Vali Acc: 0.541 Test Loss: 1.217 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 11 cost time: 0.6666865348815918
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7119863033294678
Epoch: 12, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5702414512634277
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.217 Vali Acc: 0.568 Test Loss: 1.217 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567555).  Saving model ...
Epoch: 14 cost time: 0.8135933876037598
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.258 Vali Acc: 0.568 Test Loss: 1.258 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5400989055633545
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.305 Vali Acc: 0.554 Test Loss: 1.305 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.743598461151123
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.289 Vali Acc: 0.568 Test Loss: 1.289 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7286214828491211
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.348 Vali Acc: 0.568 Test Loss: 1.348 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8328292369842529
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.372 Vali Acc: 0.568 Test Loss: 1.372 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5449488162994385
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.344 Vali Acc: 0.568 Test Loss: 1.344 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8043642044067383
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.338 Vali Acc: 0.581 Test Loss: 1.338 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581068).  Saving model ...
Epoch: 21 cost time: 1.0496776103973389
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.369 Vali Acc: 0.554 Test Loss: 1.369 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8014850616455078
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.375 Vali Acc: 0.581 Test Loss: 1.375 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9717967510223389
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.406 Vali Acc: 0.581 Test Loss: 1.406 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9065070152282715
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.413 Vali Acc: 0.568 Test Loss: 1.413 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8296411037445068
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.416 Vali Acc: 0.554 Test Loss: 1.416 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7209227085113525
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.409 Vali Acc: 0.554 Test Loss: 1.409 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6769976615905762
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.403 Vali Acc: 0.568 Test Loss: 1.403 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5578217506408691
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.415 Vali Acc: 0.568 Test Loss: 1.415 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9428894519805908
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.428 Vali Acc: 0.554 Test Loss: 1.428 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5852179527282715
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.490 Vali Acc: 0.568 Test Loss: 1.490 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 30100996
model size : 129.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0031843185424805
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.449 Vali Acc: 0.176 Test Loss: 1.449 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 0.8742880821228027
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (-0.175661 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.2280993461608887
Epoch: 3, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.305 Vali Acc: 0.419 Test Loss: 1.305 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.9633071422576904
Epoch: 4, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.202 Vali Acc: 0.432 Test Loss: 1.202 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.802635908126831
Epoch: 5, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.243 Vali Acc: 0.432 Test Loss: 1.243 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6055409908294678
Epoch: 6, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.142 Vali Acc: 0.486 Test Loss: 1.142 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.700507402420044
Epoch: 7, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.129 Vali Acc: 0.568 Test Loss: 1.129 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 0.8287639617919922
Epoch: 8, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.228 Vali Acc: 0.527 Test Loss: 1.228 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7760202884674072
Epoch: 9, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.308 Vali Acc: 0.514 Test Loss: 1.308 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7684140205383301
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.268 Vali Acc: 0.541 Test Loss: 1.268 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8124492168426514
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.628 Vali Acc: 0.473 Test Loss: 1.628 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8053841590881348
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.586 Vali Acc: 0.514 Test Loss: 1.586 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.708510160446167
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.745 Vali Acc: 0.473 Test Loss: 1.745 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0215156078338623
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.594 Vali Acc: 0.554 Test Loss: 1.594 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.909614086151123
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.806 Vali Acc: 0.527 Test Loss: 1.806 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.821413516998291
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.666 Vali Acc: 0.527 Test Loss: 1.666 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0319368839263916
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.685 Vali Acc: 0.541 Test Loss: 1.685 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 30294532
model size : 130.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.501844882965088
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.7075812816619873
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.370 Vali Acc: 0.270 Test Loss: 1.370 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6858119964599609
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.270 Vali Acc: 0.459 Test Loss: 1.270 Test Acc: 0.459
Validation loss decreased (-0.297283 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.7419931888580322
Epoch: 4, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.246 Vali Acc: 0.459 Test Loss: 1.246 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.8888018131256104
Epoch: 5, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.4311184883117676
Epoch: 6, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.150 Vali Acc: 0.581 Test Loss: 1.150 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 0.9727787971496582
Epoch: 7, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3465595245361328
Epoch: 8, Steps: 10 | Train Loss: 0.408 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8104965686798096
Epoch: 9, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7365236282348633
Epoch: 10, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4627206325531006
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.437 Vali Acc: 0.459 Test Loss: 1.437 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2502045631408691
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.253 Vali Acc: 0.527 Test Loss: 1.253 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9677634239196777
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.377 Vali Acc: 0.581 Test Loss: 1.377 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9414699077606201
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.369 Vali Acc: 0.568 Test Loss: 1.369 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5057830810546875
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.346 Vali Acc: 0.541 Test Loss: 1.346 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8755674362182617
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.378 Vali Acc: 0.581 Test Loss: 1.378 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 30211588
model size : 129.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4263062477111816
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.407 Vali Acc: 0.203 Test Loss: 1.407 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.7736186981201172
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
Validation loss decreased (-0.202689 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.0154719352722168
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.352 Vali Acc: 0.311 Test Loss: 1.352 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.1576433181762695
Epoch: 4, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.308 Vali Acc: 0.378 Test Loss: 1.308 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.043820858001709
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.9985878467559814
Epoch: 6, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.248 Vali Acc: 0.419 Test Loss: 1.248 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.87021803855896
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.220 Vali Acc: 0.473 Test Loss: 1.220 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.6968584060668945
Epoch: 8, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.895336389541626
Epoch: 9, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.195 Vali Acc: 0.446 Test Loss: 1.195 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6729080677032471
Epoch: 10, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.208 Vali Acc: 0.432 Test Loss: 1.208 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7867579460144043
Epoch: 11, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.257 Vali Acc: 0.486 Test Loss: 1.257 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 12 cost time: 0.648209810256958
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 13 cost time: 0.7622628211975098
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.237 Vali Acc: 0.514 Test Loss: 1.237 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.849738359451294
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.303 Vali Acc: 0.486 Test Loss: 1.303 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6654922962188721
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.277 Vali Acc: 0.514 Test Loss: 1.277 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6746470928192139
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.259 Vali Acc: 0.527 Test Loss: 1.259 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 17 cost time: 0.7463893890380859
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.304 Vali Acc: 0.527 Test Loss: 1.304 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9288532733917236
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.267 Vali Acc: 0.527 Test Loss: 1.267 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7253189086914062
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.276 Vali Acc: 0.473 Test Loss: 1.276 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7555999755859375
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7021727561950684
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.318 Vali Acc: 0.514 Test Loss: 1.318 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5999472141265869
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.297 Vali Acc: 0.514 Test Loss: 1.297 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6130332946777344
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6959211826324463
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.300 Vali Acc: 0.541 Test Loss: 1.300 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540528).  Saving model ...
Epoch: 25 cost time: 0.6528196334838867
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.312 Vali Acc: 0.527 Test Loss: 1.312 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5531256198883057
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.318 Vali Acc: 0.527 Test Loss: 1.318 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6395480632781982
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.320 Vali Acc: 0.527 Test Loss: 1.320 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6392967700958252
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.326 Vali Acc: 0.568 Test Loss: 1.326 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567554).  Saving model ...
Epoch: 29 cost time: 0.8745105266571045
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.330 Vali Acc: 0.568 Test Loss: 1.330 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9003679752349854
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.338 Vali Acc: 0.514 Test Loss: 1.338 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8482835292816162
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.337 Vali Acc: 0.541 Test Loss: 1.337 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8481085300445557
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.358 Vali Acc: 0.541 Test Loss: 1.358 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0094971656799316
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.354 Vali Acc: 0.541 Test Loss: 1.354 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9242298603057861
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.346 Vali Acc: 0.568 Test Loss: 1.346 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6480350494384766
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.554 Test Loss: 1.351 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6565325260162354
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.568 Test Loss: 1.352 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6956300735473633
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6756789684295654
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.581 Test Loss: 1.350 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581068).  Saving model ...
Epoch: 39 cost time: 0.6430544853210449
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
Validation loss decreased (-0.581068 --> -0.581068).  Saving model ...
Epoch: 40 cost time: 0.6977846622467041
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.581 Test Loss: 1.329 Test Acc: 0.581
Validation loss decreased (-0.581068 --> -0.581068).  Saving model ...
Epoch: 41 cost time: 1.0101470947265625
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.326 Vali Acc: 0.595 Test Loss: 1.326 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594581).  Saving model ...
Epoch: 42 cost time: 0.7930054664611816
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.314 Vali Acc: 0.581 Test Loss: 1.314 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.773242712020874
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.318 Vali Acc: 0.581 Test Loss: 1.318 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8690736293792725
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.568 Test Loss: 1.328 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8010601997375488
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.581 Test Loss: 1.334 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8880839347839355
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.342 Vali Acc: 0.581 Test Loss: 1.342 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8601100444793701
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.595 Test Loss: 1.364 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8207387924194336
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.581 Test Loss: 1.379 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8131816387176514
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.581 Test Loss: 1.381 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6200430393218994
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.581 Test Loss: 1.380 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 30170116
model size : 129.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1302287578582764
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.372 Vali Acc: 0.270 Test Loss: 1.372 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.8331241607666016
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
Validation loss decreased (-0.270257 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.7975356578826904
Epoch: 3, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.269 Vali Acc: 0.365 Test Loss: 1.269 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.887836217880249
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.159 Vali Acc: 0.527 Test Loss: 1.159 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.8669166564941406
Epoch: 5, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.114 Vali Acc: 0.486 Test Loss: 1.114 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8787827491760254
Epoch: 6, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9455471038818359
Epoch: 7, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 0.7938411235809326
Epoch: 8, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.743257999420166
Epoch: 9, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0428647994995117
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.346 Vali Acc: 0.568 Test Loss: 1.346 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567554).  Saving model ...
Epoch: 11 cost time: 0.8758387565612793
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.421 Vali Acc: 0.514 Test Loss: 1.421 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6971161365509033
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.397 Vali Acc: 0.581 Test Loss: 1.397 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581067).  Saving model ...
Epoch: 13 cost time: 0.57167649269104
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.361 Vali Acc: 0.527 Test Loss: 1.361 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8338499069213867
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0517899990081787
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.241992712020874
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.426 Vali Acc: 0.608 Test Loss: 1.426 Test Acc: 0.608
Validation loss decreased (-0.581067 --> -0.608094).  Saving model ...
Epoch: 17 cost time: 0.884880542755127
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.474 Vali Acc: 0.595 Test Loss: 1.474 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5498347282409668
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.595 Test Loss: 1.509 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9174978733062744
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.581 Test Loss: 1.509 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2399816513061523
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.595 Test Loss: 1.503 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9603989124298096
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.595 Test Loss: 1.526 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5635418891906738
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.595 Test Loss: 1.530 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8756735324859619
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.568 Test Loss: 1.481 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0112173557281494
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.554 Test Loss: 1.503 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0389578342437744
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.528 Vali Acc: 0.568 Test Loss: 1.528 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3017175197601318
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.595 Test Loss: 1.551 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 30377476
model size : 130.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7015929222106934
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.383 Vali Acc: 0.351 Test Loss: 1.383 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.0928936004638672
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.369 Vali Acc: 0.324 Test Loss: 1.369 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8232297897338867
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.303 Vali Acc: 0.432 Test Loss: 1.303 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.7746281623840332
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.306 Vali Acc: 0.351 Test Loss: 1.306 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0545618534088135
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.242 Vali Acc: 0.473 Test Loss: 1.242 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.425675868988037
Epoch: 6, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.0746684074401855
Epoch: 7, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.179 Vali Acc: 0.486 Test Loss: 1.179 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.5763154029846191
Epoch: 8, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.208 Vali Acc: 0.486 Test Loss: 1.208 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1548550128936768
Epoch: 9, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.230 Vali Acc: 0.473 Test Loss: 1.230 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8556513786315918
Epoch: 10, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.414 Vali Acc: 0.473 Test Loss: 1.414 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9011380672454834
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.244 Vali Acc: 0.527 Test Loss: 1.244 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 1.2165307998657227
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9177744388580322
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7989687919616699
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.442 Vali Acc: 0.541 Test Loss: 1.442 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540526).  Saving model ...
Epoch: 15 cost time: 0.980689525604248
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.379 Vali Acc: 0.541 Test Loss: 1.379 Test Acc: 0.541
Validation loss decreased (-0.540526 --> -0.540527).  Saving model ...
Epoch: 16 cost time: 0.7006361484527588
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.406 Vali Acc: 0.554 Test Loss: 1.406 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554040).  Saving model ...
Epoch: 17 cost time: 0.7433173656463623
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.453 Vali Acc: 0.554 Test Loss: 1.453 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1306679248809814
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.473 Vali Acc: 0.554 Test Loss: 1.473 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7083849906921387
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7017557621002197
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.452 Vali Acc: 0.554 Test Loss: 1.452 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7116856575012207
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.426 Vali Acc: 0.554 Test Loss: 1.426 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5501253604888916
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.554 Test Loss: 1.429 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0979599952697754
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.466 Vali Acc: 0.581 Test Loss: 1.466 Test Acc: 0.581
Validation loss decreased (-0.554040 --> -0.581066).  Saving model ...
Epoch: 24 cost time: 1.1922564506530762
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.476 Vali Acc: 0.568 Test Loss: 1.476 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7479321956634521
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.568 Test Loss: 1.487 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0420629978179932
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.463 Vali Acc: 0.554 Test Loss: 1.463 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1541180610656738
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.581 Test Loss: 1.451 Test Acc: 0.581
Validation loss decreased (-0.581066 --> -0.581067).  Saving model ...
Epoch: 28 cost time: 0.7294580936431885
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.442 Vali Acc: 0.595 Test Loss: 1.442 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594580).  Saving model ...
Epoch: 29 cost time: 1.0667567253112793
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.568 Test Loss: 1.487 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.911829948425293
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.512 Vali Acc: 0.568 Test Loss: 1.512 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3684818744659424
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.568 Test Loss: 1.501 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7245216369628906
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.496 Vali Acc: 0.554 Test Loss: 1.496 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.398712158203125
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.554 Test Loss: 1.505 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8284385204315186
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.554 Test Loss: 1.530 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4126019477844238
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.540 Vali Acc: 0.554 Test Loss: 1.540 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1137163639068604
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.554 Test Loss: 1.541 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3607869148254395
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.541 Test Loss: 1.537 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.324263572692871
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.554 Test Loss: 1.551 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 30312964
model size : 130.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.150867462158203
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.9495687484741211
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.312 Vali Acc: 0.446 Test Loss: 1.312 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.0301804542541504
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.276 Vali Acc: 0.419 Test Loss: 1.276 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8248748779296875
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.85239577293396
Epoch: 5, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.177 Vali Acc: 0.527 Test Loss: 1.177 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.8322663307189941
Epoch: 6, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.9376485347747803
Epoch: 7, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8304586410522461
Epoch: 8, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.082 Vali Acc: 0.473 Test Loss: 1.082 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9982326030731201
Epoch: 9, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.918363094329834
Epoch: 10, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.985203742980957
Epoch: 11, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7568709850311279
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9957137107849121
Epoch: 13, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8102517127990723
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.119 Vali Acc: 0.568 Test Loss: 1.119 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 0.8848593235015869
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.143 Vali Acc: 0.541 Test Loss: 1.143 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8594300746917725
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5669078826904297
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5034699440002441
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8010282516479492
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.167 Vali Acc: 0.608 Test Loss: 1.167 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608096).  Saving model ...
Epoch: 20 cost time: 0.8438842296600342
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.177 Vali Acc: 0.595 Test Loss: 1.177 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6802899837493896
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.166 Vali Acc: 0.595 Test Loss: 1.166 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9278812408447266
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8726160526275635
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.205 Vali Acc: 0.568 Test Loss: 1.205 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8929693698883057
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.195 Vali Acc: 0.541 Test Loss: 1.195 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8782618045806885
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6489784717559814
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.177 Vali Acc: 0.581 Test Loss: 1.177 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6175117492675781
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.183 Vali Acc: 0.568 Test Loss: 1.183 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8094804286956787
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.203 Vali Acc: 0.554 Test Loss: 1.203 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8795778751373291
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.219 Vali Acc: 0.568 Test Loss: 1.219 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 30276100
model size : 130.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.412057399749756
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.406 Vali Acc: 0.297 Test Loss: 1.406 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.8416709899902344
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.327 Vali Acc: 0.378 Test Loss: 1.327 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.8196394443511963
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.254 Vali Acc: 0.473 Test Loss: 1.254 Test Acc: 0.473
Validation loss decreased (-0.378365 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.9952354431152344
Epoch: 4, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9022281169891357
Epoch: 5, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8760693073272705
Epoch: 6, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.294 Vali Acc: 0.486 Test Loss: 1.294 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9806065559387207
Epoch: 7, Steps: 10 | Train Loss: 0.497 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0435235500335693
Epoch: 8, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.326 Vali Acc: 0.459 Test Loss: 1.326 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.012169361114502
Epoch: 9, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.277 Vali Acc: 0.446 Test Loss: 1.277 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1520493030548096
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.394 Vali Acc: 0.514 Test Loss: 1.394 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513500).  Saving model ...
Epoch: 11 cost time: 0.9201831817626953
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.416 Vali Acc: 0.514 Test Loss: 1.416 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8921470642089844
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.436 Vali Acc: 0.568 Test Loss: 1.436 Test Acc: 0.568
Validation loss decreased (-0.513500 --> -0.567553).  Saving model ...
Epoch: 13 cost time: 1.3768374919891357
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.396 Vali Acc: 0.554 Test Loss: 1.396 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8567960262298584
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.421 Vali Acc: 0.554 Test Loss: 1.421 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7203643321990967
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.428 Vali Acc: 0.568 Test Loss: 1.428 Test Acc: 0.568
Validation loss decreased (-0.567553 --> -0.567553).  Saving model ...
Epoch: 16 cost time: 0.9480388164520264
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.554 Test Loss: 1.455 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.770625114440918
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.554 Test Loss: 1.455 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8013663291931152
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.445 Vali Acc: 0.541 Test Loss: 1.445 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7853856086730957
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.458 Vali Acc: 0.554 Test Loss: 1.458 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7947249412536621
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.554 Test Loss: 1.490 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6560242176055908
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.554 Test Loss: 1.492 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7636215686798096
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.483 Vali Acc: 0.554 Test Loss: 1.483 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.416517972946167
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.554 Test Loss: 1.477 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0167946815490723
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.511 Vali Acc: 0.554 Test Loss: 1.511 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.670257568359375
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.554 Test Loss: 1.543 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 30478852
model size : 130.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.202030658721924
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.441 Vali Acc: 0.284 Test Loss: 1.441 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 0.8037841320037842
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.326 Vali Acc: 0.419 Test Loss: 1.326 Test Acc: 0.419
Validation loss decreased (-0.283769 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.908294677734375
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.299 Vali Acc: 0.473 Test Loss: 1.299 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.6778252124786377
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.239 Vali Acc: 0.514 Test Loss: 1.239 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 0.9551386833190918
Epoch: 5, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.0139765739440918
Epoch: 6, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.5310065746307373
Epoch: 7, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.043 Vali Acc: 0.527 Test Loss: 1.043 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7040503025054932
Epoch: 8, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.041 Vali Acc: 0.554 Test Loss: 1.041 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 0.68780517578125
Epoch: 9, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.6301360130310059
Epoch: 10, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6417758464813232
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.041 Vali Acc: 0.649 Test Loss: 1.041 Test Acc: 0.649
Validation loss decreased (-0.567557 --> -0.648638).  Saving model ...
Epoch: 12 cost time: 0.8056137561798096
Epoch: 12, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7000703811645508
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.192 Vali Acc: 0.608 Test Loss: 1.192 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6753654479980469
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7060694694519043
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.182 Vali Acc: 0.568 Test Loss: 1.182 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7031259536743164
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.161 Vali Acc: 0.608 Test Loss: 1.161 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6991274356842041
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.152 Vali Acc: 0.595 Test Loss: 1.152 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7382333278656006
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.183 Vali Acc: 0.581 Test Loss: 1.183 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1273281574249268
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.195 Vali Acc: 0.608 Test Loss: 1.195 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8573236465454102
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.189 Vali Acc: 0.595 Test Loss: 1.189 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8257308006286621
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 30423556
model size : 130.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5774588584899902
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.353 Vali Acc: 0.284 Test Loss: 1.353 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.5803453922271729
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.344 Vali Acc: 0.365 Test Loss: 1.344 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 0.7017431259155273
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.364851 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.8198294639587402
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6419012546539307
Epoch: 5, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.166 Vali Acc: 0.527 Test Loss: 1.166 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.691502571105957
Epoch: 6, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.148 Vali Acc: 0.514 Test Loss: 1.148 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7493689060211182
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.7215852737426758
Epoch: 8, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.057 Vali Acc: 0.527 Test Loss: 1.057 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.7334237098693848
Epoch: 9, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5770370960235596
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 0.6400909423828125
Epoch: 11, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6598634719848633
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6292445659637451
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.178 Vali Acc: 0.595 Test Loss: 1.178 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 0.615293025970459
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.276 Vali Acc: 0.608 Test Loss: 1.276 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608095).  Saving model ...
Epoch: 15 cost time: 0.6500449180603027
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.191 Vali Acc: 0.568 Test Loss: 1.191 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6355509757995605
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.246 Vali Acc: 0.608 Test Loss: 1.246 Test Acc: 0.608
Validation loss decreased (-0.608095 --> -0.608096).  Saving model ...
Epoch: 17 cost time: 0.6425952911376953
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.310 Vali Acc: 0.527 Test Loss: 1.310 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6362342834472656
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.280 Vali Acc: 0.554 Test Loss: 1.280 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6806848049163818
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.327 Vali Acc: 0.608 Test Loss: 1.327 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6741371154785156
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.346 Vali Acc: 0.608 Test Loss: 1.346 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7097485065460205
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.323 Vali Acc: 0.622 Test Loss: 1.323 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621608).  Saving model ...
Epoch: 22 cost time: 0.6782331466674805
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.321 Vali Acc: 0.635 Test Loss: 1.321 Test Acc: 0.635
Validation loss decreased (-0.621608 --> -0.635122).  Saving model ...
Epoch: 23 cost time: 0.6903162002563477
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.356 Vali Acc: 0.635 Test Loss: 1.356 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6537737846374512
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.375 Vali Acc: 0.595 Test Loss: 1.375 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7121155261993408
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.370 Vali Acc: 0.595 Test Loss: 1.370 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6649169921875
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.392 Vali Acc: 0.608 Test Loss: 1.392 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6333305835723877
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.415 Vali Acc: 0.595 Test Loss: 1.415 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5948634147644043
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.399 Vali Acc: 0.595 Test Loss: 1.399 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7688734531402588
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.400 Vali Acc: 0.595 Test Loss: 1.400 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.68638014793396
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.431 Vali Acc: 0.595 Test Loss: 1.431 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5945706367492676
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.446 Vali Acc: 0.595 Test Loss: 1.446 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6191680431365967
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.608 Test Loss: 1.455 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 30391300
model size : 130.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.082430839538574
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.463 Vali Acc: 0.297 Test Loss: 1.463 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.6589930057525635
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.324 Vali Acc: 0.419 Test Loss: 1.324 Test Acc: 0.419
Validation loss decreased (-0.297283 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8059964179992676
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.8623809814453125
Epoch: 4, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.212 Vali Acc: 0.446 Test Loss: 1.212 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3446903228759766
Epoch: 5, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2207996845245361
Epoch: 6, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.0521471500396729
Epoch: 7, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8619251251220703
Epoch: 8, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.875434160232544
Epoch: 9, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.310 Vali Acc: 0.514 Test Loss: 1.310 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3203232288360596
Epoch: 10, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.217 Vali Acc: 0.568 Test Loss: 1.217 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567555).  Saving model ...
Epoch: 11 cost time: 1.2700188159942627
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.407 Vali Acc: 0.473 Test Loss: 1.407 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9081482887268066
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2880144119262695
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.462 Vali Acc: 0.527 Test Loss: 1.462 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8995151519775391
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.304 Vali Acc: 0.581 Test Loss: 1.304 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581068).  Saving model ...
Epoch: 15 cost time: 0.8136966228485107
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.336 Vali Acc: 0.568 Test Loss: 1.336 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.436615228652954
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.381 Vali Acc: 0.541 Test Loss: 1.381 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9379279613494873
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.368 Vali Acc: 0.568 Test Loss: 1.368 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.819922924041748
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.568 Test Loss: 1.373 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9748096466064453
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.406 Vali Acc: 0.554 Test Loss: 1.406 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7445218563079834
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.568 Test Loss: 1.417 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2204949855804443
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.431 Vali Acc: 0.554 Test Loss: 1.431 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8416647911071777
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.568 Test Loss: 1.430 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7680103778839111
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.568 Test Loss: 1.434 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9711968898773193
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.581 Test Loss: 1.459 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 30644740
model size : 131.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2298471927642822
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.383 Vali Acc: 0.284 Test Loss: 1.383 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9370787143707275
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.403 Vali Acc: 0.203 Test Loss: 1.403 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0099976062774658
Epoch: 3, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.337 Vali Acc: 0.365 Test Loss: 1.337 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.6447451114654541
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.230 Vali Acc: 0.486 Test Loss: 1.230 Test Acc: 0.486
Validation loss decreased (-0.364851 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 0.8563807010650635
Epoch: 5, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.287 Vali Acc: 0.392 Test Loss: 1.287 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6022255420684814
Epoch: 6, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.5841002464294434
Epoch: 7, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7353579998016357
Epoch: 8, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.297 Vali Acc: 0.527 Test Loss: 1.297 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6384198665618896
Epoch: 9, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 0.882498025894165
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.386 Vali Acc: 0.541 Test Loss: 1.386 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7489330768585205
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.217 Vali Acc: 0.581 Test Loss: 1.217 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 0.8980104923248291
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.476 Vali Acc: 0.568 Test Loss: 1.476 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6607191562652588
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.371 Vali Acc: 0.554 Test Loss: 1.371 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6692023277282715
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.339 Vali Acc: 0.581 Test Loss: 1.339 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5930471420288086
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.482 Vali Acc: 0.554 Test Loss: 1.482 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8063735961914062
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.444 Vali Acc: 0.581 Test Loss: 1.444 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7906124591827393
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6084074974060059
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.434 Vali Acc: 0.595 Test Loss: 1.434 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594580).  Saving model ...
Epoch: 19 cost time: 0.9445819854736328
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.453 Vali Acc: 0.595 Test Loss: 1.453 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9389595985412598
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.497 Vali Acc: 0.608 Test Loss: 1.497 Test Acc: 0.608
Validation loss decreased (-0.594580 --> -0.608093).  Saving model ...
Epoch: 21 cost time: 0.8429446220397949
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.521 Vali Acc: 0.608 Test Loss: 1.521 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7423627376556396
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.522 Vali Acc: 0.622 Test Loss: 1.522 Test Acc: 0.622
Validation loss decreased (-0.608093 --> -0.621606).  Saving model ...
Epoch: 23 cost time: 0.7735354900360107
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.552 Vali Acc: 0.595 Test Loss: 1.552 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0933318138122559
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.572 Vali Acc: 0.581 Test Loss: 1.572 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7852957248687744
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.573 Vali Acc: 0.581 Test Loss: 1.573 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7314445972442627
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.555 Vali Acc: 0.581 Test Loss: 1.555 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6414783000946045
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.550 Vali Acc: 0.581 Test Loss: 1.550 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.769517183303833
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.570 Vali Acc: 0.581 Test Loss: 1.570 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7308046817779541
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.581 Test Loss: 1.584 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8485190868377686
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.581 Test Loss: 1.599 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7538435459136963
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.581 Test Loss: 1.604 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.585820198059082
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.581 Test Loss: 1.609 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 30594052
model size : 131.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.067059278488159
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.405 Vali Acc: 0.216 Test Loss: 1.405 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.5415027141571045
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.380 Vali Acc: 0.338 Test Loss: 1.380 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.7576148509979248
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.353 Vali Acc: 0.378 Test Loss: 1.353 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.6924362182617188
Epoch: 4, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.331 Vali Acc: 0.392 Test Loss: 1.331 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.5965893268585205
Epoch: 5, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.729194164276123
Epoch: 6, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.8396039009094238
Epoch: 7, Steps: 10 | Train Loss: 0.734 Vali Loss: 1.210 Vali Acc: 0.432 Test Loss: 1.210 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.651214599609375
Epoch: 8, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.156 Vali Acc: 0.459 Test Loss: 1.156 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 9 cost time: 0.8265280723571777
Epoch: 9, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.131 Vali Acc: 0.486 Test Loss: 1.131 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 0.7629406452178955
Epoch: 10, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 0.775923490524292
Epoch: 11, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6731712818145752
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7566215991973877
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6846573352813721
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.184 Vali Acc: 0.527 Test Loss: 1.184 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7053279876708984
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9039974212646484
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.215 Vali Acc: 0.568 Test Loss: 1.215 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567555).  Saving model ...
Epoch: 17 cost time: 0.6379728317260742
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.209 Vali Acc: 0.568 Test Loss: 1.209 Test Acc: 0.568
Validation loss decreased (-0.567555 --> -0.567555).  Saving model ...
Epoch: 18 cost time: 0.7058165073394775
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
Validation loss decreased (-0.567555 --> -0.567556).  Saving model ...
Epoch: 19 cost time: 0.7795324325561523
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.195 Vali Acc: 0.568 Test Loss: 1.195 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 20 cost time: 0.6573247909545898
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.203 Vali Acc: 0.568 Test Loss: 1.203 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7091107368469238
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.218 Vali Acc: 0.568 Test Loss: 1.218 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6450533866882324
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.230 Vali Acc: 0.554 Test Loss: 1.230 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6741983890533447
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.239 Vali Acc: 0.554 Test Loss: 1.239 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6256394386291504
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.250 Vali Acc: 0.554 Test Loss: 1.250 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6709480285644531
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.255 Vali Acc: 0.554 Test Loss: 1.255 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6386778354644775
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.267 Vali Acc: 0.554 Test Loss: 1.267 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.641359806060791
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.304 Vali Acc: 0.541 Test Loss: 1.304 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5583033561706543
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.303 Vali Acc: 0.541 Test Loss: 1.303 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5516159534454346
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.272 Vali Acc: 0.541 Test Loss: 1.272 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 30566404
model size : 131.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1631462574005127
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.396 Vali Acc: 0.230 Test Loss: 1.396 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.0519726276397705
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.337 Vali Acc: 0.338 Test Loss: 1.337 Test Acc: 0.338
Validation loss decreased (-0.229716 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.7395257949829102
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.260 Vali Acc: 0.432 Test Loss: 1.260 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.5626749992370605
Epoch: 4, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.203 Vali Acc: 0.419 Test Loss: 1.203 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0046303272247314
Epoch: 5, Steps: 10 | Train Loss: 0.876 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8960814476013184
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6938009262084961
Epoch: 7, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7876958847045898
Epoch: 8, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 1.069385290145874
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.293 Vali Acc: 0.595 Test Loss: 1.293 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594582).  Saving model ...
Epoch: 10 cost time: 0.5742268562316895
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.410 Vali Acc: 0.541 Test Loss: 1.410 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6111102104187012
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.331 Vali Acc: 0.568 Test Loss: 1.331 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5825924873352051
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5970680713653564
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.377 Vali Acc: 0.608 Test Loss: 1.377 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608094).  Saving model ...
Epoch: 14 cost time: 0.6074128150939941
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.531 Vali Acc: 0.595 Test Loss: 1.531 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5839810371398926
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.491 Vali Acc: 0.581 Test Loss: 1.491 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6990268230438232
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.534 Vali Acc: 0.568 Test Loss: 1.534 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7797191143035889
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.581 Test Loss: 1.551 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1677043437957764
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.564 Vali Acc: 0.581 Test Loss: 1.564 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9014227390289307
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.572 Vali Acc: 0.581 Test Loss: 1.572 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3618981838226318
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.582 Vali Acc: 0.581 Test Loss: 1.582 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7924089431762695
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.587 Vali Acc: 0.622 Test Loss: 1.587 Test Acc: 0.622
Validation loss decreased (-0.608094 --> -0.621606).  Saving model ...
Epoch: 22 cost time: 0.8167650699615479
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.581 Test Loss: 1.598 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6593539714813232
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.595 Test Loss: 1.592 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8795769214630127
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.581 Test Loss: 1.609 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9712193012237549
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.608 Test Loss: 1.624 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2600688934326172
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.608 Test Loss: 1.634 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7947611808776855
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.581 Test Loss: 1.646 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3979709148406982
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.581 Test Loss: 1.649 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7012958526611328
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.608 Test Loss: 1.655 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8559098243713379
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.608 Test Loss: 1.676 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7901318073272705
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.608 Test Loss: 1.676 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 30838276
model size : 132.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.376589298248291
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.416 Vali Acc: 0.203 Test Loss: 1.416 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.8603677749633789
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.345 Vali Acc: 0.351 Test Loss: 1.345 Test Acc: 0.351
Validation loss decreased (-0.202689 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.7095298767089844
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.325 Vali Acc: 0.378 Test Loss: 1.325 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.6892740726470947
Epoch: 4, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.265 Vali Acc: 0.419 Test Loss: 1.265 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.7999875545501709
Epoch: 5, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.195 Vali Acc: 0.473 Test Loss: 1.195 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.9992179870605469
Epoch: 6, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.193 Vali Acc: 0.419 Test Loss: 1.193 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.613480806350708
Epoch: 7, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.100 Vali Acc: 0.486 Test Loss: 1.100 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.06528902053833
Epoch: 8, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.078 Vali Acc: 0.514 Test Loss: 1.078 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513503).  Saving model ...
Epoch: 9 cost time: 0.7528214454650879
Epoch: 9, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527017).  Saving model ...
Epoch: 10 cost time: 0.9242262840270996
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8883180618286133
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.195 Vali Acc: 0.473 Test Loss: 1.195 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0294604301452637
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.203 Vali Acc: 0.541 Test Loss: 1.203 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 0.7056446075439453
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.138 Vali Acc: 0.581 Test Loss: 1.138 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 0.8267953395843506
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.134 Vali Acc: 0.581 Test Loss: 1.134 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 0.7201120853424072
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.126 Vali Acc: 0.595 Test Loss: 1.126 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 16 cost time: 0.8886022567749023
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.097 Vali Acc: 0.635 Test Loss: 1.097 Test Acc: 0.635
Validation loss decreased (-0.594583 --> -0.635124).  Saving model ...
Epoch: 17 cost time: 0.7661030292510986
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.102 Vali Acc: 0.622 Test Loss: 1.102 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6172170639038086
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.116 Vali Acc: 0.608 Test Loss: 1.116 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7261126041412354
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.153 Vali Acc: 0.608 Test Loss: 1.153 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8943712711334229
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.186 Vali Acc: 0.595 Test Loss: 1.186 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8009445667266846
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.189 Vali Acc: 0.595 Test Loss: 1.189 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8446822166442871
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.183 Vali Acc: 0.581 Test Loss: 1.183 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.779280424118042
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.174 Vali Acc: 0.608 Test Loss: 1.174 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9247608184814453
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.174 Vali Acc: 0.595 Test Loss: 1.174 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8917694091796875
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.184 Vali Acc: 0.595 Test Loss: 1.184 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1688129901885986
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.185 Vali Acc: 0.595 Test Loss: 1.185 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 30792196
model size : 132.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.014106512069702
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.360 Vali Acc: 0.324 Test Loss: 1.360 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.870173454284668
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.307 Vali Acc: 0.459 Test Loss: 1.307 Test Acc: 0.459
Validation loss decreased (-0.324311 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.6332056522369385
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.256 Vali Acc: 0.514 Test Loss: 1.256 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.6503551006317139
Epoch: 4, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.7938816547393799
Epoch: 5, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.9089112281799316
Epoch: 6, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.166 Vali Acc: 0.568 Test Loss: 1.166 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 0.7210726737976074
Epoch: 7, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.083 Vali Acc: 0.581 Test Loss: 1.083 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.6551969051361084
Epoch: 8, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5997011661529541
Epoch: 9, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.083 Vali Acc: 0.622 Test Loss: 1.083 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 0.5970470905303955
Epoch: 10, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5523762702941895
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.195 Vali Acc: 0.581 Test Loss: 1.195 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.555189847946167
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5498089790344238
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.111 Vali Acc: 0.608 Test Loss: 1.111 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7810373306274414
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.168 Vali Acc: 0.622 Test Loss: 1.168 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6258959770202637
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.190 Vali Acc: 0.622 Test Loss: 1.190 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.614771842956543
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.188 Vali Acc: 0.635 Test Loss: 1.188 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635123).  Saving model ...
Epoch: 17 cost time: 0.5868568420410156
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.188 Vali Acc: 0.635 Test Loss: 1.188 Test Acc: 0.635
Validation loss decreased (-0.635123 --> -0.635123).  Saving model ...
Epoch: 18 cost time: 0.5919537544250488
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.190 Vali Acc: 0.635 Test Loss: 1.190 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7808551788330078
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.208 Vali Acc: 0.635 Test Loss: 1.208 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5952911376953125
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.225 Vali Acc: 0.635 Test Loss: 1.225 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5333347320556641
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.239 Vali Acc: 0.622 Test Loss: 1.239 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6470649242401123
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7229955196380615
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.242 Vali Acc: 0.622 Test Loss: 1.242 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7703485488891602
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.266 Vali Acc: 0.622 Test Loss: 1.266 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7286810874938965
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.276 Vali Acc: 0.622 Test Loss: 1.276 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7213625907897949
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.290 Vali Acc: 0.622 Test Loss: 1.290 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5503969192504883
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.297 Vali Acc: 0.635 Test Loss: 1.297 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 30769156
model size : 132.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.314777135848999
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.416 Vali Acc: 0.216 Test Loss: 1.416 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.1955487728118896
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.351 Vali Acc: 0.338 Test Loss: 1.351 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.341137170791626
Epoch: 3, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 0.8126480579376221
Epoch: 4, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.235 Vali Acc: 0.405 Test Loss: 1.235 Test Acc: 0.405
Validation loss decreased (-0.337825 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 0.7289159297943115
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.204 Vali Acc: 0.446 Test Loss: 1.204 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 0.8294920921325684
Epoch: 6, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.8616540431976318
Epoch: 7, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.223 Vali Acc: 0.541 Test Loss: 1.223 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 0.7732234001159668
Epoch: 8, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.199 Vali Acc: 0.473 Test Loss: 1.199 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0085577964782715
Epoch: 9, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 0.8754079341888428
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.216 Vali Acc: 0.568 Test Loss: 1.216 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 11 cost time: 0.6772239208221436
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.283 Vali Acc: 0.554 Test Loss: 1.283 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7617855072021484
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.263 Vali Acc: 0.527 Test Loss: 1.263 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.305802822113037
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.195 Vali Acc: 0.581 Test Loss: 1.195 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581069).  Saving model ...
Epoch: 14 cost time: 0.7658584117889404
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.235 Vali Acc: 0.595 Test Loss: 1.235 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 15 cost time: 0.8595857620239258
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.283 Vali Acc: 0.608 Test Loss: 1.283 Test Acc: 0.608
Validation loss decreased (-0.594582 --> -0.608095).  Saving model ...
Epoch: 16 cost time: 1.127171277999878
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.323 Vali Acc: 0.608 Test Loss: 1.323 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8375339508056641
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.595 Test Loss: 1.349 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5605006217956543
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.309 Vali Acc: 0.595 Test Loss: 1.309 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7798583507537842
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.315 Vali Acc: 0.608 Test Loss: 1.315 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6927962303161621
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.331 Vali Acc: 0.622 Test Loss: 1.331 Test Acc: 0.622
Validation loss decreased (-0.608095 --> -0.621608).  Saving model ...
Epoch: 21 cost time: 1.270127773284912
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.622 Test Loss: 1.347 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.858910322189331
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.608 Test Loss: 1.367 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8058600425720215
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.608 Test Loss: 1.363 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6865670680999756
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.608 Test Loss: 1.348 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7185251712799072
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.360 Vali Acc: 0.608 Test Loss: 1.360 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6871557235717773
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.383 Vali Acc: 0.608 Test Loss: 1.383 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7754263877868652
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.595 Test Loss: 1.398 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7963297367095947
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.608 Test Loss: 1.395 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8974497318267822
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.608 Test Loss: 1.391 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2227816581726074
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.608 Test Loss: 1.391 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 31123972
model size : 133.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2053420543670654
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.447 Vali Acc: 0.270 Test Loss: 1.447 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.7267987728118896
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.324 Vali Acc: 0.432 Test Loss: 1.324 Test Acc: 0.432
Validation loss decreased (-0.270256 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.6426472663879395
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.281 Vali Acc: 0.446 Test Loss: 1.281 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.6009743213653564
Epoch: 4, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.7976858615875244
Epoch: 5, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.6966321468353271
Epoch: 6, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.5386083126068115
Epoch: 7, Steps: 10 | Train Loss: 0.487 Vali Loss: 1.117 Vali Acc: 0.527 Test Loss: 1.117 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.5648653507232666
Epoch: 8, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8108725547790527
Epoch: 9, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.083 Vali Acc: 0.541 Test Loss: 1.083 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 0.6134731769561768
Epoch: 10, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7062122821807861
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7718055248260498
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.242 Vali Acc: 0.568 Test Loss: 1.242 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567555).  Saving model ...
Epoch: 13 cost time: 0.658015251159668
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.199 Vali Acc: 0.581 Test Loss: 1.199 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581069).  Saving model ...
Epoch: 14 cost time: 0.694526195526123
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.218 Vali Acc: 0.514 Test Loss: 1.218 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.741795539855957
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6998081207275391
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8946259021759033
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.211 Vali Acc: 0.554 Test Loss: 1.211 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6786978244781494
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.211 Vali Acc: 0.554 Test Loss: 1.211 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8855211734771729
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.213 Vali Acc: 0.554 Test Loss: 1.213 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6303260326385498
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7477314472198486
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6932141780853271
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.222 Vali Acc: 0.541 Test Loss: 1.222 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6346611976623535
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.221 Vali Acc: 0.568 Test Loss: 1.221 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 31087108
model size : 133.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9446125030517578
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.419 Vali Acc: 0.203 Test Loss: 1.419 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.6414039134979248
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.327 Vali Acc: 0.284 Test Loss: 1.327 Test Acc: 0.284
Validation loss decreased (-0.202689 --> -0.283771).  Saving model ...
Epoch: 3 cost time: 0.9681379795074463
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.269 Vali Acc: 0.432 Test Loss: 1.269 Test Acc: 0.432
Validation loss decreased (-0.283771 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.6822848320007324
Epoch: 4, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.248 Vali Acc: 0.446 Test Loss: 1.248 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.6551222801208496
Epoch: 5, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.204 Vali Acc: 0.527 Test Loss: 1.204 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.5269954204559326
Epoch: 6, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.148 Vali Acc: 0.473 Test Loss: 1.148 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5199949741363525
Epoch: 7, Steps: 10 | Train Loss: 0.644 Vali Loss: 1.074 Vali Acc: 0.514 Test Loss: 1.074 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5007569789886475
Epoch: 8, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.060 Vali Acc: 0.527 Test Loss: 1.060 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.8408851623535156
Epoch: 9, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554044).  Saving model ...
Epoch: 10 cost time: 0.6091518402099609
Epoch: 10, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.998 Vali Acc: 0.581 Test Loss: 0.998 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 0.7620656490325928
Epoch: 11, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.012 Vali Acc: 0.581 Test Loss: 1.012 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6482632160186768
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.990 Vali Acc: 0.608 Test Loss: 0.990 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 0.6209845542907715
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5967457294464111
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.005 Vali Acc: 0.595 Test Loss: 1.005 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8159871101379395
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.988 Vali Acc: 0.649 Test Loss: 0.988 Test Acc: 0.649
Validation loss decreased (-0.608098 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 0.6868464946746826
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.992 Vali Acc: 0.649 Test Loss: 0.992 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9855754375457764
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.015 Vali Acc: 0.662 Test Loss: 1.015 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 18 cost time: 0.6421866416931152
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.005 Vali Acc: 0.662 Test Loss: 1.005 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 19 cost time: 0.8268287181854248
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8484904766082764
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.017 Vali Acc: 0.608 Test Loss: 1.017 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.80704665184021
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.029 Vali Acc: 0.595 Test Loss: 1.029 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.786888599395752
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8389513492584229
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8376033306121826
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.041 Vali Acc: 0.608 Test Loss: 1.041 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9013183116912842
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6954209804534912
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.608 Test Loss: 1.054 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6712696552276611
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.056 Vali Acc: 0.622 Test Loss: 1.056 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7032699584960938
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.065 Vali Acc: 0.635 Test Loss: 1.065 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el4_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 31068676
model size : 133.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.675772190093994
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.441 Vali Acc: 0.203 Test Loss: 1.441 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.1513886451721191
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.299 Vali Acc: 0.297 Test Loss: 1.299 Test Acc: 0.297
Validation loss decreased (-0.202688 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.005082368850708
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.476 Vali Acc: 0.405 Test Loss: 1.476 Test Acc: 0.405
Validation loss decreased (-0.297284 --> -0.405391).  Saving model ...
Epoch: 4 cost time: 0.9805989265441895
Epoch: 4, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.795 Vali Acc: 0.243 Test Loss: 1.795 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.018383502960205
Epoch: 5, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
Validation loss decreased (-0.405391 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 1.0561375617980957
Epoch: 6, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.292 Vali Acc: 0.473 Test Loss: 1.292 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.036736011505127
Epoch: 7, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.330 Vali Acc: 0.446 Test Loss: 1.330 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0053308010101318
Epoch: 8, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.765 Vali Acc: 0.473 Test Loss: 1.765 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0171177387237549
Epoch: 9, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.407 Vali Acc: 0.365 Test Loss: 3.407 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0398733615875244
Epoch: 10, Steps: 10 | Train Loss: 0.288 Vali Loss: 2.375 Vali Acc: 0.473 Test Loss: 2.375 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1027560234069824
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 2.776 Vali Acc: 0.473 Test Loss: 2.776 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9255390167236328
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 2.258 Vali Acc: 0.581 Test Loss: 2.258 Test Acc: 0.581
Validation loss decreased (-0.486475 --> -0.581059).  Saving model ...
Epoch: 13 cost time: 1.1118290424346924
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 2.771 Vali Acc: 0.486 Test Loss: 2.771 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8580515384674072
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 2.708 Vali Acc: 0.541 Test Loss: 2.708 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0301249027252197
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.830 Vali Acc: 0.514 Test Loss: 2.830 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2681810855865479
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 2.766 Vali Acc: 0.500 Test Loss: 2.766 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8636484146118164
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 2.558 Vali Acc: 0.608 Test Loss: 2.558 Test Acc: 0.608
Validation loss decreased (-0.581059 --> -0.608083).  Saving model ...
Epoch: 18 cost time: 0.9771895408630371
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.751 Vali Acc: 0.541 Test Loss: 2.751 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7085556983947754
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.978 Vali Acc: 0.486 Test Loss: 2.978 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6722941398620605
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.672 Vali Acc: 0.500 Test Loss: 2.672 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7670130729675293
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.799 Vali Acc: 0.541 Test Loss: 2.799 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7011637687683105
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.843 Vali Acc: 0.541 Test Loss: 2.843 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7906043529510498
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.806 Vali Acc: 0.554 Test Loss: 2.806 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7289299964904785
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.527 Test Loss: 2.802 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8627634048461914
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.817 Vali Acc: 0.527 Test Loss: 2.817 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9400765895843506
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.527 Test Loss: 2.812 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0360324382781982
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.541 Test Loss: 2.812 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 22930180
model size : 102.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1106393337249756
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.363 Vali Acc: 0.392 Test Loss: 1.363 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.5568068027496338
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0813889503479004
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.583040714263916
Epoch: 4, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.227 Vali Acc: 0.446 Test Loss: 1.227 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.8416094779968262
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8811233043670654
Epoch: 6, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.6975035667419434
Epoch: 7, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.142 Vali Acc: 0.486 Test Loss: 1.142 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8991353511810303
Epoch: 8, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.209 Vali Acc: 0.486 Test Loss: 1.209 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2962627410888672
Epoch: 9, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.353 Vali Acc: 0.486 Test Loss: 1.353 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9139654636383057
Epoch: 10, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.522 Vali Acc: 0.486 Test Loss: 1.522 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0558905601501465
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.594 Vali Acc: 0.486 Test Loss: 1.594 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7503280639648438
Epoch: 12, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.613 Vali Acc: 0.514 Test Loss: 1.613 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7113039493560791
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.479 Vali Acc: 0.554 Test Loss: 1.479 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554039).  Saving model ...
Epoch: 14 cost time: 0.7219114303588867
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.428 Vali Acc: 0.608 Test Loss: 1.428 Test Acc: 0.608
Validation loss decreased (-0.554039 --> -0.608094).  Saving model ...
Epoch: 15 cost time: 1.225332260131836
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.350 Vali Acc: 0.662 Test Loss: 1.350 Test Acc: 0.662
Validation loss decreased (-0.608094 --> -0.662149).  Saving model ...
Epoch: 16 cost time: 0.7630667686462402
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.495 Vali Acc: 0.568 Test Loss: 1.495 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9274170398712158
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.733 Vali Acc: 0.622 Test Loss: 1.733 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.758887767791748
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.531 Vali Acc: 0.568 Test Loss: 1.531 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1425702571868896
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.622 Test Loss: 1.537 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6466596126556396
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.608 Test Loss: 1.606 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1128590106964111
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.649 Test Loss: 1.596 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8742477893829346
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.649 Test Loss: 1.597 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9990370273590088
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.649 Test Loss: 1.591 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.012223720550537
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.649 Test Loss: 1.615 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9318678379058838
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.662 Test Loss: 1.587 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 22708996
model size : 101.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1967101097106934
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.396 Vali Acc: 0.311 Test Loss: 1.396 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.5660467147827148
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.367 Vali Acc: 0.189 Test Loss: 1.367 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5979821681976318
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.331 Vali Acc: 0.351 Test Loss: 1.331 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.6267914772033691
Epoch: 4, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.268 Vali Acc: 0.419 Test Loss: 1.268 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.7061154842376709
Epoch: 5, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.272 Vali Acc: 0.365 Test Loss: 1.272 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1598320007324219
Epoch: 6, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.211 Vali Acc: 0.527 Test Loss: 1.211 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.7287328243255615
Epoch: 7, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.187 Vali Acc: 0.419 Test Loss: 1.187 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7240047454833984
Epoch: 8, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.146 Vali Acc: 0.446 Test Loss: 1.146 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6822271347045898
Epoch: 9, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6736717224121094
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.290 Vali Acc: 0.554 Test Loss: 1.290 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554041).  Saving model ...
Epoch: 11 cost time: 0.8582277297973633
Epoch: 11, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.525 Vali Acc: 0.473 Test Loss: 1.525 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8604075908660889
Epoch: 12, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.324 Vali Acc: 0.459 Test Loss: 1.324 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.614138126373291
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.465 Vali Acc: 0.527 Test Loss: 1.465 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7276961803436279
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.413 Vali Acc: 0.473 Test Loss: 1.413 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5911645889282227
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.369 Vali Acc: 0.527 Test Loss: 1.369 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7442851066589355
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.426 Vali Acc: 0.473 Test Loss: 1.426 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9088859558105469
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.432 Vali Acc: 0.568 Test Loss: 1.432 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567553).  Saving model ...
Epoch: 18 cost time: 1.1011312007904053
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.432 Vali Acc: 0.514 Test Loss: 1.432 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.681553840637207
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.432 Vali Acc: 0.541 Test Loss: 1.432 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7320952415466309
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.440 Vali Acc: 0.541 Test Loss: 1.440 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7922298908233643
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.424 Vali Acc: 0.514 Test Loss: 1.424 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7897682189941406
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.411 Vali Acc: 0.541 Test Loss: 1.411 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0885639190673828
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.568 Test Loss: 1.413 Test Acc: 0.568
Validation loss decreased (-0.567553 --> -0.567553).  Saving model ...
Epoch: 24 cost time: 0.6443095207214355
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.423 Vali Acc: 0.581 Test Loss: 1.423 Test Acc: 0.581
Validation loss decreased (-0.567553 --> -0.581067).  Saving model ...
Epoch: 25 cost time: 0.5088491439819336
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.415 Vali Acc: 0.541 Test Loss: 1.415 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6477663516998291
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.541 Test Loss: 1.403 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9030101299285889
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.541 Test Loss: 1.417 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5919442176818848
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.541 Test Loss: 1.427 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5596859455108643
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.541 Test Loss: 1.425 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5100727081298828
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.554 Test Loss: 1.412 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5823101997375488
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.554 Test Loss: 1.410 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5837099552154541
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.554 Test Loss: 1.419 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9240210056304932
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.554 Test Loss: 1.429 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7211332321166992
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.432 Vali Acc: 0.554 Test Loss: 1.432 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 22598404
model size : 100.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6548101902008057
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.401 Vali Acc: 0.351 Test Loss: 1.401 Test Acc: 0.351
Validation loss decreased (inf --> -0.351337).  Saving model ...
Epoch: 2 cost time: 1.464503526687622
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.507 Vali Acc: 0.243 Test Loss: 1.507 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0860443115234375
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.430 Vali Acc: 0.473 Test Loss: 1.430 Test Acc: 0.473
Validation loss decreased (-0.351337 --> -0.472959).  Saving model ...
Epoch: 4 cost time: 1.6797771453857422
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.685 Vali Acc: 0.203 Test Loss: 1.685 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0979399681091309
Epoch: 5, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
Validation loss decreased (-0.472959 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.5258188247680664
Epoch: 6, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.320 Vali Acc: 0.473 Test Loss: 1.320 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9277410507202148
Epoch: 7, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.271 Vali Acc: 0.541 Test Loss: 1.271 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 1.018846035003662
Epoch: 8, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.569 Vali Acc: 0.459 Test Loss: 1.569 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9484262466430664
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.824 Vali Acc: 0.419 Test Loss: 1.824 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8859729766845703
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.600 Vali Acc: 0.486 Test Loss: 1.600 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0226831436157227
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.890 Vali Acc: 0.568 Test Loss: 1.890 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567549).  Saving model ...
Epoch: 12 cost time: 0.950049638748169
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 2.064 Vali Acc: 0.473 Test Loss: 2.064 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9390859603881836
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.969 Vali Acc: 0.568 Test Loss: 1.969 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.823793888092041
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.549 Vali Acc: 0.527 Test Loss: 2.549 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8104314804077148
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 2.579 Vali Acc: 0.500 Test Loss: 2.579 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.025413990020752
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 2.402 Vali Acc: 0.500 Test Loss: 2.402 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1311967372894287
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.085 Vali Acc: 0.459 Test Loss: 3.085 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1379449367523193
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 2.714 Vali Acc: 0.541 Test Loss: 2.714 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9670393466949463
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.288 Vali Acc: 0.446 Test Loss: 4.288 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.966475248336792
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.678 Vali Acc: 0.486 Test Loss: 3.678 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7678322792053223
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.184 Vali Acc: 0.473 Test Loss: 3.184 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 22861060
model size : 101.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.081441640853882
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.464 Vali Acc: 0.230 Test Loss: 1.464 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.7975008487701416
Epoch: 2, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.9796962738037109
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.344 Vali Acc: 0.311 Test Loss: 1.344 Test Acc: 0.311
Validation loss decreased (-0.243229 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.090256690979004
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.291 Vali Acc: 0.446 Test Loss: 1.291 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.9476132392883301
Epoch: 5, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.224 Vali Acc: 0.405 Test Loss: 1.224 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7342925071716309
Epoch: 6, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.9007346630096436
Epoch: 7, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.111 Vali Acc: 0.473 Test Loss: 1.111 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4312877655029297
Epoch: 8, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.444 Vali Acc: 0.500 Test Loss: 1.444 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7159361839294434
Epoch: 9, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.275071144104004
Epoch: 10, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.205 Vali Acc: 0.527 Test Loss: 1.205 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0921218395233154
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.233 Vali Acc: 0.595 Test Loss: 1.233 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 12 cost time: 0.883065938949585
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.312 Vali Acc: 0.581 Test Loss: 1.312 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1110291481018066
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.486 Vali Acc: 0.527 Test Loss: 1.486 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8211109638214111
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.334 Vali Acc: 0.595 Test Loss: 1.334 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7630436420440674
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.482 Vali Acc: 0.541 Test Loss: 1.482 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7422091960906982
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.472 Vali Acc: 0.568 Test Loss: 1.472 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7758769989013672
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.568 Test Loss: 1.487 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6863768100738525
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.568 Test Loss: 1.535 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0248870849609375
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.595 Test Loss: 1.526 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8856556415557861
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.581 Test Loss: 1.505 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.762474536895752
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.549 Vali Acc: 0.581 Test Loss: 1.549 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 22704388
model size : 101.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.331637382507324
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.404 Vali Acc: 0.230 Test Loss: 1.404 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.5996782779693604
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.396 Vali Acc: 0.338 Test Loss: 1.396 Test Acc: 0.338
Validation loss decreased (-0.229716 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.7840917110443115
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.371 Vali Acc: 0.311 Test Loss: 1.371 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9631164073944092
Epoch: 4, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.294 Vali Acc: 0.378 Test Loss: 1.294 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.818915605545044
Epoch: 5, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.277 Vali Acc: 0.378 Test Loss: 1.277 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 6 cost time: 1.1521201133728027
Epoch: 6, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.210 Vali Acc: 0.527 Test Loss: 1.210 Test Acc: 0.527
Validation loss decreased (-0.378366 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.8577229976654053
Epoch: 7, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6624388694763184
Epoch: 8, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7233626842498779
Epoch: 9, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.355 Vali Acc: 0.473 Test Loss: 1.355 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7702398300170898
Epoch: 10, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.250 Vali Acc: 0.554 Test Loss: 1.250 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 0.658867359161377
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.207 Vali Acc: 0.581 Test Loss: 1.207 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 0.574709415435791
Epoch: 12, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.306 Vali Acc: 0.486 Test Loss: 1.306 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5380990505218506
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.321 Vali Acc: 0.514 Test Loss: 1.321 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9902913570404053
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9152743816375732
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.297 Vali Acc: 0.595 Test Loss: 1.297 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 16 cost time: 0.6705005168914795
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.441 Vali Acc: 0.649 Test Loss: 1.441 Test Acc: 0.649
Validation loss decreased (-0.594582 --> -0.648634).  Saving model ...
Epoch: 17 cost time: 0.6111862659454346
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.417 Vali Acc: 0.622 Test Loss: 1.417 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0204195976257324
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.420 Vali Acc: 0.662 Test Loss: 1.420 Test Acc: 0.662
Validation loss decreased (-0.648634 --> -0.662148).  Saving model ...
Epoch: 19 cost time: 0.7719683647155762
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.417 Vali Acc: 0.662 Test Loss: 1.417 Test Acc: 0.662
Validation loss decreased (-0.662148 --> -0.662148).  Saving model ...
Epoch: 20 cost time: 0.652090311050415
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.422 Vali Acc: 0.649 Test Loss: 1.422 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7115797996520996
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.427 Vali Acc: 0.662 Test Loss: 1.427 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.862544059753418
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.443 Vali Acc: 0.649 Test Loss: 1.443 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9940395355224609
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.435 Vali Acc: 0.649 Test Loss: 1.435 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0740692615509033
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.467 Vali Acc: 0.649 Test Loss: 1.467 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6070966720581055
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.457 Vali Acc: 0.649 Test Loss: 1.457 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9254665374755859
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.451 Vali Acc: 0.649 Test Loss: 1.451 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8694331645965576
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.440 Vali Acc: 0.649 Test Loss: 1.440 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8410077095031738
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.662 Test Loss: 1.492 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5906860828399658
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.662 Test Loss: 1.460 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 22612228
model size : 100.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.431032180786133
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.444 Vali Acc: 0.203 Test Loss: 1.444 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.0208089351654053
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.450 Vali Acc: 0.351 Test Loss: 1.450 Test Acc: 0.351
Validation loss decreased (-0.202688 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 0.8862981796264648
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.297 Vali Acc: 0.365 Test Loss: 1.297 Test Acc: 0.365
Validation loss decreased (-0.351337 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.6810050010681152
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.289 Vali Acc: 0.378 Test Loss: 1.289 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.9173464775085449
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.7143194675445557
Epoch: 6, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.8326020240783691
Epoch: 7, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.512 Vali Acc: 0.473 Test Loss: 1.512 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.81770920753479
Epoch: 8, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.363 Vali Acc: 0.514 Test Loss: 1.363 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.735973596572876
Epoch: 9, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.344 Vali Acc: 0.527 Test Loss: 1.344 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8100986480712891
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.552 Vali Acc: 0.486 Test Loss: 1.552 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7214696407318115
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.437 Vali Acc: 0.554 Test Loss: 1.437 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8906633853912354
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.500 Vali Acc: 0.554 Test Loss: 1.500 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9282212257385254
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.985 Vali Acc: 0.514 Test Loss: 1.985 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8678696155548096
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 2.854 Vali Acc: 0.527 Test Loss: 2.854 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8193321228027344
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.458 Vali Acc: 0.473 Test Loss: 2.458 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8440260887145996
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.241 Vali Acc: 0.500 Test Loss: 3.241 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 22884100
model size : 101.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.320537805557251
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.341 Vali Acc: 0.419 Test Loss: 1.341 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.1089143753051758
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.343 Vali Acc: 0.270 Test Loss: 1.343 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.888566255569458
Epoch: 3, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.263 Vali Acc: 0.432 Test Loss: 1.263 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.7246770858764648
Epoch: 4, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.218 Vali Acc: 0.432 Test Loss: 1.218 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.6199467182159424
Epoch: 5, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.7323215007781982
Epoch: 6, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.7682147026062012
Epoch: 7, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.567 Vali Acc: 0.365 Test Loss: 1.567 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8352177143096924
Epoch: 8, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.279 Vali Acc: 0.473 Test Loss: 1.279 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.026365041732788
Epoch: 9, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.316 Vali Acc: 0.446 Test Loss: 1.316 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8959929943084717
Epoch: 10, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8159677982330322
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.406 Vali Acc: 0.473 Test Loss: 1.406 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8522937297821045
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.646 Vali Acc: 0.514 Test Loss: 1.646 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513497).  Saving model ...
Epoch: 13 cost time: 1.1831169128417969
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.606 Vali Acc: 0.527 Test Loss: 1.606 Test Acc: 0.527
Validation loss decreased (-0.513497 --> -0.527011).  Saving model ...
Epoch: 14 cost time: 0.7528154850006104
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.466 Vali Acc: 0.581 Test Loss: 1.466 Test Acc: 0.581
Validation loss decreased (-0.527011 --> -0.581066).  Saving model ...
Epoch: 15 cost time: 0.7358617782592773
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.482 Vali Acc: 0.554 Test Loss: 1.482 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9362843036651611
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.399 Vali Acc: 0.581 Test Loss: 1.399 Test Acc: 0.581
Validation loss decreased (-0.581066 --> -0.581067).  Saving model ...
Epoch: 17 cost time: 0.7924702167510986
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.495 Vali Acc: 0.568 Test Loss: 1.495 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.104379415512085
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.513 Vali Acc: 0.554 Test Loss: 1.513 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7726187705993652
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.595 Test Loss: 1.482 Test Acc: 0.595
Validation loss decreased (-0.581067 --> -0.594580).  Saving model ...
Epoch: 20 cost time: 0.7502889633178711
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.568 Test Loss: 1.460 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1051764488220215
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.554 Test Loss: 1.488 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7867450714111328
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.483 Vali Acc: 0.568 Test Loss: 1.483 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0358929634094238
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.581 Test Loss: 1.451 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.840897798538208
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.568 Test Loss: 1.459 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.087634801864624
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.568 Test Loss: 1.489 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7381374835968018
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.505 Vali Acc: 0.568 Test Loss: 1.505 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0899169445037842
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.581 Test Loss: 1.481 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9042761325836182
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.595 Test Loss: 1.493 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.744870662689209
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.581 Test Loss: 1.516 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 22727428
model size : 101.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9889912605285645
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.380 Vali Acc: 0.351 Test Loss: 1.380 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.5428116321563721
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6843464374542236
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.299 Vali Acc: 0.459 Test Loss: 1.299 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 0.8648934364318848
Epoch: 4, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.343 Vali Acc: 0.311 Test Loss: 1.343 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8781309127807617
Epoch: 5, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.246 Vali Acc: 0.473 Test Loss: 1.246 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.6819570064544678
Epoch: 6, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.215 Vali Acc: 0.419 Test Loss: 1.215 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6886756420135498
Epoch: 7, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.155 Vali Acc: 0.486 Test Loss: 1.155 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.524383544921875
Epoch: 8, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5249431133270264
Epoch: 9, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 0.6628711223602295
Epoch: 10, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.997175931930542
Epoch: 11, Steps: 10 | Train Loss: 0.231 Vali Loss: 1.421 Vali Acc: 0.459 Test Loss: 1.421 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7329928874969482
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.265 Vali Acc: 0.541 Test Loss: 1.265 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2133896350860596
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.178 Vali Acc: 0.568 Test Loss: 1.178 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 0.9830300807952881
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.164 Vali Acc: 0.568 Test Loss: 1.164 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 0.8077101707458496
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.369 Vali Acc: 0.541 Test Loss: 1.369 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7661781311035156
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.206 Vali Acc: 0.595 Test Loss: 1.206 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 17 cost time: 0.9029815196990967
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.300 Vali Acc: 0.595 Test Loss: 1.300 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.088697910308838
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.298 Vali Acc: 0.622 Test Loss: 1.298 Test Acc: 0.622
Validation loss decreased (-0.594583 --> -0.621609).  Saving model ...
Epoch: 19 cost time: 0.6956944465637207
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.212 Vali Acc: 0.662 Test Loss: 1.212 Test Acc: 0.662
Validation loss decreased (-0.621609 --> -0.662150).  Saving model ...
Epoch: 20 cost time: 0.9247431755065918
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.256 Vali Acc: 0.662 Test Loss: 1.256 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7474167346954346
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.259 Vali Acc: 0.676 Test Loss: 1.259 Test Acc: 0.676
Validation loss decreased (-0.662150 --> -0.675663).  Saving model ...
Epoch: 22 cost time: 0.7942392826080322
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.265 Vali Acc: 0.662 Test Loss: 1.265 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3316476345062256
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.259 Vali Acc: 0.676 Test Loss: 1.259 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8186583518981934
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.282 Vali Acc: 0.676 Test Loss: 1.282 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9418799877166748
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.285 Vali Acc: 0.662 Test Loss: 1.285 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8040366172790527
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.251 Vali Acc: 0.676 Test Loss: 1.251 Test Acc: 0.676
Validation loss decreased (-0.675663 --> -0.675663).  Saving model ...
Epoch: 27 cost time: 0.5561461448669434
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.259 Vali Acc: 0.689 Test Loss: 1.259 Test Acc: 0.689
Validation loss decreased (-0.675663 --> -0.689177).  Saving model ...
Epoch: 28 cost time: 0.7342028617858887
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.689 Test Loss: 1.278 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1823983192443848
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.676 Test Loss: 1.293 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6007542610168457
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.272 Vali Acc: 0.676 Test Loss: 1.272 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5093343257904053
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.265 Vali Acc: 0.676 Test Loss: 1.265 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7031722068786621
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.676 Test Loss: 1.268 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7886178493499756
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.676 Test Loss: 1.266 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6898276805877686
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.287 Vali Acc: 0.676 Test Loss: 1.287 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5827033519744873
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.676 Test Loss: 1.298 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6103169918060303
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.287 Vali Acc: 0.676 Test Loss: 1.287 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6480534076690674
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.275 Vali Acc: 0.676 Test Loss: 1.275 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 22630660
model size : 100.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.539456844329834
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.456 Vali Acc: 0.162 Test Loss: 1.456 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 1.4444355964660645
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.508 Vali Acc: 0.270 Test Loss: 1.508 Test Acc: 0.270
Validation loss decreased (-0.162148 --> -0.270255).  Saving model ...
Epoch: 3 cost time: 0.9966282844543457
Epoch: 3, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.451 Vali Acc: 0.338 Test Loss: 1.451 Test Acc: 0.338
Validation loss decreased (-0.270255 --> -0.337823).  Saving model ...
Epoch: 4 cost time: 0.7515630722045898
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.217 Vali Acc: 0.459 Test Loss: 1.217 Test Acc: 0.459
Validation loss decreased (-0.337823 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.8294491767883301
Epoch: 5, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.112 Vali Acc: 0.514 Test Loss: 1.112 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2868542671203613
Epoch: 6, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.298 Vali Acc: 0.486 Test Loss: 1.298 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8915634155273438
Epoch: 7, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.460 Vali Acc: 0.473 Test Loss: 1.460 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0852782726287842
Epoch: 8, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.279 Vali Acc: 0.541 Test Loss: 1.279 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 0.608126163482666
Epoch: 9, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.561 Vali Acc: 0.432 Test Loss: 1.561 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6324515342712402
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.796 Vali Acc: 0.486 Test Loss: 1.796 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5871927738189697
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.701 Vali Acc: 0.459 Test Loss: 1.701 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.988563060760498
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.822 Vali Acc: 0.541 Test Loss: 1.822 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.684985876083374
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.011 Vali Acc: 0.527 Test Loss: 2.011 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6422715187072754
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.899 Vali Acc: 0.541 Test Loss: 1.899 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3668558597564697
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.170 Vali Acc: 0.554 Test Loss: 2.170 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554032).  Saving model ...
Epoch: 16 cost time: 1.2887473106384277
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.153 Vali Acc: 0.527 Test Loss: 2.153 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.238297462463379
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.500 Test Loss: 2.050 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0208919048309326
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.527 Test Loss: 2.050 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3236455917358398
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.541 Test Loss: 2.012 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2213866710662842
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.999 Vali Acc: 0.541 Test Loss: 1.999 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4546008110046387
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.541 Test Loss: 2.023 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9617373943328857
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5376613140106201
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.080 Vali Acc: 0.514 Test Loss: 2.080 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0406842231750488
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.514 Test Loss: 2.047 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.469076156616211
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.008 Vali Acc: 0.541 Test Loss: 2.008 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 22907140
model size : 102.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2601001262664795
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.422 Vali Acc: 0.230 Test Loss: 1.422 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.5212979316711426
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.340 Vali Acc: 0.365 Test Loss: 1.340 Test Acc: 0.365
Validation loss decreased (-0.229716 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 0.9350290298461914
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.316 Vali Acc: 0.405 Test Loss: 1.316 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.8309412002563477
Epoch: 4, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.347 Vali Acc: 0.365 Test Loss: 1.347 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8111515045166016
Epoch: 5, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.8701357841491699
Epoch: 6, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.816443681716919
Epoch: 7, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0291996002197266
Epoch: 8, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.252 Vali Acc: 0.541 Test Loss: 1.252 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 0.8894443511962891
Epoch: 9, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.224 Vali Acc: 0.541 Test Loss: 1.224 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 0.7685420513153076
Epoch: 10, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.272 Vali Acc: 0.581 Test Loss: 1.272 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581068).  Saving model ...
Epoch: 11 cost time: 0.7496597766876221
Epoch: 11, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.265 Vali Acc: 0.554 Test Loss: 1.265 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8463306427001953
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.758 Vali Acc: 0.554 Test Loss: 1.758 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8217933177947998
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9499766826629639
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.490 Vali Acc: 0.527 Test Loss: 1.490 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8029513359069824
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.475 Vali Acc: 0.527 Test Loss: 1.475 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8567070960998535
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.621 Vali Acc: 0.568 Test Loss: 1.621 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7141745090484619
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.523 Vali Acc: 0.554 Test Loss: 1.523 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0806455612182617
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.506 Vali Acc: 0.514 Test Loss: 1.506 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9096560478210449
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7665281295776367
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.560 Vali Acc: 0.541 Test Loss: 1.560 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 22732036
model size : 101.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3417513370513916
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.333 Vali Acc: 0.392 Test Loss: 1.333 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 0.7693216800689697
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.324 Vali Acc: 0.378 Test Loss: 1.324 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7865288257598877
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.295 Vali Acc: 0.446 Test Loss: 1.295 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.49355340003967285
Epoch: 4, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.284 Vali Acc: 0.432 Test Loss: 1.284 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5256185531616211
Epoch: 5, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.7661035060882568
Epoch: 6, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0016577243804932
Epoch: 7, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.8341324329376221
Epoch: 8, Steps: 10 | Train Loss: 0.635 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.711796760559082
Epoch: 9, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7398419380187988
Epoch: 10, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.177 Vali Acc: 0.541 Test Loss: 1.177 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6886358261108398
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.207 Vali Acc: 0.541 Test Loss: 1.207 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6884715557098389
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.185 Vali Acc: 0.608 Test Loss: 1.185 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608096).  Saving model ...
Epoch: 13 cost time: 0.9831395149230957
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.211 Vali Acc: 0.554 Test Loss: 1.211 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7417833805084229
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.337 Vali Acc: 0.527 Test Loss: 1.337 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8305208683013916
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.179 Vali Acc: 0.608 Test Loss: 1.179 Test Acc: 0.608
Validation loss decreased (-0.608096 --> -0.608096).  Saving model ...
Epoch: 16 cost time: 0.8567085266113281
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.320 Vali Acc: 0.554 Test Loss: 1.320 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.547663688659668
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.208 Vali Acc: 0.595 Test Loss: 1.208 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.43627285957336426
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.186 Vali Acc: 0.622 Test Loss: 1.186 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621610).  Saving model ...
Epoch: 19 cost time: 0.518927812576294
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.226 Vali Acc: 0.608 Test Loss: 1.226 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6294894218444824
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.265 Vali Acc: 0.581 Test Loss: 1.265 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6456480026245117
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.235 Vali Acc: 0.595 Test Loss: 1.235 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1206955909729004
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.245 Vali Acc: 0.595 Test Loss: 1.245 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7081289291381836
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.247 Vali Acc: 0.595 Test Loss: 1.247 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7240996360778809
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.227 Vali Acc: 0.581 Test Loss: 1.227 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7856054306030273
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.261 Vali Acc: 0.595 Test Loss: 1.261 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7044472694396973
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.300 Vali Acc: 0.595 Test Loss: 1.300 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6908688545227051
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.299 Vali Acc: 0.595 Test Loss: 1.299 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8946878910064697
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.255 Vali Acc: 0.608 Test Loss: 1.255 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 22649092
model size : 101.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.799312114715576
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.447 Vali Acc: 0.230 Test Loss: 1.447 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.9111549854278564
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.249 Vali Acc: 0.432 Test Loss: 1.249 Test Acc: 0.432
Validation loss decreased (-0.229715 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.0846316814422607
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.295 Vali Acc: 0.338 Test Loss: 1.295 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.129863977432251
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.461 Vali Acc: 0.324 Test Loss: 1.461 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9206681251525879
Epoch: 5, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9727928638458252
Epoch: 6, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.190 Vali Acc: 0.541 Test Loss: 1.190 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8959810733795166
Epoch: 7, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.320 Vali Acc: 0.514 Test Loss: 1.320 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.945988655090332
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.529 Vali Acc: 0.527 Test Loss: 1.529 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8734102249145508
Epoch: 9, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.592 Vali Acc: 0.554 Test Loss: 1.592 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554038).  Saving model ...
Epoch: 10 cost time: 0.8907451629638672
Epoch: 10, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.927 Vali Acc: 0.514 Test Loss: 1.927 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8495585918426514
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 2.050 Vali Acc: 0.473 Test Loss: 2.050 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.097353458404541
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.958 Vali Acc: 0.554 Test Loss: 1.958 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0943708419799805
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.782 Vali Acc: 0.554 Test Loss: 1.782 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1448843479156494
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.877 Vali Acc: 0.527 Test Loss: 1.877 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4066424369812012
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.070 Vali Acc: 0.541 Test Loss: 2.070 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.368138313293457
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 2.028 Vali Acc: 0.608 Test Loss: 2.028 Test Acc: 0.608
Validation loss decreased (-0.554038 --> -0.608088).  Saving model ...
Epoch: 17 cost time: 1.6550393104553223
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.214 Vali Acc: 0.568 Test Loss: 2.214 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2736399173736572
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.933 Vali Acc: 0.568 Test Loss: 1.933 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2849271297454834
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.608 Test Loss: 1.796 Test Acc: 0.608
Validation loss decreased (-0.608088 --> -0.608090).  Saving model ...
Epoch: 20 cost time: 1.0605387687683105
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.595 Test Loss: 1.826 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2269771099090576
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.568 Test Loss: 1.866 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.072580099105835
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.554 Test Loss: 1.889 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3042471408843994
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.893 Vali Acc: 0.568 Test Loss: 1.893 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2078170776367188
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.581 Test Loss: 1.854 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.432447910308838
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.842 Vali Acc: 0.581 Test Loss: 1.842 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0325536727905273
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.581 Test Loss: 1.813 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3150489330291748
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.581 Test Loss: 1.799 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1061511039733887
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.581 Test Loss: 1.789 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1702220439910889
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.581 Test Loss: 1.804 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 22930180
model size : 102.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7645273208618164
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.405 Vali Acc: 0.257 Test Loss: 1.405 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.72259521484375
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.366 Vali Acc: 0.338 Test Loss: 1.366 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.4225726127624512
Epoch: 3, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.295 Vali Acc: 0.392 Test Loss: 1.295 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.9806616306304932
Epoch: 4, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.296 Vali Acc: 0.432 Test Loss: 1.296 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.2754669189453125
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.432419 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.8317523002624512
Epoch: 6, Steps: 10 | Train Loss: 0.879 Vali Loss: 1.313 Vali Acc: 0.392 Test Loss: 1.313 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.139453649520874
Epoch: 7, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.8711817264556885
Epoch: 8, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 1.1644792556762695
Epoch: 9, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.311 Vali Acc: 0.446 Test Loss: 1.311 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8341989517211914
Epoch: 10, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.381 Vali Acc: 0.500 Test Loss: 1.381 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.040428638458252
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.394 Vali Acc: 0.568 Test Loss: 1.394 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567554).  Saving model ...
Epoch: 12 cost time: 0.8796341419219971
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.466 Vali Acc: 0.554 Test Loss: 1.466 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0072102546691895
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.582 Vali Acc: 0.486 Test Loss: 1.582 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8142869472503662
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.263 Vali Acc: 0.608 Test Loss: 1.263 Test Acc: 0.608
Validation loss decreased (-0.567554 --> -0.608095).  Saving model ...
Epoch: 15 cost time: 1.2871429920196533
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.465 Vali Acc: 0.568 Test Loss: 1.465 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.892120361328125
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.359 Vali Acc: 0.622 Test Loss: 1.359 Test Acc: 0.622
Validation loss decreased (-0.608095 --> -0.621608).  Saving model ...
Epoch: 17 cost time: 1.0076110363006592
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.328 Vali Acc: 0.608 Test Loss: 1.328 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5343210697174072
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.449 Vali Acc: 0.622 Test Loss: 1.449 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7361831665039062
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.622 Test Loss: 1.480 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8298823833465576
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.608 Test Loss: 1.429 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8730981349945068
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.635 Test Loss: 1.388 Test Acc: 0.635
Validation loss decreased (-0.621608 --> -0.635121).  Saving model ...
Epoch: 22 cost time: 0.805377721786499
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.608 Test Loss: 1.406 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.79390549659729
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.389 Vali Acc: 0.649 Test Loss: 1.389 Test Acc: 0.649
Validation loss decreased (-0.635121 --> -0.648635).  Saving model ...
Epoch: 24 cost time: 0.65006422996521
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.662 Test Loss: 1.406 Test Acc: 0.662
Validation loss decreased (-0.648635 --> -0.662148).  Saving model ...
Epoch: 25 cost time: 0.7922828197479248
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.608 Test Loss: 1.451 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0660362243652344
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.595 Test Loss: 1.463 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8232905864715576
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.608 Test Loss: 1.440 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8619041442871094
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.595 Test Loss: 1.433 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7966980934143066
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.608 Test Loss: 1.449 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7891952991485596
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.635 Test Loss: 1.461 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.943774938583374
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.608 Test Loss: 1.459 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8111941814422607
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.622 Test Loss: 1.456 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8834214210510254
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.635 Test Loss: 1.464 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1368510723114014
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.635 Test Loss: 1.486 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 22755076
model size : 101.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.328160047531128
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.415 Vali Acc: 0.216 Test Loss: 1.415 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.6921021938323975
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.360 Vali Acc: 0.338 Test Loss: 1.360 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.5663433074951172
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.317 Vali Acc: 0.432 Test Loss: 1.317 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 0.6585342884063721
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.297 Vali Acc: 0.432 Test Loss: 1.297 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 0.6449413299560547
Epoch: 5, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.5977282524108887
Epoch: 6, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.205 Vali Acc: 0.527 Test Loss: 1.205 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.7108340263366699
Epoch: 7, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.6485462188720703
Epoch: 8, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.171 Vali Acc: 0.486 Test Loss: 1.171 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4629361629486084
Epoch: 9, Steps: 10 | Train Loss: 0.483 Vali Loss: 1.199 Vali Acc: 0.459 Test Loss: 1.199 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7012720108032227
Epoch: 10, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.456 Vali Acc: 0.486 Test Loss: 1.456 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8148207664489746
Epoch: 11, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0580167770385742
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.561 Vali Acc: 0.446 Test Loss: 1.561 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6405811309814453
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.514 Vali Acc: 0.500 Test Loss: 1.514 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.684485673904419
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.402 Vali Acc: 0.554 Test Loss: 1.402 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554040).  Saving model ...
Epoch: 15 cost time: 0.6670389175415039
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.624 Vali Acc: 0.486 Test Loss: 1.624 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6629302501678467
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.437 Vali Acc: 0.541 Test Loss: 1.437 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7369449138641357
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.584 Vali Acc: 0.514 Test Loss: 1.584 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6968297958374023
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.493 Vali Acc: 0.554 Test Loss: 1.493 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6944012641906738
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.517 Vali Acc: 0.554 Test Loss: 1.517 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6842076778411865
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.572 Vali Acc: 0.541 Test Loss: 1.572 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7069976329803467
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.495 Vali Acc: 0.581 Test Loss: 1.495 Test Acc: 0.581
Validation loss decreased (-0.554040 --> -0.581066).  Saving model ...
Epoch: 22 cost time: 0.950160026550293
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8760986328125
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.536 Vali Acc: 0.527 Test Loss: 1.536 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6896984577178955
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.528 Vali Acc: 0.554 Test Loss: 1.528 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1440541744232178
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.547 Vali Acc: 0.541 Test Loss: 1.547 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6927947998046875
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.587 Vali Acc: 0.527 Test Loss: 1.587 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8025870323181152
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8432602882385254
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.558 Vali Acc: 0.568 Test Loss: 1.558 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8361029624938965
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.568 Test Loss: 1.563 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0601754188537598
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.527 Test Loss: 1.587 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8811633586883545
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.541 Test Loss: 1.613 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 22667524
model size : 101.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps22_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3045294284820557
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.309 Vali Acc: 0.392 Test Loss: 1.309 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 1.199662208557129
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.342 Vali Acc: 0.230 Test Loss: 1.342 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.993811845779419
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.311 Vali Acc: 0.351 Test Loss: 1.311 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.476029396057129
Epoch: 4, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.1707308292388916
Epoch: 5, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.092 Vali Acc: 0.554 Test Loss: 1.092 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.0963413715362549
Epoch: 6, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.054 Vali Acc: 0.486 Test Loss: 1.054 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3359594345092773
Epoch: 7, Steps: 10 | Train Loss: 0.415 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0284295082092285
Epoch: 8, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.017914056777954
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.341 Vali Acc: 0.568 Test Loss: 1.341 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567554).  Saving model ...
Epoch: 10 cost time: 1.3313231468200684
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.704 Vali Acc: 0.500 Test Loss: 1.704 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2343499660491943
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 2.037 Vali Acc: 0.514 Test Loss: 2.037 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9487385749816895
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.553 Vali Acc: 0.554 Test Loss: 1.553 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.186357021331787
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.652 Vali Acc: 0.595 Test Loss: 1.652 Test Acc: 0.595
Validation loss decreased (-0.567554 --> -0.594578).  Saving model ...
Epoch: 14 cost time: 1.1411783695220947
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.699 Vali Acc: 0.554 Test Loss: 1.699 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.364346981048584
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.441 Vali Acc: 0.595 Test Loss: 1.441 Test Acc: 0.595
Validation loss decreased (-0.594578 --> -0.594580).  Saving model ...
Epoch: 16 cost time: 0.6002719402313232
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.087 Vali Acc: 0.581 Test Loss: 2.087 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6865999698638916
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.622 Test Loss: 1.630 Test Acc: 0.622
Validation loss decreased (-0.594580 --> -0.621605).  Saving model ...
Epoch: 18 cost time: 0.7375831604003906
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.502 Vali Acc: 0.568 Test Loss: 2.502 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.738656759262085
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 2.299 Vali Acc: 0.568 Test Loss: 2.299 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7084376811981201
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.283 Vali Acc: 0.554 Test Loss: 2.283 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6640350818634033
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.493 Vali Acc: 0.581 Test Loss: 2.493 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.824446439743042
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.253 Vali Acc: 0.568 Test Loss: 2.253 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6814639568328857
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.351 Vali Acc: 0.486 Test Loss: 2.351 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6321053504943848
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.198 Vali Acc: 0.554 Test Loss: 2.198 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6118366718292236
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.554 Test Loss: 2.166 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7106854915618896
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.188 Vali Acc: 0.581 Test Loss: 2.188 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1151695251464844
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.581 Test Loss: 2.196 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps22_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 22916356
model size : 102.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7814650535583496
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.7078206539154053
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.328 Vali Acc: 0.378 Test Loss: 1.328 Test Acc: 0.378
Validation loss decreased (-0.243229 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.012739896774292
Epoch: 3, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.326 Vali Acc: 0.486 Test Loss: 1.326 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486473).  Saving model ...
Epoch: 4 cost time: 0.6479766368865967
Epoch: 4, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.214 Vali Acc: 0.595 Test Loss: 1.214 Test Acc: 0.595
Validation loss decreased (-0.486473 --> -0.594582).  Saving model ...
Epoch: 5 cost time: 0.6770167350769043
Epoch: 5, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.151 Vali Acc: 0.459 Test Loss: 1.151 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6991755962371826
Epoch: 6, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.155 Vali Acc: 0.446 Test Loss: 1.155 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7331883907318115
Epoch: 7, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6469430923461914
Epoch: 8, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6513206958770752
Epoch: 9, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.369 Vali Acc: 0.486 Test Loss: 1.369 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5580289363861084
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.404 Vali Acc: 0.500 Test Loss: 1.404 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6150808334350586
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.339 Vali Acc: 0.541 Test Loss: 1.339 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6398899555206299
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.540 Vali Acc: 0.486 Test Loss: 1.540 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9275622367858887
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.676 Vali Acc: 0.473 Test Loss: 1.676 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6615655422210693
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.385 Vali Acc: 0.527 Test Loss: 1.385 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 22782724
model size : 101.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps22_str22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.7488515377044678
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.7383880615234375
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.613959789276123
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.385 Vali Acc: 0.243 Test Loss: 1.385 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 0.6061501502990723
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.314 Vali Acc: 0.486 Test Loss: 1.314 Test Acc: 0.486
Validation loss decreased (-0.243229 --> -0.486473).  Saving model ...
Epoch: 5 cost time: 0.6186859607696533
Epoch: 5, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.346 Vali Acc: 0.311 Test Loss: 1.346 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5801246166229248
Epoch: 6, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
Validation loss decreased (-0.486473 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 0.8180184364318848
Epoch: 7, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.301 Vali Acc: 0.432 Test Loss: 1.301 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6844801902770996
Epoch: 8, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1740317344665527
Epoch: 9, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.272 Vali Acc: 0.514 Test Loss: 1.272 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7850477695465088
Epoch: 10, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.294 Vali Acc: 0.432 Test Loss: 1.294 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6075496673583984
Epoch: 11, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9209468364715576
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7288711071014404
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6054880619049072
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.248 Vali Acc: 0.568 Test Loss: 1.248 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567555).  Saving model ...
Epoch: 15 cost time: 0.7326173782348633
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.283 Vali Acc: 0.514 Test Loss: 1.283 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.760138750076294
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.284 Vali Acc: 0.568 Test Loss: 1.284 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.041764736175537
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.270 Vali Acc: 0.608 Test Loss: 1.270 Test Acc: 0.608
Validation loss decreased (-0.567555 --> -0.608095).  Saving model ...
Epoch: 18 cost time: 0.7629642486572266
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.331 Vali Acc: 0.581 Test Loss: 1.331 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2109878063201904
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.306 Vali Acc: 0.608 Test Loss: 1.306 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8092789649963379
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.290 Vali Acc: 0.595 Test Loss: 1.290 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9629471302032471
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.327 Vali Acc: 0.595 Test Loss: 1.327 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7311539649963379
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.329 Vali Acc: 0.608 Test Loss: 1.329 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5485231876373291
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.310 Vali Acc: 0.581 Test Loss: 1.310 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9375371932983398
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.335 Vali Acc: 0.622 Test Loss: 1.335 Test Acc: 0.622
Validation loss decreased (-0.608095 --> -0.621608).  Saving model ...
Epoch: 25 cost time: 1.0199377536773682
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.581 Test Loss: 1.350 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.543745756149292
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.352 Vali Acc: 0.595 Test Loss: 1.352 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7382216453552246
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.366 Vali Acc: 0.595 Test Loss: 1.366 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0154995918273926
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.595 Test Loss: 1.373 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6211445331573486
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.362 Vali Acc: 0.568 Test Loss: 1.362 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9038128852844238
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.371 Vali Acc: 0.568 Test Loss: 1.371 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7638261318206787
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.595 Test Loss: 1.377 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7134983539581299
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.378 Vali Acc: 0.568 Test Loss: 1.378 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9805152416229248
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.568 Test Loss: 1.386 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6491730213165283
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.581 Test Loss: 1.400 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps22_str22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 22704388
model size : 101.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2220265865325928
Epoch: 1, Steps: 10 | Train Loss: 1.594 Vali Loss: 1.428 Vali Acc: 0.284 Test Loss: 1.428 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9798834323883057
Epoch: 2, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.430 Vali Acc: 0.257 Test Loss: 1.430 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9728155136108398
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.375 Vali Acc: 0.351 Test Loss: 1.375 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.3769347667694092
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.244 Vali Acc: 0.392 Test Loss: 1.244 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.5736167430877686
Epoch: 5, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.216 Vali Acc: 0.514 Test Loss: 1.216 Test Acc: 0.514
Validation loss decreased (-0.391879 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.272801399230957
Epoch: 6, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.284 Vali Acc: 0.473 Test Loss: 1.284 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0737583637237549
Epoch: 7, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.652 Vali Acc: 0.459 Test Loss: 1.652 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0687813758850098
Epoch: 8, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.434 Vali Acc: 0.473 Test Loss: 1.434 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6717040538787842
Epoch: 9, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.734 Vali Acc: 0.514 Test Loss: 1.734 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4645178318023682
Epoch: 10, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.673 Vali Acc: 0.541 Test Loss: 1.673 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540524).  Saving model ...
Epoch: 11 cost time: 1.349013090133667
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.886 Vali Acc: 0.554 Test Loss: 1.886 Test Acc: 0.554
Validation loss decreased (-0.540524 --> -0.554035).  Saving model ...
Epoch: 12 cost time: 1.3529901504516602
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.575 Vali Acc: 0.568 Test Loss: 1.575 Test Acc: 0.568
Validation loss decreased (-0.554035 --> -0.567552).  Saving model ...
Epoch: 13 cost time: 1.059403896331787
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.807 Vali Acc: 0.527 Test Loss: 1.807 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.43416166305542
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.693 Vali Acc: 0.595 Test Loss: 1.693 Test Acc: 0.595
Validation loss decreased (-0.567552 --> -0.594578).  Saving model ...
Epoch: 15 cost time: 1.34983491897583
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.806 Vali Acc: 0.595 Test Loss: 1.806 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1429777145385742
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.712 Vali Acc: 0.554 Test Loss: 1.712 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0811676979064941
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.796 Vali Acc: 0.554 Test Loss: 1.796 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.996375560760498
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.933 Vali Acc: 0.608 Test Loss: 1.933 Test Acc: 0.608
Validation loss decreased (-0.594578 --> -0.608089).  Saving model ...
Epoch: 19 cost time: 0.6840136051177979
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 2.008 Vali Acc: 0.554 Test Loss: 2.008 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0634009838104248
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.527 Test Loss: 1.770 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8873946666717529
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.541 Test Loss: 1.853 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8641061782836914
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.527 Test Loss: 1.966 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.004023790359497
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.017 Vali Acc: 0.527 Test Loss: 2.017 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8989760875701904
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.541 Test Loss: 2.016 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9049179553985596
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.568 Test Loss: 1.958 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8502233028411865
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.568 Test Loss: 1.916 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.943204402923584
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.581 Test Loss: 1.916 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0953617095947266
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.554 Test Loss: 1.906 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 22934788
model size : 102.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4435811042785645
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.367 Vali Acc: 0.338 Test Loss: 1.367 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.49376678466796875
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.340 Vali Acc: 0.311 Test Loss: 1.340 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9632959365844727
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.337824 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.6776340007781982
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.236 Vali Acc: 0.446 Test Loss: 1.236 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5000011920928955
Epoch: 5, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.138 Vali Acc: 0.581 Test Loss: 1.138 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.8696334362030029
Epoch: 6, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.076 Vali Acc: 0.514 Test Loss: 1.076 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6955156326293945
Epoch: 7, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.323 Vali Acc: 0.432 Test Loss: 1.323 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7199697494506836
Epoch: 8, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.698493242263794
Epoch: 9, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.454 Vali Acc: 0.514 Test Loss: 1.454 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6175577640533447
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.527 Vali Acc: 0.541 Test Loss: 1.527 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6182434558868408
Epoch: 11, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7934277057647705
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.403 Vali Acc: 0.486 Test Loss: 1.403 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.059797763824463
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.441 Vali Acc: 0.500 Test Loss: 1.441 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6361465454101562
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.492 Vali Acc: 0.500 Test Loss: 1.492 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6400361061096191
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.377 Vali Acc: 0.541 Test Loss: 1.377 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 22791940
model size : 101.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.5262279510498047
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.385 Vali Acc: 0.365 Test Loss: 1.385 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 0.7702553272247314
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.374 Vali Acc: 0.284 Test Loss: 1.374 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.988863468170166
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.339 Vali Acc: 0.392 Test Loss: 1.339 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.6435790061950684
Epoch: 4, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.307 Vali Acc: 0.392 Test Loss: 1.307 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 0.6725955009460449
Epoch: 5, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.278 Vali Acc: 0.405 Test Loss: 1.278 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.6711466312408447
Epoch: 6, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.218 Vali Acc: 0.405 Test Loss: 1.218 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 0.944617509841919
Epoch: 7, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.6548357009887695
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 0.9846343994140625
Epoch: 9, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.167 Vali Acc: 0.473 Test Loss: 1.167 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5346004962921143
Epoch: 10, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1218986511230469
Epoch: 11, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7055206298828125
Epoch: 12, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.056 Vali Acc: 0.527 Test Loss: 1.056 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1999232769012451
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.320 Vali Acc: 0.554 Test Loss: 1.320 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554041).  Saving model ...
Epoch: 14 cost time: 0.6416726112365723
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.109 Vali Acc: 0.581 Test Loss: 1.109 Test Acc: 0.581
Validation loss decreased (-0.554041 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 0.7481143474578857
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.377 Vali Acc: 0.568 Test Loss: 1.377 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7546110153198242
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.342 Vali Acc: 0.581 Test Loss: 1.342 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5238039493560791
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.345 Vali Acc: 0.608 Test Loss: 1.345 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608095).  Saving model ...
Epoch: 18 cost time: 0.5641753673553467
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.314 Vali Acc: 0.608 Test Loss: 1.314 Test Acc: 0.608
Validation loss decreased (-0.608095 --> -0.608095).  Saving model ...
Epoch: 19 cost time: 0.6201298236846924
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.276 Vali Acc: 0.608 Test Loss: 1.276 Test Acc: 0.608
Validation loss decreased (-0.608095 --> -0.608095).  Saving model ...
Epoch: 20 cost time: 1.0653281211853027
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.318 Vali Acc: 0.595 Test Loss: 1.318 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9536402225494385
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.361 Vali Acc: 0.608 Test Loss: 1.361 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9922363758087158
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.344 Vali Acc: 0.595 Test Loss: 1.344 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.741497278213501
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.318 Vali Acc: 0.608 Test Loss: 1.318 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.833242654800415
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.315 Vali Acc: 0.595 Test Loss: 1.315 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8028512001037598
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.322 Vali Acc: 0.595 Test Loss: 1.322 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7999875545501709
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.333 Vali Acc: 0.595 Test Loss: 1.333 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.942943811416626
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.368 Vali Acc: 0.608 Test Loss: 1.368 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6281847953796387
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.361 Vali Acc: 0.581 Test Loss: 1.361 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.684213399887085
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.372 Vali Acc: 0.581 Test Loss: 1.372 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 22722820
model size : 101.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.282050371170044
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.374 Vali Acc: 0.378 Test Loss: 1.374 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.2650892734527588
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 1.0875740051269531
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.260 Vali Acc: 0.378 Test Loss: 1.260 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2406268119812012
Epoch: 4, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.186 Vali Acc: 0.446 Test Loss: 1.186 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.255908489227295
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.4677557945251465
Epoch: 6, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.387 Vali Acc: 0.446 Test Loss: 1.387 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.930673360824585
Epoch: 7, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.508 Vali Acc: 0.459 Test Loss: 1.508 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2696607112884521
Epoch: 8, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.607 Vali Acc: 0.419 Test Loss: 1.607 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.119001865386963
Epoch: 9, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.877 Vali Acc: 0.514 Test Loss: 1.877 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4966764450073242
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.792 Vali Acc: 0.486 Test Loss: 1.792 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0075337886810303
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.532 Vali Acc: 0.527 Test Loss: 1.532 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527012).  Saving model ...
Epoch: 12 cost time: 1.2437281608581543
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 2.031 Vali Acc: 0.568 Test Loss: 2.031 Test Acc: 0.568
Validation loss decreased (-0.527012 --> -0.567547).  Saving model ...
Epoch: 13 cost time: 1.3827743530273438
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.732 Vali Acc: 0.514 Test Loss: 1.732 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.030876636505127
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.663 Vali Acc: 0.554 Test Loss: 1.663 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.160494327545166
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.867 Vali Acc: 0.514 Test Loss: 1.867 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.243527889251709
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.698 Vali Acc: 0.527 Test Loss: 1.698 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9562840461730957
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.644 Vali Acc: 0.541 Test Loss: 1.644 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0378057956695557
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.650 Vali Acc: 0.500 Test Loss: 1.650 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9801573753356934
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.527 Test Loss: 1.593 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8978068828582764
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.554 Test Loss: 1.583 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.907681941986084
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.541 Test Loss: 1.626 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.902822732925415
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.554 Test Loss: 1.652 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 22957828
model size : 102.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9866914749145508
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.6285219192504883
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.357 Vali Acc: 0.351 Test Loss: 1.357 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.6554675102233887
Epoch: 3, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.278 Vali Acc: 0.459 Test Loss: 1.278 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.6428201198577881
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.262 Vali Acc: 0.419 Test Loss: 1.262 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.47160840034484863
Epoch: 5, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8825709819793701
Epoch: 6, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.210 Vali Acc: 0.514 Test Loss: 1.210 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 0.6440837383270264
Epoch: 7, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.344 Vali Acc: 0.473 Test Loss: 1.344 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6799266338348389
Epoch: 8, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.267 Vali Acc: 0.527 Test Loss: 1.267 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 9 cost time: 0.6150026321411133
Epoch: 9, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.447 Vali Acc: 0.527 Test Loss: 1.447 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6009843349456787
Epoch: 10, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.586 Vali Acc: 0.419 Test Loss: 1.586 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7527592182159424
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.404 Vali Acc: 0.527 Test Loss: 1.404 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6269094944000244
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.534 Vali Acc: 0.541 Test Loss: 1.534 Test Acc: 0.541
Validation loss decreased (-0.527014 --> -0.540525).  Saving model ...
Epoch: 13 cost time: 0.6653740406036377
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5166630744934082
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.471 Vali Acc: 0.635 Test Loss: 1.471 Test Acc: 0.635
Validation loss decreased (-0.540525 --> -0.635120).  Saving model ...
Epoch: 15 cost time: 1.0014374256134033
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.455 Vali Acc: 0.581 Test Loss: 1.455 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.672332763671875
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.573 Vali Acc: 0.581 Test Loss: 1.573 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0871078968048096
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.491 Vali Acc: 0.635 Test Loss: 1.491 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9561316967010498
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.595 Test Loss: 1.413 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6617424488067627
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.439 Vali Acc: 0.608 Test Loss: 1.439 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9022622108459473
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.499 Vali Acc: 0.635 Test Loss: 1.499 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6657483577728271
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.635 Test Loss: 1.508 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6717543601989746
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.495 Vali Acc: 0.635 Test Loss: 1.495 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.686246395111084
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.649 Test Loss: 1.493 Test Acc: 0.649
Validation loss decreased (-0.635120 --> -0.648634).  Saving model ...
Epoch: 24 cost time: 0.7501282691955566
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.649 Test Loss: 1.520 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0984601974487305
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.635 Test Loss: 1.545 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8593299388885498
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.538 Vali Acc: 0.635 Test Loss: 1.538 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7809653282165527
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.539 Vali Acc: 0.595 Test Loss: 1.539 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7594442367553711
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.595 Test Loss: 1.537 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7375099658966064
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.562 Vali Acc: 0.622 Test Loss: 1.562 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7251026630401611
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.608 Test Loss: 1.566 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6342742443084717
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.581 Test Loss: 1.544 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.694939374923706
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.540 Vali Acc: 0.581 Test Loss: 1.540 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6743917465209961
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.595 Test Loss: 1.549 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 22814980
model size : 101.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8902883529663086
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.413 Vali Acc: 0.257 Test Loss: 1.413 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.9766907691955566
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.385 Vali Acc: 0.243 Test Loss: 1.385 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7044920921325684
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.373 Vali Acc: 0.257 Test Loss: 1.373 Test Acc: 0.257
Validation loss decreased (-0.256743 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 0.5920343399047852
Epoch: 4, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.304 Vali Acc: 0.405 Test Loss: 1.304 Test Acc: 0.405
Validation loss decreased (-0.256743 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.593886137008667
Epoch: 5, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.268 Vali Acc: 0.486 Test Loss: 1.268 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.5084795951843262
Epoch: 6, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.260 Vali Acc: 0.459 Test Loss: 1.260 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.48862791061401367
Epoch: 7, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.246 Vali Acc: 0.432 Test Loss: 1.246 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4507722854614258
Epoch: 8, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.6745009422302246
Epoch: 9, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.7967658042907715
Epoch: 10, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.231 Vali Acc: 0.446 Test Loss: 1.231 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6213538646697998
Epoch: 11, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5295262336730957
Epoch: 12, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.216 Vali Acc: 0.541 Test Loss: 1.216 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 13 cost time: 0.5615541934967041
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7337779998779297
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.337 Vali Acc: 0.527 Test Loss: 1.337 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6046156883239746
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 16 cost time: 0.8642055988311768
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.277 Vali Acc: 0.595 Test Loss: 1.277 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 0.8286597728729248
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.267 Vali Acc: 0.581 Test Loss: 1.267 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6086719036102295
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.237 Vali Acc: 0.541 Test Loss: 1.237 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5838050842285156
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.303 Vali Acc: 0.581 Test Loss: 1.303 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6373190879821777
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.371 Vali Acc: 0.568 Test Loss: 1.371 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6635499000549316
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.327 Vali Acc: 0.568 Test Loss: 1.327 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8767857551574707
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.328 Vali Acc: 0.568 Test Loss: 1.328 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9440979957580566
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.355 Vali Acc: 0.568 Test Loss: 1.355 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.877701997756958
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.355 Vali Acc: 0.554 Test Loss: 1.355 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8198013305664062
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.344 Vali Acc: 0.581 Test Loss: 1.344 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7940759658813477
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.353 Vali Acc: 0.581 Test Loss: 1.353 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 22741252
model size : 101.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6530344486236572
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.427 Vali Acc: 0.189 Test Loss: 1.427 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.7441451549530029
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.471 Vali Acc: 0.230 Test Loss: 1.471 Test Acc: 0.230
Validation loss decreased (-0.189175 --> -0.229715).  Saving model ...
Epoch: 3 cost time: 0.8592243194580078
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.230 Vali Acc: 0.405 Test Loss: 1.230 Test Acc: 0.405
Validation loss decreased (-0.229715 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.6583919525146484
Epoch: 4, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.300 Vali Acc: 0.392 Test Loss: 1.300 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6683688163757324
Epoch: 5, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.7171754837036133
Epoch: 6, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.530 Vali Acc: 0.338 Test Loss: 1.530 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1295666694641113
Epoch: 7, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.209 Vali Acc: 0.486 Test Loss: 1.209 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6778247356414795
Epoch: 8, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.451 Vali Acc: 0.541 Test Loss: 1.451 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540526).  Saving model ...
Epoch: 9 cost time: 0.8416221141815186
Epoch: 9, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.459 Vali Acc: 0.541 Test Loss: 1.459 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.091285228729248
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.405 Vali Acc: 0.554 Test Loss: 1.405 Test Acc: 0.554
Validation loss decreased (-0.540526 --> -0.554040).  Saving model ...
Epoch: 11 cost time: 0.7622931003570557
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.737 Vali Acc: 0.568 Test Loss: 1.737 Test Acc: 0.568
Validation loss decreased (-0.554040 --> -0.567550).  Saving model ...
Epoch: 12 cost time: 0.8389127254486084
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.575 Vali Acc: 0.595 Test Loss: 1.575 Test Acc: 0.595
Validation loss decreased (-0.567550 --> -0.594579).  Saving model ...
Epoch: 13 cost time: 0.6968050003051758
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.282 Vali Acc: 0.622 Test Loss: 1.282 Test Acc: 0.622
Validation loss decreased (-0.594579 --> -0.621609).  Saving model ...
Epoch: 14 cost time: 0.7226457595825195
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.997 Vali Acc: 0.581 Test Loss: 1.997 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7338657379150391
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.360 Vali Acc: 0.622 Test Loss: 1.360 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1831514835357666
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.530 Vali Acc: 0.581 Test Loss: 1.530 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8906421661376953
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.622 Test Loss: 1.768 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2014076709747314
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.622 Test Loss: 1.609 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7377932071685791
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.622 Test Loss: 1.553 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0241332054138184
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.570 Vali Acc: 0.622 Test Loss: 1.570 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0570855140686035
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.622 Test Loss: 1.631 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.171675682067871
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.649 Test Loss: 1.651 Test Acc: 0.649
Validation loss decreased (-0.621609 --> -0.648632).  Saving model ...
Epoch: 23 cost time: 0.8422291278839111
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.622 Test Loss: 1.643 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6129350662231445
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.622 Test Loss: 1.610 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5118107795715332
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.622 Test Loss: 1.607 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5334961414337158
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.649 Test Loss: 1.631 Test Acc: 0.649
Validation loss decreased (-0.648632 --> -0.648632).  Saving model ...
Epoch: 27 cost time: 0.7371950149536133
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.649 Test Loss: 1.620 Test Acc: 0.649
Validation loss decreased (-0.648632 --> -0.648632).  Saving model ...
Epoch: 28 cost time: 0.7907319068908691
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.622 Test Loss: 1.604 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7260184288024902
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.608 Test Loss: 1.586 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6206207275390625
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.622 Test Loss: 1.618 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.751807451248169
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.622 Test Loss: 1.619 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7408640384674072
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.635 Test Loss: 1.628 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8962428569793701
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.622 Test Loss: 1.619 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0812220573425293
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.622 Test Loss: 1.608 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8034298419952393
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.622 Test Loss: 1.604 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7437436580657959
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.608 Test Loss: 1.595 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1776790618896484
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.608 Test Loss: 1.608 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 22939396
model size : 102.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9202251434326172
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.345 Vali Acc: 0.311 Test Loss: 1.345 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.6767375469207764
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.366 Vali Acc: 0.284 Test Loss: 1.366 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0586354732513428
Epoch: 3, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.262 Vali Acc: 0.527 Test Loss: 1.262 Test Acc: 0.527
Validation loss decreased (-0.310797 --> -0.527014).  Saving model ...
Epoch: 4 cost time: 0.691277027130127
Epoch: 4, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.270 Vali Acc: 0.405 Test Loss: 1.270 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.624295711517334
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5439746379852295
Epoch: 6, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
Validation loss decreased (-0.527014 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.5571422576904297
Epoch: 7, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.023 Vali Acc: 0.554 Test Loss: 1.023 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 0.6161370277404785
Epoch: 8, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.969 Vali Acc: 0.554 Test Loss: 0.969 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 0.5994536876678467
Epoch: 9, Steps: 10 | Train Loss: 0.255 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6880335807800293
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.135 Vali Acc: 0.568 Test Loss: 1.135 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 0.6716129779815674
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.484 Vali Acc: 0.446 Test Loss: 1.484 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6210715770721436
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.515 Vali Acc: 0.514 Test Loss: 1.515 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6681711673736572
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.463 Vali Acc: 0.541 Test Loss: 1.463 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5652501583099365
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.558 Vali Acc: 0.541 Test Loss: 1.558 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6012074947357178
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.393 Vali Acc: 0.554 Test Loss: 1.393 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5679254531860352
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.398 Vali Acc: 0.554 Test Loss: 1.398 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6431350708007812
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.394 Vali Acc: 0.554 Test Loss: 1.394 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5862791538238525
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.395 Vali Acc: 0.568 Test Loss: 1.395 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6046068668365479
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.439 Vali Acc: 0.568 Test Loss: 1.439 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.080927848815918
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.595 Test Loss: 1.422 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594580).  Saving model ...
Epoch: 21 cost time: 0.7211213111877441
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.408 Vali Acc: 0.595 Test Loss: 1.408 Test Acc: 0.595
Validation loss decreased (-0.594580 --> -0.594581).  Saving model ...
Epoch: 22 cost time: 0.839935302734375
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.421 Vali Acc: 0.568 Test Loss: 1.421 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.654364824295044
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.581 Test Loss: 1.410 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6033368110656738
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.581 Test Loss: 1.422 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5733110904693604
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.446 Vali Acc: 0.595 Test Loss: 1.446 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7306966781616211
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.426 Vali Acc: 0.581 Test Loss: 1.426 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1031215190887451
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.581 Test Loss: 1.451 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7295279502868652
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.581 Test Loss: 1.447 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6306445598602295
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.470 Vali Acc: 0.581 Test Loss: 1.470 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8601498603820801
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.581 Test Loss: 1.475 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.124692440032959
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.476 Vali Acc: 0.581 Test Loss: 1.476 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 22824196
model size : 101.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.982532262802124
Epoch: 1, Steps: 10 | Train Loss: 1.513 Vali Loss: 1.418 Vali Acc: 0.189 Test Loss: 1.418 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.7815585136413574
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.373 Vali Acc: 0.257 Test Loss: 1.373 Test Acc: 0.257
Validation loss decreased (-0.189175 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 0.9151110649108887
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.406 Vali Acc: 0.311 Test Loss: 1.406 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.5917115211486816
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.308 Vali Acc: 0.365 Test Loss: 1.308 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.5638587474822998
Epoch: 5, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.309 Vali Acc: 0.351 Test Loss: 1.309 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5672097206115723
Epoch: 6, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.237 Vali Acc: 0.486 Test Loss: 1.237 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 0.7285370826721191
Epoch: 7, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.218 Vali Acc: 0.459 Test Loss: 1.218 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6239149570465088
Epoch: 8, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6773276329040527
Epoch: 9, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6068770885467529
Epoch: 10, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.361 Vali Acc: 0.446 Test Loss: 1.361 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5519423484802246
Epoch: 11, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.215 Vali Acc: 0.527 Test Loss: 1.215 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 0.9614276885986328
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.243 Vali Acc: 0.514 Test Loss: 1.243 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6901340484619141
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.373 Vali Acc: 0.541 Test Loss: 1.373 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540527).  Saving model ...
Epoch: 14 cost time: 1.0638079643249512
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.244 Vali Acc: 0.554 Test Loss: 1.244 Test Acc: 0.554
Validation loss decreased (-0.540527 --> -0.554042).  Saving model ...
Epoch: 15 cost time: 0.6502516269683838
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.346 Vali Acc: 0.527 Test Loss: 1.346 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8502542972564697
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.346 Vali Acc: 0.541 Test Loss: 1.346 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7283713817596436
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.271 Vali Acc: 0.568 Test Loss: 1.271 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 18 cost time: 0.5461065769195557
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.321 Vali Acc: 0.581 Test Loss: 1.321 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581068).  Saving model ...
Epoch: 19 cost time: 0.7770459651947021
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.300 Vali Acc: 0.595 Test Loss: 1.300 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594582).  Saving model ...
Epoch: 20 cost time: 0.7026345729827881
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0321159362792969
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.313 Vali Acc: 0.595 Test Loss: 1.313 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6881265640258789
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.334 Vali Acc: 0.581 Test Loss: 1.334 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7007279396057129
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.397 Vali Acc: 0.595 Test Loss: 1.397 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7487185001373291
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.390 Vali Acc: 0.581 Test Loss: 1.390 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7499539852142334
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.581 Test Loss: 1.357 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7305529117584229
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.366 Vali Acc: 0.595 Test Loss: 1.366 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8403375148773193
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.405 Vali Acc: 0.595 Test Loss: 1.405 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0161712169647217
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.426 Vali Acc: 0.581 Test Loss: 1.426 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7400295734405518
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.396 Vali Acc: 0.581 Test Loss: 1.396 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 22764292
model size : 101.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.822495698928833
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.538 Vali Acc: 0.176 Test Loss: 1.538 Test Acc: 0.176
Validation loss decreased (inf --> -0.175660).  Saving model ...
Epoch: 2 cost time: 1.3308193683624268
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.299 Vali Acc: 0.459 Test Loss: 1.299 Test Acc: 0.459
Validation loss decreased (-0.175660 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.1596271991729736
Epoch: 3, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.366 Vali Acc: 0.257 Test Loss: 1.366 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3320412635803223
Epoch: 4, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.224 Vali Acc: 0.432 Test Loss: 1.224 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7941608428955078
Epoch: 5, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.459446 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.7485885620117188
Epoch: 6, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.280 Vali Acc: 0.459 Test Loss: 1.280 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0413250923156738
Epoch: 7, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.344 Vali Acc: 0.446 Test Loss: 1.344 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5858745574951172
Epoch: 8, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.358 Vali Acc: 0.514 Test Loss: 1.358 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513500).  Saving model ...
Epoch: 9 cost time: 1.2935421466827393
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.402 Vali Acc: 0.446 Test Loss: 1.402 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6829829216003418
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.614 Vali Acc: 0.514 Test Loss: 1.614 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7160429954528809
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.512 Vali Acc: 0.581 Test Loss: 1.512 Test Acc: 0.581
Validation loss decreased (-0.513500 --> -0.581066).  Saving model ...
Epoch: 12 cost time: 0.7914392948150635
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.743 Vali Acc: 0.568 Test Loss: 1.743 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8684172630310059
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.757 Vali Acc: 0.514 Test Loss: 1.757 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8836100101470947
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 2.047 Vali Acc: 0.527 Test Loss: 2.047 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8692026138305664
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.904 Vali Acc: 0.500 Test Loss: 1.904 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8044388294219971
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.822 Vali Acc: 0.541 Test Loss: 1.822 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7279918193817139
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.972 Vali Acc: 0.527 Test Loss: 1.972 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7133493423461914
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.964 Vali Acc: 0.541 Test Loss: 1.964 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7298226356506348
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.581 Test Loss: 1.867 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8604090213775635
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.554 Test Loss: 1.858 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7621140480041504
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.541 Test Loss: 1.909 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 22985476
model size : 102.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8771369457244873
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.364 Vali Acc: 0.297 Test Loss: 1.364 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.7212951183319092
Epoch: 2, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.359 Vali Acc: 0.324 Test Loss: 1.359 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.7135787010192871
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.307 Vali Acc: 0.459 Test Loss: 1.307 Test Acc: 0.459
Validation loss decreased (-0.324311 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 0.5087745189666748
Epoch: 4, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.243 Vali Acc: 0.419 Test Loss: 1.243 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5541272163391113
Epoch: 5, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.459446 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.5045228004455566
Epoch: 6, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5813286304473877
Epoch: 7, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.214 Vali Acc: 0.446 Test Loss: 1.214 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5591676235198975
Epoch: 8, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4935905933380127
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 0.5804901123046875
Epoch: 10, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.6965415477752686
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.108 Vali Acc: 0.595 Test Loss: 1.108 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.6006088256835938
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.099 Vali Acc: 0.595 Test Loss: 1.099 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 0.5874555110931396
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.273 Vali Acc: 0.581 Test Loss: 1.273 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7212707996368408
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.281 Vali Acc: 0.595 Test Loss: 1.281 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6469378471374512
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.351 Vali Acc: 0.622 Test Loss: 1.351 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621608).  Saving model ...
Epoch: 16 cost time: 0.6723239421844482
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.204 Vali Acc: 0.608 Test Loss: 1.204 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8040425777435303
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.322 Vali Acc: 0.622 Test Loss: 1.322 Test Acc: 0.622
Validation loss decreased (-0.621608 --> -0.621608).  Saving model ...
Epoch: 18 cost time: 0.7143785953521729
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.339 Vali Acc: 0.635 Test Loss: 1.339 Test Acc: 0.635
Validation loss decreased (-0.621608 --> -0.635122).  Saving model ...
Epoch: 19 cost time: 0.6158642768859863
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.290 Vali Acc: 0.608 Test Loss: 1.290 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6580166816711426
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.324 Vali Acc: 0.622 Test Loss: 1.324 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.684614896774292
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.379 Vali Acc: 0.635 Test Loss: 1.379 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7435822486877441
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.608 Test Loss: 1.368 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8513121604919434
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.339 Vali Acc: 0.622 Test Loss: 1.339 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5981466770172119
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.622 Test Loss: 1.334 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9241077899932861
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.608 Test Loss: 1.367 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8969621658325195
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.399 Vali Acc: 0.608 Test Loss: 1.399 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6735436916351318
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.608 Test Loss: 1.418 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8466472625732422
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.421 Vali Acc: 0.608 Test Loss: 1.421 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 22861060
model size : 101.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1090621948242188
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.6859607696533203
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.337 Vali Acc: 0.378 Test Loss: 1.337 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.5005607604980469
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.333 Vali Acc: 0.338 Test Loss: 1.333 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5738329887390137
Epoch: 4, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.6244981288909912
Epoch: 5, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.242 Vali Acc: 0.419 Test Loss: 1.242 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.571763277053833
Epoch: 6, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.222 Vali Acc: 0.459 Test Loss: 1.222 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 0.8640267848968506
Epoch: 7, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.148 Vali Acc: 0.473 Test Loss: 1.148 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 0.605323314666748
Epoch: 8, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.5170660018920898
Epoch: 9, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.157 Vali Acc: 0.459 Test Loss: 1.157 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6749036312103271
Epoch: 10, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.115 Vali Acc: 0.486 Test Loss: 1.115 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6179568767547607
Epoch: 11, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.119 Vali Acc: 0.622 Test Loss: 1.119 Test Acc: 0.622
Validation loss decreased (-0.499988 --> -0.621610).  Saving model ...
Epoch: 12 cost time: 0.6014397144317627
Epoch: 12, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.094 Vali Acc: 0.541 Test Loss: 1.094 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5635614395141602
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.120 Vali Acc: 0.622 Test Loss: 1.120 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6790685653686523
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.278 Vali Acc: 0.568 Test Loss: 1.278 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7525057792663574
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.257 Vali Acc: 0.568 Test Loss: 1.257 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5937674045562744
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.303 Vali Acc: 0.581 Test Loss: 1.303 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.574038028717041
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.330 Vali Acc: 0.581 Test Loss: 1.330 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7250182628631592
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.309 Vali Acc: 0.608 Test Loss: 1.309 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6027779579162598
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.350 Vali Acc: 0.608 Test Loss: 1.350 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7580790519714355
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.352 Vali Acc: 0.608 Test Loss: 1.352 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5891115665435791
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.318 Vali Acc: 0.595 Test Loss: 1.318 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 22801156
model size : 101.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.239589214324951
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.360 Vali Acc: 0.351 Test Loss: 1.360 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.7987492084503174
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.369 Vali Acc: 0.243 Test Loss: 1.369 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6115162372589111
Epoch: 3, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.239 Vali Acc: 0.527 Test Loss: 1.239 Test Acc: 0.527
Validation loss decreased (-0.351338 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.6084542274475098
Epoch: 4, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.149 Vali Acc: 0.446 Test Loss: 1.149 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6448123455047607
Epoch: 5, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8431084156036377
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5934722423553467
Epoch: 7, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.465 Vali Acc: 0.486 Test Loss: 1.465 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4959545135498047
Epoch: 8, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.622 Vali Acc: 0.459 Test Loss: 1.622 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5389316082000732
Epoch: 9, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.446 Vali Acc: 0.514 Test Loss: 1.446 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5251009464263916
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.534 Vali Acc: 0.459 Test Loss: 1.534 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5831246376037598
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.433 Vali Acc: 0.581 Test Loss: 1.433 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581067).  Saving model ...
Epoch: 12 cost time: 0.7181668281555176
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.745 Vali Acc: 0.514 Test Loss: 1.745 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9439718723297119
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.535 Vali Acc: 0.568 Test Loss: 1.535 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8966066837310791
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.711 Vali Acc: 0.554 Test Loss: 1.711 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7656271457672119
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.806 Vali Acc: 0.527 Test Loss: 1.806 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7822659015655518
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.581 Test Loss: 1.641 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9324870109558105
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.568 Test Loss: 1.581 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9756057262420654
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.581 Test Loss: 1.618 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8745219707489014
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.581 Test Loss: 1.658 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9203994274139404
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.568 Test Loss: 1.690 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8104758262634277
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.581 Test Loss: 1.664 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 22999300
model size : 102.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.287480115890503
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.428 Vali Acc: 0.176 Test Loss: 1.428 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.0160865783691406
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.335 Vali Acc: 0.378 Test Loss: 1.335 Test Acc: 0.378
Validation loss decreased (-0.175661 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.7416138648986816
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.348 Vali Acc: 0.392 Test Loss: 1.348 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 0.7662715911865234
Epoch: 4, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.6693375110626221
Epoch: 5, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.291 Vali Acc: 0.405 Test Loss: 1.291 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7275979518890381
Epoch: 6, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.194 Vali Acc: 0.527 Test Loss: 1.194 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.6320486068725586
Epoch: 7, Steps: 10 | Train Loss: 0.789 Vali Loss: 1.146 Vali Acc: 0.473 Test Loss: 1.146 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6359825134277344
Epoch: 8, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 0.7764761447906494
Epoch: 9, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.508 Vali Acc: 0.446 Test Loss: 1.508 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6901593208312988
Epoch: 10, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5458440780639648
Epoch: 11, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4965214729309082
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.307 Vali Acc: 0.554 Test Loss: 1.307 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554041).  Saving model ...
Epoch: 13 cost time: 0.8227415084838867
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.451 Vali Acc: 0.527 Test Loss: 1.451 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7442944049835205
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.291 Vali Acc: 0.568 Test Loss: 1.291 Test Acc: 0.568
Validation loss decreased (-0.554041 --> -0.567555).  Saving model ...
Epoch: 15 cost time: 1.0140109062194824
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.500 Vali Acc: 0.568 Test Loss: 1.500 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8083274364471436
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.437 Vali Acc: 0.622 Test Loss: 1.437 Test Acc: 0.622
Validation loss decreased (-0.567555 --> -0.621607).  Saving model ...
Epoch: 17 cost time: 0.7097146511077881
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.385 Vali Acc: 0.568 Test Loss: 1.385 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.875065803527832
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.407 Vali Acc: 0.622 Test Loss: 1.407 Test Acc: 0.622
Validation loss decreased (-0.621607 --> -0.621608).  Saving model ...
Epoch: 19 cost time: 0.9001750946044922
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.453 Vali Acc: 0.595 Test Loss: 1.453 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7271335124969482
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.399 Vali Acc: 0.581 Test Loss: 1.399 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6279840469360352
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.385 Vali Acc: 0.581 Test Loss: 1.385 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9036352634429932
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.595 Test Loss: 1.429 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.756598949432373
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.608 Test Loss: 1.424 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.836590051651001
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.414 Vali Acc: 0.595 Test Loss: 1.414 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7612087726593018
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.595 Test Loss: 1.454 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6029798984527588
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.446 Vali Acc: 0.595 Test Loss: 1.446 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6959776878356934
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.595 Test Loss: 1.439 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.555609941482544
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.595 Test Loss: 1.418 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 22897924
model size : 102.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.7496283054351807
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.384 Vali Acc: 0.284 Test Loss: 1.384 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.5673623085021973
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.391 Vali Acc: 0.257 Test Loss: 1.391 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7057943344116211
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.345 Vali Acc: 0.324 Test Loss: 1.345 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 0.5531337261199951
Epoch: 4, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.337 Vali Acc: 0.365 Test Loss: 1.337 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 0.6263680458068848
Epoch: 5, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.276 Vali Acc: 0.392 Test Loss: 1.276 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.7209408283233643
Epoch: 6, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.256 Vali Acc: 0.405 Test Loss: 1.256 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 0.5591917037963867
Epoch: 7, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.207 Vali Acc: 0.432 Test Loss: 1.207 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 0.6099410057067871
Epoch: 8, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.178 Vali Acc: 0.446 Test Loss: 1.178 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 0.8024353981018066
Epoch: 9, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.203 Vali Acc: 0.419 Test Loss: 1.203 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7648937702178955
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.089 Vali Acc: 0.527 Test Loss: 1.089 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.6568186283111572
Epoch: 11, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.129 Vali Acc: 0.514 Test Loss: 1.129 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6256551742553711
Epoch: 12, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8023371696472168
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6623640060424805
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6190860271453857
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.150 Vali Acc: 0.581 Test Loss: 1.150 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 0.7027707099914551
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6939797401428223
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.450469970703125
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.162 Vali Acc: 0.541 Test Loss: 1.162 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4777498245239258
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.158 Vali Acc: 0.568 Test Loss: 1.158 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4871687889099121
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7220654487609863
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6953582763671875
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7229728698730469
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.149 Vali Acc: 0.554 Test Loss: 1.149 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6568138599395752
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6573836803436279
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.180 Vali Acc: 0.527 Test Loss: 1.180 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 22842628
model size : 101.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps31_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5361123085021973
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.444 Vali Acc: 0.230 Test Loss: 1.444 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.8243935108184814
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.363 Vali Acc: 0.378 Test Loss: 1.363 Test Acc: 0.378
Validation loss decreased (-0.229715 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.0961785316467285
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.278 Vali Acc: 0.392 Test Loss: 1.278 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8358755111694336
Epoch: 4, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.059821367263794
Epoch: 5, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8680801391601562
Epoch: 6, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.305 Vali Acc: 0.419 Test Loss: 1.305 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.890918493270874
Epoch: 7, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.312 Vali Acc: 0.473 Test Loss: 1.312 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1507232189178467
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.257 Vali Acc: 0.473 Test Loss: 1.257 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7815916538238525
Epoch: 9, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.255 Vali Acc: 0.473 Test Loss: 1.255 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8501062393188477
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.495 Vali Acc: 0.486 Test Loss: 1.495 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7869827747344971
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.678 Vali Acc: 0.514 Test Loss: 1.678 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9830992221832275
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.739 Vali Acc: 0.527 Test Loss: 1.739 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8262767791748047
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.701 Vali Acc: 0.500 Test Loss: 1.701 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0268137454986572
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.789 Vali Acc: 0.541 Test Loss: 1.789 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540523).  Saving model ...
Epoch: 15 cost time: 0.5524098873138428
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.759 Vali Acc: 0.527 Test Loss: 1.759 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.497394323348999
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.514 Test Loss: 1.723 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.515833854675293
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.514 Test Loss: 1.738 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6280174255371094
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.500 Test Loss: 1.790 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9156758785247803
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.527 Test Loss: 1.752 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.764843225479126
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.514 Test Loss: 1.754 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8208792209625244
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.767 Vali Acc: 0.514 Test Loss: 1.767 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7748713493347168
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.486 Test Loss: 1.775 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4558417797088623
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.500 Test Loss: 1.787 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0047569274902344
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.486 Test Loss: 1.782 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps31_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 23045380
model size : 102.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.447476387023926
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.418 Vali Acc: 0.230 Test Loss: 1.418 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 1.1114966869354248
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.357 Vali Acc: 0.351 Test Loss: 1.357 Test Acc: 0.351
Validation loss decreased (-0.229716 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.9499821662902832
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.366 Vali Acc: 0.297 Test Loss: 1.366 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.685255765914917
Epoch: 4, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.8599913120269775
Epoch: 5, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.316 Vali Acc: 0.324 Test Loss: 1.316 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.776512861251831
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9691474437713623
Epoch: 7, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.249 Vali Acc: 0.419 Test Loss: 1.249 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0993270874023438
Epoch: 8, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.453 Vali Acc: 0.378 Test Loss: 1.453 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6357192993164062
Epoch: 9, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.291 Vali Acc: 0.541 Test Loss: 1.291 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540528).  Saving model ...
Epoch: 10 cost time: 0.9150731563568115
Epoch: 10, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.279 Vali Acc: 0.527 Test Loss: 1.279 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.73683762550354
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.363 Vali Acc: 0.514 Test Loss: 1.363 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7482616901397705
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.427 Vali Acc: 0.500 Test Loss: 1.427 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0561416149139404
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.766 Vali Acc: 0.459 Test Loss: 1.766 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9083385467529297
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.548 Vali Acc: 0.514 Test Loss: 1.548 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7249383926391602
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.575 Vali Acc: 0.514 Test Loss: 1.575 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7169044017791748
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.593 Vali Acc: 0.500 Test Loss: 1.593 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8883833885192871
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.558 Vali Acc: 0.541 Test Loss: 1.558 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9670538902282715
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.642 Vali Acc: 0.527 Test Loss: 1.642 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9652328491210938
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.673 Vali Acc: 0.514 Test Loss: 1.673 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 22939396
model size : 102.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps31_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4193003177642822
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.357 Vali Acc: 0.351 Test Loss: 1.357 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.6065101623535156
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.390 Vali Acc: 0.257 Test Loss: 1.390 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6117215156555176
Epoch: 3, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.631455659866333
Epoch: 4, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.275 Vali Acc: 0.432 Test Loss: 1.275 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.612908124923706
Epoch: 5, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 0.5621116161346436
Epoch: 6, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.579789400100708
Epoch: 7, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.7251853942871094
Epoch: 8, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7586333751678467
Epoch: 9, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5784473419189453
Epoch: 10, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7501194477081299
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7236847877502441
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.208 Vali Acc: 0.541 Test Loss: 1.208 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6110227108001709
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.264 Vali Acc: 0.514 Test Loss: 1.264 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6265273094177246
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.315 Vali Acc: 0.459 Test Loss: 1.315 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6068565845489502
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6436009407043457
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.377 Vali Acc: 0.500 Test Loss: 1.377 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8718340396881104
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps31_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 22884100
model size : 101.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2600955963134766
Epoch: 1, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.329 Vali Acc: 0.405 Test Loss: 1.329 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 0.8050823211669922
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7909069061279297
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.237 Vali Acc: 0.541 Test Loss: 1.237 Test Acc: 0.541
Validation loss decreased (-0.405392 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 0.9325473308563232
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9192304611206055
Epoch: 5, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.9617621898651123
Epoch: 6, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.255 Vali Acc: 0.405 Test Loss: 1.255 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0665643215179443
Epoch: 7, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.448 Vali Acc: 0.432 Test Loss: 1.448 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7965717315673828
Epoch: 8, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.092517614364624
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.248 Vali Acc: 0.554 Test Loss: 1.248 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9882557392120361
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.196 Vali Acc: 0.608 Test Loss: 1.196 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608096).  Saving model ...
Epoch: 11 cost time: 0.9233086109161377
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.504 Vali Acc: 0.554 Test Loss: 1.504 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7974860668182373
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.265 Vali Acc: 0.568 Test Loss: 1.265 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9541044235229492
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.396 Vali Acc: 0.568 Test Loss: 1.396 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7936632633209229
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.420 Vali Acc: 0.581 Test Loss: 1.420 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7368922233581543
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.404 Vali Acc: 0.608 Test Loss: 1.404 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9288003444671631
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.438 Vali Acc: 0.595 Test Loss: 1.438 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8533697128295898
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.533 Vali Acc: 0.595 Test Loss: 1.533 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8653433322906494
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.502 Vali Acc: 0.595 Test Loss: 1.502 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9269742965698242
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.595 Test Loss: 1.481 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8644242286682129
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.608 Test Loss: 1.475 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 23086852
model size : 102.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0134170055389404
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.398 Vali Acc: 0.230 Test Loss: 1.398 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.5984880924224854
Epoch: 2, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.295 Vali Acc: 0.446 Test Loss: 1.295 Test Acc: 0.446
Validation loss decreased (-0.229716 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.7435019016265869
Epoch: 3, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.335 Vali Acc: 0.311 Test Loss: 1.335 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6957058906555176
Epoch: 4, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.7686855792999268
Epoch: 5, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6261353492736816
Epoch: 6, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 0.6055848598480225
Epoch: 7, Steps: 10 | Train Loss: 0.754 Vali Loss: 1.226 Vali Acc: 0.459 Test Loss: 1.226 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6009149551391602
Epoch: 8, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7794911861419678
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7103428840637207
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.136 Vali Acc: 0.622 Test Loss: 1.136 Test Acc: 0.622
Validation loss decreased (-0.567556 --> -0.621610).  Saving model ...
Epoch: 11 cost time: 0.7449951171875
Epoch: 11, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6548182964324951
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.164 Vali Acc: 0.527 Test Loss: 1.164 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7343261241912842
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.421 Vali Acc: 0.595 Test Loss: 1.421 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8673155307769775
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.152 Vali Acc: 0.568 Test Loss: 1.152 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0127708911895752
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.310 Vali Acc: 0.595 Test Loss: 1.310 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7580091953277588
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.223 Vali Acc: 0.595 Test Loss: 1.223 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8893089294433594
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.287 Vali Acc: 0.635 Test Loss: 1.287 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635122).  Saving model ...
Epoch: 18 cost time: 0.7874431610107422
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.315 Vali Acc: 0.608 Test Loss: 1.315 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7636737823486328
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.260 Vali Acc: 0.608 Test Loss: 1.260 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7462308406829834
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.268 Vali Acc: 0.622 Test Loss: 1.268 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7922883033752441
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.284 Vali Acc: 0.608 Test Loss: 1.284 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9446022510528564
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.622 Test Loss: 1.291 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.636298656463623
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.290 Vali Acc: 0.635 Test Loss: 1.290 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6869304180145264
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.310 Vali Acc: 0.635 Test Loss: 1.310 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7318503856658936
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.635 Test Loss: 1.288 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7290496826171875
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.278 Vali Acc: 0.635 Test Loss: 1.278 Test Acc: 0.635
Validation loss decreased (-0.635122 --> -0.635122).  Saving model ...
Epoch: 27 cost time: 0.5414402484893799
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.296 Vali Acc: 0.635 Test Loss: 1.296 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7987873554229736
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.309 Vali Acc: 0.635 Test Loss: 1.309 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7466275691986084
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.635 Test Loss: 1.323 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.639378547668457
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.635 Test Loss: 1.301 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7082593441009521
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.310 Vali Acc: 0.635 Test Loss: 1.310 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6638493537902832
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.635 Test Loss: 1.329 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6899118423461914
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.635 Test Loss: 1.337 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7266764640808105
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.635 Test Loss: 1.345 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7356460094451904
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.635 Test Loss: 1.345 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5855741500854492
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.635 Test Loss: 1.357 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 22999300
model size : 102.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9895057678222656
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.451 Vali Acc: 0.230 Test Loss: 1.451 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.5584995746612549
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.396 Vali Acc: 0.324 Test Loss: 1.396 Test Acc: 0.324
Validation loss decreased (-0.229715 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 0.9269351959228516
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.340 Vali Acc: 0.405 Test Loss: 1.340 Test Acc: 0.405
Validation loss decreased (-0.324310 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.5338494777679443
Epoch: 4, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.354 Vali Acc: 0.297 Test Loss: 1.354 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5411796569824219
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
Validation loss decreased (-0.405392 --> -0.540528).  Saving model ...
Epoch: 6 cost time: 0.5590224266052246
Epoch: 6, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.233 Vali Acc: 0.541 Test Loss: 1.233 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540528).  Saving model ...
Epoch: 7 cost time: 0.6190586090087891
Epoch: 7, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 0.5829005241394043
Epoch: 8, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.559556245803833
Epoch: 9, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.201 Vali Acc: 0.554 Test Loss: 1.201 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6877341270446777
Epoch: 10, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.234 Vali Acc: 0.568 Test Loss: 1.234 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 11 cost time: 0.5767033100128174
Epoch: 11, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5389523506164551
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5525352954864502
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.218 Vali Acc: 0.541 Test Loss: 1.218 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5181484222412109
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.264 Vali Acc: 0.581 Test Loss: 1.264 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581068).  Saving model ...
Epoch: 15 cost time: 0.6557555198669434
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.285 Vali Acc: 0.554 Test Loss: 1.285 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5492875576019287
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.272 Vali Acc: 0.554 Test Loss: 1.272 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6434597969055176
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.334 Vali Acc: 0.568 Test Loss: 1.334 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6193387508392334
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.330 Vali Acc: 0.541 Test Loss: 1.330 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5885791778564453
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7532763481140137
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.351 Vali Acc: 0.527 Test Loss: 1.351 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5854594707489014
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.362 Vali Acc: 0.568 Test Loss: 1.362 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5761620998382568
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.358 Vali Acc: 0.554 Test Loss: 1.358 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5619158744812012
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.373 Vali Acc: 0.595 Test Loss: 1.373 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594581).  Saving model ...
Epoch: 24 cost time: 0.8923676013946533
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.369 Vali Acc: 0.595 Test Loss: 1.369 Test Acc: 0.595
Validation loss decreased (-0.594581 --> -0.594581).  Saving model ...
Epoch: 25 cost time: 0.5043935775756836
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.380 Vali Acc: 0.608 Test Loss: 1.380 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608094).  Saving model ...
Epoch: 26 cost time: 0.5308277606964111
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.416 Vali Acc: 0.568 Test Loss: 1.416 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5083990097045898
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.413 Vali Acc: 0.554 Test Loss: 1.413 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.43919992446899414
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.408 Vali Acc: 0.595 Test Loss: 1.408 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5259053707122803
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.405 Vali Acc: 0.595 Test Loss: 1.405 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6223077774047852
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.581 Test Loss: 1.421 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5628187656402588
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.432 Vali Acc: 0.568 Test Loss: 1.432 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5674631595611572
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.595 Test Loss: 1.429 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5721731185913086
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.432 Vali Acc: 0.581 Test Loss: 1.432 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6087636947631836
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.443 Vali Acc: 0.581 Test Loss: 1.443 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6721444129943848
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.456 Vali Acc: 0.581 Test Loss: 1.456 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 22948612
model size : 102.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps37_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3127636909484863
Epoch: 1, Steps: 10 | Train Loss: 1.508 Vali Loss: 1.370 Vali Acc: 0.284 Test Loss: 1.370 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.633495569229126
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.301 Vali Acc: 0.297 Test Loss: 1.301 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.5099196434020996
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.231 Vali Acc: 0.446 Test Loss: 1.231 Test Acc: 0.446
Validation loss decreased (-0.297284 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.8107893466949463
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.170 Vali Acc: 0.473 Test Loss: 1.170 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.7701380252838135
Epoch: 5, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.230 Vali Acc: 0.365 Test Loss: 1.230 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6936826705932617
Epoch: 6, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.935166597366333
Epoch: 7, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 0.9468197822570801
Epoch: 8, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.205 Vali Acc: 0.541 Test Loss: 1.205 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 0.8492331504821777
Epoch: 9, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.376 Vali Acc: 0.554 Test Loss: 1.376 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554040).  Saving model ...
Epoch: 10 cost time: 0.8362860679626465
Epoch: 10, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.371 Vali Acc: 0.541 Test Loss: 1.371 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.811089038848877
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.388 Vali Acc: 0.554 Test Loss: 1.388 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7148733139038086
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.269 Vali Acc: 0.595 Test Loss: 1.269 Test Acc: 0.595
Validation loss decreased (-0.554040 --> -0.594582).  Saving model ...
Epoch: 13 cost time: 0.6795663833618164
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.569 Vali Acc: 0.527 Test Loss: 1.569 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8962852954864502
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.359 Vali Acc: 0.568 Test Loss: 1.359 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6557826995849609
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.383 Vali Acc: 0.622 Test Loss: 1.383 Test Acc: 0.622
Validation loss decreased (-0.594582 --> -0.621608).  Saving model ...
Epoch: 16 cost time: 0.7334027290344238
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.414 Vali Acc: 0.581 Test Loss: 1.414 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8437099456787109
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.417 Vali Acc: 0.554 Test Loss: 1.417 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7429420948028564
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.380 Vali Acc: 0.581 Test Loss: 1.380 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6784114837646484
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.595 Test Loss: 1.386 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6424686908721924
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.581 Test Loss: 1.396 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6227254867553711
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.568 Test Loss: 1.404 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.46820855140686035
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.388 Vali Acc: 0.554 Test Loss: 1.388 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6951825618743896
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.554 Test Loss: 1.365 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.763188362121582
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.342 Vali Acc: 0.581 Test Loss: 1.342 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7178130149841309
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.364 Vali Acc: 0.568 Test Loss: 1.364 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps37_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 23137540
model size : 102.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps37_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1339645385742188
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.441 Vali Acc: 0.176 Test Loss: 1.441 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 0.5231659412384033
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.361 Vali Acc: 0.284 Test Loss: 1.361 Test Acc: 0.284
Validation loss decreased (-0.175661 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.7913880348205566
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.317 Vali Acc: 0.405 Test Loss: 1.317 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 0.6111030578613281
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.5814754962921143
Epoch: 5, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.7950806617736816
Epoch: 6, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7621097564697266
Epoch: 7, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.184 Vali Acc: 0.419 Test Loss: 1.184 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6328074932098389
Epoch: 8, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 0.7017333507537842
Epoch: 9, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.457 Vali Acc: 0.378 Test Loss: 1.457 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7210102081298828
Epoch: 10, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9273359775543213
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.265 Vali Acc: 0.527 Test Loss: 1.265 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49369263648986816
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.443 Vali Acc: 0.514 Test Loss: 1.443 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7357757091522217
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.259 Vali Acc: 0.568 Test Loss: 1.259 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 14 cost time: 0.9061024188995361
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.388 Vali Acc: 0.514 Test Loss: 1.388 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9686400890350342
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.378 Vali Acc: 0.527 Test Loss: 1.378 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6414737701416016
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.290 Vali Acc: 0.514 Test Loss: 1.290 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6023311614990234
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.347 Vali Acc: 0.527 Test Loss: 1.347 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6415259838104248
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581068).  Saving model ...
Epoch: 19 cost time: 0.7286789417266846
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.313 Vali Acc: 0.500 Test Loss: 1.313 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0284178256988525
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.343 Vali Acc: 0.554 Test Loss: 1.343 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5251984596252441
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0441288948059082
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.399 Vali Acc: 0.514 Test Loss: 1.399 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9414443969726562
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.389 Vali Acc: 0.541 Test Loss: 1.389 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.674522876739502
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9159445762634277
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.393 Vali Acc: 0.527 Test Loss: 1.393 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8299593925476074
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.405 Vali Acc: 0.527 Test Loss: 1.405 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6090164184570312
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.541 Test Loss: 1.415 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.833655834197998
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.541 Test Loss: 1.406 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps37_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 23059204
model size : 102.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps37_str37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9553465843200684
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.423 Vali Acc: 0.189 Test Loss: 1.423 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.6106562614440918
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.332 Vali Acc: 0.324 Test Loss: 1.332 Test Acc: 0.324
Validation loss decreased (-0.189175 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.600783109664917
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.379 Vali Acc: 0.284 Test Loss: 1.379 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5461058616638184
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.295 Vali Acc: 0.405 Test Loss: 1.295 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.6224868297576904
Epoch: 5, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.274 Vali Acc: 0.432 Test Loss: 1.274 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.5736393928527832
Epoch: 6, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.261 Vali Acc: 0.432 Test Loss: 1.261 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 0.5156092643737793
Epoch: 7, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 0.6436195373535156
Epoch: 8, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.6302425861358643
Epoch: 9, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5436291694641113
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.162 Vali Acc: 0.486 Test Loss: 1.162 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.622908353805542
Epoch: 11, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.269 Vali Acc: 0.473 Test Loss: 1.269 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.590003490447998
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.266 Vali Acc: 0.486 Test Loss: 1.266 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5155124664306641
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.275 Vali Acc: 0.527 Test Loss: 1.275 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527014).  Saving model ...
Epoch: 14 cost time: 0.5972821712493896
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.362 Vali Acc: 0.554 Test Loss: 1.362 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554040).  Saving model ...
Epoch: 15 cost time: 0.683624267578125
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.280 Vali Acc: 0.527 Test Loss: 1.280 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6854727268218994
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.301 Vali Acc: 0.581 Test Loss: 1.301 Test Acc: 0.581
Validation loss decreased (-0.554040 --> -0.581068).  Saving model ...
Epoch: 17 cost time: 0.7571115493774414
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.311 Vali Acc: 0.581 Test Loss: 1.311 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6618525981903076
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.317 Vali Acc: 0.541 Test Loss: 1.317 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6281931400299072
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.345 Vali Acc: 0.514 Test Loss: 1.345 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6216576099395752
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.343 Vali Acc: 0.541 Test Loss: 1.343 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9379978179931641
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.367 Vali Acc: 0.568 Test Loss: 1.367 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8376331329345703
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.378 Vali Acc: 0.541 Test Loss: 1.378 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6326239109039307
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.397 Vali Acc: 0.568 Test Loss: 1.397 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6403982639312744
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.397 Vali Acc: 0.554 Test Loss: 1.397 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6012935638427734
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.403 Vali Acc: 0.568 Test Loss: 1.403 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6305968761444092
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.415 Vali Acc: 0.568 Test Loss: 1.415 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps37_str37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 23013124
model size : 102.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps40_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.277040958404541
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.444 Vali Acc: 0.189 Test Loss: 1.444 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 0.6353046894073486
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.342 Vali Acc: 0.324 Test Loss: 1.342 Test Acc: 0.324
Validation loss decreased (-0.189175 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.5999972820281982
Epoch: 3, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.306 Vali Acc: 0.351 Test Loss: 1.306 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.7570281028747559
Epoch: 4, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.227 Vali Acc: 0.432 Test Loss: 1.227 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 0.670112133026123
Epoch: 5, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.264 Vali Acc: 0.432 Test Loss: 1.264 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.967775821685791
Epoch: 6, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.7056698799133301
Epoch: 7, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.059 Vali Acc: 0.541 Test Loss: 1.059 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 0.9090046882629395
Epoch: 8, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.336 Vali Acc: 0.527 Test Loss: 1.336 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8867931365966797
Epoch: 9, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.503 Vali Acc: 0.514 Test Loss: 1.503 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9139862060546875
Epoch: 10, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.330 Vali Acc: 0.581 Test Loss: 1.330 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581068).  Saving model ...
Epoch: 11 cost time: 0.7928190231323242
Epoch: 11, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.621 Vali Acc: 0.419 Test Loss: 1.621 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7545878887176514
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.546 Vali Acc: 0.527 Test Loss: 1.546 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7183666229248047
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.581 Vali Acc: 0.568 Test Loss: 1.581 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0945415496826172
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.386 Vali Acc: 0.581 Test Loss: 1.386 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9807391166687012
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.553 Vali Acc: 0.595 Test Loss: 1.553 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594579).  Saving model ...
Epoch: 16 cost time: 0.8026585578918457
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.641 Vali Acc: 0.581 Test Loss: 1.641 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8793656826019287
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.581 Test Loss: 1.592 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0618739128112793
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.595 Test Loss: 1.565 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9893069267272949
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.595 Test Loss: 1.592 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8402585983276367
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.581 Test Loss: 1.620 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0476725101470947
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.568 Test Loss: 1.619 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8161368370056152
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.568 Test Loss: 1.620 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8727607727050781
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.568 Test Loss: 1.621 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8299083709716797
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.568 Test Loss: 1.638 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9458508491516113
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.568 Test Loss: 1.635 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps40_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 23206660
model size : 103.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps40_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1883530616760254
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.368 Vali Acc: 0.270 Test Loss: 1.368 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.634871244430542
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.352 Vali Acc: 0.365 Test Loss: 1.352 Test Acc: 0.365
Validation loss decreased (-0.270257 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 0.5841555595397949
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.280 Vali Acc: 0.473 Test Loss: 1.280 Test Acc: 0.473
Validation loss decreased (-0.364851 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.6137845516204834
Epoch: 4, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 0.6315398216247559
Epoch: 5, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.5929579734802246
Epoch: 6, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.146 Vali Acc: 0.486 Test Loss: 1.146 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6267590522766113
Epoch: 7, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.205 Vali Acc: 0.527 Test Loss: 1.205 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6153345108032227
Epoch: 8, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.226 Vali Acc: 0.514 Test Loss: 1.226 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6555798053741455
Epoch: 9, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.166 Vali Acc: 0.568 Test Loss: 1.166 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 0.66001296043396
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.244 Vali Acc: 0.554 Test Loss: 1.244 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6119945049285889
Epoch: 11, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5618107318878174
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.252 Vali Acc: 0.541 Test Loss: 1.252 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5979740619659424
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.191 Vali Acc: 0.595 Test Loss: 1.191 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 0.6633830070495605
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.441 Vali Acc: 0.568 Test Loss: 1.441 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8962204456329346
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.331 Vali Acc: 0.568 Test Loss: 1.331 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6724259853363037
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.287 Vali Acc: 0.581 Test Loss: 1.287 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6290278434753418
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.348 Vali Acc: 0.581 Test Loss: 1.348 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6389439105987549
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.385 Vali Acc: 0.581 Test Loss: 1.385 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5700984001159668
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.382 Vali Acc: 0.581 Test Loss: 1.382 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.657301664352417
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.410 Vali Acc: 0.554 Test Loss: 1.410 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8616049289703369
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.409 Vali Acc: 0.541 Test Loss: 1.409 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5599138736724854
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.407 Vali Acc: 0.541 Test Loss: 1.407 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5674643516540527
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.411 Vali Acc: 0.541 Test Loss: 1.411 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps40_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 23123716
model size : 102.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps40_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.7364718914031982
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.415 Vali Acc: 0.176 Test Loss: 1.415 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 0.45836973190307617
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.393 Vali Acc: 0.270 Test Loss: 1.393 Test Acc: 0.270
Validation loss decreased (-0.175662 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 0.5050778388977051
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.348 Vali Acc: 0.338 Test Loss: 1.348 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.5817945003509521
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.307 Vali Acc: 0.365 Test Loss: 1.307 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 0.5633993148803711
Epoch: 5, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.6421363353729248
Epoch: 6, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.225 Vali Acc: 0.432 Test Loss: 1.225 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6654350757598877
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.209 Vali Acc: 0.419 Test Loss: 1.209 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7856981754302979
Epoch: 8, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.240 Vali Acc: 0.405 Test Loss: 1.240 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4533708095550537
Epoch: 9, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.171 Vali Acc: 0.473 Test Loss: 1.171 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 0.5562927722930908
Epoch: 10, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.167 Vali Acc: 0.473 Test Loss: 1.167 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 0.7310712337493896
Epoch: 11, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 0.7886219024658203
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 0.48934364318847656
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5099387168884277
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5870370864868164
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.169 Vali Acc: 0.568 Test Loss: 1.169 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5090124607086182
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5245037078857422
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6078188419342041
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.209 Vali Acc: 0.568 Test Loss: 1.209 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5747392177581787
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5954625606536865
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.189 Vali Acc: 0.595 Test Loss: 1.189 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 21 cost time: 0.7559859752655029
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6184530258178711
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.173 Vali Acc: 0.581 Test Loss: 1.173 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.552898645401001
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.199 Vali Acc: 0.595 Test Loss: 1.199 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6946511268615723
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.215 Vali Acc: 0.595 Test Loss: 1.215 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.43283629417419434
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.217 Vali Acc: 0.608 Test Loss: 1.217 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 26 cost time: 0.5939450263977051
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.216 Vali Acc: 0.622 Test Loss: 1.216 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621609).  Saving model ...
Epoch: 27 cost time: 0.5410366058349609
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.216 Vali Acc: 0.595 Test Loss: 1.216 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6911139488220215
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.227 Vali Acc: 0.581 Test Loss: 1.227 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.47356486320495605
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.251 Vali Acc: 0.568 Test Loss: 1.251 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5099844932556152
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.263 Vali Acc: 0.581 Test Loss: 1.263 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5732192993164062
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.258 Vali Acc: 0.581 Test Loss: 1.258 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.493725061416626
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.265 Vali Acc: 0.581 Test Loss: 1.265 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4795191287994385
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.524066686630249
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5618894100189209
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.291 Vali Acc: 0.568 Test Loss: 1.291 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5999646186828613
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.286 Vali Acc: 0.581 Test Loss: 1.286 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps40_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 23082244
model size : 102.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.173323631286621
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.366 Vali Acc: 0.270 Test Loss: 1.366 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.6441495418548584
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.290 Vali Acc: 0.392 Test Loss: 1.290 Test Acc: 0.392
Validation loss decreased (-0.270257 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.0378942489624023
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.271 Vali Acc: 0.446 Test Loss: 1.271 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.7175319194793701
Epoch: 4, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.177 Vali Acc: 0.514 Test Loss: 1.177 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.5517704486846924
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.791776180267334
Epoch: 6, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
Validation loss decreased (-0.527016 --> -0.608097).  Saving model ...
Epoch: 7 cost time: 0.6064209938049316
Epoch: 7, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7009880542755127
Epoch: 8, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.350 Vali Acc: 0.514 Test Loss: 1.350 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.696871280670166
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5601294040679932
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6892080307006836
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.256 Vali Acc: 0.527 Test Loss: 1.256 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6617021560668945
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.330 Vali Acc: 0.595 Test Loss: 1.330 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8337466716766357
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.407 Vali Acc: 0.595 Test Loss: 1.407 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7241146564483643
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.342 Vali Acc: 0.568 Test Loss: 1.342 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8538877964019775
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.384 Vali Acc: 0.554 Test Loss: 1.384 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8246707916259766
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.473 Vali Acc: 0.595 Test Loss: 1.473 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 23289604
model size : 103.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8411643505096436
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.367 Vali Acc: 0.351 Test Loss: 1.367 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.670928955078125
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.351 Vali Acc: 0.378 Test Loss: 1.351 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.7357912063598633
Epoch: 3, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.316 Vali Acc: 0.351 Test Loss: 1.316 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7099225521087646
Epoch: 4, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.290 Vali Acc: 0.365 Test Loss: 1.290 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7771768569946289
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.240 Vali Acc: 0.514 Test Loss: 1.240 Test Acc: 0.514
Validation loss decreased (-0.378365 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 0.7882628440856934
Epoch: 6, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6750473976135254
Epoch: 7, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 0.6472277641296387
Epoch: 8, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.245 Vali Acc: 0.541 Test Loss: 1.245 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540528).  Saving model ...
Epoch: 9 cost time: 0.6568067073822021
Epoch: 9, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.177 Vali Acc: 0.446 Test Loss: 1.177 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6699891090393066
Epoch: 10, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.432 Vali Acc: 0.446 Test Loss: 1.432 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5659117698669434
Epoch: 11, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.229 Vali Acc: 0.432 Test Loss: 1.229 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5432913303375244
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.533 Vali Acc: 0.527 Test Loss: 1.533 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.49549126625061035
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.290 Vali Acc: 0.527 Test Loss: 1.290 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.537745475769043
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7691357135772705
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.233 Vali Acc: 0.568 Test Loss: 1.233 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567555).  Saving model ...
Epoch: 16 cost time: 0.737776517868042
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.342 Vali Acc: 0.568 Test Loss: 1.342 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9127540588378906
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.279 Vali Acc: 0.554 Test Loss: 1.279 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7942461967468262
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.278 Vali Acc: 0.554 Test Loss: 1.278 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8369967937469482
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.305 Vali Acc: 0.568 Test Loss: 1.305 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6565868854522705
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.342 Vali Acc: 0.527 Test Loss: 1.342 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.600602388381958
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.341 Vali Acc: 0.541 Test Loss: 1.341 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.51922607421875
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.341 Vali Acc: 0.554 Test Loss: 1.341 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7402172088623047
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.341 Vali Acc: 0.541 Test Loss: 1.341 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6764211654663086
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.346 Vali Acc: 0.554 Test Loss: 1.346 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7184820175170898
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.357 Vali Acc: 0.554 Test Loss: 1.357 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 23225092
model size : 103.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9397084712982178
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.369 Vali Acc: 0.311 Test Loss: 1.369 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.5168187618255615
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.326 Vali Acc: 0.392 Test Loss: 1.326 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.5371780395507812
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.283 Vali Acc: 0.446 Test Loss: 1.283 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.6428191661834717
Epoch: 4, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.266 Vali Acc: 0.405 Test Loss: 1.266 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4447951316833496
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.207 Vali Acc: 0.541 Test Loss: 1.207 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540528).  Saving model ...
Epoch: 6 cost time: 0.737541913986206
Epoch: 6, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.561835765838623
Epoch: 7, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.086 Vali Acc: 0.527 Test Loss: 1.086 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5645880699157715
Epoch: 8, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.069 Vali Acc: 0.486 Test Loss: 1.069 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5574982166290283
Epoch: 9, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.074 Vali Acc: 0.514 Test Loss: 1.074 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5734233856201172
Epoch: 10, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.076 Vali Acc: 0.459 Test Loss: 1.076 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6001303195953369
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.109 Vali Acc: 0.473 Test Loss: 1.109 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5467503070831299
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.073 Vali Acc: 0.527 Test Loss: 1.073 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5290312767028809
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6427133083343506
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5734269618988037
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5261940956115723
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.118 Vali Acc: 0.514 Test Loss: 1.118 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 23188228
model size : 103.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps50_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9149589538574219
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.419 Vali Acc: 0.257 Test Loss: 1.419 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.7049975395202637
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.350 Vali Acc: 0.284 Test Loss: 1.350 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.665726900100708
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.271 Vali Acc: 0.459 Test Loss: 1.271 Test Acc: 0.459
Validation loss decreased (-0.283770 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.6348235607147217
Epoch: 4, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.6762702465057373
Epoch: 5, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.8179643154144287
Epoch: 6, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.226 Vali Acc: 0.419 Test Loss: 1.226 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8881320953369141
Epoch: 7, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.6161818504333496
Epoch: 8, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.259 Vali Acc: 0.405 Test Loss: 1.259 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6996726989746094
Epoch: 9, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0147595405578613
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.357 Vali Acc: 0.527 Test Loss: 1.357 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9428248405456543
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.383 Vali Acc: 0.486 Test Loss: 1.383 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.693631649017334
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.378 Vali Acc: 0.486 Test Loss: 1.378 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.666022777557373
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.463 Vali Acc: 0.541 Test Loss: 1.463 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7961304187774658
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.630 Vali Acc: 0.514 Test Loss: 1.630 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7101218700408936
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.480 Vali Acc: 0.541 Test Loss: 1.480 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8617162704467773
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.468 Vali Acc: 0.527 Test Loss: 1.468 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8929390907287598
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.527 Vali Acc: 0.527 Test Loss: 1.527 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps50_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 23390980
model size : 103.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps50_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9992945194244385
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.7958319187164307
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.336 Vali Acc: 0.392 Test Loss: 1.336 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7170369625091553
Epoch: 3, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5700769424438477
Epoch: 4, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.266 Vali Acc: 0.446 Test Loss: 1.266 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 0.7260885238647461
Epoch: 5, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.7874059677124023
Epoch: 6, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.188 Vali Acc: 0.459 Test Loss: 1.188 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7076435089111328
Epoch: 7, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7036967277526855
Epoch: 8, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.162 Vali Acc: 0.527 Test Loss: 1.162 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 0.6922705173492432
Epoch: 9, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.136 Vali Acc: 0.554 Test Loss: 1.136 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.6136178970336914
Epoch: 10, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.609656572341919
Epoch: 11, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.157 Vali Acc: 0.595 Test Loss: 1.157 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594583).  Saving model ...
Epoch: 12 cost time: 0.5700092315673828
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.594043493270874
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.332 Vali Acc: 0.514 Test Loss: 1.332 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5660500526428223
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.316 Vali Acc: 0.514 Test Loss: 1.316 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5522778034210205
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.318 Vali Acc: 0.514 Test Loss: 1.318 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6659212112426758
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.300 Vali Acc: 0.541 Test Loss: 1.300 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6096556186676025
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.282 Vali Acc: 0.527 Test Loss: 1.282 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5618212223052979
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.276 Vali Acc: 0.527 Test Loss: 1.276 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5355722904205322
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.312 Vali Acc: 0.568 Test Loss: 1.312 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6046226024627686
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.326 Vali Acc: 0.554 Test Loss: 1.326 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5767745971679688
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.346 Vali Acc: 0.541 Test Loss: 1.346 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps50_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 23335684
model size : 103.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps50_str50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.847017765045166
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.338 Vali Acc: 0.297 Test Loss: 1.338 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.5501346588134766
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.346 Vali Acc: 0.392 Test Loss: 1.346 Test Acc: 0.392
Validation loss decreased (-0.297284 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 0.5972485542297363
Epoch: 3, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.278 Vali Acc: 0.432 Test Loss: 1.278 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.5147562026977539
Epoch: 4, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.5873329639434814
Epoch: 5, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.6439721584320068
Epoch: 6, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.155 Vali Acc: 0.527 Test Loss: 1.155 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 0.6087973117828369
Epoch: 7, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 0.5411617755889893
Epoch: 8, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.016 Vali Acc: 0.568 Test Loss: 1.016 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.6401066780090332
Epoch: 9, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.6105058193206787
Epoch: 10, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.054 Vali Acc: 0.595 Test Loss: 1.054 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.5210397243499756
Epoch: 11, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.033 Vali Acc: 0.622 Test Loss: 1.033 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 0.5788149833679199
Epoch: 12, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5944781303405762
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5605278015136719
Epoch: 14, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.054 Vali Acc: 0.635 Test Loss: 1.054 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 0.6643316745758057
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.057 Vali Acc: 0.635 Test Loss: 1.057 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.634293794631958
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.049 Vali Acc: 0.635 Test Loss: 1.049 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 0.7856054306030273
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.081 Vali Acc: 0.662 Test Loss: 1.081 Test Acc: 0.662
Validation loss decreased (-0.635125 --> -0.662151).  Saving model ...
Epoch: 18 cost time: 0.6737267971038818
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.120 Vali Acc: 0.649 Test Loss: 1.120 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5455427169799805
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.130 Vali Acc: 0.622 Test Loss: 1.130 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6038172245025635
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.110 Vali Acc: 0.662 Test Loss: 1.110 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5597949028015137
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.108 Vali Acc: 0.676 Test Loss: 1.108 Test Acc: 0.676
Validation loss decreased (-0.662151 --> -0.675665).  Saving model ...
Epoch: 22 cost time: 0.5872862339019775
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.113 Vali Acc: 0.662 Test Loss: 1.113 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5885095596313477
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.117 Vali Acc: 0.662 Test Loss: 1.117 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5450432300567627
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.121 Vali Acc: 0.662 Test Loss: 1.121 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.587601900100708
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.131 Vali Acc: 0.649 Test Loss: 1.131 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6111595630645752
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.168 Vali Acc: 0.649 Test Loss: 1.168 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.55405592918396
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.189 Vali Acc: 0.662 Test Loss: 1.189 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5660240650177002
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.191 Vali Acc: 0.662 Test Loss: 1.191 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.651573657989502
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.189 Vali Acc: 0.662 Test Loss: 1.189 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5173959732055664
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.198 Vali Acc: 0.676 Test Loss: 1.198 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.535942554473877
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.212 Vali Acc: 0.649 Test Loss: 1.212 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps50_str50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 23303428
model size : 103.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.172299385070801
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.457 Vali Acc: 0.257 Test Loss: 1.457 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.6895871162414551
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.341 Vali Acc: 0.432 Test Loss: 1.341 Test Acc: 0.432
Validation loss decreased (-0.256742 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.5406336784362793
Epoch: 3, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.268 Vali Acc: 0.459 Test Loss: 1.268 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.5763015747070312
Epoch: 4, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.5640015602111816
Epoch: 5, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.159 Vali Acc: 0.541 Test Loss: 1.159 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.560138463973999
Epoch: 6, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.5961554050445557
Epoch: 7, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.6521108150482178
Epoch: 8, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8665575981140137
Epoch: 9, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.336 Vali Acc: 0.486 Test Loss: 1.336 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6685354709625244
Epoch: 10, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5473778247833252
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7283391952514648
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.362 Vali Acc: 0.486 Test Loss: 1.362 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8994576930999756
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.286 Vali Acc: 0.554 Test Loss: 1.286 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7890868186950684
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.347 Vali Acc: 0.554 Test Loss: 1.347 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6650772094726562
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.452 Vali Acc: 0.514 Test Loss: 1.452 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6557385921478271
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.416 Vali Acc: 0.541 Test Loss: 1.416 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5782120227813721
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.420 Vali Acc: 0.541 Test Loss: 1.420 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 23556868
model size : 104.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9583790302276611
Epoch: 1, Steps: 10 | Train Loss: 1.530 Vali Loss: 1.384 Vali Acc: 0.230 Test Loss: 1.384 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.5017421245574951
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.396 Vali Acc: 0.284 Test Loss: 1.396 Test Acc: 0.284
Validation loss decreased (-0.229716 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.541569709777832
Epoch: 3, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.330 Vali Acc: 0.459 Test Loss: 1.330 Test Acc: 0.459
Validation loss decreased (-0.283770 --> -0.459446).  Saving model ...
Epoch: 4 cost time: 0.5570144653320312
Epoch: 4, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.239 Vali Acc: 0.514 Test Loss: 1.239 Test Acc: 0.514
Validation loss decreased (-0.459446 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 0.6727490425109863
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5402090549468994
Epoch: 6, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.6246581077575684
Epoch: 7, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.5358309745788574
Epoch: 8, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.103 Vali Acc: 0.595 Test Loss: 1.103 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 0.5417912006378174
Epoch: 9, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.085 Vali Acc: 0.568 Test Loss: 1.085 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.49385786056518555
Epoch: 10, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.172 Vali Acc: 0.581 Test Loss: 1.172 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.49749231338500977
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.111 Vali Acc: 0.635 Test Loss: 1.111 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635124).  Saving model ...
Epoch: 12 cost time: 0.5809760093688965
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.270 Vali Acc: 0.635 Test Loss: 1.270 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.550264835357666
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.222 Vali Acc: 0.622 Test Loss: 1.222 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5529370307922363
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.170 Vali Acc: 0.595 Test Loss: 1.170 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5770213603973389
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.249 Vali Acc: 0.622 Test Loss: 1.249 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5743732452392578
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.219 Vali Acc: 0.649 Test Loss: 1.219 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648636).  Saving model ...
Epoch: 17 cost time: 0.6420409679412842
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.209 Vali Acc: 0.622 Test Loss: 1.209 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6615040302276611
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.234 Vali Acc: 0.662 Test Loss: 1.234 Test Acc: 0.662
Validation loss decreased (-0.648636 --> -0.662150).  Saving model ...
Epoch: 19 cost time: 0.5682172775268555
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.277 Vali Acc: 0.662 Test Loss: 1.277 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5449995994567871
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.260 Vali Acc: 0.649 Test Loss: 1.260 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7239820957183838
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.249 Vali Acc: 0.635 Test Loss: 1.249 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6198382377624512
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.233 Vali Acc: 0.662 Test Loss: 1.233 Test Acc: 0.662
Validation loss decreased (-0.662150 --> -0.662150).  Saving model ...
Epoch: 23 cost time: 0.6427285671234131
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.256 Vali Acc: 0.649 Test Loss: 1.256 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5218372344970703
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.266 Vali Acc: 0.662 Test Loss: 1.266 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6384773254394531
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.275 Vali Acc: 0.649 Test Loss: 1.275 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.577730655670166
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.270 Vali Acc: 0.662 Test Loss: 1.270 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6960875988006592
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.267 Vali Acc: 0.662 Test Loss: 1.267 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5737812519073486
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.276 Vali Acc: 0.662 Test Loss: 1.276 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5984725952148438
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.662 Test Loss: 1.284 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.49137258529663086
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.290 Vali Acc: 0.662 Test Loss: 1.290 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5537495613098145
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.300 Vali Acc: 0.662 Test Loss: 1.300 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.48726940155029297
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.307 Vali Acc: 0.662 Test Loss: 1.307 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 23506180
model size : 104.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9246017932891846
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.5909161567687988
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.6715598106384277
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.346 Vali Acc: 0.338 Test Loss: 1.346 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 0.5566055774688721
Epoch: 4, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.334 Vali Acc: 0.351 Test Loss: 1.334 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.6166846752166748
Epoch: 5, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.280 Vali Acc: 0.405 Test Loss: 1.280 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 0.5613555908203125
Epoch: 6, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.239 Vali Acc: 0.446 Test Loss: 1.239 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 7 cost time: 0.6798000335693359
Epoch: 7, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.195 Vali Acc: 0.432 Test Loss: 1.195 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6821432113647461
Epoch: 8, Steps: 10 | Train Loss: 0.627 Vali Loss: 1.149 Vali Acc: 0.473 Test Loss: 1.149 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.7286543846130371
Epoch: 9, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 0.6520533561706543
Epoch: 10, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 0.6295816898345947
Epoch: 11, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.551950216293335
Epoch: 12, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.105 Vali Acc: 0.554 Test Loss: 1.105 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 0.7089941501617432
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 0.6188468933105469
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.093 Vali Acc: 0.595 Test Loss: 1.093 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 0.6854562759399414
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5979359149932861
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.159 Vali Acc: 0.581 Test Loss: 1.159 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.596045970916748
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.159 Vali Acc: 0.568 Test Loss: 1.159 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5427331924438477
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.144 Vali Acc: 0.581 Test Loss: 1.144 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.575613260269165
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.176 Vali Acc: 0.581 Test Loss: 1.176 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5326740741729736
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.190 Vali Acc: 0.595 Test Loss: 1.190 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6101377010345459
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.204 Vali Acc: 0.622 Test Loss: 1.204 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621610).  Saving model ...
Epoch: 22 cost time: 0.5185930728912354
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.205 Vali Acc: 0.595 Test Loss: 1.205 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6071822643280029
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.202 Vali Acc: 0.608 Test Loss: 1.202 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5035605430603027
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.213 Vali Acc: 0.608 Test Loss: 1.213 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6002118587493896
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.214 Vali Acc: 0.608 Test Loss: 1.214 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7142069339752197
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.214 Vali Acc: 0.608 Test Loss: 1.214 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5765583515167236
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.212 Vali Acc: 0.608 Test Loss: 1.212 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5634806156158447
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.208 Vali Acc: 0.608 Test Loss: 1.208 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5514688491821289
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.214 Vali Acc: 0.608 Test Loss: 1.214 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5215792655944824
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.217 Vali Acc: 0.595 Test Loss: 1.217 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6757586002349854
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.221 Vali Acc: 0.595 Test Loss: 1.221 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 23478532
model size : 104.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps67_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.027958631515503
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.0115303993225098
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.353 Vali Acc: 0.338 Test Loss: 1.353 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.605144739151001
Epoch: 3, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.291 Vali Acc: 0.432 Test Loss: 1.291 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.7204737663269043
Epoch: 4, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.237 Vali Acc: 0.473 Test Loss: 1.237 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.7744455337524414
Epoch: 5, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.177 Vali Acc: 0.473 Test Loss: 1.177 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.6500058174133301
Epoch: 6, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.155 Vali Acc: 0.486 Test Loss: 1.155 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 0.6384742259979248
Epoch: 7, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.209 Vali Acc: 0.541 Test Loss: 1.209 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540528).  Saving model ...
Epoch: 8 cost time: 0.6724650859832764
Epoch: 8, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 0.6729872226715088
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 0.6412320137023926
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.412 Vali Acc: 0.581 Test Loss: 1.412 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6540441513061523
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5855362415313721
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.358 Vali Acc: 0.581 Test Loss: 1.358 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6408581733703613
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.292 Vali Acc: 0.595 Test Loss: 1.292 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7286393642425537
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.394 Vali Acc: 0.568 Test Loss: 1.394 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6659238338470459
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.457 Vali Acc: 0.595 Test Loss: 1.457 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9162585735321045
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.423 Vali Acc: 0.581 Test Loss: 1.423 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7352840900421143
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.390 Vali Acc: 0.581 Test Loss: 1.390 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.700559139251709
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.397 Vali Acc: 0.595 Test Loss: 1.397 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5797417163848877
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.437 Vali Acc: 0.608 Test Loss: 1.437 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608094).  Saving model ...
Epoch: 20 cost time: 0.6463210582733154
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.463 Vali Acc: 0.608 Test Loss: 1.463 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6922838687896729
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.438 Vali Acc: 0.595 Test Loss: 1.438 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6943233013153076
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.445 Vali Acc: 0.581 Test Loss: 1.445 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7317953109741211
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.595 Test Loss: 1.455 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.699976921081543
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.581 Test Loss: 1.475 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.618340253829956
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.456 Vali Acc: 0.595 Test Loss: 1.456 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7007997035980225
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.446 Vali Acc: 0.595 Test Loss: 1.446 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6224889755249023
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.595 Test Loss: 1.459 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6882052421569824
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.595 Test Loss: 1.477 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6464478969573975
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.608 Test Loss: 1.474 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps67_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 23750404
model size : 105.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps67_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0648465156555176
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.422 Vali Acc: 0.162 Test Loss: 1.422 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 0.4727318286895752
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.363 Vali Acc: 0.284 Test Loss: 1.363 Test Acc: 0.284
Validation loss decreased (-0.162148 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.6034059524536133
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.342 Vali Acc: 0.351 Test Loss: 1.342 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.5734384059906006
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.297 Vali Acc: 0.419 Test Loss: 1.297 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 0.5214111804962158
Epoch: 5, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.47467041015625
Epoch: 6, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.241 Vali Acc: 0.378 Test Loss: 1.241 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5038728713989258
Epoch: 7, Steps: 10 | Train Loss: 0.720 Vali Loss: 1.192 Vali Acc: 0.405 Test Loss: 1.192 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5614545345306396
Epoch: 8, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 0.5312960147857666
Epoch: 9, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 0.5449128150939941
Epoch: 10, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.073 Vali Acc: 0.527 Test Loss: 1.073 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.5313525199890137
Epoch: 11, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.071 Vali Acc: 0.581 Test Loss: 1.071 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 0.6500263214111328
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6964306831359863
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6545155048370361
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.160 Vali Acc: 0.527 Test Loss: 1.160 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6823732852935791
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6409916877746582
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5847759246826172
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.205 Vali Acc: 0.541 Test Loss: 1.205 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8240566253662109
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.217 Vali Acc: 0.541 Test Loss: 1.217 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5267605781555176
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.220 Vali Acc: 0.541 Test Loss: 1.220 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5780618190765381
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.45111894607543945
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps67_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 23704324
model size : 105.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps67_str67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.9598751068115234
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.358 Vali Acc: 0.324 Test Loss: 1.358 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.7076454162597656
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.313 Vali Acc: 0.446 Test Loss: 1.313 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.6395995616912842
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.6165249347686768
Epoch: 4, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.63987135887146
Epoch: 5, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.233 Vali Acc: 0.446 Test Loss: 1.233 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6502821445465088
Epoch: 6, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.202 Vali Acc: 0.514 Test Loss: 1.202 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6163668632507324
Epoch: 7, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 0.5848484039306641
Epoch: 8, Steps: 10 | Train Loss: 0.628 Vali Loss: 1.090 Vali Acc: 0.581 Test Loss: 1.090 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 0.6151530742645264
Epoch: 9, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7331712245941162
Epoch: 10, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.016 Vali Acc: 0.595 Test Loss: 1.016 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.5922229290008545
Epoch: 11, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.075 Vali Acc: 0.568 Test Loss: 1.075 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5861155986785889
Epoch: 12, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5722200870513916
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.039 Vali Acc: 0.554 Test Loss: 1.039 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.553297758102417
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5916235446929932
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5385940074920654
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 17 cost time: 0.6192286014556885
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.111 Vali Acc: 0.608 Test Loss: 1.111 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6489851474761963
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.119 Vali Acc: 0.581 Test Loss: 1.119 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5795145034790039
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.109 Vali Acc: 0.608 Test Loss: 1.109 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5834379196166992
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.53312087059021
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.124 Vali Acc: 0.622 Test Loss: 1.124 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 22 cost time: 0.6002171039581299
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.139 Vali Acc: 0.622 Test Loss: 1.139 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6252236366271973
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6332507133483887
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6401066780090332
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.155 Vali Acc: 0.608 Test Loss: 1.155 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4963035583496094
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.156 Vali Acc: 0.595 Test Loss: 1.156 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5612452030181885
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.162 Vali Acc: 0.595 Test Loss: 1.162 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5870616436004639
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.164 Vali Acc: 0.608 Test Loss: 1.164 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.46413254737854004
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.168 Vali Acc: 0.608 Test Loss: 1.168 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6202318668365479
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.170 Vali Acc: 0.622 Test Loss: 1.170 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6014301776885986
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.173 Vali Acc: 0.622 Test Loss: 1.173 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps67_str67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 23681284
model size : 105.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps80_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6188600063323975
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.424 Vali Acc: 0.216 Test Loss: 1.424 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.6833269596099854
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.348 Vali Acc: 0.284 Test Loss: 1.348 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.9274177551269531
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.311 Vali Acc: 0.378 Test Loss: 1.311 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.6281890869140625
Epoch: 4, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.240 Vali Acc: 0.419 Test Loss: 1.240 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 0.7833845615386963
Epoch: 5, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.217 Vali Acc: 0.432 Test Loss: 1.217 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 0.8697667121887207
Epoch: 6, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.155 Vali Acc: 0.459 Test Loss: 1.155 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 1.1051361560821533
Epoch: 7, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.188 Vali Acc: 0.527 Test Loss: 1.188 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 0.897036075592041
Epoch: 8, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.180 Vali Acc: 0.473 Test Loss: 1.180 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8224525451660156
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.188 Vali Acc: 0.459 Test Loss: 1.188 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0487332344055176
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.261 Vali Acc: 0.568 Test Loss: 1.261 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567555).  Saving model ...
Epoch: 11 cost time: 1.0127143859863281
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.178 Vali Acc: 0.595 Test Loss: 1.178 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594583).  Saving model ...
Epoch: 12 cost time: 0.8617720603942871
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.262 Vali Acc: 0.541 Test Loss: 1.262 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7042925357818604
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.283 Vali Acc: 0.568 Test Loss: 1.283 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7204136848449707
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.238 Vali Acc: 0.581 Test Loss: 1.238 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6166021823883057
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.284 Vali Acc: 0.581 Test Loss: 1.284 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6489005088806152
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.313 Vali Acc: 0.581 Test Loss: 1.313 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6987488269805908
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.259 Vali Acc: 0.581 Test Loss: 1.259 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6871242523193359
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.253 Vali Acc: 0.595 Test Loss: 1.253 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7215595245361328
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.264 Vali Acc: 0.595 Test Loss: 1.264 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7106335163116455
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.265 Vali Acc: 0.595 Test Loss: 1.265 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6628367900848389
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.277 Vali Acc: 0.595 Test Loss: 1.277 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps80_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 24036100
model size : 106.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps80_str40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0720081329345703
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.468 Vali Acc: 0.284 Test Loss: 1.468 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 0.7627179622650146
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.329 Vali Acc: 0.459 Test Loss: 1.329 Test Acc: 0.459
Validation loss decreased (-0.283769 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.6721482276916504
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.47885799407958984
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.320 Vali Acc: 0.405 Test Loss: 1.320 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.462238073348999
Epoch: 5, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
Validation loss decreased (-0.459446 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 0.619055986404419
Epoch: 6, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5952587127685547
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.101 Vali Acc: 0.527 Test Loss: 1.101 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.5645847320556641
Epoch: 8, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 0.7164015769958496
Epoch: 9, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.5592930316925049
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 0.5975310802459717
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 0.7325644493103027
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.038 Vali Acc: 0.554 Test Loss: 1.038 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6425309181213379
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.018 Vali Acc: 0.554 Test Loss: 1.018 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6709985733032227
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.061 Vali Acc: 0.622 Test Loss: 1.061 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 15 cost time: 0.5405840873718262
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.056 Vali Acc: 0.595 Test Loss: 1.056 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48291707038879395
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5007803440093994
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5858180522918701
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.090 Vali Acc: 0.622 Test Loss: 1.090 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7389416694641113
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.105 Vali Acc: 0.649 Test Loss: 1.105 Test Acc: 0.649
Validation loss decreased (-0.621611 --> -0.648638).  Saving model ...
Epoch: 20 cost time: 0.7662148475646973
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.103 Vali Acc: 0.595 Test Loss: 1.103 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6242713928222656
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.114 Vali Acc: 0.622 Test Loss: 1.114 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6253542900085449
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.111 Vali Acc: 0.635 Test Loss: 1.111 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6165180206298828
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.116 Vali Acc: 0.622 Test Loss: 1.116 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.757596492767334
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.125 Vali Acc: 0.622 Test Loss: 1.125 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6171894073486328
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.119 Vali Acc: 0.622 Test Loss: 1.119 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5383355617523193
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.122 Vali Acc: 0.635 Test Loss: 1.122 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5878527164459229
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.130 Vali Acc: 0.622 Test Loss: 1.130 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7037415504455566
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.622 Test Loss: 1.131 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7100315093994141
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.139 Vali Acc: 0.622 Test Loss: 1.139 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps80_str40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 23999236
model size : 106.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps80_str80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.088892936706543
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.414 Vali Acc: 0.203 Test Loss: 1.414 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 0.45566725730895996
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.323 Vali Acc: 0.338 Test Loss: 1.323 Test Acc: 0.338
Validation loss decreased (-0.202689 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 0.704766035079956
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.268 Vali Acc: 0.473 Test Loss: 1.268 Test Acc: 0.473
Validation loss decreased (-0.337825 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.6536684036254883
Epoch: 4, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7205212116241455
Epoch: 5, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.6757967472076416
Epoch: 6, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.5374138355255127
Epoch: 7, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5441606044769287
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.051 Vali Acc: 0.568 Test Loss: 1.051 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.5772433280944824
Epoch: 9, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.6357581615447998
Epoch: 10, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.041 Vali Acc: 0.541 Test Loss: 1.041 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5911276340484619
Epoch: 11, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.000 Vali Acc: 0.554 Test Loss: 1.000 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5491421222686768
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.984 Vali Acc: 0.568 Test Loss: 0.984 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5526046752929688
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.031 Vali Acc: 0.635 Test Loss: 1.031 Test Acc: 0.635
Validation loss decreased (-0.581071 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 0.7875854969024658
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.041 Vali Acc: 0.635 Test Loss: 1.041 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6890277862548828
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5949292182922363
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.054 Vali Acc: 0.608 Test Loss: 1.054 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.48790836334228516
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.068 Vali Acc: 0.635 Test Loss: 1.068 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6071279048919678
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.088 Vali Acc: 0.635 Test Loss: 1.088 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6811928749084473
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.095 Vali Acc: 0.649 Test Loss: 1.095 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 20 cost time: 0.6010956764221191
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.093 Vali Acc: 0.649 Test Loss: 1.093 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 21 cost time: 0.7784638404846191
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.095 Vali Acc: 0.635 Test Loss: 1.095 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6581151485443115
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.099 Vali Acc: 0.622 Test Loss: 1.099 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7493734359741211
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.111 Vali Acc: 0.622 Test Loss: 1.111 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6587011814117432
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.118 Vali Acc: 0.622 Test Loss: 1.118 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5931711196899414
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.135 Vali Acc: 0.622 Test Loss: 1.135 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7439758777618408
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.143 Vali Acc: 0.622 Test Loss: 1.143 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5970337390899658
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.134 Vali Acc: 0.622 Test Loss: 1.134 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.48236656188964844
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.130 Vali Acc: 0.608 Test Loss: 1.130 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5664093494415283
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.139 Vali Acc: 0.622 Test Loss: 1.139 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.553661584854126
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.622 Test Loss: 1.145 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_GPT4TS_UEA_ftM_sl400_ll0_pl0_el3_dm768_df768_ps80_str80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 23980804
model size : 106.15MB
