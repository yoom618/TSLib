Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.721944808959961
Epoch: 1, Steps: 17 | Train Loss: 1.871 Vali Loss: 1.506 Vali Acc: 0.335 Test Loss: 1.506 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 4.910266160964966
Epoch: 2, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.179 Vali Acc: 0.543 Test Loss: 1.179 Test Acc: 0.543
Validation loss decreased (-0.335245 --> -0.543341).  Saving model ...
Epoch: 3 cost time: 4.200578689575195
Epoch: 3, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.240 Vali Acc: 0.566 Test Loss: 1.240 Test Acc: 0.566
Validation loss decreased (-0.543341 --> -0.566462).  Saving model ...
Epoch: 4 cost time: 3.8350601196289062
Epoch: 4, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.860 Vali Acc: 0.676 Test Loss: 0.860 Test Acc: 0.676
Validation loss decreased (-0.566462 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 4.653505802154541
Epoch: 5, Steps: 17 | Train Loss: 0.596 Vali Loss: 1.137 Vali Acc: 0.630 Test Loss: 1.137 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.310119152069092
Epoch: 6, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.814 Vali Acc: 0.740 Test Loss: 0.814 Test Acc: 0.740
Validation loss decreased (-0.676292 --> -0.739876).  Saving model ...
Epoch: 7 cost time: 4.5375590324401855
Epoch: 7, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.730 Vali Acc: 0.792 Test Loss: 0.730 Test Acc: 0.792
Validation loss decreased (-0.739876 --> -0.791900).  Saving model ...
Epoch: 8 cost time: 3.7949562072753906
Epoch: 8, Steps: 17 | Train Loss: 0.275 Vali Loss: 1.448 Vali Acc: 0.688 Test Loss: 1.448 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.639600038528442
Epoch: 9, Steps: 17 | Train Loss: 0.481 Vali Loss: 1.284 Vali Acc: 0.636 Test Loss: 1.284 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.651294231414795
Epoch: 10, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9901840686798096
Epoch: 11, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.451 Vali Acc: 0.694 Test Loss: 1.451 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.166836738586426
Epoch: 12, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.173 Vali Acc: 0.792 Test Loss: 1.173 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.412038803100586
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.432 Vali Acc: 0.798 Test Loss: 1.432 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797674).  Saving model ...
Epoch: 14 cost time: 4.499862909317017
Epoch: 14, Steps: 17 | Train Loss: 0.300 Vali Loss: 2.053 Vali Acc: 0.694 Test Loss: 2.053 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.639710426330566
Epoch: 15, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.631 Vali Acc: 0.740 Test Loss: 1.631 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.283934831619263
Epoch: 16, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.489 Vali Acc: 0.780 Test Loss: 1.489 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.2351179122924805
Epoch: 17, Steps: 17 | Train Loss: 0.174 Vali Loss: 2.007 Vali Acc: 0.798 Test Loss: 2.007 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.204376697540283
Epoch: 18, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.923 Vali Acc: 0.723 Test Loss: 1.923 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9639978408813477
Epoch: 19, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.834 Vali Acc: 0.792 Test Loss: 1.834 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.828566789627075
Epoch: 20, Steps: 17 | Train Loss: 0.092 Vali Loss: 3.061 Vali Acc: 0.728 Test Loss: 3.061 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8681905269622803
Epoch: 21, Steps: 17 | Train Loss: 0.189 Vali Loss: 1.425 Vali Acc: 0.786 Test Loss: 1.425 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.838423013687134
Epoch: 22, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.083 Vali Acc: 0.803 Test Loss: 1.083 Test Acc: 0.803
Validation loss decreased (-0.797674 --> -0.803457).  Saving model ...
Epoch: 23 cost time: 5.309768438339233
Epoch: 23, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.207 Vali Acc: 0.775 Test Loss: 2.207 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.085819721221924
Epoch: 24, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.615 Vali Acc: 0.803 Test Loss: 1.615 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.053126811981201
Epoch: 25, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.723 Vali Acc: 0.827 Test Loss: 1.723 Test Acc: 0.827
Validation loss decreased (-0.803457 --> -0.826572).  Saving model ...
Epoch: 26 cost time: 5.371128797531128
Epoch: 26, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.846 Vali Acc: 0.821 Test Loss: 1.846 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.397714614868164
Epoch: 27, Steps: 17 | Train Loss: 0.077 Vali Loss: 3.337 Vali Acc: 0.751 Test Loss: 3.337 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.0052313804626465
Epoch: 28, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.878 Vali Acc: 0.792 Test Loss: 1.878 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.472168684005737
Epoch: 29, Steps: 17 | Train Loss: 0.041 Vali Loss: 3.256 Vali Acc: 0.757 Test Loss: 3.256 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.60639214515686
Epoch: 30, Steps: 17 | Train Loss: 0.199 Vali Loss: 2.303 Vali Acc: 0.780 Test Loss: 2.303 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.722237586975098
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.012 Vali Acc: 0.821 Test Loss: 2.012 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.560801982879639
Epoch: 32, Steps: 17 | Train Loss: 0.123 Vali Loss: 3.251 Vali Acc: 0.769 Test Loss: 3.251 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.948387622833252
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.210 Vali Acc: 0.763 Test Loss: 2.210 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.3938820362091064
Epoch: 34, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.852 Vali Acc: 0.798 Test Loss: 2.852 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.158735990524292
Epoch: 35, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.571 Vali Acc: 0.803 Test Loss: 2.571 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 57176839
model size : 232.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.748194694519043
Epoch: 1, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.620 Vali Acc: 0.260 Test Loss: 1.620 Test Acc: 0.260
Validation loss decreased (inf --> -0.260099).  Saving model ...
Epoch: 2 cost time: 4.445849418640137
Epoch: 2, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.542 Vali Acc: 0.324 Test Loss: 1.542 Test Acc: 0.324
Validation loss decreased (-0.260099 --> -0.323684).  Saving model ...
Epoch: 3 cost time: 3.5381858348846436
Epoch: 3, Steps: 17 | Train Loss: 1.035 Vali Loss: 0.819 Vali Acc: 0.694 Test Loss: 0.819 Test Acc: 0.694
Validation loss decreased (-0.323684 --> -0.693633).  Saving model ...
Epoch: 4 cost time: 3.5710928440093994
Epoch: 4, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.755 Vali Acc: 0.694 Test Loss: 0.755 Test Acc: 0.694
Validation loss decreased (-0.693633 --> -0.693634).  Saving model ...
Epoch: 5 cost time: 3.390214204788208
Epoch: 5, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.953 Vali Acc: 0.665 Test Loss: 0.953 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.827984094619751
Epoch: 6, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.973 Vali Acc: 0.705 Test Loss: 0.973 Test Acc: 0.705
Validation loss decreased (-0.693634 --> -0.705193).  Saving model ...
Epoch: 7 cost time: 4.093929767608643
Epoch: 7, Steps: 17 | Train Loss: 0.275 Vali Loss: 1.382 Vali Acc: 0.653 Test Loss: 1.382 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.115464210510254
Epoch: 8, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.646 Vali Acc: 0.798 Test Loss: 0.646 Test Acc: 0.798
Validation loss decreased (-0.705193 --> -0.797681).  Saving model ...
Epoch: 9 cost time: 4.353891849517822
Epoch: 9, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.355 Vali Acc: 0.705 Test Loss: 1.355 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.64812970161438
Epoch: 10, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.807 Vali Acc: 0.838 Test Loss: 0.807 Test Acc: 0.838
Validation loss decreased (-0.797681 --> -0.838142).  Saving model ...
Epoch: 11 cost time: 2.598332643508911
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.081 Vali Acc: 0.821 Test Loss: 1.081 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.633348226547241
Epoch: 12, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.211 Vali Acc: 0.751 Test Loss: 1.211 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1889023780822754
Epoch: 13, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.949 Vali Acc: 0.798 Test Loss: 0.949 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.227853775024414
Epoch: 14, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.533 Vali Acc: 0.803 Test Loss: 1.533 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4581260681152344
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.952 Vali Acc: 0.815 Test Loss: 0.952 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.374256134033203
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.069 Vali Acc: 0.815 Test Loss: 1.069 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.4158647060394287
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.855 Test Loss: 0.764 Test Acc: 0.855
Validation loss decreased (-0.838142 --> -0.855484).  Saving model ...
Epoch: 18 cost time: 2.468742847442627
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.803 Test Loss: 0.956 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.948207139968872
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.821 Test Loss: 0.990 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.069572448730469
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.946 Vali Acc: 0.780 Test Loss: 0.946 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.751699447631836
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.780 Test Loss: 0.941 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.79166579246521
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.786 Test Loss: 0.927 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3559091091156006
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.798 Test Loss: 0.920 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5826425552368164
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.798 Test Loss: 0.915 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8417139053344727
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.798 Test Loss: 0.920 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.049694061279297
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.798 Test Loss: 0.925 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.623854160308838
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.803 Test Loss: 0.957 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 57017863
model size : 232.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.117532730102539
Epoch: 1, Steps: 17 | Train Loss: 1.822 Vali Loss: 1.605 Vali Acc: 0.335 Test Loss: 1.605 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 2.4213626384735107
Epoch: 2, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.172 Vali Acc: 0.462 Test Loss: 1.172 Test Acc: 0.462
Validation loss decreased (-0.335244 --> -0.462416).  Saving model ...
Epoch: 3 cost time: 2.6278374195098877
Epoch: 3, Steps: 17 | Train Loss: 0.814 Vali Loss: 1.104 Vali Acc: 0.566 Test Loss: 1.104 Test Acc: 0.566
Validation loss decreased (-0.462416 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 2.467029333114624
Epoch: 4, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.987 Vali Acc: 0.624 Test Loss: 0.987 Test Acc: 0.624
Validation loss decreased (-0.566463 --> -0.624268).  Saving model ...
Epoch: 5 cost time: 3.529803514480591
Epoch: 5, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.706 Vali Acc: 0.757 Test Loss: 0.706 Test Acc: 0.757
Validation loss decreased (-0.624268 --> -0.757218).  Saving model ...
Epoch: 6 cost time: 3.1432693004608154
Epoch: 6, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4254050254821777
Epoch: 7, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.788 Vali Acc: 0.723 Test Loss: 0.788 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9524061679840088
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.940 Vali Acc: 0.723 Test Loss: 0.940 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9504477977752686
Epoch: 9, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.101 Vali Acc: 0.705 Test Loss: 1.101 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4395394325256348
Epoch: 10, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.228 Vali Acc: 0.717 Test Loss: 1.228 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3047449588775635
Epoch: 11, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.130 Vali Acc: 0.711 Test Loss: 1.130 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8970236778259277
Epoch: 12, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.720 Vali Acc: 0.763 Test Loss: 0.720 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762999).  Saving model ...
Epoch: 13 cost time: 3.6402580738067627
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.082 Vali Acc: 0.769 Test Loss: 1.082 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768775).  Saving model ...
Epoch: 14 cost time: 3.3580291271209717
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.173 Vali Acc: 0.786 Test Loss: 1.173 Test Acc: 0.786
Validation loss decreased (-0.768775 --> -0.786115).  Saving model ...
Epoch: 15 cost time: 3.4703598022460938
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.022 Vali Acc: 0.792 Test Loss: 1.022 Test Acc: 0.792
Validation loss decreased (-0.786115 --> -0.791897).  Saving model ...
Epoch: 16 cost time: 2.761711597442627
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.947 Vali Acc: 0.775 Test Loss: 0.947 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9058446884155273
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.956 Vali Acc: 0.717 Test Loss: 1.956 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0141708850860596
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.170233964920044
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.842 Vali Acc: 0.803 Test Loss: 0.842 Test Acc: 0.803
Validation loss decreased (-0.791897 --> -0.803460).  Saving model ...
Epoch: 20 cost time: 2.7547671794891357
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.165 Vali Acc: 0.803 Test Loss: 1.165 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.931567907333374
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.854 Vali Acc: 0.809 Test Loss: 0.854 Test Acc: 0.809
Validation loss decreased (-0.803460 --> -0.809240).  Saving model ...
Epoch: 22 cost time: 2.340900421142578
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.815 Test Loss: 1.014 Test Acc: 0.815
Validation loss decreased (-0.809240 --> -0.815019).  Saving model ...
Epoch: 23 cost time: 3.44174861907959
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.266 Vali Acc: 0.769 Test Loss: 1.266 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.833423614501953
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.122 Vali Acc: 0.780 Test Loss: 1.122 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.417815685272217
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.192 Vali Acc: 0.775 Test Loss: 1.192 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4484431743621826
Epoch: 26, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.571 Vali Acc: 0.757 Test Loss: 1.571 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.4443540573120117
Epoch: 27, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.931 Vali Acc: 0.769 Test Loss: 1.931 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.7380270957946777
Epoch: 28, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.856 Vali Acc: 0.780 Test Loss: 0.856 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.936302900314331
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.960 Vali Acc: 0.769 Test Loss: 0.960 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.810910701751709
Epoch: 30, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.361 Vali Acc: 0.717 Test Loss: 1.361 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.993483781814575
Epoch: 31, Steps: 17 | Train Loss: 0.118 Vali Loss: 2.613 Vali Acc: 0.688 Test Loss: 2.613 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.2981395721435547
Epoch: 32, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.858 Vali Acc: 0.809 Test Loss: 0.858 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 56858887
model size : 231.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.882736921310425
Epoch: 1, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.597 Vali Acc: 0.329 Test Loss: 1.597 Test Acc: 0.329
Validation loss decreased (inf --> -0.329464).  Saving model ...
Epoch: 2 cost time: 4.0272932052612305
Epoch: 2, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.129 Vali Acc: 0.543 Test Loss: 1.129 Test Acc: 0.543
Validation loss decreased (-0.329464 --> -0.543341).  Saving model ...
Epoch: 3 cost time: 4.714823246002197
Epoch: 3, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.407 Vali Acc: 0.462 Test Loss: 1.407 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.36942982673645
Epoch: 4, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.914 Vali Acc: 0.647 Test Loss: 0.914 Test Acc: 0.647
Validation loss decreased (-0.543341 --> -0.647390).  Saving model ...
Epoch: 5 cost time: 4.084842681884766
Epoch: 5, Steps: 17 | Train Loss: 0.494 Vali Loss: 1.008 Vali Acc: 0.653 Test Loss: 1.008 Test Acc: 0.653
Validation loss decreased (-0.647390 --> -0.653169).  Saving model ...
Epoch: 6 cost time: 3.601764440536499
Epoch: 6, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.482 Vali Acc: 0.526 Test Loss: 1.482 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.585041046142578
Epoch: 7, Steps: 17 | Train Loss: 0.556 Vali Loss: 1.152 Vali Acc: 0.659 Test Loss: 1.152 Test Acc: 0.659
Validation loss decreased (-0.653169 --> -0.658948).  Saving model ...
Epoch: 8 cost time: 3.4162096977233887
Epoch: 8, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.903 Vali Acc: 0.728 Test Loss: 0.903 Test Acc: 0.728
Validation loss decreased (-0.658948 --> -0.728315).  Saving model ...
Epoch: 9 cost time: 2.7004261016845703
Epoch: 9, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.149 Vali Acc: 0.734 Test Loss: 1.149 Test Acc: 0.734
Validation loss decreased (-0.728315 --> -0.734093).  Saving model ...
Epoch: 10 cost time: 4.081101417541504
Epoch: 10, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.499 Vali Acc: 0.723 Test Loss: 1.499 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.056439638137817
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.412 Vali Acc: 0.717 Test Loss: 1.412 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.436352968215942
Epoch: 12, Steps: 17 | Train Loss: 0.583 Vali Loss: 1.585 Vali Acc: 0.734 Test Loss: 1.585 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5641136169433594
Epoch: 13, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.167 Vali Acc: 0.780 Test Loss: 1.167 Test Acc: 0.780
Validation loss decreased (-0.734093 --> -0.780335).  Saving model ...
Epoch: 14 cost time: 3.4420392513275146
Epoch: 14, Steps: 17 | Train Loss: 0.232 Vali Loss: 1.523 Vali Acc: 0.775 Test Loss: 1.523 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.130114555358887
Epoch: 15, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.756 Vali Acc: 0.688 Test Loss: 1.756 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.935102939605713
Epoch: 16, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.322 Vali Acc: 0.769 Test Loss: 1.322 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.732747316360474
Epoch: 17, Steps: 17 | Train Loss: 0.217 Vali Loss: 2.224 Vali Acc: 0.688 Test Loss: 2.224 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.730920791625977
Epoch: 18, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.702 Vali Acc: 0.746 Test Loss: 1.702 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.958470344543457
Epoch: 19, Steps: 17 | Train Loss: 0.292 Vali Loss: 1.765 Vali Acc: 0.751 Test Loss: 1.765 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.948347330093384
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.804 Vali Acc: 0.838 Test Loss: 0.804 Test Acc: 0.838
Validation loss decreased (-0.780335 --> -0.838142).  Saving model ...
Epoch: 21 cost time: 3.356513023376465
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.301 Vali Acc: 0.769 Test Loss: 1.301 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.550950288772583
Epoch: 22, Steps: 17 | Train Loss: 0.363 Vali Loss: 1.538 Vali Acc: 0.751 Test Loss: 1.538 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7151706218719482
Epoch: 23, Steps: 17 | Train Loss: 0.231 Vali Loss: 1.193 Vali Acc: 0.763 Test Loss: 1.193 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2223927974700928
Epoch: 24, Steps: 17 | Train Loss: 0.160 Vali Loss: 2.288 Vali Acc: 0.659 Test Loss: 2.288 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3446741104125977
Epoch: 25, Steps: 17 | Train Loss: 0.099 Vali Loss: 2.262 Vali Acc: 0.711 Test Loss: 2.262 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.617467164993286
Epoch: 26, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.930 Vali Acc: 0.769 Test Loss: 1.930 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.2116382122039795
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.734 Vali Acc: 0.815 Test Loss: 1.734 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.367180824279785
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.454 Vali Acc: 0.815 Test Loss: 2.454 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.989903211593628
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.865 Vali Acc: 0.815 Test Loss: 1.865 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.7775261402130127
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.694 Vali Acc: 0.844 Test Loss: 1.694 Test Acc: 0.844
Validation loss decreased (-0.838142 --> -0.843914).  Saving model ...
Epoch: 31 cost time: 3.760481357574463
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.984 Vali Acc: 0.798 Test Loss: 1.984 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.8931093215942383
Epoch: 32, Steps: 17 | Train Loss: 0.417 Vali Loss: 2.565 Vali Acc: 0.798 Test Loss: 2.565 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5284528732299805
Epoch: 33, Steps: 17 | Train Loss: 0.126 Vali Loss: 2.661 Vali Acc: 0.746 Test Loss: 2.661 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.1467387676239014
Epoch: 34, Steps: 17 | Train Loss: 0.281 Vali Loss: 3.085 Vali Acc: 0.694 Test Loss: 3.085 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.521223783493042
Epoch: 35, Steps: 17 | Train Loss: 0.249 Vali Loss: 4.040 Vali Acc: 0.711 Test Loss: 4.040 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.692368984222412
Epoch: 36, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.942 Vali Acc: 0.821 Test Loss: 1.942 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.872137784957886
Epoch: 37, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.150 Vali Acc: 0.855 Test Loss: 1.150 Test Acc: 0.855
Validation loss decreased (-0.843914 --> -0.855480).  Saving model ...
Epoch: 38 cost time: 4.663396596908569
Epoch: 38, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.708 Vali Acc: 0.821 Test Loss: 1.708 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.402158975601196
Epoch: 39, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.542 Vali Acc: 0.786 Test Loss: 2.542 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.981985569000244
Epoch: 40, Steps: 17 | Train Loss: 0.026 Vali Loss: 3.508 Vali Acc: 0.780 Test Loss: 3.508 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.7849292755126953
Epoch: 41, Steps: 17 | Train Loss: 0.170 Vali Loss: 3.780 Vali Acc: 0.734 Test Loss: 3.780 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.383023500442505
Epoch: 42, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.093 Vali Acc: 0.838 Test Loss: 2.093 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.9512083530426025
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.821 Test Loss: 1.749 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 4.342289686203003
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.833 Vali Acc: 0.827 Test Loss: 1.833 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 4.743665933609009
Epoch: 45, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.787 Vali Acc: 0.827 Test Loss: 1.787 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 4.654527187347412
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.026 Vali Acc: 0.786 Test Loss: 2.026 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 4.150079727172852
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.471 Vali Acc: 0.821 Test Loss: 2.471 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 59388679
model size : 241.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.734135389328003
Epoch: 1, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.684 Vali Acc: 0.277 Test Loss: 1.684 Test Acc: 0.277
Validation loss decreased (inf --> -0.277440).  Saving model ...
Epoch: 2 cost time: 3.317577838897705
Epoch: 2, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.084 Vali Acc: 0.532 Test Loss: 1.084 Test Acc: 0.532
Validation loss decreased (-0.277440 --> -0.531781).  Saving model ...
Epoch: 3 cost time: 3.2503609657287598
Epoch: 3, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.097 Vali Acc: 0.549 Test Loss: 1.097 Test Acc: 0.549
Validation loss decreased (-0.531781 --> -0.549122).  Saving model ...
Epoch: 4 cost time: 2.5158188343048096
Epoch: 4, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.993 Vali Acc: 0.665 Test Loss: 0.993 Test Acc: 0.665
Validation loss decreased (-0.549122 --> -0.664730).  Saving model ...
Epoch: 5 cost time: 2.665658950805664
Epoch: 5, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.650 Vali Acc: 0.786 Test Loss: 0.650 Test Acc: 0.786
Validation loss decreased (-0.664730 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 3.80981707572937
Epoch: 6, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.717 Vali Acc: 0.740 Test Loss: 0.717 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8855478763580322
Epoch: 7, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.635 Vali Acc: 0.769 Test Loss: 0.635 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9339170455932617
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.291 Vali Acc: 0.682 Test Loss: 1.291 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.183138370513916
Epoch: 9, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.724 Vali Acc: 0.827 Test Loss: 0.724 Test Acc: 0.827
Validation loss decreased (-0.786121 --> -0.826582).  Saving model ...
Epoch: 10 cost time: 3.785538673400879
Epoch: 10, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.584 Vali Acc: 0.827 Test Loss: 0.584 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826584).  Saving model ...
Epoch: 11 cost time: 3.513288974761963
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.980 Vali Acc: 0.786 Test Loss: 0.980 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.677870035171509
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.887 Vali Acc: 0.780 Test Loss: 0.887 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4111168384552
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.917 Vali Acc: 0.786 Test Loss: 0.917 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.596447229385376
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.946 Vali Acc: 0.786 Test Loss: 0.946 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7016243934631348
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.838 Test Loss: 0.768 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838143).  Saving model ...
Epoch: 16 cost time: 2.7114644050598145
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.012 Vali Acc: 0.792 Test Loss: 1.012 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.085996150970459
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.721 Vali Acc: 0.815 Test Loss: 0.721 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.385751247406006
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.833 Vali Acc: 0.821 Test Loss: 0.833 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.637052536010742
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.216 Vali Acc: 0.798 Test Loss: 1.216 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6576762199401855
Epoch: 20, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.055 Vali Acc: 0.792 Test Loss: 1.055 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.5047664642333984
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.145 Vali Acc: 0.763 Test Loss: 1.145 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2816312313079834
Epoch: 22, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.243 Vali Acc: 0.775 Test Loss: 1.243 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.5099592208862305
Epoch: 23, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.831 Vali Acc: 0.809 Test Loss: 0.831 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.57794451713562
Epoch: 24, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.139 Vali Acc: 0.844 Test Loss: 1.139 Test Acc: 0.844
Validation loss decreased (-0.838143 --> -0.843919).  Saving model ...
Epoch: 25 cost time: 2.0266671180725098
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.155 Vali Acc: 0.798 Test Loss: 1.155 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9640278816223145
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.824 Vali Acc: 0.821 Test Loss: 0.824 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8251798152923584
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.492 Vali Acc: 0.763 Test Loss: 1.492 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.761115789413452
Epoch: 28, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.494 Vali Acc: 0.763 Test Loss: 1.494 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.839669942855835
Epoch: 29, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.201 Vali Acc: 0.815 Test Loss: 1.201 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.4915759563446045
Epoch: 30, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.444 Vali Acc: 0.815 Test Loss: 1.444 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.544414520263672
Epoch: 31, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.103 Vali Acc: 0.832 Test Loss: 1.103 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.5490105152130127
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.292 Vali Acc: 0.832 Test Loss: 1.292 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.1857869625091553
Epoch: 33, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.605 Vali Acc: 0.803 Test Loss: 1.605 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.8764283657073975
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.850 Test Loss: 1.841 Test Acc: 0.850
Validation loss decreased (-0.843919 --> -0.849693).  Saving model ...
Epoch: 35 cost time: 2.987673044204712
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.323 Vali Acc: 0.798 Test Loss: 2.323 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.452651023864746
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.273 Vali Acc: 0.821 Test Loss: 2.273 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.812711715698242
Epoch: 37, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.820 Vali Acc: 0.815 Test Loss: 1.820 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.099900484085083
Epoch: 38, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.075 Vali Acc: 0.827 Test Loss: 2.075 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.366365909576416
Epoch: 39, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.080 Vali Acc: 0.809 Test Loss: 2.080 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.9514832496643066
Epoch: 40, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.661 Vali Acc: 0.844 Test Loss: 1.661 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.607924222946167
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.730 Vali Acc: 0.838 Test Loss: 1.730 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.1934399604797363
Epoch: 42, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.825 Vali Acc: 0.827 Test Loss: 1.825 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.4232561588287354
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.111 Vali Acc: 0.809 Test Loss: 2.111 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.184122085571289
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.850 Test Loss: 1.670 Test Acc: 0.850
Validation loss decreased (-0.849693 --> -0.849694).  Saving model ...
Epoch: 45 cost time: 3.9315133094787598
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.832 Test Loss: 1.753 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.024871349334717
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.815 Test Loss: 1.775 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.5995900630950928
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.815 Test Loss: 1.766 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.828012704849243
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.821 Test Loss: 1.758 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.3079752922058105
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.821 Test Loss: 1.756 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.5245885848999023
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.827 Test Loss: 1.746 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 59153671
model size : 240.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.777606248855591
Epoch: 1, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.563 Vali Acc: 0.341 Test Loss: 1.563 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 2.740701675415039
Epoch: 2, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.249 Vali Acc: 0.503 Test Loss: 1.249 Test Acc: 0.503
Validation loss decreased (-0.341025 --> -0.502878).  Saving model ...
Epoch: 3 cost time: 2.6912474632263184
Epoch: 3, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.991 Vali Acc: 0.618 Test Loss: 0.991 Test Acc: 0.618
Validation loss decreased (-0.502878 --> -0.618487).  Saving model ...
Epoch: 4 cost time: 3.149486780166626
Epoch: 4, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.761 Vali Acc: 0.653 Test Loss: 0.761 Test Acc: 0.653
Validation loss decreased (-0.618487 --> -0.653172).  Saving model ...
Epoch: 5 cost time: 3.2011892795562744
Epoch: 5, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.746 Vali Acc: 0.740 Test Loss: 0.746 Test Acc: 0.740
Validation loss decreased (-0.653172 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 2.1611461639404297
Epoch: 6, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.724 Vali Acc: 0.734 Test Loss: 0.724 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2264981269836426
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.038 Vali Acc: 0.717 Test Loss: 1.038 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4446964263916016
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
Validation loss decreased (-0.739877 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 3.3837952613830566
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2240052223205566
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.843 Vali Acc: 0.775 Test Loss: 0.843 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.221184492111206
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.475 Vali Acc: 0.838 Test Loss: 0.475 Test Acc: 0.838
Validation loss decreased (-0.803462 --> -0.838146).  Saving model ...
Epoch: 12 cost time: 2.476797580718994
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.754 Vali Acc: 0.746 Test Loss: 0.754 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.719741106033325
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9637584686279297
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.728 Vali Acc: 0.821 Test Loss: 0.728 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2168970108032227
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.719 Vali Acc: 0.792 Test Loss: 0.719 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6164393424987793
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.938 Vali Acc: 0.757 Test Loss: 0.938 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.599038600921631
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.867 Vali Acc: 0.786 Test Loss: 0.867 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.738636016845703
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.213 Vali Acc: 0.751 Test Loss: 1.213 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.4233131408691406
Epoch: 19, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.997 Vali Acc: 0.763 Test Loss: 0.997 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.1794474124908447
Epoch: 20, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.007 Vali Acc: 0.798 Test Loss: 1.007 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.017738580703735
Epoch: 21, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.893 Vali Acc: 0.757 Test Loss: 1.893 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 59049991
model size : 239.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.7805116176605225
Epoch: 1, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.537 Vali Acc: 0.295 Test Loss: 1.537 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 3.825634479522705
Epoch: 2, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.754 Vali Acc: 0.416 Test Loss: 1.754 Test Acc: 0.416
Validation loss decreased (-0.294782 --> -0.416167).  Saving model ...
Epoch: 3 cost time: 2.2131290435791016
Epoch: 3, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.050 Vali Acc: 0.595 Test Loss: 1.050 Test Acc: 0.595
Validation loss decreased (-0.416167 --> -0.595365).  Saving model ...
Epoch: 4 cost time: 4.4846155643463135
Epoch: 4, Steps: 17 | Train Loss: 0.632 Vali Loss: 1.048 Vali Acc: 0.676 Test Loss: 1.048 Test Acc: 0.676
Validation loss decreased (-0.595365 --> -0.676290).  Saving model ...
Epoch: 5 cost time: 3.5052995681762695
Epoch: 5, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
Validation loss decreased (-0.676290 --> -0.716755).  Saving model ...
Epoch: 6 cost time: 4.234140157699585
Epoch: 6, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.596 Vali Acc: 0.659 Test Loss: 1.596 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1957614421844482
Epoch: 7, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.758 Vali Acc: 0.757 Test Loss: 0.758 Test Acc: 0.757
Validation loss decreased (-0.716755 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 4.666548728942871
Epoch: 8, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.934 Vali Acc: 0.688 Test Loss: 0.934 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.131415605545044
Epoch: 9, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.635 Vali Acc: 0.705 Test Loss: 1.635 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.46040415763855
Epoch: 10, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.081 Vali Acc: 0.763 Test Loss: 1.081 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762995).  Saving model ...
Epoch: 11 cost time: 3.218315839767456
Epoch: 11, Steps: 17 | Train Loss: 0.191 Vali Loss: 1.119 Vali Acc: 0.763 Test Loss: 1.119 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.440918445587158
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.299 Vali Acc: 0.763 Test Loss: 1.299 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.706385850906372
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 3.492 Vali Acc: 0.624 Test Loss: 3.492 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.469649791717529
Epoch: 14, Steps: 17 | Train Loss: 0.560 Vali Loss: 1.632 Vali Acc: 0.699 Test Loss: 1.632 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.588671922683716
Epoch: 15, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.738 Vali Acc: 0.838 Test Loss: 0.738 Test Acc: 0.838
Validation loss decreased (-0.762995 --> -0.838143).  Saving model ...
Epoch: 16 cost time: 4.477423906326294
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.151 Vali Acc: 0.821 Test Loss: 1.151 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.55135440826416
Epoch: 17, Steps: 17 | Train Loss: 0.121 Vali Loss: 1.224 Vali Acc: 0.803 Test Loss: 1.224 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.157413721084595
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.254 Vali Acc: 0.798 Test Loss: 1.254 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.509861946105957
Epoch: 19, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.712 Vali Acc: 0.740 Test Loss: 1.712 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.576754570007324
Epoch: 20, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.138 Vali Acc: 0.832 Test Loss: 1.138 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.493868350982666
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.576 Vali Acc: 0.803 Test Loss: 1.576 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.687956809997559
Epoch: 22, Steps: 17 | Train Loss: 0.075 Vali Loss: 2.654 Vali Acc: 0.723 Test Loss: 2.654 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.575106143951416
Epoch: 23, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.273 Vali Acc: 0.827 Test Loss: 1.273 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.203857898712158
Epoch: 24, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.833 Vali Acc: 0.786 Test Loss: 1.833 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.259994745254517
Epoch: 25, Steps: 17 | Train Loss: 0.060 Vali Loss: 2.625 Vali Acc: 0.763 Test Loss: 2.625 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 61607431
model size : 249.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.3295981884002686
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.393 Vali Acc: 0.572 Test Loss: 1.393 Test Acc: 0.572
Validation loss decreased (inf --> -0.572240).  Saving model ...
Epoch: 2 cost time: 3.2740235328674316
Epoch: 2, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.183 Vali Acc: 0.532 Test Loss: 1.183 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.993739128112793
Epoch: 3, Steps: 17 | Train Loss: 1.082 Vali Loss: 0.996 Vali Acc: 0.653 Test Loss: 0.996 Test Acc: 0.653
Validation loss decreased (-0.572240 --> -0.653169).  Saving model ...
Epoch: 4 cost time: 3.2431914806365967
Epoch: 4, Steps: 17 | Train Loss: 0.702 Vali Loss: 0.780 Vali Acc: 0.699 Test Loss: 0.780 Test Acc: 0.699
Validation loss decreased (-0.653169 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 3.2869882583618164
Epoch: 5, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.992 Vali Acc: 0.671 Test Loss: 0.992 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3012049198150635
Epoch: 6, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.711 Vali Acc: 0.746 Test Loss: 0.711 Test Acc: 0.746
Validation loss decreased (-0.699414 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 3.3450353145599365
Epoch: 7, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.885 Vali Acc: 0.694 Test Loss: 0.885 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3709495067596436
Epoch: 8, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.953 Vali Acc: 0.740 Test Loss: 0.953 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4335601329803467
Epoch: 9, Steps: 17 | Train Loss: 0.198 Vali Loss: 1.190 Vali Acc: 0.740 Test Loss: 1.190 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.943059206008911
Epoch: 10, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.486 Vali Acc: 0.867 Test Loss: 0.486 Test Acc: 0.867
Validation loss decreased (-0.745658 --> -0.867047).  Saving model ...
Epoch: 11 cost time: 2.5516207218170166
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.061 Vali Acc: 0.803 Test Loss: 1.061 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7551517486572266
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.957 Vali Acc: 0.827 Test Loss: 0.957 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5145680904388428
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.512 Vali Acc: 0.786 Test Loss: 1.512 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.517245054244995
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.682 Vali Acc: 0.803 Test Loss: 1.682 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.484198570251465
Epoch: 15, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.861 Vali Acc: 0.827 Test Loss: 0.861 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.1066839694976807
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.433086395263672
Epoch: 17, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.941 Vali Acc: 0.821 Test Loss: 0.941 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9195525646209717
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.019 Vali Acc: 0.803 Test Loss: 1.019 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3887929916381836
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.516 Vali Acc: 0.798 Test Loss: 1.516 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.653794050216675
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.253 Vali Acc: 0.769 Test Loss: 1.253 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 61372423
model size : 248.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.381758451461792
Epoch: 1, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.527 Vali Acc: 0.405 Test Loss: 1.527 Test Acc: 0.405
Validation loss decreased (inf --> -0.404609).  Saving model ...
Epoch: 2 cost time: 3.380671262741089
Epoch: 2, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.279 Vali Acc: 0.561 Test Loss: 1.279 Test Acc: 0.561
Validation loss decreased (-0.404609 --> -0.560681).  Saving model ...
Epoch: 3 cost time: 2.7320919036865234
Epoch: 3, Steps: 17 | Train Loss: 1.004 Vali Loss: 0.891 Vali Acc: 0.682 Test Loss: 0.891 Test Acc: 0.682
Validation loss decreased (-0.560681 --> -0.682072).  Saving model ...
Epoch: 4 cost time: 2.6701228618621826
Epoch: 4, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.747 Vali Acc: 0.688 Test Loss: 0.747 Test Acc: 0.688
Validation loss decreased (-0.682072 --> -0.687854).  Saving model ...
Epoch: 5 cost time: 2.6741549968719482
Epoch: 5, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.976 Vali Acc: 0.636 Test Loss: 0.976 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.86159086227417
Epoch: 6, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.821 Vali Acc: 0.688 Test Loss: 0.821 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7179672718048096
Epoch: 7, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.818 Vali Acc: 0.682 Test Loss: 0.818 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8724939823150635
Epoch: 8, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
Validation loss decreased (-0.687854 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 3.6818833351135254
Epoch: 9, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.956 Vali Acc: 0.699 Test Loss: 0.956 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6766486167907715
Epoch: 10, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.728 Vali Acc: 0.780 Test Loss: 0.728 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4484267234802246
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.844 Vali Acc: 0.798 Test Loss: 0.844 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.435183525085449
Epoch: 12, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.769 Vali Acc: 0.792 Test Loss: 0.769 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.912966251373291
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.780 Vali Acc: 0.798 Test Loss: 0.780 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2596776485443115
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.855 Test Loss: 0.644 Test Acc: 0.855
Validation loss decreased (-0.803463 --> -0.855485).  Saving model ...
Epoch: 15 cost time: 2.9469656944274902
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.815 Test Loss: 0.774 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7288177013397217
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.242 Vali Acc: 0.734 Test Loss: 1.242 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0676302909851074
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.675 Vali Acc: 0.792 Test Loss: 0.675 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1594085693359375
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.745 Vali Acc: 0.786 Test Loss: 0.745 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0001420974731445
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.968 Vali Acc: 0.769 Test Loss: 0.968 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.499598741531372
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.064030408859253
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.544 Vali Acc: 0.734 Test Loss: 1.544 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.1225945949554443
Epoch: 22, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.576 Vali Acc: 0.757 Test Loss: 1.576 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.388455867767334
Epoch: 23, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.812 Vali Acc: 0.723 Test Loss: 1.812 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2678699493408203
Epoch: 24, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.780 Vali Acc: 0.786 Test Loss: 0.780 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 61254919
model size : 248.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.965070962905884
Epoch: 1, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.621 Vali Acc: 0.416 Test Loss: 1.621 Test Acc: 0.416
Validation loss decreased (inf --> -0.416169).  Saving model ...
Epoch: 2 cost time: 3.6281228065490723
Epoch: 2, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.521 Vali Acc: 0.405 Test Loss: 1.521 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.869438648223877
Epoch: 3, Steps: 17 | Train Loss: 0.839 Vali Loss: 0.903 Vali Acc: 0.601 Test Loss: 0.903 Test Acc: 0.601
Validation loss decreased (-0.416169 --> -0.601147).  Saving model ...
Epoch: 4 cost time: 3.9404847621917725
Epoch: 4, Steps: 17 | Train Loss: 0.579 Vali Loss: 1.063 Vali Acc: 0.613 Test Loss: 1.063 Test Acc: 0.613
Validation loss decreased (-0.601147 --> -0.612706).  Saving model ...
Epoch: 5 cost time: 3.4536232948303223
Epoch: 5, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.972 Vali Acc: 0.630 Test Loss: 0.972 Test Acc: 0.630
Validation loss decreased (-0.612706 --> -0.630048).  Saving model ...
Epoch: 6 cost time: 2.57429575920105
Epoch: 6, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.902 Vali Acc: 0.751 Test Loss: 0.902 Test Acc: 0.751
Validation loss decreased (-0.630048 --> -0.751436).  Saving model ...
Epoch: 7 cost time: 3.383230209350586
Epoch: 7, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.991 Vali Acc: 0.763 Test Loss: 0.991 Test Acc: 0.763
Validation loss decreased (-0.751436 --> -0.762996).  Saving model ...
Epoch: 8 cost time: 3.939213991165161
Epoch: 8, Steps: 17 | Train Loss: 0.285 Vali Loss: 1.079 Vali Acc: 0.734 Test Loss: 1.079 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.127047300338745
Epoch: 9, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.925 Vali Acc: 0.723 Test Loss: 0.925 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.420640468597412
Epoch: 10, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.325 Vali Acc: 0.659 Test Loss: 1.325 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.675402879714966
Epoch: 11, Steps: 17 | Train Loss: 0.361 Vali Loss: 1.401 Vali Acc: 0.751 Test Loss: 1.401 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7740683555603027
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.121 Vali Acc: 0.786 Test Loss: 1.121 Test Acc: 0.786
Validation loss decreased (-0.762996 --> -0.786116).  Saving model ...
Epoch: 13 cost time: 4.914863109588623
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.127 Vali Acc: 0.780 Test Loss: 1.127 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.763791084289551
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.293 Vali Acc: 0.740 Test Loss: 1.293 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.882002592086792
Epoch: 15, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.206 Vali Acc: 0.786 Test Loss: 1.206 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6055052280426025
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.980 Vali Acc: 0.798 Test Loss: 0.980 Test Acc: 0.798
Validation loss decreased (-0.786116 --> -0.797678).  Saving model ...
Epoch: 17 cost time: 4.403550863265991
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.165 Vali Acc: 0.827 Test Loss: 1.165 Test Acc: 0.827
Validation loss decreased (-0.797678 --> -0.826578).  Saving model ...
Epoch: 18 cost time: 3.8673977851867676
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.777 Vali Acc: 0.775 Test Loss: 1.777 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9416849613189697
Epoch: 19, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.591 Vali Acc: 0.734 Test Loss: 1.591 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0383448600769043
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.472 Vali Acc: 0.815 Test Loss: 1.472 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2329843044281006
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.497 Vali Acc: 0.786 Test Loss: 1.497 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4391117095947266
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.171 Vali Acc: 0.832 Test Loss: 1.171 Test Acc: 0.832
Validation loss decreased (-0.826578 --> -0.832358).  Saving model ...
Epoch: 23 cost time: 4.422652006149292
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.257 Vali Acc: 0.803 Test Loss: 1.257 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.1718034744262695
Epoch: 24, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.149 Vali Acc: 0.786 Test Loss: 1.149 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.404863595962524
Epoch: 25, Steps: 17 | Train Loss: 0.072 Vali Loss: 2.158 Vali Acc: 0.734 Test Loss: 2.158 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.551706075668335
Epoch: 26, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.163 Vali Acc: 0.792 Test Loss: 1.163 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.380685567855835
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.628 Vali Acc: 0.786 Test Loss: 1.628 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.503081798553467
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.533 Vali Acc: 0.751 Test Loss: 1.533 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.76705265045166
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.985 Vali Acc: 0.740 Test Loss: 1.985 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.706098794937134
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.556 Vali Acc: 0.815 Test Loss: 1.556 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.641129732131958
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.792 Test Loss: 1.254 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.370398759841919
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.809 Test Loss: 1.060 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 63667207
model size : 257.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.853387355804443
Epoch: 1, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.528 Vali Acc: 0.277 Test Loss: 1.528 Test Acc: 0.277
Validation loss decreased (inf --> -0.277441).  Saving model ...
Epoch: 2 cost time: 2.8601536750793457
Epoch: 2, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.012 Vali Acc: 0.613 Test Loss: 1.012 Test Acc: 0.613
Validation loss decreased (-0.277441 --> -0.612707).  Saving model ...
Epoch: 3 cost time: 3.9461159706115723
Epoch: 3, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.879 Vali Acc: 0.676 Test Loss: 0.879 Test Acc: 0.676
Validation loss decreased (-0.612707 --> -0.676292).  Saving model ...
Epoch: 4 cost time: 4.3772807121276855
Epoch: 4, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.772 Vali Acc: 0.734 Test Loss: 0.772 Test Acc: 0.734
Validation loss decreased (-0.676292 --> -0.734096).  Saving model ...
Epoch: 5 cost time: 4.134044170379639
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.891 Vali Acc: 0.757 Test Loss: 0.891 Test Acc: 0.757
Validation loss decreased (-0.734096 --> -0.757217).  Saving model ...
Epoch: 6 cost time: 3.7320659160614014
Epoch: 6, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.709 Vali Acc: 0.786 Test Loss: 0.709 Test Acc: 0.786
Validation loss decreased (-0.757217 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 3.6995158195495605
Epoch: 7, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7871499061584473
Epoch: 8, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.325 Vali Acc: 0.694 Test Loss: 1.325 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.112562894821167
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.769 Vali Acc: 0.792 Test Loss: 0.769 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791900).  Saving model ...
Epoch: 10 cost time: 2.6196024417877197
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
Validation loss decreased (-0.791900 --> -0.803461).  Saving model ...
Epoch: 11 cost time: 2.6508474349975586
Epoch: 11, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.676 Vali Acc: 0.711 Test Loss: 1.676 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0822665691375732
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.533 Vali Acc: 0.728 Test Loss: 1.533 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.885524272918701
Epoch: 13, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.802 Vali Acc: 0.803 Test Loss: 0.802 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.760256290435791
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.689 Vali Acc: 0.757 Test Loss: 1.689 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.978131055831909
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.833 Vali Acc: 0.723 Test Loss: 1.833 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.9675254821777344
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.078 Vali Acc: 0.763 Test Loss: 1.078 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.981693744659424
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.576 Vali Acc: 0.757 Test Loss: 1.576 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.6347601413726807
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.820 Vali Acc: 0.740 Test Loss: 1.820 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3791298866271973
Epoch: 19, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.689 Vali Acc: 0.763 Test Loss: 1.689 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.516592025756836
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.077 Vali Acc: 0.798 Test Loss: 1.077 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 63542791
model size : 257.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.778299331665039
Epoch: 1, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.551 Vali Acc: 0.260 Test Loss: 1.551 Test Acc: 0.260
Validation loss decreased (inf --> -0.260100).  Saving model ...
Epoch: 2 cost time: 2.6694889068603516
Epoch: 2, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.189 Vali Acc: 0.538 Test Loss: 1.189 Test Acc: 0.538
Validation loss decreased (-0.260100 --> -0.537560).  Saving model ...
Epoch: 3 cost time: 2.79254150390625
Epoch: 3, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.877 Vali Acc: 0.618 Test Loss: 0.877 Test Acc: 0.618
Validation loss decreased (-0.537560 --> -0.618488).  Saving model ...
Epoch: 4 cost time: 3.7720108032226562
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.648 Vali Acc: 0.792 Test Loss: 0.648 Test Acc: 0.792
Validation loss decreased (-0.618488 --> -0.791901).  Saving model ...
Epoch: 5 cost time: 2.8525161743164062
Epoch: 5, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7567660808563232
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9985251426696777
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.619 Vali Acc: 0.780 Test Loss: 0.619 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.172245740890503
Epoch: 8, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.803 Vali Acc: 0.751 Test Loss: 0.803 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.406325578689575
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.131 Vali Acc: 0.734 Test Loss: 1.131 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4487497806549072
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.845 Vali Acc: 0.751 Test Loss: 0.845 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6807777881622314
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.961 Vali Acc: 0.757 Test Loss: 0.961 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.5719234943389893
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.746 Vali Acc: 0.815 Test Loss: 0.746 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815021).  Saving model ...
Epoch: 13 cost time: 2.3449506759643555
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.652 Vali Acc: 0.815 Test Loss: 0.652 Test Acc: 0.815
Validation loss decreased (-0.815021 --> -0.815022).  Saving model ...
Epoch: 14 cost time: 2.9313199520111084
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.855 Vali Acc: 0.803 Test Loss: 0.855 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3078408241271973
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.780 Test Loss: 0.843 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.161684274673462
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.815 Test Loss: 0.797 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.207787275314331
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.815 Test Loss: 0.854 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6120059490203857
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.803 Test Loss: 0.852 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8332366943359375
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.803 Test Loss: 0.871 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.935365915298462
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.809 Test Loss: 0.891 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.143922805786133
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.815 Test Loss: 0.890 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4615747928619385
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.809 Test Loss: 0.876 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5597686767578125
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.809 Test Loss: 0.872 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 63459847
model size : 256.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.101487398147583
Epoch: 1, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.529 Vali Acc: 0.353 Test Loss: 1.529 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 4.313549041748047
Epoch: 2, Steps: 17 | Train Loss: 1.178 Vali Loss: 1.261 Vali Acc: 0.457 Test Loss: 1.261 Test Acc: 0.457
Validation loss decreased (-0.352586 --> -0.456635).  Saving model ...
Epoch: 3 cost time: 4.2493298053741455
Epoch: 3, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.959 Vali Acc: 0.630 Test Loss: 0.959 Test Acc: 0.630
Validation loss decreased (-0.456635 --> -0.630048).  Saving model ...
Epoch: 4 cost time: 3.4831252098083496
Epoch: 4, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.411 Vali Acc: 0.578 Test Loss: 1.411 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.45560622215271
Epoch: 5, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.815 Vali Acc: 0.671 Test Loss: 0.815 Test Acc: 0.671
Validation loss decreased (-0.630048 --> -0.670512).  Saving model ...
Epoch: 6 cost time: 3.2740468978881836
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
Validation loss decreased (-0.670512 --> -0.774558).  Saving model ...
Epoch: 7 cost time: 3.2775039672851562
Epoch: 7, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.701 Vali Acc: 0.751 Test Loss: 0.701 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.045625686645508
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.889 Vali Acc: 0.780 Test Loss: 0.889 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780338).  Saving model ...
Epoch: 9 cost time: 4.195511817932129
Epoch: 9, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.176 Vali Acc: 0.723 Test Loss: 1.176 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.021723508834839
Epoch: 10, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.150 Vali Acc: 0.746 Test Loss: 1.150 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.316907644271851
Epoch: 11, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.051 Vali Acc: 0.792 Test Loss: 1.051 Test Acc: 0.792
Validation loss decreased (-0.780338 --> -0.791897).  Saving model ...
Epoch: 12 cost time: 4.130397319793701
Epoch: 12, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.111 Vali Acc: 0.728 Test Loss: 1.111 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7574970722198486
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.424 Vali Acc: 0.775 Test Loss: 1.424 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.717907190322876
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.088 Vali Acc: 0.798 Test Loss: 1.088 Test Acc: 0.798
Validation loss decreased (-0.791897 --> -0.797677).  Saving model ...
Epoch: 15 cost time: 3.3811824321746826
Epoch: 15, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.781 Vali Acc: 0.763 Test Loss: 1.781 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5247411727905273
Epoch: 16, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.313 Vali Acc: 0.775 Test Loss: 1.313 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7751102447509766
Epoch: 17, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.009 Vali Acc: 0.786 Test Loss: 1.009 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6810693740844727
Epoch: 18, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.294 Vali Acc: 0.786 Test Loss: 1.294 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1370105743408203
Epoch: 19, Steps: 17 | Train Loss: 0.086 Vali Loss: 2.033 Vali Acc: 0.769 Test Loss: 2.033 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.093517780303955
Epoch: 20, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.638 Vali Acc: 0.763 Test Loss: 1.638 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1457958221435547
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.131 Vali Acc: 0.809 Test Loss: 1.131 Test Acc: 0.809
Validation loss decreased (-0.797677 --> -0.809237).  Saving model ...
Epoch: 22 cost time: 3.412881374359131
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.297 Vali Acc: 0.803 Test Loss: 1.297 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6195294857025146
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.487 Vali Acc: 0.844 Test Loss: 1.487 Test Acc: 0.844
Validation loss decreased (-0.809237 --> -0.843916).  Saving model ...
Epoch: 24 cost time: 3.1281609535217285
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.212 Vali Acc: 0.786 Test Loss: 1.212 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3512728214263916
Epoch: 25, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.920 Vali Acc: 0.751 Test Loss: 1.920 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.315617799758911
Epoch: 26, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.646 Vali Acc: 0.827 Test Loss: 1.646 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.300321102142334
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.710 Vali Acc: 0.798 Test Loss: 1.710 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.299891471862793
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.868 Vali Acc: 0.792 Test Loss: 1.868 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.5042364597320557
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.302 Vali Acc: 0.734 Test Loss: 2.302 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.4466552734375
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.924 Vali Acc: 0.821 Test Loss: 1.924 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.4182560443878174
Epoch: 31, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.738 Vali Acc: 0.786 Test Loss: 1.738 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.6738898754119873
Epoch: 32, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.499 Vali Acc: 0.827 Test Loss: 1.499 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.7497360706329346
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.097 Vali Acc: 0.775 Test Loss: 2.097 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 65879047
model size : 265.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.25284743309021
Epoch: 1, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.436 Vali Acc: 0.497 Test Loss: 1.436 Test Acc: 0.497
Validation loss decreased (inf --> -0.497095).  Saving model ...
Epoch: 2 cost time: 2.849916696548462
Epoch: 2, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.114 Vali Acc: 0.566 Test Loss: 1.114 Test Acc: 0.566
Validation loss decreased (-0.497095 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 3.2745580673217773
Epoch: 3, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.301 Vali Acc: 0.509 Test Loss: 1.301 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4036529064178467
Epoch: 4, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.820 Vali Acc: 0.705 Test Loss: 0.820 Test Acc: 0.705
Validation loss decreased (-0.566463 --> -0.705194).  Saving model ...
Epoch: 5 cost time: 3.448537826538086
Epoch: 5, Steps: 17 | Train Loss: 0.544 Vali Loss: 1.187 Vali Acc: 0.566 Test Loss: 1.187 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.239530563354492
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.680 Vali Acc: 0.769 Test Loss: 0.680 Test Acc: 0.769
Validation loss decreased (-0.705194 --> -0.768779).  Saving model ...
Epoch: 7 cost time: 3.028435468673706
Epoch: 7, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.538 Vali Acc: 0.792 Test Loss: 0.538 Test Acc: 0.792
Validation loss decreased (-0.768779 --> -0.791902).  Saving model ...
Epoch: 8 cost time: 3.7933809757232666
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.886 Vali Acc: 0.757 Test Loss: 0.886 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9992220401763916
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.544 Vali Acc: 0.798 Test Loss: 0.544 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 4.262723684310913
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.820 Vali Acc: 0.786 Test Loss: 0.820 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6818108558654785
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.613 Vali Acc: 0.653 Test Loss: 1.613 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.176830291748047
Epoch: 12, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7942886352539062
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.721 Vali Acc: 0.827 Test Loss: 0.721 Test Acc: 0.827
Validation loss decreased (-0.797682 --> -0.826582).  Saving model ...
Epoch: 14 cost time: 3.177001714706421
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.960 Vali Acc: 0.815 Test Loss: 0.960 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6988906860351562
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.103 Vali Acc: 0.763 Test Loss: 1.103 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.148097276687622
Epoch: 16, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.884 Vali Acc: 0.740 Test Loss: 1.884 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.626502513885498
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.601 Vali Acc: 0.832 Test Loss: 0.601 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832364).  Saving model ...
Epoch: 18 cost time: 2.758829116821289
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.832 Test Loss: 0.660 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.771791458129883
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.908 Vali Acc: 0.821 Test Loss: 0.908 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4913392066955566
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.647 Vali Acc: 0.832 Test Loss: 0.647 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1349520683288574
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.815 Test Loss: 0.719 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2435271739959717
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.783 Vali Acc: 0.803 Test Loss: 0.783 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.119926691055298
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.001 Vali Acc: 0.792 Test Loss: 1.001 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2230777740478516
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.079 Vali Acc: 0.792 Test Loss: 1.079 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.4121689796447754
Epoch: 25, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.008 Vali Acc: 0.821 Test Loss: 1.008 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.2149760723114014
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.397 Vali Acc: 0.751 Test Loss: 1.397 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.811368465423584
Epoch: 27, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.023 Vali Acc: 0.803 Test Loss: 1.023 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 65754631
model size : 265.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.411925315856934
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.619 Vali Acc: 0.254 Test Loss: 1.619 Test Acc: 0.254
Validation loss decreased (inf --> -0.254319).  Saving model ...
Epoch: 2 cost time: 2.480914354324341
Epoch: 2, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.332 Vali Acc: 0.416 Test Loss: 1.332 Test Acc: 0.416
Validation loss decreased (-0.254319 --> -0.416172).  Saving model ...
Epoch: 3 cost time: 2.7975220680236816
Epoch: 3, Steps: 17 | Train Loss: 1.049 Vali Loss: 0.926 Vali Acc: 0.636 Test Loss: 0.926 Test Acc: 0.636
Validation loss decreased (-0.416172 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 2.515106678009033
Epoch: 4, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.803 Vali Acc: 0.699 Test Loss: 0.803 Test Acc: 0.699
Validation loss decreased (-0.635829 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 2.8065316677093506
Epoch: 5, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.717 Vali Acc: 0.723 Test Loss: 0.717 Test Acc: 0.723
Validation loss decreased (-0.699414 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 2.77909255027771
Epoch: 6, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.829 Vali Acc: 0.723 Test Loss: 0.829 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4636032581329346
Epoch: 7, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.871 Vali Acc: 0.705 Test Loss: 0.871 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4411637783050537
Epoch: 8, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.852 Vali Acc: 0.711 Test Loss: 0.852 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.637505054473877
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
Validation loss decreased (-0.722536 --> -0.803463).  Saving model ...
Epoch: 10 cost time: 3.234753370285034
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.930 Vali Acc: 0.746 Test Loss: 0.930 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9971954822540283
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809242).  Saving model ...
Epoch: 12 cost time: 3.1795427799224854
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809242).  Saving model ...
Epoch: 13 cost time: 3.4001083374023438
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.933 Vali Acc: 0.775 Test Loss: 0.933 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3813955783843994
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.219 Vali Acc: 0.780 Test Loss: 1.219 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3321571350097656
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.817 Vali Acc: 0.815 Test Loss: 0.817 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815021).  Saving model ...
Epoch: 16 cost time: 3.083946943283081
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.574 Vali Acc: 0.751 Test Loss: 1.574 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.973768711090088
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.824 Vali Acc: 0.751 Test Loss: 0.824 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.316879987716675
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.802 Vali Acc: 0.751 Test Loss: 0.802 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4975407123565674
Epoch: 19, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.804 Vali Acc: 0.803 Test Loss: 0.804 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.428023338317871
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.910 Vali Acc: 0.757 Test Loss: 0.910 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.112609386444092
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.907 Vali Acc: 0.798 Test Loss: 0.907 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.0330681800842285
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.815 Vali Acc: 0.821 Test Loss: 0.815 Test Acc: 0.821
Validation loss decreased (-0.815021 --> -0.820801).  Saving model ...
Epoch: 23 cost time: 3.3120484352111816
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.082 Vali Acc: 0.792 Test Loss: 1.082 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0225107669830322
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.722 Vali Acc: 0.821 Test Loss: 0.722 Test Acc: 0.821
Validation loss decreased (-0.820801 --> -0.820802).  Saving model ...
Epoch: 25 cost time: 2.784048080444336
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.838 Test Loss: 0.619 Test Acc: 0.838
Validation loss decreased (-0.820802 --> -0.838144).  Saving model ...
Epoch: 26 cost time: 3.2060656547546387
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.838 Test Loss: 0.644 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.210576295852661
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.609 Vali Acc: 0.827 Test Loss: 0.609 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5578384399414062
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.926 Vali Acc: 0.798 Test Loss: 0.926 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.81889271736145
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.827 Test Loss: 0.630 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.678351402282715
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.821 Test Loss: 0.776 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.9444751739501953
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.7388110160827637
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.809 Test Loss: 0.651 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.896667242050171
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.827 Test Loss: 0.651 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.24459171295166
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.832 Test Loss: 0.653 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.864567995071411
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.832 Test Loss: 0.654 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 65664775
model size : 265.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.3703694343566895
Epoch: 1, Steps: 17 | Train Loss: 1.826 Vali Loss: 1.511 Vali Acc: 0.347 Test Loss: 1.511 Test Acc: 0.347
Validation loss decreased (inf --> -0.346806).  Saving model ...
Epoch: 2 cost time: 2.9165568351745605
Epoch: 2, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.086 Vali Acc: 0.555 Test Loss: 1.086 Test Acc: 0.555
Validation loss decreased (-0.346806 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 3.636490821838379
Epoch: 3, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.840 Vali Acc: 0.676 Test Loss: 0.840 Test Acc: 0.676
Validation loss decreased (-0.554902 --> -0.676292).  Saving model ...
Epoch: 4 cost time: 2.256565809249878
Epoch: 4, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.726 Vali Acc: 0.740 Test Loss: 0.726 Test Acc: 0.740
Validation loss decreased (-0.676292 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 4.408556222915649
Epoch: 5, Steps: 17 | Train Loss: 0.541 Vali Loss: 1.028 Vali Acc: 0.590 Test Loss: 1.028 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.3525121212005615
Epoch: 6, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.786 Vali Acc: 0.728 Test Loss: 0.786 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5064921379089355
Epoch: 7, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.369 Vali Acc: 0.630 Test Loss: 1.369 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.15460467338562
Epoch: 8, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.787 Vali Acc: 0.798 Test Loss: 0.787 Test Acc: 0.798
Validation loss decreased (-0.739877 --> -0.797680).  Saving model ...
Epoch: 9 cost time: 4.14863920211792
Epoch: 9, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.989 Vali Acc: 0.798 Test Loss: 0.989 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.360485315322876
Epoch: 10, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.466 Vali Acc: 0.740 Test Loss: 1.466 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.608804702758789
Epoch: 11, Steps: 17 | Train Loss: 0.210 Vali Loss: 2.421 Vali Acc: 0.601 Test Loss: 2.421 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.979119300842285
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.677 Vali Acc: 0.832 Test Loss: 0.677 Test Acc: 0.832
Validation loss decreased (-0.797680 --> -0.832363).  Saving model ...
Epoch: 13 cost time: 3.4674158096313477
Epoch: 13, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.367 Vali Acc: 0.717 Test Loss: 1.367 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7030627727508545
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.364 Vali Acc: 0.757 Test Loss: 1.364 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.676504611968994
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.458 Vali Acc: 0.786 Test Loss: 1.458 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.685290575027466
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.424 Vali Acc: 0.780 Test Loss: 1.424 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.9096877574920654
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.220 Vali Acc: 0.740 Test Loss: 2.220 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.377297878265381
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.433 Vali Acc: 0.728 Test Loss: 1.433 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.2485969066619873
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.929 Vali Acc: 0.815 Test Loss: 0.929 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1103217601776123
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.966 Vali Acc: 0.815 Test Loss: 0.966 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.420286178588867
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.525 Vali Acc: 0.775 Test Loss: 1.525 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.37382173538208
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.499 Vali Acc: 0.815 Test Loss: 1.499 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 68097799
model size : 274.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.325366735458374
Epoch: 1, Steps: 17 | Train Loss: 1.842 Vali Loss: 1.494 Vali Acc: 0.335 Test Loss: 1.494 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 3.4868717193603516
Epoch: 2, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.037 Vali Acc: 0.601 Test Loss: 1.037 Test Acc: 0.601
Validation loss decreased (-0.335245 --> -0.601146).  Saving model ...
Epoch: 3 cost time: 3.6351234912872314
Epoch: 3, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.123 Vali Acc: 0.566 Test Loss: 1.123 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.096251726150513
Epoch: 4, Steps: 17 | Train Loss: 0.682 Vali Loss: 1.128 Vali Acc: 0.555 Test Loss: 1.128 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.303198337554932
Epoch: 5, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.147 Vali Acc: 0.671 Test Loss: 1.147 Test Acc: 0.671
Validation loss decreased (-0.601146 --> -0.670509).  Saving model ...
Epoch: 6 cost time: 3.8462467193603516
Epoch: 6, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.637 Vali Acc: 0.734 Test Loss: 0.637 Test Acc: 0.734
Validation loss decreased (-0.670509 --> -0.734098).  Saving model ...
Epoch: 7 cost time: 4.498015403747559
Epoch: 7, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.619 Vali Acc: 0.792 Test Loss: 0.619 Test Acc: 0.792
Validation loss decreased (-0.734098 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 4.67048192024231
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.708 Vali Acc: 0.815 Test Loss: 0.708 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815022).  Saving model ...
Epoch: 9 cost time: 4.046023607254028
Epoch: 9, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.874 Vali Acc: 0.775 Test Loss: 0.874 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5451464653015137
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1375317573547363
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.382 Vali Acc: 0.682 Test Loss: 1.382 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4682204723358154
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.906 Vali Acc: 0.734 Test Loss: 0.906 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5770771503448486
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.891 Vali Acc: 0.723 Test Loss: 0.891 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.863719940185547
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.808 Vali Acc: 0.809 Test Loss: 0.808 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.73067045211792
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.896 Vali Acc: 0.792 Test Loss: 0.896 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.4523515701293945
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.373081922531128
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.821 Test Loss: 0.812 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820801).  Saving model ...
Epoch: 18 cost time: 3.5508954524993896
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.786 Test Loss: 0.829 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.614414930343628
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.798 Test Loss: 0.800 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2413885593414307
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.809 Test Loss: 0.805 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0587010383605957
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.798 Test Loss: 0.815 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.227311849594116
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.798 Test Loss: 0.826 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.933166027069092
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.798 Test Loss: 0.836 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.8169376850128174
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.798 Test Loss: 0.840 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.481539726257324
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.798 Test Loss: 0.845 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.5505521297454834
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.803 Test Loss: 0.857 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.396768569946289
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.803 Test Loss: 0.865 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 67945735
model size : 273.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.037522077560425
Epoch: 1, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.533 Vali Acc: 0.434 Test Loss: 1.533 Test Acc: 0.434
Validation loss decreased (inf --> -0.433511).  Saving model ...
Epoch: 2 cost time: 3.858464002609253
Epoch: 2, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.451 Vali Acc: 0.416 Test Loss: 1.451 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.880485773086548
Epoch: 3, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.151 Vali Acc: 0.543 Test Loss: 1.151 Test Acc: 0.543
Validation loss decreased (-0.433511 --> -0.543341).  Saving model ...
Epoch: 4 cost time: 3.913891077041626
Epoch: 4, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.056 Vali Acc: 0.618 Test Loss: 1.056 Test Acc: 0.618
Validation loss decreased (-0.543341 --> -0.618487).  Saving model ...
Epoch: 5 cost time: 4.220782041549683
Epoch: 5, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.712 Vali Acc: 0.757 Test Loss: 0.712 Test Acc: 0.757
Validation loss decreased (-0.618487 --> -0.757218).  Saving model ...
Epoch: 6 cost time: 3.7298030853271484
Epoch: 6, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.929 Vali Acc: 0.618 Test Loss: 0.929 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.779571056365967
Epoch: 7, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.259 Vali Acc: 0.503 Test Loss: 1.259 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.475465536117554
Epoch: 8, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.716 Vali Acc: 0.723 Test Loss: 0.716 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.390389442443848
Epoch: 9, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.613 Vali Acc: 0.792 Test Loss: 0.613 Test Acc: 0.792
Validation loss decreased (-0.757218 --> -0.791901).  Saving model ...
Epoch: 10 cost time: 4.155893564224243
Epoch: 10, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.592 Vali Acc: 0.757 Test Loss: 0.592 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0707316398620605
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.667 Vali Acc: 0.792 Test Loss: 0.667 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.2368385791778564
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.713 Vali Acc: 0.757 Test Loss: 0.713 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.23035740852356
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803462).  Saving model ...
Epoch: 14 cost time: 4.281199216842651
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.755 Vali Acc: 0.792 Test Loss: 0.755 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.204486131668091
Epoch: 15, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.684 Vali Acc: 0.803 Test Loss: 0.684 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.18036150932312
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.539 Vali Acc: 0.798 Test Loss: 0.539 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8129918575286865
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.546 Vali Acc: 0.798 Test Loss: 0.546 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8465042114257812
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.654 Vali Acc: 0.827 Test Loss: 0.654 Test Acc: 0.827
Validation loss decreased (-0.803462 --> -0.826583).  Saving model ...
Epoch: 19 cost time: 3.965357542037964
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.765 Vali Acc: 0.809 Test Loss: 0.765 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.099913120269775
Epoch: 20, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.374 Vali Acc: 0.740 Test Loss: 1.374 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.388906478881836
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.051 Vali Acc: 0.740 Test Loss: 1.051 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.295822858810425
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.973 Vali Acc: 0.786 Test Loss: 0.973 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.7220187187194824
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.675 Vali Acc: 0.815 Test Loss: 0.675 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.6365275382995605
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.739 Vali Acc: 0.827 Test Loss: 0.739 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.462921619415283
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.798 Test Loss: 0.834 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.4702303409576416
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
Validation loss decreased (-0.826583 --> -0.843924).  Saving model ...
Epoch: 27 cost time: 3.4115817546844482
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 28 cost time: 3.850639581680298
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.832 Test Loss: 0.628 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.148893117904663
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.832 Test Loss: 0.651 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.0089614391326904
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.821 Test Loss: 0.669 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2913990020751953
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.832 Test Loss: 0.662 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.552363395690918
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.838 Test Loss: 0.672 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.7696690559387207
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.838 Test Loss: 0.673 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.494142532348633
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.832 Test Loss: 0.680 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.363776445388794
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.832 Test Loss: 0.673 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.1318745613098145
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.832 Test Loss: 0.673 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.9261345863342285
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.832 Test Loss: 0.677 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 67876615
model size : 273.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.323946237564087
Epoch: 1, Steps: 17 | Train Loss: 1.954 Vali Loss: 1.541 Vali Acc: 0.347 Test Loss: 1.541 Test Acc: 0.347
Validation loss decreased (inf --> -0.346805).  Saving model ...
Epoch: 2 cost time: 3.6293842792510986
Epoch: 2, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.277 Vali Acc: 0.572 Test Loss: 1.277 Test Acc: 0.572
Validation loss decreased (-0.346805 --> -0.572242).  Saving model ...
Epoch: 3 cost time: 4.018199443817139
Epoch: 3, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.066 Vali Acc: 0.549 Test Loss: 1.066 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5704972743988037
Epoch: 4, Steps: 17 | Train Loss: 0.615 Vali Loss: 1.421 Vali Acc: 0.543 Test Loss: 1.421 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.999738931655884
Epoch: 5, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.887 Vali Acc: 0.757 Test Loss: 0.887 Test Acc: 0.757
Validation loss decreased (-0.572242 --> -0.757217).  Saving model ...
Epoch: 6 cost time: 3.8818726539611816
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.627 Vali Acc: 0.786 Test Loss: 0.627 Test Acc: 0.786
Validation loss decreased (-0.757217 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 3.2775845527648926
Epoch: 7, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.944 Vali Acc: 0.723 Test Loss: 0.944 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8324506282806396
Epoch: 8, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.782 Vali Acc: 0.751 Test Loss: 0.782 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.87630558013916
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.475 Vali Acc: 0.642 Test Loss: 1.475 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.922861814498901
Epoch: 10, Steps: 17 | Train Loss: 0.274 Vali Loss: 1.565 Vali Acc: 0.717 Test Loss: 1.565 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.516038179397583
Epoch: 11, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.316 Vali Acc: 0.746 Test Loss: 1.316 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.231265544891357
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.822 Vali Acc: 0.786 Test Loss: 0.822 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.82265305519104
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.433 Vali Acc: 0.740 Test Loss: 1.433 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.498435735702515
Epoch: 14, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.509 Vali Acc: 0.763 Test Loss: 1.509 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.281785011291504
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.038 Vali Acc: 0.740 Test Loss: 2.038 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.004467010498047
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.682 Vali Acc: 0.809 Test Loss: 1.682 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809232).  Saving model ...
Epoch: 17 cost time: 4.601814270019531
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 2.259 Vali Acc: 0.775 Test Loss: 2.259 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.088988304138184
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.620 Vali Acc: 0.786 Test Loss: 1.620 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.972718238830566
Epoch: 19, Steps: 17 | Train Loss: 0.135 Vali Loss: 2.244 Vali Acc: 0.711 Test Loss: 2.244 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.797445058822632
Epoch: 20, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.991 Vali Acc: 0.815 Test Loss: 0.991 Test Acc: 0.815
Validation loss decreased (-0.809232 --> -0.815019).  Saving model ...
Epoch: 21 cost time: 5.148564577102661
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.717 Vali Acc: 0.769 Test Loss: 1.717 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.929586887359619
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.449 Vali Acc: 0.792 Test Loss: 1.449 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.274714469909668
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.290 Vali Acc: 0.803 Test Loss: 1.290 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.533653497695923
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.170 Vali Acc: 0.769 Test Loss: 2.170 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.6432230472564697
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.933 Vali Acc: 0.775 Test Loss: 1.933 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.037362575531006
Epoch: 26, Steps: 17 | Train Loss: 0.240 Vali Loss: 1.686 Vali Acc: 0.746 Test Loss: 1.686 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.301342964172363
Epoch: 27, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.206 Vali Acc: 0.798 Test Loss: 1.206 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.660744667053223
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.354 Vali Acc: 0.792 Test Loss: 1.354 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.092551946640015
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.701 Vali Acc: 0.798 Test Loss: 1.701 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.420910596847534
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.170 Vali Acc: 0.780 Test Loss: 2.170 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 70316551
model size : 282.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.977815866470337
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.669 Vali Acc: 0.301 Test Loss: 1.669 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 4.0676422119140625
Epoch: 2, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.108 Vali Acc: 0.474 Test Loss: 1.108 Test Acc: 0.474
Validation loss decreased (-0.300561 --> -0.473977).  Saving model ...
Epoch: 3 cost time: 4.170982837677002
Epoch: 3, Steps: 17 | Train Loss: 0.941 Vali Loss: 0.961 Vali Acc: 0.601 Test Loss: 0.961 Test Acc: 0.601
Validation loss decreased (-0.473977 --> -0.601146).  Saving model ...
Epoch: 4 cost time: 3.66591215133667
Epoch: 4, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.647 Vali Acc: 0.769 Test Loss: 0.647 Test Acc: 0.769
Validation loss decreased (-0.601146 --> -0.768780).  Saving model ...
Epoch: 5 cost time: 3.4048988819122314
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.602 Vali Acc: 0.769 Test Loss: 0.602 Test Acc: 0.769
Validation loss decreased (-0.768780 --> -0.768780).  Saving model ...
Epoch: 6 cost time: 3.5674517154693604
Epoch: 6, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.934 Vali Acc: 0.694 Test Loss: 0.934 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7383358478546143
Epoch: 7, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.565 Vali Acc: 0.815 Test Loss: 0.565 Test Acc: 0.815
Validation loss decreased (-0.768780 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 3.8994686603546143
Epoch: 8, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3713181018829346
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.601 Vali Acc: 0.786 Test Loss: 0.601 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7063241004943848
Epoch: 10, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.693 Vali Acc: 0.832 Test Loss: 0.693 Test Acc: 0.832
Validation loss decreased (-0.815023 --> -0.832363).  Saving model ...
Epoch: 11 cost time: 3.7800772190093994
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.908 Vali Acc: 0.780 Test Loss: 0.908 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9499528408050537
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.146 Vali Acc: 0.751 Test Loss: 1.146 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.031364440917969
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.298 Vali Acc: 0.757 Test Loss: 1.298 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5107569694519043
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.809 Vali Acc: 0.827 Test Loss: 0.809 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.292843818664551
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.697 Vali Acc: 0.838 Test Loss: 0.697 Test Acc: 0.838
Validation loss decreased (-0.832363 --> -0.838143).  Saving model ...
Epoch: 16 cost time: 3.0597455501556396
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.090 Vali Acc: 0.786 Test Loss: 1.090 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.533607244491577
Epoch: 17, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.224 Vali Acc: 0.728 Test Loss: 1.224 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.032066822052002
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.923 Vali Acc: 0.792 Test Loss: 0.923 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5770328044891357
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.131 Vali Acc: 0.786 Test Loss: 1.131 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.76066255569458
Epoch: 20, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.736 Vali Acc: 0.844 Test Loss: 0.736 Test Acc: 0.844
Validation loss decreased (-0.838143 --> -0.843923).  Saving model ...
Epoch: 21 cost time: 4.208462476730347
Epoch: 21, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.775 Vali Acc: 0.855 Test Loss: 0.775 Test Acc: 0.855
Validation loss decreased (-0.843923 --> -0.855484).  Saving model ...
Epoch: 22 cost time: 4.076353073120117
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.925 Vali Acc: 0.821 Test Loss: 0.925 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.310053825378418
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.036 Vali Acc: 0.850 Test Loss: 1.036 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.285383462905884
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.838 Test Loss: 0.834 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.973615407943726
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.855 Test Loss: 0.822 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.8652403354644775
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.99875807762146
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.838 Test Loss: 0.928 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.441940069198608
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.809 Test Loss: 0.956 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.55030083656311
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.827 Test Loss: 0.896 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.994370937347412
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.832 Test Loss: 0.882 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.466236114501953
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.827 Test Loss: 0.905 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 70164487
model size : 282.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.2033162117004395
Epoch: 1, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.599 Vali Acc: 0.260 Test Loss: 1.599 Test Acc: 0.260
Validation loss decreased (inf --> -0.260100).  Saving model ...
Epoch: 2 cost time: 3.4994444847106934
Epoch: 2, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.051 Vali Acc: 0.543 Test Loss: 1.051 Test Acc: 0.543
Validation loss decreased (-0.260100 --> -0.543342).  Saving model ...
Epoch: 3 cost time: 3.3733389377593994
Epoch: 3, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.959 Vali Acc: 0.630 Test Loss: 0.959 Test Acc: 0.630
Validation loss decreased (-0.543342 --> -0.630048).  Saving model ...
Epoch: 4 cost time: 3.5102884769439697
Epoch: 4, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
Validation loss decreased (-0.630048 --> -0.745658).  Saving model ...
Epoch: 5 cost time: 3.409322500228882
Epoch: 5, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.636 Vali Acc: 0.769 Test Loss: 0.636 Test Acc: 0.769
Validation loss decreased (-0.745658 --> -0.768780).  Saving model ...
Epoch: 6 cost time: 2.6596648693084717
Epoch: 6, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.778 Vali Acc: 0.740 Test Loss: 0.778 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.608227491378784
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.837 Vali Acc: 0.740 Test Loss: 0.837 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6249940395355225
Epoch: 8, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.703 Vali Acc: 0.786 Test Loss: 0.703 Test Acc: 0.786
Validation loss decreased (-0.768780 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 3.191917657852173
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.554 Vali Acc: 0.838 Test Loss: 0.554 Test Acc: 0.838
Validation loss decreased (-0.786120 --> -0.838145).  Saving model ...
Epoch: 10 cost time: 3.264845371246338
Epoch: 10, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.653 Vali Acc: 0.792 Test Loss: 0.653 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9325015544891357
Epoch: 11, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.086 Vali Acc: 0.757 Test Loss: 1.086 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8676037788391113
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.721 Vali Acc: 0.775 Test Loss: 0.721 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7680811882019043
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9617536067962646
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.873 Vali Acc: 0.803 Test Loss: 0.873 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9239296913146973
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.070 Vali Acc: 0.803 Test Loss: 1.070 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.907191514968872
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.882 Vali Acc: 0.780 Test Loss: 0.882 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6855993270874023
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.220 Vali Acc: 0.780 Test Loss: 1.220 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.292174339294434
Epoch: 18, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.866 Vali Acc: 0.763 Test Loss: 0.866 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.6577773094177246
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 70088455
model size : 282.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.808541536331177
Epoch: 1, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.381 Vali Acc: 0.491 Test Loss: 1.381 Test Acc: 0.491
Validation loss decreased (inf --> -0.491316).  Saving model ...
Epoch: 2 cost time: 3.5665993690490723
Epoch: 2, Steps: 17 | Train Loss: 1.133 Vali Loss: 0.977 Vali Acc: 0.549 Test Loss: 0.977 Test Acc: 0.549
Validation loss decreased (-0.491316 --> -0.549123).  Saving model ...
Epoch: 3 cost time: 4.7382423877716064
Epoch: 3, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.943 Vali Acc: 0.653 Test Loss: 0.943 Test Acc: 0.653
Validation loss decreased (-0.549123 --> -0.653170).  Saving model ...
Epoch: 4 cost time: 5.052302837371826
Epoch: 4, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.694 Vali Acc: 0.751 Test Loss: 0.694 Test Acc: 0.751
Validation loss decreased (-0.653170 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 4.449323415756226
Epoch: 5, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.782 Vali Acc: 0.682 Test Loss: 0.782 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.685908079147339
Epoch: 6, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.562 Vali Acc: 0.792 Test Loss: 0.562 Test Acc: 0.792
Validation loss decreased (-0.751438 --> -0.791902).  Saving model ...
Epoch: 7 cost time: 2.7776384353637695
Epoch: 7, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.146 Vali Acc: 0.723 Test Loss: 1.146 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.865111351013184
Epoch: 8, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.127 Vali Acc: 0.665 Test Loss: 1.127 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.479051351547241
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.585 Vali Acc: 0.873 Test Loss: 0.585 Test Acc: 0.873
Validation loss decreased (-0.791902 --> -0.872827).  Saving model ...
Epoch: 10 cost time: 5.041599988937378
Epoch: 10, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.725 Vali Acc: 0.821 Test Loss: 0.725 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.256741046905518
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.688 Vali Acc: 0.798 Test Loss: 0.688 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.70912504196167
Epoch: 12, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.882 Vali Acc: 0.867 Test Loss: 0.882 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.77024507522583
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.494 Vali Acc: 0.775 Test Loss: 1.494 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.313575267791748
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.774 Vali Acc: 0.832 Test Loss: 0.774 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.120797157287598
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.138 Vali Acc: 0.809 Test Loss: 1.138 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.110739231109619
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.927 Vali Acc: 0.780 Test Loss: 0.927 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.064927339553833
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.061 Vali Acc: 0.844 Test Loss: 1.061 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.123339891433716
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.389 Vali Acc: 0.780 Test Loss: 1.389 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.0563201904296875
Epoch: 19, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.113 Vali Acc: 0.827 Test Loss: 1.113 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 74671111
model size : 299.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.533287286758423
Epoch: 1, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.590 Vali Acc: 0.306 Test Loss: 1.590 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 3.8309779167175293
Epoch: 2, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.086 Vali Acc: 0.630 Test Loss: 1.086 Test Acc: 0.630
Validation loss decreased (-0.306342 --> -0.630047).  Saving model ...
Epoch: 3 cost time: 3.889875650405884
Epoch: 3, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.737 Vali Acc: 0.699 Test Loss: 0.737 Test Acc: 0.699
Validation loss decreased (-0.630047 --> -0.699415).  Saving model ...
Epoch: 4 cost time: 3.8581223487854004
Epoch: 4, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.876 Vali Acc: 0.659 Test Loss: 0.876 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.274645805358887
Epoch: 5, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.761 Vali Acc: 0.671 Test Loss: 0.761 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.693171977996826
Epoch: 6, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
Validation loss decreased (-0.699415 --> -0.757219).  Saving model ...
Epoch: 7 cost time: 3.5593130588531494
Epoch: 7, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.788 Vali Acc: 0.711 Test Loss: 0.788 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.350147247314453
Epoch: 8, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.784 Vali Acc: 0.786 Test Loss: 0.784 Test Acc: 0.786
Validation loss decreased (-0.757219 --> -0.786119).  Saving model ...
Epoch: 9 cost time: 4.024578094482422
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.648 Vali Acc: 0.815 Test Loss: 0.648 Test Acc: 0.815
Validation loss decreased (-0.786119 --> -0.815022).  Saving model ...
Epoch: 10 cost time: 4.253142356872559
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.691 Vali Acc: 0.815 Test Loss: 0.691 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.656028509140015
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.740 Vali Acc: 0.809 Test Loss: 0.740 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.538272380828857
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.780 Test Loss: 0.762 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.782742977142334
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.734 Vali Acc: 0.815 Test Loss: 0.734 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.4119954109191895
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.882 Vali Acc: 0.769 Test Loss: 0.882 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.341803312301636
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.927 Vali Acc: 0.775 Test Loss: 0.927 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.399251699447632
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.720 Vali Acc: 0.815 Test Loss: 0.720 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.0585105419158936
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.203 Vali Acc: 0.740 Test Loss: 1.203 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.543973922729492
Epoch: 18, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.720 Vali Acc: 0.827 Test Loss: 0.720 Test Acc: 0.827
Validation loss decreased (-0.815022 --> -0.826582).  Saving model ...
Epoch: 19 cost time: 5.268826246261597
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.799 Vali Acc: 0.803 Test Loss: 0.799 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.284950256347656
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.646 Vali Acc: 0.832 Test Loss: 0.646 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832363).  Saving model ...
Epoch: 21 cost time: 4.284176826477051
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.803 Test Loss: 0.715 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.010354280471802
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.815 Test Loss: 0.739 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.15814471244812
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.815 Test Loss: 0.660 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.929866075515747
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.803 Test Loss: 0.669 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.373467206954956
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.266641855239868
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.815 Test Loss: 0.661 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.700220346450806
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.815 Test Loss: 0.664 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.941012382507324
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.815 Test Loss: 0.667 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.936285972595215
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.815 Test Loss: 0.661 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.973394393920898
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.821 Test Loss: 0.659 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 74574343
model size : 299.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.375673294067383
Epoch: 1, Steps: 17 | Train Loss: 1.861 Vali Loss: 1.512 Vali Acc: 0.295 Test Loss: 1.512 Test Acc: 0.295
Validation loss decreased (inf --> -0.294783).  Saving model ...
Epoch: 2 cost time: 3.8193862438201904
Epoch: 2, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.198 Vali Acc: 0.538 Test Loss: 1.198 Test Acc: 0.538
Validation loss decreased (-0.294783 --> -0.537560).  Saving model ...
Epoch: 3 cost time: 3.6021029949188232
Epoch: 3, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.161 Vali Acc: 0.590 Test Loss: 1.161 Test Acc: 0.590
Validation loss decreased (-0.537560 --> -0.589584).  Saving model ...
Epoch: 4 cost time: 3.5197596549987793
Epoch: 4, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.754 Vali Acc: 0.676 Test Loss: 0.754 Test Acc: 0.676
Validation loss decreased (-0.589584 --> -0.676293).  Saving model ...
Epoch: 5 cost time: 4.059734582901001
Epoch: 5, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.849 Vali Acc: 0.682 Test Loss: 0.849 Test Acc: 0.682
Validation loss decreased (-0.676293 --> -0.682072).  Saving model ...
Epoch: 6 cost time: 3.6795525550842285
Epoch: 6, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.263 Vali Acc: 0.624 Test Loss: 1.263 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5936591625213623
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.786 Vali Acc: 0.751 Test Loss: 0.786 Test Acc: 0.751
Validation loss decreased (-0.682072 --> -0.751437).  Saving model ...
Epoch: 8 cost time: 3.671746015548706
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.595 Vali Acc: 0.769 Test Loss: 0.595 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768780).  Saving model ...
Epoch: 9 cost time: 4.1052210330963135
Epoch: 9, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 4.130414247512817
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
Validation loss decreased (-0.774559 --> -0.774560).  Saving model ...
Epoch: 11 cost time: 4.0662760734558105
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.552 Vali Acc: 0.798 Test Loss: 0.552 Test Acc: 0.798
Validation loss decreased (-0.774560 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 3.6422278881073
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 3.3884289264678955
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.798 Test Loss: 0.624 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.505018472671509
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8053576946258545
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.720 Vali Acc: 0.751 Test Loss: 0.720 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.058532238006592
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.877 Vali Acc: 0.792 Test Loss: 0.877 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.055732727050781
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.616 Vali Acc: 0.792 Test Loss: 0.616 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.765392303466797
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.624 Vali Acc: 0.827 Test Loss: 0.624 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826583).  Saving model ...
Epoch: 19 cost time: 4.998858690261841
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.815 Test Loss: 0.649 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.340562343597412
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5318095684051514
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.815 Test Loss: 0.654 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2898056507110596
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.815 Test Loss: 0.671 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5055410861968994
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.815 Test Loss: 0.680 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.032440423965454
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.815 Test Loss: 0.676 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.904254198074341
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.815 Test Loss: 0.673 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.6299993991851807
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.815 Test Loss: 0.683 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.162739276885986
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.815 Test Loss: 0.696 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.247771978378296
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.815 Test Loss: 0.702 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 74512135
model size : 298.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.243475675582886
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.357 Vali Acc: 0.439 Test Loss: 1.357 Test Acc: 0.439
Validation loss decreased (inf --> -0.439293).  Saving model ...
Epoch: 2 cost time: 2.9958972930908203
Epoch: 2, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.093 Vali Acc: 0.532 Test Loss: 1.093 Test Acc: 0.532
Validation loss decreased (-0.439293 --> -0.531781).  Saving model ...
Epoch: 3 cost time: 3.9478161334991455
Epoch: 3, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.285 Vali Acc: 0.572 Test Loss: 1.285 Test Acc: 0.572
Validation loss decreased (-0.531781 --> -0.572241).  Saving model ...
Epoch: 4 cost time: 3.975898504257202
Epoch: 4, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.347 Vali Acc: 0.572 Test Loss: 1.347 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.681246519088745
Epoch: 5, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
Validation loss decreased (-0.572241 --> -0.803461).  Saving model ...
Epoch: 6 cost time: 4.787282228469849
Epoch: 6, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.439 Vali Acc: 0.624 Test Loss: 1.439 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.351132869720459
Epoch: 7, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.592 Vali Acc: 0.821 Test Loss: 0.592 Test Acc: 0.821
Validation loss decreased (-0.803461 --> -0.820803).  Saving model ...
Epoch: 8 cost time: 4.192847490310669
Epoch: 8, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.855 Vali Acc: 0.757 Test Loss: 0.855 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1539764404296875
Epoch: 9, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.920 Vali Acc: 0.751 Test Loss: 0.920 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.380169868469238
Epoch: 10, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.681656360626221
Epoch: 11, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.937 Vali Acc: 0.751 Test Loss: 0.937 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.339972496032715
Epoch: 12, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.891 Vali Acc: 0.769 Test Loss: 0.891 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9249086380004883
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.038223505020142
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.043 Vali Acc: 0.780 Test Loss: 1.043 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.025778293609619
Epoch: 15, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.820803 --> -0.849706).  Saving model ...
Epoch: 16 cost time: 3.367722988128662
Epoch: 16, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.989 Vali Acc: 0.821 Test Loss: 0.989 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0147500038146973
Epoch: 17, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.696 Vali Acc: 0.832 Test Loss: 0.696 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.063793659210205
Epoch: 18, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.180 Vali Acc: 0.827 Test Loss: 1.180 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.483776330947876
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.919 Vali Acc: 0.827 Test Loss: 0.919 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.232288837432861
Epoch: 20, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.798 Vali Acc: 0.798 Test Loss: 0.798 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.11245322227478
Epoch: 21, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.888 Vali Acc: 0.850 Test Loss: 0.888 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.2500669956207275
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.077 Vali Acc: 0.792 Test Loss: 1.077 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.2667694091796875
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.871 Vali Acc: 0.803 Test Loss: 0.871 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.437495946884155
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.799 Vali Acc: 0.844 Test Loss: 0.799 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7667548656463623
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.120 Vali Acc: 0.815 Test Loss: 1.120 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 76889863
model size : 307.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.985396385192871
Epoch: 1, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.493 Vali Acc: 0.266 Test Loss: 1.493 Test Acc: 0.266
Validation loss decreased (inf --> -0.265881).  Saving model ...
Epoch: 2 cost time: 4.311044454574585
Epoch: 2, Steps: 17 | Train Loss: 1.162 Vali Loss: 0.947 Vali Acc: 0.618 Test Loss: 0.947 Test Acc: 0.618
Validation loss decreased (-0.265881 --> -0.618488).  Saving model ...
Epoch: 3 cost time: 4.459521293640137
Epoch: 3, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.806 Vali Acc: 0.728 Test Loss: 0.806 Test Acc: 0.728
Validation loss decreased (-0.618488 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 4.800005912780762
Epoch: 4, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.691 Vali Acc: 0.711 Test Loss: 0.691 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.554462432861328
Epoch: 5, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.5966901779174805
Epoch: 6, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.894 Vali Acc: 0.705 Test Loss: 0.894 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.766728639602661
Epoch: 7, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.631 Vali Acc: 0.728 Test Loss: 0.631 Test Acc: 0.728
Validation loss decreased (-0.728316 --> -0.728317).  Saving model ...
Epoch: 8 cost time: 4.2159507274627686
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.990 Vali Acc: 0.734 Test Loss: 0.990 Test Acc: 0.734
Validation loss decreased (-0.728317 --> -0.734094).  Saving model ...
Epoch: 9 cost time: 3.195847988128662
Epoch: 9, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.734094 --> -0.809242).  Saving model ...
Epoch: 10 cost time: 3.7974889278411865
Epoch: 10, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.107 Vali Acc: 0.734 Test Loss: 1.107 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7001006603240967
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2665910720825195
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.791 Vali Acc: 0.757 Test Loss: 0.791 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6518664360046387
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.712 Vali Acc: 0.815 Test Loss: 0.712 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815022).  Saving model ...
Epoch: 14 cost time: 4.756295204162598
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.977 Vali Acc: 0.803 Test Loss: 0.977 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.553429126739502
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.903 Vali Acc: 0.780 Test Loss: 0.903 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.036501407623291
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.622 Vali Acc: 0.821 Test Loss: 0.622 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820803).  Saving model ...
Epoch: 17 cost time: 4.338477611541748
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.573 Vali Acc: 0.798 Test Loss: 0.573 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.478004217147827
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.566021680831909
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.780 Test Loss: 0.604 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.487725496292114
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.954468488693237
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.150846004486084
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.798 Test Loss: 0.656 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.173342227935791
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.798 Test Loss: 0.654 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.223859548568726
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.079474210739136
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.798 Test Loss: 0.663 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.3712317943573
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.798 Test Loss: 0.671 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 76779271
model size : 307.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.589633464813232
Epoch: 1, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.431 Vali Acc: 0.399 Test Loss: 1.431 Test Acc: 0.399
Validation loss decreased (inf --> -0.398830).  Saving model ...
Epoch: 2 cost time: 3.4963767528533936
Epoch: 2, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.107 Vali Acc: 0.561 Test Loss: 1.107 Test Acc: 0.561
Validation loss decreased (-0.398830 --> -0.560683).  Saving model ...
Epoch: 3 cost time: 2.6725471019744873
Epoch: 3, Steps: 17 | Train Loss: 0.956 Vali Loss: 0.806 Vali Acc: 0.694 Test Loss: 0.806 Test Acc: 0.694
Validation loss decreased (-0.560683 --> -0.693634).  Saving model ...
Epoch: 4 cost time: 3.9862658977508545
Epoch: 4, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.891 Vali Acc: 0.647 Test Loss: 0.891 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.654845952987671
Epoch: 5, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.908 Vali Acc: 0.671 Test Loss: 0.908 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.216465473175049
Epoch: 6, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.732 Vali Acc: 0.711 Test Loss: 0.732 Test Acc: 0.711
Validation loss decreased (-0.693634 --> -0.710975).  Saving model ...
Epoch: 7 cost time: 3.003389596939087
Epoch: 7, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.599 Vali Acc: 0.769 Test Loss: 0.599 Test Acc: 0.769
Validation loss decreased (-0.710975 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 3.1356773376464844
Epoch: 8, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.840 Vali Acc: 0.705 Test Loss: 0.840 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.934431314468384
Epoch: 9, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.696 Vali Acc: 0.751 Test Loss: 0.696 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1025004386901855
Epoch: 10, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809243).  Saving model ...
Epoch: 11 cost time: 3.217958450317383
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.467 Vali Acc: 0.815 Test Loss: 0.467 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 12 cost time: 3.9556350708007812
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.732 Vali Acc: 0.780 Test Loss: 0.732 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4758107662200928
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.960 Vali Acc: 0.757 Test Loss: 0.960 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.81311297416687
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.794 Vali Acc: 0.798 Test Loss: 0.794 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.553062677383423
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.678 Vali Acc: 0.763 Test Loss: 0.678 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.49664306640625
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.671 Vali Acc: 0.780 Test Loss: 0.671 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.088851690292358
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.222294330596924
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.803 Test Loss: 0.691 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.03115701675415
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.798 Test Loss: 0.706 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3273513317108154
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.0318803787231445
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 76723975
model size : 307.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.023416996002197
Epoch: 1, Steps: 17 | Train Loss: 1.764 Vali Loss: 1.490 Vali Acc: 0.283 Test Loss: 1.490 Test Acc: 0.283
Validation loss decreased (inf --> -0.283222).  Saving model ...
Epoch: 2 cost time: 4.465667486190796
Epoch: 2, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.037 Vali Acc: 0.532 Test Loss: 1.037 Test Acc: 0.532
Validation loss decreased (-0.283222 --> -0.531782).  Saving model ...
Epoch: 3 cost time: 4.7963385581970215
Epoch: 3, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.517415761947632
Epoch: 4, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.771 Vali Acc: 0.723 Test Loss: 0.771 Test Acc: 0.723
Validation loss decreased (-0.531782 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 4.130788803100586
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774561).  Saving model ...
Epoch: 6 cost time: 3.0144033432006836
Epoch: 6, Steps: 17 | Train Loss: 0.279 Vali Loss: 1.193 Vali Acc: 0.682 Test Loss: 1.193 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.028118848800659
Epoch: 7, Steps: 17 | Train Loss: 0.256 Vali Loss: 1.130 Vali Acc: 0.699 Test Loss: 1.130 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.367913246154785
Epoch: 8, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.004 Vali Acc: 0.763 Test Loss: 1.004 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9381701946258545
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.560 Vali Acc: 0.780 Test Loss: 0.560 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780341).  Saving model ...
Epoch: 10 cost time: 4.234531879425049
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.778 Vali Acc: 0.757 Test Loss: 0.778 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.138170480728149
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.634 Vali Acc: 0.815 Test Loss: 0.634 Test Acc: 0.815
Validation loss decreased (-0.780341 --> -0.815023).  Saving model ...
Epoch: 12 cost time: 3.568244218826294
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.746 Vali Acc: 0.815 Test Loss: 0.746 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.035297393798828
Epoch: 13, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.258 Vali Acc: 0.688 Test Loss: 1.258 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.3723530769348145
Epoch: 14, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.033 Vali Acc: 0.780 Test Loss: 1.033 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.353822946548462
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
Validation loss decreased (-0.815023 --> -0.843924).  Saving model ...
Epoch: 16 cost time: 3.6960489749908447
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.693 Vali Acc: 0.827 Test Loss: 0.693 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.7459070682525635
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.861 Test Loss: 0.556 Test Acc: 0.861
Validation loss decreased (-0.843924 --> -0.861266).  Saving model ...
Epoch: 18 cost time: 3.275862455368042
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.855 Test Loss: 0.573 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2308340072631836
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.873 Test Loss: 0.508 Test Acc: 0.873
Validation loss decreased (-0.861266 --> -0.872827).  Saving model ...
Epoch: 20 cost time: 2.4153239727020264
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.867 Test Loss: 0.544 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6654231548309326
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.867 Test Loss: 0.554 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.452662229537964
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.867 Test Loss: 0.548 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.48268985748291
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.867 Test Loss: 0.565 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.851541757583618
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6948413848876953
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5438802242279053
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.4959466457366943
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.9208407402038574
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.2974307537078857
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 79108615
model size : 316.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.927976846694946
Epoch: 1, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.385 Vali Acc: 0.474 Test Loss: 1.385 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 3.5110249519348145
Epoch: 2, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.115 Vali Acc: 0.497 Test Loss: 1.115 Test Acc: 0.497
Validation loss decreased (-0.473975 --> -0.497099).  Saving model ...
Epoch: 3 cost time: 3.2184417247772217
Epoch: 3, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.972 Vali Acc: 0.676 Test Loss: 0.972 Test Acc: 0.676
Validation loss decreased (-0.497099 --> -0.676291).  Saving model ...
Epoch: 4 cost time: 4.621043920516968
Epoch: 4, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.816 Vali Acc: 0.665 Test Loss: 0.816 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.266733884811401
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.754 Vali Acc: 0.688 Test Loss: 0.754 Test Acc: 0.688
Validation loss decreased (-0.676291 --> -0.687854).  Saving model ...
Epoch: 6 cost time: 3.2477481365203857
Epoch: 6, Steps: 17 | Train Loss: 0.266 Vali Loss: 1.024 Vali Acc: 0.694 Test Loss: 1.024 Test Acc: 0.694
Validation loss decreased (-0.687854 --> -0.693631).  Saving model ...
Epoch: 7 cost time: 4.563389301300049
Epoch: 7, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.612 Vali Acc: 0.769 Test Loss: 0.612 Test Acc: 0.769
Validation loss decreased (-0.693631 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 4.16417670249939
Epoch: 8, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.833 Vali Acc: 0.798 Test Loss: 0.833 Test Acc: 0.798
Validation loss decreased (-0.768780 --> -0.797680).  Saving model ...
Epoch: 9 cost time: 3.5895025730133057
Epoch: 9, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.638 Vali Acc: 0.792 Test Loss: 0.638 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.600952625274658
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.586 Vali Acc: 0.815 Test Loss: 0.586 Test Acc: 0.815
Validation loss decreased (-0.797680 --> -0.815023).  Saving model ...
Epoch: 11 cost time: 4.797851324081421
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.910 Vali Acc: 0.780 Test Loss: 0.910 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.737107038497925
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.777 Vali Acc: 0.780 Test Loss: 0.777 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3735456466674805
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.624 Vali Acc: 0.827 Test Loss: 0.624 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826583).  Saving model ...
Epoch: 14 cost time: 2.9599251747131348
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.919 Vali Acc: 0.780 Test Loss: 0.919 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7209813594818115
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.735 Vali Acc: 0.798 Test Loss: 0.735 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7679104804992676
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.1818695068359375
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.921 Vali Acc: 0.769 Test Loss: 0.921 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.748139381408691
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.686 Vali Acc: 0.815 Test Loss: 0.686 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.1473143100738525
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.706 Vali Acc: 0.786 Test Loss: 0.706 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.88674259185791
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.733 Vali Acc: 0.757 Test Loss: 0.733 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.489163160324097
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.40813136100769
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.619 Vali Acc: 0.827 Test Loss: 0.619 Test Acc: 0.827
Validation loss decreased (-0.826583 --> -0.826583).  Saving model ...
Epoch: 23 cost time: 4.249873876571655
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.647 Vali Acc: 0.855 Test Loss: 0.647 Test Acc: 0.855
Validation loss decreased (-0.826583 --> -0.855485).  Saving model ...
Epoch: 24 cost time: 3.3337152004241943
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.453671455383301
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.855 Test Loss: 0.620 Test Acc: 0.855
Validation loss decreased (-0.855485 --> -0.855485).  Saving model ...
Epoch: 26 cost time: 3.1965410709381104
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.282184362411499
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0360727310180664
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.521145820617676
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.005420684814453
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.868189811706543
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.024909019470215
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.861 Test Loss: 0.564 Test Acc: 0.861
Validation loss decreased (-0.855485 --> -0.861266).  Saving model ...
Epoch: 33 cost time: 2.4748876094818115
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.211139678955078
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.0508501529693604
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.9878721237182617
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.8052408695220947
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.855 Test Loss: 0.586 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.8700456619262695
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.431201457977295
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.5910825729370117
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.861 Test Loss: 0.580 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.2116808891296387
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.861 Test Loss: 0.571 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.446362257003784
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.861 Test Loss: 0.572 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 78998023
model size : 316.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.309995889663696
Epoch: 1, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.431 Vali Acc: 0.439 Test Loss: 1.431 Test Acc: 0.439
Validation loss decreased (inf --> -0.439292).  Saving model ...
Epoch: 2 cost time: 2.644672393798828
Epoch: 2, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.056 Vali Acc: 0.543 Test Loss: 1.056 Test Acc: 0.543
Validation loss decreased (-0.439292 --> -0.543342).  Saving model ...
Epoch: 3 cost time: 2.5577468872070312
Epoch: 3, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.964 Vali Acc: 0.572 Test Loss: 0.964 Test Acc: 0.572
Validation loss decreased (-0.543342 --> -0.572245).  Saving model ...
Epoch: 4 cost time: 2.9753284454345703
Epoch: 4, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
Validation loss decreased (-0.572245 --> -0.716756).  Saving model ...
Epoch: 5 cost time: 3.67415189743042
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.518 Vali Acc: 0.827 Test Loss: 0.518 Test Acc: 0.827
Validation loss decreased (-0.716756 --> -0.826584).  Saving model ...
Epoch: 6 cost time: 3.273383378982544
Epoch: 6, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.845 Vali Acc: 0.734 Test Loss: 0.845 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5093576908111572
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.686 Vali Acc: 0.769 Test Loss: 0.686 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8500490188598633
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.5417637825012207
Epoch: 9, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.662 Vali Acc: 0.769 Test Loss: 0.662 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.927602529525757
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.481071949005127
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.815 Test Loss: 0.676 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4254817962646484
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.631 Vali Acc: 0.821 Test Loss: 0.631 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.580806255340576
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.821 Test Loss: 0.609 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.603188991546631
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.827 Test Loss: 0.615 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.5293571949005127
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.821 Test Loss: 0.626 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 78942727
model size : 315.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.320339202880859
Epoch: 1, Steps: 17 | Train Loss: 1.877 Vali Loss: 1.603 Vali Acc: 0.329 Test Loss: 1.603 Test Acc: 0.329
Validation loss decreased (inf --> -0.329464).  Saving model ...
Epoch: 2 cost time: 6.270216703414917
Epoch: 2, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.120 Vali Acc: 0.595 Test Loss: 1.120 Test Acc: 0.595
Validation loss decreased (-0.329464 --> -0.595365).  Saving model ...
Epoch: 3 cost time: 6.188991546630859
Epoch: 3, Steps: 17 | Train Loss: 0.954 Vali Loss: 0.743 Vali Acc: 0.699 Test Loss: 0.743 Test Acc: 0.699
Validation loss decreased (-0.595365 --> -0.699415).  Saving model ...
Epoch: 4 cost time: 5.943051099777222
Epoch: 4, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.802 Vali Acc: 0.682 Test Loss: 0.802 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.111845254898071
Epoch: 5, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.692 Vali Acc: 0.723 Test Loss: 0.692 Test Acc: 0.723
Validation loss decreased (-0.699415 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 3.7927324771881104
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.894 Vali Acc: 0.763 Test Loss: 0.894 Test Acc: 0.763
Validation loss decreased (-0.722536 --> -0.762997).  Saving model ...
Epoch: 7 cost time: 5.0864081382751465
Epoch: 7, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
Validation loss decreased (-0.762997 --> -0.774560).  Saving model ...
Epoch: 8 cost time: 5.013252258300781
Epoch: 8, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.202 Vali Acc: 0.676 Test Loss: 1.202 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.98366904258728
Epoch: 9, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.794 Vali Acc: 0.780 Test Loss: 0.794 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780339).  Saving model ...
Epoch: 10 cost time: 5.317656993865967
Epoch: 10, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.262 Vali Acc: 0.705 Test Loss: 1.262 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.824598550796509
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.824 Vali Acc: 0.757 Test Loss: 0.824 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.570274829864502
Epoch: 12, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.588 Vali Acc: 0.827 Test Loss: 0.588 Test Acc: 0.827
Validation loss decreased (-0.780339 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 4.7881858348846436
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.147 Vali Acc: 0.769 Test Loss: 1.147 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.315409898757935
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.440 Vali Acc: 0.769 Test Loss: 1.440 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.202401876449585
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.898 Vali Acc: 0.798 Test Loss: 0.898 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.9890034198760986
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.051 Vali Acc: 0.769 Test Loss: 1.051 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.997969150543213
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.857 Vali Acc: 0.798 Test Loss: 0.857 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.952036619186401
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.842 Vali Acc: 0.821 Test Loss: 0.842 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.316349029541016
Epoch: 19, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.166 Vali Acc: 0.792 Test Loss: 1.166 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.289875268936157
Epoch: 20, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.433 Vali Acc: 0.775 Test Loss: 1.433 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.205448865890503
Epoch: 21, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.916 Vali Acc: 0.821 Test Loss: 0.916 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.092097520828247
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.335 Vali Acc: 0.751 Test Loss: 1.335 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 83497735
model size : 333.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.557205677032471
Epoch: 1, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.351 Vali Acc: 0.486 Test Loss: 1.351 Test Acc: 0.486
Validation loss decreased (inf --> -0.485536).  Saving model ...
Epoch: 2 cost time: 4.057678461074829
Epoch: 2, Steps: 17 | Train Loss: 1.148 Vali Loss: 0.949 Vali Acc: 0.636 Test Loss: 0.949 Test Acc: 0.636
Validation loss decreased (-0.485536 --> -0.635829).  Saving model ...
Epoch: 3 cost time: 4.375321626663208
Epoch: 3, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.849 Vali Acc: 0.642 Test Loss: 0.849 Test Acc: 0.642
Validation loss decreased (-0.635829 --> -0.641610).  Saving model ...
Epoch: 4 cost time: 4.099836111068726
Epoch: 4, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.802 Vali Acc: 0.647 Test Loss: 0.802 Test Acc: 0.647
Validation loss decreased (-0.641610 --> -0.647391).  Saving model ...
Epoch: 5 cost time: 5.696325778961182
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.908 Vali Acc: 0.636 Test Loss: 0.908 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.18392539024353
Epoch: 6, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.647 Vali Acc: 0.751 Test Loss: 0.647 Test Acc: 0.751
Validation loss decreased (-0.647391 --> -0.751439).  Saving model ...
Epoch: 7 cost time: 5.413991689682007
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.871 Vali Acc: 0.711 Test Loss: 0.871 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7373270988464355
Epoch: 8, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.830 Vali Acc: 0.763 Test Loss: 0.830 Test Acc: 0.763
Validation loss decreased (-0.751439 --> -0.762997).  Saving model ...
Epoch: 9 cost time: 4.339117527008057
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.618 Vali Acc: 0.815 Test Loss: 0.618 Test Acc: 0.815
Validation loss decreased (-0.762997 --> -0.815023).  Saving model ...
Epoch: 10 cost time: 4.1740381717681885
Epoch: 10, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8967106342315674
Epoch: 11, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.168065309524536
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.913 Vali Acc: 0.798 Test Loss: 0.913 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.679522275924683
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.738 Vali Acc: 0.769 Test Loss: 0.738 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.72274374961853
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.71588659286499
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.838 Test Loss: 0.628 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838144).  Saving model ...
Epoch: 16 cost time: 4.244077920913696
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.763 Test Loss: 0.752 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.480759382247925
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.758413791656494
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.798 Test Loss: 0.620 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.01911735534668
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.798 Test Loss: 0.637 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.084912538528442
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.645461082458496
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.815 Test Loss: 0.648 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.270534038543701
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.183408975601196
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.132979393005371
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.045300245285034
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 83421703
model size : 332.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.094323396682739
Epoch: 1, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.627 Vali Acc: 0.272 Test Loss: 1.627 Test Acc: 0.272
Validation loss decreased (inf --> -0.271660).  Saving model ...
Epoch: 2 cost time: 4.578172922134399
Epoch: 2, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.097 Vali Acc: 0.578 Test Loss: 1.097 Test Acc: 0.578
Validation loss decreased (-0.271660 --> -0.578024).  Saving model ...
Epoch: 3 cost time: 4.95361852645874
Epoch: 3, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.915 Vali Acc: 0.566 Test Loss: 0.915 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.321286678314209
Epoch: 4, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.728 Vali Acc: 0.740 Test Loss: 0.728 Test Acc: 0.740
Validation loss decreased (-0.578024 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 5.056613922119141
Epoch: 5, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.029 Vali Acc: 0.723 Test Loss: 1.029 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.036848306655884
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.639 Vali Acc: 0.746 Test Loss: 0.639 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 5.588127136230469
Epoch: 7, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.008 Vali Acc: 0.751 Test Loss: 1.008 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751435).  Saving model ...
Epoch: 8 cost time: 4.837130546569824
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.761 Vali Acc: 0.798 Test Loss: 0.761 Test Acc: 0.798
Validation loss decreased (-0.751435 --> -0.797680).  Saving model ...
Epoch: 9 cost time: 4.042119979858398
Epoch: 9, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.060 Vali Acc: 0.757 Test Loss: 1.060 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8681485652923584
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.851 Vali Acc: 0.803 Test Loss: 0.851 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803460).  Saving model ...
Epoch: 11 cost time: 4.464314699172974
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.559 Vali Acc: 0.809 Test Loss: 0.559 Test Acc: 0.809
Validation loss decreased (-0.803460 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 4.4890830516815186
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.561 Vali Acc: 0.786 Test Loss: 0.561 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.711716175079346
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.541 Vali Acc: 0.838 Test Loss: 0.541 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 4.417304039001465
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.2736170291900635
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.798 Test Loss: 0.609 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.231961727142334
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.211698770523071
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.786 Test Loss: 0.629 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.095922231674194
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.273468732833862
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.539943218231201
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.792 Test Loss: 0.631 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.328463792800903
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.792 Test Loss: 0.642 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.599578857421875
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.792 Test Loss: 0.651 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.841810941696167
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.792 Test Loss: 0.665 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 83373319
model size : 332.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.019540786743164
Epoch: 1, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.370 Vali Acc: 0.503 Test Loss: 1.370 Test Acc: 0.503
Validation loss decreased (inf --> -0.502876).  Saving model ...
Epoch: 2 cost time: 5.065656900405884
Epoch: 2, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.107 Vali Acc: 0.578 Test Loss: 1.107 Test Acc: 0.578
Validation loss decreased (-0.502876 --> -0.578024).  Saving model ...
Epoch: 3 cost time: 5.293544054031372
Epoch: 3, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.832 Vali Acc: 0.630 Test Loss: 0.832 Test Acc: 0.630
Validation loss decreased (-0.578024 --> -0.630049).  Saving model ...
Epoch: 4 cost time: 5.529891729354858
Epoch: 4, Steps: 17 | Train Loss: 0.602 Vali Loss: 1.107 Vali Acc: 0.578 Test Loss: 1.107 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.643571853637695
Epoch: 5, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.798 Vali Acc: 0.711 Test Loss: 0.798 Test Acc: 0.711
Validation loss decreased (-0.630049 --> -0.710975).  Saving model ...
Epoch: 6 cost time: 6.018232107162476
Epoch: 6, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.584 Vali Acc: 0.786 Test Loss: 0.584 Test Acc: 0.786
Validation loss decreased (-0.710975 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 4.922307014465332
Epoch: 7, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.758 Vali Acc: 0.763 Test Loss: 0.758 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.1222898960113525
Epoch: 8, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.801 Vali Acc: 0.780 Test Loss: 0.801 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.944291830062866
Epoch: 9, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803462).  Saving model ...
Epoch: 10 cost time: 6.611462116241455
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.835 Vali Acc: 0.803 Test Loss: 0.835 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.940970420837402
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.634 Vali Acc: 0.832 Test Loss: 0.634 Test Acc: 0.832
Validation loss decreased (-0.803462 --> -0.832364).  Saving model ...
Epoch: 12 cost time: 4.076819896697998
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.497 Vali Acc: 0.861 Test Loss: 0.497 Test Acc: 0.861
Validation loss decreased (-0.832364 --> -0.861267).  Saving model ...
Epoch: 13 cost time: 5.1923089027404785
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.455 Vali Acc: 0.873 Test Loss: 0.455 Test Acc: 0.873
Validation loss decreased (-0.861267 --> -0.872828).  Saving model ...
Epoch: 14 cost time: 5.862297058105469
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.322 Vali Acc: 0.740 Test Loss: 1.322 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.362514019012451
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.382697582244873
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.710 Vali Acc: 0.809 Test Loss: 0.710 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.2603919506073
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.761 Vali Acc: 0.832 Test Loss: 0.761 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.28081750869751
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.827 Test Loss: 0.770 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.704016447067261
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.827 Test Loss: 0.752 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.398475170135498
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.832 Test Loss: 0.752 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.1193928718566895
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.832 Test Loss: 0.752 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.853693962097168
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.832 Test Loss: 0.751 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.7569918632507324
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.838 Test Loss: 0.750 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 90119431
model size : 358.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.5745320320129395
Epoch: 1, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.534 Vali Acc: 0.341 Test Loss: 1.534 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 3.681680202484131
Epoch: 2, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.095 Vali Acc: 0.543 Test Loss: 1.095 Test Acc: 0.543
Validation loss decreased (-0.341025 --> -0.543342).  Saving model ...
Epoch: 3 cost time: 6.241952896118164
Epoch: 3, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.796 Vali Acc: 0.688 Test Loss: 0.796 Test Acc: 0.688
Validation loss decreased (-0.543342 --> -0.687853).  Saving model ...
Epoch: 4 cost time: 5.3954291343688965
Epoch: 4, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.656 Vali Acc: 0.798 Test Loss: 0.656 Test Acc: 0.798
Validation loss decreased (-0.687853 --> -0.797681).  Saving model ...
Epoch: 5 cost time: 6.181701898574829
Epoch: 5, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.665 Vali Acc: 0.728 Test Loss: 0.665 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.442800998687744
Epoch: 6, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.727 Vali Acc: 0.746 Test Loss: 0.727 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.211121559143066
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.551 Vali Acc: 0.855 Test Loss: 0.551 Test Acc: 0.855
Validation loss decreased (-0.797681 --> -0.855486).  Saving model ...
Epoch: 8 cost time: 4.157357931137085
Epoch: 8, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.170307397842407
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.519 Vali Acc: 0.827 Test Loss: 0.519 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.671643018722534
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.580081224441528
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.516 Vali Acc: 0.566 Test Loss: 1.516 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.457279920578003
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.805132627487183
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.796 Vali Acc: 0.740 Test Loss: 0.796 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.882221221923828
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.988 Vali Acc: 0.780 Test Loss: 0.988 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.005936622619629
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.057 Vali Acc: 0.746 Test Loss: 1.057 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.992375373840332
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.893 Vali Acc: 0.763 Test Loss: 0.893 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.9530272483825684
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.957 Vali Acc: 0.792 Test Loss: 0.957 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 90057223
model size : 358.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.446754693984985
Epoch: 1, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.440 Vali Acc: 0.491 Test Loss: 1.440 Test Acc: 0.491
Validation loss decreased (inf --> -0.491315).  Saving model ...
Epoch: 2 cost time: 3.893994092941284
Epoch: 2, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.000 Vali Acc: 0.624 Test Loss: 1.000 Test Acc: 0.624
Validation loss decreased (-0.491315 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 4.483039617538452
Epoch: 3, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.014 Vali Acc: 0.555 Test Loss: 1.014 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.075288772583008
Epoch: 4, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.697 Vali Acc: 0.711 Test Loss: 0.697 Test Acc: 0.711
Validation loss decreased (-0.624267 --> -0.710976).  Saving model ...
Epoch: 5 cost time: 4.424169063568115
Epoch: 5, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.821 Vali Acc: 0.676 Test Loss: 0.821 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.0189292430877686
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.936 Vali Acc: 0.694 Test Loss: 0.936 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.754538536071777
Epoch: 7, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
Validation loss decreased (-0.710976 --> -0.757220).  Saving model ...
Epoch: 8 cost time: 5.359069585800171
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.544 Vali Acc: 0.815 Test Loss: 0.544 Test Acc: 0.815
Validation loss decreased (-0.757220 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 4.50971794128418
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.824 Vali Acc: 0.786 Test Loss: 0.824 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9015064239501953
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.564 Vali Acc: 0.815 Test Loss: 0.564 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7393438816070557
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9316153526306152
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.544 Vali Acc: 0.827 Test Loss: 0.544 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 5.310764312744141
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.821 Test Loss: 0.603 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.395133018493652
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.815 Test Loss: 0.604 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.389749765396118
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.104773759841919
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.3399388790130615
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.431716680526733
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.832 Test Loss: 0.578 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832364).  Saving model ...
Epoch: 19 cost time: 4.1296961307525635
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.832 Test Loss: 0.586 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.627626180648804
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.974921941757202
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.827 Test Loss: 0.591 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.038246154785156
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.827 Test Loss: 0.595 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.37740159034729
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.821 Test Loss: 0.600 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.333273649215698
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.832 Test Loss: 0.597 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.486226797103882
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.821 Test Loss: 0.606 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.899978399276733
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.832 Test Loss: 0.608 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.165839195251465
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.838 Test Loss: 0.606 Test Acc: 0.838
Validation loss decreased (-0.832364 --> -0.838144).  Saving model ...
Epoch: 28 cost time: 3.586132287979126
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.821 Test Loss: 0.614 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.076889514923096
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.821 Test Loss: 0.620 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.8047425746917725
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.821 Test Loss: 0.619 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.134007930755615
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.821 Test Loss: 0.619 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.906936168670654
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.862200021743774
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.821 Test Loss: 0.624 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.774048566818237
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.821 Test Loss: 0.620 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.905258417129517
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.821 Test Loss: 0.625 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.316590309143066
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.827 Test Loss: 0.623 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.328359842300415
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.832 Test Loss: 0.622 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 90015751
model size : 358.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.9592719078063965
Epoch: 1, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.563 Vali Acc: 0.266 Test Loss: 1.563 Test Acc: 0.266
Validation loss decreased (inf --> -0.265880).  Saving model ...
Epoch: 2 cost time: 4.592653036117554
Epoch: 2, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.329 Vali Acc: 0.451 Test Loss: 1.329 Test Acc: 0.451
Validation loss decreased (-0.265880 --> -0.450854).  Saving model ...
Epoch: 3 cost time: 4.651555776596069
Epoch: 3, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
Validation loss decreased (-0.450854 --> -0.595366).  Saving model ...
Epoch: 4 cost time: 5.314666032791138
Epoch: 4, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.690 Vali Acc: 0.694 Test Loss: 0.690 Test Acc: 0.694
Validation loss decreased (-0.595366 --> -0.693635).  Saving model ...
Epoch: 5 cost time: 4.4505133628845215
Epoch: 5, Steps: 17 | Train Loss: 0.544 Vali Loss: 0.779 Vali Acc: 0.728 Test Loss: 0.779 Test Acc: 0.728
Validation loss decreased (-0.693635 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 4.94231390953064
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.773 Vali Acc: 0.751 Test Loss: 0.773 Test Acc: 0.751
Validation loss decreased (-0.728316 --> -0.751437).  Saving model ...
Epoch: 7 cost time: 4.667746067047119
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.904 Vali Acc: 0.740 Test Loss: 0.904 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.903565406799316
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.913 Vali Acc: 0.734 Test Loss: 0.913 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.814244508743286
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.697 Vali Acc: 0.821 Test Loss: 0.697 Test Acc: 0.821
Validation loss decreased (-0.751437 --> -0.820802).  Saving model ...
Epoch: 10 cost time: 3.2676169872283936
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.863 Vali Acc: 0.751 Test Loss: 0.863 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.244988203048706
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.748 Vali Acc: 0.780 Test Loss: 0.748 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9892916679382324
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.761 Vali Acc: 0.832 Test Loss: 0.761 Test Acc: 0.832
Validation loss decreased (-0.820802 --> -0.832362).  Saving model ...
Epoch: 13 cost time: 3.5024056434631348
Epoch: 13, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.037 Vali Acc: 0.763 Test Loss: 1.037 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.701289653778076
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.070 Vali Acc: 0.757 Test Loss: 1.070 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.367025375366211
Epoch: 15, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.934 Vali Acc: 0.734 Test Loss: 0.934 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.677825212478638
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
Validation loss decreased (-0.832362 --> -0.849706).  Saving model ...
Epoch: 17 cost time: 4.9412007331848145
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.801 Vali Acc: 0.798 Test Loss: 0.801 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.624643564224243
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.839 Vali Acc: 0.838 Test Loss: 0.839 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.9756457805633545
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.602 Vali Acc: 0.827 Test Loss: 0.602 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.82822585105896
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.557 Vali Acc: 0.827 Test Loss: 0.557 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.603706121444702
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.827 Test Loss: 0.593 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.0785088539123535
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.827 Test Loss: 0.632 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.866466045379639
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.821 Test Loss: 0.664 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.962975025177002
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.692691087722778
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.344057321548462
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 96775687
model size : 383.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.3804216384887695
Epoch: 1, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.440 Vali Acc: 0.341 Test Loss: 1.440 Test Acc: 0.341
Validation loss decreased (inf --> -0.341026).  Saving model ...
Epoch: 2 cost time: 4.303714752197266
Epoch: 2, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.088 Vali Acc: 0.509 Test Loss: 1.088 Test Acc: 0.509
Validation loss decreased (-0.341026 --> -0.508660).  Saving model ...
Epoch: 3 cost time: 4.339933633804321
Epoch: 3, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.990 Vali Acc: 0.590 Test Loss: 0.990 Test Acc: 0.590
Validation loss decreased (-0.508660 --> -0.589585).  Saving model ...
Epoch: 4 cost time: 3.7837917804718018
Epoch: 4, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.823 Vali Acc: 0.717 Test Loss: 0.823 Test Acc: 0.717
Validation loss decreased (-0.589585 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 3.9267618656158447
Epoch: 5, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.015 Vali Acc: 0.711 Test Loss: 1.015 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.044881820678711
Epoch: 6, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.859 Vali Acc: 0.734 Test Loss: 0.859 Test Acc: 0.734
Validation loss decreased (-0.716755 --> -0.734095).  Saving model ...
Epoch: 7 cost time: 3.785101890563965
Epoch: 7, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.652 Vali Acc: 0.780 Test Loss: 0.652 Test Acc: 0.780
Validation loss decreased (-0.734095 --> -0.780340).  Saving model ...
Epoch: 8 cost time: 3.7812697887420654
Epoch: 8, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
Validation loss decreased (-0.780340 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 4.53384804725647
Epoch: 9, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.139 Vali Acc: 0.751 Test Loss: 1.139 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.738365650177002
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.906 Vali Acc: 0.723 Test Loss: 0.906 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.9915122985839844
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.742 Vali Acc: 0.803 Test Loss: 0.742 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.383059024810791
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.590231418609619
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.718 Vali Acc: 0.803 Test Loss: 0.718 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.2873005867004395
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.697 Vali Acc: 0.821 Test Loss: 0.697 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820802).  Saving model ...
Epoch: 15 cost time: 5.040364980697632
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.377727746963501
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.821 Test Loss: 0.593 Test Acc: 0.821
Validation loss decreased (-0.820802 --> -0.820803).  Saving model ...
Epoch: 17 cost time: 5.00072169303894
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.815 Test Loss: 0.561 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.302968263626099
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.815 Test Loss: 0.576 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8130042552948
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.815 Test Loss: 0.579 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.3129067420959473
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.821 Test Loss: 0.575 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820804).  Saving model ...
Epoch: 21 cost time: 4.1881163120269775
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.821 Test Loss: 0.572 Test Acc: 0.821
Validation loss decreased (-0.820804 --> -0.820804).  Saving model ...
Epoch: 22 cost time: 4.121252775192261
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.821 Test Loss: 0.575 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.355973482131958
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.821 Test Loss: 0.578 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.85028338432312
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.821 Test Loss: 0.577 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.852825164794922
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.821 Test Loss: 0.582 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.640899181365967
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.827 Test Loss: 0.584 Test Acc: 0.827
Validation loss decreased (-0.820804 --> -0.826584).  Saving model ...
Epoch: 27 cost time: 4.593692779541016
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.827 Test Loss: 0.586 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.789289236068726
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.832 Test Loss: 0.589 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832364).  Saving model ...
Epoch: 29 cost time: 3.9355523586273193
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.821 Test Loss: 0.587 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.4357993602752686
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.821 Test Loss: 0.587 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.226187229156494
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.821 Test Loss: 0.588 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.450261831283569
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.821 Test Loss: 0.590 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.18916392326355
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.821 Test Loss: 0.593 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.492070436477661
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.827 Test Loss: 0.599 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.395065069198608
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.815 Test Loss: 0.602 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.199719429016113
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.6178956031799316
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.821 Test Loss: 0.604 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.230593204498291
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.832 Test Loss: 0.606 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 96706567
model size : 383.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.184507846832275
Epoch: 1, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.350 Vali Acc: 0.486 Test Loss: 1.350 Test Acc: 0.486
Validation loss decreased (inf --> -0.485536).  Saving model ...
Epoch: 2 cost time: 4.245882034301758
Epoch: 2, Steps: 17 | Train Loss: 1.153 Vali Loss: 0.961 Vali Acc: 0.642 Test Loss: 0.961 Test Acc: 0.642
Validation loss decreased (-0.485536 --> -0.641609).  Saving model ...
Epoch: 3 cost time: 4.22597861289978
Epoch: 3, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.958 Vali Acc: 0.566 Test Loss: 0.958 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.205639839172363
Epoch: 4, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.791 Vali Acc: 0.705 Test Loss: 0.791 Test Acc: 0.705
Validation loss decreased (-0.641609 --> -0.705194).  Saving model ...
Epoch: 5 cost time: 5.430587291717529
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.688 Vali Acc: 0.723 Test Loss: 0.688 Test Acc: 0.723
Validation loss decreased (-0.705194 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 5.356491327285767
Epoch: 6, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.595 Vali Acc: 0.786 Test Loss: 0.595 Test Acc: 0.786
Validation loss decreased (-0.722536 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 4.983729362487793
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.654 Vali Acc: 0.798 Test Loss: 0.654 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 4.5410096645355225
Epoch: 8, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.773 Vali Acc: 0.786 Test Loss: 0.773 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.548870325088501
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.722 Vali Acc: 0.786 Test Loss: 0.722 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.41546106338501
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
Validation loss decreased (-0.797681 --> -0.843925).  Saving model ...
Epoch: 11 cost time: 5.4053144454956055
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.838 Vali Acc: 0.723 Test Loss: 0.838 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.377945899963379
Epoch: 12, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.638 Vali Acc: 0.786 Test Loss: 0.638 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.262537240982056
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.741 Vali Acc: 0.780 Test Loss: 0.741 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.632287502288818
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.589 Vali Acc: 0.827 Test Loss: 0.589 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.456214666366577
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.875 Vali Acc: 0.775 Test Loss: 0.875 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.135164260864258
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.829 Vali Acc: 0.769 Test Loss: 0.829 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.143565893173218
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.722 Vali Acc: 0.786 Test Loss: 0.722 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.393749952316284
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.623 Vali Acc: 0.827 Test Loss: 0.623 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.4031150341033936
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.882045745849609
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.780 Test Loss: 0.704 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 96672007
model size : 383.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.749111652374268
Epoch: 1, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.455 Vali Acc: 0.428 Test Loss: 1.455 Test Acc: 0.428
Validation loss decreased (inf --> -0.427731).  Saving model ...
Epoch: 2 cost time: 5.716302156448364
Epoch: 2, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.077 Vali Acc: 0.538 Test Loss: 1.077 Test Acc: 0.538
Validation loss decreased (-0.427731 --> -0.537561).  Saving model ...
Epoch: 3 cost time: 5.910293102264404
Epoch: 3, Steps: 17 | Train Loss: 0.777 Vali Loss: 1.160 Vali Acc: 0.647 Test Loss: 1.160 Test Acc: 0.647
Validation loss decreased (-0.537561 --> -0.647387).  Saving model ...
Epoch: 4 cost time: 7.586429834365845
Epoch: 4, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.760 Vali Acc: 0.723 Test Loss: 0.760 Test Acc: 0.723
Validation loss decreased (-0.647387 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 6.709045648574829
Epoch: 5, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.939 Vali Acc: 0.694 Test Loss: 0.939 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.950361251831055
Epoch: 6, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.630 Vali Acc: 0.780 Test Loss: 0.630 Test Acc: 0.780
Validation loss decreased (-0.722536 --> -0.780341).  Saving model ...
Epoch: 7 cost time: 8.095315217971802
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
Validation loss decreased (-0.780341 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 7.660794973373413
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.659 Vali Acc: 0.798 Test Loss: 0.659 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.940032482147217
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.591 Vali Acc: 0.786 Test Loss: 0.591 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.350561618804932
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.674 Vali Acc: 0.775 Test Loss: 0.674 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.684412240982056
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.633 Vali Acc: 0.798 Test Loss: 0.633 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.849736452102661
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.900 Vali Acc: 0.740 Test Loss: 0.900 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.027496814727783
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.022 Vali Acc: 0.699 Test Loss: 1.022 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.788100004196167
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815022).  Saving model ...
Epoch: 15 cost time: 7.955188035964966
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.874 Vali Acc: 0.803 Test Loss: 0.874 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.458018064498901
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.083 Vali Acc: 0.757 Test Loss: 1.083 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.457930088043213
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.478978395462036
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.685 Vali Acc: 0.769 Test Loss: 0.685 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.955110549926758
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.63519549369812
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.792 Test Loss: 0.579 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.104245662689209
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.3725175857543945
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.439278602600098
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.798 Test Loss: 0.593 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.530006408691406
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.821 Test Loss: 0.589 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820803).  Saving model ...
Epoch: 25 cost time: 6.681683778762817
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.821 Test Loss: 0.588 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820803).  Saving model ...
Epoch: 26 cost time: 7.534453392028809
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.809 Test Loss: 0.603 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.38778829574585
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.217594861984253
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.2572386264801025
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.090943813323975
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.894255638122559
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.815 Test Loss: 0.620 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.079260587692261
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.815 Test Loss: 0.627 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.847665786743164
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.798 Test Loss: 0.637 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.839942693710327
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.798 Test Loss: 0.639 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.11857533454895
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.798 Test Loss: 0.642 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 107827975
model size : 426.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.824110746383667
Epoch: 1, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.427 Vali Acc: 0.393 Test Loss: 1.427 Test Acc: 0.393
Validation loss decreased (inf --> -0.393049).  Saving model ...
Epoch: 2 cost time: 6.307018041610718
Epoch: 2, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.190 Vali Acc: 0.439 Test Loss: 1.190 Test Acc: 0.439
Validation loss decreased (-0.393049 --> -0.439294).  Saving model ...
Epoch: 3 cost time: 5.437342166900635
Epoch: 3, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.153 Vali Acc: 0.699 Test Loss: 1.153 Test Acc: 0.699
Validation loss decreased (-0.439294 --> -0.699410).  Saving model ...
Epoch: 4 cost time: 8.186707258224487
Epoch: 4, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.833 Vali Acc: 0.699 Test Loss: 0.833 Test Acc: 0.699
Validation loss decreased (-0.699410 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 7.740222930908203
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.736 Vali Acc: 0.751 Test Loss: 0.736 Test Acc: 0.751
Validation loss decreased (-0.699414 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 7.862094163894653
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.749 Vali Acc: 0.734 Test Loss: 0.749 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.076842069625854
Epoch: 7, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
Validation loss decreased (-0.751438 --> -0.803461).  Saving model ...
Epoch: 8 cost time: 7.27774453163147
Epoch: 8, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.743 Vali Acc: 0.769 Test Loss: 0.743 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.461214303970337
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.731 Vali Acc: 0.734 Test Loss: 0.731 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.37614369392395
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.761 Vali Acc: 0.734 Test Loss: 0.761 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.755238056182861
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.065 Vali Acc: 0.769 Test Loss: 1.065 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.650949478149414
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.051 Vali Acc: 0.740 Test Loss: 1.051 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.873401403427124
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.714 Vali Acc: 0.786 Test Loss: 0.714 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.594885349273682
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.691 Vali Acc: 0.780 Test Loss: 0.691 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.430104494094849
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.234 Vali Acc: 0.786 Test Loss: 1.234 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.102924585342407
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.950 Vali Acc: 0.803 Test Loss: 0.950 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.290334701538086
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
Validation loss decreased (-0.803461 --> -0.849705).  Saving model ...
Epoch: 18 cost time: 7.023008584976196
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.832 Test Loss: 0.631 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.923803329467773
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.821 Test Loss: 0.572 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.650055170059204
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.821 Test Loss: 0.541 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.506431579589844
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.011295795440674
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.667699575424194
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.035258054733276
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.815 Test Loss: 0.555 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.696524143218994
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.815 Test Loss: 0.554 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.417295455932617
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.16797947883606
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 107779591
model size : 425.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.39978814125061
Epoch: 1, Steps: 17 | Train Loss: 1.728 Vali Loss: 1.340 Vali Acc: 0.462 Test Loss: 1.340 Test Acc: 0.462
Validation loss decreased (inf --> -0.462414).  Saving model ...
Epoch: 2 cost time: 7.465301752090454
Epoch: 2, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.080 Vali Acc: 0.566 Test Loss: 1.080 Test Acc: 0.566
Validation loss decreased (-0.462414 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 7.032980442047119
Epoch: 3, Steps: 17 | Train Loss: 0.787 Vali Loss: 0.773 Vali Acc: 0.734 Test Loss: 0.773 Test Acc: 0.734
Validation loss decreased (-0.566463 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 7.333416223526001
Epoch: 4, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.598 Vali Acc: 0.763 Test Loss: 0.598 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.763000).  Saving model ...
Epoch: 5 cost time: 7.7545177936553955
Epoch: 5, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.587 Vali Acc: 0.780 Test Loss: 0.587 Test Acc: 0.780
Validation loss decreased (-0.763000 --> -0.780341).  Saving model ...
Epoch: 6 cost time: 6.800561904907227
Epoch: 6, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.716 Vali Acc: 0.798 Test Loss: 0.716 Test Acc: 0.798
Validation loss decreased (-0.780341 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 5.465443134307861
Epoch: 7, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.734 Vali Acc: 0.769 Test Loss: 0.734 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.856320142745972
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.48949408531189
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.478 Vali Acc: 0.821 Test Loss: 0.478 Test Acc: 0.821
Validation loss decreased (-0.797681 --> -0.820804).  Saving model ...
Epoch: 10 cost time: 6.453080654144287
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.657 Vali Acc: 0.838 Test Loss: 0.657 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838144).  Saving model ...
Epoch: 11 cost time: 6.129067659378052
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.611 Vali Acc: 0.775 Test Loss: 0.611 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.998437404632568
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.697 Vali Acc: 0.757 Test Loss: 0.697 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.021233797073364
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.547 Vali Acc: 0.832 Test Loss: 0.547 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.351673364639282
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.524 Vali Acc: 0.832 Test Loss: 0.524 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.03397536277771
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.682 Vali Acc: 0.769 Test Loss: 0.682 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.826350688934326
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.827 Test Loss: 0.676 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.832475185394287
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.821 Test Loss: 0.609 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.650224685668945
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.827 Test Loss: 0.561 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.077264785766602
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.540 Vali Acc: 0.855 Test Loss: 0.540 Test Acc: 0.855
Validation loss decreased (-0.838144 --> -0.855486).  Saving model ...
Epoch: 20 cost time: 5.563233852386475
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.832 Test Loss: 0.555 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.51822566986084
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.832 Test Loss: 0.550 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.583119630813599
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.486391544342041
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.832 Test Loss: 0.555 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.11478590965271
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.844 Test Loss: 0.554 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.03532862663269
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.821 Test Loss: 0.572 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.222235918045044
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.271738290786743
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.821 Test Loss: 0.598 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.811199903488159
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.584853887557983
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.821 Test Loss: 0.586 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el6_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 107751943
model size : 425.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.214578628540039
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.553 Vali Acc: 0.254 Test Loss: 1.553 Test Acc: 0.254
Validation loss decreased (inf --> -0.254320).  Saving model ...
Epoch: 2 cost time: 3.823720693588257
Epoch: 2, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.345 Vali Acc: 0.509 Test Loss: 1.345 Test Acc: 0.509
Validation loss decreased (-0.254320 --> -0.508657).  Saving model ...
Epoch: 3 cost time: 2.4993999004364014
Epoch: 3, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.242 Vali Acc: 0.561 Test Loss: 1.242 Test Acc: 0.561
Validation loss decreased (-0.508657 --> -0.560681).  Saving model ...
Epoch: 4 cost time: 3.4376206398010254
Epoch: 4, Steps: 17 | Train Loss: 0.644 Vali Loss: 1.049 Vali Acc: 0.676 Test Loss: 1.049 Test Acc: 0.676
Validation loss decreased (-0.560681 --> -0.676290).  Saving model ...
Epoch: 5 cost time: 3.6746809482574463
Epoch: 5, Steps: 17 | Train Loss: 0.561 Vali Loss: 1.037 Vali Acc: 0.647 Test Loss: 1.037 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.354999303817749
Epoch: 6, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.999 Vali Acc: 0.653 Test Loss: 0.999 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.115204095840454
Epoch: 7, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.865 Vali Acc: 0.723 Test Loss: 0.865 Test Acc: 0.723
Validation loss decreased (-0.676290 --> -0.722535).  Saving model ...
Epoch: 8 cost time: 3.158738851547241
Epoch: 8, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.824 Vali Acc: 0.740 Test Loss: 0.824 Test Acc: 0.740
Validation loss decreased (-0.722535 --> -0.739876).  Saving model ...
Epoch: 9 cost time: 3.5844807624816895
Epoch: 9, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.633 Vali Acc: 0.832 Test Loss: 0.633 Test Acc: 0.832
Validation loss decreased (-0.739876 --> -0.832364).  Saving model ...
Epoch: 10 cost time: 3.0035314559936523
Epoch: 10, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.981 Vali Acc: 0.780 Test Loss: 0.981 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0510616302490234
Epoch: 11, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.174 Vali Acc: 0.775 Test Loss: 1.174 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.92069673538208
Epoch: 12, Steps: 17 | Train Loss: 0.265 Vali Loss: 1.123 Vali Acc: 0.717 Test Loss: 1.123 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.858062267303467
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.296 Vali Acc: 0.798 Test Loss: 1.296 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0444531440734863
Epoch: 14, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.523 Vali Acc: 0.705 Test Loss: 2.523 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3272531032562256
Epoch: 15, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.013 Vali Acc: 0.815 Test Loss: 1.013 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4297242164611816
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.364 Vali Acc: 0.740 Test Loss: 1.364 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5889647006988525
Epoch: 17, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.270 Vali Acc: 0.775 Test Loss: 1.270 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.233566999435425
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 2.112 Vali Acc: 0.740 Test Loss: 2.112 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2082061767578125
Epoch: 19, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.298 Vali Acc: 0.769 Test Loss: 1.298 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 50088967
model size : 205.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.372729778289795
Epoch: 1, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.609 Vali Acc: 0.260 Test Loss: 1.609 Test Acc: 0.260
Validation loss decreased (inf --> -0.260100).  Saving model ...
Epoch: 2 cost time: 2.9030237197875977
Epoch: 2, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.444 Vali Acc: 0.434 Test Loss: 1.444 Test Acc: 0.434
Validation loss decreased (-0.260100 --> -0.433512).  Saving model ...
Epoch: 3 cost time: 3.0222041606903076
Epoch: 3, Steps: 17 | Train Loss: 1.033 Vali Loss: 0.881 Vali Acc: 0.636 Test Loss: 0.881 Test Acc: 0.636
Validation loss decreased (-0.433512 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 2.481778383255005
Epoch: 4, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.027 Vali Acc: 0.538 Test Loss: 1.027 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.766444444656372
Epoch: 5, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
Validation loss decreased (-0.635829 --> -0.716756).  Saving model ...
Epoch: 6 cost time: 1.9081785678863525
Epoch: 6, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.927 Vali Acc: 0.647 Test Loss: 0.927 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1200530529022217
Epoch: 7, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.739 Vali Acc: 0.705 Test Loss: 0.739 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.939028263092041
Epoch: 8, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.859 Vali Acc: 0.763 Test Loss: 0.859 Test Acc: 0.763
Validation loss decreased (-0.716756 --> -0.762997).  Saving model ...
Epoch: 9 cost time: 2.206346273422241
Epoch: 9, Steps: 17 | Train Loss: 0.293 Vali Loss: 1.441 Vali Acc: 0.665 Test Loss: 1.441 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5079147815704346
Epoch: 10, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.799 Vali Acc: 0.746 Test Loss: 0.799 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7066547870635986
Epoch: 11, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.124 Vali Acc: 0.740 Test Loss: 1.124 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7605650424957275
Epoch: 12, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.987 Vali Acc: 0.775 Test Loss: 0.987 Test Acc: 0.775
Validation loss decreased (-0.762997 --> -0.774557).  Saving model ...
Epoch: 13 cost time: 2.446932077407837
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.437 Vali Acc: 0.723 Test Loss: 1.437 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1813206672668457
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.510 Vali Acc: 0.751 Test Loss: 1.510 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.049379825592041
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.090 Vali Acc: 0.775 Test Loss: 1.090 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.152003049850464
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.265 Vali Acc: 0.809 Test Loss: 1.265 Test Acc: 0.809
Validation loss decreased (-0.774557 --> -0.809236).  Saving model ...
Epoch: 17 cost time: 2.2616145610809326
Epoch: 17, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.743 Vali Acc: 0.798 Test Loss: 0.743 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4336647987365723
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.200 Vali Acc: 0.798 Test Loss: 1.200 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6832079887390137
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.224 Vali Acc: 0.792 Test Loss: 1.224 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9279260635375977
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.076 Vali Acc: 0.780 Test Loss: 1.076 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.773892402648926
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.289 Vali Acc: 0.775 Test Loss: 1.289 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.901867389678955
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.535 Vali Acc: 0.792 Test Loss: 1.535 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3151097297668457
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 2.024 Vali Acc: 0.763 Test Loss: 2.024 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.834115505218506
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.599 Vali Acc: 0.775 Test Loss: 1.599 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.884911298751831
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.716 Vali Acc: 0.723 Test Loss: 1.716 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.074026346206665
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.316 Vali Acc: 0.780 Test Loss: 1.316 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 49929991
model size : 205.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.701663970947266
Epoch: 1, Steps: 17 | Train Loss: 1.822 Vali Loss: 1.592 Vali Acc: 0.289 Test Loss: 1.592 Test Acc: 0.289
Validation loss decreased (inf --> -0.289001).  Saving model ...
Epoch: 2 cost time: 2.561915397644043
Epoch: 2, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
Validation loss decreased (-0.289001 --> -0.514439).  Saving model ...
Epoch: 3 cost time: 2.5818541049957275
Epoch: 3, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.903 Vali Acc: 0.636 Test Loss: 0.903 Test Acc: 0.636
Validation loss decreased (-0.514439 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 2.181225299835205
Epoch: 4, Steps: 17 | Train Loss: 0.568 Vali Loss: 1.065 Vali Acc: 0.601 Test Loss: 1.065 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.375623941421509
Epoch: 5, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.816 Vali Acc: 0.728 Test Loss: 0.816 Test Acc: 0.728
Validation loss decreased (-0.635829 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 2.3204345703125
Epoch: 6, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.018 Vali Acc: 0.630 Test Loss: 1.018 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.767343282699585
Epoch: 7, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.200 Vali Acc: 0.653 Test Loss: 1.200 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.160975456237793
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.788 Vali Acc: 0.786 Test Loss: 0.788 Test Acc: 0.786
Validation loss decreased (-0.728316 --> -0.786119).  Saving model ...
Epoch: 9 cost time: 1.610276222229004
Epoch: 9, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.695 Vali Acc: 0.775 Test Loss: 0.695 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.542154550552368
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.981 Vali Acc: 0.815 Test Loss: 0.981 Test Acc: 0.815
Validation loss decreased (-0.786119 --> -0.815019).  Saving model ...
Epoch: 11 cost time: 2.1404292583465576
Epoch: 11, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.359 Vali Acc: 0.647 Test Loss: 1.359 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.301424503326416
Epoch: 12, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.662 Vali Acc: 0.798 Test Loss: 0.662 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3618111610412598
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.754 Vali Acc: 0.827 Test Loss: 0.754 Test Acc: 0.827
Validation loss decreased (-0.815019 --> -0.826582).  Saving model ...
Epoch: 14 cost time: 2.5628809928894043
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.076 Vali Acc: 0.740 Test Loss: 1.076 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1981444358825684
Epoch: 15, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.973 Vali Acc: 0.757 Test Loss: 0.973 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2038002014160156
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.542 Vali Acc: 0.884 Test Loss: 0.542 Test Acc: 0.884
Validation loss decreased (-0.826582 --> -0.884388).  Saving model ...
Epoch: 17 cost time: 2.141916275024414
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.793 Vali Acc: 0.792 Test Loss: 0.793 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2070913314819336
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.815 Test Loss: 0.710 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.429137706756592
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.821 Test Loss: 0.700 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2687416076660156
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.155 Vali Acc: 0.803 Test Loss: 1.155 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4474141597747803
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.788 Vali Acc: 0.815 Test Loss: 0.788 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4143059253692627
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.860 Vali Acc: 0.780 Test Loss: 0.860 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4244701862335205
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.775 Test Loss: 0.829 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5206093788146973
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.803 Test Loss: 0.750 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.407449245452881
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.815 Test Loss: 0.688 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4350714683532715
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.643 Vali Acc: 0.827 Test Loss: 0.643 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 49771015
model size : 204.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.3566601276397705
Epoch: 1, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.501 Vali Acc: 0.364 Test Loss: 1.501 Test Acc: 0.364
Validation loss decreased (inf --> -0.364147).  Saving model ...
Epoch: 2 cost time: 2.8761115074157715
Epoch: 2, Steps: 17 | Train Loss: 1.298 Vali Loss: 0.996 Vali Acc: 0.566 Test Loss: 0.996 Test Acc: 0.566
Validation loss decreased (-0.364147 --> -0.566464).  Saving model ...
Epoch: 3 cost time: 3.6130034923553467
Epoch: 3, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.782 Vali Acc: 0.312 Test Loss: 1.782 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7808170318603516
Epoch: 4, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.990 Vali Acc: 0.653 Test Loss: 0.990 Test Acc: 0.653
Validation loss decreased (-0.566464 --> -0.653169).  Saving model ...
Epoch: 5 cost time: 3.271500587463379
Epoch: 5, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.606 Vali Acc: 0.769 Test Loss: 0.606 Test Acc: 0.769
Validation loss decreased (-0.653169 --> -0.768780).  Saving model ...
Epoch: 6 cost time: 3.586958885192871
Epoch: 6, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.906 Vali Acc: 0.699 Test Loss: 0.906 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7360587120056152
Epoch: 7, Steps: 17 | Train Loss: 0.323 Vali Loss: 1.681 Vali Acc: 0.590 Test Loss: 1.681 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.805393695831299
Epoch: 8, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.823 Vali Acc: 0.746 Test Loss: 0.823 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.427119016647339
Epoch: 9, Steps: 17 | Train Loss: 0.320 Vali Loss: 1.464 Vali Acc: 0.711 Test Loss: 1.464 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.625868082046509
Epoch: 10, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.974 Vali Acc: 0.671 Test Loss: 0.974 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8660097122192383
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.321 Vali Acc: 0.780 Test Loss: 1.321 Test Acc: 0.780
Validation loss decreased (-0.768780 --> -0.780334).  Saving model ...
Epoch: 12 cost time: 3.2788572311401367
Epoch: 12, Steps: 17 | Train Loss: 0.263 Vali Loss: 1.249 Vali Acc: 0.792 Test Loss: 1.249 Test Acc: 0.792
Validation loss decreased (-0.780334 --> -0.791895).  Saving model ...
Epoch: 13 cost time: 3.3810930252075195
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.414 Vali Acc: 0.728 Test Loss: 1.414 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4016318321228027
Epoch: 14, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.200 Vali Acc: 0.821 Test Loss: 1.200 Test Acc: 0.821
Validation loss decreased (-0.791895 --> -0.820797).  Saving model ...
Epoch: 15 cost time: 3.8030290603637695
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.192 Vali Acc: 0.815 Test Loss: 1.192 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.154698371887207
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.456 Vali Acc: 0.780 Test Loss: 1.456 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2915093898773193
Epoch: 17, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.904 Vali Acc: 0.763 Test Loss: 1.904 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8320658206939697
Epoch: 18, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.108 Vali Acc: 0.803 Test Loss: 1.108 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.999098539352417
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.184 Vali Acc: 0.734 Test Loss: 2.184 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5780444145202637
Epoch: 20, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.427 Vali Acc: 0.780 Test Loss: 1.427 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2175347805023193
Epoch: 21, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.501 Vali Acc: 0.792 Test Loss: 1.501 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.3542442321777344
Epoch: 22, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.882 Vali Acc: 0.780 Test Loss: 1.882 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.707371711730957
Epoch: 23, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.988 Vali Acc: 0.798 Test Loss: 1.988 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.525970697402954
Epoch: 24, Steps: 17 | Train Loss: 0.334 Vali Loss: 2.716 Vali Acc: 0.699 Test Loss: 2.716 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 52300807
model size : 214.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.8651323318481445
Epoch: 1, Steps: 17 | Train Loss: 1.942 Vali Loss: 1.630 Vali Acc: 0.249 Test Loss: 1.630 Test Acc: 0.249
Validation loss decreased (inf --> -0.248539).  Saving model ...
Epoch: 2 cost time: 2.6998448371887207
Epoch: 2, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
Validation loss decreased (-0.248539 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 2.3233349323272705
Epoch: 3, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.996 Vali Acc: 0.601 Test Loss: 0.996 Test Acc: 0.601
Validation loss decreased (-0.485537 --> -0.601146).  Saving model ...
Epoch: 4 cost time: 2.257812976837158
Epoch: 4, Steps: 17 | Train Loss: 0.665 Vali Loss: 0.715 Vali Acc: 0.740 Test Loss: 0.715 Test Acc: 0.740
Validation loss decreased (-0.601146 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 2.506861925125122
Epoch: 5, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.852 Vali Acc: 0.688 Test Loss: 0.852 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.651719570159912
Epoch: 6, Steps: 17 | Train Loss: 0.341 Vali Loss: 1.066 Vali Acc: 0.694 Test Loss: 1.066 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.482414484024048
Epoch: 7, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.600 Vali Acc: 0.769 Test Loss: 0.600 Test Acc: 0.769
Validation loss decreased (-0.739877 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 2.5577733516693115
Epoch: 8, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.684 Vali Acc: 0.786 Test Loss: 0.684 Test Acc: 0.786
Validation loss decreased (-0.768780 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.6671135425567627
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.839 Vali Acc: 0.775 Test Loss: 0.839 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3536458015441895
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.836 Vali Acc: 0.751 Test Loss: 0.836 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4443278312683105
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.845 Vali Acc: 0.734 Test Loss: 0.845 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6117024421691895
Epoch: 12, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.231 Vali Acc: 0.757 Test Loss: 1.231 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4459407329559326
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.528 Vali Acc: 0.861 Test Loss: 0.528 Test Acc: 0.861
Validation loss decreased (-0.786120 --> -0.861266).  Saving model ...
Epoch: 14 cost time: 2.2736194133758545
Epoch: 14, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.485 Vali Acc: 0.740 Test Loss: 1.485 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8621046543121338
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.779 Vali Acc: 0.827 Test Loss: 0.779 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.190859079360962
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.943 Vali Acc: 0.798 Test Loss: 0.943 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5109806060791016
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.660 Vali Acc: 0.815 Test Loss: 0.660 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.852449655532837
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.253 Vali Acc: 0.780 Test Loss: 1.253 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5021004676818848
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.290 Vali Acc: 0.786 Test Loss: 1.290 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4612698554992676
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.809 Vali Acc: 0.844 Test Loss: 0.809 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5672545433044434
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.823 Vali Acc: 0.792 Test Loss: 0.823 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.9204673767089844
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.233 Vali Acc: 0.757 Test Loss: 1.233 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0158462524414062
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.906 Vali Acc: 0.734 Test Loss: 1.906 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 52065799
model size : 213.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.694857597351074
Epoch: 1, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.547 Vali Acc: 0.382 Test Loss: 1.547 Test Acc: 0.382
Validation loss decreased (inf --> -0.381487).  Saving model ...
Epoch: 2 cost time: 2.208332061767578
Epoch: 2, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.159 Vali Acc: 0.509 Test Loss: 1.159 Test Acc: 0.509
Validation loss decreased (-0.381487 --> -0.508659).  Saving model ...
Epoch: 3 cost time: 2.1376187801361084
Epoch: 3, Steps: 17 | Train Loss: 0.933 Vali Loss: 0.963 Vali Acc: 0.630 Test Loss: 0.963 Test Acc: 0.630
Validation loss decreased (-0.508659 --> -0.630048).  Saving model ...
Epoch: 4 cost time: 2.6828806400299072
Epoch: 4, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
Validation loss decreased (-0.630048 --> -0.757219).  Saving model ...
Epoch: 5 cost time: 2.674607515335083
Epoch: 5, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.771 Vali Acc: 0.728 Test Loss: 0.771 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5446102619171143
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.775 Vali Acc: 0.665 Test Loss: 0.775 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4281346797943115
Epoch: 7, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.895 Vali Acc: 0.740 Test Loss: 0.895 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.452585220336914
Epoch: 8, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.758 Vali Acc: 0.699 Test Loss: 0.758 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.545513868331909
Epoch: 9, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.063 Vali Acc: 0.682 Test Loss: 1.063 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4366109371185303
Epoch: 10, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
Validation loss decreased (-0.757219 --> -0.774559).  Saving model ...
Epoch: 11 cost time: 2.2170803546905518
Epoch: 11, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.761 Vali Acc: 0.821 Test Loss: 0.761 Test Acc: 0.821
Validation loss decreased (-0.774559 --> -0.820802).  Saving model ...
Epoch: 12 cost time: 2.0726003646850586
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.532 Vali Acc: 0.827 Test Loss: 0.532 Test Acc: 0.827
Validation loss decreased (-0.820802 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 2.3280346393585205
Epoch: 13, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.156 Vali Acc: 0.751 Test Loss: 1.156 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4936580657958984
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.806 Vali Acc: 0.792 Test Loss: 0.806 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0966439247131348
Epoch: 15, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.518 Vali Acc: 0.757 Test Loss: 1.518 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9866960048675537
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.131 Vali Acc: 0.746 Test Loss: 1.131 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8735580444335938
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1336488723754883
Epoch: 18, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.078 Vali Acc: 0.699 Test Loss: 1.078 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1970207691192627
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.239 Vali Acc: 0.751 Test Loss: 1.239 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.773132085800171
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.350 Vali Acc: 0.780 Test Loss: 1.350 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.358100414276123
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.169 Vali Acc: 0.792 Test Loss: 1.169 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7550036907196045
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.860 Vali Acc: 0.827 Test Loss: 0.860 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 51962119
model size : 212.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.322897672653198
Epoch: 1, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.595 Vali Acc: 0.243 Test Loss: 1.595 Test Acc: 0.243
Validation loss decreased (inf --> -0.242759).  Saving model ...
Epoch: 2 cost time: 3.88335919380188
Epoch: 2, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.103 Vali Acc: 0.584 Test Loss: 1.103 Test Acc: 0.584
Validation loss decreased (-0.242759 --> -0.583804).  Saving model ...
Epoch: 3 cost time: 3.670734405517578
Epoch: 3, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.063 Vali Acc: 0.671 Test Loss: 1.063 Test Acc: 0.671
Validation loss decreased (-0.583804 --> -0.670510).  Saving model ...
Epoch: 4 cost time: 3.535987377166748
Epoch: 4, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.914 Vali Acc: 0.676 Test Loss: 0.914 Test Acc: 0.676
Validation loss decreased (-0.670510 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 3.494119167327881
Epoch: 5, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.866 Vali Acc: 0.682 Test Loss: 0.866 Test Acc: 0.682
Validation loss decreased (-0.676291 --> -0.682072).  Saving model ...
Epoch: 6 cost time: 3.513951539993286
Epoch: 6, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.945 Vali Acc: 0.763 Test Loss: 0.945 Test Acc: 0.763
Validation loss decreased (-0.682072 --> -0.762996).  Saving model ...
Epoch: 7 cost time: 4.166327238082886
Epoch: 7, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.286 Vali Acc: 0.665 Test Loss: 1.286 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.834709405899048
Epoch: 8, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.066 Vali Acc: 0.682 Test Loss: 1.066 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7655036449432373
Epoch: 9, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.745 Vali Acc: 0.647 Test Loss: 1.745 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6528613567352295
Epoch: 10, Steps: 17 | Train Loss: 0.606 Vali Loss: 1.691 Vali Acc: 0.613 Test Loss: 1.691 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4285011291503906
Epoch: 11, Steps: 17 | Train Loss: 0.489 Vali Loss: 1.123 Vali Acc: 0.740 Test Loss: 1.123 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7059102058410645
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.235 Vali Acc: 0.769 Test Loss: 1.235 Test Acc: 0.769
Validation loss decreased (-0.762996 --> -0.768774).  Saving model ...
Epoch: 13 cost time: 3.2987313270568848
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.393 Vali Acc: 0.769 Test Loss: 1.393 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.202049732208252
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.554 Vali Acc: 0.688 Test Loss: 1.554 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4037129878997803
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.887 Vali Acc: 0.688 Test Loss: 1.887 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.866417169570923
Epoch: 16, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.219 Vali Acc: 0.751 Test Loss: 1.219 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5482571125030518
Epoch: 17, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.261 Vali Acc: 0.780 Test Loss: 1.261 Test Acc: 0.780
Validation loss decreased (-0.768774 --> -0.780334).  Saving model ...
Epoch: 18 cost time: 3.1494295597076416
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.830 Vali Acc: 0.803 Test Loss: 1.830 Test Acc: 0.803
Validation loss decreased (-0.780334 --> -0.803450).  Saving model ...
Epoch: 19 cost time: 2.996533155441284
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 2.288 Vali Acc: 0.763 Test Loss: 2.288 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2310404777526855
Epoch: 20, Steps: 17 | Train Loss: 0.122 Vali Loss: 2.984 Vali Acc: 0.659 Test Loss: 2.984 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.555553436279297
Epoch: 21, Steps: 17 | Train Loss: 0.196 Vali Loss: 2.520 Vali Acc: 0.775 Test Loss: 2.520 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2783565521240234
Epoch: 22, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.936 Vali Acc: 0.798 Test Loss: 0.936 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.890014410018921
Epoch: 23, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.530 Vali Acc: 0.775 Test Loss: 1.530 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.77675724029541
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.421 Vali Acc: 0.844 Test Loss: 1.421 Test Acc: 0.844
Validation loss decreased (-0.803450 --> -0.843916).  Saving model ...
Epoch: 25 cost time: 2.8653206825256348
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.640 Vali Acc: 0.838 Test Loss: 1.640 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.168440580368042
Epoch: 26, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.681 Vali Acc: 0.815 Test Loss: 1.681 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.873380184173584
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.334 Vali Acc: 0.792 Test Loss: 2.334 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6716222763061523
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.688 Vali Acc: 0.821 Test Loss: 1.688 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.9965591430664062
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.815 Test Loss: 1.702 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6525542736053467
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.815 Test Loss: 1.663 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.4790523052215576
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.815 Test Loss: 1.652 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.8183062076568604
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.815 Test Loss: 1.637 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.1184616088867188
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.803 Test Loss: 1.638 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.321119546890259
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.803 Test Loss: 1.617 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 54519559
model size : 222.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.372924089431763
Epoch: 1, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.468 Vali Acc: 0.532 Test Loss: 1.468 Test Acc: 0.532
Validation loss decreased (inf --> -0.531777).  Saving model ...
Epoch: 2 cost time: 3.8648693561553955
Epoch: 2, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.513 Vali Acc: 0.393 Test Loss: 1.513 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9548089504241943
Epoch: 3, Steps: 17 | Train Loss: 1.135 Vali Loss: 0.944 Vali Acc: 0.624 Test Loss: 0.944 Test Acc: 0.624
Validation loss decreased (-0.531777 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 2.7733983993530273
Epoch: 4, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.797 Vali Acc: 0.659 Test Loss: 0.797 Test Acc: 0.659
Validation loss decreased (-0.624268 --> -0.658952).  Saving model ...
Epoch: 5 cost time: 3.4672906398773193
Epoch: 5, Steps: 17 | Train Loss: 0.446 Vali Loss: 1.062 Vali Acc: 0.699 Test Loss: 1.062 Test Acc: 0.699
Validation loss decreased (-0.658952 --> -0.699411).  Saving model ...
Epoch: 6 cost time: 2.3684613704681396
Epoch: 6, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.679 Vali Acc: 0.786 Test Loss: 0.679 Test Acc: 0.786
Validation loss decreased (-0.699411 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 2.3372366428375244
Epoch: 7, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.018 Vali Acc: 0.659 Test Loss: 1.018 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5058414936065674
Epoch: 8, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.879 Vali Acc: 0.734 Test Loss: 0.879 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.301654815673828
Epoch: 9, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.992 Vali Acc: 0.746 Test Loss: 0.992 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.578805446624756
Epoch: 10, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.463 Vali Acc: 0.711 Test Loss: 1.463 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.428088665008545
Epoch: 11, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.672 Vali Acc: 0.798 Test Loss: 0.672 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797681).  Saving model ...
Epoch: 12 cost time: 2.6396679878234863
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.000 Vali Acc: 0.757 Test Loss: 1.000 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.000962734222412
Epoch: 13, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.210 Vali Acc: 0.809 Test Loss: 1.210 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809236).  Saving model ...
Epoch: 14 cost time: 3.019552230834961
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.897 Vali Acc: 0.792 Test Loss: 0.897 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0442519187927246
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.926 Vali Acc: 0.786 Test Loss: 0.926 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6893489360809326
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.009 Vali Acc: 0.809 Test Loss: 1.009 Test Acc: 0.809
Validation loss decreased (-0.809236 --> -0.809238).  Saving model ...
Epoch: 17 cost time: 3.4450221061706543
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.099 Vali Acc: 0.832 Test Loss: 1.099 Test Acc: 0.832
Validation loss decreased (-0.809238 --> -0.832359).  Saving model ...
Epoch: 18 cost time: 3.598505973815918
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.008 Vali Acc: 0.821 Test Loss: 1.008 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.458866596221924
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.079 Vali Acc: 0.717 Test Loss: 2.079 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6916472911834717
Epoch: 20, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.905 Vali Acc: 0.832 Test Loss: 0.905 Test Acc: 0.832
Validation loss decreased (-0.832359 --> -0.832361).  Saving model ...
Epoch: 21 cost time: 2.342845916748047
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.786 Vali Acc: 0.844 Test Loss: 0.786 Test Acc: 0.844
Validation loss decreased (-0.832361 --> -0.843923).  Saving model ...
Epoch: 22 cost time: 3.051525354385376
Epoch: 22, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.232 Vali Acc: 0.792 Test Loss: 1.232 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8350088596343994
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.552 Vali Acc: 0.769 Test Loss: 1.552 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.878777265548706
Epoch: 24, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.861 Vali Acc: 0.786 Test Loss: 1.861 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.296922206878662
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.973 Vali Acc: 0.740 Test Loss: 1.973 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.590486764907837
Epoch: 26, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.983 Vali Acc: 0.792 Test Loss: 0.983 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2297325134277344
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.673 Vali Acc: 0.786 Test Loss: 1.673 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.2909445762634277
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.417 Vali Acc: 0.827 Test Loss: 1.417 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3554742336273193
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.061 Vali Acc: 0.780 Test Loss: 2.061 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.920459032058716
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.707 Vali Acc: 0.809 Test Loss: 1.707 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.386272430419922
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.502 Vali Acc: 0.798 Test Loss: 1.502 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 54284551
model size : 221.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.2303993701934814
Epoch: 1, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.504 Vali Acc: 0.416 Test Loss: 1.504 Test Acc: 0.416
Validation loss decreased (inf --> -0.416170).  Saving model ...
Epoch: 2 cost time: 2.672128915786743
Epoch: 2, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.257 Vali Acc: 0.532 Test Loss: 1.257 Test Acc: 0.532
Validation loss decreased (-0.416170 --> -0.531779).  Saving model ...
Epoch: 3 cost time: 2.0753612518310547
Epoch: 3, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.974 Vali Acc: 0.613 Test Loss: 0.974 Test Acc: 0.613
Validation loss decreased (-0.531779 --> -0.612707).  Saving model ...
Epoch: 4 cost time: 2.1799886226654053
Epoch: 4, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.745 Vali Acc: 0.688 Test Loss: 0.745 Test Acc: 0.688
Validation loss decreased (-0.612707 --> -0.687854).  Saving model ...
Epoch: 5 cost time: 3.21801495552063
Epoch: 5, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.690 Vali Acc: 0.769 Test Loss: 0.690 Test Acc: 0.769
Validation loss decreased (-0.687854 --> -0.768779).  Saving model ...
Epoch: 6 cost time: 2.8508784770965576
Epoch: 6, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.683 Vali Acc: 0.757 Test Loss: 0.683 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.456554651260376
Epoch: 7, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.693 Vali Acc: 0.734 Test Loss: 0.693 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6043384075164795
Epoch: 8, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.756 Vali Acc: 0.751 Test Loss: 0.756 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1696255207061768
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774560).  Saving model ...
Epoch: 10 cost time: 3.8542447090148926
Epoch: 10, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.855 Vali Acc: 0.734 Test Loss: 0.855 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9441235065460205
Epoch: 11, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.007 Vali Acc: 0.717 Test Loss: 1.007 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.0271453857421875
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.988 Vali Acc: 0.792 Test Loss: 0.988 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791898).  Saving model ...
Epoch: 13 cost time: 3.906658172607422
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.692 Vali Acc: 0.786 Test Loss: 0.692 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.965540647506714
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.984 Vali Acc: 0.728 Test Loss: 0.984 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0692873001098633
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.110 Vali Acc: 0.751 Test Loss: 1.110 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9651522636413574
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.832 Vali Acc: 0.780 Test Loss: 0.832 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4300923347473145
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.848 Vali Acc: 0.769 Test Loss: 0.848 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.234221935272217
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.803 Test Loss: 0.829 Test Acc: 0.803
Validation loss decreased (-0.791898 --> -0.803460).  Saving model ...
Epoch: 19 cost time: 3.207258701324463
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.792 Test Loss: 0.839 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1536197662353516
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.792 Test Loss: 0.867 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.346613645553589
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.792 Test Loss: 0.850 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3997561931610107
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.803 Test Loss: 0.836 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0763611793518066
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.798 Test Loss: 0.815 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.633484363555908
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.798 Test Loss: 0.814 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.533517360687256
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.798 Test Loss: 0.824 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.455268144607544
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.798 Test Loss: 0.842 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7531981468200684
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.803 Test Loss: 0.848 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.739347219467163
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.803 Test Loss: 0.850 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 54167047
model size : 221.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.907579660415649
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.596 Vali Acc: 0.335 Test Loss: 1.596 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 2.371495008468628
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.290 Vali Acc: 0.468 Test Loss: 1.290 Test Acc: 0.468
Validation loss decreased (-0.335244 --> -0.468195).  Saving model ...
Epoch: 3 cost time: 2.549457311630249
Epoch: 3, Steps: 17 | Train Loss: 0.953 Vali Loss: 0.847 Vali Acc: 0.671 Test Loss: 0.847 Test Acc: 0.671
Validation loss decreased (-0.468195 --> -0.670512).  Saving model ...
Epoch: 4 cost time: 3.088426113128662
Epoch: 4, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.855 Vali Acc: 0.613 Test Loss: 0.855 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5639278888702393
Epoch: 5, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.734 Vali Acc: 0.711 Test Loss: 0.734 Test Acc: 0.711
Validation loss decreased (-0.670512 --> -0.710975).  Saving model ...
Epoch: 6 cost time: 3.823868989944458
Epoch: 6, Steps: 17 | Train Loss: 0.649 Vali Loss: 1.128 Vali Acc: 0.705 Test Loss: 1.128 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4214186668395996
Epoch: 7, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.726 Vali Acc: 0.694 Test Loss: 0.726 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2984840869903564
Epoch: 8, Steps: 17 | Train Loss: 0.647 Vali Loss: 1.172 Vali Acc: 0.630 Test Loss: 1.172 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.752011299133301
Epoch: 9, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
Validation loss decreased (-0.710975 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 3.957221508026123
Epoch: 10, Steps: 17 | Train Loss: 0.413 Vali Loss: 1.275 Vali Acc: 0.613 Test Loss: 1.275 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7903103828430176
Epoch: 11, Steps: 17 | Train Loss: 0.451 Vali Loss: 1.010 Vali Acc: 0.694 Test Loss: 1.010 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.824796676635742
Epoch: 12, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.322 Vali Acc: 0.728 Test Loss: 1.322 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.387824535369873
Epoch: 13, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.754 Vali Acc: 0.832 Test Loss: 0.754 Test Acc: 0.832
Validation loss decreased (-0.762999 --> -0.832362).  Saving model ...
Epoch: 14 cost time: 3.5286169052124023
Epoch: 14, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.932 Vali Acc: 0.786 Test Loss: 0.932 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.903759241104126
Epoch: 15, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.617 Vali Acc: 0.815 Test Loss: 0.617 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.5608227252960205
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.124 Vali Acc: 0.775 Test Loss: 1.124 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.177300214767456
Epoch: 17, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.924 Vali Acc: 0.821 Test Loss: 0.924 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.562715530395508
Epoch: 18, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
Validation loss decreased (-0.832362 --> -0.849704).  Saving model ...
Epoch: 19 cost time: 3.0045318603515625
Epoch: 19, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.359 Vali Acc: 0.740 Test Loss: 1.359 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5043067932128906
Epoch: 20, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.439734935760498
Epoch: 21, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.801 Vali Acc: 0.867 Test Loss: 0.801 Test Acc: 0.867
Validation loss decreased (-0.849704 --> -0.867044).  Saving model ...
Epoch: 22 cost time: 4.0278942584991455
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.945 Vali Acc: 0.827 Test Loss: 0.945 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.440128803253174
Epoch: 23, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.061 Vali Acc: 0.832 Test Loss: 1.061 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.2690911293029785
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.077 Vali Acc: 0.827 Test Loss: 1.077 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.232427597045898
Epoch: 25, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.057 Vali Acc: 0.838 Test Loss: 1.057 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.652374267578125
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.887 Vali Acc: 0.844 Test Loss: 0.887 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.8980228900909424
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.926 Vali Acc: 0.855 Test Loss: 0.926 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.478384256362915
Epoch: 28, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.939 Vali Acc: 0.844 Test Loss: 0.939 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.7689831256866455
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.949 Vali Acc: 0.815 Test Loss: 0.949 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.079284906387329
Epoch: 30, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.888 Vali Acc: 0.844 Test Loss: 0.888 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.9853594303131104
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.879 Test Loss: 0.591 Test Acc: 0.879
Validation loss decreased (-0.867044 --> -0.878607).  Saving model ...
Epoch: 32 cost time: 2.958059310913086
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.861 Test Loss: 0.825 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.147611141204834
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.827 Test Loss: 0.813 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.064136505126953
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.807 Vali Acc: 0.827 Test Loss: 0.807 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.571906566619873
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.838 Test Loss: 0.808 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.4258463382720947
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.838 Test Loss: 0.812 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.474172353744507
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.832 Test Loss: 0.820 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.785442352294922
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.838 Test Loss: 0.817 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.6484673023223877
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.838 Test Loss: 0.811 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.305126428604126
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.850 Test Loss: 0.801 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.0802395343780518
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 56579335
model size : 230.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.843459606170654
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.493 Vali Acc: 0.277 Test Loss: 1.493 Test Acc: 0.277
Validation loss decreased (inf --> -0.277442).  Saving model ...
Epoch: 2 cost time: 3.171456813812256
Epoch: 2, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.097 Vali Acc: 0.561 Test Loss: 1.097 Test Acc: 0.561
Validation loss decreased (-0.277442 --> -0.560683).  Saving model ...
Epoch: 3 cost time: 2.5529074668884277
Epoch: 3, Steps: 17 | Train Loss: 0.777 Vali Loss: 0.770 Vali Acc: 0.676 Test Loss: 0.770 Test Acc: 0.676
Validation loss decreased (-0.560683 --> -0.676293).  Saving model ...
Epoch: 4 cost time: 2.5878143310546875
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
Validation loss decreased (-0.676293 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 3.2175052165985107
Epoch: 5, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.832 Vali Acc: 0.763 Test Loss: 0.832 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4703071117401123
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.009 Vali Acc: 0.728 Test Loss: 1.009 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.681776285171509
Epoch: 7, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.616 Vali Acc: 0.815 Test Loss: 0.616 Test Acc: 0.815
Validation loss decreased (-0.762999 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 3.575700044631958
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.026 Vali Acc: 0.763 Test Loss: 1.026 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.591700792312622
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.307 Vali Acc: 0.723 Test Loss: 1.307 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4290642738342285
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.851 Vali Acc: 0.786 Test Loss: 0.851 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8077433109283447
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.188 Vali Acc: 0.775 Test Loss: 1.188 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.754727602005005
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.169 Vali Acc: 0.751 Test Loss: 1.169 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4116859436035156
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.772 Vali Acc: 0.838 Test Loss: 0.772 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838143).  Saving model ...
Epoch: 14 cost time: 2.6430790424346924
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.767 Vali Acc: 0.838 Test Loss: 0.767 Test Acc: 0.838
Validation loss decreased (-0.838143 --> -0.838143).  Saving model ...
Epoch: 15 cost time: 2.6521921157836914
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.738 Vali Acc: 0.821 Test Loss: 0.738 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5875022411346436
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.818 Vali Acc: 0.815 Test Loss: 0.818 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2883245944976807
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.123 Vali Acc: 0.809 Test Loss: 1.123 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2103710174560547
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.005 Vali Acc: 0.844 Test Loss: 1.005 Test Acc: 0.844
Validation loss decreased (-0.838143 --> -0.843921).  Saving model ...
Epoch: 19 cost time: 2.432429552078247
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.815 Test Loss: 0.893 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0084264278411865
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.719 Vali Acc: 0.832 Test Loss: 0.719 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5730247497558594
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.751 Vali Acc: 0.844 Test Loss: 0.751 Test Acc: 0.844
Validation loss decreased (-0.843921 --> -0.843923).  Saving model ...
Epoch: 22 cost time: 3.052690267562866
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.227 Vali Acc: 0.757 Test Loss: 1.227 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.954362630844116
Epoch: 23, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.066 Vali Acc: 0.803 Test Loss: 1.066 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.9740447998046875
Epoch: 24, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.228 Vali Acc: 0.786 Test Loss: 1.228 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1214778423309326
Epoch: 25, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.232 Vali Acc: 0.792 Test Loss: 1.232 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0509872436523438
Epoch: 26, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.331 Vali Acc: 0.757 Test Loss: 1.331 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.810051679611206
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 2.161 Vali Acc: 0.786 Test Loss: 2.161 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.1559548377990723
Epoch: 28, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.875 Vali Acc: 0.786 Test Loss: 1.875 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.2152278423309326
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.483 Vali Acc: 0.809 Test Loss: 1.483 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.8898613452911377
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.740 Vali Acc: 0.792 Test Loss: 1.740 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.0006582736968994
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.821 Test Loss: 1.540 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 56454919
model size : 230.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.940364837646484
Epoch: 1, Steps: 17 | Train Loss: 1.817 Vali Loss: 1.467 Vali Acc: 0.295 Test Loss: 1.467 Test Acc: 0.295
Validation loss decreased (inf --> -0.294783).  Saving model ...
Epoch: 2 cost time: 2.9684698581695557
Epoch: 2, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.302 Vali Acc: 0.486 Test Loss: 1.302 Test Acc: 0.486
Validation loss decreased (-0.294783 --> -0.485536).  Saving model ...
Epoch: 3 cost time: 3.145388603210449
Epoch: 3, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.908 Vali Acc: 0.618 Test Loss: 0.908 Test Acc: 0.618
Validation loss decreased (-0.485536 --> -0.618488).  Saving model ...
Epoch: 4 cost time: 3.126359462738037
Epoch: 4, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.762 Vali Acc: 0.717 Test Loss: 0.762 Test Acc: 0.717
Validation loss decreased (-0.618488 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 2.9884560108184814
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
Validation loss decreased (-0.716755 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 3.458314895629883
Epoch: 6, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.55060076713562
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.930 Vali Acc: 0.728 Test Loss: 0.930 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9784276485443115
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.656 Vali Acc: 0.821 Test Loss: 0.656 Test Acc: 0.821
Validation loss decreased (-0.757219 --> -0.820803).  Saving model ...
Epoch: 9 cost time: 3.0511298179626465
Epoch: 9, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.597 Vali Acc: 0.832 Test Loss: 0.597 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832364).  Saving model ...
Epoch: 10 cost time: 2.7650744915008545
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.768 Vali Acc: 0.798 Test Loss: 0.768 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6660537719726562
Epoch: 11, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.190237045288086
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2576637268066406
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.901 Vali Acc: 0.786 Test Loss: 0.901 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.157623529434204
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.967 Vali Acc: 0.740 Test Loss: 0.967 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6128015518188477
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.680 Vali Acc: 0.792 Test Loss: 0.680 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.1375656127929688
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.622 Vali Acc: 0.798 Test Loss: 0.622 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.4258627891540527
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.549 Vali Acc: 0.832 Test Loss: 0.549 Test Acc: 0.832
Validation loss decreased (-0.832364 --> -0.832364).  Saving model ...
Epoch: 18 cost time: 3.1209897994995117
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.827 Test Loss: 0.514 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.081871271133423
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.531 Vali Acc: 0.827 Test Loss: 0.531 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3480210304260254
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.815 Test Loss: 0.580 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.628084421157837
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.827 Test Loss: 0.596 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.75175404548645
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.832 Test Loss: 0.591 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.878572702407837
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.827 Test Loss: 0.588 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3499069213867188
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.2976276874542236
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.827 Test Loss: 0.580 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.4817042350769043
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.821 Test Loss: 0.585 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.972564697265625
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.827 Test Loss: 0.607 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 56371975
model size : 229.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.239022254943848
Epoch: 1, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.529 Vali Acc: 0.341 Test Loss: 1.529 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 3.524369239807129
Epoch: 2, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.459 Vali Acc: 0.422 Test Loss: 1.459 Test Acc: 0.422
Validation loss decreased (-0.341025 --> -0.421951).  Saving model ...
Epoch: 3 cost time: 3.329031229019165
Epoch: 3, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.933 Vali Acc: 0.636 Test Loss: 0.933 Test Acc: 0.636
Validation loss decreased (-0.421951 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 2.9708268642425537
Epoch: 4, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.909 Vali Acc: 0.705 Test Loss: 0.909 Test Acc: 0.705
Validation loss decreased (-0.635829 --> -0.705193).  Saving model ...
Epoch: 5 cost time: 2.1223649978637695
Epoch: 5, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.846 Vali Acc: 0.630 Test Loss: 0.846 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.731229543685913
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
Validation loss decreased (-0.705193 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 3.2347731590270996
Epoch: 7, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.620 Vali Acc: 0.798 Test Loss: 0.620 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797682).  Saving model ...
Epoch: 8 cost time: 2.8467159271240234
Epoch: 8, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.816 Vali Acc: 0.786 Test Loss: 0.816 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8837478160858154
Epoch: 9, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7221086025238037
Epoch: 10, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.741 Vali Acc: 0.809 Test Loss: 0.741 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809241).  Saving model ...
Epoch: 11 cost time: 3.1255626678466797
Epoch: 11, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.118 Vali Acc: 0.723 Test Loss: 1.118 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.027217149734497
Epoch: 12, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.194 Vali Acc: 0.786 Test Loss: 1.194 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.60145902633667
Epoch: 13, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.080 Vali Acc: 0.769 Test Loss: 1.080 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7150402069091797
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.912 Vali Acc: 0.827 Test Loss: 0.912 Test Acc: 0.827
Validation loss decreased (-0.809241 --> -0.826580).  Saving model ...
Epoch: 15 cost time: 3.3132338523864746
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.560 Vali Acc: 0.723 Test Loss: 1.560 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.182206392288208
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.683 Vali Acc: 0.757 Test Loss: 1.683 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5786116123199463
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.524 Vali Acc: 0.792 Test Loss: 1.524 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.363664150238037
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.281 Vali Acc: 0.775 Test Loss: 1.281 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.326348066329956
Epoch: 19, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.806 Vali Acc: 0.775 Test Loss: 1.806 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6229536533355713
Epoch: 20, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.278 Vali Acc: 0.786 Test Loss: 1.278 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.576910972595215
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.578 Vali Acc: 0.827 Test Loss: 1.578 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7067432403564453
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.019 Vali Acc: 0.844 Test Loss: 1.019 Test Acc: 0.844
Validation loss decreased (-0.826580 --> -0.843920).  Saving model ...
Epoch: 23 cost time: 3.7800064086914062
Epoch: 23, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.178 Vali Acc: 0.757 Test Loss: 2.178 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.046802520751953
Epoch: 24, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.359 Vali Acc: 0.780 Test Loss: 1.359 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8193917274475098
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.274 Vali Acc: 0.798 Test Loss: 1.274 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.160745620727539
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.188 Vali Acc: 0.723 Test Loss: 2.188 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.967820167541504
Epoch: 27, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.170 Vali Acc: 0.792 Test Loss: 2.170 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.094315767288208
Epoch: 28, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.994 Vali Acc: 0.809 Test Loss: 0.994 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.3211560249328613
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.636 Vali Acc: 0.763 Test Loss: 1.636 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.819857358932495
Epoch: 30, Steps: 17 | Train Loss: 0.058 Vali Loss: 2.185 Vali Acc: 0.757 Test Loss: 2.185 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.8169612884521484
Epoch: 31, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.631 Vali Acc: 0.792 Test Loss: 1.631 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.8772664070129395
Epoch: 32, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.584 Vali Acc: 0.775 Test Loss: 1.584 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 58791175
model size : 238.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.660497426986694
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.475 Vali Acc: 0.561 Test Loss: 1.475 Test Acc: 0.561
Validation loss decreased (inf --> -0.560679).  Saving model ...
Epoch: 2 cost time: 2.765211582183838
Epoch: 2, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.081 Vali Acc: 0.526 Test Loss: 1.081 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.134133815765381
Epoch: 3, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.036 Vali Acc: 0.630 Test Loss: 1.036 Test Acc: 0.630
Validation loss decreased (-0.560679 --> -0.630047).  Saving model ...
Epoch: 4 cost time: 3.0205044746398926
Epoch: 4, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.688 Vali Acc: 0.740 Test Loss: 0.688 Test Acc: 0.740
Validation loss decreased (-0.630047 --> -0.739878).  Saving model ...
Epoch: 5 cost time: 3.3122506141662598
Epoch: 5, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.802 Vali Acc: 0.723 Test Loss: 0.802 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.343116521835327
Epoch: 6, Steps: 17 | Train Loss: 0.474 Vali Loss: 1.036 Vali Acc: 0.653 Test Loss: 1.036 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8866114616394043
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.798 Vali Acc: 0.746 Test Loss: 0.798 Test Acc: 0.746
Validation loss decreased (-0.739878 --> -0.745657).  Saving model ...
Epoch: 8 cost time: 2.917018413543701
Epoch: 8, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.876 Vali Acc: 0.769 Test Loss: 0.876 Test Acc: 0.769
Validation loss decreased (-0.745657 --> -0.768777).  Saving model ...
Epoch: 9 cost time: 2.8459043502807617
Epoch: 9, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.013 Vali Acc: 0.746 Test Loss: 1.013 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.612111806869507
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.952 Vali Acc: 0.809 Test Loss: 0.952 Test Acc: 0.809
Validation loss decreased (-0.768777 --> -0.809239).  Saving model ...
Epoch: 11 cost time: 3.0128581523895264
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.042 Vali Acc: 0.769 Test Loss: 1.042 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3991568088531494
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.947 Vali Acc: 0.786 Test Loss: 0.947 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1776912212371826
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.135 Vali Acc: 0.786 Test Loss: 1.135 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1600544452667236
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.402 Vali Acc: 0.740 Test Loss: 1.402 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.310330867767334
Epoch: 15, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.055 Vali Acc: 0.827 Test Loss: 1.055 Test Acc: 0.827
Validation loss decreased (-0.809239 --> -0.826579).  Saving model ...
Epoch: 16 cost time: 3.451699733734131
Epoch: 16, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.260 Vali Acc: 0.769 Test Loss: 1.260 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9954445362091064
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.448 Vali Acc: 0.769 Test Loss: 1.448 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4177463054656982
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.009 Vali Acc: 0.780 Test Loss: 1.009 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6546878814697266
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.171 Vali Acc: 0.780 Test Loss: 1.171 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1726274490356445
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.203 Vali Acc: 0.780 Test Loss: 1.203 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.5488693714141846
Epoch: 21, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.630 Vali Acc: 0.827 Test Loss: 0.630 Test Acc: 0.827
Validation loss decreased (-0.826579 --> -0.826583).  Saving model ...
Epoch: 22 cost time: 3.000741958618164
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.274 Vali Acc: 0.803 Test Loss: 1.274 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5429227352142334
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.869 Vali Acc: 0.821 Test Loss: 0.869 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.255617141723633
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.897 Vali Acc: 0.832 Test Loss: 0.897 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832361).  Saving model ...
Epoch: 25 cost time: 3.4406521320343018
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.803 Test Loss: 0.945 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4922189712524414
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.792 Test Loss: 0.985 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3164010047912598
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.821 Test Loss: 0.902 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0437405109405518
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.821 Test Loss: 0.911 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.687391996383667
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.815 Test Loss: 0.896 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.829784870147705
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.827 Test Loss: 0.883 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.394548177719116
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.815 Test Loss: 0.879 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.922882318496704
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.815 Test Loss: 0.880 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.701129913330078
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.815 Test Loss: 0.886 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.765543222427368
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.821 Test Loss: 0.885 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 58666759
model size : 238.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.1800925731658936
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.474 Vali Acc: 0.364 Test Loss: 1.474 Test Acc: 0.364
Validation loss decreased (inf --> -0.364147).  Saving model ...
Epoch: 2 cost time: 2.6539547443389893
Epoch: 2, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.258 Vali Acc: 0.451 Test Loss: 1.258 Test Acc: 0.451
Validation loss decreased (-0.364147 --> -0.450854).  Saving model ...
Epoch: 3 cost time: 2.355069637298584
Epoch: 3, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.084 Vali Acc: 0.549 Test Loss: 1.084 Test Acc: 0.549
Validation loss decreased (-0.450854 --> -0.549122).  Saving model ...
Epoch: 4 cost time: 2.248364210128784
Epoch: 4, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.800 Vali Acc: 0.699 Test Loss: 0.800 Test Acc: 0.699
Validation loss decreased (-0.549122 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 2.946115732192993
Epoch: 5, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.653 Vali Acc: 0.786 Test Loss: 0.653 Test Acc: 0.786
Validation loss decreased (-0.699414 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 2.993917226791382
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.891 Vali Acc: 0.653 Test Loss: 0.891 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.572040319442749
Epoch: 7, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.908 Vali Acc: 0.671 Test Loss: 0.908 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.751662254333496
Epoch: 8, Steps: 17 | Train Loss: 0.237 Vali Loss: 1.026 Vali Acc: 0.705 Test Loss: 1.026 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.220797061920166
Epoch: 9, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.746 Vali Acc: 0.723 Test Loss: 0.746 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6185128688812256
Epoch: 10, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.944 Vali Acc: 0.740 Test Loss: 0.944 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2229318618774414
Epoch: 11, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.876 Vali Acc: 0.740 Test Loss: 0.876 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3532586097717285
Epoch: 12, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.580 Vali Acc: 0.821 Test Loss: 0.580 Test Acc: 0.821
Validation loss decreased (-0.786121 --> -0.820803).  Saving model ...
Epoch: 13 cost time: 2.6237268447875977
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.726 Vali Acc: 0.798 Test Loss: 0.726 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6002695560455322
Epoch: 14, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.050 Vali Acc: 0.751 Test Loss: 1.050 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7261099815368652
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.935 Vali Acc: 0.780 Test Loss: 0.935 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.855910062789917
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.755 Vali Acc: 0.786 Test Loss: 0.755 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4306833744049072
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.366999387741089
Epoch: 18, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.329 Vali Acc: 0.711 Test Loss: 1.329 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.222431182861328
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.357755184173584
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.926 Vali Acc: 0.809 Test Loss: 0.926 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2289366722106934
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.032 Vali Acc: 0.786 Test Loss: 1.032 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.99055814743042
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.048 Vali Acc: 0.769 Test Loss: 1.048 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 58576903
model size : 238.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.830308437347412
Epoch: 1, Steps: 17 | Train Loss: 1.842 Vali Loss: 1.484 Vali Acc: 0.370 Test Loss: 1.484 Test Acc: 0.370
Validation loss decreased (inf --> -0.369927).  Saving model ...
Epoch: 2 cost time: 3.1092803478240967
Epoch: 2, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.253 Vali Acc: 0.514 Test Loss: 1.253 Test Acc: 0.514
Validation loss decreased (-0.369927 --> -0.514438).  Saving model ...
Epoch: 3 cost time: 3.510286331176758
Epoch: 3, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.867 Vali Acc: 0.653 Test Loss: 0.867 Test Acc: 0.653
Validation loss decreased (-0.514438 --> -0.653171).  Saving model ...
Epoch: 4 cost time: 3.6976373195648193
Epoch: 4, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.751 Vali Acc: 0.705 Test Loss: 0.751 Test Acc: 0.705
Validation loss decreased (-0.653171 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 3.9397470951080322
Epoch: 5, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
Validation loss decreased (-0.705195 --> -0.716755).  Saving model ...
Epoch: 6 cost time: 3.0783884525299072
Epoch: 6, Steps: 17 | Train Loss: 0.302 Vali Loss: 1.028 Vali Acc: 0.671 Test Loss: 1.028 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2712514400482178
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 1.113 Vali Acc: 0.699 Test Loss: 1.113 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7031197547912598
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.783 Vali Acc: 0.780 Test Loss: 0.783 Test Acc: 0.780
Validation loss decreased (-0.716755 --> -0.780339).  Saving model ...
Epoch: 9 cost time: 2.601160764694214
Epoch: 9, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.502 Vali Acc: 0.711 Test Loss: 1.502 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8752126693725586
Epoch: 10, Steps: 17 | Train Loss: 0.252 Vali Loss: 1.265 Vali Acc: 0.717 Test Loss: 1.265 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.094564199447632
Epoch: 11, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.436 Vali Acc: 0.734 Test Loss: 1.436 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.704988479614258
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.903 Vali Acc: 0.803 Test Loss: 0.903 Test Acc: 0.803
Validation loss decreased (-0.780339 --> -0.803459).  Saving model ...
Epoch: 13 cost time: 2.930983543395996
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.734 Vali Acc: 0.827 Test Loss: 0.734 Test Acc: 0.827
Validation loss decreased (-0.803459 --> -0.826582).  Saving model ...
Epoch: 14 cost time: 3.4684078693389893
Epoch: 14, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.852 Vali Acc: 0.780 Test Loss: 0.852 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.504173755645752
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.631 Vali Acc: 0.653 Test Loss: 1.631 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.453822374343872
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.890 Vali Acc: 0.792 Test Loss: 0.890 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3289942741394043
Epoch: 17, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.787 Vali Acc: 0.832 Test Loss: 0.787 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832362).  Saving model ...
Epoch: 18 cost time: 2.9960126876831055
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.531 Vali Acc: 0.740 Test Loss: 1.531 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9655404090881348
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.581 Vali Acc: 0.769 Test Loss: 1.581 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9239485263824463
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.358 Vali Acc: 0.798 Test Loss: 1.358 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0806243419647217
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.242 Vali Acc: 0.746 Test Loss: 2.242 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.723162889480591
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.008 Vali Acc: 0.827 Test Loss: 1.008 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6836836338043213
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.913 Vali Acc: 0.746 Test Loss: 1.913 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.4987237453460693
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.324 Vali Acc: 0.844 Test Loss: 1.324 Test Acc: 0.844
Validation loss decreased (-0.832362 --> -0.843917).  Saving model ...
Epoch: 25 cost time: 3.2907402515411377
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.026 Vali Acc: 0.821 Test Loss: 1.026 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.030092239379883
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.268 Vali Acc: 0.815 Test Loss: 1.268 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2988440990448
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.299 Vali Acc: 0.792 Test Loss: 1.299 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.507599353790283
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.488 Vali Acc: 0.763 Test Loss: 1.488 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5216872692108154
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.195 Vali Acc: 0.798 Test Loss: 1.195 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.9693734645843506
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.838 Test Loss: 0.939 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.826676368713379
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.838 Test Loss: 0.878 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.8345866203308105
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.838 Test Loss: 0.864 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.9555258750915527
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.832 Test Loss: 0.860 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.7390522956848145
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.832 Test Loss: 0.859 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 61009927
model size : 247.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.000409126281738
Epoch: 1, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.570 Vali Acc: 0.289 Test Loss: 1.570 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 3.154499053955078
Epoch: 2, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.143 Vali Acc: 0.497 Test Loss: 1.143 Test Acc: 0.497
Validation loss decreased (-0.289002 --> -0.497098).  Saving model ...
Epoch: 3 cost time: 2.86188006401062
Epoch: 3, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.943 Vali Acc: 0.636 Test Loss: 0.943 Test Acc: 0.636
Validation loss decreased (-0.497098 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 3.1294291019439697
Epoch: 4, Steps: 17 | Train Loss: 0.621 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0741097927093506
Epoch: 5, Steps: 17 | Train Loss: 0.430 Vali Loss: 1.232 Vali Acc: 0.636 Test Loss: 1.232 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.155366897583008
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.556 Vali Acc: 0.832 Test Loss: 0.556 Test Acc: 0.832
Validation loss decreased (-0.635829 --> -0.832364).  Saving model ...
Epoch: 7 cost time: 3.069192409515381
Epoch: 7, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.468841791152954
Epoch: 8, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.747 Vali Acc: 0.740 Test Loss: 0.747 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9872448444366455
Epoch: 9, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.541 Vali Acc: 0.850 Test Loss: 0.541 Test Acc: 0.850
Validation loss decreased (-0.832364 --> -0.849706).  Saving model ...
Epoch: 10 cost time: 2.447470188140869
Epoch: 10, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.942 Vali Acc: 0.746 Test Loss: 0.942 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.162780284881592
Epoch: 11, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.207 Vali Acc: 0.746 Test Loss: 1.207 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.417266845703125
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.513 Vali Acc: 0.838 Test Loss: 0.513 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7113471031188965
Epoch: 13, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.488 Vali Acc: 0.757 Test Loss: 1.488 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.745833396911621
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.880 Vali Acc: 0.792 Test Loss: 0.880 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.863476514816284
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.913 Vali Acc: 0.832 Test Loss: 0.913 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.163360118865967
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.578 Vali Acc: 0.751 Test Loss: 1.578 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5838966369628906
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 2.238 Vali Acc: 0.740 Test Loss: 2.238 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1369221210479736
Epoch: 18, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.063 Vali Acc: 0.809 Test Loss: 1.063 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.6382317543029785
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.370 Vali Acc: 0.780 Test Loss: 1.370 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 60857863
model size : 246.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.756906986236572
Epoch: 1, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.501 Vali Acc: 0.410 Test Loss: 1.501 Test Acc: 0.410
Validation loss decreased (inf --> -0.410390).  Saving model ...
Epoch: 2 cost time: 2.508241653442383
Epoch: 2, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.525 Vali Acc: 0.312 Test Loss: 1.525 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.22438383102417
Epoch: 3, Steps: 17 | Train Loss: 0.937 Vali Loss: 0.858 Vali Acc: 0.624 Test Loss: 0.858 Test Acc: 0.624
Validation loss decreased (-0.410390 --> -0.624269).  Saving model ...
Epoch: 4 cost time: 2.5696966648101807
Epoch: 4, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
Validation loss decreased (-0.624269 --> -0.716756).  Saving model ...
Epoch: 5 cost time: 2.4668262004852295
Epoch: 5, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.835 Vali Acc: 0.688 Test Loss: 0.835 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1519947052001953
Epoch: 6, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.685 Vali Acc: 0.705 Test Loss: 0.685 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4430432319641113
Epoch: 7, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.534 Vali Acc: 0.815 Test Loss: 0.534 Test Acc: 0.815
Validation loss decreased (-0.716756 --> -0.815024).  Saving model ...
Epoch: 8 cost time: 2.7272238731384277
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.963 Vali Acc: 0.734 Test Loss: 0.963 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.832824230194092
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.663 Vali Acc: 0.855 Test Loss: 0.663 Test Acc: 0.855
Validation loss decreased (-0.815024 --> -0.855485).  Saving model ...
Epoch: 10 cost time: 2.33933424949646
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.420452356338501
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.801 Vali Acc: 0.780 Test Loss: 0.801 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4096314907073975
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.669 Vali Acc: 0.769 Test Loss: 0.669 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7195699214935303
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.073 Vali Acc: 0.757 Test Loss: 1.073 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5820627212524414
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.698 Vali Acc: 0.815 Test Loss: 0.698 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5904877185821533
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.557 Vali Acc: 0.838 Test Loss: 0.557 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7441048622131348
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.569 Vali Acc: 0.832 Test Loss: 0.569 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6823551654815674
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.950 Vali Acc: 0.751 Test Loss: 0.950 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.58685564994812
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.721 Vali Acc: 0.792 Test Loss: 0.721 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7671332359313965
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.815 Test Loss: 0.609 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 60788743
model size : 246.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.382418394088745
Epoch: 1, Steps: 17 | Train Loss: 1.924 Vali Loss: 1.507 Vali Acc: 0.272 Test Loss: 1.507 Test Acc: 0.272
Validation loss decreased (inf --> -0.271661).  Saving model ...
Epoch: 2 cost time: 3.912463903427124
Epoch: 2, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.370 Vali Acc: 0.549 Test Loss: 1.370 Test Acc: 0.549
Validation loss decreased (-0.271661 --> -0.549119).  Saving model ...
Epoch: 3 cost time: 3.4130964279174805
Epoch: 3, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.072 Vali Acc: 0.543 Test Loss: 1.072 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.958177089691162
Epoch: 4, Steps: 17 | Train Loss: 0.657 Vali Loss: 1.239 Vali Acc: 0.665 Test Loss: 1.239 Test Acc: 0.665
Validation loss decreased (-0.549119 --> -0.664727).  Saving model ...
Epoch: 5 cost time: 3.258941173553467
Epoch: 5, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.206 Vali Acc: 0.584 Test Loss: 1.206 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.337186098098755
Epoch: 6, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.912 Vali Acc: 0.665 Test Loss: 0.912 Test Acc: 0.665
Validation loss decreased (-0.664727 --> -0.664731).  Saving model ...
Epoch: 7 cost time: 3.190960168838501
Epoch: 7, Steps: 17 | Train Loss: 0.428 Vali Loss: 1.222 Vali Acc: 0.671 Test Loss: 1.222 Test Acc: 0.671
Validation loss decreased (-0.664731 --> -0.670508).  Saving model ...
Epoch: 8 cost time: 3.837937355041504
Epoch: 8, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.125 Vali Acc: 0.757 Test Loss: 1.125 Test Acc: 0.757
Validation loss decreased (-0.670508 --> -0.757214).  Saving model ...
Epoch: 9 cost time: 3.099165439605713
Epoch: 9, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.059 Vali Acc: 0.717 Test Loss: 1.059 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.549442768096924
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.938 Vali Acc: 0.699 Test Loss: 1.938 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.768127918243408
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.185 Vali Acc: 0.763 Test Loss: 1.185 Test Acc: 0.763
Validation loss decreased (-0.757214 --> -0.762994).  Saving model ...
Epoch: 12 cost time: 3.1812262535095215
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.499 Vali Acc: 0.728 Test Loss: 1.499 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1447157859802246
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.097 Vali Acc: 0.798 Test Loss: 1.097 Test Acc: 0.798
Validation loss decreased (-0.762994 --> -0.797677).  Saving model ...
Epoch: 14 cost time: 3.3716161251068115
Epoch: 14, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.370 Vali Acc: 0.775 Test Loss: 1.370 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.116901397705078
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.232 Vali Acc: 0.809 Test Loss: 1.232 Test Acc: 0.809
Validation loss decreased (-0.797677 --> -0.809236).  Saving model ...
Epoch: 16 cost time: 3.1345393657684326
Epoch: 16, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.189 Vali Acc: 0.757 Test Loss: 1.189 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.910144805908203
Epoch: 17, Steps: 17 | Train Loss: 0.192 Vali Loss: 1.376 Vali Acc: 0.792 Test Loss: 1.376 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2274208068847656
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.036 Vali Acc: 0.809 Test Loss: 1.036 Test Acc: 0.809
Validation loss decreased (-0.809236 --> -0.809238).  Saving model ...
Epoch: 19 cost time: 3.0169711112976074
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.052 Vali Acc: 0.775 Test Loss: 1.052 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.898822784423828
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.747 Vali Acc: 0.780 Test Loss: 1.747 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8385233879089355
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.548 Vali Acc: 0.763 Test Loss: 1.548 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.5688812732696533
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.243 Vali Acc: 0.792 Test Loss: 1.243 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4170737266540527
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.133 Vali Acc: 0.832 Test Loss: 1.133 Test Acc: 0.832
Validation loss decreased (-0.809238 --> -0.832359).  Saving model ...
Epoch: 24 cost time: 2.391911745071411
Epoch: 24, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.997 Vali Acc: 0.723 Test Loss: 2.997 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.368835926055908
Epoch: 25, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.655 Vali Acc: 0.775 Test Loss: 1.655 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1222593784332275
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.847 Vali Acc: 0.809 Test Loss: 1.847 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.705860137939453
Epoch: 27, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.815 Vali Acc: 0.786 Test Loss: 1.815 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.478233814239502
Epoch: 28, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.797 Vali Acc: 0.769 Test Loss: 1.797 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7881388664245605
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.496 Vali Acc: 0.798 Test Loss: 1.496 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.9544289112091064
Epoch: 30, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.437 Vali Acc: 0.775 Test Loss: 1.437 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.4168457984924316
Epoch: 31, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.772 Vali Acc: 0.757 Test Loss: 1.772 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9290053844451904
Epoch: 32, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.251 Vali Acc: 0.832 Test Loss: 1.251 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.7425835132598877
Epoch: 33, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.820 Vali Acc: 0.786 Test Loss: 1.820 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 63228679
model size : 255.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.24634861946106
Epoch: 1, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.542 Vali Acc: 0.318 Test Loss: 1.542 Test Acc: 0.318
Validation loss decreased (inf --> -0.317904).  Saving model ...
Epoch: 2 cost time: 3.114408016204834
Epoch: 2, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.048 Vali Acc: 0.538 Test Loss: 1.048 Test Acc: 0.538
Validation loss decreased (-0.317904 --> -0.537562).  Saving model ...
Epoch: 3 cost time: 2.367079496383667
Epoch: 3, Steps: 17 | Train Loss: 0.807 Vali Loss: 0.745 Vali Acc: 0.763 Test Loss: 0.745 Test Acc: 0.763
Validation loss decreased (-0.537562 --> -0.762998).  Saving model ...
Epoch: 4 cost time: 2.693699598312378
Epoch: 4, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.821 Vali Acc: 0.723 Test Loss: 0.821 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9098258018493652
Epoch: 5, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.744 Vali Acc: 0.682 Test Loss: 0.744 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1940715312957764
Epoch: 6, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.781 Vali Acc: 0.723 Test Loss: 0.781 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.473012924194336
Epoch: 7, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.812 Vali Acc: 0.723 Test Loss: 0.812 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.396906852722168
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.219 Vali Acc: 0.711 Test Loss: 1.219 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8038041591644287
Epoch: 9, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
Validation loss decreased (-0.762998 --> -0.774560).  Saving model ...
Epoch: 10 cost time: 2.984875440597534
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.952 Vali Acc: 0.740 Test Loss: 0.952 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8704726696014404
Epoch: 11, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.693 Vali Acc: 0.809 Test Loss: 0.693 Test Acc: 0.809
Validation loss decreased (-0.774560 --> -0.809242).  Saving model ...
Epoch: 12 cost time: 3.0627315044403076
Epoch: 12, Steps: 17 | Train Loss: 0.169 Vali Loss: 1.074 Vali Acc: 0.723 Test Loss: 1.074 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1747822761535645
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.237 Vali Acc: 0.786 Test Loss: 1.237 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8292438983917236
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.028 Vali Acc: 0.792 Test Loss: 1.028 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.818974494934082
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.718 Vali Acc: 0.879 Test Loss: 0.718 Test Acc: 0.879
Validation loss decreased (-0.809242 --> -0.878606).  Saving model ...
Epoch: 16 cost time: 2.8465700149536133
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.859 Vali Acc: 0.815 Test Loss: 0.859 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.227799415588379
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.163 Vali Acc: 0.780 Test Loss: 1.163 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.630077362060547
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.286 Vali Acc: 0.821 Test Loss: 1.286 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.718635082244873
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.407 Vali Acc: 0.827 Test Loss: 1.407 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.494804859161377
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.057 Vali Acc: 0.821 Test Loss: 1.057 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.00520658493042
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.827 Test Loss: 0.863 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7550008296966553
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.873 Test Loss: 0.807 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.314116954803467
Epoch: 23, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.994 Vali Acc: 0.809 Test Loss: 0.994 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.428051233291626
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.861 Test Loss: 0.618 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.997486114501953
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.662 Vali Acc: 0.855 Test Loss: 0.662 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 63076615
model size : 255.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.747563362121582
Epoch: 1, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.588 Vali Acc: 0.306 Test Loss: 1.588 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 2.8277432918548584
Epoch: 2, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.107 Vali Acc: 0.532 Test Loss: 1.107 Test Acc: 0.532
Validation loss decreased (-0.306342 --> -0.531781).  Saving model ...
Epoch: 3 cost time: 2.90104079246521
Epoch: 3, Steps: 17 | Train Loss: 0.885 Vali Loss: 0.978 Vali Acc: 0.601 Test Loss: 0.978 Test Acc: 0.601
Validation loss decreased (-0.531781 --> -0.601146).  Saving model ...
Epoch: 4 cost time: 2.9024925231933594
Epoch: 4, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.924 Vali Acc: 0.624 Test Loss: 0.924 Test Acc: 0.624
Validation loss decreased (-0.601146 --> -0.624268).  Saving model ...
Epoch: 5 cost time: 2.662109613418579
Epoch: 5, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
Validation loss decreased (-0.624268 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 2.9391961097717285
Epoch: 6, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.757 Vali Acc: 0.699 Test Loss: 0.757 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.985670804977417
Epoch: 7, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.891 Vali Acc: 0.728 Test Loss: 0.891 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9040279388427734
Epoch: 8, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.648 Vali Acc: 0.775 Test Loss: 0.648 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774560).  Saving model ...
Epoch: 9 cost time: 3.2098608016967773
Epoch: 9, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.982 Vali Acc: 0.723 Test Loss: 0.982 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.152918815612793
Epoch: 10, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.842 Vali Acc: 0.786 Test Loss: 0.842 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786119).  Saving model ...
Epoch: 11 cost time: 3.2951323986053467
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
Validation loss decreased (-0.786119 --> -0.809242).  Saving model ...
Epoch: 12 cost time: 2.9916574954986572
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.893402338027954
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8645272254943848
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.798 Vali Acc: 0.809 Test Loss: 0.798 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.586386203765869
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.780 Test Loss: 0.721 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.697579860687256
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 17 cost time: 2.6860947608947754
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.152 Vali Acc: 0.809 Test Loss: 1.152 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.860379457473755
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.809 Test Loss: 0.805 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.902925968170166
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.815 Test Loss: 0.746 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815021).  Saving model ...
Epoch: 20 cost time: 2.894446611404419
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.821 Test Loss: 0.751 Test Acc: 0.821
Validation loss decreased (-0.815021 --> -0.820802).  Saving model ...
Epoch: 21 cost time: 2.7901053428649902
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.815 Test Loss: 0.749 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.053466796875
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.821 Test Loss: 0.753 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8320367336273193
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.827 Test Loss: 0.745 Test Acc: 0.827
Validation loss decreased (-0.820802 --> -0.826582).  Saving model ...
Epoch: 24 cost time: 2.7790050506591797
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.827 Test Loss: 0.763 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9078774452209473
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.821 Test Loss: 0.774 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5952537059783936
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.815 Test Loss: 0.774 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3376805782318115
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.821 Test Loss: 0.772 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9162850379943848
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.809 Test Loss: 0.773 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.2281875610351562
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.809 Test Loss: 0.770 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.4507360458374023
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.7706410884857178
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.792 Test Loss: 0.933 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.5799379348754883
Epoch: 32, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.879 Vali Acc: 0.751 Test Loss: 0.879 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.6187758445739746
Epoch: 33, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.013 Vali Acc: 0.590 Test Loss: 2.013 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 63000583
model size : 255.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.144279956817627
Epoch: 1, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.465 Vali Acc: 0.457 Test Loss: 1.465 Test Acc: 0.457
Validation loss decreased (inf --> -0.456633).  Saving model ...
Epoch: 2 cost time: 3.1020023822784424
Epoch: 2, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.022 Vali Acc: 0.538 Test Loss: 1.022 Test Acc: 0.538
Validation loss decreased (-0.456633 --> -0.537562).  Saving model ...
Epoch: 3 cost time: 4.375817775726318
Epoch: 3, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.939 Vali Acc: 0.688 Test Loss: 0.939 Test Acc: 0.688
Validation loss decreased (-0.537562 --> -0.687852).  Saving model ...
Epoch: 4 cost time: 3.4474539756774902
Epoch: 4, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
Validation loss decreased (-0.687852 --> -0.716756).  Saving model ...
Epoch: 5 cost time: 3.7685563564300537
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.704 Vali Acc: 0.711 Test Loss: 0.704 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.092984199523926
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.804 Vali Acc: 0.694 Test Loss: 0.804 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.3841047286987305
Epoch: 7, Steps: 17 | Train Loss: 0.274 Vali Loss: 1.133 Vali Acc: 0.636 Test Loss: 1.133 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5394797325134277
Epoch: 8, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.618 Vali Acc: 0.792 Test Loss: 0.618 Test Acc: 0.792
Validation loss decreased (-0.716756 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 3.494654893875122
Epoch: 9, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.608 Vali Acc: 0.827 Test Loss: 0.608 Test Acc: 0.827
Validation loss decreased (-0.791901 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 3.300290822982788
Epoch: 10, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.263 Vali Acc: 0.717 Test Loss: 1.263 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3930585384368896
Epoch: 11, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.093 Vali Acc: 0.746 Test Loss: 1.093 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6282875537872314
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.064 Vali Acc: 0.798 Test Loss: 1.064 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.661151647567749
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.804 Vali Acc: 0.780 Test Loss: 0.804 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8250653743743896
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.799 Vali Acc: 0.838 Test Loss: 0.799 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838142).  Saving model ...
Epoch: 15 cost time: 3.307372808456421
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.847 Vali Acc: 0.803 Test Loss: 0.847 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.96820068359375
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3166818618774414
Epoch: 17, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.706 Vali Acc: 0.711 Test Loss: 1.706 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.22651743888855
Epoch: 18, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.500 Vali Acc: 0.786 Test Loss: 1.500 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.138413429260254
Epoch: 19, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.422 Vali Acc: 0.740 Test Loss: 1.422 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.696645736694336
Epoch: 20, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.675 Vali Acc: 0.798 Test Loss: 1.675 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.5316474437713623
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.339 Vali Acc: 0.740 Test Loss: 1.339 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.136342525482178
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.247 Vali Acc: 0.803 Test Loss: 1.247 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8833580017089844
Epoch: 23, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.465 Vali Acc: 0.775 Test Loss: 1.465 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.8747098445892334
Epoch: 24, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.873 Vali Acc: 0.775 Test Loss: 1.873 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 67583239
model size : 272.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.001528739929199
Epoch: 1, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.615 Vali Acc: 0.347 Test Loss: 1.615 Test Acc: 0.347
Validation loss decreased (inf --> -0.346805).  Saving model ...
Epoch: 2 cost time: 4.250917196273804
Epoch: 2, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.023 Vali Acc: 0.694 Test Loss: 1.023 Test Acc: 0.694
Validation loss decreased (-0.346805 --> -0.693631).  Saving model ...
Epoch: 3 cost time: 3.2566678524017334
Epoch: 3, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.731 Vali Acc: 0.705 Test Loss: 0.731 Test Acc: 0.705
Validation loss decreased (-0.693631 --> -0.705195).  Saving model ...
Epoch: 4 cost time: 3.3784265518188477
Epoch: 4, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.865 Vali Acc: 0.636 Test Loss: 0.865 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.616786241531372
Epoch: 5, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.826 Vali Acc: 0.688 Test Loss: 0.826 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.1012327671051025
Epoch: 6, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.880 Vali Acc: 0.699 Test Loss: 0.880 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.954087018966675
Epoch: 7, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.775 Vali Acc: 0.757 Test Loss: 0.775 Test Acc: 0.757
Validation loss decreased (-0.705195 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 3.8446624279022217
Epoch: 8, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.201 Vali Acc: 0.699 Test Loss: 1.201 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6443467140197754
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.742 Vali Acc: 0.798 Test Loss: 0.742 Test Acc: 0.798
Validation loss decreased (-0.757218 --> -0.797680).  Saving model ...
Epoch: 10 cost time: 3.293039560317993
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.713 Vali Acc: 0.815 Test Loss: 0.713 Test Acc: 0.815
Validation loss decreased (-0.797680 --> -0.815022).  Saving model ...
Epoch: 11 cost time: 3.4365296363830566
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.883 Vali Acc: 0.792 Test Loss: 0.883 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.687215566635132
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.600 Vali Acc: 0.792 Test Loss: 0.600 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8698155879974365
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.786 Test Loss: 0.844 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8598084449768066
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.680 Vali Acc: 0.827 Test Loss: 0.680 Test Acc: 0.827
Validation loss decreased (-0.815022 --> -0.826583).  Saving model ...
Epoch: 15 cost time: 3.630387544631958
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.741243839263916
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.984772205352783
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.803 Test Loss: 0.684 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.175692558288574
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.798 Test Loss: 0.697 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9947056770324707
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.783015012741089
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.798 Test Loss: 0.701 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2699649333953857
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.798 Test Loss: 0.711 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.18407940864563
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.798 Test Loss: 0.719 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.764655113220215
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.798 Test Loss: 0.717 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6233959197998047
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.798 Test Loss: 0.717 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 67486471
model size : 272.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.1155126094818115
Epoch: 1, Steps: 17 | Train Loss: 1.858 Vali Loss: 1.484 Vali Acc: 0.306 Test Loss: 1.484 Test Acc: 0.306
Validation loss decreased (inf --> -0.306344).  Saving model ...
Epoch: 2 cost time: 4.3821446895599365
Epoch: 2, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.138 Vali Acc: 0.509 Test Loss: 1.138 Test Acc: 0.509
Validation loss decreased (-0.306344 --> -0.508659).  Saving model ...
Epoch: 3 cost time: 4.3547210693359375
Epoch: 3, Steps: 17 | Train Loss: 0.780 Vali Loss: 1.069 Vali Acc: 0.561 Test Loss: 1.069 Test Acc: 0.561
Validation loss decreased (-0.508659 --> -0.560683).  Saving model ...
Epoch: 4 cost time: 4.338477373123169
Epoch: 4, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.958 Vali Acc: 0.607 Test Loss: 0.958 Test Acc: 0.607
Validation loss decreased (-0.560683 --> -0.606927).  Saving model ...
Epoch: 5 cost time: 2.886695384979248
Epoch: 5, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.658 Vali Acc: 0.723 Test Loss: 0.658 Test Acc: 0.723
Validation loss decreased (-0.606927 --> -0.722537).  Saving model ...
Epoch: 6 cost time: 3.0301754474639893
Epoch: 6, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
Validation loss decreased (-0.722537 --> -0.763000).  Saving model ...
Epoch: 7 cost time: 3.1809194087982178
Epoch: 7, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.108 Vali Acc: 0.659 Test Loss: 1.108 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.41921329498291
Epoch: 8, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.679 Vali Acc: 0.780 Test Loss: 0.679 Test Acc: 0.780
Validation loss decreased (-0.763000 --> -0.780340).  Saving model ...
Epoch: 9 cost time: 3.926419734954834
Epoch: 9, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.770 Vali Acc: 0.786 Test Loss: 0.770 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786119).  Saving model ...
Epoch: 10 cost time: 3.8848791122436523
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
Validation loss decreased (-0.786119 --> -0.849706).  Saving model ...
Epoch: 11 cost time: 3.7558798789978027
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.508 Vali Acc: 0.838 Test Loss: 0.508 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7911856174468994
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.736 Vali Acc: 0.746 Test Loss: 0.736 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2034080028533936
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.792 Test Loss: 0.728 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0240814685821533
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.585 Vali Acc: 0.832 Test Loss: 0.585 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6201024055480957
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 16 cost time: 2.8079161643981934
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.627 Vali Acc: 0.838 Test Loss: 0.627 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6994452476501465
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.838 Test Loss: 0.613 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.18279767036438
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.827 Test Loss: 0.608 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.299715518951416
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.832 Test Loss: 0.587 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.449512481689453
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1139063835144043
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.855 Test Loss: 0.586 Test Acc: 0.855
Validation loss decreased (-0.849706 --> -0.855485).  Saving model ...
Epoch: 22 cost time: 3.359001636505127
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0357935428619385
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.192873477935791
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.14793062210083
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.9433062076568604
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.855 Test Loss: 0.589 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1633503437042236
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.984492540359497
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.902493953704834
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.855 Test Loss: 0.600 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.410468101501465
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.7156198024749756
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 67424263
model size : 271.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.39529013633728
Epoch: 1, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.365 Vali Acc: 0.462 Test Loss: 1.365 Test Acc: 0.462
Validation loss decreased (inf --> -0.462414).  Saving model ...
Epoch: 2 cost time: 3.239645004272461
Epoch: 2, Steps: 17 | Train Loss: 1.171 Vali Loss: 0.980 Vali Acc: 0.584 Test Loss: 0.980 Test Acc: 0.584
Validation loss decreased (-0.462414 --> -0.583805).  Saving model ...
Epoch: 3 cost time: 3.167644500732422
Epoch: 3, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.839 Vali Acc: 0.659 Test Loss: 0.839 Test Acc: 0.659
Validation loss decreased (-0.583805 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 2.482163190841675
Epoch: 4, Steps: 17 | Train Loss: 0.865 Vali Loss: 0.830 Vali Acc: 0.711 Test Loss: 0.830 Test Acc: 0.711
Validation loss decreased (-0.658951 --> -0.710974).  Saving model ...
Epoch: 5 cost time: 3.459045886993408
Epoch: 5, Steps: 17 | Train Loss: 0.488 Vali Loss: 1.075 Vali Acc: 0.671 Test Loss: 1.075 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8831653594970703
Epoch: 6, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.152 Vali Acc: 0.676 Test Loss: 1.152 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8192298412323
Epoch: 7, Steps: 17 | Train Loss: 0.282 Vali Loss: 1.597 Vali Acc: 0.520 Test Loss: 1.597 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.868189573287964
Epoch: 8, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.665 Vali Acc: 0.769 Test Loss: 0.665 Test Acc: 0.769
Validation loss decreased (-0.710974 --> -0.768779).  Saving model ...
Epoch: 9 cost time: 3.687615394592285
Epoch: 9, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.145 Vali Acc: 0.763 Test Loss: 1.145 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.754479169845581
Epoch: 10, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.732 Vali Acc: 0.792 Test Loss: 0.732 Test Acc: 0.792
Validation loss decreased (-0.768779 --> -0.791900).  Saving model ...
Epoch: 11 cost time: 2.808875322341919
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.128 Vali Acc: 0.798 Test Loss: 1.128 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797677).  Saving model ...
Epoch: 12 cost time: 2.9580702781677246
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.247 Vali Acc: 0.699 Test Loss: 1.247 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.167246103286743
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.662 Vali Acc: 0.815 Test Loss: 0.662 Test Acc: 0.815
Validation loss decreased (-0.797677 --> -0.815022).  Saving model ...
Epoch: 14 cost time: 3.1351144313812256
Epoch: 14, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.261 Vali Acc: 0.786 Test Loss: 1.261 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8770909309387207
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.081 Vali Acc: 0.798 Test Loss: 1.081 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4215657711029053
Epoch: 16, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.927 Vali Acc: 0.786 Test Loss: 0.927 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.45391845703125
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.445 Vali Acc: 0.775 Test Loss: 1.445 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.499234676361084
Epoch: 18, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.178 Vali Acc: 0.838 Test Loss: 1.178 Test Acc: 0.838
Validation loss decreased (-0.815022 --> -0.838139).  Saving model ...
Epoch: 19 cost time: 3.564079999923706
Epoch: 19, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.670 Vali Acc: 0.827 Test Loss: 0.670 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.860060214996338
Epoch: 20, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.501 Vali Acc: 0.775 Test Loss: 1.501 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3818256855010986
Epoch: 21, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.086 Vali Acc: 0.798 Test Loss: 1.086 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.572164535522461
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.074 Vali Acc: 0.815 Test Loss: 1.074 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6836094856262207
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.931 Vali Acc: 0.827 Test Loss: 0.931 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.1917972564697266
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.920 Vali Acc: 0.798 Test Loss: 0.920 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1349103450775146
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.557 Vali Acc: 0.821 Test Loss: 1.557 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.336944580078125
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.120 Vali Acc: 0.803 Test Loss: 1.120 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5809972286224365
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.850 Test Loss: 1.032 Test Acc: 0.850
Validation loss decreased (-0.838139 --> -0.849701).  Saving model ...
Epoch: 28 cost time: 3.615546941757202
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.855 Test Loss: 1.029 Test Acc: 0.855
Validation loss decreased (-0.849701 --> -0.855481).  Saving model ...
Epoch: 29 cost time: 2.986797571182251
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.850 Test Loss: 1.044 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.9869489669799805
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.838 Test Loss: 1.052 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.0703282356262207
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.832 Test Loss: 1.061 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4233498573303223
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.832 Test Loss: 1.058 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.224468469619751
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.832 Test Loss: 1.133 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.0999348163604736
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.838 Test Loss: 1.157 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.247469902038574
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.832 Test Loss: 1.131 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.838704824447632
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.114 Vali Acc: 0.832 Test Loss: 1.114 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.0232880115509033
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.106 Vali Acc: 0.832 Test Loss: 1.106 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.663007974624634
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.111 Vali Acc: 0.832 Test Loss: 1.111 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 69801991
model size : 280.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.563338756561279
Epoch: 1, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.503 Vali Acc: 0.289 Test Loss: 1.503 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 3.659419298171997
Epoch: 2, Steps: 17 | Train Loss: 1.197 Vali Loss: 0.990 Vali Acc: 0.590 Test Loss: 0.990 Test Acc: 0.590
Validation loss decreased (-0.289002 --> -0.589585).  Saving model ...
Epoch: 3 cost time: 3.4919943809509277
Epoch: 3, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.984 Vali Acc: 0.659 Test Loss: 0.984 Test Acc: 0.659
Validation loss decreased (-0.589585 --> -0.658950).  Saving model ...
Epoch: 4 cost time: 3.1318769454956055
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.836 Vali Acc: 0.723 Test Loss: 0.836 Test Acc: 0.723
Validation loss decreased (-0.658950 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 2.6851418018341064
Epoch: 5, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.802 Vali Acc: 0.676 Test Loss: 0.802 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.126997709274292
Epoch: 6, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.690 Vali Acc: 0.757 Test Loss: 0.690 Test Acc: 0.757
Validation loss decreased (-0.722535 --> -0.757219).  Saving model ...
Epoch: 7 cost time: 2.1602494716644287
Epoch: 7, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.830 Vali Acc: 0.763 Test Loss: 0.830 Test Acc: 0.763
Validation loss decreased (-0.757219 --> -0.762997).  Saving model ...
Epoch: 8 cost time: 3.466609001159668
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.552 Vali Acc: 0.832 Test Loss: 0.552 Test Acc: 0.832
Validation loss decreased (-0.762997 --> -0.832364).  Saving model ...
Epoch: 9 cost time: 3.417217969894409
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.061 Vali Acc: 0.746 Test Loss: 1.061 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4221432209014893
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4551379680633545
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.711 Vali Acc: 0.792 Test Loss: 0.711 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4909300804138184
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.897 Vali Acc: 0.780 Test Loss: 0.897 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0290918350219727
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.701748847961426
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.855 Test Loss: 0.554 Test Acc: 0.855
Validation loss decreased (-0.832364 --> -0.855486).  Saving model ...
Epoch: 15 cost time: 3.675320625305176
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.056774854660034
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.02294659614563
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.821 Test Loss: 0.637 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0450427532196045
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.910839557647705
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.815 Test Loss: 0.644 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8571643829345703
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.821 Test Loss: 0.653 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.5667245388031006
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.821 Test Loss: 0.661 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.5380337238311768
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.821 Test Loss: 0.666 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.398650646209717
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.821 Test Loss: 0.670 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.2777953147888184
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.821 Test Loss: 0.684 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 69691399
model size : 280.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.041342258453369
Epoch: 1, Steps: 17 | Train Loss: 1.832 Vali Loss: 1.452 Vali Acc: 0.347 Test Loss: 1.452 Test Acc: 0.347
Validation loss decreased (inf --> -0.346806).  Saving model ...
Epoch: 2 cost time: 3.4825503826141357
Epoch: 2, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
Validation loss decreased (-0.346806 --> -0.514440).  Saving model ...
Epoch: 3 cost time: 3.727083921432495
Epoch: 3, Steps: 17 | Train Loss: 0.984 Vali Loss: 0.942 Vali Acc: 0.642 Test Loss: 0.942 Test Acc: 0.642
Validation loss decreased (-0.514440 --> -0.641609).  Saving model ...
Epoch: 4 cost time: 3.3349967002868652
Epoch: 4, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.706 Vali Acc: 0.740 Test Loss: 0.706 Test Acc: 0.740
Validation loss decreased (-0.641609 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 3.5398643016815186
Epoch: 5, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.949 Vali Acc: 0.642 Test Loss: 0.949 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2572124004364014
Epoch: 6, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
Validation loss decreased (-0.739877 --> -0.774561).  Saving model ...
Epoch: 7 cost time: 2.799022674560547
Epoch: 7, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.824594020843506
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.623 Vali Acc: 0.827 Test Loss: 0.623 Test Acc: 0.827
Validation loss decreased (-0.774561 --> -0.826583).  Saving model ...
Epoch: 9 cost time: 2.9636716842651367
Epoch: 9, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9236347675323486
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.464 Vali Acc: 0.832 Test Loss: 0.464 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832365).  Saving model ...
Epoch: 11 cost time: 3.501370668411255
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.708 Vali Acc: 0.780 Test Loss: 0.708 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4739880561828613
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.511 Vali Acc: 0.827 Test Loss: 0.511 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8280458450317383
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838144).  Saving model ...
Epoch: 14 cost time: 3.6394662857055664
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
Validation loss decreased (-0.838144 --> -0.861267).  Saving model ...
Epoch: 15 cost time: 3.103952407836914
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.452 Vali Acc: 0.838 Test Loss: 0.452 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4001805782318115
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.861 Test Loss: 0.474 Test Acc: 0.861
Validation loss decreased (-0.861267 --> -0.861267).  Saving model ...
Epoch: 17 cost time: 3.648827075958252
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.850 Test Loss: 0.496 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.471860408782959
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.501 Vali Acc: 0.850 Test Loss: 0.501 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0070242881774902
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8805947303771973
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.838 Test Loss: 0.517 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.899435043334961
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.598857879638672
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.001732587814331
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.0880494117736816
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2556540966033936
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.971517562866211
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 69636103
model size : 280.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.16065526008606
Epoch: 1, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.454 Vali Acc: 0.306 Test Loss: 1.454 Test Acc: 0.306
Validation loss decreased (inf --> -0.306344).  Saving model ...
Epoch: 2 cost time: 2.846149444580078
Epoch: 2, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.053 Vali Acc: 0.590 Test Loss: 1.053 Test Acc: 0.590
Validation loss decreased (-0.306344 --> -0.589585).  Saving model ...
Epoch: 3 cost time: 3.7643511295318604
Epoch: 3, Steps: 17 | Train Loss: 0.702 Vali Loss: 1.517 Vali Acc: 0.474 Test Loss: 1.517 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4961671829223633
Epoch: 4, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.733 Vali Acc: 0.705 Test Loss: 0.733 Test Acc: 0.705
Validation loss decreased (-0.589585 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 3.1863601207733154
Epoch: 5, Steps: 17 | Train Loss: 0.614 Vali Loss: 1.056 Vali Acc: 0.630 Test Loss: 1.056 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6165285110473633
Epoch: 6, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.051 Vali Acc: 0.665 Test Loss: 1.051 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8893892765045166
Epoch: 7, Steps: 17 | Train Loss: 0.243 Vali Loss: 1.269 Vali Acc: 0.642 Test Loss: 1.269 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6362974643707275
Epoch: 8, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.879 Vali Acc: 0.711 Test Loss: 0.879 Test Acc: 0.711
Validation loss decreased (-0.705195 --> -0.710974).  Saving model ...
Epoch: 9 cost time: 3.9936745166778564
Epoch: 9, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.795 Vali Acc: 0.763 Test Loss: 0.795 Test Acc: 0.763
Validation loss decreased (-0.710974 --> -0.762998).  Saving model ...
Epoch: 10 cost time: 3.6623804569244385
Epoch: 10, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.772 Vali Acc: 0.786 Test Loss: 0.772 Test Acc: 0.786
Validation loss decreased (-0.762998 --> -0.786119).  Saving model ...
Epoch: 11 cost time: 2.9089927673339844
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.328 Vali Acc: 0.699 Test Loss: 1.328 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.135153293609619
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.287 Vali Acc: 0.734 Test Loss: 1.287 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.125938653945923
Epoch: 13, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.273 Vali Acc: 0.786 Test Loss: 1.273 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6489031314849854
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.895 Vali Acc: 0.803 Test Loss: 0.895 Test Acc: 0.803
Validation loss decreased (-0.786119 --> -0.803459).  Saving model ...
Epoch: 15 cost time: 3.22969913482666
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.983 Vali Acc: 0.763 Test Loss: 0.983 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.627983808517456
Epoch: 16, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.689 Vali Acc: 0.728 Test Loss: 1.689 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.9977147579193115
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.359 Vali Acc: 0.780 Test Loss: 1.359 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.180417537689209
Epoch: 18, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.715 Vali Acc: 0.798 Test Loss: 1.715 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4366259574890137
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.676 Vali Acc: 0.798 Test Loss: 1.676 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.144171953201294
Epoch: 20, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.479 Vali Acc: 0.786 Test Loss: 1.479 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.928537607192993
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.259 Vali Acc: 0.751 Test Loss: 2.259 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.4711148738861084
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.807 Vali Acc: 0.763 Test Loss: 1.807 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.0328314304351807
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.171 Vali Acc: 0.815 Test Loss: 1.171 Test Acc: 0.815
Validation loss decreased (-0.803459 --> -0.815017).  Saving model ...
Epoch: 24 cost time: 3.013906478881836
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.623 Vali Acc: 0.786 Test Loss: 1.623 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.054337501525879
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.426 Vali Acc: 0.844 Test Loss: 1.426 Test Acc: 0.844
Validation loss decreased (-0.815017 --> -0.843916).  Saving model ...
Epoch: 26 cost time: 3.084503650665283
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.827 Test Loss: 1.390 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.278143882751465
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.821 Test Loss: 1.418 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0574193000793457
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.815 Test Loss: 1.453 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.069385051727295
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.815 Test Loss: 1.464 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.5268537998199463
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.815 Test Loss: 1.465 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.573416233062744
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.815 Test Loss: 1.469 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2937698364257812
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.809 Test Loss: 1.471 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0317463874816895
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.475 Vali Acc: 0.809 Test Loss: 1.475 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.5643725395202637
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.809 Test Loss: 1.473 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.880124568939209
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.809 Test Loss: 1.474 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 72020743
model size : 289.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.902565002441406
Epoch: 1, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.374 Vali Acc: 0.480 Test Loss: 1.374 Test Acc: 0.480
Validation loss decreased (inf --> -0.479755).  Saving model ...
Epoch: 2 cost time: 3.1145570278167725
Epoch: 2, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.091 Vali Acc: 0.509 Test Loss: 1.091 Test Acc: 0.509
Validation loss decreased (-0.479755 --> -0.508660).  Saving model ...
Epoch: 3 cost time: 3.169468879699707
Epoch: 3, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.062 Vali Acc: 0.630 Test Loss: 1.062 Test Acc: 0.630
Validation loss decreased (-0.508660 --> -0.630047).  Saving model ...
Epoch: 4 cost time: 3.568016529083252
Epoch: 4, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.849 Vali Acc: 0.676 Test Loss: 0.849 Test Acc: 0.676
Validation loss decreased (-0.630047 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 2.633924961090088
Epoch: 5, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.703 Vali Acc: 0.740 Test Loss: 0.703 Test Acc: 0.740
Validation loss decreased (-0.676292 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 2.905118227005005
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.899 Vali Acc: 0.711 Test Loss: 0.899 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0773677825927734
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 1.023 Vali Acc: 0.671 Test Loss: 1.023 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.018885850906372
Epoch: 8, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.734 Vali Acc: 0.792 Test Loss: 0.734 Test Acc: 0.792
Validation loss decreased (-0.739877 --> -0.791900).  Saving model ...
Epoch: 9 cost time: 3.264770269393921
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.720 Vali Acc: 0.792 Test Loss: 0.720 Test Acc: 0.792
Validation loss decreased (-0.791900 --> -0.791900).  Saving model ...
Epoch: 10 cost time: 3.2948076725006104
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.809 Vali Acc: 0.728 Test Loss: 0.809 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1269314289093018
Epoch: 11, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
Validation loss decreased (-0.791900 --> -0.843924).  Saving model ...
Epoch: 12 cost time: 3.2279272079467773
Epoch: 12, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.488 Vali Acc: 0.821 Test Loss: 0.488 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.26485276222229
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.765 Vali Acc: 0.786 Test Loss: 0.765 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3774518966674805
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.526 Vali Acc: 0.855 Test Loss: 0.526 Test Acc: 0.855
Validation loss decreased (-0.843924 --> -0.855486).  Saving model ...
Epoch: 15 cost time: 2.9588863849639893
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.628 Vali Acc: 0.803 Test Loss: 0.628 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7243926525115967
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8520426750183105
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.832 Test Loss: 0.492 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0506393909454346
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.553 Vali Acc: 0.832 Test Loss: 0.553 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1854166984558105
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.832 Test Loss: 0.521 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1356093883514404
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.501598358154297
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7940027713775635
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.919861316680908
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.838 Test Loss: 0.522 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.8558080196380615
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.838 Test Loss: 0.523 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 71910151
model size : 288.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.6524882316589355
Epoch: 1, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.368 Vali Acc: 0.439 Test Loss: 1.368 Test Acc: 0.439
Validation loss decreased (inf --> -0.439293).  Saving model ...
Epoch: 2 cost time: 3.0141608715057373
Epoch: 2, Steps: 17 | Train Loss: 1.182 Vali Loss: 0.996 Vali Acc: 0.618 Test Loss: 0.996 Test Acc: 0.618
Validation loss decreased (-0.439293 --> -0.618487).  Saving model ...
Epoch: 3 cost time: 2.9798266887664795
Epoch: 3, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.831 Vali Acc: 0.665 Test Loss: 0.831 Test Acc: 0.665
Validation loss decreased (-0.618487 --> -0.664732).  Saving model ...
Epoch: 4 cost time: 3.188366651535034
Epoch: 4, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.686 Vali Acc: 0.723 Test Loss: 0.686 Test Acc: 0.723
Validation loss decreased (-0.664732 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 2.129981756210327
Epoch: 5, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.619 Vali Acc: 0.786 Test Loss: 0.619 Test Acc: 0.786
Validation loss decreased (-0.722536 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 2.5796091556549072
Epoch: 6, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.787 Vali Acc: 0.705 Test Loss: 0.787 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.459890842437744
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.607 Vali Acc: 0.786 Test Loss: 0.607 Test Acc: 0.786
Validation loss decreased (-0.786121 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 2.6732277870178223
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 3.0535266399383545
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
Validation loss decreased (-0.803462 --> -0.838145).  Saving model ...
Epoch: 10 cost time: 2.8378283977508545
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.770646572113037
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.850 Test Loss: 0.439 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849707).  Saving model ...
Epoch: 12 cost time: 2.486898422241211
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.693 Vali Acc: 0.832 Test Loss: 0.693 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.673513889312744
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.465 Vali Acc: 0.827 Test Loss: 0.465 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8152904510498047
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.626919984817505
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.823768138885498
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.815 Test Loss: 0.585 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.514399766921997
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3809938430786133
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.792 Test Loss: 0.572 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.4564578533172607
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.832 Test Loss: 0.568 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4122354984283447
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.543147563934326
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.832 Test Loss: 0.584 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 71854855
model size : 288.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.470207691192627
Epoch: 1, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.597 Vali Acc: 0.283 Test Loss: 1.597 Test Acc: 0.283
Validation loss decreased (inf --> -0.283221).  Saving model ...
Epoch: 2 cost time: 3.521719217300415
Epoch: 2, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.062 Vali Acc: 0.572 Test Loss: 1.062 Test Acc: 0.572
Validation loss decreased (-0.283221 --> -0.572244).  Saving model ...
Epoch: 3 cost time: 3.84128737449646
Epoch: 3, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.724 Vali Acc: 0.711 Test Loss: 0.724 Test Acc: 0.711
Validation loss decreased (-0.572244 --> -0.710975).  Saving model ...
Epoch: 4 cost time: 4.117915868759155
Epoch: 4, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.746 Vali Acc: 0.699 Test Loss: 0.746 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.378392696380615
Epoch: 5, Steps: 17 | Train Loss: 0.473 Vali Loss: 1.073 Vali Acc: 0.566 Test Loss: 1.073 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.113546133041382
Epoch: 6, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.935 Vali Acc: 0.699 Test Loss: 0.935 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.207196950912476
Epoch: 7, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.629 Vali Acc: 0.780 Test Loss: 0.629 Test Acc: 0.780
Validation loss decreased (-0.710975 --> -0.780341).  Saving model ...
Epoch: 8 cost time: 3.2632832527160645
Epoch: 8, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.992 Vali Acc: 0.699 Test Loss: 0.992 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2893073558807373
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.147 Vali Acc: 0.717 Test Loss: 1.147 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.282212495803833
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.029 Vali Acc: 0.734 Test Loss: 1.029 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.063758373260498
Epoch: 11, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.889 Vali Acc: 0.821 Test Loss: 0.889 Test Acc: 0.821
Validation loss decreased (-0.780341 --> -0.820800).  Saving model ...
Epoch: 12 cost time: 4.050750255584717
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.303 Vali Acc: 0.757 Test Loss: 1.303 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9341962337493896
Epoch: 13, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.829 Vali Acc: 0.809 Test Loss: 0.829 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.1295435428619385
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.584 Vali Acc: 0.728 Test Loss: 1.584 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.006653785705566
Epoch: 15, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.0043487548828125
Epoch: 16, Steps: 17 | Train Loss: 0.189 Vali Loss: 1.247 Vali Acc: 0.717 Test Loss: 1.247 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.980555772781372
Epoch: 17, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.182 Vali Acc: 0.740 Test Loss: 1.182 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.179494619369507
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.844 Vali Acc: 0.855 Test Loss: 0.844 Test Acc: 0.855
Validation loss decreased (-0.820800 --> -0.855483).  Saving model ...
Epoch: 19 cost time: 3.952353000640869
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.070 Vali Acc: 0.711 Test Loss: 2.070 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.675825595855713
Epoch: 20, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.994 Vali Acc: 0.798 Test Loss: 0.994 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.408352851867676
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.809 Test Loss: 1.057 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4614639282226562
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.977 Vali Acc: 0.803 Test Loss: 0.977 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.598403215408325
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.255 Vali Acc: 0.780 Test Loss: 1.255 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9731557369232178
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.820 Vali Acc: 0.815 Test Loss: 0.820 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.818056583404541
Epoch: 25, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.924 Vali Acc: 0.711 Test Loss: 1.924 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.660562038421631
Epoch: 26, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.986 Vali Acc: 0.792 Test Loss: 0.986 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.7252347469329834
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.026 Vali Acc: 0.751 Test Loss: 1.026 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.816784620285034
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.899 Vali Acc: 0.763 Test Loss: 1.899 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 76409863
model size : 306.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.905608892440796
Epoch: 1, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.303 Vali Acc: 0.543 Test Loss: 1.303 Test Acc: 0.543
Validation loss decreased (inf --> -0.543340).  Saving model ...
Epoch: 2 cost time: 3.7008793354034424
Epoch: 2, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.015 Vali Acc: 0.624 Test Loss: 1.015 Test Acc: 0.624
Validation loss decreased (-0.543340 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 4.065718412399292
Epoch: 3, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.916 Vali Acc: 0.601 Test Loss: 0.916 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.851992130279541
Epoch: 4, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.782 Vali Acc: 0.705 Test Loss: 0.782 Test Acc: 0.705
Validation loss decreased (-0.624267 --> -0.705194).  Saving model ...
Epoch: 5 cost time: 4.085256814956665
Epoch: 5, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.623 Vali Acc: 0.769 Test Loss: 0.623 Test Acc: 0.769
Validation loss decreased (-0.705194 --> -0.768780).  Saving model ...
Epoch: 6 cost time: 3.789597749710083
Epoch: 6, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.819 Vali Acc: 0.694 Test Loss: 0.819 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6958730220794678
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809242).  Saving model ...
Epoch: 8 cost time: 3.4961440563201904
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.662 Vali Acc: 0.832 Test Loss: 0.662 Test Acc: 0.832
Validation loss decreased (-0.809242 --> -0.832363).  Saving model ...
Epoch: 9 cost time: 3.9890246391296387
Epoch: 9, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.613 Vali Acc: 0.792 Test Loss: 0.613 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0276360511779785
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.235 Vali Acc: 0.723 Test Loss: 1.235 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.02505087852478
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.717 Vali Acc: 0.792 Test Loss: 0.717 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.854951858520508
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.656 Vali Acc: 0.832 Test Loss: 0.656 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 13 cost time: 3.637606382369995
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.566 Vali Acc: 0.827 Test Loss: 0.566 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.604353904724121
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.832363 --> -0.855487).  Saving model ...
Epoch: 15 cost time: 3.8661551475524902
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.526 Vali Acc: 0.850 Test Loss: 0.526 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.752746343612671
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.838 Test Loss: 0.555 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.844287395477295
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.832 Test Loss: 0.592 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.781708002090454
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.832 Test Loss: 0.592 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.818202257156372
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.827 Test Loss: 0.611 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9262876510620117
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.832 Test Loss: 0.616 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.908787488937378
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.832 Test Loss: 0.624 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.8412973880767822
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.827 Test Loss: 0.628 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.0509068965911865
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5042922496795654
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 76333831
model size : 305.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.797241687774658
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.618 Vali Acc: 0.347 Test Loss: 1.618 Test Acc: 0.347
Validation loss decreased (inf --> -0.346805).  Saving model ...
Epoch: 2 cost time: 3.8808703422546387
Epoch: 2, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.056 Vali Acc: 0.590 Test Loss: 1.056 Test Acc: 0.590
Validation loss decreased (-0.346805 --> -0.589585).  Saving model ...
Epoch: 3 cost time: 3.9551310539245605
Epoch: 3, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.922 Vali Acc: 0.584 Test Loss: 0.922 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.073323488235474
Epoch: 4, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.597 Vali Acc: 0.775 Test Loss: 0.597 Test Acc: 0.775
Validation loss decreased (-0.589585 --> -0.774561).  Saving model ...
Epoch: 5 cost time: 3.295748710632324
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.981 Vali Acc: 0.705 Test Loss: 0.981 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3587522506713867
Epoch: 6, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
Validation loss decreased (-0.774561 --> -0.809243).  Saving model ...
Epoch: 7 cost time: 3.7420756816864014
Epoch: 7, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.588 Vali Acc: 0.792 Test Loss: 0.588 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8322575092315674
Epoch: 8, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3693108558654785
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.767 Vali Acc: 0.769 Test Loss: 0.767 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.980936288833618
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.987 Vali Acc: 0.792 Test Loss: 0.987 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.863628387451172
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.536 Vali Acc: 0.832 Test Loss: 0.536 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832365).  Saving model ...
Epoch: 12 cost time: 2.906618595123291
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.998 Vali Acc: 0.803 Test Loss: 0.998 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2915759086608887
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.848 Vali Acc: 0.780 Test Loss: 0.848 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.647878408432007
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.827 Test Loss: 0.663 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3504855632781982
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.781 Vali Acc: 0.798 Test Loss: 0.781 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.245237350463867
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.809 Test Loss: 0.693 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7264416217803955
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.798 Test Loss: 0.708 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.5569183826446533
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.809 Test Loss: 0.734 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3304519653320312
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.809 Test Loss: 0.746 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2191848754882812
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.809 Test Loss: 0.763 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.893902063369751
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 76285447
model size : 305.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.2186431884765625
Epoch: 1, Steps: 17 | Train Loss: 1.832 Vali Loss: 1.482 Vali Acc: 0.405 Test Loss: 1.482 Test Acc: 0.405
Validation loss decreased (inf --> -0.404609).  Saving model ...
Epoch: 2 cost time: 4.6105170249938965
Epoch: 2, Steps: 17 | Train Loss: 1.166 Vali Loss: 0.970 Vali Acc: 0.630 Test Loss: 0.970 Test Acc: 0.630
Validation loss decreased (-0.404609 --> -0.630048).  Saving model ...
Epoch: 3 cost time: 4.082673788070679
Epoch: 3, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.913 Vali Acc: 0.624 Test Loss: 0.913 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.396956443786621
Epoch: 4, Steps: 17 | Train Loss: 0.696 Vali Loss: 1.131 Vali Acc: 0.728 Test Loss: 1.131 Test Acc: 0.728
Validation loss decreased (-0.630048 --> -0.728312).  Saving model ...
Epoch: 5 cost time: 4.496289968490601
Epoch: 5, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.788 Vali Acc: 0.699 Test Loss: 0.788 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.6336894035339355
Epoch: 6, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
Validation loss decreased (-0.728312 --> -0.803462).  Saving model ...
Epoch: 7 cost time: 4.174386501312256
Epoch: 7, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.846 Vali Acc: 0.734 Test Loss: 0.846 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5415427684783936
Epoch: 8, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.658 Vali Acc: 0.798 Test Loss: 0.658 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.537636041641235
Epoch: 9, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.862 Vali Acc: 0.780 Test Loss: 0.862 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7342660427093506
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.875 Vali Acc: 0.809 Test Loss: 0.875 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809240).  Saving model ...
Epoch: 11 cost time: 4.385274410247803
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.716 Vali Acc: 0.792 Test Loss: 0.716 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.443501949310303
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.815 Vali Acc: 0.792 Test Loss: 0.815 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9439895153045654
Epoch: 13, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.886 Vali Acc: 0.803 Test Loss: 0.886 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.1597864627838135
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.753 Vali Acc: 0.786 Test Loss: 0.753 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.943037986755371
Epoch: 15, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.082 Vali Acc: 0.705 Test Loss: 1.082 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.9333608150482178
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.196 Vali Acc: 0.757 Test Loss: 1.196 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.349762439727783
Epoch: 17, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.966 Vali Acc: 0.803 Test Loss: 0.966 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.0056421756744385
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.984 Vali Acc: 0.832 Test Loss: 0.984 Test Acc: 0.832
Validation loss decreased (-0.809240 --> -0.832360).  Saving model ...
Epoch: 19 cost time: 3.9367074966430664
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.855 Vali Acc: 0.803 Test Loss: 0.855 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.557175397872925
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.821 Vali Acc: 0.827 Test Loss: 0.821 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.024543762207031
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.893 Vali Acc: 0.803 Test Loss: 0.893 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.301015853881836
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.479 Vali Acc: 0.757 Test Loss: 1.479 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.015277624130249
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.854 Vali Acc: 0.838 Test Loss: 0.854 Test Acc: 0.838
Validation loss decreased (-0.832360 --> -0.838142).  Saving model ...
Epoch: 24 cost time: 4.443316698074341
Epoch: 24, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.857 Vali Acc: 0.827 Test Loss: 0.857 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.278163433074951
Epoch: 25, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.794 Vali Acc: 0.850 Test Loss: 0.794 Test Acc: 0.850
Validation loss decreased (-0.838142 --> -0.849703).  Saving model ...
Epoch: 26 cost time: 3.8660783767700195
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.032 Vali Acc: 0.803 Test Loss: 1.032 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.6822545528411865
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.916 Vali Acc: 0.815 Test Loss: 0.916 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6825180053710938
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.904 Vali Acc: 0.803 Test Loss: 0.904 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.87192964553833
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.894 Vali Acc: 0.798 Test Loss: 0.894 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.427683591842651
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.838 Test Loss: 0.696 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.469560384750366
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.332 Vali Acc: 0.815 Test Loss: 1.332 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.107203722000122
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.920 Vali Acc: 0.827 Test Loss: 0.920 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.171020030975342
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.798 Vali Acc: 0.867 Test Loss: 0.798 Test Acc: 0.867
Validation loss decreased (-0.849703 --> -0.867044).  Saving model ...
Epoch: 34 cost time: 4.239490747451782
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.832 Test Loss: 0.916 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.539468288421631
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.122 Vali Acc: 0.809 Test Loss: 1.122 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.3077425956726074
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.815 Test Loss: 1.151 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1567280292510986
Epoch: 37, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.875 Vali Acc: 0.699 Test Loss: 1.875 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.9950976371765137
Epoch: 38, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.769 Vali Acc: 0.815 Test Loss: 0.769 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.1387510299682617
Epoch: 39, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.093 Vali Acc: 0.746 Test Loss: 1.093 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.598934173583984
Epoch: 40, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.893 Vali Acc: 0.809 Test Loss: 0.893 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.692976951599121
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.138 Vali Acc: 0.792 Test Loss: 1.138 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.010260105133057
Epoch: 42, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.949 Vali Acc: 0.780 Test Loss: 0.949 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.539675712585449
Epoch: 43, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.005 Vali Acc: 0.827 Test Loss: 1.005 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 83031559
model size : 331.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.809738397598267
Epoch: 1, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.430 Vali Acc: 0.410 Test Loss: 1.430 Test Acc: 0.410
Validation loss decreased (inf --> -0.410390).  Saving model ...
Epoch: 2 cost time: 3.8513503074645996
Epoch: 2, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.064 Vali Acc: 0.561 Test Loss: 1.064 Test Acc: 0.561
Validation loss decreased (-0.410390 --> -0.560683).  Saving model ...
Epoch: 3 cost time: 4.543675661087036
Epoch: 3, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.744 Vali Acc: 0.763 Test Loss: 0.744 Test Acc: 0.763
Validation loss decreased (-0.560683 --> -0.762998).  Saving model ...
Epoch: 4 cost time: 4.545114994049072
Epoch: 4, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.767802000045776
Epoch: 5, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.744 Vali Acc: 0.740 Test Loss: 0.744 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.527899980545044
Epoch: 6, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.585 Vali Acc: 0.740 Test Loss: 0.585 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.079483270645142
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.763000).  Saving model ...
Epoch: 8 cost time: 4.177304267883301
Epoch: 8, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.474 Vali Acc: 0.827 Test Loss: 0.474 Test Acc: 0.827
Validation loss decreased (-0.763000 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 3.9328269958496094
Epoch: 9, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.695 Vali Acc: 0.769 Test Loss: 0.695 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.00223445892334
Epoch: 10, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.683 Vali Acc: 0.798 Test Loss: 0.683 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8355085849761963
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4972681999206543
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.551 Vali Acc: 0.815 Test Loss: 0.551 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.939739227294922
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.855 Vali Acc: 0.723 Test Loss: 0.855 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.295622110366821
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.507 Vali Acc: 0.861 Test Loss: 0.507 Test Acc: 0.861
Validation loss decreased (-0.826585 --> -0.861267).  Saving model ...
Epoch: 15 cost time: 3.9497599601745605
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.821 Test Loss: 0.563 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.241094350814819
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.880 Vali Acc: 0.815 Test Loss: 0.880 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.30745792388916
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.832 Test Loss: 0.781 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4115662574768066
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.867 Test Loss: 0.692 Test Acc: 0.867
Validation loss decreased (-0.861267 --> -0.867045).  Saving model ...
Epoch: 19 cost time: 3.9517982006073
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9542202949523926
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.850 Test Loss: 0.745 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.502182960510254
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.861 Test Loss: 0.746 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.355682373046875
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.861 Test Loss: 0.754 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.7622435092926025
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.5993077754974365
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.861 Test Loss: 0.760 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.9491209983825684
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.850 Test Loss: 0.765 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.689254999160767
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.861 Test Loss: 0.759 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.5214457511901855
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.861 Test Loss: 0.767 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.9533348083496094
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.861 Test Loss: 0.768 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 82969351
model size : 331.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.384946346282959
Epoch: 1, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.345 Vali Acc: 0.509 Test Loss: 1.345 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 4.048224449157715
Epoch: 2, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.062 Vali Acc: 0.549 Test Loss: 1.062 Test Acc: 0.549
Validation loss decreased (-0.508657 --> -0.549122).  Saving model ...
Epoch: 3 cost time: 4.478888988494873
Epoch: 3, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.084 Vali Acc: 0.549 Test Loss: 1.084 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.333000898361206
Epoch: 4, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.776 Vali Acc: 0.671 Test Loss: 0.776 Test Acc: 0.671
Validation loss decreased (-0.549122 --> -0.670512).  Saving model ...
Epoch: 5 cost time: 3.262977123260498
Epoch: 5, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.997 Vali Acc: 0.647 Test Loss: 0.997 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.602095365524292
Epoch: 6, Steps: 17 | Train Loss: 0.362 Vali Loss: 1.009 Vali Acc: 0.642 Test Loss: 1.009 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.720050573348999
Epoch: 7, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.669 Vali Acc: 0.711 Test Loss: 0.669 Test Acc: 0.711
Validation loss decreased (-0.670512 --> -0.710976).  Saving model ...
Epoch: 8 cost time: 4.003374099731445
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
Validation loss decreased (-0.710976 --> -0.838145).  Saving model ...
Epoch: 9 cost time: 4.027753591537476
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.697404146194458
Epoch: 10, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.089869499206543
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.850 Vali Acc: 0.809 Test Loss: 0.850 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.333383083343506
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.669 Vali Acc: 0.815 Test Loss: 0.669 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.876295328140259
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.563 Vali Acc: 0.780 Test Loss: 0.563 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2417263984680176
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.815 Test Loss: 0.582 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.714344024658203
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.556 Vali Acc: 0.832 Test Loss: 0.556 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6884043216705322
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.8057141304016113
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.798 Test Loss: 0.572 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.861649513244629
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.832 Test Loss: 0.575 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 82927879
model size : 331.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.613736152648926
Epoch: 1, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.609 Vali Acc: 0.243 Test Loss: 1.609 Test Acc: 0.243
Validation loss decreased (inf --> -0.242758).  Saving model ...
Epoch: 2 cost time: 3.7719368934631348
Epoch: 2, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.287 Vali Acc: 0.422 Test Loss: 1.287 Test Acc: 0.422
Validation loss decreased (-0.242758 --> -0.421952).  Saving model ...
Epoch: 3 cost time: 4.380588054656982
Epoch: 3, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.610 Vali Acc: 0.792 Test Loss: 0.610 Test Acc: 0.792
Validation loss decreased (-0.421952 --> -0.791901).  Saving model ...
Epoch: 4 cost time: 4.036612272262573
Epoch: 4, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.585 Vali Acc: 0.815 Test Loss: 0.585 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815023).  Saving model ...
Epoch: 5 cost time: 3.9548771381378174
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 1.194 Vali Acc: 0.607 Test Loss: 1.194 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.3486387729644775
Epoch: 6, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.470358371734619
Epoch: 7, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.803 Vali Acc: 0.740 Test Loss: 0.803 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.4905920028686523
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.701 Vali Acc: 0.786 Test Loss: 0.701 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2292819023132324
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.694 Vali Acc: 0.821 Test Loss: 0.694 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820802).  Saving model ...
Epoch: 10 cost time: 4.538491725921631
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.937 Vali Acc: 0.780 Test Loss: 0.937 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.9243035316467285
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.880 Vali Acc: 0.792 Test Loss: 0.880 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.370625972747803
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.840 Vali Acc: 0.803 Test Loss: 0.840 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.526981353759766
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.802 Vali Acc: 0.786 Test Loss: 0.802 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.926236391067505
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.967 Vali Acc: 0.775 Test Loss: 0.967 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.558959722518921
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.783 Vali Acc: 0.809 Test Loss: 0.783 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.619499683380127
Epoch: 16, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.817 Vali Acc: 0.734 Test Loss: 0.817 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6269772052764893
Epoch: 17, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.895 Vali Acc: 0.792 Test Loss: 0.895 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.9191925525665283
Epoch: 18, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.912 Vali Acc: 0.803 Test Loss: 0.912 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.032339811325073
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.051 Vali Acc: 0.775 Test Loss: 1.051 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 89687815
model size : 356.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.512888431549072
Epoch: 1, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.437 Vali Acc: 0.358 Test Loss: 1.437 Test Acc: 0.358
Validation loss decreased (inf --> -0.358367).  Saving model ...
Epoch: 2 cost time: 3.5417416095733643
Epoch: 2, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.022 Vali Acc: 0.555 Test Loss: 1.022 Test Acc: 0.555
Validation loss decreased (-0.358367 --> -0.554903).  Saving model ...
Epoch: 3 cost time: 3.9073028564453125
Epoch: 3, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.973 Vali Acc: 0.572 Test Loss: 0.973 Test Acc: 0.572
Validation loss decreased (-0.554903 --> -0.572245).  Saving model ...
Epoch: 4 cost time: 4.101050615310669
Epoch: 4, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.840 Vali Acc: 0.671 Test Loss: 0.840 Test Acc: 0.671
Validation loss decreased (-0.572245 --> -0.670512).  Saving model ...
Epoch: 5 cost time: 4.389368534088135
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 1.042 Vali Acc: 0.740 Test Loss: 1.042 Test Acc: 0.740
Validation loss decreased (-0.670512 --> -0.739874).  Saving model ...
Epoch: 6 cost time: 3.7678003311157227
Epoch: 6, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
Validation loss decreased (-0.739874 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 3.9633071422576904
Epoch: 7, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.806 Vali Acc: 0.734 Test Loss: 0.806 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5392258167266846
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.712 Vali Acc: 0.792 Test Loss: 0.712 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.401819229125977
Epoch: 9, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.905 Vali Acc: 0.751 Test Loss: 0.905 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.025743007659912
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.853 Vali Acc: 0.792 Test Loss: 0.853 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3322577476501465
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.991 Vali Acc: 0.751 Test Loss: 0.991 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.089449882507324
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.054 Vali Acc: 0.786 Test Loss: 1.054 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.208332300186157
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.026 Vali Acc: 0.751 Test Loss: 1.026 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9875566959381104
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.898 Vali Acc: 0.780 Test Loss: 0.898 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.9949750900268555
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.9694623947143555
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.781 Vali Acc: 0.769 Test Loss: 0.781 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 89618695
model size : 356.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.709616661071777
Epoch: 1, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.331 Vali Acc: 0.497 Test Loss: 1.331 Test Acc: 0.497
Validation loss decreased (inf --> -0.497097).  Saving model ...
Epoch: 2 cost time: 4.406512975692749
Epoch: 2, Steps: 17 | Train Loss: 1.151 Vali Loss: 0.949 Vali Acc: 0.659 Test Loss: 0.949 Test Acc: 0.659
Validation loss decreased (-0.497097 --> -0.658950).  Saving model ...
Epoch: 3 cost time: 4.383692264556885
Epoch: 3, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.842 Vali Acc: 0.647 Test Loss: 0.842 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2964181900024414
Epoch: 4, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.914 Vali Acc: 0.647 Test Loss: 0.914 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5876452922821045
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.774 Vali Acc: 0.665 Test Loss: 0.774 Test Acc: 0.665
Validation loss decreased (-0.658950 --> -0.664732).  Saving model ...
Epoch: 6 cost time: 3.586010694503784
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.615 Vali Acc: 0.798 Test Loss: 0.615 Test Acc: 0.798
Validation loss decreased (-0.664732 --> -0.797682).  Saving model ...
Epoch: 7 cost time: 3.123823642730713
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.769 Vali Acc: 0.740 Test Loss: 0.769 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.2934935092926025
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.066537380218506
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.149 Vali Acc: 0.694 Test Loss: 1.149 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.930319309234619
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809242).  Saving model ...
Epoch: 11 cost time: 4.052734136581421
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.879 Vali Acc: 0.757 Test Loss: 0.879 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.337647199630737
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.927 Vali Acc: 0.763 Test Loss: 0.927 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.365986108779907
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.590 Vali Acc: 0.827 Test Loss: 0.590 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826584).  Saving model ...
Epoch: 14 cost time: 3.6437337398529053
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.832 Test Loss: 0.659 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832363).  Saving model ...
Epoch: 15 cost time: 3.8340721130371094
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.043 Vali Acc: 0.803 Test Loss: 1.043 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.26043963432312
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.375 Vali Acc: 0.769 Test Loss: 1.375 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.307882785797119
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.233 Vali Acc: 0.775 Test Loss: 1.233 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.417006492614746
Epoch: 18, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.919 Vali Acc: 0.792 Test Loss: 0.919 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.187380790710449
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.663 Vali Acc: 0.827 Test Loss: 0.663 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.784446954727173
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
Validation loss decreased (-0.832363 --> -0.843925).  Saving model ...
Epoch: 21 cost time: 3.6234130859375
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.815 Test Loss: 0.653 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.147180557250977
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.111321449279785
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.827 Test Loss: 0.584 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.012179136276245
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.827 Test Loss: 0.600 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.941136598587036
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.827 Test Loss: 0.611 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.113983869552612
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.827 Test Loss: 0.612 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.8940019607543945
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.827 Test Loss: 0.609 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.9390859603881836
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.821 Test Loss: 0.608 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.902919292449951
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.821 Test Loss: 0.616 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.108197450637817
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.821 Test Loss: 0.620 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 89584135
model size : 356.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.362544059753418
Epoch: 1, Steps: 17 | Train Loss: 1.858 Vali Loss: 1.406 Vali Acc: 0.457 Test Loss: 1.406 Test Acc: 0.457
Validation loss decreased (inf --> -0.456633).  Saving model ...
Epoch: 2 cost time: 5.729970216751099
Epoch: 2, Steps: 17 | Train Loss: 1.104 Vali Loss: 0.920 Vali Acc: 0.653 Test Loss: 0.920 Test Acc: 0.653
Validation loss decreased (-0.456633 --> -0.653170).  Saving model ...
Epoch: 3 cost time: 6.0343406200408936
Epoch: 3, Steps: 17 | Train Loss: 0.709 Vali Loss: 1.170 Vali Acc: 0.636 Test Loss: 1.170 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.848833084106445
Epoch: 4, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.635 Vali Acc: 0.769 Test Loss: 0.635 Test Acc: 0.769
Validation loss decreased (-0.653170 --> -0.768780).  Saving model ...
Epoch: 5 cost time: 5.459952354431152
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 1.044 Vali Acc: 0.671 Test Loss: 1.044 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7059948444366455
Epoch: 6, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.693 Vali Acc: 0.792 Test Loss: 0.693 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 5.873671293258667
Epoch: 7, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.780283689498901
Epoch: 8, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.662 Vali Acc: 0.827 Test Loss: 0.662 Test Acc: 0.827
Validation loss decreased (-0.791901 --> -0.826583).  Saving model ...
Epoch: 9 cost time: 4.420243263244629
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.549 Vali Acc: 0.832 Test Loss: 0.549 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832364).  Saving model ...
Epoch: 10 cost time: 5.049139738082886
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.766 Vali Acc: 0.815 Test Loss: 0.766 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.950076103210449
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.657 Vali Acc: 0.786 Test Loss: 0.657 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.795782089233398
Epoch: 12, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.219 Vali Acc: 0.775 Test Loss: 1.219 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.015044927597046
Epoch: 13, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.738 Vali Acc: 0.792 Test Loss: 0.738 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.113590478897095
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.344 Vali Acc: 0.723 Test Loss: 1.344 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.11118745803833
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.792 Vali Acc: 0.769 Test Loss: 0.792 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.185874700546265
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.313062429428101
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.840105772018433
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.710 Vali Acc: 0.786 Test Loss: 0.710 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.223848819732666
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.821 Test Loss: 0.653 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 100740103
model size : 398.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.473586082458496
Epoch: 1, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.448 Vali Acc: 0.353 Test Loss: 1.448 Test Acc: 0.353
Validation loss decreased (inf --> -0.352587).  Saving model ...
Epoch: 2 cost time: 4.700295448303223
Epoch: 2, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.074 Vali Acc: 0.549 Test Loss: 1.074 Test Acc: 0.549
Validation loss decreased (-0.352587 --> -0.549122).  Saving model ...
Epoch: 3 cost time: 4.8854451179504395
Epoch: 3, Steps: 17 | Train Loss: 0.821 Vali Loss: 1.107 Vali Acc: 0.728 Test Loss: 1.107 Test Acc: 0.728
Validation loss decreased (-0.549122 --> -0.728313).  Saving model ...
Epoch: 4 cost time: 4.906687498092651
Epoch: 4, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.685 Vali Acc: 0.775 Test Loss: 0.685 Test Acc: 0.775
Validation loss decreased (-0.728313 --> -0.774560).  Saving model ...
Epoch: 5 cost time: 4.62577223777771
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.682 Vali Acc: 0.751 Test Loss: 0.682 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.556643724441528
Epoch: 6, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.076 Vali Acc: 0.699 Test Loss: 1.076 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.285980939865112
Epoch: 7, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.630 Vali Acc: 0.786 Test Loss: 0.630 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 5.34880805015564
Epoch: 8, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.512 Vali Acc: 0.821 Test Loss: 0.512 Test Acc: 0.821
Validation loss decreased (-0.786121 --> -0.820804).  Saving model ...
Epoch: 9 cost time: 5.360365152359009
Epoch: 9, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.606 Vali Acc: 0.821 Test Loss: 0.606 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.3125388622283936
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.461773157119751
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.624 Vali Acc: 0.838 Test Loss: 0.624 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838144).  Saving model ...
Epoch: 12 cost time: 4.921121597290039
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.718 Vali Acc: 0.769 Test Loss: 0.718 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.912261962890625
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.632 Vali Acc: 0.769 Test Loss: 0.632 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.094324827194214
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.642 Vali Acc: 0.769 Test Loss: 0.642 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.97392463684082
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.866 Vali Acc: 0.775 Test Loss: 0.866 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.138501405715942
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.855 Test Loss: 0.643 Test Acc: 0.855
Validation loss decreased (-0.838144 --> -0.855485).  Saving model ...
Epoch: 17 cost time: 5.287763833999634
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.792 Test Loss: 0.742 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.299802780151367
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.780 Test Loss: 0.743 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.258793354034424
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.792 Test Loss: 0.761 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.278321981430054
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.786 Test Loss: 0.747 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.904321908950806
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.798 Test Loss: 0.741 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.722366809844971
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.786 Test Loss: 0.752 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.99237585067749
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.786 Test Loss: 0.767 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.009963750839233
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.786 Test Loss: 0.762 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.872065782546997
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.792 Test Loss: 0.758 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.991564512252808
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.792 Test Loss: 0.761 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 100691719
model size : 398.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.919088363647461
Epoch: 1, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.322 Vali Acc: 0.376 Test Loss: 1.322 Test Acc: 0.376
Validation loss decreased (inf --> -0.375709).  Saving model ...
Epoch: 2 cost time: 4.260996103286743
Epoch: 2, Steps: 17 | Train Loss: 1.129 Vali Loss: 0.990 Vali Acc: 0.601 Test Loss: 0.990 Test Acc: 0.601
Validation loss decreased (-0.375709 --> -0.601146).  Saving model ...
Epoch: 3 cost time: 5.573069095611572
Epoch: 3, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.764 Vali Acc: 0.699 Test Loss: 0.764 Test Acc: 0.699
Validation loss decreased (-0.601146 --> -0.699414).  Saving model ...
Epoch: 4 cost time: 5.085233449935913
Epoch: 4, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.667 Vali Acc: 0.728 Test Loss: 0.667 Test Acc: 0.728
Validation loss decreased (-0.699414 --> -0.728317).  Saving model ...
Epoch: 5 cost time: 4.886486053466797
Epoch: 5, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
Validation loss decreased (-0.728317 --> -0.774559).  Saving model ...
Epoch: 6 cost time: 4.848141431808472
Epoch: 6, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.751 Vali Acc: 0.728 Test Loss: 0.751 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.8968517780303955
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.576 Vali Acc: 0.838 Test Loss: 0.576 Test Acc: 0.838
Validation loss decreased (-0.774559 --> -0.838145).  Saving model ...
Epoch: 8 cost time: 5.332822322845459
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.882 Vali Acc: 0.734 Test Loss: 0.882 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.78026008605957
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.868 Vali Acc: 0.786 Test Loss: 0.868 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.064608573913574
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.772 Vali Acc: 0.763 Test Loss: 0.772 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.317150115966797
Epoch: 11, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.562 Vali Acc: 0.798 Test Loss: 0.562 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.916774034500122
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.501 Vali Acc: 0.838 Test Loss: 0.501 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 4.685586452484131
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.509 Vali Acc: 0.832 Test Loss: 0.509 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.733391523361206
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.53464937210083
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849705).  Saving model ...
Epoch: 16 cost time: 5.062180519104004
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.849705 --> -0.861266).  Saving model ...
Epoch: 17 cost time: 4.5697948932647705
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.821 Test Loss: 0.594 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.022682428359985
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.821 Test Loss: 0.604 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.9609973430633545
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.844 Test Loss: 0.566 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.837330341339111
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.676087379455566
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.085533142089844
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.832 Test Loss: 0.603 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.175931215286255
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.237637042999268
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.706739902496338
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.432285785675049
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el5_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 100664071
model size : 398.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.075716018676758
Epoch: 1, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.600 Vali Acc: 0.249 Test Loss: 1.600 Test Acc: 0.249
Validation loss decreased (inf --> -0.248539).  Saving model ...
Epoch: 2 cost time: 2.5033137798309326
Epoch: 2, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.365 Vali Acc: 0.538 Test Loss: 1.365 Test Acc: 0.538
Validation loss decreased (-0.248539 --> -0.537559).  Saving model ...
Epoch: 3 cost time: 2.315833330154419
Epoch: 3, Steps: 17 | Train Loss: 1.011 Vali Loss: 0.991 Vali Acc: 0.607 Test Loss: 0.991 Test Acc: 0.607
Validation loss decreased (-0.537559 --> -0.606927).  Saving model ...
Epoch: 4 cost time: 2.2566773891448975
Epoch: 4, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.922 Vali Acc: 0.676 Test Loss: 0.922 Test Acc: 0.676
Validation loss decreased (-0.606927 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 2.460923671722412
Epoch: 5, Steps: 17 | Train Loss: 0.622 Vali Loss: 1.026 Vali Acc: 0.665 Test Loss: 1.026 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5930747985839844
Epoch: 6, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
Validation loss decreased (-0.676291 --> -0.716754).  Saving model ...
Epoch: 7 cost time: 2.46331524848938
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.592 Vali Acc: 0.798 Test Loss: 0.592 Test Acc: 0.798
Validation loss decreased (-0.716754 --> -0.797682).  Saving model ...
Epoch: 8 cost time: 2.654331684112549
Epoch: 8, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.423 Vali Acc: 0.711 Test Loss: 1.423 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4344444274902344
Epoch: 9, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.850 Vali Acc: 0.798 Test Loss: 0.850 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3796284198760986
Epoch: 10, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.773 Vali Acc: 0.844 Test Loss: 0.773 Test Acc: 0.844
Validation loss decreased (-0.797682 --> -0.843923).  Saving model ...
Epoch: 11 cost time: 2.053199291229248
Epoch: 11, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.457 Vali Acc: 0.694 Test Loss: 1.457 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5406975746154785
Epoch: 12, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.999 Vali Acc: 0.786 Test Loss: 0.999 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5177552700042725
Epoch: 13, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.357 Vali Acc: 0.751 Test Loss: 2.357 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.57118821144104
Epoch: 14, Steps: 17 | Train Loss: 0.156 Vali Loss: 3.018 Vali Acc: 0.676 Test Loss: 3.018 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2562928199768066
Epoch: 15, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.046 Vali Acc: 0.769 Test Loss: 1.046 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.557206153869629
Epoch: 16, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.926 Vali Acc: 0.803 Test Loss: 0.926 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4466052055358887
Epoch: 17, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.437 Vali Acc: 0.763 Test Loss: 1.437 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.502737522125244
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.879 Vali Acc: 0.769 Test Loss: 1.879 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3792598247528076
Epoch: 19, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.023 Vali Acc: 0.751 Test Loss: 3.023 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.437839984893799
Epoch: 20, Steps: 17 | Train Loss: 0.293 Vali Loss: 1.345 Vali Acc: 0.751 Test Loss: 1.345 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 43001095
model size : 178.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7066712379455566
Epoch: 1, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.629 Vali Acc: 0.243 Test Loss: 1.629 Test Acc: 0.243
Validation loss decreased (inf --> -0.242758).  Saving model ...
Epoch: 2 cost time: 2.278571844100952
Epoch: 2, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.760 Vali Acc: 0.312 Test Loss: 1.760 Test Acc: 0.312
Validation loss decreased (-0.242758 --> -0.312121).  Saving model ...
Epoch: 3 cost time: 2.1615543365478516
Epoch: 3, Steps: 17 | Train Loss: 1.014 Vali Loss: 0.906 Vali Acc: 0.636 Test Loss: 0.906 Test Acc: 0.636
Validation loss decreased (-0.312121 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 1.9839894771575928
Epoch: 4, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.721 Vali Acc: 0.676 Test Loss: 0.721 Test Acc: 0.676
Validation loss decreased (-0.635829 --> -0.676293).  Saving model ...
Epoch: 5 cost time: 2.08685040473938
Epoch: 5, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.914 Vali Acc: 0.676 Test Loss: 0.914 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1851418018341064
Epoch: 6, Steps: 17 | Train Loss: 0.260 Vali Loss: 1.139 Vali Acc: 0.671 Test Loss: 1.139 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1324548721313477
Epoch: 7, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.862 Vali Acc: 0.717 Test Loss: 0.862 Test Acc: 0.717
Validation loss decreased (-0.676293 --> -0.716754).  Saving model ...
Epoch: 8 cost time: 1.994802713394165
Epoch: 8, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.779 Vali Acc: 0.763 Test Loss: 0.779 Test Acc: 0.763
Validation loss decreased (-0.716754 --> -0.762998).  Saving model ...
Epoch: 9 cost time: 2.204333543777466
Epoch: 9, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.148 Vali Acc: 0.728 Test Loss: 1.148 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.201186418533325
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.142 Vali Acc: 0.786 Test Loss: 1.142 Test Acc: 0.786
Validation loss decreased (-0.762998 --> -0.786116).  Saving model ...
Epoch: 11 cost time: 2.1538007259368896
Epoch: 11, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.376 Vali Acc: 0.723 Test Loss: 1.376 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9426183700561523
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.859 Vali Acc: 0.832 Test Loss: 0.859 Test Acc: 0.832
Validation loss decreased (-0.786116 --> -0.832361).  Saving model ...
Epoch: 13 cost time: 2.2398407459259033
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.065 Vali Acc: 0.786 Test Loss: 1.065 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.211806058883667
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.115 Vali Acc: 0.792 Test Loss: 1.115 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.289038896560669
Epoch: 15, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.082 Vali Acc: 0.751 Test Loss: 1.082 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9234156608581543
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.213 Vali Acc: 0.751 Test Loss: 1.213 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8664824962615967
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.209 Vali Acc: 0.792 Test Loss: 1.209 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1404271125793457
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.186 Vali Acc: 0.769 Test Loss: 2.186 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.921741247177124
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.053 Vali Acc: 0.821 Test Loss: 1.053 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8276007175445557
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.516 Vali Acc: 0.757 Test Loss: 1.516 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7455472946166992
Epoch: 21, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.306 Vali Acc: 0.815 Test Loss: 1.306 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8241724967956543
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.196 Vali Acc: 0.827 Test Loss: 1.196 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 42842119
model size : 178.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.630817651748657
Epoch: 1, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.609 Vali Acc: 0.306 Test Loss: 1.609 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 2.7798094749450684
Epoch: 2, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.205 Vali Acc: 0.474 Test Loss: 1.205 Test Acc: 0.474
Validation loss decreased (-0.306342 --> -0.473976).  Saving model ...
Epoch: 3 cost time: 2.691524028778076
Epoch: 3, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.038 Vali Acc: 0.590 Test Loss: 1.038 Test Acc: 0.590
Validation loss decreased (-0.473976 --> -0.589585).  Saving model ...
Epoch: 4 cost time: 2.9232404232025146
Epoch: 4, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.935 Vali Acc: 0.595 Test Loss: 0.935 Test Acc: 0.595
Validation loss decreased (-0.589585 --> -0.595366).  Saving model ...
Epoch: 5 cost time: 2.960529088973999
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.878 Vali Acc: 0.751 Test Loss: 0.878 Test Acc: 0.751
Validation loss decreased (-0.595366 --> -0.751436).  Saving model ...
Epoch: 6 cost time: 2.4256420135498047
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5156335830688477
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.754 Vali Acc: 0.723 Test Loss: 0.754 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.539611577987671
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.497 Vali Acc: 0.873 Test Loss: 0.497 Test Acc: 0.873
Validation loss decreased (-0.751436 --> -0.872827).  Saving model ...
Epoch: 9 cost time: 2.852592706680298
Epoch: 9, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.380 Vali Acc: 0.711 Test Loss: 1.380 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3502652645111084
Epoch: 10, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.163494110107422
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.765 Vali Acc: 0.757 Test Loss: 0.765 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0470738410949707
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.171 Vali Acc: 0.734 Test Loss: 1.171 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0087344646453857
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.521 Vali Acc: 0.838 Test Loss: 0.521 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7456932067871094
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.398 Vali Acc: 0.763 Test Loss: 1.398 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.97471022605896
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.345 Vali Acc: 0.728 Test Loss: 1.345 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8911972045898438
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.751 Vali Acc: 0.780 Test Loss: 0.751 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3766238689422607
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.196 Vali Acc: 0.763 Test Loss: 1.196 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5042896270751953
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 42683143
model size : 177.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.979635953903198
Epoch: 1, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.517 Vali Acc: 0.358 Test Loss: 1.517 Test Acc: 0.358
Validation loss decreased (inf --> -0.358366).  Saving model ...
Epoch: 2 cost time: 4.5414369106292725
Epoch: 2, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.047 Vali Acc: 0.636 Test Loss: 1.047 Test Acc: 0.636
Validation loss decreased (-0.358366 --> -0.635828).  Saving model ...
Epoch: 3 cost time: 4.32130765914917
Epoch: 3, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.121 Vali Acc: 0.486 Test Loss: 1.121 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.44023585319519
Epoch: 4, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.776 Vali Acc: 0.699 Test Loss: 0.776 Test Acc: 0.699
Validation loss decreased (-0.635828 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 4.507815837860107
Epoch: 5, Steps: 17 | Train Loss: 0.350 Vali Loss: 1.257 Vali Acc: 0.647 Test Loss: 1.257 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.190206527709961
Epoch: 6, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.726 Vali Acc: 0.792 Test Loss: 0.726 Test Acc: 0.792
Validation loss decreased (-0.699414 --> -0.791900).  Saving model ...
Epoch: 7 cost time: 4.114927530288696
Epoch: 7, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.771 Vali Acc: 0.786 Test Loss: 0.771 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.3957812786102295
Epoch: 8, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.187 Vali Acc: 0.676 Test Loss: 1.187 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.5380024909973145
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.012 Vali Acc: 0.792 Test Loss: 1.012 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.236742258071899
Epoch: 10, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.982 Vali Acc: 0.711 Test Loss: 0.982 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.504532098770142
Epoch: 11, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.944 Vali Acc: 0.821 Test Loss: 0.944 Test Acc: 0.821
Validation loss decreased (-0.791900 --> -0.820800).  Saving model ...
Epoch: 12 cost time: 4.359606027603149
Epoch: 12, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.285 Vali Acc: 0.769 Test Loss: 1.285 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.130116939544678
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.836 Vali Acc: 0.832 Test Loss: 0.836 Test Acc: 0.832
Validation loss decreased (-0.820800 --> -0.832362).  Saving model ...
Epoch: 14 cost time: 4.371179103851318
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.200 Vali Acc: 0.815 Test Loss: 1.200 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.479915618896484
Epoch: 15, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.862 Vali Acc: 0.786 Test Loss: 0.862 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.052124977111816
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.075 Vali Acc: 0.809 Test Loss: 1.075 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.225630044937134
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.542 Vali Acc: 0.798 Test Loss: 2.542 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.243535280227661
Epoch: 18, Steps: 17 | Train Loss: 0.258 Vali Loss: 1.190 Vali Acc: 0.827 Test Loss: 1.190 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.49086856842041
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.237 Vali Acc: 0.775 Test Loss: 1.237 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.330536603927612
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.523 Vali Acc: 0.803 Test Loss: 1.523 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.810824394226074
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.489 Vali Acc: 0.780 Test Loss: 1.489 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.0199058055877686
Epoch: 22, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.710 Vali Acc: 0.798 Test Loss: 1.710 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.355744361877441
Epoch: 23, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.635 Vali Acc: 0.786 Test Loss: 1.635 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 45212935
model size : 187.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.788026809692383
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.628 Vali Acc: 0.324 Test Loss: 1.628 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 3.804860830307007
Epoch: 2, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
Validation loss decreased (-0.323683 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 3.181314706802368
Epoch: 3, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.813 Vali Acc: 0.723 Test Loss: 0.813 Test Acc: 0.723
Validation loss decreased (-0.485537 --> -0.722535).  Saving model ...
Epoch: 4 cost time: 3.503523111343384
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 1.125 Vali Acc: 0.688 Test Loss: 1.125 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7513835430145264
Epoch: 5, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.754 Vali Acc: 0.705 Test Loss: 0.754 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.46942400932312
Epoch: 6, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
Validation loss decreased (-0.722535 --> -0.809243).  Saving model ...
Epoch: 7 cost time: 3.605353593826294
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.906 Vali Acc: 0.757 Test Loss: 0.906 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.556774139404297
Epoch: 8, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.662 Vali Acc: 0.827 Test Loss: 0.662 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826583).  Saving model ...
Epoch: 9 cost time: 3.627528429031372
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.871 Vali Acc: 0.780 Test Loss: 0.871 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4211935997009277
Epoch: 10, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.074 Vali Acc: 0.775 Test Loss: 1.074 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.50644588470459
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.565 Vali Acc: 0.694 Test Loss: 1.565 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.267195701599121
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.129 Vali Acc: 0.803 Test Loss: 1.129 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.449688196182251
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.077 Vali Acc: 0.798 Test Loss: 1.077 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.8380322456359863
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.918 Vali Acc: 0.809 Test Loss: 0.918 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.682961940765381
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.712 Vali Acc: 0.850 Test Loss: 0.712 Test Acc: 0.850
Validation loss decreased (-0.826583 --> -0.849704).  Saving model ...
Epoch: 16 cost time: 3.8819339275360107
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.933 Vali Acc: 0.832 Test Loss: 0.933 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.856826066970825
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.470 Vali Acc: 0.786 Test Loss: 1.470 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.808424949645996
Epoch: 18, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.054 Vali Acc: 0.780 Test Loss: 1.054 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.704230308532715
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.372 Vali Acc: 0.815 Test Loss: 1.372 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.569971799850464
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.531 Vali Acc: 0.763 Test Loss: 1.531 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3992745876312256
Epoch: 21, Steps: 17 | Train Loss: 0.165 Vali Loss: 1.570 Vali Acc: 0.775 Test Loss: 1.570 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.938727855682373
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.094 Vali Acc: 0.798 Test Loss: 1.094 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.7529349327087402
Epoch: 23, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.522 Vali Acc: 0.728 Test Loss: 1.522 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.263800859451294
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.656 Vali Acc: 0.740 Test Loss: 1.656 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4082818031311035
Epoch: 25, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.087 Vali Acc: 0.809 Test Loss: 1.087 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 44977927
model size : 186.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.719988584518433
Epoch: 1, Steps: 17 | Train Loss: 1.853 Vali Loss: 1.576 Vali Acc: 0.353 Test Loss: 1.576 Test Acc: 0.353
Validation loss decreased (inf --> -0.352585).  Saving model ...
Epoch: 2 cost time: 3.506787061691284
Epoch: 2, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.257 Vali Acc: 0.543 Test Loss: 1.257 Test Acc: 0.543
Validation loss decreased (-0.352585 --> -0.543340).  Saving model ...
Epoch: 3 cost time: 3.1393778324127197
Epoch: 3, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.141 Vali Acc: 0.572 Test Loss: 1.141 Test Acc: 0.572
Validation loss decreased (-0.543340 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 2.9989962577819824
Epoch: 4, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.729 Vali Acc: 0.682 Test Loss: 0.729 Test Acc: 0.682
Validation loss decreased (-0.572243 --> -0.682074).  Saving model ...
Epoch: 5 cost time: 3.180837869644165
Epoch: 5, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.920 Vali Acc: 0.688 Test Loss: 0.920 Test Acc: 0.688
Validation loss decreased (-0.682074 --> -0.687852).  Saving model ...
Epoch: 6 cost time: 2.9753150939941406
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.842 Vali Acc: 0.717 Test Loss: 0.842 Test Acc: 0.717
Validation loss decreased (-0.687852 --> -0.716755).  Saving model ...
Epoch: 7 cost time: 3.4922609329223633
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.590 Vali Acc: 0.792 Test Loss: 0.590 Test Acc: 0.792
Validation loss decreased (-0.716755 --> -0.791902).  Saving model ...
Epoch: 8 cost time: 3.4250893592834473
Epoch: 8, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.672 Vali Acc: 0.740 Test Loss: 0.672 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.539360523223877
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.789 Vali Acc: 0.803 Test Loss: 0.789 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803460).  Saving model ...
Epoch: 10 cost time: 3.455951690673828
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.762 Vali Acc: 0.803 Test Loss: 0.762 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803461).  Saving model ...
Epoch: 11 cost time: 3.3480005264282227
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.443 Vali Acc: 0.740 Test Loss: 1.443 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2585694789886475
Epoch: 12, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.696 Vali Acc: 0.809 Test Loss: 0.696 Test Acc: 0.809
Validation loss decreased (-0.803461 --> -0.809242).  Saving model ...
Epoch: 13 cost time: 3.233856678009033
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7727062702178955
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.053 Vali Acc: 0.746 Test Loss: 1.053 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.471282482147217
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.637 Vali Acc: 0.786 Test Loss: 0.637 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.250119209289551
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.602 Vali Acc: 0.827 Test Loss: 0.602 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826584).  Saving model ...
Epoch: 17 cost time: 3.3303287029266357
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.818 Vali Acc: 0.838 Test Loss: 0.818 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838142).  Saving model ...
Epoch: 18 cost time: 2.4484810829162598
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.827 Test Loss: 0.827 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.374404191970825
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.832 Test Loss: 0.855 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1907055377960205
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.832 Test Loss: 0.813 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.363887310028076
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.832 Test Loss: 0.776 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0906214714050293
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.827 Test Loss: 0.766 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.272824287414551
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.844 Test Loss: 0.782 Test Acc: 0.844
Validation loss decreased (-0.838142 --> -0.843923).  Saving model ...
Epoch: 24 cost time: 3.449302911758423
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.815 Test Loss: 0.817 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4804441928863525
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.815 Test Loss: 0.826 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.4769256114959717
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3081090450286865
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.815 Test Loss: 0.844 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.5550360679626465
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.832 Test Loss: 0.837 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.661707639694214
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.827 Test Loss: 0.862 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.210829973220825
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.827 Test Loss: 0.868 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.693624258041382
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.815 Test Loss: 0.861 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.611269950866699
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.815 Test Loss: 0.851 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.804699420928955
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.815 Test Loss: 0.850 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 44874247
model size : 185.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.417533874511719
Epoch: 1, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.546 Vali Acc: 0.254 Test Loss: 1.546 Test Acc: 0.254
Validation loss decreased (inf --> -0.254320).  Saving model ...
Epoch: 2 cost time: 4.582237482070923
Epoch: 2, Steps: 17 | Train Loss: 1.196 Vali Loss: 0.955 Vali Acc: 0.624 Test Loss: 0.955 Test Acc: 0.624
Validation loss decreased (-0.254320 --> -0.624268).  Saving model ...
Epoch: 3 cost time: 4.298037767410278
Epoch: 3, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.996 Vali Acc: 0.601 Test Loss: 0.996 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.188879013061523
Epoch: 4, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.020 Vali Acc: 0.688 Test Loss: 1.020 Test Acc: 0.688
Validation loss decreased (-0.624268 --> -0.687851).  Saving model ...
Epoch: 5 cost time: 4.433792591094971
Epoch: 5, Steps: 17 | Train Loss: 0.534 Vali Loss: 1.340 Vali Acc: 0.653 Test Loss: 1.340 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.180217027664185
Epoch: 6, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.343 Vali Acc: 0.422 Test Loss: 2.343 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.374118804931641
Epoch: 7, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.843 Vali Acc: 0.740 Test Loss: 0.843 Test Acc: 0.740
Validation loss decreased (-0.687851 --> -0.739876).  Saving model ...
Epoch: 8 cost time: 4.7499425411224365
Epoch: 8, Steps: 17 | Train Loss: 0.273 Vali Loss: 1.676 Vali Acc: 0.665 Test Loss: 1.676 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.693523406982422
Epoch: 9, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
Validation loss decreased (-0.739876 --> -0.768777).  Saving model ...
Epoch: 10 cost time: 4.939345359802246
Epoch: 10, Steps: 17 | Train Loss: 0.254 Vali Loss: 2.060 Vali Acc: 0.595 Test Loss: 2.060 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.792147874832153
Epoch: 11, Steps: 17 | Train Loss: 0.327 Vali Loss: 1.168 Vali Acc: 0.717 Test Loss: 1.168 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.950991868972778
Epoch: 12, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.373 Vali Acc: 0.775 Test Loss: 1.373 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774553).  Saving model ...
Epoch: 13 cost time: 4.592095851898193
Epoch: 13, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.638 Vali Acc: 0.757 Test Loss: 1.638 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.703333854675293
Epoch: 14, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.048 Vali Acc: 0.803 Test Loss: 1.048 Test Acc: 0.803
Validation loss decreased (-0.774553 --> -0.803458).  Saving model ...
Epoch: 15 cost time: 4.706558465957642
Epoch: 15, Steps: 17 | Train Loss: 0.220 Vali Loss: 2.252 Vali Acc: 0.728 Test Loss: 2.252 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.393089771270752
Epoch: 16, Steps: 17 | Train Loss: 0.188 Vali Loss: 1.201 Vali Acc: 0.775 Test Loss: 1.201 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.506878137588501
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.080 Vali Acc: 0.775 Test Loss: 1.080 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.28774356842041
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.448 Vali Acc: 0.786 Test Loss: 1.448 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.6513683795928955
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.993 Vali Acc: 0.780 Test Loss: 0.993 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.74713659286499
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.727 Vali Acc: 0.775 Test Loss: 1.727 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.752498626708984
Epoch: 21, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.438 Vali Acc: 0.821 Test Loss: 1.438 Test Acc: 0.821
Validation loss decreased (-0.803458 --> -0.820795).  Saving model ...
Epoch: 22 cost time: 4.6413702964782715
Epoch: 22, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.075 Vali Acc: 0.792 Test Loss: 1.075 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.65559983253479
Epoch: 23, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.366 Vali Acc: 0.769 Test Loss: 1.366 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.923978567123413
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.224 Vali Acc: 0.815 Test Loss: 1.224 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.845972537994385
Epoch: 25, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.817 Vali Acc: 0.844 Test Loss: 0.817 Test Acc: 0.844
Validation loss decreased (-0.820795 --> -0.843922).  Saving model ...
Epoch: 26 cost time: 4.617299318313599
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.106 Vali Acc: 0.832 Test Loss: 1.106 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.534823656082153
Epoch: 27, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.542 Vali Acc: 0.792 Test Loss: 1.542 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.607627630233765
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.561 Vali Acc: 0.792 Test Loss: 1.561 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.769928216934204
Epoch: 29, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.831 Vali Acc: 0.821 Test Loss: 0.831 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.572834730148315
Epoch: 30, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.494 Vali Acc: 0.763 Test Loss: 1.494 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.1658666133880615
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.483 Vali Acc: 0.809 Test Loss: 1.483 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 5.0068159103393555
Epoch: 32, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.348 Vali Acc: 0.838 Test Loss: 1.348 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.045395851135254
Epoch: 33, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.045 Vali Acc: 0.757 Test Loss: 2.045 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.907592535018921
Epoch: 34, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.875 Vali Acc: 0.751 Test Loss: 1.875 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.247618198394775
Epoch: 35, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.217 Vali Acc: 0.809 Test Loss: 2.217 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 47431687
model size : 195.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.8260040283203125
Epoch: 1, Steps: 17 | Train Loss: 1.858 Vali Loss: 1.436 Vali Acc: 0.457 Test Loss: 1.436 Test Acc: 0.457
Validation loss decreased (inf --> -0.456633).  Saving model ...
Epoch: 2 cost time: 4.168076753616333
Epoch: 2, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.429 Vali Acc: 0.451 Test Loss: 1.429 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3636345863342285
Epoch: 3, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.082 Vali Acc: 0.566 Test Loss: 1.082 Test Acc: 0.566
Validation loss decreased (-0.456633 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 3.770587682723999
Epoch: 4, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.962 Vali Acc: 0.572 Test Loss: 0.962 Test Acc: 0.572
Validation loss decreased (-0.566463 --> -0.572245).  Saving model ...
Epoch: 5 cost time: 3.6849682331085205
Epoch: 5, Steps: 17 | Train Loss: 0.545 Vali Loss: 1.077 Vali Acc: 0.653 Test Loss: 1.077 Test Acc: 0.653
Validation loss decreased (-0.572245 --> -0.653168).  Saving model ...
Epoch: 6 cost time: 4.09221887588501
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.849 Vali Acc: 0.746 Test Loss: 0.849 Test Acc: 0.746
Validation loss decreased (-0.653168 --> -0.745656).  Saving model ...
Epoch: 7 cost time: 3.669551372528076
Epoch: 7, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.777 Vali Acc: 0.757 Test Loss: 0.777 Test Acc: 0.757
Validation loss decreased (-0.745656 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 3.5665318965911865
Epoch: 8, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.503 Vali Acc: 0.815 Test Loss: 0.503 Test Acc: 0.815
Validation loss decreased (-0.757218 --> -0.815024).  Saving model ...
Epoch: 9 cost time: 3.7466888427734375
Epoch: 9, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.014 Vali Acc: 0.688 Test Loss: 1.014 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.966064214706421
Epoch: 10, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.414 Vali Acc: 0.734 Test Loss: 1.414 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8800787925720215
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.158 Vali Acc: 0.728 Test Loss: 1.158 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.437756299972534
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.946 Vali Acc: 0.798 Test Loss: 0.946 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.8341829776763916
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.646 Vali Acc: 0.815 Test Loss: 0.646 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.8263139724731445
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.687 Vali Acc: 0.821 Test Loss: 0.687 Test Acc: 0.821
Validation loss decreased (-0.815024 --> -0.820802).  Saving model ...
Epoch: 15 cost time: 4.000978231430054
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.905 Vali Acc: 0.780 Test Loss: 0.905 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9640984535217285
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.471 Vali Acc: 0.746 Test Loss: 1.471 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.821431875228882
Epoch: 17, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.298 Vali Acc: 0.769 Test Loss: 1.298 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.874581813812256
Epoch: 18, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.807 Vali Acc: 0.844 Test Loss: 0.807 Test Acc: 0.844
Validation loss decreased (-0.820802 --> -0.843923).  Saving model ...
Epoch: 19 cost time: 3.443613290786743
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.223 Vali Acc: 0.786 Test Loss: 1.223 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.518549680709839
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.016 Vali Acc: 0.821 Test Loss: 1.016 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5283873081207275
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.709 Vali Acc: 0.838 Test Loss: 0.709 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3741910457611084
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.769 Test Loss: 1.199 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.093994379043579
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.206 Vali Acc: 0.803 Test Loss: 1.206 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.7373533248901367
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.430 Vali Acc: 0.809 Test Loss: 1.430 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.79455304145813
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.092 Vali Acc: 0.815 Test Loss: 1.092 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8345720767974854
Epoch: 26, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.746 Vali Acc: 0.821 Test Loss: 0.746 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.042335748672485
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.065 Vali Acc: 0.821 Test Loss: 1.065 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.052888870239258
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.129 Vali Acc: 0.803 Test Loss: 1.129 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 47196679
model size : 194.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.574497222900391
Epoch: 1, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.526 Vali Acc: 0.416 Test Loss: 1.526 Test Acc: 0.416
Validation loss decreased (inf --> -0.416170).  Saving model ...
Epoch: 2 cost time: 3.461322784423828
Epoch: 2, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.237 Vali Acc: 0.480 Test Loss: 1.237 Test Acc: 0.480
Validation loss decreased (-0.416170 --> -0.479756).  Saving model ...
Epoch: 3 cost time: 3.6051440238952637
Epoch: 3, Steps: 17 | Train Loss: 1.063 Vali Loss: 0.939 Vali Acc: 0.682 Test Loss: 0.939 Test Acc: 0.682
Validation loss decreased (-0.479756 --> -0.682072).  Saving model ...
Epoch: 4 cost time: 4.2910919189453125
Epoch: 4, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.721 Vali Acc: 0.699 Test Loss: 0.721 Test Acc: 0.699
Validation loss decreased (-0.682072 --> -0.699415).  Saving model ...
Epoch: 5 cost time: 3.7851510047912598
Epoch: 5, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.749 Vali Acc: 0.734 Test Loss: 0.749 Test Acc: 0.734
Validation loss decreased (-0.699415 --> -0.734097).  Saving model ...
Epoch: 6 cost time: 3.8859925270080566
Epoch: 6, Steps: 17 | Train Loss: 0.329 Vali Loss: 1.035 Vali Acc: 0.671 Test Loss: 1.035 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.975769281387329
Epoch: 7, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.607 Vali Acc: 0.751 Test Loss: 0.607 Test Acc: 0.751
Validation loss decreased (-0.734097 --> -0.751439).  Saving model ...
Epoch: 8 cost time: 4.07478666305542
Epoch: 8, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
Validation loss decreased (-0.751439 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 4.0671045780181885
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.022 Vali Acc: 0.711 Test Loss: 1.022 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6518940925598145
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809244).  Saving model ...
Epoch: 11 cost time: 3.9716994762420654
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.681 Vali Acc: 0.827 Test Loss: 0.681 Test Acc: 0.827
Validation loss decreased (-0.809244 --> -0.826583).  Saving model ...
Epoch: 12 cost time: 4.060362100601196
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.919 Vali Acc: 0.757 Test Loss: 0.919 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.011117219924927
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.543 Vali Acc: 0.844 Test Loss: 0.543 Test Acc: 0.844
Validation loss decreased (-0.826583 --> -0.843925).  Saving model ...
Epoch: 14 cost time: 3.6640727519989014
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.726 Vali Acc: 0.821 Test Loss: 0.726 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.595818281173706
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.808 Vali Acc: 0.769 Test Loss: 0.808 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3794729709625244
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.745 Vali Acc: 0.798 Test Loss: 0.745 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.526871919631958
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.087 Vali Acc: 0.786 Test Loss: 1.087 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.83821177482605
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.199 Vali Acc: 0.728 Test Loss: 1.199 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9210731983184814
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.906 Vali Acc: 0.786 Test Loss: 0.906 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.8164241313934326
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.9074480533599854
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.809 Vali Acc: 0.757 Test Loss: 0.809 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8914566040039062
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.726 Vali Acc: 0.769 Test Loss: 0.726 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.846348524093628
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.990 Vali Acc: 0.769 Test Loss: 0.990 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 47079175
model size : 194.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.285037517547607
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.575 Vali Acc: 0.301 Test Loss: 1.575 Test Acc: 0.301
Validation loss decreased (inf --> -0.300562).  Saving model ...
Epoch: 2 cost time: 4.182895183563232
Epoch: 2, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.234 Vali Acc: 0.462 Test Loss: 1.234 Test Acc: 0.462
Validation loss decreased (-0.300562 --> -0.462415).  Saving model ...
Epoch: 3 cost time: 3.472999334335327
Epoch: 3, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.955 Vali Acc: 0.642 Test Loss: 0.955 Test Acc: 0.642
Validation loss decreased (-0.462415 --> -0.641609).  Saving model ...
Epoch: 4 cost time: 3.5133659839630127
Epoch: 4, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.923 Vali Acc: 0.624 Test Loss: 0.923 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.440159797668457
Epoch: 5, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.712 Vali Acc: 0.728 Test Loss: 0.712 Test Acc: 0.728
Validation loss decreased (-0.641609 --> -0.728317).  Saving model ...
Epoch: 6 cost time: 4.060867071151733
Epoch: 6, Steps: 17 | Train Loss: 0.386 Vali Loss: 1.184 Vali Acc: 0.676 Test Loss: 1.184 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.162134408950806
Epoch: 7, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.900 Vali Acc: 0.711 Test Loss: 0.900 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.337326526641846
Epoch: 8, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.610 Vali Acc: 0.769 Test Loss: 0.610 Test Acc: 0.769
Validation loss decreased (-0.728317 --> -0.768780).  Saving model ...
Epoch: 9 cost time: 4.491522312164307
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.047 Vali Acc: 0.763 Test Loss: 1.047 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.184225082397461
Epoch: 10, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.653 Vali Acc: 0.855 Test Loss: 0.653 Test Acc: 0.855
Validation loss decreased (-0.768780 --> -0.855485).  Saving model ...
Epoch: 11 cost time: 3.8507864475250244
Epoch: 11, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.542 Vali Acc: 0.682 Test Loss: 1.542 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.983123302459717
Epoch: 12, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.25572657585144
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.460 Vali Acc: 0.775 Test Loss: 1.460 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.211394786834717
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.766 Vali Acc: 0.792 Test Loss: 0.766 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.05760931968689
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.707 Vali Acc: 0.728 Test Loss: 1.707 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.074084997177124
Epoch: 16, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.262 Vali Acc: 0.723 Test Loss: 1.262 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.236410617828369
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.033 Vali Acc: 0.821 Test Loss: 1.033 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.30612850189209
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.012 Vali Acc: 0.838 Test Loss: 1.012 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.359841346740723
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.396 Vali Acc: 0.792 Test Loss: 1.396 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.577600717544556
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.556 Vali Acc: 0.728 Test Loss: 1.556 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 49491463
model size : 203.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.363339900970459
Epoch: 1, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.500 Vali Acc: 0.260 Test Loss: 1.500 Test Acc: 0.260
Validation loss decreased (inf --> -0.260101).  Saving model ...
Epoch: 2 cost time: 3.9621543884277344
Epoch: 2, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.012 Vali Acc: 0.590 Test Loss: 1.012 Test Acc: 0.590
Validation loss decreased (-0.260101 --> -0.589585).  Saving model ...
Epoch: 3 cost time: 4.345416784286499
Epoch: 3, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.799 Vali Acc: 0.705 Test Loss: 0.799 Test Acc: 0.705
Validation loss decreased (-0.589585 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 4.308242559432983
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.950 Vali Acc: 0.636 Test Loss: 0.950 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.282958269119263
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
Validation loss decreased (-0.705194 --> -0.774558).  Saving model ...
Epoch: 6 cost time: 4.296834707260132
Epoch: 6, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.857 Vali Acc: 0.780 Test Loss: 0.857 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780338).  Saving model ...
Epoch: 7 cost time: 4.136649131774902
Epoch: 7, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.525 Vali Acc: 0.821 Test Loss: 0.525 Test Acc: 0.821
Validation loss decreased (-0.780338 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 4.030663728713989
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.898 Vali Acc: 0.792 Test Loss: 0.898 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.65411376953125
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.041 Vali Acc: 0.780 Test Loss: 1.041 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8969688415527344
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.640 Vali Acc: 0.740 Test Loss: 1.640 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.672588348388672
Epoch: 11, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.174 Vali Acc: 0.786 Test Loss: 1.174 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9757447242736816
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.324 Vali Acc: 0.751 Test Loss: 1.324 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.83276104927063
Epoch: 13, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.862 Vali Acc: 0.809 Test Loss: 0.862 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.118335723876953
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.713 Vali Acc: 0.838 Test Loss: 0.713 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838143).  Saving model ...
Epoch: 15 cost time: 4.19846248626709
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.864 Vali Acc: 0.809 Test Loss: 0.864 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.225455284118652
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.339 Vali Acc: 0.740 Test Loss: 1.339 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8738508224487305
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.950 Vali Acc: 0.803 Test Loss: 0.950 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.0090062618255615
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.376 Vali Acc: 0.746 Test Loss: 1.376 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.917635202407837
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.876 Vali Acc: 0.769 Test Loss: 0.876 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.252662420272827
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.246 Vali Acc: 0.803 Test Loss: 1.246 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.819408416748047
Epoch: 21, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.867 Vali Acc: 0.827 Test Loss: 0.867 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.082643032073975
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.962 Vali Acc: 0.850 Test Loss: 0.962 Test Acc: 0.850
Validation loss decreased (-0.838143 --> -0.849701).  Saving model ...
Epoch: 23 cost time: 3.7307627201080322
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.013 Vali Acc: 0.792 Test Loss: 1.013 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9371159076690674
Epoch: 24, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.790 Vali Acc: 0.711 Test Loss: 1.790 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7788400650024414
Epoch: 25, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.563 Vali Acc: 0.803 Test Loss: 1.563 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.8735158443450928
Epoch: 26, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.481 Vali Acc: 0.803 Test Loss: 1.481 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.212805271148682
Epoch: 27, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.506 Vali Acc: 0.827 Test Loss: 1.506 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.102591276168823
Epoch: 28, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.623 Vali Acc: 0.734 Test Loss: 1.623 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.747324228286743
Epoch: 29, Steps: 17 | Train Loss: 0.062 Vali Loss: 2.925 Vali Acc: 0.751 Test Loss: 2.925 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.119060277938843
Epoch: 30, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.630 Vali Acc: 0.775 Test Loss: 1.630 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.971343517303467
Epoch: 31, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.714 Vali Acc: 0.786 Test Loss: 1.714 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.212109088897705
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.301 Vali Acc: 0.815 Test Loss: 1.301 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 49367047
model size : 202.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.164093017578125
Epoch: 1, Steps: 17 | Train Loss: 1.815 Vali Loss: 1.500 Vali Acc: 0.283 Test Loss: 1.500 Test Acc: 0.283
Validation loss decreased (inf --> -0.283222).  Saving model ...
Epoch: 2 cost time: 3.697578191757202
Epoch: 2, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.221 Vali Acc: 0.497 Test Loss: 1.221 Test Acc: 0.497
Validation loss decreased (-0.283222 --> -0.497098).  Saving model ...
Epoch: 3 cost time: 3.944654703140259
Epoch: 3, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.806 Vali Acc: 0.659 Test Loss: 0.806 Test Acc: 0.659
Validation loss decreased (-0.497098 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 4.072737455368042
Epoch: 4, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.667 Vali Acc: 0.734 Test Loss: 0.667 Test Acc: 0.734
Validation loss decreased (-0.658951 --> -0.734097).  Saving model ...
Epoch: 5 cost time: 4.159538984298706
Epoch: 5, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.670 Vali Acc: 0.728 Test Loss: 0.670 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.2431254386901855
Epoch: 6, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.740 Vali Acc: 0.769 Test Loss: 0.740 Test Acc: 0.769
Validation loss decreased (-0.734097 --> -0.768779).  Saving model ...
Epoch: 7 cost time: 4.226355314254761
Epoch: 7, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.790 Vali Acc: 0.723 Test Loss: 0.790 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8923122882843018
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.886 Vali Acc: 0.798 Test Loss: 0.886 Test Acc: 0.798
Validation loss decreased (-0.768779 --> -0.797679).  Saving model ...
Epoch: 9 cost time: 3.5296077728271484
Epoch: 9, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.214 Vali Acc: 0.734 Test Loss: 1.214 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5910651683807373
Epoch: 10, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.236 Vali Acc: 0.699 Test Loss: 1.236 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.661905288696289
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.975 Vali Acc: 0.751 Test Loss: 0.975 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.245755195617676
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.794 Vali Acc: 0.786 Test Loss: 0.794 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.274246454238892
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.810 Vali Acc: 0.809 Test Loss: 0.810 Test Acc: 0.809
Validation loss decreased (-0.797679 --> -0.809240).  Saving model ...
Epoch: 14 cost time: 3.876504898071289
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.755 Vali Acc: 0.815 Test Loss: 0.755 Test Acc: 0.815
Validation loss decreased (-0.809240 --> -0.815021).  Saving model ...
Epoch: 15 cost time: 3.6547839641571045
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.734 Vali Acc: 0.827 Test Loss: 0.734 Test Acc: 0.827
Validation loss decreased (-0.815021 --> -0.826582).  Saving model ...
Epoch: 16 cost time: 3.3472237586975098
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.342 Vali Acc: 0.723 Test Loss: 1.342 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.296969413757324
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.758 Vali Acc: 0.809 Test Loss: 0.758 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.222383260726929
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.122 Vali Acc: 0.717 Test Loss: 1.122 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9989125728607178
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.008 Vali Acc: 0.780 Test Loss: 1.008 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.024651527404785
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.991 Vali Acc: 0.757 Test Loss: 0.991 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.12286901473999
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.786 Test Loss: 0.927 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.828134536743164
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.055 Vali Acc: 0.763 Test Loss: 1.055 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.695288896560669
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.924 Vali Acc: 0.763 Test Loss: 0.924 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.6580917835235596
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.805 Vali Acc: 0.798 Test Loss: 0.805 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7183310985565186
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.844 Vali Acc: 0.792 Test Loss: 0.844 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 49284103
model size : 202.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.358772277832031
Epoch: 1, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.455 Vali Acc: 0.382 Test Loss: 1.455 Test Acc: 0.382
Validation loss decreased (inf --> -0.381488).  Saving model ...
Epoch: 2 cost time: 4.215814113616943
Epoch: 2, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.347 Vali Acc: 0.434 Test Loss: 1.347 Test Acc: 0.434
Validation loss decreased (-0.381488 --> -0.433513).  Saving model ...
Epoch: 3 cost time: 4.081845760345459
Epoch: 3, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.989 Vali Acc: 0.647 Test Loss: 0.989 Test Acc: 0.647
Validation loss decreased (-0.433513 --> -0.647389).  Saving model ...
Epoch: 4 cost time: 4.342785120010376
Epoch: 4, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.875 Vali Acc: 0.694 Test Loss: 0.875 Test Acc: 0.694
Validation loss decreased (-0.647389 --> -0.693633).  Saving model ...
Epoch: 5 cost time: 3.917780876159668
Epoch: 5, Steps: 17 | Train Loss: 0.555 Vali Loss: 1.102 Vali Acc: 0.590 Test Loss: 1.102 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.259635925292969
Epoch: 6, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.897 Vali Acc: 0.717 Test Loss: 0.897 Test Acc: 0.717
Validation loss decreased (-0.693633 --> -0.716754).  Saving model ...
Epoch: 7 cost time: 4.380131244659424
Epoch: 7, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.639 Vali Acc: 0.780 Test Loss: 0.639 Test Acc: 0.780
Validation loss decreased (-0.716754 --> -0.780340).  Saving model ...
Epoch: 8 cost time: 4.109606981277466
Epoch: 8, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.889 Vali Acc: 0.798 Test Loss: 0.889 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797679).  Saving model ...
Epoch: 9 cost time: 4.2294533252716064
Epoch: 9, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.519 Vali Acc: 0.642 Test Loss: 1.519 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.022846937179565
Epoch: 10, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.120 Vali Acc: 0.711 Test Loss: 1.120 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.032780647277832
Epoch: 11, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.841 Vali Acc: 0.734 Test Loss: 0.841 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.367342233657837
Epoch: 12, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.433 Vali Acc: 0.705 Test Loss: 1.433 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.625516891479492
Epoch: 13, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.300 Vali Acc: 0.769 Test Loss: 1.300 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.640055418014526
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.892 Vali Acc: 0.832 Test Loss: 0.892 Test Acc: 0.832
Validation loss decreased (-0.797679 --> -0.832361).  Saving model ...
Epoch: 15 cost time: 4.213437795639038
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.975 Vali Acc: 0.832 Test Loss: 0.975 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7644472122192383
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.844 Vali Acc: 0.798 Test Loss: 0.844 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.032926082611084
Epoch: 17, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.732 Vali Acc: 0.815 Test Loss: 0.732 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.224074363708496
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.849 Vali Acc: 0.832 Test Loss: 0.849 Test Acc: 0.832
Validation loss decreased (-0.832361 --> -0.832361).  Saving model ...
Epoch: 19 cost time: 4.530507802963257
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.422 Vali Acc: 0.769 Test Loss: 2.422 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.103459119796753
Epoch: 20, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.257 Vali Acc: 0.775 Test Loss: 1.257 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9855518341064453
Epoch: 21, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.270 Vali Acc: 0.803 Test Loss: 1.270 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.482312202453613
Epoch: 22, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.881 Vali Acc: 0.734 Test Loss: 1.881 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.480080604553223
Epoch: 23, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.773 Vali Acc: 0.775 Test Loss: 1.773 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.582379102706909
Epoch: 24, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.691 Vali Acc: 0.775 Test Loss: 1.691 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.469714879989624
Epoch: 25, Steps: 17 | Train Loss: 0.123 Vali Loss: 2.423 Vali Acc: 0.734 Test Loss: 2.423 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.342268466949463
Epoch: 26, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.283 Vali Acc: 0.769 Test Loss: 1.283 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.135019540786743
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.936 Vali Acc: 0.821 Test Loss: 0.936 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.209937572479248
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.225 Vali Acc: 0.815 Test Loss: 1.225 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 51703303
model size : 211.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.336446762084961
Epoch: 1, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.508 Vali Acc: 0.549 Test Loss: 1.508 Test Acc: 0.549
Validation loss decreased (inf --> -0.549118).  Saving model ...
Epoch: 2 cost time: 3.752983808517456
Epoch: 2, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.171 Vali Acc: 0.497 Test Loss: 1.171 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5871224403381348
Epoch: 3, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.229 Vali Acc: 0.526 Test Loss: 1.229 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9441940784454346
Epoch: 4, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.886 Vali Acc: 0.630 Test Loss: 0.886 Test Acc: 0.630
Validation loss decreased (-0.549118 --> -0.630049).  Saving model ...
Epoch: 5 cost time: 4.2040135860443115
Epoch: 5, Steps: 17 | Train Loss: 0.602 Vali Loss: 1.086 Vali Acc: 0.601 Test Loss: 1.086 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.953155994415283
Epoch: 6, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.913 Vali Acc: 0.711 Test Loss: 0.913 Test Acc: 0.711
Validation loss decreased (-0.630049 --> -0.710974).  Saving model ...
Epoch: 7 cost time: 3.7954957485198975
Epoch: 7, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.834 Vali Acc: 0.682 Test Loss: 0.834 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.876098394393921
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.743 Vali Acc: 0.798 Test Loss: 0.743 Test Acc: 0.798
Validation loss decreased (-0.710974 --> -0.797680).  Saving model ...
Epoch: 9 cost time: 4.209859371185303
Epoch: 9, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.283 Vali Acc: 0.688 Test Loss: 1.283 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.240142107009888
Epoch: 10, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.702 Vali Acc: 0.798 Test Loss: 0.702 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797681).  Saving model ...
Epoch: 11 cost time: 4.259393692016602
Epoch: 11, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.126 Vali Acc: 0.803 Test Loss: 1.126 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803457).  Saving model ...
Epoch: 12 cost time: 3.7372281551361084
Epoch: 12, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.907 Vali Acc: 0.746 Test Loss: 0.907 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.683581829071045
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.0440590381622314
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.070 Vali Acc: 0.780 Test Loss: 1.070 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.211144685745239
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.238 Vali Acc: 0.775 Test Loss: 1.238 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.334792613983154
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.844 Vali Acc: 0.803 Test Loss: 0.844 Test Acc: 0.803
Validation loss decreased (-0.803457 --> -0.803460).  Saving model ...
Epoch: 17 cost time: 4.002540826797485
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.842 Vali Acc: 0.780 Test Loss: 0.842 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.091445684432983
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.450 Vali Acc: 0.734 Test Loss: 1.450 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.181641578674316
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.372 Vali Acc: 0.792 Test Loss: 1.372 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.264124631881714
Epoch: 20, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.869 Vali Acc: 0.821 Test Loss: 0.869 Test Acc: 0.821
Validation loss decreased (-0.803460 --> -0.820801).  Saving model ...
Epoch: 21 cost time: 3.9636144638061523
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.786 Vali Acc: 0.827 Test Loss: 0.786 Test Acc: 0.827
Validation loss decreased (-0.820801 --> -0.826582).  Saving model ...
Epoch: 22 cost time: 3.7690131664276123
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.952 Vali Acc: 0.867 Test Loss: 0.952 Test Acc: 0.867
Validation loss decreased (-0.826582 --> -0.867043).  Saving model ...
Epoch: 23 cost time: 3.8585922718048096
Epoch: 23, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.243 Vali Acc: 0.798 Test Loss: 1.243 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.242185115814209
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.922 Vali Acc: 0.821 Test Loss: 0.922 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8923628330230713
Epoch: 25, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.053 Vali Acc: 0.821 Test Loss: 1.053 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9696297645568848
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.058 Vali Acc: 0.821 Test Loss: 1.058 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.5942304134368896
Epoch: 27, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.418 Vali Acc: 0.775 Test Loss: 1.418 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.959897756576538
Epoch: 28, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.525 Vali Acc: 0.809 Test Loss: 1.525 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.1023993492126465
Epoch: 29, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.560 Vali Acc: 0.757 Test Loss: 1.560 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.250566244125366
Epoch: 30, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.158 Vali Acc: 0.780 Test Loss: 1.158 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.283984899520874
Epoch: 31, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.369 Vali Acc: 0.775 Test Loss: 1.369 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.189500093460083
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.310 Vali Acc: 0.803 Test Loss: 1.310 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 51578887
model size : 211.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.057002067565918
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.550 Vali Acc: 0.370 Test Loss: 1.550 Test Acc: 0.370
Validation loss decreased (inf --> -0.369927).  Saving model ...
Epoch: 2 cost time: 3.8880345821380615
Epoch: 2, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.285 Vali Acc: 0.428 Test Loss: 1.285 Test Acc: 0.428
Validation loss decreased (-0.369927 --> -0.427733).  Saving model ...
Epoch: 3 cost time: 4.166881799697876
Epoch: 3, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.005 Vali Acc: 0.526 Test Loss: 1.005 Test Acc: 0.526
Validation loss decreased (-0.427733 --> -0.526002).  Saving model ...
Epoch: 4 cost time: 3.6681556701660156
Epoch: 4, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.965 Vali Acc: 0.665 Test Loss: 0.965 Test Acc: 0.665
Validation loss decreased (-0.526002 --> -0.664730).  Saving model ...
Epoch: 5 cost time: 3.8878347873687744
Epoch: 5, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.838 Vali Acc: 0.676 Test Loss: 0.838 Test Acc: 0.676
Validation loss decreased (-0.664730 --> -0.676292).  Saving model ...
Epoch: 6 cost time: 3.6693267822265625
Epoch: 6, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.808 Vali Acc: 0.642 Test Loss: 0.808 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.444042205810547
Epoch: 7, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.883 Vali Acc: 0.699 Test Loss: 0.883 Test Acc: 0.699
Validation loss decreased (-0.676292 --> -0.699413).  Saving model ...
Epoch: 8 cost time: 3.6004929542541504
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
Validation loss decreased (-0.699413 --> -0.757218).  Saving model ...
Epoch: 9 cost time: 3.826373815536499
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.755 Vali Acc: 0.746 Test Loss: 0.755 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.121043920516968
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.937 Vali Acc: 0.740 Test Loss: 0.937 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.762854814529419
Epoch: 11, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.264 Vali Acc: 0.717 Test Loss: 1.264 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8901054859161377
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
Validation loss decreased (-0.757218 --> -0.884388).  Saving model ...
Epoch: 13 cost time: 3.7699522972106934
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.581 Vali Acc: 0.838 Test Loss: 0.581 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8012382984161377
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.786 Vali Acc: 0.775 Test Loss: 0.786 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.393017292022705
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.774 Vali Acc: 0.798 Test Loss: 0.774 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.551511287689209
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.677 Vali Acc: 0.821 Test Loss: 0.677 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7684309482574463
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.850 Test Loss: 0.585 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.813506841659546
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.821 Test Loss: 0.618 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.741988182067871
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.821 Test Loss: 0.667 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.5389702320098877
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.809 Test Loss: 0.738 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.6831817626953125
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.832 Test Loss: 0.694 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.641723871231079
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 51489031
model size : 211.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.989480257034302
Epoch: 1, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.525 Vali Acc: 0.387 Test Loss: 1.525 Test Acc: 0.387
Validation loss decreased (inf --> -0.387268).  Saving model ...
Epoch: 2 cost time: 3.887944459915161
Epoch: 2, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.241 Vali Acc: 0.520 Test Loss: 1.241 Test Acc: 0.520
Validation loss decreased (-0.387268 --> -0.520219).  Saving model ...
Epoch: 3 cost time: 4.13642954826355
Epoch: 3, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.946 Vali Acc: 0.618 Test Loss: 0.946 Test Acc: 0.618
Validation loss decreased (-0.520219 --> -0.618488).  Saving model ...
Epoch: 4 cost time: 4.442173480987549
Epoch: 4, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.972 Vali Acc: 0.642 Test Loss: 0.972 Test Acc: 0.642
Validation loss decreased (-0.618488 --> -0.641609).  Saving model ...
Epoch: 5 cost time: 4.255483388900757
Epoch: 5, Steps: 17 | Train Loss: 0.460 Vali Loss: 1.404 Vali Acc: 0.584 Test Loss: 1.404 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9737629890441895
Epoch: 6, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.782 Vali Acc: 0.746 Test Loss: 0.782 Test Acc: 0.746
Validation loss decreased (-0.641609 --> -0.745657).  Saving model ...
Epoch: 7 cost time: 4.214848518371582
Epoch: 7, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.645 Vali Acc: 0.786 Test Loss: 0.645 Test Acc: 0.786
Validation loss decreased (-0.745657 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 4.07595157623291
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.989 Vali Acc: 0.763 Test Loss: 0.989 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.141552448272705
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803461).  Saving model ...
Epoch: 10 cost time: 4.382644891738892
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.983 Vali Acc: 0.780 Test Loss: 0.983 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.463465213775635
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.676 Vali Acc: 0.844 Test Loss: 0.676 Test Acc: 0.844
Validation loss decreased (-0.803461 --> -0.843924).  Saving model ...
Epoch: 12 cost time: 4.343764066696167
Epoch: 12, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.996 Vali Acc: 0.688 Test Loss: 1.996 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.504118204116821
Epoch: 13, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.562 Vali Acc: 0.821 Test Loss: 0.562 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.501194953918457
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.913 Vali Acc: 0.815 Test Loss: 0.913 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.540464878082275
Epoch: 15, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.314 Vali Acc: 0.740 Test Loss: 1.314 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.332201719284058
Epoch: 16, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.259 Vali Acc: 0.821 Test Loss: 1.259 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6720447540283203
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.536 Vali Acc: 0.769 Test Loss: 1.536 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.8100650310516357
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.383 Vali Acc: 0.769 Test Loss: 1.383 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.7380545139312744
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.353 Vali Acc: 0.786 Test Loss: 1.353 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.142211437225342
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.809 Test Loss: 1.011 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.219787836074829
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.895 Vali Acc: 0.838 Test Loss: 0.895 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 53922055
model size : 220.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.218362808227539
Epoch: 1, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.485 Vali Acc: 0.312 Test Loss: 1.485 Test Acc: 0.312
Validation loss decreased (inf --> -0.312124).  Saving model ...
Epoch: 2 cost time: 3.6301779747009277
Epoch: 2, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
Validation loss decreased (-0.312124 --> -0.514440).  Saving model ...
Epoch: 3 cost time: 3.96059250831604
Epoch: 3, Steps: 17 | Train Loss: 0.899 Vali Loss: 0.881 Vali Acc: 0.653 Test Loss: 0.881 Test Acc: 0.653
Validation loss decreased (-0.514440 --> -0.653170).  Saving model ...
Epoch: 4 cost time: 3.976860523223877
Epoch: 4, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.894 Vali Acc: 0.636 Test Loss: 0.894 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9790947437286377
Epoch: 5, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.970 Vali Acc: 0.659 Test Loss: 0.970 Test Acc: 0.659
Validation loss decreased (-0.653170 --> -0.658950).  Saving model ...
Epoch: 6 cost time: 3.62416672706604
Epoch: 6, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.631 Vali Acc: 0.786 Test Loss: 0.631 Test Acc: 0.786
Validation loss decreased (-0.658950 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 4.097158432006836
Epoch: 7, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.773 Vali Acc: 0.705 Test Loss: 0.773 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.081273078918457
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.594 Vali Acc: 0.792 Test Loss: 0.594 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 9 cost time: 4.000810384750366
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
Validation loss decreased (-0.791902 --> -0.809242).  Saving model ...
Epoch: 10 cost time: 3.99885892868042
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.03549861907959
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.134 Vali Acc: 0.740 Test Loss: 1.134 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.180032253265381
Epoch: 12, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.010 Vali Acc: 0.763 Test Loss: 1.010 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6222052574157715
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.884 Vali Acc: 0.792 Test Loss: 0.884 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.525705337524414
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.146 Vali Acc: 0.821 Test Loss: 1.146 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820798).  Saving model ...
Epoch: 15 cost time: 4.065111875534058
Epoch: 15, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.155 Vali Acc: 0.815 Test Loss: 1.155 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.31168270111084
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.932 Vali Acc: 0.815 Test Loss: 0.932 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8327977657318115
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.046 Vali Acc: 0.821 Test Loss: 1.046 Test Acc: 0.821
Validation loss decreased (-0.820798 --> -0.820799).  Saving model ...
Epoch: 18 cost time: 4.1094701290130615
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.989 Vali Acc: 0.827 Test Loss: 0.989 Test Acc: 0.827
Validation loss decreased (-0.820799 --> -0.826580).  Saving model ...
Epoch: 19 cost time: 3.986125946044922
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.922 Vali Acc: 0.844 Test Loss: 0.922 Test Acc: 0.844
Validation loss decreased (-0.826580 --> -0.843921).  Saving model ...
Epoch: 20 cost time: 4.311925888061523
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.837 Vali Acc: 0.815 Test Loss: 0.837 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9113776683807373
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.815 Test Loss: 0.945 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.733102321624756
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.832 Test Loss: 0.802 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.6645548343658447
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.838 Test Loss: 0.834 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.8958141803741455
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.821 Test Loss: 0.864 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.06022310256958
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.827 Test Loss: 0.879 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.305248975753784
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.844 Test Loss: 0.892 Test Acc: 0.844
Validation loss decreased (-0.843921 --> -0.843922).  Saving model ...
Epoch: 27 cost time: 4.125849723815918
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.838 Test Loss: 0.898 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.908043622970581
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.832 Test Loss: 0.903 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7098934650421143
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.838 Test Loss: 0.910 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.282921075820923
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.832 Test Loss: 0.912 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.7475767135620117
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.827 Test Loss: 0.927 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.324121952056885
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.827 Test Loss: 0.934 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.357059955596924
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.934 Vali Acc: 0.832 Test Loss: 0.934 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.613194704055786
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.827 Test Loss: 0.925 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.328752517700195
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.827 Test Loss: 0.924 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.080668687820435
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.832 Test Loss: 0.926 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 53769991
model size : 219.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.99627161026001
Epoch: 1, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.519 Vali Acc: 0.387 Test Loss: 1.519 Test Acc: 0.387
Validation loss decreased (inf --> -0.387268).  Saving model ...
Epoch: 2 cost time: 3.9665417671203613
Epoch: 2, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.371 Vali Acc: 0.387 Test Loss: 1.371 Test Acc: 0.387
Validation loss decreased (-0.387268 --> -0.387270).  Saving model ...
Epoch: 3 cost time: 3.7360622882843018
Epoch: 3, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.003 Vali Acc: 0.613 Test Loss: 1.003 Test Acc: 0.613
Validation loss decreased (-0.387270 --> -0.612707).  Saving model ...
Epoch: 4 cost time: 3.5924019813537598
Epoch: 4, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.828 Vali Acc: 0.705 Test Loss: 0.828 Test Acc: 0.705
Validation loss decreased (-0.612707 --> -0.705194).  Saving model ...
Epoch: 5 cost time: 3.702847719192505
Epoch: 5, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.655 Vali Acc: 0.792 Test Loss: 0.655 Test Acc: 0.792
Validation loss decreased (-0.705194 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 4.01606011390686
Epoch: 6, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.534 Vali Acc: 0.792 Test Loss: 0.534 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 7 cost time: 3.7987375259399414
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.493 Vali Acc: 0.821 Test Loss: 0.493 Test Acc: 0.821
Validation loss decreased (-0.791902 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 3.506594181060791
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.072 Vali Acc: 0.769 Test Loss: 1.072 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.422515869140625
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.652 Vali Acc: 0.798 Test Loss: 0.652 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6818771362304688
Epoch: 10, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.588 Vali Acc: 0.786 Test Loss: 0.588 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8805532455444336
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.779266834259033
Epoch: 12, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.944 Vali Acc: 0.786 Test Loss: 0.944 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4929802417755127
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.107 Vali Acc: 0.775 Test Loss: 1.107 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5137577056884766
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.866 Vali Acc: 0.769 Test Loss: 0.866 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.637206792831421
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.734 Vali Acc: 0.809 Test Loss: 0.734 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.723179340362549
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.792 Test Loss: 0.713 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.8344500064849854
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.792 Test Loss: 0.713 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 53700871
model size : 219.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.077053070068359
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.523 Vali Acc: 0.277 Test Loss: 1.523 Test Acc: 0.277
Validation loss decreased (inf --> -0.277441).  Saving model ...
Epoch: 2 cost time: 4.153066873550415
Epoch: 2, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.265 Vali Acc: 0.572 Test Loss: 1.265 Test Acc: 0.572
Validation loss decreased (-0.277441 --> -0.572242).  Saving model ...
Epoch: 3 cost time: 4.509498596191406
Epoch: 3, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.903 Vali Acc: 0.618 Test Loss: 0.903 Test Acc: 0.618
Validation loss decreased (-0.572242 --> -0.618488).  Saving model ...
Epoch: 4 cost time: 4.389635324478149
Epoch: 4, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.914 Vali Acc: 0.682 Test Loss: 0.914 Test Acc: 0.682
Validation loss decreased (-0.618488 --> -0.682072).  Saving model ...
Epoch: 5 cost time: 4.150515556335449
Epoch: 5, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.867 Vali Acc: 0.636 Test Loss: 0.867 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.221750497817993
Epoch: 6, Steps: 17 | Train Loss: 0.427 Vali Loss: 1.040 Vali Acc: 0.613 Test Loss: 1.040 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.015449047088623
Epoch: 7, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.431 Vali Acc: 0.676 Test Loss: 1.431 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.220386743545532
Epoch: 8, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.763 Vali Acc: 0.746 Test Loss: 0.763 Test Acc: 0.746
Validation loss decreased (-0.682072 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 4.027854681015015
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.531 Vali Acc: 0.832 Test Loss: 0.531 Test Acc: 0.832
Validation loss decreased (-0.745657 --> -0.832365).  Saving model ...
Epoch: 10 cost time: 4.128239154815674
Epoch: 10, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.854 Vali Acc: 0.809 Test Loss: 0.854 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.947611093521118
Epoch: 11, Steps: 17 | Train Loss: 0.268 Vali Loss: 1.027 Vali Acc: 0.665 Test Loss: 1.027 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.285295486450195
Epoch: 12, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.877 Vali Acc: 0.815 Test Loss: 0.877 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.364083766937256
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.870 Vali Acc: 0.803 Test Loss: 0.870 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8939199447631836
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.747 Vali Acc: 0.838 Test Loss: 0.747 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838143).  Saving model ...
Epoch: 15 cost time: 4.02613377571106
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.933 Vali Acc: 0.786 Test Loss: 0.933 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.133099555969238
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.227 Vali Acc: 0.746 Test Loss: 1.227 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.3669397830963135
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.257 Vali Acc: 0.786 Test Loss: 1.257 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.323229551315308
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.754 Vali Acc: 0.838 Test Loss: 0.754 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.9447546005249023
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.375 Vali Acc: 0.803 Test Loss: 1.375 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.922013282775879
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.474 Vali Acc: 0.827 Test Loss: 1.474 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.213343858718872
Epoch: 21, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.069 Vali Acc: 0.832 Test Loss: 1.069 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.235182046890259
Epoch: 22, Steps: 17 | Train Loss: 0.030 Vali Loss: 2.422 Vali Acc: 0.751 Test Loss: 2.422 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.322943925857544
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 2.045 Vali Acc: 0.792 Test Loss: 2.045 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.217214107513428
Epoch: 24, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.568 Vali Acc: 0.803 Test Loss: 1.568 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 56140807
model size : 228.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.915426969528198
Epoch: 1, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.499 Vali Acc: 0.347 Test Loss: 1.499 Test Acc: 0.347
Validation loss decreased (inf --> -0.346806).  Saving model ...
Epoch: 2 cost time: 3.8550844192504883
Epoch: 2, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.192 Vali Acc: 0.422 Test Loss: 1.192 Test Acc: 0.422
Validation loss decreased (-0.346806 --> -0.421953).  Saving model ...
Epoch: 3 cost time: 3.7494688034057617
Epoch: 3, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.267 Vali Acc: 0.462 Test Loss: 1.267 Test Acc: 0.462
Validation loss decreased (-0.421953 --> -0.462415).  Saving model ...
Epoch: 4 cost time: 4.287346124649048
Epoch: 4, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.797 Vali Acc: 0.647 Test Loss: 0.797 Test Acc: 0.647
Validation loss decreased (-0.462415 --> -0.647391).  Saving model ...
Epoch: 5 cost time: 4.179579973220825
Epoch: 5, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.578 Vali Acc: 0.740 Test Loss: 0.578 Test Acc: 0.740
Validation loss decreased (-0.647391 --> -0.739879).  Saving model ...
Epoch: 6 cost time: 3.768301010131836
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.780 Vali Acc: 0.746 Test Loss: 0.780 Test Acc: 0.746
Validation loss decreased (-0.739879 --> -0.745657).  Saving model ...
Epoch: 7 cost time: 3.918466567993164
Epoch: 7, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.735 Vali Acc: 0.763 Test Loss: 0.735 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762998).  Saving model ...
Epoch: 8 cost time: 4.192433834075928
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
Validation loss decreased (-0.762998 --> -0.809244).  Saving model ...
Epoch: 9 cost time: 4.279402017593384
Epoch: 9, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.933 Vali Acc: 0.728 Test Loss: 0.933 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.205005168914795
Epoch: 10, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.887 Vali Acc: 0.763 Test Loss: 0.887 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.029414176940918
Epoch: 11, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.251923084259033
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.984 Vali Acc: 0.757 Test Loss: 0.984 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.310133457183838
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.886 Vali Acc: 0.809 Test Loss: 0.886 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.057682275772095
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.675 Vali Acc: 0.838 Test Loss: 0.675 Test Acc: 0.838
Validation loss decreased (-0.809244 --> -0.838144).  Saving model ...
Epoch: 15 cost time: 3.747687578201294
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9343204498291016
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.832 Test Loss: 0.733 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.983642816543579
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.809 Test Loss: 0.710 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.989029884338379
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.786 Test Loss: 0.699 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.944744825363159
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.786 Test Loss: 0.679 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.003763675689697
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.786 Test Loss: 0.683 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.596574306488037
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.786 Test Loss: 0.698 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.9501028060913086
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.792 Test Loss: 0.725 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.498840093612671
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.792 Test Loss: 0.736 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.596004009246826
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.792 Test Loss: 0.742 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 55988743
model size : 228.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.431752443313599
Epoch: 1, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.570 Vali Acc: 0.341 Test Loss: 1.570 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 4.044811010360718
Epoch: 2, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.000 Vali Acc: 0.642 Test Loss: 1.000 Test Acc: 0.642
Validation loss decreased (-0.341025 --> -0.641608).  Saving model ...
Epoch: 3 cost time: 4.17859959602356
Epoch: 3, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.979 Vali Acc: 0.595 Test Loss: 0.979 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.273710012435913
Epoch: 4, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.800 Vali Acc: 0.682 Test Loss: 0.800 Test Acc: 0.682
Validation loss decreased (-0.641608 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 4.19280743598938
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
Validation loss decreased (-0.682073 --> -0.791902).  Saving model ...
Epoch: 6 cost time: 3.906458616256714
Epoch: 6, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.867 Vali Acc: 0.688 Test Loss: 0.867 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.830728054046631
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.762 Vali Acc: 0.734 Test Loss: 0.762 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.782564878463745
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.909 Vali Acc: 0.786 Test Loss: 0.909 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8714547157287598
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.866 Vali Acc: 0.786 Test Loss: 0.866 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.362762928009033
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.903 Vali Acc: 0.757 Test Loss: 0.903 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4341444969177246
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.209 Vali Acc: 0.763 Test Loss: 1.209 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.822618246078491
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.015340566635132
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.831 Vali Acc: 0.792 Test Loss: 0.831 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.698709487915039
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.803 Test Loss: 0.782 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803460).  Saving model ...
Epoch: 15 cost time: 3.9369373321533203
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.861 Vali Acc: 0.786 Test Loss: 0.861 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.949221134185791
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.798 Test Loss: 0.824 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.036717891693115
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.798 Test Loss: 0.755 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.962669610977173
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.792 Test Loss: 0.780 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.118038654327393
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.786 Test Loss: 0.813 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.118244409561157
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.786 Test Loss: 0.822 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.095414876937866
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.792 Test Loss: 0.841 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.732156753540039
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.792 Test Loss: 0.874 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.7427992820739746
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.798 Test Loss: 0.853 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7987418174743652
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.798 Test Loss: 0.857 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 55912711
model size : 227.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.77153754234314
Epoch: 1, Steps: 17 | Train Loss: 1.862 Vali Loss: 1.453 Vali Acc: 0.382 Test Loss: 1.453 Test Acc: 0.382
Validation loss decreased (inf --> -0.381488).  Saving model ...
Epoch: 2 cost time: 4.668078422546387
Epoch: 2, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.081 Vali Acc: 0.514 Test Loss: 1.081 Test Acc: 0.514
Validation loss decreased (-0.381488 --> -0.514440).  Saving model ...
Epoch: 3 cost time: 4.520473957061768
Epoch: 3, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.883 Vali Acc: 0.653 Test Loss: 0.883 Test Acc: 0.653
Validation loss decreased (-0.514440 --> -0.653170).  Saving model ...
Epoch: 4 cost time: 4.744821071624756
Epoch: 4, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.828 Vali Acc: 0.688 Test Loss: 0.828 Test Acc: 0.688
Validation loss decreased (-0.653170 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 5.000435829162598
Epoch: 5, Steps: 17 | Train Loss: 0.402 Vali Loss: 1.224 Vali Acc: 0.624 Test Loss: 1.224 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.096312522888184
Epoch: 6, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
Validation loss decreased (-0.687853 --> -0.716755).  Saving model ...
Epoch: 7 cost time: 4.9089343547821045
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.210 Vali Acc: 0.717 Test Loss: 1.210 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.9069671630859375
Epoch: 8, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.861 Vali Acc: 0.694 Test Loss: 0.861 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.206250190734863
Epoch: 9, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.805 Vali Acc: 0.775 Test Loss: 0.805 Test Acc: 0.775
Validation loss decreased (-0.716755 --> -0.774558).  Saving model ...
Epoch: 10 cost time: 4.179665803909302
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.733 Vali Acc: 0.855 Test Loss: 0.733 Test Acc: 0.855
Validation loss decreased (-0.774558 --> -0.855484).  Saving model ...
Epoch: 11 cost time: 3.7280616760253906
Epoch: 11, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.074 Vali Acc: 0.734 Test Loss: 1.074 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.466813325881958
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.240 Vali Acc: 0.757 Test Loss: 1.240 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.068240165710449
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.301 Vali Acc: 0.780 Test Loss: 1.301 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.014007091522217
Epoch: 14, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.119 Vali Acc: 0.763 Test Loss: 1.119 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.778461217880249
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.964 Vali Acc: 0.803 Test Loss: 0.964 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.307549715042114
Epoch: 16, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.281 Vali Acc: 0.792 Test Loss: 1.281 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.8351566791534424
Epoch: 17, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.133 Vali Acc: 0.746 Test Loss: 1.133 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.575820446014404
Epoch: 18, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.276 Vali Acc: 0.792 Test Loss: 1.276 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.461341381072998
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.114 Vali Acc: 0.780 Test Loss: 1.114 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.157586336135864
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.971 Vali Acc: 0.798 Test Loss: 0.971 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 60495367
model size : 245.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.92299222946167
Epoch: 1, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.569 Vali Acc: 0.283 Test Loss: 1.569 Test Acc: 0.283
Validation loss decreased (inf --> -0.283221).  Saving model ...
Epoch: 2 cost time: 4.716153144836426
Epoch: 2, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.031 Vali Acc: 0.682 Test Loss: 1.031 Test Acc: 0.682
Validation loss decreased (-0.283221 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 4.37349009513855
Epoch: 3, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.688 Vali Acc: 0.757 Test Loss: 0.688 Test Acc: 0.757
Validation loss decreased (-0.682071 --> -0.757219).  Saving model ...
Epoch: 4 cost time: 4.209033727645874
Epoch: 4, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.779 Vali Acc: 0.671 Test Loss: 0.779 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.0046117305755615
Epoch: 5, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.829 Vali Acc: 0.682 Test Loss: 0.829 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.838660955429077
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.681 Vali Acc: 0.780 Test Loss: 0.681 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 4.862322092056274
Epoch: 7, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.796 Vali Acc: 0.751 Test Loss: 0.796 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.891420841217041
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.801 Vali Acc: 0.705 Test Loss: 0.801 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.541690826416016
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.661 Vali Acc: 0.780 Test Loss: 0.661 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780340).  Saving model ...
Epoch: 10 cost time: 4.448349237442017
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.04731822013855
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.781 Vali Acc: 0.838 Test Loss: 0.781 Test Acc: 0.838
Validation loss decreased (-0.780340 --> -0.838142).  Saving model ...
Epoch: 12 cost time: 5.156188488006592
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.619 Vali Acc: 0.815 Test Loss: 0.619 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.142415761947632
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.650 Vali Acc: 0.832 Test Loss: 0.650 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.8595545291900635
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.934 Vali Acc: 0.775 Test Loss: 0.934 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.766188383102417
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.908748149871826
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.808 Vali Acc: 0.786 Test Loss: 0.808 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.9358742237091064
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.809 Test Loss: 0.728 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.694692850112915
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.786 Test Loss: 0.762 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.082601308822632
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.798 Test Loss: 0.758 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.334304571151733
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.798 Test Loss: 0.756 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.115908622741699
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 60398599
model size : 245.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.670053005218506
Epoch: 1, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.512 Vali Acc: 0.364 Test Loss: 1.512 Test Acc: 0.364
Validation loss decreased (inf --> -0.364147).  Saving model ...
Epoch: 2 cost time: 4.513549566268921
Epoch: 2, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.299 Vali Acc: 0.434 Test Loss: 1.299 Test Acc: 0.434
Validation loss decreased (-0.364147 --> -0.433513).  Saving model ...
Epoch: 3 cost time: 4.022098064422607
Epoch: 3, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.166 Vali Acc: 0.601 Test Loss: 1.166 Test Acc: 0.601
Validation loss decreased (-0.433513 --> -0.601144).  Saving model ...
Epoch: 4 cost time: 4.071004629135132
Epoch: 4, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.782 Vali Acc: 0.665 Test Loss: 0.782 Test Acc: 0.665
Validation loss decreased (-0.601144 --> -0.664732).  Saving model ...
Epoch: 5 cost time: 4.651648283004761
Epoch: 5, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.694 Vali Acc: 0.705 Test Loss: 0.694 Test Acc: 0.705
Validation loss decreased (-0.664732 --> -0.705195).  Saving model ...
Epoch: 6 cost time: 4.536055326461792
Epoch: 6, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.738 Vali Acc: 0.757 Test Loss: 0.738 Test Acc: 0.757
Validation loss decreased (-0.705195 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 3.7689850330352783
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.632 Vali Acc: 0.751 Test Loss: 0.632 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7342677116394043
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.659 Vali Acc: 0.746 Test Loss: 0.659 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.072691440582275
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.959 Vali Acc: 0.798 Test Loss: 0.959 Test Acc: 0.798
Validation loss decreased (-0.757218 --> -0.797678).  Saving model ...
Epoch: 10 cost time: 4.306376934051514
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.5213844776153564
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.594 Vali Acc: 0.832 Test Loss: 0.594 Test Acc: 0.832
Validation loss decreased (-0.797678 --> -0.832364).  Saving model ...
Epoch: 12 cost time: 4.030318021774292
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
Validation loss decreased (-0.832364 --> -0.855485).  Saving model ...
Epoch: 13 cost time: 4.821868896484375
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.855 Test Loss: 0.567 Test Acc: 0.855
Validation loss decreased (-0.855485 --> -0.855486).  Saving model ...
Epoch: 14 cost time: 4.483242034912109
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.708717584609985
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.942 Vali Acc: 0.763 Test Loss: 0.942 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.365756988525391
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.350109815597534
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.742 Vali Acc: 0.803 Test Loss: 0.742 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.996704578399658
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.782 Vali Acc: 0.775 Test Loss: 0.782 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.87187933921814
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.732 Vali Acc: 0.751 Test Loss: 0.732 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.871080160140991
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.617 Vali Acc: 0.821 Test Loss: 0.617 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.618281364440918
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.798 Test Loss: 0.583 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.4446659088134766
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.798 Test Loss: 0.619 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.152704954147339
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.821 Test Loss: 0.660 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 60336391
model size : 244.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.600951910018921
Epoch: 1, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.419 Vali Acc: 0.486 Test Loss: 1.419 Test Acc: 0.486
Validation loss decreased (inf --> -0.485535).  Saving model ...
Epoch: 2 cost time: 4.1234729290008545
Epoch: 2, Steps: 17 | Train Loss: 1.193 Vali Loss: 0.995 Vali Acc: 0.538 Test Loss: 0.995 Test Acc: 0.538
Validation loss decreased (-0.485535 --> -0.537562).  Saving model ...
Epoch: 3 cost time: 4.308447599411011
Epoch: 3, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.368 Vali Acc: 0.584 Test Loss: 1.368 Test Acc: 0.584
Validation loss decreased (-0.537562 --> -0.583801).  Saving model ...
Epoch: 4 cost time: 4.107663631439209
Epoch: 4, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.039 Vali Acc: 0.590 Test Loss: 1.039 Test Acc: 0.590
Validation loss decreased (-0.583801 --> -0.589585).  Saving model ...
Epoch: 5 cost time: 3.4795889854431152
Epoch: 5, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.626 Vali Acc: 0.769 Test Loss: 0.626 Test Acc: 0.769
Validation loss decreased (-0.589585 --> -0.768780).  Saving model ...
Epoch: 6 cost time: 4.974387884140015
Epoch: 6, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.764 Vali Acc: 0.711 Test Loss: 0.764 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.75404953956604
Epoch: 7, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.536 Vali Acc: 0.798 Test Loss: 0.536 Test Acc: 0.798
Validation loss decreased (-0.768780 --> -0.797682).  Saving model ...
Epoch: 8 cost time: 4.545169830322266
Epoch: 8, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.794 Vali Acc: 0.769 Test Loss: 0.794 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.673378944396973
Epoch: 9, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.682 Vali Acc: 0.769 Test Loss: 0.682 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.002490997314453
Epoch: 10, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.562 Vali Acc: 0.861 Test Loss: 0.562 Test Acc: 0.861
Validation loss decreased (-0.797682 --> -0.861266).  Saving model ...
Epoch: 11 cost time: 4.711285829544067
Epoch: 11, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.737 Vali Acc: 0.803 Test Loss: 0.737 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.738201379776001
Epoch: 12, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.718 Vali Acc: 0.821 Test Loss: 0.718 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.406132936477661
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.711 Vali Acc: 0.821 Test Loss: 0.711 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.486817121505737
Epoch: 14, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
Validation loss decreased (-0.861266 --> -0.867046).  Saving model ...
Epoch: 15 cost time: 4.514333009719849
Epoch: 15, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.700 Vali Acc: 0.821 Test Loss: 0.700 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.4458465576171875
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.893 Vali Acc: 0.821 Test Loss: 0.893 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.272221803665161
Epoch: 17, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.067 Vali Acc: 0.792 Test Loss: 1.067 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.350770711898804
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.893 Vali Acc: 0.855 Test Loss: 0.893 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.597585439682007
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.379 Vali Acc: 0.798 Test Loss: 1.379 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.375086069107056
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.883 Vali Acc: 0.844 Test Loss: 0.883 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.207387685775757
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.185 Vali Acc: 0.809 Test Loss: 1.185 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.068940877914429
Epoch: 22, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.687 Vali Acc: 0.832 Test Loss: 0.687 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.194869518280029
Epoch: 23, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.012 Vali Acc: 0.803 Test Loss: 1.012 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.460721731185913
Epoch: 24, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.093 Vali Acc: 0.821 Test Loss: 1.093 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 62714119
model size : 253.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.419568061828613
Epoch: 1, Steps: 17 | Train Loss: 1.853 Vali Loss: 1.565 Vali Acc: 0.318 Test Loss: 1.565 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
Epoch: 2 cost time: 4.627487897872925
Epoch: 2, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.064 Vali Acc: 0.572 Test Loss: 1.064 Test Acc: 0.572
Validation loss decreased (-0.317903 --> -0.572244).  Saving model ...
Epoch: 3 cost time: 4.649704933166504
Epoch: 3, Steps: 17 | Train Loss: 0.742 Vali Loss: 1.027 Vali Acc: 0.676 Test Loss: 1.027 Test Acc: 0.676
Validation loss decreased (-0.572244 --> -0.676290).  Saving model ...
Epoch: 4 cost time: 4.418984889984131
Epoch: 4, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.829 Vali Acc: 0.723 Test Loss: 0.829 Test Acc: 0.723
Validation loss decreased (-0.676290 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 4.346243858337402
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.716 Vali Acc: 0.734 Test Loss: 0.716 Test Acc: 0.734
Validation loss decreased (-0.722535 --> -0.734097).  Saving model ...
Epoch: 6 cost time: 4.085601329803467
Epoch: 6, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.752 Vali Acc: 0.769 Test Loss: 0.752 Test Acc: 0.769
Validation loss decreased (-0.734097 --> -0.768779).  Saving model ...
Epoch: 7 cost time: 4.338502407073975
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.48813533782959
Epoch: 8, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.768779 --> -0.803461).  Saving model ...
Epoch: 9 cost time: 4.360578536987305
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.764 Vali Acc: 0.786 Test Loss: 0.764 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.331684112548828
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.655 Vali Acc: 0.780 Test Loss: 0.655 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.245198726654053
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.702 Vali Acc: 0.803 Test Loss: 0.702 Test Acc: 0.803
Validation loss decreased (-0.803461 --> -0.803461).  Saving model ...
Epoch: 12 cost time: 4.599211931228638
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.786 Test Loss: 0.689 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.3976051807403564
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.792 Test Loss: 0.697 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.242359161376953
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.290808439254761
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.815 Test Loss: 0.645 Test Acc: 0.815
Validation loss decreased (-0.803461 --> -0.815022).  Saving model ...
Epoch: 16 cost time: 4.580549240112305
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.821 Test Loss: 0.647 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820803).  Saving model ...
Epoch: 17 cost time: 4.469412326812744
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.821 Test Loss: 0.646 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820803).  Saving model ...
Epoch: 18 cost time: 4.642216205596924
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.821 Test Loss: 0.662 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.0530946254730225
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.815 Test Loss: 0.665 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.268821477890015
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.821 Test Loss: 0.672 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.851206541061401
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.821 Test Loss: 0.673 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.767717123031616
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.821 Test Loss: 0.684 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.769734859466553
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.821 Test Loss: 0.682 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.61771821975708
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.821 Test Loss: 0.684 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.778774261474609
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.821 Test Loss: 0.688 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.95894718170166
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.821 Test Loss: 0.690 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.807874917984009
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.821 Test Loss: 0.690 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 62603527
model size : 253.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.970488548278809
Epoch: 1, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.409 Vali Acc: 0.434 Test Loss: 1.409 Test Acc: 0.434
Validation loss decreased (inf --> -0.433512).  Saving model ...
Epoch: 2 cost time: 4.002837181091309
Epoch: 2, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.132 Vali Acc: 0.532 Test Loss: 1.132 Test Acc: 0.532
Validation loss decreased (-0.433512 --> -0.531781).  Saving model ...
Epoch: 3 cost time: 3.693253517150879
Epoch: 3, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.137 Vali Acc: 0.538 Test Loss: 1.137 Test Acc: 0.538
Validation loss decreased (-0.531781 --> -0.537561).  Saving model ...
Epoch: 4 cost time: 3.7984161376953125
Epoch: 4, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.854 Vali Acc: 0.659 Test Loss: 0.854 Test Acc: 0.659
Validation loss decreased (-0.537561 --> -0.658951).  Saving model ...
Epoch: 5 cost time: 3.900273323059082
Epoch: 5, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.196 Vali Acc: 0.613 Test Loss: 1.196 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5424540042877197
Epoch: 6, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.679 Vali Acc: 0.740 Test Loss: 0.679 Test Acc: 0.740
Validation loss decreased (-0.658951 --> -0.739878).  Saving model ...
Epoch: 7 cost time: 3.9356038570404053
Epoch: 7, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.727 Vali Acc: 0.740 Test Loss: 0.727 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.928327798843384
Epoch: 8, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8701372146606445
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 1.010 Vali Acc: 0.676 Test Loss: 1.010 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3353824615478516
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.516 Vali Acc: 0.844 Test Loss: 0.516 Test Acc: 0.844
Validation loss decreased (-0.739878 --> -0.843925).  Saving model ...
Epoch: 11 cost time: 3.7376325130462646
Epoch: 11, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.904 Vali Acc: 0.723 Test Loss: 0.904 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.3154683113098145
Epoch: 12, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.936 Vali Acc: 0.723 Test Loss: 0.936 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.288270950317383
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.732 Vali Acc: 0.780 Test Loss: 0.732 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.124184846878052
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9155304431915283
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.481 Vali Acc: 0.844 Test Loss: 0.481 Test Acc: 0.844
Validation loss decreased (-0.843925 --> -0.843926).  Saving model ...
Epoch: 16 cost time: 4.125526666641235
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.885 Vali Acc: 0.769 Test Loss: 0.885 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.167867422103882
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.854 Vali Acc: 0.798 Test Loss: 0.854 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.332023620605469
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.815 Test Loss: 0.714 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.0850510597229
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.943 Vali Acc: 0.803 Test Loss: 0.943 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.264804124832153
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.733 Vali Acc: 0.803 Test Loss: 0.733 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.074497938156128
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.195367813110352
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.175 Vali Acc: 0.780 Test Loss: 1.175 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.0279529094696045
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.809 Test Loss: 0.944 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.127751111984253
Epoch: 24, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.018 Vali Acc: 0.740 Test Loss: 1.018 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.8083837032318115
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.969 Vali Acc: 0.775 Test Loss: 0.969 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 62548231
model size : 253.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.079567193984985
Epoch: 1, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.436 Vali Acc: 0.289 Test Loss: 1.436 Test Acc: 0.289
Validation loss decreased (inf --> -0.289003).  Saving model ...
Epoch: 2 cost time: 3.7745392322540283
Epoch: 2, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.121 Vali Acc: 0.497 Test Loss: 1.121 Test Acc: 0.497
Validation loss decreased (-0.289003 --> -0.497099).  Saving model ...
Epoch: 3 cost time: 3.9788401126861572
Epoch: 3, Steps: 17 | Train Loss: 0.706 Vali Loss: 1.547 Vali Acc: 0.497 Test Loss: 1.547 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7183783054351807
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.759 Vali Acc: 0.763 Test Loss: 0.759 Test Acc: 0.763
Validation loss decreased (-0.497099 --> -0.762998).  Saving model ...
Epoch: 5 cost time: 4.085768461227417
Epoch: 5, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.649 Vali Acc: 0.775 Test Loss: 0.649 Test Acc: 0.775
Validation loss decreased (-0.762998 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 3.845693826675415
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 3.5907084941864014
Epoch: 7, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.703 Vali Acc: 0.780 Test Loss: 0.703 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.185888051986694
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.601 Vali Acc: 0.798 Test Loss: 0.601 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797682).  Saving model ...
Epoch: 9 cost time: 3.9918289184570312
Epoch: 9, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.045 Vali Acc: 0.751 Test Loss: 1.045 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9573049545288086
Epoch: 10, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.797682 --> -0.838145).  Saving model ...
Epoch: 11 cost time: 3.9353325366973877
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.362364053726196
Epoch: 12, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.765 Vali Acc: 0.699 Test Loss: 1.765 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.34927225112915
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.975 Vali Acc: 0.746 Test Loss: 0.975 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.939469814300537
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.766 Vali Acc: 0.763 Test Loss: 0.766 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.056322336196899
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.808 Vali Acc: 0.763 Test Loss: 0.808 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.109366178512573
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.027 Vali Acc: 0.786 Test Loss: 1.027 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.332951307296753
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.182 Vali Acc: 0.792 Test Loss: 1.182 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.138604164123535
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.643 Vali Acc: 0.798 Test Loss: 0.643 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.925706148147583
Epoch: 19, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.563 Vali Acc: 0.740 Test Loss: 1.563 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.859647274017334
Epoch: 20, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.405 Vali Acc: 0.751 Test Loss: 1.405 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 64932871
model size : 262.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.224565744400024
Epoch: 1, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.338 Vali Acc: 0.572 Test Loss: 1.338 Test Acc: 0.572
Validation loss decreased (inf --> -0.572241).  Saving model ...
Epoch: 2 cost time: 3.199469804763794
Epoch: 2, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.287 Vali Acc: 0.462 Test Loss: 1.287 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1174066066741943
Epoch: 3, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.030 Vali Acc: 0.665 Test Loss: 1.030 Test Acc: 0.665
Validation loss decreased (-0.572241 --> -0.664730).  Saving model ...
Epoch: 4 cost time: 3.2810440063476562
Epoch: 4, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.839 Vali Acc: 0.699 Test Loss: 0.839 Test Acc: 0.699
Validation loss decreased (-0.664730 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 3.5003268718719482
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.783 Vali Acc: 0.711 Test Loss: 0.783 Test Acc: 0.711
Validation loss decreased (-0.699414 --> -0.710975).  Saving model ...
Epoch: 6 cost time: 3.3534488677978516
Epoch: 6, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.098 Vali Acc: 0.711 Test Loss: 1.098 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5369129180908203
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.646 Vali Acc: 0.769 Test Loss: 0.646 Test Acc: 0.769
Validation loss decreased (-0.710975 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 3.277869462966919
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.812 Vali Acc: 0.798 Test Loss: 0.812 Test Acc: 0.798
Validation loss decreased (-0.768780 --> -0.797680).  Saving model ...
Epoch: 9 cost time: 3.4492576122283936
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.782 Vali Acc: 0.798 Test Loss: 0.782 Test Acc: 0.798
Validation loss decreased (-0.797680 --> -0.797680).  Saving model ...
Epoch: 10 cost time: 3.4300901889801025
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.008 Vali Acc: 0.711 Test Loss: 1.008 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6191246509552
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.749 Vali Acc: 0.757 Test Loss: 0.749 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7339601516723633
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.797680 --> -0.809242).  Saving model ...
Epoch: 13 cost time: 3.7965214252471924
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.855 Vali Acc: 0.780 Test Loss: 0.855 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.81579327583313
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.913 Vali Acc: 0.757 Test Loss: 0.913 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.031006813049316
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.126 Vali Acc: 0.723 Test Loss: 1.126 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.009782314300537
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.907 Vali Acc: 0.809 Test Loss: 0.907 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7667083740234375
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.780 Test Loss: 0.753 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8561065196990967
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8257012367248535
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.798 Test Loss: 0.704 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.879938840866089
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9914956092834473
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.798 Test Loss: 0.702 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.600668430328369
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.803 Test Loss: 0.705 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 64822279
model size : 261.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.230660438537598
Epoch: 1, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.397 Vali Acc: 0.439 Test Loss: 1.397 Test Acc: 0.439
Validation loss decreased (inf --> -0.439292).  Saving model ...
Epoch: 2 cost time: 3.0937306880950928
Epoch: 2, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.035 Vali Acc: 0.526 Test Loss: 1.035 Test Acc: 0.526
Validation loss decreased (-0.439292 --> -0.526001).  Saving model ...
Epoch: 3 cost time: 3.0122106075286865
Epoch: 3, Steps: 17 | Train Loss: 0.929 Vali Loss: 0.962 Vali Acc: 0.595 Test Loss: 0.962 Test Acc: 0.595
Validation loss decreased (-0.526001 --> -0.595366).  Saving model ...
Epoch: 4 cost time: 2.845243215560913
Epoch: 4, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.756 Vali Acc: 0.699 Test Loss: 0.756 Test Acc: 0.699
Validation loss decreased (-0.595366 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 2.844080686569214
Epoch: 5, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.532 Vali Acc: 0.792 Test Loss: 0.532 Test Acc: 0.792
Validation loss decreased (-0.699414 --> -0.791902).  Saving model ...
Epoch: 6 cost time: 3.0816619396209717
Epoch: 6, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.010 Vali Acc: 0.699 Test Loss: 1.010 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2139084339141846
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.652 Vali Acc: 0.746 Test Loss: 0.652 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8165392875671387
Epoch: 8, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.532 Vali Acc: 0.798 Test Loss: 0.532 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797683).  Saving model ...
Epoch: 9 cost time: 2.9001221656799316
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.738 Vali Acc: 0.792 Test Loss: 0.738 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9934420585632324
Epoch: 10, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.613 Vali Acc: 0.786 Test Loss: 0.613 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.171502113342285
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.681 Vali Acc: 0.780 Test Loss: 0.681 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.207333564758301
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.689 Vali Acc: 0.798 Test Loss: 0.689 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.081476926803589
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.682 Vali Acc: 0.792 Test Loss: 0.682 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7558557987213135
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.795 Vali Acc: 0.792 Test Loss: 0.795 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.268075466156006
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2677621841430664
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.656 Vali Acc: 0.798 Test Loss: 0.656 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.316943645477295
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.798 Test Loss: 0.661 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2096712589263916
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.867 Vali Acc: 0.780 Test Loss: 0.867 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 64766983
model size : 261.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.212866306304932
Epoch: 1, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.611 Vali Acc: 0.312 Test Loss: 1.611 Test Acc: 0.312
Validation loss decreased (inf --> -0.312123).  Saving model ...
Epoch: 2 cost time: 4.596594333648682
Epoch: 2, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.210 Vali Acc: 0.514 Test Loss: 1.210 Test Acc: 0.514
Validation loss decreased (-0.312123 --> -0.514439).  Saving model ...
Epoch: 3 cost time: 4.6462531089782715
Epoch: 3, Steps: 17 | Train Loss: 0.966 Vali Loss: 0.830 Vali Acc: 0.659 Test Loss: 0.830 Test Acc: 0.659
Validation loss decreased (-0.514439 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 4.363552808761597
Epoch: 4, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.785 Vali Acc: 0.688 Test Loss: 0.785 Test Acc: 0.688
Validation loss decreased (-0.658951 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 4.035790920257568
Epoch: 5, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.924 Vali Acc: 0.613 Test Loss: 0.924 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.159589529037476
Epoch: 6, Steps: 17 | Train Loss: 0.255 Vali Loss: 1.060 Vali Acc: 0.688 Test Loss: 1.060 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.41264533996582
Epoch: 7, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.818 Vali Acc: 0.746 Test Loss: 0.818 Test Acc: 0.746
Validation loss decreased (-0.687853 --> -0.745657).  Saving model ...
Epoch: 8 cost time: 4.033304691314697
Epoch: 8, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.110 Vali Acc: 0.682 Test Loss: 1.110 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.238901138305664
Epoch: 9, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.668 Vali Acc: 0.821 Test Loss: 0.668 Test Acc: 0.821
Validation loss decreased (-0.745657 --> -0.820803).  Saving model ...
Epoch: 10 cost time: 3.3557236194610596
Epoch: 10, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.283 Vali Acc: 0.746 Test Loss: 1.283 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5073676109313965
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.315 Vali Acc: 0.757 Test Loss: 1.315 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.853501558303833
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.219 Vali Acc: 0.711 Test Loss: 1.219 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.748922824859619
Epoch: 13, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
Validation loss decreased (-0.820803 --> -0.855485).  Saving model ...
Epoch: 14 cost time: 4.566912412643433
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.790 Vali Acc: 0.815 Test Loss: 0.790 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.151747941970825
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.083 Vali Acc: 0.763 Test Loss: 1.083 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.406438112258911
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.138 Vali Acc: 0.723 Test Loss: 1.138 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.4975175857543945
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.972 Vali Acc: 0.809 Test Loss: 0.972 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.489234209060669
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.434 Vali Acc: 0.769 Test Loss: 1.434 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.806596279144287
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.791 Vali Acc: 0.815 Test Loss: 0.791 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.061401605606079
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.948 Vali Acc: 0.763 Test Loss: 0.948 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.419224977493286
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.457 Vali Acc: 0.723 Test Loss: 1.457 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.389254570007324
Epoch: 22, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.738 Vali Acc: 0.798 Test Loss: 0.738 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.896793603897095
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.882 Vali Acc: 0.769 Test Loss: 0.882 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 69321991
model size : 279.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.882338285446167
Epoch: 1, Steps: 17 | Train Loss: 1.795 Vali Loss: 1.353 Vali Acc: 0.480 Test Loss: 1.353 Test Acc: 0.480
Validation loss decreased (inf --> -0.479755).  Saving model ...
Epoch: 2 cost time: 4.624673128128052
Epoch: 2, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.032 Vali Acc: 0.590 Test Loss: 1.032 Test Acc: 0.590
Validation loss decreased (-0.479755 --> -0.589585).  Saving model ...
Epoch: 3 cost time: 4.409287929534912
Epoch: 3, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.823 Vali Acc: 0.653 Test Loss: 0.823 Test Acc: 0.653
Validation loss decreased (-0.589585 --> -0.653171).  Saving model ...
Epoch: 4 cost time: 3.892805814743042
Epoch: 4, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.822 Vali Acc: 0.630 Test Loss: 0.822 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.4334588050842285
Epoch: 5, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.904 Vali Acc: 0.682 Test Loss: 0.904 Test Acc: 0.682
Validation loss decreased (-0.653171 --> -0.682072).  Saving model ...
Epoch: 6 cost time: 4.8538734912872314
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.809 Vali Acc: 0.699 Test Loss: 0.809 Test Acc: 0.699
Validation loss decreased (-0.682072 --> -0.699414).  Saving model ...
Epoch: 7 cost time: 4.4732630252838135
Epoch: 7, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.492 Vali Acc: 0.827 Test Loss: 0.492 Test Acc: 0.827
Validation loss decreased (-0.699414 --> -0.826585).  Saving model ...
Epoch: 8 cost time: 4.478241920471191
Epoch: 8, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.055 Vali Acc: 0.717 Test Loss: 1.055 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.8000288009643555
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.51154637336731
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.861 Vali Acc: 0.763 Test Loss: 0.861 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.687586069107056
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.201 Vali Acc: 0.688 Test Loss: 1.201 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.205450773239136
Epoch: 12, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.665 Vali Acc: 0.798 Test Loss: 0.665 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.228997707366943
Epoch: 13, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.693 Vali Acc: 0.792 Test Loss: 0.693 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.7640721797943115
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.810 Vali Acc: 0.780 Test Loss: 0.810 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.680565357208252
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.615 Vali Acc: 0.838 Test Loss: 0.615 Test Acc: 0.838
Validation loss decreased (-0.826585 --> -0.838144).  Saving model ...
Epoch: 16 cost time: 4.118661642074585
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.838 Test Loss: 0.593 Test Acc: 0.838
Validation loss decreased (-0.838144 --> -0.838144).  Saving model ...
Epoch: 17 cost time: 4.260812044143677
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.710767984390259
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.9477715492248535
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.821 Test Loss: 0.615 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.093024015426636
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.815 Test Loss: 0.640 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.5966832637786865
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.821 Test Loss: 0.609 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.6592912673950195
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.832 Test Loss: 0.601 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.085911750793457
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.827 Test Loss: 0.613 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.8732006549835205
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.832 Test Loss: 0.617 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.721529006958008
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.832 Test Loss: 0.622 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.957547664642334
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.821 Test Loss: 0.628 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 69245959
model size : 278.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.882272243499756
Epoch: 1, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.624 Vali Acc: 0.370 Test Loss: 1.624 Test Acc: 0.370
Validation loss decreased (inf --> -0.369926).  Saving model ...
Epoch: 2 cost time: 3.903831958770752
Epoch: 2, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.158 Vali Acc: 0.601 Test Loss: 1.158 Test Acc: 0.601
Validation loss decreased (-0.369926 --> -0.601144).  Saving model ...
Epoch: 3 cost time: 4.391398191452026
Epoch: 3, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.148 Vali Acc: 0.520 Test Loss: 1.148 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.311472415924072
Epoch: 4, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
Validation loss decreased (-0.601144 --> -0.757219).  Saving model ...
Epoch: 5 cost time: 4.489455699920654
Epoch: 5, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.915 Vali Acc: 0.757 Test Loss: 0.915 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.189770936965942
Epoch: 6, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.604 Vali Acc: 0.769 Test Loss: 0.604 Test Acc: 0.769
Validation loss decreased (-0.757219 --> -0.768780).  Saving model ...
Epoch: 7 cost time: 4.092669248580933
Epoch: 7, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.745 Vali Acc: 0.763 Test Loss: 0.745 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.333665609359741
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.483 Vali Acc: 0.827 Test Loss: 0.483 Test Acc: 0.827
Validation loss decreased (-0.768780 --> -0.826585).  Saving model ...
Epoch: 9 cost time: 4.667875528335571
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.596 Vali Acc: 0.827 Test Loss: 0.596 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.381721258163452
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.722 Vali Acc: 0.775 Test Loss: 0.722 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.2787392139434814
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.551 Vali Acc: 0.815 Test Loss: 0.551 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.1292641162872314
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.597 Vali Acc: 0.798 Test Loss: 0.597 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.383874893188477
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.297219276428223
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.775 Test Loss: 0.689 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.5183045864105225
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.792 Test Loss: 0.798 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.458985090255737
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.774533748626709
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.769 Test Loss: 0.718 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.7795307636260986
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 69197575
model size : 278.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.891775131225586
Epoch: 1, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.448 Vali Acc: 0.457 Test Loss: 1.448 Test Acc: 0.457
Validation loss decreased (inf --> -0.456633).  Saving model ...
Epoch: 2 cost time: 5.552786588668823
Epoch: 2, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.077 Vali Acc: 0.578 Test Loss: 1.077 Test Acc: 0.578
Validation loss decreased (-0.456633 --> -0.578024).  Saving model ...
Epoch: 3 cost time: 5.515177488327026
Epoch: 3, Steps: 17 | Train Loss: 0.788 Vali Loss: 1.015 Vali Acc: 0.630 Test Loss: 1.015 Test Acc: 0.630
Validation loss decreased (-0.578024 --> -0.630048).  Saving model ...
Epoch: 4 cost time: 4.653863191604614
Epoch: 4, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.498 Vali Acc: 0.659 Test Loss: 1.498 Test Acc: 0.659
Validation loss decreased (-0.630048 --> -0.658945).  Saving model ...
Epoch: 5 cost time: 5.407175302505493
Epoch: 5, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.680 Vali Acc: 0.723 Test Loss: 0.680 Test Acc: 0.723
Validation loss decreased (-0.658945 --> -0.722537).  Saving model ...
Epoch: 6 cost time: 5.7202136516571045
Epoch: 6, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.971 Vali Acc: 0.694 Test Loss: 0.971 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.460815906524658
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.984 Vali Acc: 0.694 Test Loss: 0.984 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.8264312744140625
Epoch: 8, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.806 Vali Acc: 0.780 Test Loss: 0.806 Test Acc: 0.780
Validation loss decreased (-0.722537 --> -0.780339).  Saving model ...
Epoch: 9 cost time: 5.2389445304870605
Epoch: 9, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.868 Vali Acc: 0.769 Test Loss: 0.868 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.225052833557129
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.754 Vali Acc: 0.821 Test Loss: 0.754 Test Acc: 0.821
Validation loss decreased (-0.780339 --> -0.820802).  Saving model ...
Epoch: 11 cost time: 4.648970127105713
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.959 Vali Acc: 0.769 Test Loss: 0.959 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.266810894012451
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.561 Vali Acc: 0.832 Test Loss: 0.561 Test Acc: 0.832
Validation loss decreased (-0.820802 --> -0.832364).  Saving model ...
Epoch: 13 cost time: 5.351309776306152
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.684 Vali Acc: 0.827 Test Loss: 0.684 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.1450440883636475
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.119 Vali Acc: 0.803 Test Loss: 1.119 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.911861419677734
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.891 Vali Acc: 0.803 Test Loss: 0.891 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.1162269115448
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.832 Test Loss: 0.809 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.8377392292022705
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.827 Test Loss: 0.936 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.318933963775635
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.855 Test Loss: 0.839 Test Acc: 0.855
Validation loss decreased (-0.832364 --> -0.855483).  Saving model ...
Epoch: 19 cost time: 4.936509609222412
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.867 Test Loss: 0.828 Test Acc: 0.867
Validation loss decreased (-0.855483 --> -0.867044).  Saving model ...
Epoch: 20 cost time: 4.364628791809082
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.861 Test Loss: 0.906 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.834805250167847
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.861 Test Loss: 0.900 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.266567707061768
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.850 Test Loss: 0.885 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.250063180923462
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.855 Test Loss: 0.881 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.955884218215942
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.850 Test Loss: 0.889 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.991922378540039
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.844 Test Loss: 0.895 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.713805913925171
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.844 Test Loss: 0.898 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.9681396484375
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.832 Test Loss: 0.903 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.816046953201294
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.838 Test Loss: 0.909 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.6134326457977295
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.838 Test Loss: 0.911 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 75943687
model size : 304.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.633623361587524
Epoch: 1, Steps: 17 | Train Loss: 1.771 Vali Loss: 1.408 Vali Acc: 0.382 Test Loss: 1.408 Test Acc: 0.382
Validation loss decreased (inf --> -0.381489).  Saving model ...
Epoch: 2 cost time: 5.6181676387786865
Epoch: 2, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.153 Vali Acc: 0.538 Test Loss: 1.153 Test Acc: 0.538
Validation loss decreased (-0.381489 --> -0.537561).  Saving model ...
Epoch: 3 cost time: 5.105373382568359
Epoch: 3, Steps: 17 | Train Loss: 0.897 Vali Loss: 0.840 Vali Acc: 0.653 Test Loss: 0.840 Test Acc: 0.653
Validation loss decreased (-0.537561 --> -0.653171).  Saving model ...
Epoch: 4 cost time: 5.6623358726501465
Epoch: 4, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
Validation loss decreased (-0.653171 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 5.246448278427124
Epoch: 5, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
Validation loss decreased (-0.762999 --> -0.820803).  Saving model ...
Epoch: 6 cost time: 4.671068906784058
Epoch: 6, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.559 Vali Acc: 0.798 Test Loss: 0.559 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.708564519882202
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5202624797821045
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.091 Vali Acc: 0.699 Test Loss: 1.091 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.6499104499816895
Epoch: 9, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.654 Vali Acc: 0.786 Test Loss: 0.654 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9275569915771484
Epoch: 10, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.483824253082275
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.364 Vali Acc: 0.723 Test Loss: 1.364 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.607321500778198
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.534 Vali Acc: 0.821 Test Loss: 0.534 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 5.742652416229248
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.565 Vali Acc: 0.821 Test Loss: 0.565 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.2916929721832275
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.707 Vali Acc: 0.792 Test Loss: 0.707 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.265991926193237
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.733 Vali Acc: 0.798 Test Loss: 0.733 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.299444198608398
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.410264730453491
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.48176383972168
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.001036882400513
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.792 Test Loss: 0.652 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.663817882537842
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.792 Test Loss: 0.650 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.1650965213775635
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.786 Test Loss: 0.670 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.180586099624634
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 75881479
model size : 304.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.090543031692505
Epoch: 1, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.421 Vali Acc: 0.457 Test Loss: 1.421 Test Acc: 0.457
Validation loss decreased (inf --> -0.456633).  Saving model ...
Epoch: 2 cost time: 5.686260461807251
Epoch: 2, Steps: 17 | Train Loss: 1.178 Vali Loss: 0.992 Vali Acc: 0.613 Test Loss: 0.992 Test Acc: 0.613
Validation loss decreased (-0.456633 --> -0.612707).  Saving model ...
Epoch: 3 cost time: 5.87649941444397
Epoch: 3, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.161 Vali Acc: 0.532 Test Loss: 1.161 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.533665418624878
Epoch: 4, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
Validation loss decreased (-0.612707 --> -0.716756).  Saving model ...
Epoch: 5 cost time: 5.832845687866211
Epoch: 5, Steps: 17 | Train Loss: 0.466 Vali Loss: 1.013 Vali Acc: 0.665 Test Loss: 1.013 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.959251642227173
Epoch: 6, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.629 Vali Acc: 0.769 Test Loss: 0.629 Test Acc: 0.769
Validation loss decreased (-0.716756 --> -0.768780).  Saving model ...
Epoch: 7 cost time: 5.760626554489136
Epoch: 7, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.768 Vali Acc: 0.763 Test Loss: 0.768 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.296355247497559
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.629 Vali Acc: 0.746 Test Loss: 0.629 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.428972482681274
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803462).  Saving model ...
Epoch: 10 cost time: 5.7152323722839355
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.365948677062988
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.495 Vali Acc: 0.838 Test Loss: 0.495 Test Acc: 0.838
Validation loss decreased (-0.803462 --> -0.838145).  Saving model ...
Epoch: 12 cost time: 5.388331890106201
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.698284864425659
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.827 Test Loss: 0.529 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.465588569641113
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.832 Test Loss: 0.561 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.195140361785889
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.827 Test Loss: 0.567 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.351566553115845
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.832 Test Loss: 0.562 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.556659936904907
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.827 Test Loss: 0.574 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.508157253265381
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.821 Test Loss: 0.573 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.446529865264893
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.395140171051025
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.821 Test Loss: 0.597 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.629124402999878
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.821 Test Loss: 0.596 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 75840007
model size : 303.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.561929702758789
Epoch: 1, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.561 Vali Acc: 0.329 Test Loss: 1.561 Test Acc: 0.329
Validation loss decreased (inf --> -0.329464).  Saving model ...
Epoch: 2 cost time: 5.996170282363892
Epoch: 2, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.329464 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 6.047726631164551
Epoch: 3, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.837 Vali Acc: 0.676 Test Loss: 0.837 Test Acc: 0.676
Validation loss decreased (-0.485537 --> -0.676292).  Saving model ...
Epoch: 4 cost time: 5.880048036575317
Epoch: 4, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.733 Vali Acc: 0.676 Test Loss: 0.733 Test Acc: 0.676
Validation loss decreased (-0.676292 --> -0.676293).  Saving model ...
Epoch: 5 cost time: 5.899288177490234
Epoch: 5, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.324 Vali Acc: 0.526 Test Loss: 1.324 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.902957439422607
Epoch: 6, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.987 Vali Acc: 0.688 Test Loss: 0.987 Test Acc: 0.688
Validation loss decreased (-0.676293 --> -0.687851).  Saving model ...
Epoch: 7 cost time: 4.341403961181641
Epoch: 7, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
Validation loss decreased (-0.687851 --> -0.762999).  Saving model ...
Epoch: 8 cost time: 5.5403618812561035
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
Validation loss decreased (-0.762999 --> -0.809242).  Saving model ...
Epoch: 9 cost time: 6.120126247406006
Epoch: 9, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.136 Vali Acc: 0.740 Test Loss: 1.136 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.346330165863037
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.137 Vali Acc: 0.734 Test Loss: 1.137 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.0868611335754395
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.705 Vali Acc: 0.815 Test Loss: 0.705 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815022).  Saving model ...
Epoch: 12 cost time: 6.098886013031006
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.512511491775513
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.875 Vali Acc: 0.792 Test Loss: 0.875 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.961912393569946
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.604 Vali Acc: 0.705 Test Loss: 1.604 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.145948171615601
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.434 Vali Acc: 0.809 Test Loss: 1.434 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.193005561828613
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.161 Vali Acc: 0.792 Test Loss: 1.161 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.4000067710876465
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.023 Vali Acc: 0.803 Test Loss: 1.023 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.266191005706787
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.798 Test Loss: 0.984 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.105906963348389
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.798 Test Loss: 0.985 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.135524034500122
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.005 Vali Acc: 0.815 Test Loss: 1.005 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.405952215194702
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.815 Test Loss: 1.013 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 82599943
model size : 329.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.3998494148254395
Epoch: 1, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.415 Vali Acc: 0.353 Test Loss: 1.415 Test Acc: 0.353
Validation loss decreased (inf --> -0.352587).  Saving model ...
Epoch: 2 cost time: 5.467031002044678
Epoch: 2, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.047 Vali Acc: 0.584 Test Loss: 1.047 Test Acc: 0.584
Validation loss decreased (-0.352587 --> -0.583805).  Saving model ...
Epoch: 3 cost time: 5.122487306594849
Epoch: 3, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.017 Vali Acc: 0.584 Test Loss: 1.017 Test Acc: 0.584
Validation loss decreased (-0.583805 --> -0.583805).  Saving model ...
Epoch: 4 cost time: 5.666098594665527
Epoch: 4, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.716 Vali Acc: 0.723 Test Loss: 0.716 Test Acc: 0.723
Validation loss decreased (-0.583805 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 5.89277982711792
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.039 Vali Acc: 0.705 Test Loss: 1.039 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.74920916557312
Epoch: 6, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.910 Vali Acc: 0.717 Test Loss: 0.910 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.709502458572388
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774561).  Saving model ...
Epoch: 8 cost time: 5.64518928527832
Epoch: 8, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.753 Vali Acc: 0.792 Test Loss: 0.753 Test Acc: 0.792
Validation loss decreased (-0.774561 --> -0.791900).  Saving model ...
Epoch: 9 cost time: 5.774842023849487
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.003 Vali Acc: 0.740 Test Loss: 1.003 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.592996120452881
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.718 Vali Acc: 0.769 Test Loss: 0.718 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.661358594894409
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.777 Vali Acc: 0.809 Test Loss: 0.777 Test Acc: 0.809
Validation loss decreased (-0.791900 --> -0.809241).  Saving model ...
Epoch: 12 cost time: 5.50820255279541
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.473 Vali Acc: 0.821 Test Loss: 0.473 Test Acc: 0.821
Validation loss decreased (-0.809241 --> -0.820805).  Saving model ...
Epoch: 13 cost time: 5.472765207290649
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.446 Vali Acc: 0.844 Test Loss: 0.446 Test Acc: 0.844
Validation loss decreased (-0.820805 --> -0.843926).  Saving model ...
Epoch: 14 cost time: 5.746819496154785
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.511 Vali Acc: 0.809 Test Loss: 0.511 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.551223516464233
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.832 Test Loss: 0.442 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.451717138290405
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.844 Test Loss: 0.433 Test Acc: 0.844
Validation loss decreased (-0.843926 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 6.091782331466675
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
Validation loss decreased (-0.843926 --> -0.867048).  Saving model ...
Epoch: 18 cost time: 6.492068767547607
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.247833728790283
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.043095588684082
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.338573932647705
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.458 Vali Acc: 0.855 Test Loss: 0.458 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.500787734985352
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.855 Test Loss: 0.461 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.693052530288696
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.861 Test Loss: 0.462 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.338460445404053
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.576940298080444
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.855 Test Loss: 0.482 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.618654489517212
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.512188673019409
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 82530823
model size : 329.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.40457034111023
Epoch: 1, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.322 Vali Acc: 0.474 Test Loss: 1.322 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 6.373786449432373
Epoch: 2, Steps: 17 | Train Loss: 1.122 Vali Loss: 0.961 Vali Acc: 0.590 Test Loss: 0.961 Test Acc: 0.590
Validation loss decreased (-0.473975 --> -0.589586).  Saving model ...
Epoch: 3 cost time: 6.023809194564819
Epoch: 3, Steps: 17 | Train Loss: 0.771 Vali Loss: 0.987 Vali Acc: 0.601 Test Loss: 0.987 Test Acc: 0.601
Validation loss decreased (-0.589586 --> -0.601146).  Saving model ...
Epoch: 4 cost time: 6.181264162063599
Epoch: 4, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.976 Vali Acc: 0.566 Test Loss: 0.976 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.2889769077301025
Epoch: 5, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
Validation loss decreased (-0.601146 --> -0.803462).  Saving model ...
Epoch: 6 cost time: 5.990220308303833
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.490 Vali Acc: 0.821 Test Loss: 0.490 Test Acc: 0.821
Validation loss decreased (-0.803462 --> -0.820804).  Saving model ...
Epoch: 7 cost time: 5.624534845352173
Epoch: 7, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.597 Vali Acc: 0.792 Test Loss: 0.597 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.039218902587891
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.781 Vali Acc: 0.775 Test Loss: 0.781 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.756967782974243
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.662 Vali Acc: 0.786 Test Loss: 0.662 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.585751056671143
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.792 Vali Acc: 0.838 Test Loss: 0.792 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838142).  Saving model ...
Epoch: 11 cost time: 6.063358306884766
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.704 Vali Acc: 0.757 Test Loss: 0.704 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.385485649108887
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.498 Vali Acc: 0.815 Test Loss: 0.498 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.110735654830933
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.654 Vali Acc: 0.786 Test Loss: 0.654 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.981068849563599
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.028375148773193
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.571 Vali Acc: 0.798 Test Loss: 0.571 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.202855110168457
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.622 Vali Acc: 0.798 Test Loss: 0.622 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.061850070953369
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.803 Test Loss: 0.633 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.071545124053955
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.348599195480347
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.809 Test Loss: 0.638 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.32880163192749
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 82496263
model size : 329.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.716331958770752
Epoch: 1, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.459 Vali Acc: 0.399 Test Loss: 1.459 Test Acc: 0.399
Validation loss decreased (inf --> -0.398829).  Saving model ...
Epoch: 2 cost time: 9.164919376373291
Epoch: 2, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.004 Vali Acc: 0.642 Test Loss: 1.004 Test Acc: 0.642
Validation loss decreased (-0.398829 --> -0.641608).  Saving model ...
Epoch: 3 cost time: 9.954633712768555
Epoch: 3, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.961 Vali Acc: 0.647 Test Loss: 0.961 Test Acc: 0.647
Validation loss decreased (-0.641608 --> -0.647389).  Saving model ...
Epoch: 4 cost time: 9.180853128433228
Epoch: 4, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.868 Vali Acc: 0.647 Test Loss: 0.868 Test Acc: 0.647
Validation loss decreased (-0.647389 --> -0.647390).  Saving model ...
Epoch: 5 cost time: 9.064041376113892
Epoch: 5, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.723 Vali Acc: 0.723 Test Loss: 0.723 Test Acc: 0.723
Validation loss decreased (-0.647390 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 10.152628421783447
Epoch: 6, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.811 Vali Acc: 0.717 Test Loss: 0.811 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.491991996765137
Epoch: 7, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.143 Vali Acc: 0.699 Test Loss: 1.143 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.706933975219727
Epoch: 8, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.792 Vali Acc: 0.769 Test Loss: 0.792 Test Acc: 0.769
Validation loss decreased (-0.722536 --> -0.768778).  Saving model ...
Epoch: 9 cost time: 9.993513107299805
Epoch: 9, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
Validation loss decreased (-0.768778 --> -0.803462).  Saving model ...
Epoch: 10 cost time: 9.6659255027771
Epoch: 10, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.686 Vali Acc: 0.769 Test Loss: 0.686 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.975522994995117
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 9.68748950958252
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.423017501831055
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.826435565948486
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 8.662306547164917
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.815 Test Loss: 0.613 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.209625720977783
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.175518989562988
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.531486988067627
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.036458730697632
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.815 Test Loss: 0.641 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 11.202991962432861
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 11.664705276489258
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 11.838282108306885
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.526143074035645
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.815 Test Loss: 0.667 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 12.35942554473877
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 93652231
model size : 371.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.335531949996948
Epoch: 1, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.474 Vali Acc: 0.324 Test Loss: 1.474 Test Acc: 0.324
Validation loss decreased (inf --> -0.323685).  Saving model ...
Epoch: 2 cost time: 11.864808320999146
Epoch: 2, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.071 Vali Acc: 0.555 Test Loss: 1.071 Test Acc: 0.555
Validation loss decreased (-0.323685 --> -0.554903).  Saving model ...
Epoch: 3 cost time: 11.432515621185303
Epoch: 3, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.065 Vali Acc: 0.711 Test Loss: 1.065 Test Acc: 0.711
Validation loss decreased (-0.554903 --> -0.710972).  Saving model ...
Epoch: 4 cost time: 11.159948110580444
Epoch: 4, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.892 Vali Acc: 0.694 Test Loss: 0.892 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.746025323867798
Epoch: 5, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.789 Vali Acc: 0.699 Test Loss: 0.789 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.078685522079468
Epoch: 6, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.710972 --> -0.757219).  Saving model ...
Epoch: 7 cost time: 10.55242133140564
Epoch: 7, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.636 Vali Acc: 0.792 Test Loss: 0.636 Test Acc: 0.792
Validation loss decreased (-0.757219 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 10.969650030136108
Epoch: 8, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 11.057852029800415
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.684 Vali Acc: 0.763 Test Loss: 0.684 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.387521505355835
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.21935486793518
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.571 Vali Acc: 0.815 Test Loss: 0.571 Test Acc: 0.815
Validation loss decreased (-0.803462 --> -0.815023).  Saving model ...
Epoch: 12 cost time: 11.2864830493927
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.89344573020935
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.668 Vali Acc: 0.780 Test Loss: 0.668 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.878675699234009
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.798 Test Loss: 0.638 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.239234924316406
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.821 Test Loss: 0.612 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820803).  Saving model ...
Epoch: 16 cost time: 12.02482557296753
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.821 Test Loss: 0.652 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 11.664278984069824
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.815 Test Loss: 0.648 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.702386379241943
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 11.414734363555908
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.803 Test Loss: 0.691 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.614767074584961
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.815 Test Loss: 0.666 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.9168221950531
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.827 Test Loss: 0.669 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826583).  Saving model ...
Epoch: 22 cost time: 10.336386442184448
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.821 Test Loss: 0.677 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.263840913772583
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.815 Test Loss: 0.678 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.189987659454346
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.815 Test Loss: 0.688 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 10.55183458328247
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.815 Test Loss: 0.685 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.054949045181274
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.815 Test Loss: 0.695 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.28761100769043
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 11.33432149887085
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.803 Test Loss: 0.698 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 10.869598865509033
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.798 Test Loss: 0.704 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 10.46473503112793
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.798 Test Loss: 0.702 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 10.920504808425903
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 93603847
model size : 371.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.537980079650879
Epoch: 1, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.358 Vali Acc: 0.445 Test Loss: 1.358 Test Acc: 0.445
Validation loss decreased (inf --> -0.445073).  Saving model ...
Epoch: 2 cost time: 11.567859172821045
Epoch: 2, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.018 Vali Acc: 0.630 Test Loss: 1.018 Test Acc: 0.630
Validation loss decreased (-0.445073 --> -0.630048).  Saving model ...
Epoch: 3 cost time: 10.348606824874878
Epoch: 3, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.791 Vali Acc: 0.630 Test Loss: 0.791 Test Acc: 0.630
Validation loss decreased (-0.630048 --> -0.630050).  Saving model ...
Epoch: 4 cost time: 10.579882860183716
Epoch: 4, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
Validation loss decreased (-0.630050 --> -0.809243).  Saving model ...
Epoch: 5 cost time: 11.225713968276978
Epoch: 5, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.670 Vali Acc: 0.769 Test Loss: 0.670 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.756410360336304
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.657 Vali Acc: 0.780 Test Loss: 0.657 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.459292888641357
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.519 Vali Acc: 0.844 Test Loss: 0.519 Test Acc: 0.844
Validation loss decreased (-0.809243 --> -0.843925).  Saving model ...
Epoch: 8 cost time: 11.097535371780396
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.559 Vali Acc: 0.798 Test Loss: 0.559 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.918223142623901
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.310485601425171
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.475 Vali Acc: 0.821 Test Loss: 0.475 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.833895683288574
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.501 Vali Acc: 0.815 Test Loss: 0.501 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.287703037261963
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.037763833999634
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.838 Test Loss: 0.506 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.965224504470825
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.838 Test Loss: 0.519 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.563962459564209
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.838 Test Loss: 0.518 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.541885614395142
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.552 Vali Acc: 0.827 Test Loss: 0.552 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.775384902954102
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.832 Test Loss: 0.566 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el4_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 93576199
model size : 371.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.344359874725342
Epoch: 1, Steps: 17 | Train Loss: 1.906 Vali Loss: 1.595 Vali Acc: 0.272 Test Loss: 1.595 Test Acc: 0.272
Validation loss decreased (inf --> -0.271660).  Saving model ...
Epoch: 2 cost time: 4.641003847122192
Epoch: 2, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.200 Vali Acc: 0.526 Test Loss: 1.200 Test Acc: 0.526
Validation loss decreased (-0.271660 --> -0.526000).  Saving model ...
Epoch: 3 cost time: 4.483352422714233
Epoch: 3, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.034 Vali Acc: 0.578 Test Loss: 1.034 Test Acc: 0.578
Validation loss decreased (-0.526000 --> -0.578024).  Saving model ...
Epoch: 4 cost time: 4.3531880378723145
Epoch: 4, Steps: 17 | Train Loss: 0.689 Vali Loss: 1.226 Vali Acc: 0.590 Test Loss: 1.226 Test Acc: 0.590
Validation loss decreased (-0.578024 --> -0.589583).  Saving model ...
Epoch: 5 cost time: 4.440911293029785
Epoch: 5, Steps: 17 | Train Loss: 0.609 Vali Loss: 1.027 Vali Acc: 0.659 Test Loss: 1.027 Test Acc: 0.659
Validation loss decreased (-0.589583 --> -0.658949).  Saving model ...
Epoch: 6 cost time: 4.585123538970947
Epoch: 6, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.754 Vali Acc: 0.740 Test Loss: 0.754 Test Acc: 0.740
Validation loss decreased (-0.658949 --> -0.739877).  Saving model ...
Epoch: 7 cost time: 4.211605548858643
Epoch: 7, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.516 Vali Acc: 0.642 Test Loss: 1.516 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.1987364292144775
Epoch: 8, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
Validation loss decreased (-0.739877 --> -0.838144).  Saving model ...
Epoch: 9 cost time: 4.158321380615234
Epoch: 9, Steps: 17 | Train Loss: 0.290 Vali Loss: 1.020 Vali Acc: 0.775 Test Loss: 1.020 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8113207817077637
Epoch: 10, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.393 Vali Acc: 0.711 Test Loss: 1.393 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.513038396835327
Epoch: 11, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.518 Vali Acc: 0.723 Test Loss: 1.518 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.359403133392334
Epoch: 12, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.451 Vali Acc: 0.740 Test Loss: 1.451 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.581082582473755
Epoch: 13, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.525 Vali Acc: 0.751 Test Loss: 1.525 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.582077503204346
Epoch: 14, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.867 Vali Acc: 0.723 Test Loss: 1.867 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.680144786834717
Epoch: 15, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.029 Vali Acc: 0.769 Test Loss: 1.029 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.417341232299805
Epoch: 16, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.105 Vali Acc: 0.850 Test Loss: 1.105 Test Acc: 0.850
Validation loss decreased (-0.838144 --> -0.849700).  Saving model ...
Epoch: 17 cost time: 4.825619459152222
Epoch: 17, Steps: 17 | Train Loss: 0.103 Vali Loss: 2.117 Vali Acc: 0.763 Test Loss: 2.117 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.258592367172241
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.871 Vali Acc: 0.734 Test Loss: 3.871 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.447479009628296
Epoch: 19, Steps: 17 | Train Loss: 0.200 Vali Loss: 2.614 Vali Acc: 0.746 Test Loss: 2.614 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.128077745437622
Epoch: 20, Steps: 17 | Train Loss: 0.134 Vali Loss: 3.311 Vali Acc: 0.763 Test Loss: 3.311 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.281513690948486
Epoch: 21, Steps: 17 | Train Loss: 0.162 Vali Loss: 2.115 Vali Acc: 0.775 Test Loss: 2.115 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.2176806926727295
Epoch: 22, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.542 Vali Acc: 0.763 Test Loss: 1.542 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.063864707946777
Epoch: 23, Steps: 17 | Train Loss: 0.060 Vali Loss: 2.502 Vali Acc: 0.746 Test Loss: 2.502 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.471013069152832
Epoch: 24, Steps: 17 | Train Loss: 0.032 Vali Loss: 3.211 Vali Acc: 0.746 Test Loss: 3.211 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.630364179611206
Epoch: 25, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.962 Vali Acc: 0.780 Test Loss: 2.962 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.527053594589233
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.407 Vali Acc: 0.780 Test Loss: 2.407 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 35913223
model size : 151.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.9599549770355225
Epoch: 1, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.645 Vali Acc: 0.249 Test Loss: 1.645 Test Acc: 0.249
Validation loss decreased (inf --> -0.248538).  Saving model ...
Epoch: 2 cost time: 3.87986159324646
Epoch: 2, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.472 Vali Acc: 0.393 Test Loss: 1.472 Test Acc: 0.393
Validation loss decreased (-0.248538 --> -0.393049).  Saving model ...
Epoch: 3 cost time: 3.807166814804077
Epoch: 3, Steps: 17 | Train Loss: 1.133 Vali Loss: 0.947 Vali Acc: 0.595 Test Loss: 0.947 Test Acc: 0.595
Validation loss decreased (-0.393049 --> -0.595366).  Saving model ...
Epoch: 4 cost time: 3.7866387367248535
Epoch: 4, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.901 Vali Acc: 0.659 Test Loss: 0.901 Test Acc: 0.659
Validation loss decreased (-0.595366 --> -0.658951).  Saving model ...
Epoch: 5 cost time: 4.098798751831055
Epoch: 5, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.801 Vali Acc: 0.694 Test Loss: 0.801 Test Acc: 0.694
Validation loss decreased (-0.658951 --> -0.693634).  Saving model ...
Epoch: 6 cost time: 4.104455232620239
Epoch: 6, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.962 Vali Acc: 0.688 Test Loss: 0.962 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.274561166763306
Epoch: 7, Steps: 17 | Train Loss: 0.295 Vali Loss: 1.108 Vali Acc: 0.671 Test Loss: 1.108 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.983335494995117
Epoch: 8, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
Validation loss decreased (-0.693634 --> -0.762999).  Saving model ...
Epoch: 9 cost time: 4.160869121551514
Epoch: 9, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.182 Vali Acc: 0.688 Test Loss: 1.182 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.615924835205078
Epoch: 10, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.830 Vali Acc: 0.757 Test Loss: 0.830 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7354822158813477
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.759 Vali Acc: 0.832 Test Loss: 0.759 Test Acc: 0.832
Validation loss decreased (-0.762999 --> -0.832362).  Saving model ...
Epoch: 12 cost time: 3.9987034797668457
Epoch: 12, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.897 Vali Acc: 0.786 Test Loss: 0.897 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9802377223968506
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.089 Vali Acc: 0.786 Test Loss: 1.089 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.189010381698608
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.117 Vali Acc: 0.694 Test Loss: 2.117 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.251406669616699
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.099 Vali Acc: 0.803 Test Loss: 1.099 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.395965576171875
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.084 Vali Acc: 0.775 Test Loss: 1.084 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.379945755004883
Epoch: 17, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.903 Vali Acc: 0.786 Test Loss: 0.903 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.104161024093628
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.978 Vali Acc: 0.798 Test Loss: 0.978 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.050221920013428
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.909 Vali Acc: 0.809 Test Loss: 0.909 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.17758846282959
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.984 Vali Acc: 0.757 Test Loss: 0.984 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.27611517906189
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.892 Vali Acc: 0.763 Test Loss: 0.892 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 35754247
model size : 151.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.282683610916138
Epoch: 1, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.603 Vali Acc: 0.260 Test Loss: 1.603 Test Acc: 0.260
Validation loss decreased (inf --> -0.260100).  Saving model ...
Epoch: 2 cost time: 3.6924455165863037
Epoch: 2, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.211 Vali Acc: 0.457 Test Loss: 1.211 Test Acc: 0.457
Validation loss decreased (-0.260100 --> -0.456635).  Saving model ...
Epoch: 3 cost time: 3.6977784633636475
Epoch: 3, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.983 Vali Acc: 0.578 Test Loss: 0.983 Test Acc: 0.578
Validation loss decreased (-0.456635 --> -0.578025).  Saving model ...
Epoch: 4 cost time: 3.5627810955047607
Epoch: 4, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.999 Vali Acc: 0.624 Test Loss: 0.999 Test Acc: 0.624
Validation loss decreased (-0.578025 --> -0.624267).  Saving model ...
Epoch: 5 cost time: 3.8058359622955322
Epoch: 5, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.667 Vali Acc: 0.786 Test Loss: 0.667 Test Acc: 0.786
Validation loss decreased (-0.624267 --> -0.786120).  Saving model ...
Epoch: 6 cost time: 4.110821008682251
Epoch: 6, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.835 Vali Acc: 0.705 Test Loss: 0.835 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.786159038543701
Epoch: 7, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.901 Vali Acc: 0.688 Test Loss: 0.901 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8783483505249023
Epoch: 8, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.962 Vali Acc: 0.723 Test Loss: 0.962 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.06811785697937
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.268 Vali Acc: 0.699 Test Loss: 1.268 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.118135213851929
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.190 Vali Acc: 0.757 Test Loss: 1.190 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.2201621532440186
Epoch: 11, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.672 Vali Acc: 0.792 Test Loss: 0.672 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791901).  Saving model ...
Epoch: 12 cost time: 4.094860076904297
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.662 Vali Acc: 0.832 Test Loss: 0.662 Test Acc: 0.832
Validation loss decreased (-0.791901 --> -0.832363).  Saving model ...
Epoch: 13 cost time: 4.231081247329712
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.780 Test Loss: 0.726 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5999131202697754
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.732 Vali Acc: 0.821 Test Loss: 0.732 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.514122486114502
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.522669792175293
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.798 Test Loss: 0.709 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8190720081329346
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.809 Test Loss: 0.704 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.955319404602051
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.815 Test Loss: 0.734 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8727591037750244
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.815 Test Loss: 0.750 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.10745644569397
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.809 Test Loss: 0.752 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.086992502212524
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.792 Test Loss: 0.757 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.1787121295928955
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.792 Test Loss: 0.752 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 35595271
model size : 150.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.071467161178589
Epoch: 1, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.500 Vali Acc: 0.364 Test Loss: 1.500 Test Acc: 0.364
Validation loss decreased (inf --> -0.364147).  Saving model ...
Epoch: 2 cost time: 4.950231313705444
Epoch: 2, Steps: 17 | Train Loss: 1.185 Vali Loss: 0.929 Vali Acc: 0.584 Test Loss: 0.929 Test Acc: 0.584
Validation loss decreased (-0.364147 --> -0.583806).  Saving model ...
Epoch: 3 cost time: 4.54571533203125
Epoch: 3, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.533 Vali Acc: 0.370 Test Loss: 1.533 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.026439905166626
Epoch: 4, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.822 Vali Acc: 0.746 Test Loss: 0.822 Test Acc: 0.746
Validation loss decreased (-0.583806 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 4.1070897579193115
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.822 Vali Acc: 0.705 Test Loss: 0.822 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1468682289123535
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.667 Vali Acc: 0.647 Test Loss: 1.667 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.9104979038238525
Epoch: 7, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.901 Vali Acc: 0.688 Test Loss: 0.901 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7616798877716064
Epoch: 8, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.001 Vali Acc: 0.676 Test Loss: 1.001 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.440377950668335
Epoch: 9, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.847 Vali Acc: 0.786 Test Loss: 0.847 Test Acc: 0.786
Validation loss decreased (-0.745657 --> -0.786119).  Saving model ...
Epoch: 10 cost time: 4.192812204360962
Epoch: 10, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.626 Vali Acc: 0.659 Test Loss: 1.626 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.261674165725708
Epoch: 11, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.047 Vali Acc: 0.763 Test Loss: 1.047 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.592355012893677
Epoch: 12, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.193 Vali Acc: 0.815 Test Loss: 1.193 Test Acc: 0.815
Validation loss decreased (-0.786119 --> -0.815017).  Saving model ...
Epoch: 13 cost time: 4.729911804199219
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.285 Vali Acc: 0.740 Test Loss: 1.285 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.71219539642334
Epoch: 14, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.272 Vali Acc: 0.775 Test Loss: 1.272 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.524864435195923
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.223 Vali Acc: 0.832 Test Loss: 1.223 Test Acc: 0.832
Validation loss decreased (-0.815017 --> -0.832358).  Saving model ...
Epoch: 16 cost time: 4.937307834625244
Epoch: 16, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.220 Vali Acc: 0.832 Test Loss: 1.220 Test Acc: 0.832
Validation loss decreased (-0.832358 --> -0.832358).  Saving model ...
Epoch: 17 cost time: 4.165274620056152
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.447 Vali Acc: 0.792 Test Loss: 1.447 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.62639045715332
Epoch: 18, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.888 Vali Acc: 0.775 Test Loss: 1.888 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.32395601272583
Epoch: 19, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.394 Vali Acc: 0.850 Test Loss: 1.394 Test Acc: 0.850
Validation loss decreased (-0.832358 --> -0.849697).  Saving model ...
Epoch: 20 cost time: 4.448646068572998
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.573 Vali Acc: 0.815 Test Loss: 1.573 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.862320899963379
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.887 Vali Acc: 0.769 Test Loss: 1.887 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.878446102142334
Epoch: 22, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.406 Vali Acc: 0.786 Test Loss: 1.406 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.629063606262207
Epoch: 23, Steps: 17 | Train Loss: 0.113 Vali Loss: 3.909 Vali Acc: 0.694 Test Loss: 3.909 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.748244524002075
Epoch: 24, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.472 Vali Acc: 0.786 Test Loss: 1.472 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.233763694763184
Epoch: 25, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.909 Vali Acc: 0.809 Test Loss: 1.909 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.311280012130737
Epoch: 26, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.200 Vali Acc: 0.792 Test Loss: 2.200 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.676670074462891
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.485 Vali Acc: 0.815 Test Loss: 1.485 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.681899785995483
Epoch: 28, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.394 Vali Acc: 0.827 Test Loss: 1.394 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.324063777923584
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.562 Vali Acc: 0.809 Test Loss: 1.562 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 38125063
model size : 160.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.154115438461304
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.596 Vali Acc: 0.289 Test Loss: 1.596 Test Acc: 0.289
Validation loss decreased (inf --> -0.289001).  Saving model ...
Epoch: 2 cost time: 3.534104585647583
Epoch: 2, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.258 Vali Acc: 0.474 Test Loss: 1.258 Test Acc: 0.474
Validation loss decreased (-0.289001 --> -0.473976).  Saving model ...
Epoch: 3 cost time: 3.539637327194214
Epoch: 3, Steps: 17 | Train Loss: 0.766 Vali Loss: 0.773 Vali Acc: 0.728 Test Loss: 0.773 Test Acc: 0.728
Validation loss decreased (-0.473976 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 3.4040629863739014
Epoch: 4, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.973 Vali Acc: 0.659 Test Loss: 0.973 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.43933367729187
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.929 Vali Acc: 0.711 Test Loss: 0.929 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.209073305130005
Epoch: 6, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.923 Vali Acc: 0.653 Test Loss: 0.923 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.388082265853882
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.849 Vali Acc: 0.763 Test Loss: 0.849 Test Acc: 0.763
Validation loss decreased (-0.728316 --> -0.762997).  Saving model ...
Epoch: 8 cost time: 3.5166842937469482
Epoch: 8, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
Validation loss decreased (-0.762997 --> -0.809242).  Saving model ...
Epoch: 9 cost time: 3.675616502761841
Epoch: 9, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.661 Vali Acc: 0.838 Test Loss: 0.661 Test Acc: 0.838
Validation loss decreased (-0.809242 --> -0.838144).  Saving model ...
Epoch: 10 cost time: 3.222551107406616
Epoch: 10, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.174 Vali Acc: 0.711 Test Loss: 1.174 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.410682201385498
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.197 Vali Acc: 0.763 Test Loss: 1.197 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.311577320098877
Epoch: 12, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.669 Vali Acc: 0.746 Test Loss: 1.669 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.326272487640381
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.086 Vali Acc: 0.775 Test Loss: 1.086 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.305413007736206
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.981 Vali Acc: 0.705 Test Loss: 1.981 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.4711759090423584
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.983 Vali Acc: 0.803 Test Loss: 0.983 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.3700709342956543
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.991 Vali Acc: 0.792 Test Loss: 0.991 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.301856517791748
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.423 Vali Acc: 0.809 Test Loss: 1.423 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.3429222106933594
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.761 Vali Acc: 0.751 Test Loss: 1.761 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.106762647628784
Epoch: 19, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.437 Vali Acc: 0.780 Test Loss: 1.437 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 37890055
model size : 159.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.311127185821533
Epoch: 1, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.536 Vali Acc: 0.335 Test Loss: 1.536 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 3.507530927658081
Epoch: 2, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.158 Vali Acc: 0.584 Test Loss: 1.158 Test Acc: 0.584
Validation loss decreased (-0.335245 --> -0.583803).  Saving model ...
Epoch: 3 cost time: 3.6765387058258057
Epoch: 3, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.027 Vali Acc: 0.613 Test Loss: 1.027 Test Acc: 0.613
Validation loss decreased (-0.583803 --> -0.612706).  Saving model ...
Epoch: 4 cost time: 3.300056219100952
Epoch: 4, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.726 Vali Acc: 0.723 Test Loss: 0.726 Test Acc: 0.723
Validation loss decreased (-0.612706 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 3.251494884490967
Epoch: 5, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.769 Vali Acc: 0.763 Test Loss: 0.769 Test Acc: 0.763
Validation loss decreased (-0.722536 --> -0.762998).  Saving model ...
Epoch: 6 cost time: 3.5097920894622803
Epoch: 6, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.760 Vali Acc: 0.699 Test Loss: 0.760 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.219774007797241
Epoch: 7, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.657 Vali Acc: 0.798 Test Loss: 0.657 Test Acc: 0.798
Validation loss decreased (-0.762998 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 3.6338136196136475
Epoch: 8, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.663 Vali Acc: 0.786 Test Loss: 0.663 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.500795364379883
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.070 Vali Acc: 0.705 Test Loss: 1.070 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.498377799987793
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.636 Vali Acc: 0.769 Test Loss: 0.636 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.469831705093384
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803461).  Saving model ...
Epoch: 12 cost time: 3.5476114749908447
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.829 Vali Acc: 0.769 Test Loss: 0.829 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.406665086746216
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.878 Vali Acc: 0.740 Test Loss: 0.878 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7461678981781006
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.862 Vali Acc: 0.792 Test Loss: 0.862 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.682016134262085
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.673 Vali Acc: 0.786 Test Loss: 0.673 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2309908866882324
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.827 Test Loss: 0.637 Test Acc: 0.827
Validation loss decreased (-0.803461 --> -0.826583).  Saving model ...
Epoch: 17 cost time: 3.210813522338867
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.832 Test Loss: 0.640 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832364).  Saving model ...
Epoch: 18 cost time: 3.454251289367676
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.832 Test Loss: 0.598 Test Acc: 0.832
Validation loss decreased (-0.832364 --> -0.832364).  Saving model ...
Epoch: 19 cost time: 3.551858901977539
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.42543363571167
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.821 Test Loss: 0.655 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.407360553741455
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.827 Test Loss: 0.670 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.558580160140991
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.827 Test Loss: 0.688 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.7001774311065674
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.821 Test Loss: 0.702 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.469109296798706
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.821 Test Loss: 0.707 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.63287091255188
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.815 Test Loss: 0.703 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.5003552436828613
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.815 Test Loss: 0.693 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.1920058727264404
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.821 Test Loss: 0.695 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.3557300567626953
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.815 Test Loss: 0.703 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 37786375
model size : 158.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.120307445526123
Epoch: 1, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.565 Vali Acc: 0.243 Test Loss: 1.565 Test Acc: 0.243
Validation loss decreased (inf --> -0.242759).  Saving model ...
Epoch: 2 cost time: 3.8029003143310547
Epoch: 2, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.143 Vali Acc: 0.497 Test Loss: 1.143 Test Acc: 0.497
Validation loss decreased (-0.242759 --> -0.497098).  Saving model ...
Epoch: 3 cost time: 4.052110433578491
Epoch: 3, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.093 Vali Acc: 0.543 Test Loss: 1.093 Test Acc: 0.543
Validation loss decreased (-0.497098 --> -0.543342).  Saving model ...
Epoch: 4 cost time: 3.4930291175842285
Epoch: 4, Steps: 17 | Train Loss: 0.733 Vali Loss: 1.156 Vali Acc: 0.705 Test Loss: 1.156 Test Acc: 0.705
Validation loss decreased (-0.543342 --> -0.705191).  Saving model ...
Epoch: 5 cost time: 4.2117555141448975
Epoch: 5, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.963 Vali Acc: 0.694 Test Loss: 0.963 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9467718601226807
Epoch: 6, Steps: 17 | Train Loss: 0.586 Vali Loss: 1.088 Vali Acc: 0.636 Test Loss: 1.088 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.052138566970825
Epoch: 7, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.043 Vali Acc: 0.717 Test Loss: 1.043 Test Acc: 0.717
Validation loss decreased (-0.705191 --> -0.716753).  Saving model ...
Epoch: 8 cost time: 4.061933755874634
Epoch: 8, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.997 Vali Acc: 0.723 Test Loss: 0.997 Test Acc: 0.723
Validation loss decreased (-0.716753 --> -0.722533).  Saving model ...
Epoch: 9 cost time: 3.9926695823669434
Epoch: 9, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.327 Vali Acc: 0.740 Test Loss: 1.327 Test Acc: 0.740
Validation loss decreased (-0.722533 --> -0.739871).  Saving model ...
Epoch: 10 cost time: 4.140933036804199
Epoch: 10, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.246 Vali Acc: 0.694 Test Loss: 1.246 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8968939781188965
Epoch: 11, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.996 Vali Acc: 0.798 Test Loss: 0.996 Test Acc: 0.798
Validation loss decreased (-0.739871 --> -0.797678).  Saving model ...
Epoch: 12 cost time: 3.9256083965301514
Epoch: 12, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9219601154327393
Epoch: 13, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.113 Vali Acc: 0.671 Test Loss: 2.113 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9929797649383545
Epoch: 14, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.643 Vali Acc: 0.757 Test Loss: 1.643 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.764601945877075
Epoch: 15, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.170 Vali Acc: 0.815 Test Loss: 1.170 Test Acc: 0.815
Validation loss decreased (-0.797678 --> -0.815017).  Saving model ...
Epoch: 16 cost time: 4.011151075363159
Epoch: 16, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.581 Vali Acc: 0.792 Test Loss: 1.581 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.121886730194092
Epoch: 17, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.923 Vali Acc: 0.711 Test Loss: 1.923 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8303184509277344
Epoch: 18, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.000 Vali Acc: 0.838 Test Loss: 1.000 Test Acc: 0.838
Validation loss decreased (-0.815017 --> -0.838140).  Saving model ...
Epoch: 19 cost time: 4.098676443099976
Epoch: 19, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.264 Vali Acc: 0.803 Test Loss: 1.264 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5749151706695557
Epoch: 20, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.393 Vali Acc: 0.803 Test Loss: 1.393 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.068190813064575
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.532 Vali Acc: 0.809 Test Loss: 1.532 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.169086933135986
Epoch: 22, Steps: 17 | Train Loss: 0.104 Vali Loss: 2.137 Vali Acc: 0.798 Test Loss: 2.137 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.240861415863037
Epoch: 23, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.242 Vali Acc: 0.844 Test Loss: 1.242 Test Acc: 0.844
Validation loss decreased (-0.838140 --> -0.843918).  Saving model ...
Epoch: 24 cost time: 4.122597694396973
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.250 Vali Acc: 0.827 Test Loss: 1.250 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1320512294769287
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.289 Vali Acc: 0.798 Test Loss: 1.289 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.446413993835449
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.357 Vali Acc: 0.780 Test Loss: 2.357 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.624868631362915
Epoch: 27, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.318 Vali Acc: 0.867 Test Loss: 1.318 Test Acc: 0.867
Validation loss decreased (-0.843918 --> -0.867039).  Saving model ...
Epoch: 28 cost time: 3.6381213665008545
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.247 Vali Acc: 0.815 Test Loss: 2.247 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.145366191864014
Epoch: 29, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.036 Vali Acc: 0.861 Test Loss: 1.036 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.0246381759643555
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.765 Vali Acc: 0.798 Test Loss: 1.765 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.286162853240967
Epoch: 31, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.396 Vali Acc: 0.827 Test Loss: 1.396 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.837043285369873
Epoch: 32, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.464 Vali Acc: 0.827 Test Loss: 1.464 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.4456846714019775
Epoch: 33, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.614 Vali Acc: 0.792 Test Loss: 1.614 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.3351354598999023
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.832 Test Loss: 1.506 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.714998722076416
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.579 Vali Acc: 0.850 Test Loss: 1.579 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.545423984527588
Epoch: 36, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.987 Vali Acc: 0.815 Test Loss: 1.987 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.989596128463745
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.579 Vali Acc: 0.838 Test Loss: 1.579 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 40343815
model size : 168.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.248734951019287
Epoch: 1, Steps: 17 | Train Loss: 1.877 Vali Loss: 1.437 Vali Acc: 0.462 Test Loss: 1.437 Test Acc: 0.462
Validation loss decreased (inf --> -0.462413).  Saving model ...
Epoch: 2 cost time: 3.21181321144104
Epoch: 2, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.242 Vali Acc: 0.555 Test Loss: 1.242 Test Acc: 0.555
Validation loss decreased (-0.462413 --> -0.554901).  Saving model ...
Epoch: 3 cost time: 3.015782356262207
Epoch: 3, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.177 Vali Acc: 0.566 Test Loss: 1.177 Test Acc: 0.566
Validation loss decreased (-0.554901 --> -0.566462).  Saving model ...
Epoch: 4 cost time: 3.287374258041382
Epoch: 4, Steps: 17 | Train Loss: 0.615 Vali Loss: 1.117 Vali Acc: 0.613 Test Loss: 1.117 Test Acc: 0.613
Validation loss decreased (-0.566462 --> -0.612706).  Saving model ...
Epoch: 5 cost time: 3.286837100982666
Epoch: 5, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.954 Vali Acc: 0.682 Test Loss: 0.954 Test Acc: 0.682
Validation loss decreased (-0.612706 --> -0.682071).  Saving model ...
Epoch: 6 cost time: 3.398503303527832
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.718 Vali Acc: 0.734 Test Loss: 0.718 Test Acc: 0.734
Validation loss decreased (-0.682071 --> -0.734097).  Saving model ...
Epoch: 7 cost time: 3.107259750366211
Epoch: 7, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.932 Vali Acc: 0.751 Test Loss: 0.932 Test Acc: 0.751
Validation loss decreased (-0.734097 --> -0.751436).  Saving model ...
Epoch: 8 cost time: 2.8705198764801025
Epoch: 8, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.609 Vali Acc: 0.821 Test Loss: 0.609 Test Acc: 0.821
Validation loss decreased (-0.751436 --> -0.820803).  Saving model ...
Epoch: 9 cost time: 3.4338417053222656
Epoch: 9, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.908 Vali Acc: 0.803 Test Loss: 0.908 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.890901565551758
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.637 Vali Acc: 0.827 Test Loss: 0.637 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826583).  Saving model ...
Epoch: 11 cost time: 3.146468162536621
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.379 Vali Acc: 0.769 Test Loss: 1.379 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.075801134109497
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.826583 --> -0.849705).  Saving model ...
Epoch: 13 cost time: 3.358099937438965
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.073 Vali Acc: 0.821 Test Loss: 1.073 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2440786361694336
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.123 Vali Acc: 0.803 Test Loss: 1.123 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.231121063232422
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.357 Vali Acc: 0.775 Test Loss: 1.357 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2451257705688477
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.820 Vali Acc: 0.792 Test Loss: 0.820 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.593339443206787
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.302 Vali Acc: 0.798 Test Loss: 1.302 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.5397021770477295
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.198 Vali Acc: 0.740 Test Loss: 2.198 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.450009346008301
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.876 Vali Acc: 0.711 Test Loss: 1.876 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4073688983917236
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.971 Vali Acc: 0.792 Test Loss: 0.971 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.2126314640045166
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.461 Vali Acc: 0.798 Test Loss: 1.461 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.2470452785491943
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.004 Vali Acc: 0.780 Test Loss: 1.004 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 40108807
model size : 167.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.982746601104736
Epoch: 1, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.516 Vali Acc: 0.387 Test Loss: 1.516 Test Acc: 0.387
Validation loss decreased (inf --> -0.387268).  Saving model ...
Epoch: 2 cost time: 3.2422380447387695
Epoch: 2, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.387268 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 3.210876226425171
Epoch: 3, Steps: 17 | Train Loss: 1.021 Vali Loss: 0.901 Vali Acc: 0.665 Test Loss: 0.901 Test Acc: 0.665
Validation loss decreased (-0.485537 --> -0.664731).  Saving model ...
Epoch: 4 cost time: 3.3276820182800293
Epoch: 4, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.831 Vali Acc: 0.642 Test Loss: 0.831 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2117457389831543
Epoch: 5, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.831 Vali Acc: 0.728 Test Loss: 0.831 Test Acc: 0.728
Validation loss decreased (-0.664731 --> -0.728315).  Saving model ...
Epoch: 6 cost time: 3.215015411376953
Epoch: 6, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.739 Vali Acc: 0.728 Test Loss: 0.739 Test Acc: 0.728
Validation loss decreased (-0.728315 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 3.1734280586242676
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.087 Vali Acc: 0.705 Test Loss: 1.087 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.990845203399658
Epoch: 8, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.741 Vali Acc: 0.746 Test Loss: 0.741 Test Acc: 0.746
Validation loss decreased (-0.728316 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 2.988269567489624
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
Validation loss decreased (-0.745657 --> -0.774560).  Saving model ...
Epoch: 10 cost time: 3.2948315143585205
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.728 Vali Acc: 0.780 Test Loss: 0.728 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780340).  Saving model ...
Epoch: 11 cost time: 3.1694679260253906
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.861 Vali Acc: 0.734 Test Loss: 0.861 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.253999710083008
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.601 Vali Acc: 0.780 Test Loss: 0.601 Test Acc: 0.780
Validation loss decreased (-0.780340 --> -0.780341).  Saving model ...
Epoch: 13 cost time: 2.9430861473083496
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.800 Vali Acc: 0.821 Test Loss: 0.800 Test Acc: 0.821
Validation loss decreased (-0.780341 --> -0.820801).  Saving model ...
Epoch: 14 cost time: 2.4948770999908447
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.159 Vali Acc: 0.792 Test Loss: 1.159 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6201260089874268
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.847 Vali Acc: 0.809 Test Loss: 0.847 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.673875093460083
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.854 Vali Acc: 0.803 Test Loss: 0.854 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.44488787651062
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.807 Vali Acc: 0.792 Test Loss: 0.807 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4126882553100586
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.792 Test Loss: 0.798 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.609248638153076
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.882 Vali Acc: 0.798 Test Loss: 0.882 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.614544630050659
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.809 Test Loss: 0.884 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.892148494720459
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.798 Test Loss: 0.845 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.922487497329712
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.798 Test Loss: 0.829 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.7787821292877197
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.798 Test Loss: 0.824 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 39991303
model size : 167.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.470946311950684
Epoch: 1, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.528 Vali Acc: 0.295 Test Loss: 1.528 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 3.7620790004730225
Epoch: 2, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.502 Vali Acc: 0.416 Test Loss: 1.502 Test Acc: 0.416
Validation loss decreased (-0.294782 --> -0.416170).  Saving model ...
Epoch: 3 cost time: 3.79189133644104
Epoch: 3, Steps: 17 | Train Loss: 0.935 Vali Loss: 0.845 Vali Acc: 0.630 Test Loss: 0.845 Test Acc: 0.630
Validation loss decreased (-0.416170 --> -0.630049).  Saving model ...
Epoch: 4 cost time: 3.855719566345215
Epoch: 4, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.925 Vali Acc: 0.665 Test Loss: 0.925 Test Acc: 0.665
Validation loss decreased (-0.630049 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 3.8585333824157715
Epoch: 5, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.699 Vali Acc: 0.734 Test Loss: 0.699 Test Acc: 0.734
Validation loss decreased (-0.664731 --> -0.734097).  Saving model ...
Epoch: 6 cost time: 3.9035909175872803
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 1.049 Vali Acc: 0.699 Test Loss: 1.049 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.775557518005371
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.090 Vali Acc: 0.642 Test Loss: 1.090 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.56433367729187
Epoch: 8, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
Validation loss decreased (-0.734097 --> -0.809242).  Saving model ...
Epoch: 9 cost time: 3.544574737548828
Epoch: 9, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.129 Vali Acc: 0.676 Test Loss: 1.129 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6265575885772705
Epoch: 10, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.752 Vali Acc: 0.827 Test Loss: 0.752 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826582).  Saving model ...
Epoch: 11 cost time: 3.7026207447052
Epoch: 11, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.339 Vali Acc: 0.757 Test Loss: 1.339 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.489147186279297
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.366 Vali Acc: 0.723 Test Loss: 1.366 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5917840003967285
Epoch: 13, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.226 Vali Acc: 0.751 Test Loss: 1.226 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5560789108276367
Epoch: 14, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.291 Vali Acc: 0.711 Test Loss: 1.291 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4909300804138184
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.153 Vali Acc: 0.803 Test Loss: 1.153 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8613595962524414
Epoch: 16, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.725 Vali Acc: 0.728 Test Loss: 1.725 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.7248575687408447
Epoch: 17, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.591 Vali Acc: 0.792 Test Loss: 1.591 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.797473192214966
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.622 Vali Acc: 0.751 Test Loss: 1.622 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.605595588684082
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.737 Vali Acc: 0.757 Test Loss: 1.737 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.577089548110962
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.249 Vali Acc: 0.763 Test Loss: 1.249 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 42403591
model size : 176.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.496264934539795
Epoch: 1, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.490 Vali Acc: 0.277 Test Loss: 1.490 Test Acc: 0.277
Validation loss decreased (inf --> -0.277442).  Saving model ...
Epoch: 2 cost time: 3.633174180984497
Epoch: 2, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.148 Vali Acc: 0.561 Test Loss: 1.148 Test Acc: 0.561
Validation loss decreased (-0.277442 --> -0.560682).  Saving model ...
Epoch: 3 cost time: 3.7262380123138428
Epoch: 3, Steps: 17 | Train Loss: 0.786 Vali Loss: 0.723 Vali Acc: 0.723 Test Loss: 0.723 Test Acc: 0.723
Validation loss decreased (-0.560682 --> -0.722536).  Saving model ...
Epoch: 4 cost time: 3.6165356636047363
Epoch: 4, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.666 Vali Acc: 0.763 Test Loss: 0.666 Test Acc: 0.763
Validation loss decreased (-0.722536 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 3.6140100955963135
Epoch: 5, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.901 Vali Acc: 0.757 Test Loss: 0.901 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4619579315185547
Epoch: 6, Steps: 17 | Train Loss: 0.256 Vali Loss: 1.005 Vali Acc: 0.751 Test Loss: 1.005 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6773221492767334
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.658 Vali Acc: 0.769 Test Loss: 0.658 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 3.4709742069244385
Epoch: 8, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.925 Vali Acc: 0.763 Test Loss: 0.925 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5698912143707275
Epoch: 9, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774558).  Saving model ...
Epoch: 10 cost time: 3.792602062225342
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.044 Vali Acc: 0.798 Test Loss: 1.044 Test Acc: 0.798
Validation loss decreased (-0.774558 --> -0.797677).  Saving model ...
Epoch: 11 cost time: 3.2395670413970947
Epoch: 11, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.317 Vali Acc: 0.746 Test Loss: 1.317 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5302491188049316
Epoch: 12, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.670 Vali Acc: 0.827 Test Loss: 0.670 Test Acc: 0.827
Validation loss decreased (-0.797677 --> -0.826583).  Saving model ...
Epoch: 13 cost time: 3.365394115447998
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.607 Vali Acc: 0.850 Test Loss: 0.607 Test Acc: 0.850
Validation loss decreased (-0.826583 --> -0.849705).  Saving model ...
Epoch: 14 cost time: 3.115946054458618
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.972 Vali Acc: 0.775 Test Loss: 0.972 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.467338800430298
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.758 Vali Acc: 0.798 Test Loss: 0.758 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.350285768508911
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.865 Vali Acc: 0.769 Test Loss: 0.865 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5410079956054688
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.867 Vali Acc: 0.803 Test Loss: 0.867 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5439069271087646
Epoch: 18, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.803 Vali Acc: 0.780 Test Loss: 0.803 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.4592747688293457
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.043 Vali Acc: 0.838 Test Loss: 1.043 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.331686019897461
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.018 Vali Acc: 0.827 Test Loss: 1.018 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.456174373626709
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.796 Vali Acc: 0.798 Test Loss: 0.796 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5397531986236572
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.959 Vali Acc: 0.769 Test Loss: 0.959 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5266385078430176
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.765 Vali Acc: 0.803 Test Loss: 0.765 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 42279175
model size : 175.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.694237470626831
Epoch: 1, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.511 Vali Acc: 0.289 Test Loss: 1.511 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 3.724323034286499
Epoch: 2, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.233 Vali Acc: 0.543 Test Loss: 1.233 Test Acc: 0.543
Validation loss decreased (-0.289002 --> -0.543340).  Saving model ...
Epoch: 3 cost time: 3.5401134490966797
Epoch: 3, Steps: 17 | Train Loss: 0.885 Vali Loss: 0.981 Vali Acc: 0.566 Test Loss: 0.981 Test Acc: 0.566
Validation loss decreased (-0.543340 --> -0.566464).  Saving model ...
Epoch: 4 cost time: 3.631462574005127
Epoch: 4, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.790 Vali Acc: 0.682 Test Loss: 0.790 Test Acc: 0.682
Validation loss decreased (-0.566464 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 3.522287368774414
Epoch: 5, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
Validation loss decreased (-0.682073 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 3.5656797885894775
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.713 Vali Acc: 0.734 Test Loss: 0.713 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.562692403793335
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.647 Vali Acc: 0.786 Test Loss: 0.647 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 3.4861626625061035
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.762 Vali Acc: 0.780 Test Loss: 0.762 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.666594982147217
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.623 Vali Acc: 0.780 Test Loss: 0.623 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.720414161682129
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.744 Vali Acc: 0.775 Test Loss: 0.744 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7712864875793457
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.786121 --> -0.843924).  Saving model ...
Epoch: 12 cost time: 3.609830617904663
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.988 Vali Acc: 0.723 Test Loss: 0.988 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5895588397979736
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.824 Vali Acc: 0.815 Test Loss: 0.824 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.993772029876709
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.879 Vali Acc: 0.775 Test Loss: 0.879 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.864506483078003
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.803 Test Loss: 0.885 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9328665733337402
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.786 Test Loss: 0.893 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.909238576889038
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.792 Test Loss: 0.930 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.579371690750122
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.792 Test Loss: 0.917 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.801506280899048
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.792 Test Loss: 0.916 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.8735458850860596
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.792 Test Loss: 0.922 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.8560574054718018
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.786 Test Loss: 0.908 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 42196231
model size : 175.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.210254430770874
Epoch: 1, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.595 Vali Acc: 0.301 Test Loss: 1.595 Test Acc: 0.301
Validation loss decreased (inf --> -0.300562).  Saving model ...
Epoch: 2 cost time: 4.359591722488403
Epoch: 2, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.167 Vali Acc: 0.445 Test Loss: 1.167 Test Acc: 0.445
Validation loss decreased (-0.300562 --> -0.445075).  Saving model ...
Epoch: 3 cost time: 4.329339981079102
Epoch: 3, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.008 Vali Acc: 0.671 Test Loss: 1.008 Test Acc: 0.671
Validation loss decreased (-0.445075 --> -0.670510).  Saving model ...
Epoch: 4 cost time: 4.0881311893463135
Epoch: 4, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.018 Vali Acc: 0.682 Test Loss: 1.018 Test Acc: 0.682
Validation loss decreased (-0.670510 --> -0.682071).  Saving model ...
Epoch: 5 cost time: 4.53959584236145
Epoch: 5, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.902 Vali Acc: 0.705 Test Loss: 0.902 Test Acc: 0.705
Validation loss decreased (-0.682071 --> -0.705193).  Saving model ...
Epoch: 6 cost time: 4.459744453430176
Epoch: 6, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.882 Vali Acc: 0.711 Test Loss: 0.882 Test Acc: 0.711
Validation loss decreased (-0.705193 --> -0.710974).  Saving model ...
Epoch: 7 cost time: 4.391045331954956
Epoch: 7, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.706 Vali Acc: 0.786 Test Loss: 0.706 Test Acc: 0.786
Validation loss decreased (-0.710974 --> -0.786120).  Saving model ...
Epoch: 8 cost time: 4.527562856674194
Epoch: 8, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.009 Vali Acc: 0.751 Test Loss: 1.009 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.564127445220947
Epoch: 9, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.907 Vali Acc: 0.763 Test Loss: 0.907 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.609814405441284
Epoch: 10, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.231 Vali Acc: 0.751 Test Loss: 1.231 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.514803409576416
Epoch: 11, Steps: 17 | Train Loss: 0.366 Vali Loss: 1.206 Vali Acc: 0.734 Test Loss: 1.206 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.188488960266113
Epoch: 12, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.565 Vali Acc: 0.723 Test Loss: 1.565 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.436554431915283
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.163 Vali Acc: 0.792 Test Loss: 1.163 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791896).  Saving model ...
Epoch: 14 cost time: 4.4521872997283936
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.761 Vali Acc: 0.855 Test Loss: 0.761 Test Acc: 0.855
Validation loss decreased (-0.791896 --> -0.855484).  Saving model ...
Epoch: 15 cost time: 4.58278751373291
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.456 Vali Acc: 0.717 Test Loss: 1.456 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.485201835632324
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.497 Vali Acc: 0.740 Test Loss: 1.497 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.436372756958008
Epoch: 17, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.967 Vali Acc: 0.809 Test Loss: 0.967 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.319173336029053
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.119 Vali Acc: 0.763 Test Loss: 1.119 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.264134407043457
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.198 Vali Acc: 0.832 Test Loss: 1.198 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.315977573394775
Epoch: 20, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.366 Vali Acc: 0.798 Test Loss: 1.366 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.2336461544036865
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.112 Vali Acc: 0.832 Test Loss: 1.112 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.431241750717163
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.056 Vali Acc: 0.821 Test Loss: 1.056 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.114665985107422
Epoch: 23, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.425 Vali Acc: 0.786 Test Loss: 1.425 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.36746883392334
Epoch: 24, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.037 Vali Acc: 0.751 Test Loss: 2.037 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 44615431
model size : 184.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.968290090560913
Epoch: 1, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.565 Vali Acc: 0.376 Test Loss: 1.565 Test Acc: 0.376
Validation loss decreased (inf --> -0.375707).  Saving model ...
Epoch: 2 cost time: 3.8563201427459717
Epoch: 2, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.169 Vali Acc: 0.445 Test Loss: 1.169 Test Acc: 0.445
Validation loss decreased (-0.375707 --> -0.445075).  Saving model ...
Epoch: 3 cost time: 3.89485502243042
Epoch: 3, Steps: 17 | Train Loss: 0.917 Vali Loss: 0.991 Vali Acc: 0.549 Test Loss: 0.991 Test Acc: 0.549
Validation loss decreased (-0.445075 --> -0.549123).  Saving model ...
Epoch: 4 cost time: 3.917232036590576
Epoch: 4, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.758 Vali Acc: 0.705 Test Loss: 0.758 Test Acc: 0.705
Validation loss decreased (-0.549123 --> -0.705195).  Saving model ...
Epoch: 5 cost time: 3.923013687133789
Epoch: 5, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.922 Vali Acc: 0.624 Test Loss: 0.922 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.847688913345337
Epoch: 6, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.594 Vali Acc: 0.809 Test Loss: 0.594 Test Acc: 0.809
Validation loss decreased (-0.705195 --> -0.809243).  Saving model ...
Epoch: 7 cost time: 3.9633495807647705
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.942 Vali Acc: 0.676 Test Loss: 0.942 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.412597179412842
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.143 Vali Acc: 0.751 Test Loss: 1.143 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.092361211776733
Epoch: 9, Steps: 17 | Train Loss: 0.312 Vali Loss: 1.075 Vali Acc: 0.740 Test Loss: 1.075 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.297840118408203
Epoch: 10, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.801 Vali Acc: 0.757 Test Loss: 0.801 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.297243356704712
Epoch: 11, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.834 Vali Acc: 0.780 Test Loss: 0.834 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.2892820835113525
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.668 Vali Acc: 0.832 Test Loss: 0.668 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832363).  Saving model ...
Epoch: 13 cost time: 4.26264500617981
Epoch: 13, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.836 Vali Acc: 0.809 Test Loss: 0.836 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.3963329792022705
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.097 Vali Acc: 0.798 Test Loss: 1.097 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9738569259643555
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.036 Vali Acc: 0.775 Test Loss: 1.036 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.337713718414307
Epoch: 16, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.846 Vali Acc: 0.775 Test Loss: 0.846 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.081470251083374
Epoch: 17, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.019 Vali Acc: 0.815 Test Loss: 1.019 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.6217803955078125
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.925 Vali Acc: 0.809 Test Loss: 0.925 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.754652261734009
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.242 Vali Acc: 0.786 Test Loss: 1.242 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4243788719177246
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.065 Vali Acc: 0.798 Test Loss: 1.065 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.435676336288452
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.850 Vali Acc: 0.821 Test Loss: 0.850 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.7600364685058594
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.821 Test Loss: 0.695 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 44491015
model size : 184.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.6923911571502686
Epoch: 1, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.588 Vali Acc: 0.249 Test Loss: 1.588 Test Acc: 0.249
Validation loss decreased (inf --> -0.248539).  Saving model ...
Epoch: 2 cost time: 3.4746956825256348
Epoch: 2, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.326 Vali Acc: 0.428 Test Loss: 1.326 Test Acc: 0.428
Validation loss decreased (-0.248539 --> -0.427732).  Saving model ...
Epoch: 3 cost time: 3.543743371963501
Epoch: 3, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.029 Vali Acc: 0.561 Test Loss: 1.029 Test Acc: 0.561
Validation loss decreased (-0.427732 --> -0.560683).  Saving model ...
Epoch: 4 cost time: 4.020974636077881
Epoch: 4, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.942 Vali Acc: 0.636 Test Loss: 0.942 Test Acc: 0.636
Validation loss decreased (-0.560683 --> -0.635829).  Saving model ...
Epoch: 5 cost time: 3.851370334625244
Epoch: 5, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.737 Vali Acc: 0.694 Test Loss: 0.737 Test Acc: 0.694
Validation loss decreased (-0.635829 --> -0.693634).  Saving model ...
Epoch: 6 cost time: 3.862339735031128
Epoch: 6, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.710 Vali Acc: 0.699 Test Loss: 0.710 Test Acc: 0.699
Validation loss decreased (-0.693634 --> -0.699415).  Saving model ...
Epoch: 7 cost time: 3.374789237976074
Epoch: 7, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
Validation loss decreased (-0.699415 --> -0.757219).  Saving model ...
Epoch: 8 cost time: 4.073686361312866
Epoch: 8, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.648 Vali Acc: 0.780 Test Loss: 0.648 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780340).  Saving model ...
Epoch: 9 cost time: 4.133863210678101
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.010 Vali Acc: 0.740 Test Loss: 1.010 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.002765893936157
Epoch: 10, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
Validation loss decreased (-0.780340 --> -0.803461).  Saving model ...
Epoch: 11 cost time: 3.7508060932159424
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.659 Vali Acc: 0.798 Test Loss: 0.659 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3598947525024414
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.658 Vali Acc: 0.786 Test Loss: 0.658 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.798307180404663
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.796 Vali Acc: 0.786 Test Loss: 0.796 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.264617443084717
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.856 Vali Acc: 0.792 Test Loss: 0.856 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.108748912811279
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.673 Vali Acc: 0.786 Test Loss: 0.673 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.304167032241821
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.860 Vali Acc: 0.751 Test Loss: 0.860 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.9567346572875977
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.780 Test Loss: 0.715 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.880882740020752
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.792 Test Loss: 0.676 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.093462944030762
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.786 Test Loss: 0.678 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.313625335693359
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.798 Test Loss: 0.700 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 44401159
model size : 184.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.505538702011108
Epoch: 1, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.533 Vali Acc: 0.353 Test Loss: 1.533 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 4.85322380065918
Epoch: 2, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.334 Vali Acc: 0.503 Test Loss: 1.334 Test Acc: 0.503
Validation loss decreased (-0.352586 --> -0.502877).  Saving model ...
Epoch: 3 cost time: 4.801363229751587
Epoch: 3, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.899 Vali Acc: 0.647 Test Loss: 0.899 Test Acc: 0.647
Validation loss decreased (-0.502877 --> -0.647390).  Saving model ...
Epoch: 4 cost time: 4.469187021255493
Epoch: 4, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
Validation loss decreased (-0.647390 --> -0.716756).  Saving model ...
Epoch: 5 cost time: 4.924668073654175
Epoch: 5, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.688 Vali Acc: 0.757 Test Loss: 0.688 Test Acc: 0.757
Validation loss decreased (-0.716756 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 4.6527159214019775
Epoch: 6, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.021 Vali Acc: 0.751 Test Loss: 1.021 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.799873113632202
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.012 Vali Acc: 0.740 Test Loss: 1.012 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.999555349349976
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
Validation loss decreased (-0.757219 --> -0.803461).  Saving model ...
Epoch: 9 cost time: 4.910589694976807
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.955 Vali Acc: 0.803 Test Loss: 0.955 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.964728832244873
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.712 Vali Acc: 0.699 Test Loss: 1.712 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.289650201797485
Epoch: 11, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.967 Vali Acc: 0.792 Test Loss: 0.967 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.230258226394653
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.013 Vali Acc: 0.734 Test Loss: 1.013 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.945592641830444
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.984 Vali Acc: 0.792 Test Loss: 0.984 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.841598987579346
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.113 Vali Acc: 0.775 Test Loss: 1.113 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.703213930130005
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.128 Vali Acc: 0.694 Test Loss: 2.128 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.901460409164429
Epoch: 16, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.920 Vali Acc: 0.821 Test Loss: 0.920 Test Acc: 0.821
Validation loss decreased (-0.803461 --> -0.820800).  Saving model ...
Epoch: 17 cost time: 4.660555839538574
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.486 Vali Acc: 0.763 Test Loss: 1.486 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.7132720947265625
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.909 Vali Acc: 0.786 Test Loss: 0.909 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.950109481811523
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.714 Vali Acc: 0.775 Test Loss: 1.714 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.97841477394104
Epoch: 20, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.166 Vali Acc: 0.734 Test Loss: 1.166 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.9352052211761475
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.337 Vali Acc: 0.815 Test Loss: 1.337 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.829512596130371
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.078 Vali Acc: 0.763 Test Loss: 2.078 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.775083303451538
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.078 Vali Acc: 0.815 Test Loss: 1.078 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.78864860534668
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.838 Test Loss: 0.997 Test Acc: 0.838
Validation loss decreased (-0.820800 --> -0.838140).  Saving model ...
Epoch: 25 cost time: 4.35729718208313
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.838 Test Loss: 0.958 Test Acc: 0.838
Validation loss decreased (-0.838140 --> -0.838141).  Saving model ...
Epoch: 26 cost time: 4.4024574756622314
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.844 Test Loss: 0.958 Test Acc: 0.844
Validation loss decreased (-0.838141 --> -0.843921).  Saving model ...
Epoch: 27 cost time: 4.665159702301025
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.844 Test Loss: 0.967 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.63824987411499
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.977 Vali Acc: 0.844 Test Loss: 0.977 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.453192472457886
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.844 Test Loss: 0.981 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.672478437423706
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.979 Vali Acc: 0.844 Test Loss: 0.979 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.5725297927856445
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.844 Test Loss: 0.985 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.60580849647522
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.844 Test Loss: 0.992 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.722168207168579
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.844 Test Loss: 0.992 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.4969353675842285
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.844 Test Loss: 0.991 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.619534730911255
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.844 Test Loss: 0.989 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.2462170124053955
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.844 Test Loss: 0.995 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 46834183
model size : 193.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.961182117462158
Epoch: 1, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.519 Vali Acc: 0.376 Test Loss: 1.519 Test Acc: 0.376
Validation loss decreased (inf --> -0.375707).  Saving model ...
Epoch: 2 cost time: 4.7141664028167725
Epoch: 2, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.129 Vali Acc: 0.445 Test Loss: 1.129 Test Acc: 0.445
Validation loss decreased (-0.375707 --> -0.445075).  Saving model ...
Epoch: 3 cost time: 4.787256479263306
Epoch: 3, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.926 Vali Acc: 0.647 Test Loss: 0.926 Test Acc: 0.647
Validation loss decreased (-0.445075 --> -0.647390).  Saving model ...
Epoch: 4 cost time: 4.768932819366455
Epoch: 4, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.955 Vali Acc: 0.630 Test Loss: 0.955 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.514629125595093
Epoch: 5, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.733 Vali Acc: 0.757 Test Loss: 0.733 Test Acc: 0.757
Validation loss decreased (-0.647390 --> -0.757218).  Saving model ...
Epoch: 6 cost time: 4.676527976989746
Epoch: 6, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.843 Vali Acc: 0.717 Test Loss: 0.843 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.608310222625732
Epoch: 7, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
Validation loss decreased (-0.757218 --> -0.803461).  Saving model ...
Epoch: 8 cost time: 4.78776478767395
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.693 Vali Acc: 0.780 Test Loss: 0.693 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.653352499008179
Epoch: 9, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.593 Vali Acc: 0.827 Test Loss: 0.593 Test Acc: 0.827
Validation loss decreased (-0.803461 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 3.6106302738189697
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.680 Vali Acc: 0.821 Test Loss: 0.680 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.163183689117432
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.746 Vali Acc: 0.832 Test Loss: 0.746 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832362).  Saving model ...
Epoch: 12 cost time: 4.4442219734191895
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.082 Vali Acc: 0.763 Test Loss: 1.082 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.468937397003174
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.914 Vali Acc: 0.699 Test Loss: 0.914 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.6176347732543945
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.353 Vali Acc: 0.792 Test Loss: 1.353 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.488624572753906
Epoch: 15, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.818 Vali Acc: 0.838 Test Loss: 0.818 Test Acc: 0.838
Validation loss decreased (-0.832362 --> -0.838142).  Saving model ...
Epoch: 16 cost time: 4.41861629486084
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.348 Vali Acc: 0.757 Test Loss: 1.348 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.582990407943726
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.966 Vali Acc: 0.780 Test Loss: 0.966 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.659958839416504
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.950 Vali Acc: 0.792 Test Loss: 0.950 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.380908727645874
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.832 Test Loss: 0.735 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.272707462310791
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.827 Test Loss: 0.765 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.5584845542907715
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.533043384552002
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.815 Test Loss: 0.791 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.434264421463013
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.821 Test Loss: 0.787 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.509361505508423
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.810 Vali Acc: 0.815 Test Loss: 0.810 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.757304430007935
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.805 Vali Acc: 0.809 Test Loss: 0.805 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 46682119
model size : 192.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.819347381591797
Epoch: 1, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.466 Vali Acc: 0.387 Test Loss: 1.466 Test Acc: 0.387
Validation loss decreased (inf --> -0.387269).  Saving model ...
Epoch: 2 cost time: 4.657406330108643
Epoch: 2, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.316 Vali Acc: 0.439 Test Loss: 1.316 Test Acc: 0.439
Validation loss decreased (-0.387269 --> -0.439293).  Saving model ...
Epoch: 3 cost time: 4.70810341835022
Epoch: 3, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.122 Vali Acc: 0.561 Test Loss: 1.122 Test Acc: 0.561
Validation loss decreased (-0.439293 --> -0.560682).  Saving model ...
Epoch: 4 cost time: 4.743573904037476
Epoch: 4, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.787 Vali Acc: 0.688 Test Loss: 0.787 Test Acc: 0.688
Validation loss decreased (-0.560682 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 4.054490089416504
Epoch: 5, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.752 Vali Acc: 0.694 Test Loss: 0.752 Test Acc: 0.694
Validation loss decreased (-0.687853 --> -0.693634).  Saving model ...
Epoch: 6 cost time: 4.336293697357178
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.789 Vali Acc: 0.705 Test Loss: 0.789 Test Acc: 0.705
Validation loss decreased (-0.693634 --> -0.705194).  Saving model ...
Epoch: 7 cost time: 4.366657018661499
Epoch: 7, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
Validation loss decreased (-0.705194 --> -0.855487).  Saving model ...
Epoch: 8 cost time: 4.442801237106323
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.960 Vali Acc: 0.728 Test Loss: 0.960 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.457313537597656
Epoch: 9, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.698 Vali Acc: 0.780 Test Loss: 0.698 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.892681837081909
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.835 Vali Acc: 0.792 Test Loss: 0.835 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9621992111206055
Epoch: 11, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.604 Vali Acc: 0.821 Test Loss: 0.604 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.235564708709717
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.969 Vali Acc: 0.746 Test Loss: 0.969 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.566438436508179
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.660 Vali Acc: 0.757 Test Loss: 0.660 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.4443700313568115
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.537 Vali Acc: 0.798 Test Loss: 0.537 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.384361982345581
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.563 Vali Acc: 0.815 Test Loss: 0.563 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9981789588928223
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.538 Vali Acc: 0.798 Test Loss: 0.538 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.644685745239258
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.798 Test Loss: 0.522 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 46612999
model size : 192.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.48070502281189
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.576 Vali Acc: 0.347 Test Loss: 1.576 Test Acc: 0.347
Validation loss decreased (inf --> -0.346805).  Saving model ...
Epoch: 2 cost time: 4.653990745544434
Epoch: 2, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.086 Vali Acc: 0.595 Test Loss: 1.086 Test Acc: 0.595
Validation loss decreased (-0.346805 --> -0.595365).  Saving model ...
Epoch: 3 cost time: 4.7584874629974365
Epoch: 3, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.077 Vali Acc: 0.607 Test Loss: 1.077 Test Acc: 0.607
Validation loss decreased (-0.595365 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 5.009130954742432
Epoch: 4, Steps: 17 | Train Loss: 0.572 Vali Loss: 1.030 Vali Acc: 0.647 Test Loss: 1.030 Test Acc: 0.647
Validation loss decreased (-0.606926 --> -0.647389).  Saving model ...
Epoch: 5 cost time: 4.703624963760376
Epoch: 5, Steps: 17 | Train Loss: 0.381 Vali Loss: 1.088 Vali Acc: 0.699 Test Loss: 1.088 Test Acc: 0.699
Validation loss decreased (-0.647389 --> -0.699411).  Saving model ...
Epoch: 6 cost time: 4.437870025634766
Epoch: 6, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.905 Vali Acc: 0.711 Test Loss: 0.905 Test Acc: 0.711
Validation loss decreased (-0.699411 --> -0.710974).  Saving model ...
Epoch: 7 cost time: 3.8499794006347656
Epoch: 7, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.053 Vali Acc: 0.711 Test Loss: 1.053 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.369843482971191
Epoch: 8, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.970 Vali Acc: 0.723 Test Loss: 0.970 Test Acc: 0.723
Validation loss decreased (-0.710974 --> -0.722534).  Saving model ...
Epoch: 9 cost time: 4.263294219970703
Epoch: 9, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.852 Vali Acc: 0.769 Test Loss: 0.852 Test Acc: 0.769
Validation loss decreased (-0.722534 --> -0.768778).  Saving model ...
Epoch: 10 cost time: 4.180699348449707
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.977 Vali Acc: 0.780 Test Loss: 0.977 Test Acc: 0.780
Validation loss decreased (-0.768778 --> -0.780337).  Saving model ...
Epoch: 11 cost time: 4.414833307266235
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.989 Vali Acc: 0.792 Test Loss: 0.989 Test Acc: 0.792
Validation loss decreased (-0.780337 --> -0.791898).  Saving model ...
Epoch: 12 cost time: 4.705533266067505
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.916 Vali Acc: 0.786 Test Loss: 0.916 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.660097599029541
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.954 Vali Acc: 0.757 Test Loss: 0.954 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.413194894790649
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.636 Vali Acc: 0.757 Test Loss: 1.636 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.343329668045044
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.150 Vali Acc: 0.780 Test Loss: 1.150 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.393856763839722
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.563 Vali Acc: 0.786 Test Loss: 1.563 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.179293394088745
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.676 Vali Acc: 0.786 Test Loss: 1.676 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.51832914352417
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.798 Test Loss: 1.049 Test Acc: 0.798
Validation loss decreased (-0.791898 --> -0.797677).  Saving model ...
Epoch: 19 cost time: 4.559696197509766
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.803 Test Loss: 0.945 Test Acc: 0.803
Validation loss decreased (-0.797677 --> -0.803459).  Saving model ...
Epoch: 20 cost time: 4.208870887756348
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.798 Test Loss: 0.951 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.55126166343689
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.809 Test Loss: 0.951 Test Acc: 0.809
Validation loss decreased (-0.803459 --> -0.809239).  Saving model ...
Epoch: 22 cost time: 4.64086389541626
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.827 Test Loss: 0.969 Test Acc: 0.827
Validation loss decreased (-0.809239 --> -0.826580).  Saving model ...
Epoch: 23 cost time: 4.698039293289185
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.815 Test Loss: 0.949 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.790006160736084
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.827 Test Loss: 0.962 Test Acc: 0.827
Validation loss decreased (-0.826580 --> -0.826580).  Saving model ...
Epoch: 25 cost time: 4.662701606750488
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.827 Test Loss: 0.973 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.484784126281738
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.827 Test Loss: 0.982 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.7325451374053955
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.815 Test Loss: 0.992 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.670839071273804
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.815 Test Loss: 0.993 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.720475435256958
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.827 Test Loss: 1.015 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.538161993026733
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.827 Test Loss: 1.009 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.8076252937316895
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.821 Test Loss: 1.012 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.788421630859375
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.809 Test Loss: 1.036 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.469401597976685
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.050 Vali Acc: 0.809 Test Loss: 1.050 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.283950567245483
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.056 Vali Acc: 0.809 Test Loss: 1.056 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 49052935
model size : 201.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.155452013015747
Epoch: 1, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.493 Vali Acc: 0.370 Test Loss: 1.493 Test Acc: 0.370
Validation loss decreased (inf --> -0.369927).  Saving model ...
Epoch: 2 cost time: 3.941135883331299
Epoch: 2, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.143 Vali Acc: 0.503 Test Loss: 1.143 Test Acc: 0.503
Validation loss decreased (-0.369927 --> -0.502879).  Saving model ...
Epoch: 3 cost time: 4.431396722793579
Epoch: 3, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.028 Vali Acc: 0.665 Test Loss: 1.028 Test Acc: 0.665
Validation loss decreased (-0.502879 --> -0.664730).  Saving model ...
Epoch: 4 cost time: 4.671226263046265
Epoch: 4, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.593 Vali Acc: 0.775 Test Loss: 0.593 Test Acc: 0.775
Validation loss decreased (-0.664730 --> -0.774561).  Saving model ...
Epoch: 5 cost time: 4.53411865234375
Epoch: 5, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.590 Vali Acc: 0.786 Test Loss: 0.590 Test Acc: 0.786
Validation loss decreased (-0.774561 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 4.7770302295684814
Epoch: 6, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.466548442840576
Epoch: 7, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.772 Vali Acc: 0.757 Test Loss: 0.772 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.506424188613892
Epoch: 8, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.735 Vali Acc: 0.815 Test Loss: 0.735 Test Acc: 0.815
Validation loss decreased (-0.786121 --> -0.815022).  Saving model ...
Epoch: 9 cost time: 4.56081223487854
Epoch: 9, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.031 Vali Acc: 0.682 Test Loss: 1.031 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.66861629486084
Epoch: 10, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.598 Vali Acc: 0.838 Test Loss: 0.598 Test Acc: 0.838
Validation loss decreased (-0.815022 --> -0.838144).  Saving model ...
Epoch: 11 cost time: 4.538031816482544
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.977 Vali Acc: 0.821 Test Loss: 0.977 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.782790899276733
Epoch: 12, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.583 Vali Acc: 0.832 Test Loss: 0.583 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.778313636779785
Epoch: 13, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.842 Vali Acc: 0.786 Test Loss: 0.842 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.569883823394775
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.731 Vali Acc: 0.809 Test Loss: 0.731 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.511544704437256
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.981 Vali Acc: 0.832 Test Loss: 0.981 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.81986665725708
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
Validation loss decreased (-0.838144 --> -0.843924).  Saving model ...
Epoch: 17 cost time: 4.563936710357666
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.596 Vali Acc: 0.855 Test Loss: 0.596 Test Acc: 0.855
Validation loss decreased (-0.843924 --> -0.855485).  Saving model ...
Epoch: 18 cost time: 3.8189375400543213
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.637 Vali Acc: 0.821 Test Loss: 0.637 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.508273124694824
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.821 Test Loss: 0.650 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.58872127532959
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.815 Test Loss: 0.697 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.552694082260132
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.821 Test Loss: 0.729 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.244053840637207
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.821 Test Loss: 0.737 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.183431625366211
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.832 Test Loss: 0.755 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.8643407821655273
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.821 Test Loss: 0.782 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.351374387741089
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.821 Test Loss: 0.775 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.4047863483428955
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.827 Test Loss: 0.783 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.681491851806641
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.788 Vali Acc: 0.827 Test Loss: 0.788 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 48900871
model size : 201.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.273333787918091
Epoch: 1, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.561 Vali Acc: 0.353 Test Loss: 1.561 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 4.172559976577759
Epoch: 2, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.148 Vali Acc: 0.474 Test Loss: 1.148 Test Acc: 0.474
Validation loss decreased (-0.352586 --> -0.473977).  Saving model ...
Epoch: 3 cost time: 4.244020938873291
Epoch: 3, Steps: 17 | Train Loss: 1.059 Vali Loss: 0.950 Vali Acc: 0.561 Test Loss: 0.950 Test Acc: 0.561
Validation loss decreased (-0.473977 --> -0.560684).  Saving model ...
Epoch: 4 cost time: 4.658949613571167
Epoch: 4, Steps: 17 | Train Loss: 0.820 Vali Loss: 0.959 Vali Acc: 0.607 Test Loss: 0.959 Test Acc: 0.607
Validation loss decreased (-0.560684 --> -0.606927).  Saving model ...
Epoch: 5 cost time: 4.708918333053589
Epoch: 5, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.759 Vali Acc: 0.717 Test Loss: 0.759 Test Acc: 0.717
Validation loss decreased (-0.606927 --> -0.716755).  Saving model ...
Epoch: 6 cost time: 4.458979606628418
Epoch: 6, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.716755 --> -0.809243).  Saving model ...
Epoch: 7 cost time: 4.335792779922485
Epoch: 7, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.718534231185913
Epoch: 8, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.666 Vali Acc: 0.780 Test Loss: 0.666 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.290467023849487
Epoch: 9, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.826 Vali Acc: 0.751 Test Loss: 0.826 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.43043851852417
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.627 Vali Acc: 0.798 Test Loss: 0.627 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.633485555648804
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.171414136886597
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.489343643188477
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838144).  Saving model ...
Epoch: 14 cost time: 4.046728134155273
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.821 Test Loss: 0.692 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.203111171722412
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.821 Test Loss: 0.644 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.279020309448242
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.237493515014648
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.821 Test Loss: 0.700 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.2910027503967285
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.815 Test Loss: 0.701 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.46720290184021
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.815 Test Loss: 0.708 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.2391557693481445
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.821 Test Loss: 0.699 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.199907302856445
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.815 Test Loss: 0.687 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.1634039878845215
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.815 Test Loss: 0.689 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.390021085739136
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.821 Test Loss: 0.693 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 48824839
model size : 200.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.900625467300415
Epoch: 1, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.496 Vali Acc: 0.341 Test Loss: 1.496 Test Acc: 0.341
Validation loss decreased (inf --> -0.341026).  Saving model ...
Epoch: 2 cost time: 4.910757064819336
Epoch: 2, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.018 Vali Acc: 0.566 Test Loss: 1.018 Test Acc: 0.566
Validation loss decreased (-0.341026 --> -0.566464).  Saving model ...
Epoch: 3 cost time: 4.951747417449951
Epoch: 3, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.963 Vali Acc: 0.751 Test Loss: 0.963 Test Acc: 0.751
Validation loss decreased (-0.566464 --> -0.751435).  Saving model ...
Epoch: 4 cost time: 5.025096893310547
Epoch: 4, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.282170295715332
Epoch: 5, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.910 Vali Acc: 0.746 Test Loss: 0.910 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.122773170471191
Epoch: 6, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.728 Vali Acc: 0.746 Test Loss: 0.728 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.095396280288696
Epoch: 7, Steps: 17 | Train Loss: 0.226 Vali Loss: 1.171 Vali Acc: 0.711 Test Loss: 1.171 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.099828720092773
Epoch: 8, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.849 Vali Acc: 0.746 Test Loss: 0.849 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.105998992919922
Epoch: 9, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.633 Vali Acc: 0.844 Test Loss: 0.633 Test Acc: 0.844
Validation loss decreased (-0.751435 --> -0.843924).  Saving model ...
Epoch: 10 cost time: 5.275737285614014
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.114 Vali Acc: 0.780 Test Loss: 1.114 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.323516845703125
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.331 Vali Acc: 0.757 Test Loss: 1.331 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.19141411781311
Epoch: 12, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.340843915939331
Epoch: 13, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.188 Vali Acc: 0.815 Test Loss: 1.188 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.0503315925598145
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.861 Vali Acc: 0.792 Test Loss: 0.861 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.125253438949585
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
Validation loss decreased (-0.843924 --> -0.849703).  Saving model ...
Epoch: 16 cost time: 4.90799355506897
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.787 Vali Acc: 0.815 Test Loss: 0.787 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.092569589614868
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.943 Vali Acc: 0.809 Test Loss: 0.943 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.0744500160217285
Epoch: 18, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.847 Vali Acc: 0.798 Test Loss: 0.847 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.043083667755127
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.120 Vali Acc: 0.769 Test Loss: 1.120 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.963300943374634
Epoch: 20, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.364 Vali Acc: 0.757 Test Loss: 1.364 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.169806241989136
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.194 Vali Acc: 0.780 Test Loss: 1.194 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.931864261627197
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.068 Vali Acc: 0.757 Test Loss: 1.068 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.016900539398193
Epoch: 23, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.112 Vali Acc: 0.821 Test Loss: 1.112 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.908486366271973
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.261 Vali Acc: 0.821 Test Loss: 1.261 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.885182857513428
Epoch: 25, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.778 Vali Acc: 0.844 Test Loss: 0.778 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 53407495
model size : 218.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.137848138809204
Epoch: 1, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.590 Vali Acc: 0.277 Test Loss: 1.590 Test Acc: 0.277
Validation loss decreased (inf --> -0.277441).  Saving model ...
Epoch: 2 cost time: 4.9985575675964355
Epoch: 2, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.188 Vali Acc: 0.607 Test Loss: 1.188 Test Acc: 0.607
Validation loss decreased (-0.277441 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 5.198779106140137
Epoch: 3, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.750 Vali Acc: 0.711 Test Loss: 0.750 Test Acc: 0.711
Validation loss decreased (-0.606925 --> -0.710975).  Saving model ...
Epoch: 4 cost time: 5.508594274520874
Epoch: 4, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.799 Vali Acc: 0.699 Test Loss: 0.799 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.371694087982178
Epoch: 5, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.751 Vali Acc: 0.740 Test Loss: 0.751 Test Acc: 0.740
Validation loss decreased (-0.710975 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 5.444507360458374
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.902 Vali Acc: 0.746 Test Loss: 0.902 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745656).  Saving model ...
Epoch: 7 cost time: 5.225581884384155
Epoch: 7, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.891 Vali Acc: 0.746 Test Loss: 0.891 Test Acc: 0.746
Validation loss decreased (-0.745656 --> -0.745656).  Saving model ...
Epoch: 8 cost time: 5.5114967823028564
Epoch: 8, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.838 Vali Acc: 0.763 Test Loss: 0.838 Test Acc: 0.763
Validation loss decreased (-0.745656 --> -0.762997).  Saving model ...
Epoch: 9 cost time: 5.290054082870483
Epoch: 9, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.847 Vali Acc: 0.786 Test Loss: 0.847 Test Acc: 0.786
Validation loss decreased (-0.762997 --> -0.786119).  Saving model ...
Epoch: 10 cost time: 5.0617148876190186
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.535 Vali Acc: 0.821 Test Loss: 0.535 Test Acc: 0.821
Validation loss decreased (-0.786119 --> -0.820804).  Saving model ...
Epoch: 11 cost time: 4.735239028930664
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.638 Vali Acc: 0.815 Test Loss: 0.638 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.629351854324341
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.821 Test Loss: 0.605 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.0796778202056885
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.821 Test Loss: 0.615 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.078602075576782
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.930471897125244
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.765921354293823
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.821 Test Loss: 0.645 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.46634316444397
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.821 Test Loss: 0.637 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.905813694000244
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.821 Test Loss: 0.638 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.936286211013794
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.815 Test Loss: 0.639 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.05875301361084
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 53310727
model size : 218.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.256214141845703
Epoch: 1, Steps: 17 | Train Loss: 1.862 Vali Loss: 1.455 Vali Acc: 0.347 Test Loss: 1.455 Test Acc: 0.347
Validation loss decreased (inf --> -0.346806).  Saving model ...
Epoch: 2 cost time: 3.621978759765625
Epoch: 2, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
Validation loss decreased (-0.346806 --> -0.595366).  Saving model ...
Epoch: 3 cost time: 4.911101818084717
Epoch: 3, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.876 Vali Acc: 0.595 Test Loss: 0.876 Test Acc: 0.595
Validation loss decreased (-0.595366 --> -0.595367).  Saving model ...
Epoch: 4 cost time: 4.896061897277832
Epoch: 4, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.898 Vali Acc: 0.688 Test Loss: 0.898 Test Acc: 0.688
Validation loss decreased (-0.595367 --> -0.687852).  Saving model ...
Epoch: 5 cost time: 4.675251245498657
Epoch: 5, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.697 Vali Acc: 0.740 Test Loss: 0.697 Test Acc: 0.740
Validation loss decreased (-0.687852 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 4.676405191421509
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.684 Vali Acc: 0.780 Test Loss: 0.684 Test Acc: 0.780
Validation loss decreased (-0.739877 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 3.7724356651306152
Epoch: 7, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.752 Vali Acc: 0.728 Test Loss: 0.752 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8465051651000977
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.638 Vali Acc: 0.798 Test Loss: 0.638 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797681).  Saving model ...
Epoch: 9 cost time: 4.145304918289185
Epoch: 9, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.607 Vali Acc: 0.827 Test Loss: 0.607 Test Acc: 0.827
Validation loss decreased (-0.797681 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 4.15402889251709
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.808 Vali Acc: 0.775 Test Loss: 0.808 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8241629600524902
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.592 Vali Acc: 0.815 Test Loss: 0.592 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.251559019088745
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.726 Vali Acc: 0.780 Test Loss: 0.726 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.41902232170105
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.844 Test Loss: 0.531 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843925).  Saving model ...
Epoch: 14 cost time: 4.586535453796387
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.780 Test Loss: 0.854 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.766063690185547
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.761 Vali Acc: 0.769 Test Loss: 0.761 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.804688453674316
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.904 Vali Acc: 0.775 Test Loss: 0.904 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.929589033126831
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.987271070480347
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.901529788970947
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.815 Test Loss: 0.585 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.792479038238525
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.821 Test Loss: 0.621 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.864552974700928
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.821 Test Loss: 0.634 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.615028619766235
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.827 Test Loss: 0.633 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.619832754135132
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.827 Test Loss: 0.636 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 53248519
model size : 217.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.388293504714966
Epoch: 1, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.380 Vali Acc: 0.480 Test Loss: 1.380 Test Acc: 0.480
Validation loss decreased (inf --> -0.479755).  Saving model ...
Epoch: 2 cost time: 4.772500276565552
Epoch: 2, Steps: 17 | Train Loss: 1.172 Vali Loss: 0.955 Vali Acc: 0.572 Test Loss: 0.955 Test Acc: 0.572
Validation loss decreased (-0.479755 --> -0.572245).  Saving model ...
Epoch: 3 cost time: 4.869085788726807
Epoch: 3, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.928 Vali Acc: 0.595 Test Loss: 0.928 Test Acc: 0.595
Validation loss decreased (-0.572245 --> -0.595366).  Saving model ...
Epoch: 4 cost time: 4.781749248504639
Epoch: 4, Steps: 17 | Train Loss: 0.814 Vali Loss: 0.910 Vali Acc: 0.676 Test Loss: 0.910 Test Acc: 0.676
Validation loss decreased (-0.595366 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 4.826702117919922
Epoch: 5, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.855 Vali Acc: 0.705 Test Loss: 0.855 Test Acc: 0.705
Validation loss decreased (-0.676291 --> -0.705194).  Saving model ...
Epoch: 6 cost time: 4.691248893737793
Epoch: 6, Steps: 17 | Train Loss: 0.349 Vali Loss: 1.130 Vali Acc: 0.676 Test Loss: 1.130 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.6752238273620605
Epoch: 7, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
Validation loss decreased (-0.705194 --> -0.716754).  Saving model ...
Epoch: 8 cost time: 4.8451783657073975
Epoch: 8, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.860 Vali Acc: 0.763 Test Loss: 0.860 Test Acc: 0.763
Validation loss decreased (-0.716754 --> -0.762997).  Saving model ...
Epoch: 9 cost time: 4.715524196624756
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.064 Vali Acc: 0.746 Test Loss: 1.064 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.57165265083313
Epoch: 10, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.786 Vali Acc: 0.827 Test Loss: 0.786 Test Acc: 0.827
Validation loss decreased (-0.762997 --> -0.826582).  Saving model ...
Epoch: 11 cost time: 5.230417490005493
Epoch: 11, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.053 Vali Acc: 0.763 Test Loss: 1.053 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.078368425369263
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.068 Vali Acc: 0.757 Test Loss: 1.068 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.131688594818115
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.313 Vali Acc: 0.723 Test Loss: 1.313 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.381448745727539
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.582 Vali Acc: 0.751 Test Loss: 1.582 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.958778619766235
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.833 Vali Acc: 0.803 Test Loss: 0.833 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.026358127593994
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.000 Vali Acc: 0.751 Test Loss: 1.000 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.213102102279663
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.839 Vali Acc: 0.821 Test Loss: 0.839 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.307393312454224
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.865 Vali Acc: 0.815 Test Loss: 0.865 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.353445529937744
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.827 Test Loss: 0.740 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826582).  Saving model ...
Epoch: 20 cost time: 5.288186311721802
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.821 Test Loss: 0.784 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.366233825683594
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.815 Test Loss: 0.777 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.501775026321411
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.815 Test Loss: 0.775 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.719660043716431
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.832 Test Loss: 0.658 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832363).  Saving model ...
Epoch: 24 cost time: 4.5861146450042725
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
Validation loss decreased (-0.832363 --> -0.849704).  Saving model ...
Epoch: 25 cost time: 4.759724378585815
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
Validation loss decreased (-0.849704 --> -0.849704).  Saving model ...
Epoch: 26 cost time: 4.783086538314819
Epoch: 26, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.06291937828064
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
Validation loss decreased (-0.849704 --> -0.849705).  Saving model ...
Epoch: 28 cost time: 4.424606800079346
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.916 Vali Acc: 0.821 Test Loss: 0.916 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.745769500732422
Epoch: 29, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.313 Vali Acc: 0.740 Test Loss: 1.313 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.700501203536987
Epoch: 30, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.828 Vali Acc: 0.780 Test Loss: 0.828 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.925145864486694
Epoch: 31, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.824 Vali Acc: 0.734 Test Loss: 1.824 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.876451253890991
Epoch: 32, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.544 Vali Acc: 0.740 Test Loss: 1.544 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.813654661178589
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.676 Vali Acc: 0.803 Test Loss: 1.676 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.822134494781494
Epoch: 34, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.981 Vali Acc: 0.798 Test Loss: 0.981 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.409740686416626
Epoch: 35, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.378 Vali Acc: 0.786 Test Loss: 1.378 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.373820066452026
Epoch: 36, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.522 Vali Acc: 0.809 Test Loss: 1.522 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 5.201704025268555
Epoch: 37, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.258 Vali Acc: 0.763 Test Loss: 1.258 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 55626247
model size : 226.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.289225339889526
Epoch: 1, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.559 Vali Acc: 0.301 Test Loss: 1.559 Test Acc: 0.301
Validation loss decreased (inf --> -0.300562).  Saving model ...
Epoch: 2 cost time: 4.958526611328125
Epoch: 2, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.043 Vali Acc: 0.549 Test Loss: 1.043 Test Acc: 0.549
Validation loss decreased (-0.300562 --> -0.549123).  Saving model ...
Epoch: 3 cost time: 5.020088195800781
Epoch: 3, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.901 Vali Acc: 0.636 Test Loss: 0.901 Test Acc: 0.636
Validation loss decreased (-0.549123 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 5.261777639389038
Epoch: 4, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.872 Vali Acc: 0.671 Test Loss: 0.872 Test Acc: 0.671
Validation loss decreased (-0.635829 --> -0.670512).  Saving model ...
Epoch: 5 cost time: 5.086627244949341
Epoch: 5, Steps: 17 | Train Loss: 0.360 Vali Loss: 1.087 Vali Acc: 0.642 Test Loss: 1.087 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.119830131530762
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.745 Vali Acc: 0.694 Test Loss: 0.745 Test Acc: 0.694
Validation loss decreased (-0.670512 --> -0.693634).  Saving model ...
Epoch: 7 cost time: 5.1879191398620605
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.127 Vali Acc: 0.653 Test Loss: 1.127 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.305633068084717
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.746 Vali Acc: 0.763 Test Loss: 0.746 Test Acc: 0.763
Validation loss decreased (-0.693634 --> -0.762998).  Saving model ...
Epoch: 9 cost time: 4.9846038818359375
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.636 Vali Acc: 0.769 Test Loss: 0.636 Test Acc: 0.769
Validation loss decreased (-0.762998 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 4.971664190292358
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.845 Vali Acc: 0.803 Test Loss: 0.845 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803460).  Saving model ...
Epoch: 11 cost time: 5.043957471847534
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.743 Vali Acc: 0.780 Test Loss: 0.743 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.964968681335449
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.826 Vali Acc: 0.769 Test Loss: 0.826 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.933279037475586
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.809 Test Loss: 0.795 Test Acc: 0.809
Validation loss decreased (-0.803460 --> -0.809241).  Saving model ...
Epoch: 14 cost time: 5.083536148071289
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.798 Test Loss: 0.847 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.245098829269409
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
Validation loss decreased (-0.809241 --> -0.849705).  Saving model ...
Epoch: 16 cost time: 5.0530877113342285
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.821 Test Loss: 0.668 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.363288164138794
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.815 Test Loss: 0.712 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.318380117416382
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.815 Test Loss: 0.730 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.400420427322388
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.821 Test Loss: 0.732 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.590910911560059
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.803 Test Loss: 0.726 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.741343021392822
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.792 Test Loss: 0.731 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.796652555465698
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.8575098514556885
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.792 Test Loss: 0.726 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.1095826625823975
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.792 Test Loss: 0.729 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.275410413742065
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.792 Test Loss: 0.746 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 55515655
model size : 226.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.34356164932251
Epoch: 1, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.470 Vali Acc: 0.295 Test Loss: 1.470 Test Acc: 0.295
Validation loss decreased (inf --> -0.294783).  Saving model ...
Epoch: 2 cost time: 3.602792978286743
Epoch: 2, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.171 Vali Acc: 0.555 Test Loss: 1.171 Test Acc: 0.555
Validation loss decreased (-0.294783 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 3.787433624267578
Epoch: 3, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.022 Vali Acc: 0.543 Test Loss: 1.022 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.844892740249634
Epoch: 4, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.814 Vali Acc: 0.723 Test Loss: 0.814 Test Acc: 0.723
Validation loss decreased (-0.554902 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 3.542680263519287
Epoch: 5, Steps: 17 | Train Loss: 0.566 Vali Loss: 1.061 Vali Acc: 0.630 Test Loss: 1.061 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.03259801864624
Epoch: 6, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.570 Vali Acc: 0.780 Test Loss: 0.570 Test Acc: 0.780
Validation loss decreased (-0.722535 --> -0.780341).  Saving model ...
Epoch: 7 cost time: 4.393533229827881
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
Validation loss decreased (-0.780341 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 4.457913875579834
Epoch: 8, Steps: 17 | Train Loss: 0.230 Vali Loss: 1.264 Vali Acc: 0.642 Test Loss: 1.264 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.265559673309326
Epoch: 9, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.711 Vali Acc: 0.792 Test Loss: 0.711 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.19855809211731
Epoch: 10, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.544 Vali Acc: 0.792 Test Loss: 0.544 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.168468713760376
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
Validation loss decreased (-0.803462 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 4.304375886917114
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.607 Vali Acc: 0.827 Test Loss: 0.607 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 4.58050274848938
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.496039628982544
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.501 Vali Acc: 0.832 Test Loss: 0.501 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832365).  Saving model ...
Epoch: 15 cost time: 4.7572548389434814
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.358094215393066
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.543 Vali Acc: 0.832 Test Loss: 0.543 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.364001989364624
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.815 Test Loss: 0.549 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.4046595096588135
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.815 Test Loss: 0.558 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.074599266052246
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.821 Test Loss: 0.563 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.369978427886963
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.832 Test Loss: 0.552 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.593227863311768
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.815 Test Loss: 0.570 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.645975351333618
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.815 Test Loss: 0.578 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.651731252670288
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.832 Test Loss: 0.579 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.532391309738159
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.832 Test Loss: 0.571 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 55460359
model size : 226.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.953412294387817
Epoch: 1, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.451 Vali Acc: 0.295 Test Loss: 1.451 Test Acc: 0.295
Validation loss decreased (inf --> -0.294783).  Saving model ...
Epoch: 2 cost time: 4.189748048782349
Epoch: 2, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.136 Vali Acc: 0.474 Test Loss: 1.136 Test Acc: 0.474
Validation loss decreased (-0.294783 --> -0.473977).  Saving model ...
Epoch: 3 cost time: 4.17773962020874
Epoch: 3, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.171 Vali Acc: 0.509 Test Loss: 1.171 Test Acc: 0.509
Validation loss decreased (-0.473977 --> -0.508659).  Saving model ...
Epoch: 4 cost time: 3.43605899810791
Epoch: 4, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.650 Vali Acc: 0.763 Test Loss: 0.650 Test Acc: 0.763
Validation loss decreased (-0.508659 --> -0.762999).  Saving model ...
Epoch: 5 cost time: 3.397035598754883
Epoch: 5, Steps: 17 | Train Loss: 0.456 Vali Loss: 1.038 Vali Acc: 0.665 Test Loss: 1.038 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.268604516983032
Epoch: 6, Steps: 17 | Train Loss: 0.329 Vali Loss: 1.214 Vali Acc: 0.682 Test Loss: 1.214 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.286393165588379
Epoch: 7, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.155 Vali Acc: 0.671 Test Loss: 1.155 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.049995183944702
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.755 Vali Acc: 0.757 Test Loss: 0.755 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.347014904022217
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.983 Vali Acc: 0.728 Test Loss: 0.983 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.072655916213989
Epoch: 10, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.920 Vali Acc: 0.780 Test Loss: 0.920 Test Acc: 0.780
Validation loss decreased (-0.762999 --> -0.780338).  Saving model ...
Epoch: 11 cost time: 4.102750778198242
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.168 Vali Acc: 0.711 Test Loss: 1.168 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.125630140304565
Epoch: 12, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.842 Vali Acc: 0.786 Test Loss: 0.842 Test Acc: 0.786
Validation loss decreased (-0.780338 --> -0.786119).  Saving model ...
Epoch: 13 cost time: 4.212909698486328
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.728 Vali Acc: 0.769 Test Loss: 0.728 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.403029441833496
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.043 Vali Acc: 0.821 Test Loss: 1.043 Test Acc: 0.821
Validation loss decreased (-0.786119 --> -0.820799).  Saving model ...
Epoch: 15 cost time: 4.528528928756714
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.894 Vali Acc: 0.786 Test Loss: 0.894 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.488564729690552
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.246 Vali Acc: 0.746 Test Loss: 1.246 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.181519269943237
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.679 Vali Acc: 0.815 Test Loss: 0.679 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.985546827316284
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.809 Test Loss: 0.813 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.9580371379852295
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.844 Test Loss: 0.654 Test Acc: 0.844
Validation loss decreased (-0.820799 --> -0.843924).  Saving model ...
Epoch: 20 cost time: 4.839770555496216
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.838 Test Loss: 0.724 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.3760716915130615
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.821 Test Loss: 0.690 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.114144802093506
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.827 Test Loss: 0.635 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.351593017578125
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 24 cost time: 3.8797404766082764
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.832 Test Loss: 0.649 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.32953405380249
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.832 Test Loss: 0.647 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.236285209655762
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.832 Test Loss: 0.642 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.155254602432251
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.827 Test Loss: 0.649 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.202325820922852
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.815 Test Loss: 0.651 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.385080099105835
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.815 Test Loss: 0.656 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.394285202026367
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.815 Test Loss: 0.656 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.316962003707886
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.815 Test Loss: 0.656 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.8201828002929688
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.815 Test Loss: 0.659 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.9399282932281494
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.815 Test Loss: 0.660 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 57844999
model size : 235.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.999665975570679
Epoch: 1, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.353 Vali Acc: 0.624 Test Loss: 1.353 Test Acc: 0.624
Validation loss decreased (inf --> -0.624264).  Saving model ...
Epoch: 2 cost time: 4.423721075057983
Epoch: 2, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.320801496505737
Epoch: 3, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.055 Vali Acc: 0.624 Test Loss: 1.055 Test Acc: 0.624
Validation loss decreased (-0.624264 --> -0.624267).  Saving model ...
Epoch: 4 cost time: 4.325759172439575
Epoch: 4, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
Validation loss decreased (-0.624267 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 4.446172714233398
Epoch: 5, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.874 Vali Acc: 0.682 Test Loss: 0.874 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.589795112609863
Epoch: 6, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.609 Vali Acc: 0.786 Test Loss: 0.609 Test Acc: 0.786
Validation loss decreased (-0.716755 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 4.6774208545684814
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.688 Vali Acc: 0.780 Test Loss: 0.688 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.564310789108276
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.043 Vali Acc: 0.757 Test Loss: 1.043 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.261191129684448
Epoch: 9, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.875 Vali Acc: 0.780 Test Loss: 0.875 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.19955039024353
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6126317977905273
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.767 Vali Acc: 0.763 Test Loss: 0.767 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.81992769241333
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.690 Vali Acc: 0.815 Test Loss: 0.690 Test Acc: 0.815
Validation loss decreased (-0.786121 --> -0.815022).  Saving model ...
Epoch: 13 cost time: 3.6692113876342773
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.725 Vali Acc: 0.769 Test Loss: 0.725 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.981654167175293
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.499 Vali Acc: 0.821 Test Loss: 0.499 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820804).  Saving model ...
Epoch: 15 cost time: 4.111143112182617
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.815 Test Loss: 0.554 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.974083662033081
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
Validation loss decreased (-0.820804 --> -0.843925).  Saving model ...
Epoch: 17 cost time: 3.9642386436462402
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
Validation loss decreased (-0.843925 --> -0.849705).  Saving model ...
Epoch: 18 cost time: 4.374606609344482
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
Validation loss decreased (-0.849705 --> -0.849705).  Saving model ...
Epoch: 19 cost time: 4.253967523574829
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.849705 --> -0.849705).  Saving model ...
Epoch: 20 cost time: 3.615902900695801
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.178887844085693
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.2604615688323975
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.2844977378845215
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.155086278915405
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.838 Test Loss: 0.605 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.415499925613403
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.838 Test Loss: 0.602 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5477535724639893
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.5758509635925293
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.669813871383667
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.4517359733581543
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.815 Test Loss: 0.631 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 57734407
model size : 234.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.527531862258911
Epoch: 1, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.403 Vali Acc: 0.358 Test Loss: 1.403 Test Acc: 0.358
Validation loss decreased (inf --> -0.358367).  Saving model ...
Epoch: 2 cost time: 3.6990325450897217
Epoch: 2, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.017 Vali Acc: 0.624 Test Loss: 1.017 Test Acc: 0.624
Validation loss decreased (-0.358367 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 3.7520155906677246
Epoch: 3, Steps: 17 | Train Loss: 0.833 Vali Loss: 0.849 Vali Acc: 0.653 Test Loss: 0.849 Test Acc: 0.653
Validation loss decreased (-0.624267 --> -0.653171).  Saving model ...
Epoch: 4 cost time: 3.782797336578369
Epoch: 4, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.864 Vali Acc: 0.676 Test Loss: 0.864 Test Acc: 0.676
Validation loss decreased (-0.653171 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 3.7888588905334473
Epoch: 5, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.676292 --> -0.757219).  Saving model ...
Epoch: 6 cost time: 3.6791889667510986
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.906 Vali Acc: 0.740 Test Loss: 0.906 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6132407188415527
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.580 Vali Acc: 0.821 Test Loss: 0.580 Test Acc: 0.821
Validation loss decreased (-0.757219 --> -0.820803).  Saving model ...
Epoch: 8 cost time: 3.7701570987701416
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.665 Vali Acc: 0.815 Test Loss: 0.665 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.312140464782715
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.492 Vali Acc: 0.827 Test Loss: 0.492 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826585).  Saving model ...
Epoch: 10 cost time: 4.105301380157471
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.610 Vali Acc: 0.798 Test Loss: 0.610 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7801003456115723
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.517 Vali Acc: 0.786 Test Loss: 0.517 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.00070333480835
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.798 Test Loss: 0.577 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.080331802368164
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.821 Test Loss: 0.593 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.053835391998291
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.9789440631866455
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.113956451416016
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7697739601135254
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.072853326797485
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.774167060852051
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 57679111
model size : 234.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.484192132949829
Epoch: 1, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.601 Vali Acc: 0.289 Test Loss: 1.601 Test Acc: 0.289
Validation loss decreased (inf --> -0.289001).  Saving model ...
Epoch: 2 cost time: 5.454098463058472
Epoch: 2, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.142 Vali Acc: 0.503 Test Loss: 1.142 Test Acc: 0.503
Validation loss decreased (-0.289001 --> -0.502879).  Saving model ...
Epoch: 3 cost time: 5.259755611419678
Epoch: 3, Steps: 17 | Train Loss: 0.944 Vali Loss: 0.714 Vali Acc: 0.653 Test Loss: 0.714 Test Acc: 0.653
Validation loss decreased (-0.502879 --> -0.653172).  Saving model ...
Epoch: 4 cost time: 4.76736307144165
Epoch: 4, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.701 Vali Acc: 0.798 Test Loss: 0.701 Test Acc: 0.798
Validation loss decreased (-0.653172 --> -0.797681).  Saving model ...
Epoch: 5 cost time: 4.8450703620910645
Epoch: 5, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.692 Vali Acc: 0.780 Test Loss: 0.692 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.253336191177368
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.770 Vali Acc: 0.751 Test Loss: 0.770 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.3871142864227295
Epoch: 7, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.677 Vali Acc: 0.757 Test Loss: 0.677 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.34562349319458
Epoch: 8, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.814 Vali Acc: 0.751 Test Loss: 0.814 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.627032995223999
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.904 Vali Acc: 0.746 Test Loss: 0.904 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.807820796966553
Epoch: 10, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.185 Vali Acc: 0.740 Test Loss: 1.185 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.504932641983032
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.649295806884766
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.760 Vali Acc: 0.821 Test Loss: 0.760 Test Acc: 0.821
Validation loss decreased (-0.797681 --> -0.820802).  Saving model ...
Epoch: 13 cost time: 5.606597423553467
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.906 Vali Acc: 0.751 Test Loss: 0.906 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.288108587265015
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.715 Vali Acc: 0.798 Test Loss: 0.715 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.629179000854492
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.560 Vali Acc: 0.855 Test Loss: 0.560 Test Acc: 0.855
Validation loss decreased (-0.820802 --> -0.855486).  Saving model ...
Epoch: 16 cost time: 5.749252796173096
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.957 Vali Acc: 0.809 Test Loss: 0.957 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.613990306854248
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.879 Vali Acc: 0.803 Test Loss: 0.879 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.716730356216431
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.802 Vali Acc: 0.827 Test Loss: 0.802 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.305980920791626
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.192 Vali Acc: 0.775 Test Loss: 1.192 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.1638054847717285
Epoch: 20, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.815 Vali Acc: 0.832 Test Loss: 0.815 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.53902530670166
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.328 Vali Acc: 0.751 Test Loss: 1.328 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.498970985412598
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.823 Vali Acc: 0.746 Test Loss: 1.823 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.919071674346924
Epoch: 23, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.169 Vali Acc: 0.757 Test Loss: 1.169 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.115106105804443
Epoch: 24, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.499 Vali Acc: 0.757 Test Loss: 1.499 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.657406330108643
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.116 Vali Acc: 0.792 Test Loss: 1.116 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 62234119
model size : 252.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.77697491645813
Epoch: 1, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.357 Vali Acc: 0.514 Test Loss: 1.357 Test Acc: 0.514
Validation loss decreased (inf --> -0.514437).  Saving model ...
Epoch: 2 cost time: 5.491116762161255
Epoch: 2, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.002 Vali Acc: 0.630 Test Loss: 1.002 Test Acc: 0.630
Validation loss decreased (-0.514437 --> -0.630048).  Saving model ...
Epoch: 3 cost time: 5.42483377456665
Epoch: 3, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.749 Vali Acc: 0.688 Test Loss: 0.749 Test Acc: 0.688
Validation loss decreased (-0.630048 --> -0.687854).  Saving model ...
Epoch: 4 cost time: 5.4104180335998535
Epoch: 4, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.708 Vali Acc: 0.711 Test Loss: 0.708 Test Acc: 0.711
Validation loss decreased (-0.687854 --> -0.710976).  Saving model ...
Epoch: 5 cost time: 5.3120646476745605
Epoch: 5, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.866 Vali Acc: 0.653 Test Loss: 0.866 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.609485626220703
Epoch: 6, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.666 Vali Acc: 0.740 Test Loss: 0.666 Test Acc: 0.740
Validation loss decreased (-0.710976 --> -0.739878).  Saving model ...
Epoch: 7 cost time: 5.7223005294799805
Epoch: 7, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.603 Vali Acc: 0.792 Test Loss: 0.603 Test Acc: 0.792
Validation loss decreased (-0.739878 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 5.3262903690338135
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.584 Vali Acc: 0.786 Test Loss: 0.584 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.580487966537476
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.636 Vali Acc: 0.786 Test Loss: 0.636 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.493165016174316
Epoch: 10, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.766 Vali Acc: 0.780 Test Loss: 0.766 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.173511505126953
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.909 Vali Acc: 0.757 Test Loss: 0.909 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.184540748596191
Epoch: 12, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.884 Vali Acc: 0.740 Test Loss: 0.884 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.221539735794067
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.696 Vali Acc: 0.815 Test Loss: 0.696 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815022).  Saving model ...
Epoch: 14 cost time: 4.995012283325195
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.732 Vali Acc: 0.780 Test Loss: 0.732 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.812582969665527
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.821 Test Loss: 0.711 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820802).  Saving model ...
Epoch: 16 cost time: 5.277116060256958
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.838 Test Loss: 0.738 Test Acc: 0.838
Validation loss decreased (-0.820802 --> -0.838143).  Saving model ...
Epoch: 17 cost time: 5.408515691757202
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.838 Test Loss: 0.688 Test Acc: 0.838
Validation loss decreased (-0.838143 --> -0.838143).  Saving model ...
Epoch: 18 cost time: 5.2629969120025635
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.838 Test Loss: 0.672 Test Acc: 0.838
Validation loss decreased (-0.838143 --> -0.838144).  Saving model ...
Epoch: 19 cost time: 5.421081781387329
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.838 Test Loss: 0.669 Test Acc: 0.838
Validation loss decreased (-0.838144 --> -0.838144).  Saving model ...
Epoch: 20 cost time: 5.558254718780518
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.827 Test Loss: 0.672 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.67936635017395
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.832 Test Loss: 0.679 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.733468294143677
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.832 Test Loss: 0.689 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.678225755691528
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.827 Test Loss: 0.706 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.823649644851685
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.827 Test Loss: 0.719 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.909523248672485
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.827 Test Loss: 0.728 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.720129013061523
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.811731576919556
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.815 Test Loss: 0.745 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.370138883590698
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.827 Test Loss: 0.746 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.093768358230591
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.832 Test Loss: 0.754 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 62158087
model size : 251.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.466516733169556
Epoch: 1, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.496 Vali Acc: 0.312 Test Loss: 1.496 Test Acc: 0.312
Validation loss decreased (inf --> -0.312124).  Saving model ...
Epoch: 2 cost time: 5.168554067611694
Epoch: 2, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.113 Vali Acc: 0.607 Test Loss: 1.113 Test Acc: 0.607
Validation loss decreased (-0.312124 --> -0.606925).  Saving model ...
Epoch: 3 cost time: 5.684913158416748
Epoch: 3, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.822 Vali Acc: 0.618 Test Loss: 0.822 Test Acc: 0.618
Validation loss decreased (-0.606925 --> -0.618489).  Saving model ...
Epoch: 4 cost time: 5.490875959396362
Epoch: 4, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.686 Vali Acc: 0.757 Test Loss: 0.686 Test Acc: 0.757
Validation loss decreased (-0.618489 --> -0.757219).  Saving model ...
Epoch: 5 cost time: 5.632548093795776
Epoch: 5, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.821 Vali Acc: 0.734 Test Loss: 0.821 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.080532550811768
Epoch: 6, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.818 Vali Acc: 0.751 Test Loss: 0.818 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.284838438034058
Epoch: 7, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.767 Vali Acc: 0.734 Test Loss: 0.767 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.508995056152344
Epoch: 8, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
Validation loss decreased (-0.757219 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 5.694544553756714
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.899 Vali Acc: 0.751 Test Loss: 0.899 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.4737889766693115
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
Validation loss decreased (-0.803463 --> -0.809243).  Saving model ...
Epoch: 11 cost time: 5.662608861923218
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.169462442398071
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.23565673828125
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.803 Test Loss: 0.669 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.828171253204346
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.255824089050293
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.792 Test Loss: 0.656 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.6692028045654297
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.941261053085327
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.821 Test Loss: 0.665 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 18 cost time: 4.855823516845703
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.821 Test Loss: 0.665 Test Acc: 0.821
Validation loss decreased (-0.820803 --> -0.820803).  Saving model ...
Epoch: 19 cost time: 5.102790117263794
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.236707925796509
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.009582281112671
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.020324945449829
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.612069606781006
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.791131258010864
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.803 Test Loss: 0.691 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.1283674240112305
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.803 Test Loss: 0.696 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.735187530517578
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.7914323806762695
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.6822333335876465
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.798 Test Loss: 0.690 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 62109703
model size : 251.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.653501987457275
Epoch: 1, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.530 Vali Acc: 0.266 Test Loss: 1.530 Test Acc: 0.266
Validation loss decreased (inf --> -0.265881).  Saving model ...
Epoch: 2 cost time: 6.146488428115845
Epoch: 2, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.160 Vali Acc: 0.526 Test Loss: 1.160 Test Acc: 0.526
Validation loss decreased (-0.265881 --> -0.526000).  Saving model ...
Epoch: 3 cost time: 5.651559114456177
Epoch: 3, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.870 Vali Acc: 0.630 Test Loss: 0.870 Test Acc: 0.630
Validation loss decreased (-0.526000 --> -0.630049).  Saving model ...
Epoch: 4 cost time: 6.385359525680542
Epoch: 4, Steps: 17 | Train Loss: 0.508 Vali Loss: 1.276 Vali Acc: 0.566 Test Loss: 1.276 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.359827756881714
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.805 Vali Acc: 0.711 Test Loss: 0.805 Test Acc: 0.711
Validation loss decreased (-0.630049 --> -0.710975).  Saving model ...
Epoch: 6 cost time: 6.449636697769165
Epoch: 6, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
Validation loss decreased (-0.710975 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 6.435756206512451
Epoch: 7, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.853 Vali Acc: 0.757 Test Loss: 0.853 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757217).  Saving model ...
Epoch: 8 cost time: 6.737475872039795
Epoch: 8, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.919 Vali Acc: 0.723 Test Loss: 0.919 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.658045768737793
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.020 Vali Acc: 0.734 Test Loss: 1.020 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.806028842926025
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.689 Vali Acc: 0.815 Test Loss: 0.689 Test Acc: 0.815
Validation loss decreased (-0.757217 --> -0.815022).  Saving model ...
Epoch: 11 cost time: 6.943370342254639
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
Validation loss decreased (-0.815022 --> -0.843923).  Saving model ...
Epoch: 12 cost time: 6.248552083969116
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.869 Vali Acc: 0.786 Test Loss: 0.869 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.014625549316406
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.815 Test Loss: 0.797 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.556752681732178
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.798 Test Loss: 0.857 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.521229028701782
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.803 Test Loss: 0.825 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.229646921157837
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.803 Test Loss: 0.823 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.987088441848755
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.803 Test Loss: 0.826 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.462743043899536
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.803 Test Loss: 0.835 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.414706468582153
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.798 Test Loss: 0.833 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.553644418716431
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.803 Test Loss: 0.828 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.1018595695495605
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.803 Test Loss: 0.827 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 68855815
model size : 277.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.10411810874939
Epoch: 1, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.416 Vali Acc: 0.399 Test Loss: 1.416 Test Acc: 0.399
Validation loss decreased (inf --> -0.398830).  Saving model ...
Epoch: 2 cost time: 5.832464218139648
Epoch: 2, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.048 Vali Acc: 0.590 Test Loss: 1.048 Test Acc: 0.590
Validation loss decreased (-0.398830 --> -0.589585).  Saving model ...
Epoch: 3 cost time: 5.730765342712402
Epoch: 3, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.694 Vali Acc: 0.723 Test Loss: 0.694 Test Acc: 0.723
Validation loss decreased (-0.589585 --> -0.722536).  Saving model ...
Epoch: 4 cost time: 5.755252838134766
Epoch: 4, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.677 Vali Acc: 0.751 Test Loss: 0.677 Test Acc: 0.751
Validation loss decreased (-0.722536 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 5.484816551208496
Epoch: 5, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.666 Vali Acc: 0.746 Test Loss: 0.666 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.527508497238159
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.713 Vali Acc: 0.763 Test Loss: 0.713 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 5.830371856689453
Epoch: 7, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.585 Vali Acc: 0.792 Test Loss: 0.585 Test Acc: 0.792
Validation loss decreased (-0.762999 --> -0.791902).  Saving model ...
Epoch: 8 cost time: 5.541401386260986
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.739 Vali Acc: 0.769 Test Loss: 0.739 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.7279887199401855
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.814 Vali Acc: 0.751 Test Loss: 0.814 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.613920450210571
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.681 Vali Acc: 0.757 Test Loss: 0.681 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.663564205169678
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.556 Vali Acc: 0.786 Test Loss: 0.556 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.441589117050171
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.559 Vali Acc: 0.821 Test Loss: 0.559 Test Acc: 0.821
Validation loss decreased (-0.791902 --> -0.820804).  Saving model ...
Epoch: 13 cost time: 6.004738092422485
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.675 Vali Acc: 0.792 Test Loss: 0.675 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.88300085067749
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.726 Vali Acc: 0.798 Test Loss: 0.726 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.0579307079315186
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.792 Test Loss: 0.747 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.854453802108765
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.792 Test Loss: 0.745 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.931834936141968
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.809 Test Loss: 0.722 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.247762203216553
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.798 Test Loss: 0.735 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.412614107131958
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.803 Test Loss: 0.746 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.998520612716675
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.3636696338653564
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.832 Test Loss: 0.729 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832363).  Saving model ...
Epoch: 22 cost time: 5.917031526565552
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.809 Test Loss: 0.736 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.251800537109375
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.821 Test Loss: 0.754 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.412724256515503
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.809 Test Loss: 0.761 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.578752756118774
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.815 Test Loss: 0.774 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.972287893295288
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.827 Test Loss: 0.757 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.071110725402832
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.821 Test Loss: 0.766 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.383920431137085
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.827 Test Loss: 0.625 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.0828046798706055
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.815 Test Loss: 0.675 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.79174280166626
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.832 Test Loss: 0.633 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832364).  Saving model ...
Epoch: 31 cost time: 5.804477214813232
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.792 Test Loss: 0.633 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.917578935623169
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.792 Test Loss: 0.654 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.626975774765015
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.141233921051025
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.815 Test Loss: 0.652 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.203905820846558
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.815 Test Loss: 0.665 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 5.938340187072754
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.239595890045166
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.403054714202881
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.518417835235596
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.815 Test Loss: 0.672 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.187856435775757
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.821 Test Loss: 0.676 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 68793607
model size : 277.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.806679010391235
Epoch: 1, Steps: 17 | Train Loss: 1.765 Vali Loss: 1.366 Vali Acc: 0.480 Test Loss: 1.366 Test Acc: 0.480
Validation loss decreased (inf --> -0.479755).  Saving model ...
Epoch: 2 cost time: 5.660154342651367
Epoch: 2, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.104 Vali Acc: 0.532 Test Loss: 1.104 Test Acc: 0.532
Validation loss decreased (-0.479755 --> -0.531781).  Saving model ...
Epoch: 3 cost time: 5.75932502746582
Epoch: 3, Steps: 17 | Train Loss: 0.991 Vali Loss: 0.990 Vali Acc: 0.538 Test Loss: 0.990 Test Acc: 0.538
Validation loss decreased (-0.531781 --> -0.537562).  Saving model ...
Epoch: 4 cost time: 5.480496168136597
Epoch: 4, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.746 Vali Acc: 0.723 Test Loss: 0.746 Test Acc: 0.723
Validation loss decreased (-0.537562 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 4.900766372680664
Epoch: 5, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.841 Vali Acc: 0.659 Test Loss: 0.841 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.10983943939209
Epoch: 6, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.568 Vali Acc: 0.792 Test Loss: 0.568 Test Acc: 0.792
Validation loss decreased (-0.722536 --> -0.791902).  Saving model ...
Epoch: 7 cost time: 5.063378572463989
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.659 Vali Acc: 0.769 Test Loss: 0.659 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.49765944480896
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.623 Vali Acc: 0.769 Test Loss: 0.623 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.587111949920654
Epoch: 9, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.825 Vali Acc: 0.751 Test Loss: 0.825 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.271697998046875
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
Validation loss decreased (-0.791902 --> -0.843925).  Saving model ...
Epoch: 11 cost time: 6.295121669769287
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.780 Vali Acc: 0.792 Test Loss: 0.780 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.4916160106658936
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.738 Vali Acc: 0.798 Test Loss: 0.738 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.175909996032715
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.551206350326538
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.815 Test Loss: 0.581 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.42448353767395
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.843925 --> -0.849705).  Saving model ...
Epoch: 16 cost time: 5.976024150848389
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.838 Test Loss: 0.608 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.219536066055298
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.832 Test Loss: 0.615 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.068690776824951
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.832 Test Loss: 0.622 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.607552766799927
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.777580976486206
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.0988335609436035
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.497868776321411
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.817112922668457
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.8749494552612305
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.815 Test Loss: 0.649 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.945780515670776
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.798 Test Loss: 0.661 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 68752135
model size : 276.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.749616861343384
Epoch: 1, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.621 Vali Acc: 0.289 Test Loss: 1.621 Test Acc: 0.289
Validation loss decreased (inf --> -0.289001).  Saving model ...
Epoch: 2 cost time: 5.600043535232544
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.265 Vali Acc: 0.480 Test Loss: 1.265 Test Acc: 0.480
Validation loss decreased (-0.289001 --> -0.479756).  Saving model ...
Epoch: 3 cost time: 5.271172046661377
Epoch: 3, Steps: 17 | Train Loss: 0.875 Vali Loss: 0.894 Vali Acc: 0.688 Test Loss: 0.894 Test Acc: 0.688
Validation loss decreased (-0.479756 --> -0.687852).  Saving model ...
Epoch: 4 cost time: 6.43867564201355
Epoch: 4, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.706 Vali Acc: 0.728 Test Loss: 0.706 Test Acc: 0.728
Validation loss decreased (-0.687852 --> -0.728317).  Saving model ...
Epoch: 5 cost time: 5.958148956298828
Epoch: 5, Steps: 17 | Train Loss: 0.507 Vali Loss: 1.066 Vali Acc: 0.642 Test Loss: 1.066 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.722859859466553
Epoch: 6, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.747 Vali Acc: 0.734 Test Loss: 0.747 Test Acc: 0.734
Validation loss decreased (-0.728317 --> -0.734097).  Saving model ...
Epoch: 7 cost time: 5.361792802810669
Epoch: 7, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.059 Vali Acc: 0.792 Test Loss: 1.059 Test Acc: 0.792
Validation loss decreased (-0.734097 --> -0.791897).  Saving model ...
Epoch: 8 cost time: 6.0002992153167725
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.833 Vali Acc: 0.746 Test Loss: 0.833 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.504560947418213
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.157 Vali Acc: 0.711 Test Loss: 1.157 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.335327863693237
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.019 Vali Acc: 0.792 Test Loss: 1.019 Test Acc: 0.792
Validation loss decreased (-0.791897 --> -0.791897).  Saving model ...
Epoch: 11 cost time: 5.263890981674194
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.225 Vali Acc: 0.786 Test Loss: 1.225 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.3546130657196045
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.156 Vali Acc: 0.798 Test Loss: 1.156 Test Acc: 0.798
Validation loss decreased (-0.791897 --> -0.797676).  Saving model ...
Epoch: 13 cost time: 5.707097053527832
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.890 Vali Acc: 0.763 Test Loss: 0.890 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.479417324066162
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.844 Vali Acc: 0.821 Test Loss: 0.844 Test Acc: 0.821
Validation loss decreased (-0.797676 --> -0.820801).  Saving model ...
Epoch: 15 cost time: 6.215973854064941
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.891 Vali Acc: 0.740 Test Loss: 0.891 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.352442502975464
Epoch: 16, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.697 Vali Acc: 0.775 Test Loss: 0.697 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.3040242195129395
Epoch: 17, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.683 Vali Acc: 0.815 Test Loss: 0.683 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.505931615829468
Epoch: 18, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.157 Vali Acc: 0.769 Test Loss: 1.157 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.885697364807129
Epoch: 19, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.824 Vali Acc: 0.786 Test Loss: 0.824 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.953181743621826
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.737 Vali Acc: 0.809 Test Loss: 0.737 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.432201862335205
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.210 Vali Acc: 0.798 Test Loss: 1.210 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.265757322311401
Epoch: 22, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.966 Vali Acc: 0.786 Test Loss: 0.966 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.174733638763428
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.264 Vali Acc: 0.769 Test Loss: 1.264 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.454720735549927
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.384 Vali Acc: 0.775 Test Loss: 1.384 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 75512071
model size : 302.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.3380467891693115
Epoch: 1, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.497 Vali Acc: 0.243 Test Loss: 1.497 Test Acc: 0.243
Validation loss decreased (inf --> -0.242760).  Saving model ...
Epoch: 2 cost time: 5.7289652824401855
Epoch: 2, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.040 Vali Acc: 0.630 Test Loss: 1.040 Test Acc: 0.630
Validation loss decreased (-0.242760 --> -0.630047).  Saving model ...
Epoch: 3 cost time: 5.836230278015137
Epoch: 3, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.012 Vali Acc: 0.549 Test Loss: 1.012 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.225005626678467
Epoch: 4, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.806 Vali Acc: 0.717 Test Loss: 0.806 Test Acc: 0.717
Validation loss decreased (-0.630047 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 5.28805136680603
Epoch: 5, Steps: 17 | Train Loss: 0.400 Vali Loss: 1.029 Vali Acc: 0.699 Test Loss: 1.029 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.271031379699707
Epoch: 6, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.804 Vali Acc: 0.694 Test Loss: 0.804 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.6271653175354
Epoch: 7, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.534 Vali Acc: 0.827 Test Loss: 0.534 Test Acc: 0.827
Validation loss decreased (-0.716755 --> -0.826584).  Saving model ...
Epoch: 8 cost time: 5.7273430824279785
Epoch: 8, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.589 Vali Acc: 0.792 Test Loss: 0.589 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.377364158630371
Epoch: 9, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.41007924079895
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.919 Vali Acc: 0.728 Test Loss: 0.919 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.240805387496948
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.906 Vali Acc: 0.757 Test Loss: 0.906 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.560480117797852
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.643 Vali Acc: 0.815 Test Loss: 0.643 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.866769313812256
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.713 Vali Acc: 0.786 Test Loss: 0.713 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.957907438278198
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.593 Vali Acc: 0.821 Test Loss: 0.593 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.4715189933776855
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.582 Vali Acc: 0.815 Test Loss: 0.582 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.687666893005371
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.615 Vali Acc: 0.815 Test Loss: 0.615 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.666038990020752
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.815 Test Loss: 0.603 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 75442951
model size : 302.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.04299259185791
Epoch: 1, Steps: 17 | Train Loss: 1.760 Vali Loss: 1.337 Vali Acc: 0.526 Test Loss: 1.337 Test Acc: 0.526
Validation loss decreased (inf --> -0.525998).  Saving model ...
Epoch: 2 cost time: 4.727089881896973
Epoch: 2, Steps: 17 | Train Loss: 1.097 Vali Loss: 0.972 Vali Acc: 0.636 Test Loss: 0.972 Test Acc: 0.636
Validation loss decreased (-0.525998 --> -0.635828).  Saving model ...
Epoch: 3 cost time: 5.414096832275391
Epoch: 3, Steps: 17 | Train Loss: 0.735 Vali Loss: 0.870 Vali Acc: 0.659 Test Loss: 0.870 Test Acc: 0.659
Validation loss decreased (-0.635828 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 5.625780344009399
Epoch: 4, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.940 Vali Acc: 0.601 Test Loss: 0.940 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.440536737442017
Epoch: 5, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.641 Vali Acc: 0.798 Test Loss: 0.641 Test Acc: 0.798
Validation loss decreased (-0.658951 --> -0.797681).  Saving model ...
Epoch: 6 cost time: 4.463818073272705
Epoch: 6, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 4.175254821777344
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.547 Vali Acc: 0.821 Test Loss: 0.547 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 4.768027067184448
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.608057498931885
Epoch: 9, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.664 Vali Acc: 0.792 Test Loss: 0.664 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.60986328125
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.724925756454468
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.604 Vali Acc: 0.838 Test Loss: 0.604 Test Acc: 0.838
Validation loss decreased (-0.820804 --> -0.838144).  Saving model ...
Epoch: 12 cost time: 5.279550313949585
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.791294574737549
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.838 Test Loss: 0.559 Test Acc: 0.838
Validation loss decreased (-0.838144 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 5.7295613288879395
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.756917715072632
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.838 Test Loss: 0.604 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.627682209014893
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.838 Test Loss: 0.612 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.33260178565979
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.47083592414856
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.838 Test Loss: 0.624 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.337076663970947
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.878578424453735
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.827 Test Loss: 0.620 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.269253253936768
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.827 Test Loss: 0.641 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.25152850151062
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.827 Test Loss: 0.639 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.936866521835327
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.827 Test Loss: 0.649 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps24_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 75408391
model size : 302.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.979055643081665
Epoch: 1, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.444 Vali Acc: 0.399 Test Loss: 1.444 Test Acc: 0.399
Validation loss decreased (inf --> -0.398829).  Saving model ...
Epoch: 2 cost time: 7.446324586868286
Epoch: 2, Steps: 17 | Train Loss: 1.182 Vali Loss: 0.982 Vali Acc: 0.659 Test Loss: 0.982 Test Acc: 0.659
Validation loss decreased (-0.398829 --> -0.658950).  Saving model ...
Epoch: 3 cost time: 7.701138019561768
Epoch: 3, Steps: 17 | Train Loss: 0.822 Vali Loss: 1.122 Vali Acc: 0.676 Test Loss: 1.122 Test Acc: 0.676
Validation loss decreased (-0.658950 --> -0.676289).  Saving model ...
Epoch: 4 cost time: 7.753223180770874
Epoch: 4, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.632 Vali Acc: 0.775 Test Loss: 0.632 Test Acc: 0.775
Validation loss decreased (-0.676289 --> -0.774560).  Saving model ...
Epoch: 5 cost time: 7.318184852600098
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.764 Vali Acc: 0.705 Test Loss: 0.764 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.526273012161255
Epoch: 6, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.597 Vali Acc: 0.792 Test Loss: 0.597 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791902).  Saving model ...
Epoch: 7 cost time: 7.687713384628296
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.551 Vali Acc: 0.815 Test Loss: 0.551 Test Acc: 0.815
Validation loss decreased (-0.791902 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 7.288823127746582
Epoch: 8, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.824 Vali Acc: 0.775 Test Loss: 0.824 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.232759714126587
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.896166086196899
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.702 Vali Acc: 0.763 Test Loss: 0.702 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.340443134307861
Epoch: 11, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.840 Vali Acc: 0.746 Test Loss: 0.840 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.269817352294922
Epoch: 12, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.157 Vali Acc: 0.751 Test Loss: 1.157 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.619428396224976
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.772 Vali Acc: 0.769 Test Loss: 0.772 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.77086615562439
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.963 Vali Acc: 0.780 Test Loss: 0.963 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.450490951538086
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.574 Vali Acc: 0.815 Test Loss: 0.574 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.9653308391571045
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.775 Test Loss: 0.645 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.054293632507324
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.792 Test Loss: 0.642 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 86564359
model size : 344.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.631850719451904
Epoch: 1, Steps: 17 | Train Loss: 1.853 Vali Loss: 1.523 Vali Acc: 0.283 Test Loss: 1.523 Test Acc: 0.283
Validation loss decreased (inf --> -0.283222).  Saving model ...
Epoch: 2 cost time: 7.26463508605957
Epoch: 2, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.138 Vali Acc: 0.572 Test Loss: 1.138 Test Acc: 0.572
Validation loss decreased (-0.283222 --> -0.572243).  Saving model ...
Epoch: 3 cost time: 7.726015090942383
Epoch: 3, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.085 Vali Acc: 0.671 Test Loss: 1.085 Test Acc: 0.671
Validation loss decreased (-0.572243 --> -0.670509).  Saving model ...
Epoch: 4 cost time: 7.375157594680786
Epoch: 4, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.739 Vali Acc: 0.711 Test Loss: 0.739 Test Acc: 0.711
Validation loss decreased (-0.670509 --> -0.710975).  Saving model ...
Epoch: 5 cost time: 6.767184257507324
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.644 Vali Acc: 0.734 Test Loss: 0.644 Test Acc: 0.734
Validation loss decreased (-0.710975 --> -0.734098).  Saving model ...
Epoch: 6 cost time: 6.929995059967041
Epoch: 6, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.786 Vali Acc: 0.740 Test Loss: 0.786 Test Acc: 0.740
Validation loss decreased (-0.734098 --> -0.739877).  Saving model ...
Epoch: 7 cost time: 6.897648572921753
Epoch: 7, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.619 Vali Acc: 0.780 Test Loss: 0.619 Test Acc: 0.780
Validation loss decreased (-0.739877 --> -0.780341).  Saving model ...
Epoch: 8 cost time: 7.307737350463867
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.592 Vali Acc: 0.780 Test Loss: 0.592 Test Acc: 0.780
Validation loss decreased (-0.780341 --> -0.780341).  Saving model ...
Epoch: 9 cost time: 7.233845949172974
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.646 Vali Acc: 0.780 Test Loss: 0.646 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.908015012741089
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.609 Vali Acc: 0.827 Test Loss: 0.609 Test Acc: 0.827
Validation loss decreased (-0.780341 --> -0.826584).  Saving model ...
Epoch: 11 cost time: 7.457411289215088
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.677 Vali Acc: 0.780 Test Loss: 0.677 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.348859071731567
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.767 Vali Acc: 0.809 Test Loss: 0.767 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.7488853931427
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.946 Vali Acc: 0.780 Test Loss: 0.946 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.395671129226685
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.234 Vali Acc: 0.769 Test Loss: 1.234 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.146177768707275
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.125959157943726
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.204386472702026
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.798 Test Loss: 0.611 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.115633249282837
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.67793083190918
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.461792945861816
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.798 Test Loss: 0.561 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 86515975
model size : 344.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.438961267471313
Epoch: 1, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.359 Vali Acc: 0.399 Test Loss: 1.359 Test Acc: 0.399
Validation loss decreased (inf --> -0.398830).  Saving model ...
Epoch: 2 cost time: 7.554286241531372
Epoch: 2, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.077 Vali Acc: 0.561 Test Loss: 1.077 Test Acc: 0.561
Validation loss decreased (-0.398830 --> -0.560683).  Saving model ...
Epoch: 3 cost time: 8.22311544418335
Epoch: 3, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.701 Vali Acc: 0.740 Test Loss: 0.701 Test Acc: 0.740
Validation loss decreased (-0.560683 --> -0.739877).  Saving model ...
Epoch: 4 cost time: 7.816180944442749
Epoch: 4, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.758 Vali Acc: 0.711 Test Loss: 0.758 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.945255279541016
Epoch: 5, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.681 Vali Acc: 0.792 Test Loss: 0.681 Test Acc: 0.792
Validation loss decreased (-0.739877 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 8.085028648376465
Epoch: 6, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.720 Vali Acc: 0.769 Test Loss: 0.720 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.86397385597229
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.217 Vali Acc: 0.723 Test Loss: 1.217 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.317782163619995
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.583 Vali Acc: 0.775 Test Loss: 0.583 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.765262365341187
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.593 Vali Acc: 0.798 Test Loss: 0.593 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 8.577272891998291
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.798 Test Loss: 0.637 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.530787944793701
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.786 Test Loss: 0.686 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.247578859329224
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.593 Vali Acc: 0.780 Test Loss: 0.593 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.003152132034302
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.792 Test Loss: 0.589 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.189030885696411
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.67734146118164
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.786 Test Loss: 0.634 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.04710841178894
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.780 Test Loss: 0.647 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.8529345989227295
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.786 Test Loss: 0.662 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.518031358718872
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.786 Test Loss: 0.661 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.469166278839111
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.792 Test Loss: 0.659 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_GPT4TS_UEA_ftM_sl144_ll0_pl0_el3_dm768_df768_ps29_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 86488327
model size : 344.59MB
