Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.975703001022339
Epoch: 1, Steps: 4 | Train Loss: 1.712 Vali Loss: 1.592 Vali Acc: 0.160 Test Loss: 1.592 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.4012784957885742
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.562 Vali Acc: 0.220 Test Loss: 1.562 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.9612970352172852
Epoch: 3, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.728 Vali Acc: 0.320 Test Loss: 1.728 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 1.784296989440918
Epoch: 4, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.386 Vali Acc: 0.480 Test Loss: 1.386 Test Acc: 0.480
Validation loss decreased (-0.319983 --> -0.479986).  Saving model ...
Epoch: 5 cost time: 1.9131543636322021
Epoch: 5, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.440 Vali Acc: 0.400 Test Loss: 1.440 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3895962238311768
Epoch: 6, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.553 Vali Acc: 0.520 Test Loss: 1.553 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519984).  Saving model ...
Epoch: 7 cost time: 1.5004615783691406
Epoch: 7, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.454 Vali Acc: 0.420 Test Loss: 1.454 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4735345840454102
Epoch: 8, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.833 Vali Acc: 0.480 Test Loss: 1.833 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4920363426208496
Epoch: 9, Steps: 4 | Train Loss: 0.169 Vali Loss: 2.117 Vali Acc: 0.440 Test Loss: 2.117 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3766117095947266
Epoch: 10, Steps: 4 | Train Loss: 0.232 Vali Loss: 2.015 Vali Acc: 0.460 Test Loss: 2.015 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2399775981903076
Epoch: 11, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.531 Vali Acc: 0.480 Test Loss: 1.531 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6669297218322754
Epoch: 12, Steps: 4 | Train Loss: 0.276 Vali Loss: 2.287 Vali Acc: 0.560 Test Loss: 2.287 Test Acc: 0.560
Validation loss decreased (-0.519984 --> -0.559977).  Saving model ...
Epoch: 13 cost time: 1.1666951179504395
Epoch: 13, Steps: 4 | Train Loss: 0.098 Vali Loss: 2.464 Vali Acc: 0.420 Test Loss: 2.464 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0372264385223389
Epoch: 14, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.038 Vali Acc: 0.520 Test Loss: 2.038 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.923107385635376
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.430 Vali Acc: 0.460 Test Loss: 2.430 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7041561603546143
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.260 Vali Acc: 0.500 Test Loss: 2.260 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7663085460662842
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.244 Vali Acc: 0.540 Test Loss: 2.244 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6938867568969727
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.340 Vali Acc: 0.500 Test Loss: 2.340 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7404146194458008
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.325 Vali Acc: 0.580 Test Loss: 2.325 Test Acc: 0.580
Validation loss decreased (-0.559977 --> -0.579977).  Saving model ...
Epoch: 20 cost time: 1.5742883682250977
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.540 Vali Acc: 0.580 Test Loss: 2.540 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8200933933258057
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.122 Vali Acc: 0.540 Test Loss: 2.122 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.403639316558838
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.085 Vali Acc: 0.540 Test Loss: 2.085 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3920209407806396
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.160 Vali Acc: 0.560 Test Loss: 2.160 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6061959266662598
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.333 Vali Acc: 0.580 Test Loss: 2.333 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7419497966766357
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.893 Vali Acc: 0.560 Test Loss: 2.893 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5842511653900146
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 3.632 Vali Acc: 0.480 Test Loss: 3.632 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5764992237091064
Epoch: 27, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.629 Vali Acc: 0.580 Test Loss: 2.629 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3319196701049805
Epoch: 28, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.941 Vali Acc: 0.540 Test Loss: 2.941 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7722175121307373
Epoch: 29, Steps: 4 | Train Loss: 0.131 Vali Loss: 2.121 Vali Acc: 0.520 Test Loss: 2.121 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 77934341
model size : 311.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.82448410987854
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.625 Vali Acc: 0.120 Test Loss: 1.625 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.1460754871368408
Epoch: 2, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.541 Vali Acc: 0.260 Test Loss: 1.541 Test Acc: 0.260
Validation loss decreased (-0.119984 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.0683276653289795
Epoch: 3, Steps: 4 | Train Loss: 1.148 Vali Loss: 1.450 Vali Acc: 0.360 Test Loss: 1.450 Test Acc: 0.360
Validation loss decreased (-0.259985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.4457628726959229
Epoch: 4, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.400 Vali Acc: 0.560 Test Loss: 1.400 Test Acc: 0.560
Validation loss decreased (-0.359985 --> -0.559986).  Saving model ...
Epoch: 5 cost time: 1.2894036769866943
Epoch: 5, Steps: 4 | Train Loss: 0.651 Vali Loss: 1.513 Vali Acc: 0.460 Test Loss: 1.513 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0829694271087646
Epoch: 6, Steps: 4 | Train Loss: 0.397 Vali Loss: 1.421 Vali Acc: 0.580 Test Loss: 1.421 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579986).  Saving model ...
Epoch: 7 cost time: 1.1967463493347168
Epoch: 7, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.376 Vali Acc: 0.540 Test Loss: 1.376 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2631618976593018
Epoch: 8, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.918 Vali Acc: 0.540 Test Loss: 1.918 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3770253658294678
Epoch: 9, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3200116157531738
Epoch: 10, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.721 Vali Acc: 0.520 Test Loss: 1.721 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.274850845336914
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.494 Vali Acc: 0.560 Test Loss: 1.494 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9349575042724609
Epoch: 12, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.583 Vali Acc: 0.560 Test Loss: 1.583 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2049415111541748
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.085 Vali Acc: 0.500 Test Loss: 2.085 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2582223415374756
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.025 Vali Acc: 0.520 Test Loss: 2.025 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.367175579071045
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.914 Vali Acc: 0.520 Test Loss: 1.914 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1324377059936523
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.827 Vali Acc: 0.540 Test Loss: 1.827 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 77703173
model size : 311.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1272401809692383
Epoch: 1, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 0.9746549129486084
Epoch: 2, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.508 Vali Acc: 0.300 Test Loss: 1.508 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.2341763973236084
Epoch: 3, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.428 Vali Acc: 0.360 Test Loss: 1.428 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 1.520409345626831
Epoch: 4, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.384 Vali Acc: 0.360 Test Loss: 1.384 Test Acc: 0.360
Validation loss decreased (-0.359986 --> -0.359986).  Saving model ...
Epoch: 5 cost time: 1.3650829792022705
Epoch: 5, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.452 Vali Acc: 0.480 Test Loss: 1.452 Test Acc: 0.480
Validation loss decreased (-0.359986 --> -0.479985).  Saving model ...
Epoch: 6 cost time: 1.5093398094177246
Epoch: 6, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.4037530422210693
Epoch: 7, Steps: 4 | Train Loss: 0.236 Vali Loss: 1.296 Vali Acc: 0.520 Test Loss: 1.296 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 1.1900544166564941
Epoch: 8, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.842 Vali Acc: 0.440 Test Loss: 1.842 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2706987857818604
Epoch: 9, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.492 Vali Acc: 0.520 Test Loss: 1.492 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4342107772827148
Epoch: 10, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.658 Vali Acc: 0.500 Test Loss: 1.658 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.327233076095581
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.631 Vali Acc: 0.440 Test Loss: 1.631 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7042229175567627
Epoch: 12, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.572 Vali Acc: 0.440 Test Loss: 1.572 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6443324089050293
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.696 Vali Acc: 0.460 Test Loss: 1.696 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4469983577728271
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.873 Vali Acc: 0.480 Test Loss: 1.873 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7398827075958252
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.029 Vali Acc: 0.480 Test Loss: 2.029 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4347655773162842
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.066 Vali Acc: 0.520 Test Loss: 2.066 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8572404384613037
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.009 Vali Acc: 0.560 Test Loss: 2.009 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559980).  Saving model ...
Epoch: 18 cost time: 1.6417810916900635
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.540 Test Loss: 1.953 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9229485988616943
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.977 Vali Acc: 0.540 Test Loss: 1.977 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1381168365478516
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.520 Test Loss: 2.012 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3786590099334717
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.037 Vali Acc: 0.520 Test Loss: 2.037 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1564714908599854
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.520 Test Loss: 2.069 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6091578006744385
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.091 Vali Acc: 0.520 Test Loss: 2.091 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.127253770828247
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.108 Vali Acc: 0.540 Test Loss: 2.108 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.98634934425354
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.540 Test Loss: 2.111 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5981323719024658
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.540 Test Loss: 2.111 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4589214324951172
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.097 Vali Acc: 0.540 Test Loss: 2.097 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 77595653
model size : 310.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4286601543426514
Epoch: 1, Steps: 4 | Train Loss: 1.977 Vali Loss: 1.674 Vali Acc: 0.200 Test Loss: 1.674 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.4955191612243652
Epoch: 2, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.455 Vali Acc: 0.200 Test Loss: 1.455 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 1.6600213050842285
Epoch: 3, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.490 Vali Acc: 0.440 Test Loss: 1.490 Test Acc: 0.440
Validation loss decreased (-0.199985 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 1.4945800304412842
Epoch: 4, Steps: 4 | Train Loss: 0.879 Vali Loss: 1.310 Vali Acc: 0.520 Test Loss: 1.310 Test Acc: 0.520
Validation loss decreased (-0.439985 --> -0.519987).  Saving model ...
Epoch: 5 cost time: 1.449873924255371
Epoch: 5, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.536 Vali Acc: 0.440 Test Loss: 1.536 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3930506706237793
Epoch: 6, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.382 Vali Acc: 0.520 Test Loss: 1.382 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4503364562988281
Epoch: 7, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.486119270324707
Epoch: 8, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.504 Vali Acc: 0.640 Test Loss: 1.504 Test Acc: 0.640
Validation loss decreased (-0.519987 --> -0.639985).  Saving model ...
Epoch: 9 cost time: 1.2215960025787354
Epoch: 9, Steps: 4 | Train Loss: 0.142 Vali Loss: 3.308 Vali Acc: 0.440 Test Loss: 3.308 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.457951545715332
Epoch: 10, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.292 Vali Acc: 0.520 Test Loss: 1.292 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5036301612854004
Epoch: 11, Steps: 4 | Train Loss: 0.206 Vali Loss: 2.248 Vali Acc: 0.420 Test Loss: 2.248 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.314615249633789
Epoch: 12, Steps: 4 | Train Loss: 0.179 Vali Loss: 1.976 Vali Acc: 0.500 Test Loss: 1.976 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.542921781539917
Epoch: 13, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.895 Vali Acc: 0.480 Test Loss: 1.895 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.367354393005371
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.665 Vali Acc: 0.440 Test Loss: 2.665 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.618074893951416
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.446 Vali Acc: 0.540 Test Loss: 2.446 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5437276363372803
Epoch: 16, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.152 Vali Acc: 0.560 Test Loss: 2.152 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5816187858581543
Epoch: 17, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.238 Vali Acc: 0.540 Test Loss: 2.238 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.442425012588501
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.467 Vali Acc: 0.500 Test Loss: 2.467 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 81033221
model size : 323.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.622159481048584
Epoch: 1, Steps: 4 | Train Loss: 1.749 Vali Loss: 1.673 Vali Acc: 0.200 Test Loss: 1.673 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.2041823863983154
Epoch: 2, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.541 Vali Acc: 0.360 Test Loss: 1.541 Test Acc: 0.360
Validation loss decreased (-0.199983 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.1803655624389648
Epoch: 3, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.416 Vali Acc: 0.340 Test Loss: 1.416 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2995171546936035
Epoch: 4, Steps: 4 | Train Loss: 0.867 Vali Loss: 1.244 Vali Acc: 0.380 Test Loss: 1.244 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379988).  Saving model ...
Epoch: 5 cost time: 1.0015106201171875
Epoch: 5, Steps: 4 | Train Loss: 0.582 Vali Loss: 1.247 Vali Acc: 0.380 Test Loss: 1.247 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3524482250213623
Epoch: 6, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.386 Vali Acc: 0.460 Test Loss: 1.386 Test Acc: 0.460
Validation loss decreased (-0.379988 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.1891262531280518
Epoch: 7, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.393 Vali Acc: 0.460 Test Loss: 1.393 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3360445499420166
Epoch: 8, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.846 Vali Acc: 0.440 Test Loss: 1.846 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.216972827911377
Epoch: 9, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.483 Vali Acc: 0.520 Test Loss: 1.483 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519985).  Saving model ...
Epoch: 10 cost time: 1.2680046558380127
Epoch: 10, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.273 Vali Acc: 0.540 Test Loss: 1.273 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539987).  Saving model ...
Epoch: 11 cost time: 1.2298245429992676
Epoch: 11, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.340 Vali Acc: 0.480 Test Loss: 2.340 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.479222297668457
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.596 Vali Acc: 0.560 Test Loss: 1.596 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559984).  Saving model ...
Epoch: 13 cost time: 1.5756597518920898
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.307 Vali Acc: 0.540 Test Loss: 1.307 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.414219617843628
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.615 Vali Acc: 0.480 Test Loss: 1.615 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3922491073608398
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.480 Test Loss: 1.843 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4372279644012451
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.929 Vali Acc: 0.480 Test Loss: 1.929 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7067296504974365
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.540 Test Loss: 1.928 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4206013679504395
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.580 Test Loss: 1.916 Test Acc: 0.580
Validation loss decreased (-0.559984 --> -0.579981).  Saving model ...
Epoch: 19 cost time: 1.6271705627441406
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.600 Test Loss: 1.939 Test Acc: 0.600
Validation loss decreased (-0.579981 --> -0.599981).  Saving model ...
Epoch: 20 cost time: 1.543980598449707
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.984 Vali Acc: 0.580 Test Loss: 1.984 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.401590347290039
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.041 Vali Acc: 0.580 Test Loss: 2.041 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.320403814315796
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.103 Vali Acc: 0.600 Test Loss: 2.103 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3659477233886719
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.600 Test Loss: 2.150 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3974523544311523
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.600 Test Loss: 2.182 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4446477890014648
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.212 Vali Acc: 0.600 Test Loss: 2.212 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3796520233154297
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.235 Vali Acc: 0.580 Test Loss: 2.235 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3684659004211426
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.261 Vali Acc: 0.580 Test Loss: 2.261 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.439436435699463
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.283 Vali Acc: 0.580 Test Loss: 2.283 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.497694969177246
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.292 Vali Acc: 0.580 Test Loss: 2.292 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 80802053
model size : 322.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8432023525238037
Epoch: 1, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.667 Vali Acc: 0.200 Test Loss: 1.667 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.1828458309173584
Epoch: 2, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.554 Vali Acc: 0.400 Test Loss: 1.554 Test Acc: 0.400
Validation loss decreased (-0.199983 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 1.1091649532318115
Epoch: 3, Steps: 4 | Train Loss: 1.120 Vali Loss: 1.488 Vali Acc: 0.400 Test Loss: 1.488 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.1826941967010498
Epoch: 4, Steps: 4 | Train Loss: 1.053 Vali Loss: 1.393 Vali Acc: 0.400 Test Loss: 1.393 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.2587907314300537
Epoch: 5, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.490 Vali Acc: 0.400 Test Loss: 1.490 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6788017749786377
Epoch: 6, Steps: 4 | Train Loss: 0.441 Vali Loss: 1.385 Vali Acc: 0.460 Test Loss: 1.385 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.7484533786773682
Epoch: 7, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.479292869567871
Epoch: 8, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.634 Vali Acc: 0.540 Test Loss: 1.634 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539984).  Saving model ...
Epoch: 9 cost time: 1.417011022567749
Epoch: 9, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.427 Vali Acc: 0.500 Test Loss: 1.427 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1992652416229248
Epoch: 10, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.496 Vali Acc: 0.480 Test Loss: 1.496 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8139376640319824
Epoch: 11, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.421 Vali Acc: 0.480 Test Loss: 1.421 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0175225734710693
Epoch: 12, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.694 Vali Acc: 0.480 Test Loss: 1.694 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.170487880706787
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.369 Vali Acc: 0.500 Test Loss: 1.369 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1766383647918701
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.822 Vali Acc: 0.460 Test Loss: 1.822 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.893648624420166
Epoch: 15, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.873 Vali Acc: 0.480 Test Loss: 1.873 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8438496589660645
Epoch: 16, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.770 Vali Acc: 0.500 Test Loss: 1.770 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2127337455749512
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.130 Vali Acc: 0.520 Test Loss: 2.130 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3177251815795898
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.604 Vali Acc: 0.480 Test Loss: 2.604 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 80683781
model size : 322.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.738077163696289
Epoch: 1, Steps: 4 | Train Loss: 1.766 Vali Loss: 1.614 Vali Acc: 0.280 Test Loss: 1.614 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 0.9784696102142334
Epoch: 2, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2584857940673828
Epoch: 3, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.522 Vali Acc: 0.400 Test Loss: 1.522 Test Acc: 0.400
Validation loss decreased (-0.279984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.082486629486084
Epoch: 4, Steps: 4 | Train Loss: 0.820 Vali Loss: 1.317 Vali Acc: 0.460 Test Loss: 1.317 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459987).  Saving model ...
Epoch: 5 cost time: 1.3119494915008545
Epoch: 5, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.498 Vali Acc: 0.520 Test Loss: 1.498 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519985).  Saving model ...
Epoch: 6 cost time: 0.9774136543273926
Epoch: 6, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.508 Vali Acc: 0.480 Test Loss: 1.508 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.171692132949829
Epoch: 7, Steps: 4 | Train Loss: 0.320 Vali Loss: 1.556 Vali Acc: 0.460 Test Loss: 1.556 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3814032077789307
Epoch: 8, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.420 Vali Acc: 0.540 Test Loss: 1.420 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539986).  Saving model ...
Epoch: 9 cost time: 1.6148529052734375
Epoch: 9, Steps: 4 | Train Loss: 0.235 Vali Loss: 1.472 Vali Acc: 0.600 Test Loss: 1.472 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599985).  Saving model ...
Epoch: 10 cost time: 1.051826000213623
Epoch: 10, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.857 Vali Acc: 0.580 Test Loss: 1.857 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0404973030090332
Epoch: 11, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.223 Vali Acc: 0.600 Test Loss: 1.223 Test Acc: 0.600
Validation loss decreased (-0.599985 --> -0.599988).  Saving model ...
Epoch: 12 cost time: 0.8848700523376465
Epoch: 12, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.555 Vali Acc: 0.540 Test Loss: 1.555 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8660745620727539
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.711 Vali Acc: 0.520 Test Loss: 1.711 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.124215841293335
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.429 Vali Acc: 0.520 Test Loss: 1.429 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2925920486450195
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.563 Vali Acc: 0.560 Test Loss: 1.563 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.255540370941162
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.560 Test Loss: 1.674 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5638089179992676
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.560 Test Loss: 1.736 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7253777980804443
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.580 Test Loss: 1.741 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3400182723999023
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.600 Test Loss: 1.756 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4524426460266113
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.560 Test Loss: 1.802 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5372602939605713
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.560 Test Loss: 1.848 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 84013829
model size : 335.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.925438165664673
Epoch: 1, Steps: 4 | Train Loss: 1.770 Vali Loss: 1.721 Vali Acc: 0.220 Test Loss: 1.721 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.2432990074157715
Epoch: 2, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.496 Vali Acc: 0.320 Test Loss: 1.496 Test Acc: 0.320
Validation loss decreased (-0.219983 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 0.9864375591278076
Epoch: 3, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.312 Vali Acc: 0.520 Test Loss: 1.312 Test Acc: 0.520
Validation loss decreased (-0.319985 --> -0.519987).  Saving model ...
Epoch: 4 cost time: 1.2037365436553955
Epoch: 4, Steps: 4 | Train Loss: 0.918 Vali Loss: 1.342 Vali Acc: 0.420 Test Loss: 1.342 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0242054462432861
Epoch: 5, Steps: 4 | Train Loss: 0.514 Vali Loss: 1.497 Vali Acc: 0.480 Test Loss: 1.497 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2015397548675537
Epoch: 6, Steps: 4 | Train Loss: 0.388 Vali Loss: 1.331 Vali Acc: 0.480 Test Loss: 1.331 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2691378593444824
Epoch: 7, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.393 Vali Acc: 0.480 Test Loss: 1.393 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1503150463104248
Epoch: 8, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.497 Vali Acc: 0.500 Test Loss: 1.497 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2171590328216553
Epoch: 9, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.578 Vali Acc: 0.520 Test Loss: 1.578 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3554983139038086
Epoch: 10, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.510 Vali Acc: 0.500 Test Loss: 1.510 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2117407321929932
Epoch: 11, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.611 Vali Acc: 0.460 Test Loss: 1.611 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.324110507965088
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.917 Vali Acc: 0.480 Test Loss: 1.917 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1603188514709473
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.904 Vali Acc: 0.480 Test Loss: 1.904 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 83863301
model size : 334.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.792576551437378
Epoch: 1, Steps: 4 | Train Loss: 1.767 Vali Loss: 1.707 Vali Acc: 0.200 Test Loss: 1.707 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.4137048721313477
Epoch: 2, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.487 Vali Acc: 0.240 Test Loss: 1.487 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.3256452083587646
Epoch: 3, Steps: 4 | Train Loss: 1.184 Vali Loss: 1.462 Vali Acc: 0.380 Test Loss: 1.462 Test Acc: 0.380
Validation loss decreased (-0.239985 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 1.2729980945587158
Epoch: 4, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.497 Vali Acc: 0.400 Test Loss: 1.497 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.1531407833099365
Epoch: 5, Steps: 4 | Train Loss: 0.786 Vali Loss: 1.373 Vali Acc: 0.460 Test Loss: 1.373 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 1.329472541809082
Epoch: 6, Steps: 4 | Train Loss: 0.593 Vali Loss: 1.395 Vali Acc: 0.500 Test Loss: 1.395 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 0.9941372871398926
Epoch: 7, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 1.0881974697113037
Epoch: 8, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.658 Vali Acc: 0.460 Test Loss: 1.658 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9292011260986328
Epoch: 9, Steps: 4 | Train Loss: 0.087 Vali Loss: 2.147 Vali Acc: 0.520 Test Loss: 2.147 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519979).  Saving model ...
Epoch: 10 cost time: 1.4908473491668701
Epoch: 10, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.405 Vali Acc: 0.540 Test Loss: 1.405 Test Acc: 0.540
Validation loss decreased (-0.519979 --> -0.539986).  Saving model ...
Epoch: 11 cost time: 1.1842217445373535
Epoch: 11, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.483 Vali Acc: 0.440 Test Loss: 2.483 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2847189903259277
Epoch: 12, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.724 Vali Acc: 0.480 Test Loss: 1.724 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2611289024353027
Epoch: 13, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.458 Vali Acc: 0.540 Test Loss: 1.458 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.413259744644165
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.992 Vali Acc: 0.420 Test Loss: 1.992 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0733845233917236
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.264 Vali Acc: 0.420 Test Loss: 2.264 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9155731201171875
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.143 Vali Acc: 0.440 Test Loss: 2.143 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1570231914520264
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.923 Vali Acc: 0.500 Test Loss: 1.923 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2938594818115234
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.821 Vali Acc: 0.540 Test Loss: 1.821 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.556190013885498
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.858 Vali Acc: 0.580 Test Loss: 1.858 Test Acc: 0.580
Validation loss decreased (-0.539986 --> -0.579981).  Saving model ...
Epoch: 20 cost time: 1.1993508338928223
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.969 Vali Acc: 0.540 Test Loss: 1.969 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2766807079315186
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.061 Vali Acc: 0.540 Test Loss: 2.061 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.401996374130249
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.107 Vali Acc: 0.560 Test Loss: 2.107 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6023032665252686
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.133 Vali Acc: 0.540 Test Loss: 2.133 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7468621730804443
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.540 Test Loss: 2.149 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5540647506713867
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.520 Test Loss: 2.158 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9554579257965088
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.520 Test Loss: 2.165 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4556818008422852
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.520 Test Loss: 2.166 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6968927383422852
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.159 Vali Acc: 0.520 Test Loss: 2.159 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9366562366485596
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.157 Vali Acc: 0.540 Test Loss: 2.157 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 83771909
model size : 334.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6776835918426514
Epoch: 1, Steps: 4 | Train Loss: 1.729 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.5761911869049072
Epoch: 2, Steps: 4 | Train Loss: 1.522 Vali Loss: 1.527 Vali Acc: 0.400 Test Loss: 1.527 Test Acc: 0.400
Validation loss decreased (-0.219984 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 1.5088038444519043
Epoch: 3, Steps: 4 | Train Loss: 1.182 Vali Loss: 1.437 Vali Acc: 0.400 Test Loss: 1.437 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.7345454692840576
Epoch: 4, Steps: 4 | Train Loss: 0.811 Vali Loss: 1.238 Vali Acc: 0.420 Test Loss: 1.238 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419988).  Saving model ...
Epoch: 5 cost time: 1.3067779541015625
Epoch: 5, Steps: 4 | Train Loss: 0.518 Vali Loss: 1.413 Vali Acc: 0.440 Test Loss: 1.413 Test Acc: 0.440
Validation loss decreased (-0.419988 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.3984949588775635
Epoch: 6, Steps: 4 | Train Loss: 0.424 Vali Loss: 1.338 Vali Acc: 0.360 Test Loss: 1.338 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.123401165008545
Epoch: 7, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.628 Vali Acc: 0.400 Test Loss: 1.628 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4231839179992676
Epoch: 8, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.217 Vali Acc: 0.460 Test Loss: 1.217 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459988).  Saving model ...
Epoch: 9 cost time: 1.513946533203125
Epoch: 9, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.928 Vali Acc: 0.420 Test Loss: 1.928 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0741910934448242
Epoch: 10, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.390 Vali Acc: 0.520 Test Loss: 1.390 Test Acc: 0.520
Validation loss decreased (-0.459988 --> -0.519986).  Saving model ...
Epoch: 11 cost time: 1.4068233966827393
Epoch: 11, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.585 Vali Acc: 0.540 Test Loss: 1.585 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539984).  Saving model ...
Epoch: 12 cost time: 1.6166086196899414
Epoch: 12, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7324817180633545
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.560 Test Loss: 1.675 Test Acc: 0.560
Validation loss decreased (-0.539984 --> -0.559983).  Saving model ...
Epoch: 14 cost time: 1.5623540878295898
Epoch: 14, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.584 Vali Acc: 0.580 Test Loss: 1.584 Test Acc: 0.580
Validation loss decreased (-0.559983 --> -0.579984).  Saving model ...
Epoch: 15 cost time: 1.3820090293884277
Epoch: 15, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.038 Vali Acc: 0.520 Test Loss: 2.038 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3545446395874023
Epoch: 16, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.385 Vali Acc: 0.580 Test Loss: 2.385 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.515169382095337
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.721 Vali Acc: 0.600 Test Loss: 1.721 Test Acc: 0.600
Validation loss decreased (-0.579984 --> -0.599983).  Saving model ...
Epoch: 18 cost time: 1.2893896102905273
Epoch: 18, Steps: 4 | Train Loss: 0.115 Vali Loss: 2.784 Vali Acc: 0.540 Test Loss: 2.784 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1395361423492432
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.695 Vali Acc: 0.540 Test Loss: 2.695 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0899558067321777
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.600 Test Loss: 2.120 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1176249980926514
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.824 Vali Acc: 0.600 Test Loss: 1.824 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.105229377746582
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.640 Test Loss: 1.724 Test Acc: 0.640
Validation loss decreased (-0.599983 --> -0.639983).  Saving model ...
Epoch: 23 cost time: 1.173316478729248
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.600 Test Loss: 1.782 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2900569438934326
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.600 Test Loss: 1.902 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.972409725189209
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.058 Vali Acc: 0.600 Test Loss: 2.058 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2664496898651123
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.580 Test Loss: 2.173 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3505795001983643
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.252 Vali Acc: 0.580 Test Loss: 2.252 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.385157823562622
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.298 Vali Acc: 0.600 Test Loss: 2.298 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2800817489624023
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.326 Vali Acc: 0.600 Test Loss: 2.326 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2859611511230469
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.337 Vali Acc: 0.600 Test Loss: 2.337 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2650833129882812
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.600 Test Loss: 2.340 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.352916955947876
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.338 Vali Acc: 0.600 Test Loss: 2.338 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 87112709
model size : 346.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.914547920227051
Epoch: 1, Steps: 4 | Train Loss: 1.744 Vali Loss: 1.670 Vali Acc: 0.140 Test Loss: 1.670 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.0962622165679932
Epoch: 2, Steps: 4 | Train Loss: 1.693 Vali Loss: 1.782 Vali Acc: 0.280 Test Loss: 1.782 Test Acc: 0.280
Validation loss decreased (-0.139983 --> -0.279982).  Saving model ...
Epoch: 3 cost time: 1.1309430599212646
Epoch: 3, Steps: 4 | Train Loss: 1.373 Vali Loss: 1.591 Vali Acc: 0.320 Test Loss: 1.591 Test Acc: 0.320
Validation loss decreased (-0.279982 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.2225778102874756
Epoch: 4, Steps: 4 | Train Loss: 1.095 Vali Loss: 1.398 Vali Acc: 0.360 Test Loss: 1.398 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359986).  Saving model ...
Epoch: 5 cost time: 1.0300512313842773
Epoch: 5, Steps: 4 | Train Loss: 0.720 Vali Loss: 1.503 Vali Acc: 0.380 Test Loss: 1.503 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 1.4811856746673584
Epoch: 6, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.596 Vali Acc: 0.420 Test Loss: 1.596 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419984).  Saving model ...
Epoch: 7 cost time: 1.417067050933838
Epoch: 7, Steps: 4 | Train Loss: 0.785 Vali Loss: 1.521 Vali Acc: 0.480 Test Loss: 1.521 Test Acc: 0.480
Validation loss decreased (-0.419984 --> -0.479985).  Saving model ...
Epoch: 8 cost time: 1.107151746749878
Epoch: 8, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.490 Vali Acc: 0.460 Test Loss: 1.490 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.558603048324585
Epoch: 9, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.668 Vali Acc: 0.480 Test Loss: 1.668 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.590075969696045
Epoch: 10, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.342 Vali Acc: 0.500 Test Loss: 1.342 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 1.5355985164642334
Epoch: 11, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.389 Vali Acc: 0.520 Test Loss: 1.389 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 1.4413642883300781
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.723 Vali Acc: 0.540 Test Loss: 1.723 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539983).  Saving model ...
Epoch: 13 cost time: 1.7868232727050781
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.732 Vali Acc: 0.540 Test Loss: 1.732 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3271939754486084
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.580 Vali Acc: 0.540 Test Loss: 1.580 Test Acc: 0.540
Validation loss decreased (-0.539983 --> -0.539984).  Saving model ...
Epoch: 15 cost time: 1.4335763454437256
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.623 Vali Acc: 0.520 Test Loss: 1.623 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6020362377166748
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.765 Vali Acc: 0.540 Test Loss: 1.765 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5280795097351074
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.520 Test Loss: 1.895 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.604954481124878
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.976 Vali Acc: 0.520 Test Loss: 1.976 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.66568922996521
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.520 Test Loss: 2.015 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7365546226501465
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.027 Vali Acc: 0.520 Test Loss: 2.027 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3428397178649902
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.520 Test Loss: 2.015 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.345336675643921
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.520 Test Loss: 1.997 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2561924457550049
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.974 Vali Acc: 0.520 Test Loss: 1.974 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3268182277679443
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.520 Test Loss: 1.958 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 86962181
model size : 346.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9573256969451904
Epoch: 1, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.550 Vali Acc: 0.280 Test Loss: 1.550 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.0540809631347656
Epoch: 2, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.545 Vali Acc: 0.300 Test Loss: 1.545 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.007939338684082
Epoch: 3, Steps: 4 | Train Loss: 1.176 Vali Loss: 1.559 Vali Acc: 0.300 Test Loss: 1.559 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9378566741943359
Epoch: 4, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.9267253875732422
Epoch: 5, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.340 Vali Acc: 0.440 Test Loss: 1.340 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 1.0753238201141357
Epoch: 6, Steps: 4 | Train Loss: 0.389 Vali Loss: 1.489 Vali Acc: 0.420 Test Loss: 1.489 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1366920471191406
Epoch: 7, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.234 Vali Acc: 0.460 Test Loss: 1.234 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459988).  Saving model ...
Epoch: 8 cost time: 1.4869985580444336
Epoch: 8, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.3753845691680908
Epoch: 9, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.807 Vali Acc: 0.440 Test Loss: 1.807 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4073550701141357
Epoch: 10, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.310725450515747
Epoch: 11, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.178 Vali Acc: 0.540 Test Loss: 1.178 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 1.298743486404419
Epoch: 12, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.452 Vali Acc: 0.480 Test Loss: 1.452 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5968751907348633
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.422 Vali Acc: 0.480 Test Loss: 1.422 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6759142875671387
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.563 Vali Acc: 0.520 Test Loss: 1.563 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.370406150817871
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.689 Vali Acc: 0.540 Test Loss: 1.689 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6622281074523926
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.475 Vali Acc: 0.520 Test Loss: 1.475 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.457062005996704
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.537 Vali Acc: 0.520 Test Loss: 1.537 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3075768947601318
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.411 Vali Acc: 0.580 Test Loss: 1.411 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579986).  Saving model ...
Epoch: 19 cost time: 1.544881820678711
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.644 Vali Acc: 0.560 Test Loss: 1.644 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2953009605407715
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.327 Vali Acc: 0.520 Test Loss: 2.327 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5553710460662842
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.943 Vali Acc: 0.540 Test Loss: 1.943 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.50654935836792
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.540 Test Loss: 1.621 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.328456163406372
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.650 Vali Acc: 0.540 Test Loss: 1.650 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6251237392425537
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.899 Vali Acc: 0.520 Test Loss: 1.899 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1187665462493896
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.076 Vali Acc: 0.520 Test Loss: 2.076 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5260889530181885
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.169 Vali Acc: 0.520 Test Loss: 2.169 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4841499328613281
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.196 Vali Acc: 0.520 Test Loss: 2.196 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.264636516571045
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.198 Vali Acc: 0.540 Test Loss: 2.198 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 86865413
model size : 346.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1465003490448
Epoch: 1, Steps: 4 | Train Loss: 1.738 Vali Loss: 1.602 Vali Acc: 0.200 Test Loss: 1.602 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.6824119091033936
Epoch: 2, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.600 Vali Acc: 0.220 Test Loss: 1.600 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.6859948635101318
Epoch: 3, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.515 Vali Acc: 0.360 Test Loss: 1.515 Test Acc: 0.360
Validation loss decreased (-0.219984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.9077677726745605
Epoch: 4, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.442 Vali Acc: 0.340 Test Loss: 1.442 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4498286247253418
Epoch: 5, Steps: 4 | Train Loss: 0.510 Vali Loss: 1.616 Vali Acc: 0.420 Test Loss: 1.616 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419984).  Saving model ...
Epoch: 6 cost time: 1.6460120677947998
Epoch: 6, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.465 Vali Acc: 0.380 Test Loss: 1.465 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9989778995513916
Epoch: 7, Steps: 4 | Train Loss: 0.212 Vali Loss: 1.481 Vali Acc: 0.440 Test Loss: 1.481 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439985).  Saving model ...
Epoch: 8 cost time: 1.8037254810333252
Epoch: 8, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.432 Vali Acc: 0.460 Test Loss: 1.432 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 9 cost time: 1.515009880065918
Epoch: 9, Steps: 4 | Train Loss: 0.064 Vali Loss: 2.572 Vali Acc: 0.440 Test Loss: 2.572 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7220826148986816
Epoch: 10, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.985 Vali Acc: 0.460 Test Loss: 1.985 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3857369422912598
Epoch: 11, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.824 Vali Acc: 0.460 Test Loss: 1.824 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8183531761169434
Epoch: 12, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.804 Vali Acc: 0.540 Test Loss: 1.804 Test Acc: 0.540
Validation loss decreased (-0.459986 --> -0.539982).  Saving model ...
Epoch: 13 cost time: 1.573897123336792
Epoch: 13, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.527 Vali Acc: 0.460 Test Loss: 2.527 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.528674602508545
Epoch: 14, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.354 Vali Acc: 0.540 Test Loss: 1.354 Test Acc: 0.540
Validation loss decreased (-0.539982 --> -0.539986).  Saving model ...
Epoch: 15 cost time: 1.3736345767974854
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.914 Vali Acc: 0.480 Test Loss: 1.914 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5653598308563232
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.402 Vali Acc: 0.500 Test Loss: 2.402 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.815213918685913
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.289 Vali Acc: 0.520 Test Loss: 2.289 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.66707181930542
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.310 Vali Acc: 0.500 Test Loss: 2.310 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.559952735900879
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.391 Vali Acc: 0.540 Test Loss: 2.391 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6219351291656494
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.454 Vali Acc: 0.540 Test Loss: 2.454 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7154901027679443
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.456 Vali Acc: 0.540 Test Loss: 2.456 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5965025424957275
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.432 Vali Acc: 0.540 Test Loss: 2.432 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5871868133544922
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.363 Vali Acc: 0.540 Test Loss: 2.363 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2791166305541992
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.520 Test Loss: 2.319 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 90206213
model size : 358.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5513298511505127
Epoch: 1, Steps: 4 | Train Loss: 1.717 Vali Loss: 1.633 Vali Acc: 0.240 Test Loss: 1.633 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 0.8877089023590088
Epoch: 2, Steps: 4 | Train Loss: 1.464 Vali Loss: 1.618 Vali Acc: 0.300 Test Loss: 1.618 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.3948209285736084
Epoch: 3, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.657 Vali Acc: 0.320 Test Loss: 1.657 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 1.1492125988006592
Epoch: 4, Steps: 4 | Train Loss: 0.758 Vali Loss: 1.435 Vali Acc: 0.440 Test Loss: 1.435 Test Acc: 0.440
Validation loss decreased (-0.319983 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.443993330001831
Epoch: 5, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.520 Vali Acc: 0.460 Test Loss: 1.520 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459985).  Saving model ...
Epoch: 6 cost time: 1.3609504699707031
Epoch: 6, Steps: 4 | Train Loss: 0.405 Vali Loss: 1.242 Vali Acc: 0.480 Test Loss: 1.242 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479988).  Saving model ...
Epoch: 7 cost time: 1.2532587051391602
Epoch: 7, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.478 Vali Acc: 0.480 Test Loss: 1.478 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2156054973602295
Epoch: 8, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.665 Vali Acc: 0.460 Test Loss: 1.665 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.278101921081543
Epoch: 9, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.590 Vali Acc: 0.480 Test Loss: 1.590 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4691619873046875
Epoch: 10, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.596 Vali Acc: 0.540 Test Loss: 1.596 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539984).  Saving model ...
Epoch: 11 cost time: 1.4965689182281494
Epoch: 11, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.580 Vali Acc: 0.520 Test Loss: 1.580 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4148023128509521
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.633 Vali Acc: 0.540 Test Loss: 1.633 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3455445766448975
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.893 Vali Acc: 0.520 Test Loss: 1.893 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.108936071395874
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.195 Vali Acc: 0.500 Test Loss: 2.195 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1634588241577148
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.996 Vali Acc: 0.480 Test Loss: 1.996 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3082671165466309
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.396 Vali Acc: 0.460 Test Loss: 2.396 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2469329833984375
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.938 Vali Acc: 0.440 Test Loss: 2.938 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3579988479614258
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.708 Vali Acc: 0.440 Test Loss: 2.708 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2718501091003418
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.474 Vali Acc: 0.500 Test Loss: 2.474 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3195624351501465
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.348 Vali Acc: 0.520 Test Loss: 2.348 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 90034181
model size : 358.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.094681739807129
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.617 Vali Acc: 0.100 Test Loss: 1.617 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 1.536184549331665
Epoch: 2, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.491 Vali Acc: 0.280 Test Loss: 1.491 Test Acc: 0.280
Validation loss decreased (-0.099984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.19374680519104
Epoch: 3, Steps: 4 | Train Loss: 1.250 Vali Loss: 1.444 Vali Acc: 0.440 Test Loss: 1.444 Test Acc: 0.440
Validation loss decreased (-0.279985 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 1.4174606800079346
Epoch: 4, Steps: 4 | Train Loss: 0.691 Vali Loss: 1.369 Vali Acc: 0.500 Test Loss: 1.369 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 1.2653570175170898
Epoch: 5, Steps: 4 | Train Loss: 0.427 Vali Loss: 1.376 Vali Acc: 0.520 Test Loss: 1.376 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 1.476426601409912
Epoch: 6, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.408 Vali Acc: 0.460 Test Loss: 1.408 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4929437637329102
Epoch: 7, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2805759906768799
Epoch: 8, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.332 Vali Acc: 0.480 Test Loss: 1.332 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.152681589126587
Epoch: 9, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.495 Vali Acc: 0.500 Test Loss: 1.495 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3273131847381592
Epoch: 10, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.492 Vali Acc: 0.460 Test Loss: 1.492 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.132690668106079
Epoch: 11, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.339 Vali Acc: 0.500 Test Loss: 1.339 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.210052490234375
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.426 Vali Acc: 0.520 Test Loss: 1.426 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2223179340362549
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.483 Vali Acc: 0.540 Test Loss: 1.483 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539985).  Saving model ...
Epoch: 14 cost time: 1.686310052871704
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.397 Vali Acc: 0.540 Test Loss: 1.397 Test Acc: 0.540
Validation loss decreased (-0.539985 --> -0.539986).  Saving model ...
Epoch: 15 cost time: 1.460832118988037
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.469 Vali Acc: 0.500 Test Loss: 1.469 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0830466747283936
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.499 Vali Acc: 0.460 Test Loss: 1.499 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4724338054656982
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.476 Vali Acc: 0.540 Test Loss: 1.476 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.477419376373291
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.470 Vali Acc: 0.560 Test Loss: 1.470 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559985).  Saving model ...
Epoch: 19 cost time: 1.354304552078247
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.560 Test Loss: 1.479 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.700153112411499
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.560 Test Loss: 1.531 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.180797815322876
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.560 Test Loss: 1.575 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.171004295349121
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.560 Test Loss: 1.621 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.419450044631958
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.540 Test Loss: 1.676 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7249367237091064
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.718 Vali Acc: 0.540 Test Loss: 1.718 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9940974712371826
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.540 Test Loss: 1.739 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5365560054779053
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.560 Test Loss: 1.746 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2015979290008545
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.560 Test Loss: 1.748 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2739379405975342
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.560 Test Loss: 1.748 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 89958917
model size : 357.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3037149906158447
Epoch: 1, Steps: 4 | Train Loss: 1.819 Vali Loss: 1.647 Vali Acc: 0.120 Test Loss: 1.647 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.5340569019317627
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.603 Vali Acc: 0.340 Test Loss: 1.603 Test Acc: 0.340
Validation loss decreased (-0.119984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.503145456314087
Epoch: 3, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.611 Vali Acc: 0.400 Test Loss: 1.611 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 1.5524272918701172
Epoch: 4, Steps: 4 | Train Loss: 0.681 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.5338385105133057
Epoch: 5, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.599 Vali Acc: 0.420 Test Loss: 1.599 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419984).  Saving model ...
Epoch: 6 cost time: 1.5062980651855469
Epoch: 6, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.572 Vali Acc: 0.400 Test Loss: 1.572 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0599110126495361
Epoch: 7, Steps: 4 | Train Loss: 0.130 Vali Loss: 2.022 Vali Acc: 0.420 Test Loss: 2.022 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2291152477264404
Epoch: 8, Steps: 4 | Train Loss: 0.080 Vali Loss: 2.048 Vali Acc: 0.400 Test Loss: 2.048 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3211956024169922
Epoch: 9, Steps: 4 | Train Loss: 0.062 Vali Loss: 2.325 Vali Acc: 0.440 Test Loss: 2.325 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439977).  Saving model ...
Epoch: 10 cost time: 1.9118146896362305
Epoch: 10, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.607 Vali Acc: 0.460 Test Loss: 1.607 Test Acc: 0.460
Validation loss decreased (-0.439977 --> -0.459984).  Saving model ...
Epoch: 11 cost time: 1.4012441635131836
Epoch: 11, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.805 Vali Acc: 0.460 Test Loss: 1.805 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.632350206375122
Epoch: 12, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.546 Vali Acc: 0.460 Test Loss: 2.546 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1561505794525146
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.854 Vali Acc: 0.460 Test Loss: 1.854 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1500930786132812
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.189 Vali Acc: 0.460 Test Loss: 2.189 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.145594835281372
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.192 Vali Acc: 0.440 Test Loss: 2.192 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5123546123504639
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.255 Vali Acc: 0.480 Test Loss: 2.255 Test Acc: 0.480
Validation loss decreased (-0.459984 --> -0.479977).  Saving model ...
Epoch: 17 cost time: 1.6848795413970947
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.303 Vali Acc: 0.440 Test Loss: 2.303 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3122618198394775
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.264 Vali Acc: 0.520 Test Loss: 2.264 Test Acc: 0.520
Validation loss decreased (-0.479977 --> -0.519977).  Saving model ...
Epoch: 19 cost time: 1.4291536808013916
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.480 Test Loss: 2.197 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4724750518798828
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.242 Vali Acc: 0.480 Test Loss: 2.242 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3814899921417236
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.287 Vali Acc: 0.520 Test Loss: 2.287 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.626945972442627
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.520 Test Loss: 2.313 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.426926612854004
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.327 Vali Acc: 0.540 Test Loss: 2.327 Test Acc: 0.540
Validation loss decreased (-0.519977 --> -0.539977).  Saving model ...
Epoch: 24 cost time: 1.3990137577056885
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.339 Vali Acc: 0.540 Test Loss: 2.339 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4301650524139404
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.353 Vali Acc: 0.560 Test Loss: 2.353 Test Acc: 0.560
Validation loss decreased (-0.539977 --> -0.559976).  Saving model ...
Epoch: 26 cost time: 1.3409755229949951
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.560 Test Loss: 2.370 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.531402349472046
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.560 Test Loss: 2.388 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.407653570175171
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.403 Vali Acc: 0.560 Test Loss: 2.403 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5482995510101318
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.414 Vali Acc: 0.540 Test Loss: 2.414 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4170153141021729
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.424 Vali Acc: 0.540 Test Loss: 2.424 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4248337745666504
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.430 Vali Acc: 0.540 Test Loss: 2.430 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3333184719085693
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.432 Vali Acc: 0.540 Test Loss: 2.432 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4844045639038086
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.434 Vali Acc: 0.540 Test Loss: 2.434 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6445927619934082
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.437 Vali Acc: 0.540 Test Loss: 2.437 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3670592308044434
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.438 Vali Acc: 0.540 Test Loss: 2.438 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 93305093
model size : 370.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.628831148147583
Epoch: 1, Steps: 4 | Train Loss: 1.749 Vali Loss: 1.639 Vali Acc: 0.160 Test Loss: 1.639 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.141775369644165
Epoch: 2, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.554 Vali Acc: 0.340 Test Loss: 1.554 Test Acc: 0.340
Validation loss decreased (-0.159984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.0957279205322266
Epoch: 3, Steps: 4 | Train Loss: 1.258 Vali Loss: 1.424 Vali Acc: 0.440 Test Loss: 1.424 Test Acc: 0.440
Validation loss decreased (-0.339984 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 0.9091849327087402
Epoch: 4, Steps: 4 | Train Loss: 0.653 Vali Loss: 1.376 Vali Acc: 0.480 Test Loss: 1.376 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 5 cost time: 1.1948084831237793
Epoch: 5, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.344 Vali Acc: 0.460 Test Loss: 1.344 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2400462627410889
Epoch: 6, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.528 Vali Acc: 0.480 Test Loss: 1.528 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1814095973968506
Epoch: 7, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.215 Vali Acc: 0.540 Test Loss: 1.215 Test Acc: 0.540
Validation loss decreased (-0.479986 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 1.0997686386108398
Epoch: 8, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.495 Vali Acc: 0.520 Test Loss: 1.495 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9611537456512451
Epoch: 9, Steps: 4 | Train Loss: 0.133 Vali Loss: 1.550 Vali Acc: 0.460 Test Loss: 1.550 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9978857040405273
Epoch: 10, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.488 Vali Acc: 0.460 Test Loss: 1.488 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.188711404800415
Epoch: 11, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1168749332427979
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.634 Vali Acc: 0.460 Test Loss: 1.634 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3245432376861572
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.873 Vali Acc: 0.500 Test Loss: 1.873 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.121171474456787
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.441 Vali Acc: 0.440 Test Loss: 2.441 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0626513957977295
Epoch: 15, Steps: 4 | Train Loss: 0.044 Vali Loss: 2.062 Vali Acc: 0.500 Test Loss: 2.062 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3537585735321045
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.580 Test Loss: 1.669 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579983).  Saving model ...
Epoch: 17 cost time: 0.8990597724914551
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.396 Vali Acc: 0.600 Test Loss: 1.396 Test Acc: 0.600
Validation loss decreased (-0.579983 --> -0.599986).  Saving model ...
Epoch: 18 cost time: 1.0810530185699463
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.354 Vali Acc: 0.600 Test Loss: 1.354 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599986).  Saving model ...
Epoch: 19 cost time: 1.041684627532959
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.500 Test Loss: 1.846 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9481399059295654
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.438 Vali Acc: 0.460 Test Loss: 2.438 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.265505075454712
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.554 Vali Acc: 0.460 Test Loss: 2.554 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2591729164123535
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.698 Vali Acc: 0.420 Test Loss: 2.698 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0270450115203857
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.392 Vali Acc: 0.440 Test Loss: 2.392 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2864155769348145
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.480 Test Loss: 2.171 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0086205005645752
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.520 Test Loss: 2.050 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0281085968017578
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.500 Test Loss: 1.983 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0850293636322021
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.950 Vali Acc: 0.500 Test Loss: 1.950 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0115299224853516
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.540 Test Loss: 1.945 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 93133061
model size : 369.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.858201503753662
Epoch: 1, Steps: 4 | Train Loss: 1.709 Vali Loss: 1.629 Vali Acc: 0.200 Test Loss: 1.629 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.3885509967803955
Epoch: 2, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.566 Vali Acc: 0.280 Test Loss: 1.566 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.1611151695251465
Epoch: 3, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.440 Vali Acc: 0.380 Test Loss: 1.440 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 1.1164515018463135
Epoch: 4, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.398 Vali Acc: 0.360 Test Loss: 1.398 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.04274320602417
Epoch: 5, Steps: 4 | Train Loss: 0.660 Vali Loss: 1.416 Vali Acc: 0.460 Test Loss: 1.416 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 1.1848936080932617
Epoch: 6, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.9961209297180176
Epoch: 7, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.466 Vali Acc: 0.440 Test Loss: 1.466 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0173869132995605
Epoch: 8, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.768 Vali Acc: 0.440 Test Loss: 1.768 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4658455848693848
Epoch: 9, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.680 Vali Acc: 0.420 Test Loss: 1.680 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.031529426574707
Epoch: 10, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.262 Vali Acc: 0.520 Test Loss: 1.262 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 1.185917615890503
Epoch: 11, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.439 Vali Acc: 0.540 Test Loss: 1.439 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539986).  Saving model ...
Epoch: 12 cost time: 1.2301254272460938
Epoch: 12, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.441 Vali Acc: 0.500 Test Loss: 1.441 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.23689603805542
Epoch: 13, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.813 Vali Acc: 0.480 Test Loss: 1.813 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2201497554779053
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.005 Vali Acc: 0.460 Test Loss: 2.005 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2179629802703857
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.604 Vali Acc: 0.500 Test Loss: 1.604 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1030654907226562
Epoch: 16, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.596 Vali Acc: 0.540 Test Loss: 1.596 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1828629970550537
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.060 Vali Acc: 0.440 Test Loss: 2.060 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2054450511932373
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.230 Vali Acc: 0.400 Test Loss: 2.230 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2700583934783936
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.232 Vali Acc: 0.400 Test Loss: 2.232 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1309773921966553
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.132 Vali Acc: 0.400 Test Loss: 2.132 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.299513578414917
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.017 Vali Acc: 0.440 Test Loss: 2.017 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 93047045
model size : 369.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.920682430267334
Epoch: 1, Steps: 4 | Train Loss: 1.760 Vali Loss: 1.693 Vali Acc: 0.180 Test Loss: 1.693 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.2251007556915283
Epoch: 2, Steps: 4 | Train Loss: 1.735 Vali Loss: 1.598 Vali Acc: 0.280 Test Loss: 1.598 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.1483232975006104
Epoch: 3, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.453 Vali Acc: 0.360 Test Loss: 1.453 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.1236114501953125
Epoch: 4, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.640 Vali Acc: 0.460 Test Loss: 1.640 Test Acc: 0.460
Validation loss decreased (-0.359985 --> -0.459984).  Saving model ...
Epoch: 5 cost time: 1.3416104316711426
Epoch: 5, Steps: 4 | Train Loss: 0.382 Vali Loss: 1.974 Vali Acc: 0.400 Test Loss: 1.974 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2517108917236328
Epoch: 6, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.714 Vali Acc: 0.480 Test Loss: 1.714 Test Acc: 0.480
Validation loss decreased (-0.459984 --> -0.479983).  Saving model ...
Epoch: 7 cost time: 1.48759126663208
Epoch: 7, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.472 Vali Acc: 0.540 Test Loss: 1.472 Test Acc: 0.540
Validation loss decreased (-0.479983 --> -0.539985).  Saving model ...
Epoch: 8 cost time: 1.5353507995605469
Epoch: 8, Steps: 4 | Train Loss: 0.070 Vali Loss: 2.016 Vali Acc: 0.500 Test Loss: 2.016 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.359665870666504
Epoch: 9, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.380 Vali Acc: 0.600 Test Loss: 1.380 Test Acc: 0.600
Validation loss decreased (-0.539985 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 1.5668847560882568
Epoch: 10, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.849 Vali Acc: 0.560 Test Loss: 1.849 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.271303653717041
Epoch: 11, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.974 Vali Acc: 0.500 Test Loss: 1.974 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4596657752990723
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.618 Vali Acc: 0.580 Test Loss: 1.618 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.442918062210083
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.886 Vali Acc: 0.500 Test Loss: 1.886 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2468013763427734
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.037 Vali Acc: 0.500 Test Loss: 2.037 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0563056468963623
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.032 Vali Acc: 0.500 Test Loss: 2.032 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3176207542419434
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.011 Vali Acc: 0.540 Test Loss: 2.011 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3741159439086914
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.520 Test Loss: 2.029 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.316237449645996
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.063 Vali Acc: 0.520 Test Loss: 2.063 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2026805877685547
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.540 Test Loss: 2.106 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 96334085
model size : 382.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7850818634033203
Epoch: 1, Steps: 4 | Train Loss: 1.785 Vali Loss: 1.592 Vali Acc: 0.100 Test Loss: 1.592 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 1.7537574768066406
Epoch: 2, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.621 Vali Acc: 0.180 Test Loss: 1.621 Test Acc: 0.180
Validation loss decreased (-0.099984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.252277135848999
Epoch: 3, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.519 Vali Acc: 0.320 Test Loss: 1.519 Test Acc: 0.320
Validation loss decreased (-0.179984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.3172175884246826
Epoch: 4, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.371 Vali Acc: 0.480 Test Loss: 1.371 Test Acc: 0.480
Validation loss decreased (-0.319985 --> -0.479986).  Saving model ...
Epoch: 5 cost time: 1.2444283962249756
Epoch: 5, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.324 Vali Acc: 0.420 Test Loss: 1.324 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0315303802490234
Epoch: 6, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.463 Vali Acc: 0.400 Test Loss: 1.463 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.253502607345581
Epoch: 7, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.346 Vali Acc: 0.440 Test Loss: 1.346 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.190596342086792
Epoch: 8, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.581 Vali Acc: 0.460 Test Loss: 1.581 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2272109985351562
Epoch: 9, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.572 Vali Acc: 0.440 Test Loss: 1.572 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4212677478790283
Epoch: 10, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.484 Vali Acc: 0.500 Test Loss: 1.484 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 1.3337733745574951
Epoch: 11, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.276 Vali Acc: 0.520 Test Loss: 1.276 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519987).  Saving model ...
Epoch: 12 cost time: 1.1135568618774414
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.714 Vali Acc: 0.460 Test Loss: 1.714 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.276641845703125
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.723 Vali Acc: 0.480 Test Loss: 1.723 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3683414459228516
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.906 Vali Acc: 0.480 Test Loss: 1.906 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.341686487197876
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.812 Vali Acc: 0.500 Test Loss: 1.812 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4697751998901367
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.757 Vali Acc: 0.540 Test Loss: 1.757 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539982).  Saving model ...
Epoch: 17 cost time: 1.700282096862793
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.757 Vali Acc: 0.500 Test Loss: 1.757 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5430841445922852
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.805 Vali Acc: 0.500 Test Loss: 1.805 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.185762882232666
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.231 Vali Acc: 0.520 Test Loss: 2.231 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1661136150360107
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.011 Vali Acc: 0.540 Test Loss: 2.011 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2569093704223633
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.035 Vali Acc: 0.520 Test Loss: 2.035 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2999157905578613
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.560 Test Loss: 1.895 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559981).  Saving model ...
Epoch: 23 cost time: 1.3433549404144287
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.580 Test Loss: 1.799 Test Acc: 0.580
Validation loss decreased (-0.559981 --> -0.579982).  Saving model ...
Epoch: 24 cost time: 1.4916486740112305
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.944 Vali Acc: 0.500 Test Loss: 1.944 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6788640022277832
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.123 Vali Acc: 0.540 Test Loss: 2.123 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5389766693115234
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.244 Vali Acc: 0.520 Test Loss: 2.244 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2349574565887451
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.268 Vali Acc: 0.500 Test Loss: 2.268 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.172071933746338
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.278 Vali Acc: 0.500 Test Loss: 2.278 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.26777982711792
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.286 Vali Acc: 0.520 Test Loss: 2.286 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2312912940979004
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.302 Vali Acc: 0.520 Test Loss: 2.302 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3288092613220215
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.500 Test Loss: 2.323 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3043465614318848
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.343 Vali Acc: 0.500 Test Loss: 2.343 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.095658779144287
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.356 Vali Acc: 0.500 Test Loss: 2.356 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 96215813
model size : 381.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.828014850616455
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.598 Vali Acc: 0.180 Test Loss: 1.598 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.227484941482544
Epoch: 2, Steps: 4 | Train Loss: 1.468 Vali Loss: 1.427 Vali Acc: 0.360 Test Loss: 1.427 Test Acc: 0.360
Validation loss decreased (-0.179984 --> -0.359986).  Saving model ...
Epoch: 3 cost time: 1.188053846359253
Epoch: 3, Steps: 4 | Train Loss: 1.042 Vali Loss: 1.343 Vali Acc: 0.340 Test Loss: 1.343 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2314817905426025
Epoch: 4, Steps: 4 | Train Loss: 0.896 Vali Loss: 1.288 Vali Acc: 0.380 Test Loss: 1.288 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379987).  Saving model ...
Epoch: 5 cost time: 1.3466646671295166
Epoch: 5, Steps: 4 | Train Loss: 0.721 Vali Loss: 1.374 Vali Acc: 0.380 Test Loss: 1.374 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0734050273895264
Epoch: 6, Steps: 4 | Train Loss: 0.291 Vali Loss: 1.188 Vali Acc: 0.420 Test Loss: 1.188 Test Acc: 0.420
Validation loss decreased (-0.379987 --> -0.419988).  Saving model ...
Epoch: 7 cost time: 1.3337674140930176
Epoch: 7, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.379 Vali Acc: 0.440 Test Loss: 1.379 Test Acc: 0.440
Validation loss decreased (-0.419988 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 1.2459957599639893
Epoch: 8, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.361 Vali Acc: 0.460 Test Loss: 1.361 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 9 cost time: 1.551164150238037
Epoch: 9, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.383 Vali Acc: 0.440 Test Loss: 1.383 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2758746147155762
Epoch: 10, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.789 Vali Acc: 0.440 Test Loss: 1.789 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.300184965133667
Epoch: 11, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.282 Vali Acc: 0.460 Test Loss: 1.282 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459987).  Saving model ...
Epoch: 12 cost time: 1.4260132312774658
Epoch: 12, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.353 Vali Acc: 0.440 Test Loss: 1.353 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2997558116912842
Epoch: 13, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.297 Vali Acc: 0.460 Test Loss: 1.297 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.337054967880249
Epoch: 14, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.365 Vali Acc: 0.500 Test Loss: 1.365 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499986).  Saving model ...
Epoch: 15 cost time: 1.4335336685180664
Epoch: 15, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.695 Vali Acc: 0.480 Test Loss: 1.695 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5574944019317627
Epoch: 16, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.802 Vali Acc: 0.460 Test Loss: 1.802 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0787503719329834
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.744 Vali Acc: 0.500 Test Loss: 1.744 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4394190311431885
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.636 Vali Acc: 0.520 Test Loss: 1.636 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519984).  Saving model ...
Epoch: 19 cost time: 1.1595244407653809
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.650 Vali Acc: 0.520 Test Loss: 1.650 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.998866081237793
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.480 Test Loss: 1.816 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3184137344360352
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.969 Vali Acc: 0.480 Test Loss: 1.969 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1463220119476318
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.039 Vali Acc: 0.480 Test Loss: 2.039 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.595320701599121
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.029 Vali Acc: 0.480 Test Loss: 2.029 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.549022912979126
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.480 Test Loss: 2.012 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3961009979248047
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.988 Vali Acc: 0.480 Test Loss: 1.988 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2918009757995605
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.480 Test Loss: 1.963 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.163020372390747
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.948 Vali Acc: 0.480 Test Loss: 1.948 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1426880359649658
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.959 Vali Acc: 0.500 Test Loss: 1.959 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 96140549
model size : 381.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2829463481903076
Epoch: 1, Steps: 4 | Train Loss: 1.801 Vali Loss: 1.608 Vali Acc: 0.260 Test Loss: 1.608 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.259725570678711
Epoch: 2, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
Validation loss decreased (-0.259984 --> -0.419985).  Saving model ...
Epoch: 3 cost time: 1.2939565181732178
Epoch: 3, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.488 Vali Acc: 0.360 Test Loss: 1.488 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2012603282928467
Epoch: 4, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.405 Vali Acc: 0.340 Test Loss: 1.405 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.404456377029419
Epoch: 5, Steps: 4 | Train Loss: 0.454 Vali Loss: 1.292 Vali Acc: 0.360 Test Loss: 1.292 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2356834411621094
Epoch: 6, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.740 Vali Acc: 0.360 Test Loss: 1.740 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4478309154510498
Epoch: 7, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.480 Vali Acc: 0.440 Test Loss: 1.480 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439985).  Saving model ...
Epoch: 8 cost time: 1.284040927886963
Epoch: 8, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.998 Vali Acc: 0.360 Test Loss: 1.998 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1250333786010742
Epoch: 9, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.654 Vali Acc: 0.500 Test Loss: 1.654 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499983).  Saving model ...
Epoch: 10 cost time: 1.1452271938323975
Epoch: 10, Steps: 4 | Train Loss: 0.069 Vali Loss: 2.016 Vali Acc: 0.480 Test Loss: 2.016 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4241409301757812
Epoch: 11, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.622 Vali Acc: 0.500 Test Loss: 1.622 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499984).  Saving model ...
Epoch: 12 cost time: 1.2134597301483154
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.814 Vali Acc: 0.520 Test Loss: 1.814 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519982).  Saving model ...
Epoch: 13 cost time: 1.6387965679168701
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.303 Vali Acc: 0.500 Test Loss: 2.303 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6325123310089111
Epoch: 14, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.028 Vali Acc: 0.540 Test Loss: 2.028 Test Acc: 0.540
Validation loss decreased (-0.519982 --> -0.539980).  Saving model ...
Epoch: 15 cost time: 1.6256399154663086
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.608 Vali Acc: 0.560 Test Loss: 1.608 Test Acc: 0.560
Validation loss decreased (-0.539980 --> -0.559984).  Saving model ...
Epoch: 16 cost time: 1.6213388442993164
Epoch: 16, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.042 Vali Acc: 0.520 Test Loss: 2.042 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4778351783752441
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.906 Vali Acc: 0.440 Test Loss: 2.906 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5997838973999023
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.498 Vali Acc: 0.520 Test Loss: 2.498 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4381616115570068
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.869 Vali Acc: 0.460 Test Loss: 2.869 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.563467264175415
Epoch: 20, Steps: 4 | Train Loss: 0.095 Vali Loss: 3.592 Vali Acc: 0.460 Test Loss: 3.592 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.489030361175537
Epoch: 21, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.653 Vali Acc: 0.540 Test Loss: 1.653 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.442763090133667
Epoch: 22, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.954 Vali Acc: 0.540 Test Loss: 1.954 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3739044666290283
Epoch: 23, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.793 Vali Acc: 0.540 Test Loss: 1.793 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.531078815460205
Epoch: 24, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.071 Vali Acc: 0.540 Test Loss: 2.071 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.463231086730957
Epoch: 25, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.356 Vali Acc: 0.560 Test Loss: 2.356 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 99432965
model size : 393.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7862000465393066
Epoch: 1, Steps: 4 | Train Loss: 1.755 Vali Loss: 1.697 Vali Acc: 0.120 Test Loss: 1.697 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.5712835788726807
Epoch: 2, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.808 Vali Acc: 0.260 Test Loss: 1.808 Test Acc: 0.260
Validation loss decreased (-0.119983 --> -0.259982).  Saving model ...
Epoch: 3 cost time: 1.5534439086914062
Epoch: 3, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.678 Vali Acc: 0.400 Test Loss: 1.678 Test Acc: 0.400
Validation loss decreased (-0.259982 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 1.3652944564819336
Epoch: 4, Steps: 4 | Train Loss: 0.767 Vali Loss: 1.663 Vali Acc: 0.340 Test Loss: 1.663 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5773260593414307
Epoch: 5, Steps: 4 | Train Loss: 0.455 Vali Loss: 1.544 Vali Acc: 0.360 Test Loss: 1.544 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4435603618621826
Epoch: 6, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.573 Vali Acc: 0.460 Test Loss: 1.573 Test Acc: 0.460
Validation loss decreased (-0.399983 --> -0.459984).  Saving model ...
Epoch: 7 cost time: 1.6125092506408691
Epoch: 7, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.427 Vali Acc: 0.400 Test Loss: 1.427 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6563127040863037
Epoch: 8, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.557 Vali Acc: 0.380 Test Loss: 1.557 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4045064449310303
Epoch: 9, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.357 Vali Acc: 0.460 Test Loss: 1.357 Test Acc: 0.460
Validation loss decreased (-0.459984 --> -0.459986).  Saving model ...
Epoch: 10 cost time: 1.424306869506836
Epoch: 10, Steps: 4 | Train Loss: 0.033 Vali Loss: 2.320 Vali Acc: 0.460 Test Loss: 2.320 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5004100799560547
Epoch: 11, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.551 Vali Acc: 0.380 Test Loss: 1.551 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.206535816192627
Epoch: 12, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.878 Vali Acc: 0.480 Test Loss: 1.878 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479981).  Saving model ...
Epoch: 13 cost time: 1.4425036907196045
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.713 Vali Acc: 0.500 Test Loss: 1.713 Test Acc: 0.500
Validation loss decreased (-0.479981 --> -0.499983).  Saving model ...
Epoch: 14 cost time: 1.3977584838867188
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.623 Vali Acc: 0.560 Test Loss: 1.623 Test Acc: 0.560
Validation loss decreased (-0.499983 --> -0.559984).  Saving model ...
Epoch: 15 cost time: 1.724498987197876
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.542 Vali Acc: 0.540 Test Loss: 1.542 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9145457744598389
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.620 Vali Acc: 0.580 Test Loss: 1.620 Test Acc: 0.580
Validation loss decreased (-0.559984 --> -0.579984).  Saving model ...
Epoch: 17 cost time: 1.65153169631958
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.560 Test Loss: 1.801 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.598464012145996
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.045 Vali Acc: 0.560 Test Loss: 2.045 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.633554458618164
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.170 Vali Acc: 0.580 Test Loss: 2.170 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4428889751434326
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.173 Vali Acc: 0.580 Test Loss: 2.173 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7862114906311035
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.071 Vali Acc: 0.560 Test Loss: 2.071 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5363240242004395
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.560 Test Loss: 1.948 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.496762752532959
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.560 Test Loss: 1.878 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.849696397781372
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.580 Test Loss: 1.839 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2936625480651855
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.560 Test Loss: 1.824 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.186274290084839
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.580 Test Loss: 1.835 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 99314693
model size : 393.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.376086711883545
Epoch: 1, Steps: 4 | Train Loss: 1.685 Vali Loss: 1.623 Vali Acc: 0.120 Test Loss: 1.623 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 2.018983840942383
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.509 Vali Acc: 0.300 Test Loss: 1.509 Test Acc: 0.300
Validation loss decreased (-0.119984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 2.203503131866455
Epoch: 3, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.482 Vali Acc: 0.320 Test Loss: 1.482 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 2.0002198219299316
Epoch: 4, Steps: 4 | Train Loss: 0.897 Vali Loss: 1.524 Vali Acc: 0.360 Test Loss: 1.524 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 1.262990951538086
Epoch: 5, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.288 Vali Acc: 0.420 Test Loss: 1.288 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419987).  Saving model ...
Epoch: 6 cost time: 1.6190505027770996
Epoch: 6, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
Validation loss decreased (-0.419987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.7288873195648193
Epoch: 7, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.286 Vali Acc: 0.460 Test Loss: 1.286 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.373560905456543
Epoch: 8, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8678405284881592
Epoch: 9, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6064181327819824
Epoch: 10, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.375 Vali Acc: 0.500 Test Loss: 1.375 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9164962768554688
Epoch: 11, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.248 Vali Acc: 0.520 Test Loss: 1.248 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 12 cost time: 1.6703028678894043
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.399 Vali Acc: 0.600 Test Loss: 1.399 Test Acc: 0.600
Validation loss decreased (-0.519988 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 1.9451375007629395
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.541 Vali Acc: 0.520 Test Loss: 1.541 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6880619525909424
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.793 Vali Acc: 0.500 Test Loss: 1.793 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7078461647033691
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.571 Vali Acc: 0.560 Test Loss: 1.571 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8212876319885254
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.566 Vali Acc: 0.540 Test Loss: 1.566 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6147422790527344
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.934 Vali Acc: 0.520 Test Loss: 1.934 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3652880191802979
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.181 Vali Acc: 0.520 Test Loss: 2.181 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2277662754058838
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.046 Vali Acc: 0.540 Test Loss: 2.046 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5393178462982178
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.560 Test Loss: 1.884 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5494685173034668
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.600 Test Loss: 1.769 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6686961650848389
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.600 Test Loss: 1.714 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 99239429
model size : 393.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.672210693359375
Epoch: 1, Steps: 4 | Train Loss: 1.745 Vali Loss: 1.629 Vali Acc: 0.220 Test Loss: 1.629 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3161516189575195
Epoch: 2, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.465 Vali Acc: 0.320 Test Loss: 1.465 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.415663719177246
Epoch: 3, Steps: 4 | Train Loss: 1.055 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.2722902297973633
Epoch: 4, Steps: 4 | Train Loss: 0.912 Vali Loss: 1.343 Vali Acc: 0.420 Test Loss: 1.343 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419987).  Saving model ...
Epoch: 5 cost time: 1.4791157245635986
Epoch: 5, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.399 Vali Acc: 0.500 Test Loss: 1.399 Test Acc: 0.500
Validation loss decreased (-0.419987 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.4483342170715332
Epoch: 6, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.312 Vali Acc: 0.500 Test Loss: 1.312 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.4737131595611572
Epoch: 7, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.362 Vali Acc: 0.460 Test Loss: 1.362 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.476527452468872
Epoch: 8, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.820 Vali Acc: 0.460 Test Loss: 1.820 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7525219917297363
Epoch: 9, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.096 Vali Acc: 0.580 Test Loss: 1.096 Test Acc: 0.580
Validation loss decreased (-0.499987 --> -0.579989).  Saving model ...
Epoch: 10 cost time: 1.457549810409546
Epoch: 10, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.840 Vali Acc: 0.560 Test Loss: 1.840 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4995415210723877
Epoch: 11, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.641 Vali Acc: 0.600 Test Loss: 1.641 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 1.440946340560913
Epoch: 12, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.891 Vali Acc: 0.520 Test Loss: 1.891 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.677016019821167
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.885 Vali Acc: 0.480 Test Loss: 1.885 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.227487564086914
Epoch: 14, Steps: 4 | Train Loss: 0.022 Vali Loss: 2.555 Vali Acc: 0.440 Test Loss: 2.555 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3132004737854004
Epoch: 15, Steps: 4 | Train Loss: 0.079 Vali Loss: 2.126 Vali Acc: 0.520 Test Loss: 2.126 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5105879306793213
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.687 Vali Acc: 0.520 Test Loss: 1.687 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.447890281677246
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.868 Vali Acc: 0.480 Test Loss: 1.868 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4542968273162842
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.194 Vali Acc: 0.460 Test Loss: 2.194 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6170613765716553
Epoch: 19, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.362 Vali Acc: 0.500 Test Loss: 2.362 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5741007328033447
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.323 Vali Acc: 0.560 Test Loss: 2.323 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7941253185272217
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.274 Vali Acc: 0.580 Test Loss: 2.274 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 105630725
model size : 417.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.704890012741089
Epoch: 1, Steps: 4 | Train Loss: 1.708 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3533213138580322
Epoch: 2, Steps: 4 | Train Loss: 1.473 Vali Loss: 1.514 Vali Acc: 0.320 Test Loss: 1.514 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.0188868045806885
Epoch: 3, Steps: 4 | Train Loss: 1.010 Vali Loss: 1.387 Vali Acc: 0.340 Test Loss: 1.387 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339986).  Saving model ...
Epoch: 4 cost time: 1.787996530532837
Epoch: 4, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.356 Vali Acc: 0.400 Test Loss: 1.356 Test Acc: 0.400
Validation loss decreased (-0.339986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.5104126930236816
Epoch: 5, Steps: 4 | Train Loss: 0.580 Vali Loss: 1.536 Vali Acc: 0.400 Test Loss: 1.536 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8065474033355713
Epoch: 6, Steps: 4 | Train Loss: 0.634 Vali Loss: 1.225 Vali Acc: 0.460 Test Loss: 1.225 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459988).  Saving model ...
Epoch: 7 cost time: 1.7437365055084229
Epoch: 7, Steps: 4 | Train Loss: 0.212 Vali Loss: 1.684 Vali Acc: 0.420 Test Loss: 1.684 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1801550388336182
Epoch: 8, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.316 Vali Acc: 0.420 Test Loss: 1.316 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2996995449066162
Epoch: 9, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.576 Vali Acc: 0.480 Test Loss: 1.576 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479984).  Saving model ...
Epoch: 10 cost time: 1.3442068099975586
Epoch: 10, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.370 Vali Acc: 0.480 Test Loss: 1.370 Test Acc: 0.480
Validation loss decreased (-0.479984 --> -0.479986).  Saving model ...
Epoch: 11 cost time: 1.5608930587768555
Epoch: 11, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.387 Vali Acc: 0.540 Test Loss: 1.387 Test Acc: 0.540
Validation loss decreased (-0.479986 --> -0.539986).  Saving model ...
Epoch: 12 cost time: 1.0816452503204346
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.704 Vali Acc: 0.500 Test Loss: 1.704 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1586432456970215
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.474 Vali Acc: 0.540 Test Loss: 1.474 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5022335052490234
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.637 Vali Acc: 0.540 Test Loss: 1.637 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1803169250488281
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.805 Vali Acc: 0.520 Test Loss: 1.805 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.101348876953125
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.520 Test Loss: 1.779 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2770912647247314
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.520 Test Loss: 1.688 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4384734630584717
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.660 Vali Acc: 0.540 Test Loss: 1.660 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3668880462646484
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.704 Vali Acc: 0.520 Test Loss: 1.704 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3803069591522217
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.760 Vali Acc: 0.500 Test Loss: 1.760 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3279626369476318
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.500 Test Loss: 1.775 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 105496325
model size : 417.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.009197950363159
Epoch: 1, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.677 Vali Acc: 0.120 Test Loss: 1.677 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.5772788524627686
Epoch: 2, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.606 Vali Acc: 0.320 Test Loss: 1.606 Test Acc: 0.320
Validation loss decreased (-0.119983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.3286325931549072
Epoch: 3, Steps: 4 | Train Loss: 1.061 Vali Loss: 1.517 Vali Acc: 0.360 Test Loss: 1.517 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.7913622856140137
Epoch: 4, Steps: 4 | Train Loss: 0.765 Vali Loss: 1.379 Vali Acc: 0.420 Test Loss: 1.379 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 1.4654266834259033
Epoch: 5, Steps: 4 | Train Loss: 0.488 Vali Loss: 1.292 Vali Acc: 0.480 Test Loss: 1.292 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 1.5259661674499512
Epoch: 6, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.319 Vali Acc: 0.480 Test Loss: 1.319 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7542736530303955
Epoch: 7, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.239 Vali Acc: 0.440 Test Loss: 1.239 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6575403213500977
Epoch: 8, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.373 Vali Acc: 0.460 Test Loss: 1.373 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4338736534118652
Epoch: 9, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.351 Vali Acc: 0.440 Test Loss: 1.351 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.658104658126831
Epoch: 10, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.342 Vali Acc: 0.440 Test Loss: 1.342 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5650830268859863
Epoch: 11, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.382 Vali Acc: 0.460 Test Loss: 1.382 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7944738864898682
Epoch: 12, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.494 Vali Acc: 0.460 Test Loss: 1.494 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.614422082901001
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.627 Vali Acc: 0.420 Test Loss: 1.627 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5750582218170166
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.660 Vali Acc: 0.460 Test Loss: 1.660 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8131992816925049
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 16 cost time: 1.7849199771881104
Epoch: 16, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3445353507995605
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.163 Vali Acc: 0.440 Test Loss: 2.163 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7928917407989502
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.298 Vali Acc: 0.420 Test Loss: 2.298 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7041456699371338
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.190 Vali Acc: 0.420 Test Loss: 2.190 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1286258697509766
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.911 Vali Acc: 0.480 Test Loss: 1.911 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.626920461654663
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.728 Vali Acc: 0.500 Test Loss: 1.728 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7513842582702637
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.671 Vali Acc: 0.500 Test Loss: 1.671 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3698301315307617
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.696 Vali Acc: 0.500 Test Loss: 1.696 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.727005958557129
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.480 Test Loss: 1.738 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1423492431640625
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.480 Test Loss: 1.779 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 105426437
model size : 416.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1138904094696045
Epoch: 1, Steps: 4 | Train Loss: 1.830 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.0582263469696045
Epoch: 2, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.549 Vali Acc: 0.240 Test Loss: 1.549 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.8843936920166016
Epoch: 3, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.465 Vali Acc: 0.480 Test Loss: 1.465 Test Acc: 0.480
Validation loss decreased (-0.239985 --> -0.479985).  Saving model ...
Epoch: 4 cost time: 1.796675682067871
Epoch: 4, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.393 Vali Acc: 0.520 Test Loss: 1.393 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519986).  Saving model ...
Epoch: 5 cost time: 1.5514357089996338
Epoch: 5, Steps: 4 | Train Loss: 0.415 Vali Loss: 1.318 Vali Acc: 0.540 Test Loss: 1.318 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 6 cost time: 1.5254085063934326
Epoch: 6, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.418 Vali Acc: 0.560 Test Loss: 1.418 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559986).  Saving model ...
Epoch: 7 cost time: 1.4986152648925781
Epoch: 7, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.402625322341919
Epoch: 8, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.609 Vali Acc: 0.500 Test Loss: 1.609 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5324881076812744
Epoch: 9, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.328 Vali Acc: 0.560 Test Loss: 1.328 Test Acc: 0.560
Validation loss decreased (-0.559986 --> -0.559987).  Saving model ...
Epoch: 10 cost time: 1.5048766136169434
Epoch: 10, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.478 Vali Acc: 0.520 Test Loss: 1.478 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0998857021331787
Epoch: 11, Steps: 4 | Train Loss: 0.027 Vali Loss: 2.316 Vali Acc: 0.500 Test Loss: 2.316 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8146734237670898
Epoch: 12, Steps: 4 | Train Loss: 0.114 Vali Loss: 2.275 Vali Acc: 0.500 Test Loss: 2.275 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4652061462402344
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.141 Vali Acc: 0.480 Test Loss: 2.141 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.388756275177002
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.490 Vali Acc: 0.580 Test Loss: 1.490 Test Acc: 0.580
Validation loss decreased (-0.559987 --> -0.579985).  Saving model ...
Epoch: 15 cost time: 1.707261323928833
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.590 Vali Acc: 0.560 Test Loss: 1.590 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8403072357177734
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.609 Vali Acc: 0.540 Test Loss: 1.609 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7731571197509766
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.869 Vali Acc: 0.520 Test Loss: 1.869 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8825311660766602
Epoch: 18, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.766 Vali Acc: 0.520 Test Loss: 1.766 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9817121028900146
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.520 Test Loss: 1.858 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9129068851470947
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.480 Test Loss: 1.794 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5264842510223389
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.746 Vali Acc: 0.480 Test Loss: 1.746 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.852278470993042
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.540 Test Loss: 1.773 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5213313102722168
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.560 Test Loss: 1.847 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4801878929138184
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.920 Vali Acc: 0.560 Test Loss: 1.920 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 108681221
model size : 429.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1103157997131348
Epoch: 1, Steps: 4 | Train Loss: 1.787 Vali Loss: 1.653 Vali Acc: 0.140 Test Loss: 1.653 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.904224157333374
Epoch: 2, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.674 Vali Acc: 0.240 Test Loss: 1.674 Test Acc: 0.240
Validation loss decreased (-0.139983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.3243165016174316
Epoch: 3, Steps: 4 | Train Loss: 1.164 Vali Loss: 1.696 Vali Acc: 0.240 Test Loss: 1.696 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9800384044647217
Epoch: 4, Steps: 4 | Train Loss: 0.625 Vali Loss: 1.451 Vali Acc: 0.420 Test Loss: 1.451 Test Acc: 0.420
Validation loss decreased (-0.239983 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 1.6676278114318848
Epoch: 5, Steps: 4 | Train Loss: 0.534 Vali Loss: 1.589 Vali Acc: 0.380 Test Loss: 1.589 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5084388256072998
Epoch: 6, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.176 Vali Acc: 0.460 Test Loss: 1.176 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459988).  Saving model ...
Epoch: 7 cost time: 1.6366603374481201
Epoch: 7, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.370 Vali Acc: 0.380 Test Loss: 1.370 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3271255493164062
Epoch: 8, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.437 Vali Acc: 0.380 Test Loss: 1.437 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5218079090118408
Epoch: 9, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.548 Vali Acc: 0.400 Test Loss: 1.548 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.854942798614502
Epoch: 10, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.367 Vali Acc: 0.460 Test Loss: 1.367 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5693047046661377
Epoch: 11, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.698 Vali Acc: 0.440 Test Loss: 1.698 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7661449909210205
Epoch: 12, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.815 Vali Acc: 0.460 Test Loss: 1.815 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7007722854614258
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.836 Vali Acc: 0.460 Test Loss: 1.836 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3596315383911133
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.188 Vali Acc: 0.460 Test Loss: 2.188 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2796645164489746
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.315 Vali Acc: 0.440 Test Loss: 2.315 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2205533981323242
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.216 Vali Acc: 0.440 Test Loss: 2.216 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 108579077
model size : 428.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2742908000946045
Epoch: 1, Steps: 4 | Train Loss: 1.734 Vali Loss: 1.615 Vali Acc: 0.160 Test Loss: 1.615 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.1930537223815918
Epoch: 2, Steps: 4 | Train Loss: 1.513 Vali Loss: 1.599 Vali Acc: 0.220 Test Loss: 1.599 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.2739589214324951
Epoch: 3, Steps: 4 | Train Loss: 1.167 Vali Loss: 1.598 Vali Acc: 0.280 Test Loss: 1.598 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.3197836875915527
Epoch: 4, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.279984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 1.038639783859253
Epoch: 5, Steps: 4 | Train Loss: 0.627 Vali Loss: 1.484 Vali Acc: 0.480 Test Loss: 1.484 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479985).  Saving model ...
Epoch: 6 cost time: 1.0939335823059082
Epoch: 6, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1273045539855957
Epoch: 7, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.534 Vali Acc: 0.520 Test Loss: 1.534 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519985).  Saving model ...
Epoch: 8 cost time: 1.3825128078460693
Epoch: 8, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3493070602416992
Epoch: 9, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.733 Vali Acc: 0.460 Test Loss: 1.733 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6299076080322266
Epoch: 10, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.517 Vali Acc: 0.480 Test Loss: 1.517 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4376142024993896
Epoch: 11, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.834 Vali Acc: 0.420 Test Loss: 1.834 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.319054365158081
Epoch: 12, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.620 Vali Acc: 0.400 Test Loss: 1.620 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2604641914367676
Epoch: 13, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.793 Vali Acc: 0.420 Test Loss: 1.793 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2845032215118408
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.060 Vali Acc: 0.400 Test Loss: 2.060 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.401723861694336
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.184 Vali Acc: 0.400 Test Loss: 2.184 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4552125930786133
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.197 Vali Acc: 0.400 Test Loss: 2.197 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0861477851867676
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.156 Vali Acc: 0.380 Test Loss: 2.156 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 108519941
model size : 428.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2301268577575684
Epoch: 1, Steps: 4 | Train Loss: 1.826 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.3564856052398682
Epoch: 2, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.3527500629425049
Epoch: 3, Steps: 4 | Train Loss: 1.182 Vali Loss: 1.477 Vali Acc: 0.340 Test Loss: 1.477 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.4189932346343994
Epoch: 4, Steps: 4 | Train Loss: 0.865 Vali Loss: 1.395 Vali Acc: 0.360 Test Loss: 1.395 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359986).  Saving model ...
Epoch: 5 cost time: 1.3717780113220215
Epoch: 5, Steps: 4 | Train Loss: 0.991 Vali Loss: 1.710 Vali Acc: 0.400 Test Loss: 1.710 Test Acc: 0.400
Validation loss decreased (-0.359986 --> -0.399983).  Saving model ...
Epoch: 6 cost time: 1.3279309272766113
Epoch: 6, Steps: 4 | Train Loss: 0.607 Vali Loss: 1.472 Vali Acc: 0.500 Test Loss: 1.472 Test Acc: 0.500
Validation loss decreased (-0.399983 --> -0.499985).  Saving model ...
Epoch: 7 cost time: 1.652405023574829
Epoch: 7, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.640 Vali Acc: 0.560 Test Loss: 1.640 Test Acc: 0.560
Validation loss decreased (-0.499985 --> -0.559984).  Saving model ...
Epoch: 8 cost time: 1.4601900577545166
Epoch: 8, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.609 Vali Acc: 0.540 Test Loss: 1.609 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.308075189590454
Epoch: 9, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.255 Vali Acc: 0.420 Test Loss: 2.255 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5980470180511475
Epoch: 10, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.664 Vali Acc: 0.500 Test Loss: 1.664 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4202985763549805
Epoch: 11, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.727 Vali Acc: 0.560 Test Loss: 1.727 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5880589485168457
Epoch: 12, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.883 Vali Acc: 0.540 Test Loss: 1.883 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5497610569000244
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.932 Vali Acc: 0.520 Test Loss: 1.932 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7158033847808838
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.955 Vali Acc: 0.500 Test Loss: 1.955 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.773099660873413
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.995 Vali Acc: 0.500 Test Loss: 1.995 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7357523441314697
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.017 Vali Acc: 0.540 Test Loss: 2.017 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5226426124572754
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.045 Vali Acc: 0.580 Test Loss: 2.045 Test Acc: 0.580
Validation loss decreased (-0.559984 --> -0.579980).  Saving model ...
Epoch: 18 cost time: 1.1264629364013672
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.600 Test Loss: 2.075 Test Acc: 0.600
Validation loss decreased (-0.579980 --> -0.599979).  Saving model ...
Epoch: 19 cost time: 1.598240852355957
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.110 Vali Acc: 0.600 Test Loss: 2.110 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.169358253479004
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.600 Test Loss: 2.140 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5457303524017334
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.163 Vali Acc: 0.600 Test Loss: 2.163 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.09745454788208
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.181 Vali Acc: 0.580 Test Loss: 2.181 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3358368873596191
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.195 Vali Acc: 0.580 Test Loss: 2.195 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5439915657043457
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.209 Vali Acc: 0.580 Test Loss: 2.209 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0829033851623535
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.580 Test Loss: 2.225 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.651581048965454
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.239 Vali Acc: 0.580 Test Loss: 2.239 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3960318565368652
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.248 Vali Acc: 0.580 Test Loss: 2.248 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7866950035095215
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.253 Vali Acc: 0.580 Test Loss: 2.253 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 114878981
model size : 452.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.975247383117676
Epoch: 1, Steps: 4 | Train Loss: 1.772 Vali Loss: 1.611 Vali Acc: 0.260 Test Loss: 1.611 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.5534262657165527
Epoch: 2, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.723 Vali Acc: 0.300 Test Loss: 1.723 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.6473515033721924
Epoch: 3, Steps: 4 | Train Loss: 1.028 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.9035046100616455
Epoch: 4, Steps: 4 | Train Loss: 0.663 Vali Loss: 1.464 Vali Acc: 0.400 Test Loss: 1.464 Test Acc: 0.400
Validation loss decreased (-0.299983 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 2.0023651123046875
Epoch: 5, Steps: 4 | Train Loss: 0.526 Vali Loss: 1.526 Vali Acc: 0.380 Test Loss: 1.526 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6981301307678223
Epoch: 6, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.686 Vali Acc: 0.460 Test Loss: 1.686 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459983).  Saving model ...
Epoch: 7 cost time: 1.5119991302490234
Epoch: 7, Steps: 4 | Train Loss: 0.466 Vali Loss: 1.420 Vali Acc: 0.440 Test Loss: 1.420 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6954100131988525
Epoch: 8, Steps: 4 | Train Loss: 0.356 Vali Loss: 1.539 Vali Acc: 0.400 Test Loss: 1.539 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4932255744934082
Epoch: 9, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.447 Vali Acc: 0.440 Test Loss: 1.447 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6329758167266846
Epoch: 10, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.237 Vali Acc: 0.480 Test Loss: 1.237 Test Acc: 0.480
Validation loss decreased (-0.459983 --> -0.479988).  Saving model ...
Epoch: 11 cost time: 1.9030144214630127
Epoch: 11, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.367 Vali Acc: 0.520 Test Loss: 1.367 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 1.804398775100708
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.417 Vali Acc: 0.500 Test Loss: 1.417 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.706094741821289
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.787 Vali Acc: 0.500 Test Loss: 1.787 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6481568813323975
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.569 Vali Acc: 0.520 Test Loss: 1.569 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6431488990783691
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.365 Vali Acc: 0.540 Test Loss: 1.365 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539986).  Saving model ...
Epoch: 16 cost time: 1.5678367614746094
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.388 Vali Acc: 0.560 Test Loss: 1.388 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559986).  Saving model ...
Epoch: 17 cost time: 1.3722193241119385
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6407947540283203
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.861 Vali Acc: 0.520 Test Loss: 1.861 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5314171314239502
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.998 Vali Acc: 0.500 Test Loss: 1.998 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5400645732879639
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.077 Vali Acc: 0.500 Test Loss: 2.077 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5707452297210693
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.129 Vali Acc: 0.520 Test Loss: 2.129 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3617782592773438
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.161 Vali Acc: 0.520 Test Loss: 2.161 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5715272426605225
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.184 Vali Acc: 0.520 Test Loss: 2.184 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4810874462127686
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.540 Test Loss: 2.196 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5123035907745361
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.540 Test Loss: 2.182 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4575440883636475
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.160 Vali Acc: 0.540 Test Loss: 2.160 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 114766085
model size : 452.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.941925525665283
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.632 Vali Acc: 0.280 Test Loss: 1.632 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.9786639213562012
Epoch: 2, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.497 Vali Acc: 0.460 Test Loss: 1.497 Test Acc: 0.460
Validation loss decreased (-0.279984 --> -0.459985).  Saving model ...
Epoch: 3 cost time: 1.2916264533996582
Epoch: 3, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.417 Vali Acc: 0.400 Test Loss: 1.417 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4525868892669678
Epoch: 4, Steps: 4 | Train Loss: 0.792 Vali Loss: 1.306 Vali Acc: 0.460 Test Loss: 1.306 Test Acc: 0.460
Validation loss decreased (-0.459985 --> -0.459987).  Saving model ...
Epoch: 5 cost time: 1.7042012214660645
Epoch: 5, Steps: 4 | Train Loss: 0.433 Vali Loss: 1.364 Vali Acc: 0.380 Test Loss: 1.364 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8577072620391846
Epoch: 6, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.397 Vali Acc: 0.420 Test Loss: 1.397 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4133975505828857
Epoch: 7, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.638394832611084
Epoch: 8, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.315 Vali Acc: 0.420 Test Loss: 1.315 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6333210468292236
Epoch: 9, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.281 Vali Acc: 0.460 Test Loss: 1.281 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 1.9340505599975586
Epoch: 10, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.847 Vali Acc: 0.460 Test Loss: 1.847 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.346198320388794
Epoch: 11, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.914 Vali Acc: 0.460 Test Loss: 1.914 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4224469661712646
Epoch: 12, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4389989376068115
Epoch: 13, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.267 Vali Acc: 0.480 Test Loss: 1.267 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.3366634845733643
Epoch: 14, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.715 Vali Acc: 0.460 Test Loss: 1.715 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.446960210800171
Epoch: 15, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.986 Vali Acc: 0.440 Test Loss: 1.986 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5307366847991943
Epoch: 16, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.456 Vali Acc: 0.480 Test Loss: 1.456 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3108210563659668
Epoch: 17, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.444 Vali Acc: 0.460 Test Loss: 1.444 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.737412452697754
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.524 Vali Acc: 0.460 Test Loss: 1.524 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.566594123840332
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.632 Vali Acc: 0.460 Test Loss: 1.632 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.503260850906372
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.690 Vali Acc: 0.440 Test Loss: 1.690 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5103135108947754
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.440 Test Loss: 1.702 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.430055856704712
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.737 Vali Acc: 0.480 Test Loss: 1.737 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4598267078399658
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.845 Vali Acc: 0.480 Test Loss: 1.845 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 114712325
model size : 452.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.518010139465332
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.641 Vali Acc: 0.260 Test Loss: 1.641 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.853086233139038
Epoch: 2, Steps: 4 | Train Loss: 1.679 Vali Loss: 1.512 Vali Acc: 0.260 Test Loss: 1.512 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 2.0095272064208984
Epoch: 3, Steps: 4 | Train Loss: 1.146 Vali Loss: 1.407 Vali Acc: 0.400 Test Loss: 1.407 Test Acc: 0.400
Validation loss decreased (-0.259985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.9586350917816162
Epoch: 4, Steps: 4 | Train Loss: 0.554 Vali Loss: 1.444 Vali Acc: 0.380 Test Loss: 1.444 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9693448543548584
Epoch: 5, Steps: 4 | Train Loss: 0.356 Vali Loss: 1.244 Vali Acc: 0.460 Test Loss: 1.244 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459988).  Saving model ...
Epoch: 6 cost time: 1.7600913047790527
Epoch: 6, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.136 Vali Acc: 0.520 Test Loss: 1.136 Test Acc: 0.520
Validation loss decreased (-0.459988 --> -0.519989).  Saving model ...
Epoch: 7 cost time: 1.7329509258270264
Epoch: 7, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.393 Vali Acc: 0.440 Test Loss: 1.393 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6137416362762451
Epoch: 8, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.559 Vali Acc: 0.440 Test Loss: 1.559 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4234223365783691
Epoch: 9, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.388 Vali Acc: 0.480 Test Loss: 1.388 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3884780406951904
Epoch: 10, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.474 Vali Acc: 0.540 Test Loss: 1.474 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539985).  Saving model ...
Epoch: 11 cost time: 2.0124545097351074
Epoch: 11, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.356 Vali Acc: 0.560 Test Loss: 1.356 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559986).  Saving model ...
Epoch: 12 cost time: 1.7436275482177734
Epoch: 12, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.280 Vali Acc: 0.460 Test Loss: 1.280 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7842981815338135
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.302 Vali Acc: 0.420 Test Loss: 2.302 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1063506603240967
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.724 Vali Acc: 0.540 Test Loss: 1.724 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3201897144317627
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.594 Vali Acc: 0.520 Test Loss: 1.594 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.645517110824585
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.653 Vali Acc: 0.540 Test Loss: 1.653 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7650067806243896
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.712 Vali Acc: 0.520 Test Loss: 1.712 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9135921001434326
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.520 Test Loss: 1.787 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7329401969909668
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.560 Test Loss: 1.854 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8738670349121094
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.560 Test Loss: 1.895 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0113630294799805
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.899 Vali Acc: 0.520 Test Loss: 1.899 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 121044485
model size : 476.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.204141139984131
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.605 Vali Acc: 0.240 Test Loss: 1.605 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.7105135917663574
Epoch: 2, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.579 Vali Acc: 0.320 Test Loss: 1.579 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.7391901016235352
Epoch: 3, Steps: 4 | Train Loss: 1.125 Vali Loss: 1.602 Vali Acc: 0.360 Test Loss: 1.602 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.803663730621338
Epoch: 4, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.624 Vali Acc: 0.380 Test Loss: 1.624 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 5 cost time: 1.789416790008545
Epoch: 5, Steps: 4 | Train Loss: 0.371 Vali Loss: 1.421 Vali Acc: 0.360 Test Loss: 1.421 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7604491710662842
Epoch: 6, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.406 Vali Acc: 0.440 Test Loss: 1.406 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 1.7572555541992188
Epoch: 7, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.824 Vali Acc: 0.340 Test Loss: 1.824 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6637458801269531
Epoch: 8, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.792 Vali Acc: 0.360 Test Loss: 1.792 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8466508388519287
Epoch: 9, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.751 Vali Acc: 0.420 Test Loss: 1.751 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9131133556365967
Epoch: 10, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.397 Vali Acc: 0.460 Test Loss: 1.397 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 11 cost time: 1.8006043434143066
Epoch: 11, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.040 Vali Acc: 0.400 Test Loss: 2.040 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.748382806777954
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.875 Vali Acc: 0.440 Test Loss: 1.875 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1034202575683594
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.961 Vali Acc: 0.460 Test Loss: 1.961 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9919047355651855
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.026 Vali Acc: 0.440 Test Loss: 2.026 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4909818172454834
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.039 Vali Acc: 0.440 Test Loss: 2.039 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2052409648895264
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.969 Vali Acc: 0.460 Test Loss: 1.969 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1272730827331543
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.915 Vali Acc: 0.460 Test Loss: 1.915 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4785759449005127
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.460 Test Loss: 1.908 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4403150081634521
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.460 Test Loss: 1.953 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6764025688171387
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.981 Vali Acc: 0.480 Test Loss: 1.981 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479980).  Saving model ...
Epoch: 21 cost time: 1.6160728931427002
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.460 Test Loss: 2.013 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7780020236968994
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.460 Test Loss: 2.050 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7775475978851318
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.085 Vali Acc: 0.460 Test Loss: 2.085 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2279767990112305
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.460 Test Loss: 2.106 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8626797199249268
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.119 Vali Acc: 0.460 Test Loss: 2.119 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8981812000274658
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.460 Test Loss: 2.129 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7215733528137207
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.143 Vali Acc: 0.460 Test Loss: 2.143 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7044157981872559
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.156 Vali Acc: 0.460 Test Loss: 2.156 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.064455986022949
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.460 Test Loss: 2.164 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9186604022979736
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.480 Test Loss: 2.173 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 120953093
model size : 476.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7067677974700928
Epoch: 1, Steps: 4 | Train Loss: 1.785 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.4610071182250977
Epoch: 2, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.578 Vali Acc: 0.380 Test Loss: 1.578 Test Acc: 0.380
Validation loss decreased (-0.179983 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 2.343956708908081
Epoch: 3, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.444 Vali Acc: 0.360 Test Loss: 1.444 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4676933288574219
Epoch: 4, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.258 Vali Acc: 0.460 Test Loss: 1.258 Test Acc: 0.460
Validation loss decreased (-0.379984 --> -0.459987).  Saving model ...
Epoch: 5 cost time: 1.8398399353027344
Epoch: 5, Steps: 4 | Train Loss: 0.414 Vali Loss: 1.418 Vali Acc: 0.400 Test Loss: 1.418 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8170959949493408
Epoch: 6, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.446 Vali Acc: 0.400 Test Loss: 1.446 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8599181175231934
Epoch: 7, Steps: 4 | Train Loss: 0.311 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.691044569015503
Epoch: 8, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.550 Vali Acc: 0.440 Test Loss: 1.550 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8140010833740234
Epoch: 9, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.372 Vali Acc: 0.440 Test Loss: 1.372 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7632756233215332
Epoch: 10, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.504 Vali Acc: 0.460 Test Loss: 1.504 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7990124225616455
Epoch: 11, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.788 Vali Acc: 0.420 Test Loss: 1.788 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7959561347961426
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.670 Vali Acc: 0.440 Test Loss: 1.670 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5091700553894043
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.492 Vali Acc: 0.480 Test Loss: 1.492 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479985).  Saving model ...
Epoch: 14 cost time: 2.073744535446167
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.719 Vali Acc: 0.460 Test Loss: 1.719 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9775609970092773
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.993 Vali Acc: 0.500 Test Loss: 1.993 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499980).  Saving model ...
Epoch: 16 cost time: 2.173043966293335
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.903 Vali Acc: 0.500 Test Loss: 1.903 Test Acc: 0.500
Validation loss decreased (-0.499980 --> -0.499981).  Saving model ...
Epoch: 17 cost time: 1.7998113632202148
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.854 Vali Acc: 0.500 Test Loss: 1.854 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499981).  Saving model ...
Epoch: 18 cost time: 1.758420467376709
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.830 Vali Acc: 0.500 Test Loss: 1.830 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499982).  Saving model ...
Epoch: 19 cost time: 1.8243374824523926
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.798 Vali Acc: 0.500 Test Loss: 1.798 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499982).  Saving model ...
Epoch: 20 cost time: 1.834503173828125
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.791 Vali Acc: 0.520 Test Loss: 1.791 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519982).  Saving model ...
Epoch: 21 cost time: 1.7718513011932373
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.800 Vali Acc: 0.520 Test Loss: 1.800 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6848278045654297
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3815617561340332
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.753 Vali Acc: 0.480 Test Loss: 1.753 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7047514915466309
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.480 Test Loss: 1.726 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.626966953277588
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.480 Test Loss: 1.734 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8652725219726562
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.480 Test Loss: 1.776 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.660895586013794
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.500 Test Loss: 1.822 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0407400131225586
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.500 Test Loss: 1.876 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4709255695343018
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.914 Vali Acc: 0.500 Test Loss: 1.914 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.529564619064331
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.500 Test Loss: 1.939 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 120904709
model size : 475.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.401289701461792
Epoch: 1, Steps: 4 | Train Loss: 1.940 Vali Loss: 1.519 Vali Acc: 0.280 Test Loss: 1.519 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.3788368701934814
Epoch: 2, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.391 Vali Acc: 0.380 Test Loss: 1.391 Test Acc: 0.380
Validation loss decreased (-0.279985 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 1.275519609451294
Epoch: 3, Steps: 4 | Train Loss: 0.970 Vali Loss: 1.309 Vali Acc: 0.480 Test Loss: 1.309 Test Acc: 0.480
Validation loss decreased (-0.379986 --> -0.479987).  Saving model ...
Epoch: 4 cost time: 1.3280456066131592
Epoch: 4, Steps: 4 | Train Loss: 0.471 Vali Loss: 1.337 Vali Acc: 0.440 Test Loss: 1.337 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5238416194915771
Epoch: 5, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.520 Vali Acc: 0.460 Test Loss: 1.520 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8302266597747803
Epoch: 6, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.516 Vali Acc: 0.480 Test Loss: 1.516 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6349120140075684
Epoch: 7, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.768 Vali Acc: 0.440 Test Loss: 1.768 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.491675853729248
Epoch: 8, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.6930294036865234
Epoch: 9, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.370 Vali Acc: 0.540 Test Loss: 1.370 Test Acc: 0.540
Validation loss decreased (-0.499985 --> -0.539986).  Saving model ...
Epoch: 10 cost time: 1.8416237831115723
Epoch: 10, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.695 Vali Acc: 0.460 Test Loss: 1.695 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6954236030578613
Epoch: 11, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.520 Vali Acc: 0.520 Test Loss: 1.520 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5191586017608643
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.031 Vali Acc: 0.440 Test Loss: 2.031 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5879368782043457
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.983 Vali Acc: 0.440 Test Loss: 1.983 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2029962539672852
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.822 Vali Acc: 0.460 Test Loss: 1.822 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8392536640167236
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.520 Test Loss: 1.725 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.301313877105713
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.540 Test Loss: 1.697 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4657416343688965
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.540 Test Loss: 1.757 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.169368028640747
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.480 Test Loss: 1.868 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6117525100708008
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.460 Test Loss: 1.969 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 127236869
model size : 500.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5518674850463867
Epoch: 1, Steps: 4 | Train Loss: 1.824 Vali Loss: 1.636 Vali Acc: 0.180 Test Loss: 1.636 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.6597480773925781
Epoch: 2, Steps: 4 | Train Loss: 1.562 Vali Loss: 1.728 Vali Acc: 0.260 Test Loss: 1.728 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.5519905090332031
Epoch: 3, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.657 Vali Acc: 0.300 Test Loss: 1.657 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.254516839981079
Epoch: 4, Steps: 4 | Train Loss: 1.118 Vali Loss: 1.554 Vali Acc: 0.360 Test Loss: 1.554 Test Acc: 0.360
Validation loss decreased (-0.299983 --> -0.359984).  Saving model ...
Epoch: 5 cost time: 1.6067304611206055
Epoch: 5, Steps: 4 | Train Loss: 0.824 Vali Loss: 1.472 Vali Acc: 0.420 Test Loss: 1.472 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.5458056926727295
Epoch: 6, Steps: 4 | Train Loss: 0.557 Vali Loss: 1.459 Vali Acc: 0.400 Test Loss: 1.459 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8948769569396973
Epoch: 7, Steps: 4 | Train Loss: 0.654 Vali Loss: 1.653 Vali Acc: 0.500 Test Loss: 1.653 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499983).  Saving model ...
Epoch: 8 cost time: 1.3597207069396973
Epoch: 8, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.545 Vali Acc: 0.560 Test Loss: 1.545 Test Acc: 0.560
Validation loss decreased (-0.499983 --> -0.559985).  Saving model ...
Epoch: 9 cost time: 1.0461597442626953
Epoch: 9, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.009 Vali Acc: 0.500 Test Loss: 2.009 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.675356388092041
Epoch: 10, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.996 Vali Acc: 0.500 Test Loss: 1.996 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4899604320526123
Epoch: 11, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.519 Vali Acc: 0.560 Test Loss: 1.519 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559985).  Saving model ...
Epoch: 12 cost time: 1.448481798171997
Epoch: 12, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.548 Vali Acc: 0.520 Test Loss: 1.548 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9690208435058594
Epoch: 13, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.615 Vali Acc: 0.540 Test Loss: 1.615 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.903212308883667
Epoch: 14, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.540 Vali Acc: 0.560 Test Loss: 1.540 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9942800998687744
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.718 Vali Acc: 0.540 Test Loss: 1.718 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7781050205230713
Epoch: 16, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.547 Vali Acc: 0.540 Test Loss: 1.547 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6320393085479736
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.029 Vali Acc: 0.480 Test Loss: 2.029 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4324421882629395
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.222 Vali Acc: 0.480 Test Loss: 2.222 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5784764289855957
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.145 Vali Acc: 0.480 Test Loss: 2.145 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6286365985870361
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.036 Vali Acc: 0.500 Test Loss: 2.036 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.829129934310913
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.705 Vali Acc: 0.520 Test Loss: 1.705 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 127145477
model size : 499.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2645866870880127
Epoch: 1, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.656 Vali Acc: 0.220 Test Loss: 1.656 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.611518383026123
Epoch: 2, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.612 Vali Acc: 0.300 Test Loss: 1.612 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.5199260711669922
Epoch: 3, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.493 Vali Acc: 0.320 Test Loss: 1.493 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 2.013427734375
Epoch: 4, Steps: 4 | Train Loss: 0.759 Vali Loss: 1.400 Vali Acc: 0.340 Test Loss: 1.400 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339986).  Saving model ...
Epoch: 5 cost time: 2.037081003189087
Epoch: 5, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.395 Vali Acc: 0.440 Test Loss: 1.395 Test Acc: 0.440
Validation loss decreased (-0.339986 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 2.042546033859253
Epoch: 6, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.217 Vali Acc: 0.460 Test Loss: 1.217 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459988).  Saving model ...
Epoch: 7 cost time: 1.8531911373138428
Epoch: 7, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.466 Vali Acc: 0.440 Test Loss: 1.466 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8876512050628662
Epoch: 8, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.367 Vali Acc: 0.380 Test Loss: 1.367 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4794807434082031
Epoch: 9, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.425 Vali Acc: 0.420 Test Loss: 1.425 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5856437683105469
Epoch: 10, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.777 Vali Acc: 0.420 Test Loss: 1.777 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6846058368682861
Epoch: 11, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.337 Vali Acc: 0.560 Test Loss: 1.337 Test Acc: 0.560
Validation loss decreased (-0.459988 --> -0.559987).  Saving model ...
Epoch: 12 cost time: 1.8326258659362793
Epoch: 12, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.492 Vali Acc: 0.500 Test Loss: 1.492 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2620832920074463
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.892 Vali Acc: 0.540 Test Loss: 1.892 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5880482196807861
Epoch: 14, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.562 Vali Acc: 0.520 Test Loss: 1.562 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2849411964416504
Epoch: 15, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.575 Vali Acc: 0.540 Test Loss: 1.575 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5830368995666504
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.778 Vali Acc: 0.520 Test Loss: 1.778 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7485928535461426
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.916 Vali Acc: 0.540 Test Loss: 1.916 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.181452989578247
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.946 Vali Acc: 0.520 Test Loss: 1.946 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8396685123443604
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.931 Vali Acc: 0.520 Test Loss: 1.931 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2056713104248047
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.924 Vali Acc: 0.500 Test Loss: 1.924 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6210646629333496
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.914 Vali Acc: 0.500 Test Loss: 1.914 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 127102469
model size : 499.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6289265155792236
Epoch: 1, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.590 Vali Acc: 0.220 Test Loss: 1.590 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.2012178897857666
Epoch: 2, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.524 Vali Acc: 0.280 Test Loss: 1.524 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.5843067169189453
Epoch: 3, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.488 Vali Acc: 0.340 Test Loss: 1.488 Test Acc: 0.340
Validation loss decreased (-0.279985 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.772491216659546
Epoch: 4, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.429 Vali Acc: 0.440 Test Loss: 1.429 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.7848072052001953
Epoch: 5, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.472 Vali Acc: 0.460 Test Loss: 1.472 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459985).  Saving model ...
Epoch: 6 cost time: 1.6688365936279297
Epoch: 6, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 2.054720640182495
Epoch: 7, Steps: 4 | Train Loss: 0.214 Vali Loss: 1.392 Vali Acc: 0.540 Test Loss: 1.392 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539986).  Saving model ...
Epoch: 8 cost time: 2.232280969619751
Epoch: 8, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.683 Vali Acc: 0.500 Test Loss: 1.683 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9603321552276611
Epoch: 9, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.339 Vali Acc: 0.500 Test Loss: 1.339 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8940062522888184
Epoch: 10, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.923734188079834
Epoch: 11, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.514 Vali Acc: 0.460 Test Loss: 1.514 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1680104732513428
Epoch: 12, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.263 Vali Acc: 0.600 Test Loss: 1.263 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599987).  Saving model ...
Epoch: 13 cost time: 2.1185295581817627
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.069 Vali Acc: 0.520 Test Loss: 2.069 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.916771411895752
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.966 Vali Acc: 0.540 Test Loss: 1.966 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0115318298339844
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.452 Vali Acc: 0.600 Test Loss: 1.452 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6107368469238281
Epoch: 16, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.271 Vali Acc: 0.500 Test Loss: 2.271 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7845773696899414
Epoch: 17, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.957 Vali Acc: 0.500 Test Loss: 1.957 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2208771705627441
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.029 Vali Acc: 0.500 Test Loss: 2.029 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.30763840675354
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.139 Vali Acc: 0.500 Test Loss: 2.139 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4912512302398682
Epoch: 20, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.208 Vali Acc: 0.500 Test Loss: 2.208 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.934699296951294
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.753 Vali Acc: 0.500 Test Loss: 2.753 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7201783657073975
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.583 Vali Acc: 0.540 Test Loss: 1.583 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 136512005
model size : 535.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8637425899505615
Epoch: 1, Steps: 4 | Train Loss: 1.718 Vali Loss: 1.632 Vali Acc: 0.220 Test Loss: 1.632 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3919172286987305
Epoch: 2, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.553 Vali Acc: 0.240 Test Loss: 1.553 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.608288049697876
Epoch: 3, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.455 Vali Acc: 0.380 Test Loss: 1.455 Test Acc: 0.380
Validation loss decreased (-0.239984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 1.9089479446411133
Epoch: 4, Steps: 4 | Train Loss: 0.531 Vali Loss: 1.453 Vali Acc: 0.400 Test Loss: 1.453 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 2.10260272026062
Epoch: 5, Steps: 4 | Train Loss: 0.435 Vali Loss: 1.444 Vali Acc: 0.420 Test Loss: 1.444 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 1.858797550201416
Epoch: 6, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.392 Vali Acc: 0.500 Test Loss: 1.392 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.9610297679901123
Epoch: 7, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.504 Vali Acc: 0.400 Test Loss: 1.504 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8564980030059814
Epoch: 8, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.438 Vali Acc: 0.420 Test Loss: 1.438 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0500171184539795
Epoch: 9, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.424 Vali Acc: 0.500 Test Loss: 1.424 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.973907470703125
Epoch: 10, Steps: 4 | Train Loss: 0.024 Vali Loss: 2.038 Vali Acc: 0.440 Test Loss: 2.038 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9143164157867432
Epoch: 11, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.682 Vali Acc: 0.460 Test Loss: 1.682 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8923940658569336
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.533 Vali Acc: 0.480 Test Loss: 1.533 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9970715045928955
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.589 Vali Acc: 0.480 Test Loss: 1.589 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.267982244491577
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.882 Vali Acc: 0.480 Test Loss: 1.882 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5617458820343018
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.883 Vali Acc: 0.480 Test Loss: 1.883 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5513191223144531
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.961 Vali Acc: 0.480 Test Loss: 1.961 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 136436741
model size : 535.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.570192813873291
Epoch: 1, Steps: 4 | Train Loss: 1.822 Vali Loss: 1.674 Vali Acc: 0.200 Test Loss: 1.674 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.5493075847625732
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.673 Vali Acc: 0.360 Test Loss: 1.673 Test Acc: 0.360
Validation loss decreased (-0.199983 --> -0.359983).  Saving model ...
Epoch: 3 cost time: 1.876539945602417
Epoch: 3, Steps: 4 | Train Loss: 1.095 Vali Loss: 1.440 Vali Acc: 0.420 Test Loss: 1.440 Test Acc: 0.420
Validation loss decreased (-0.359983 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 1.7143516540527344
Epoch: 4, Steps: 4 | Train Loss: 0.823 Vali Loss: 1.387 Vali Acc: 0.360 Test Loss: 1.387 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.662778377532959
Epoch: 5, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.451 Vali Acc: 0.460 Test Loss: 1.451 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459985).  Saving model ...
Epoch: 6 cost time: 1.864673376083374
Epoch: 6, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.365 Vali Acc: 0.480 Test Loss: 1.365 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479986).  Saving model ...
Epoch: 7 cost time: 1.5142855644226074
Epoch: 7, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.273 Vali Acc: 0.560 Test Loss: 1.273 Test Acc: 0.560
Validation loss decreased (-0.479986 --> -0.559987).  Saving model ...
Epoch: 8 cost time: 1.8346006870269775
Epoch: 8, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.385 Vali Acc: 0.500 Test Loss: 1.385 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.883561372756958
Epoch: 9, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.507 Vali Acc: 0.500 Test Loss: 1.507 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.717822790145874
Epoch: 10, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.449 Vali Acc: 0.520 Test Loss: 1.449 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5299134254455566
Epoch: 11, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.292 Vali Acc: 0.500 Test Loss: 1.292 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5211927890777588
Epoch: 12, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.369 Vali Acc: 0.520 Test Loss: 1.369 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.065288782119751
Epoch: 13, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.424 Vali Acc: 0.520 Test Loss: 1.424 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5419001579284668
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.486 Vali Acc: 0.540 Test Loss: 1.486 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5180366039276123
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.668 Vali Acc: 0.520 Test Loss: 1.668 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8030779361724854
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.500 Test Loss: 1.692 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5054981708526611
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.704 Vali Acc: 0.480 Test Loss: 1.704 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 136393733
model size : 534.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1708927154541016
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.112650156021118
Epoch: 2, Steps: 4 | Train Loss: 1.478 Vali Loss: 1.417 Vali Acc: 0.320 Test Loss: 1.417 Test Acc: 0.320
Validation loss decreased (-0.239983 --> -0.319986).  Saving model ...
Epoch: 3 cost time: 2.119717597961426
Epoch: 3, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.294 Vali Acc: 0.360 Test Loss: 1.294 Test Acc: 0.360
Validation loss decreased (-0.319986 --> -0.359987).  Saving model ...
Epoch: 4 cost time: 2.4970169067382812
Epoch: 4, Steps: 4 | Train Loss: 0.586 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
Validation loss decreased (-0.359987 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 1.8020446300506592
Epoch: 5, Steps: 4 | Train Loss: 0.364 Vali Loss: 1.638 Vali Acc: 0.420 Test Loss: 1.638 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.118215322494507
Epoch: 6, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.503 Vali Acc: 0.500 Test Loss: 1.503 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499985).  Saving model ...
Epoch: 7 cost time: 2.621203899383545
Epoch: 7, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.303 Vali Acc: 0.540 Test Loss: 1.303 Test Acc: 0.540
Validation loss decreased (-0.499985 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 2.317570447921753
Epoch: 8, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.596 Vali Acc: 0.480 Test Loss: 1.596 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4915554523468018
Epoch: 9, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.895979642868042
Epoch: 10, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.538 Vali Acc: 0.520 Test Loss: 1.538 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.210362672805786
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.629 Vali Acc: 0.540 Test Loss: 1.629 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8408668041229248
Epoch: 12, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.800 Vali Acc: 0.500 Test Loss: 1.800 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2156739234924316
Epoch: 13, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.003 Vali Acc: 0.440 Test Loss: 2.003 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3067867755889893
Epoch: 14, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.074 Vali Acc: 0.440 Test Loss: 2.074 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.516648054122925
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.007 Vali Acc: 0.460 Test Loss: 2.007 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.297544240951538
Epoch: 16, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.520 Test Loss: 1.911 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.396568536758423
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.871 Vali Acc: 0.540 Test Loss: 1.871 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 148886021
model size : 582.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.250694990158081
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.724 Vali Acc: 0.120 Test Loss: 1.724 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 2.2740979194641113
Epoch: 2, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.531 Vali Acc: 0.300 Test Loss: 1.531 Test Acc: 0.300
Validation loss decreased (-0.119983 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 2.2862133979797363
Epoch: 3, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.431 Vali Acc: 0.320 Test Loss: 1.431 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319986).  Saving model ...
Epoch: 4 cost time: 1.957963466644287
Epoch: 4, Steps: 4 | Train Loss: 0.922 Vali Loss: 1.457 Vali Acc: 0.400 Test Loss: 1.457 Test Acc: 0.400
Validation loss decreased (-0.319986 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.6680045127868652
Epoch: 5, Steps: 4 | Train Loss: 0.531 Vali Loss: 1.464 Vali Acc: 0.400 Test Loss: 1.464 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6919629573822021
Epoch: 6, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.578 Vali Acc: 0.440 Test Loss: 1.578 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439984).  Saving model ...
Epoch: 7 cost time: 1.7224452495574951
Epoch: 7, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.273 Vali Acc: 0.440 Test Loss: 1.273 Test Acc: 0.440
Validation loss decreased (-0.439984 --> -0.439987).  Saving model ...
Epoch: 8 cost time: 1.3304238319396973
Epoch: 8, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.382 Vali Acc: 0.520 Test Loss: 1.382 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519986).  Saving model ...
Epoch: 9 cost time: 1.4568886756896973
Epoch: 9, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.575 Vali Acc: 0.460 Test Loss: 1.575 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6137652397155762
Epoch: 10, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.465 Vali Acc: 0.460 Test Loss: 1.465 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9549100399017334
Epoch: 11, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.526 Vali Acc: 0.460 Test Loss: 1.526 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1529417037963867
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.644 Vali Acc: 0.460 Test Loss: 1.644 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.056119203567505
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.605 Vali Acc: 0.460 Test Loss: 1.605 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4064080715179443
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.627 Vali Acc: 0.480 Test Loss: 1.627 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4253456592559814
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.615 Vali Acc: 0.480 Test Loss: 1.615 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7389962673187256
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.460 Test Loss: 1.617 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9398574829101562
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.633 Vali Acc: 0.500 Test Loss: 1.633 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.024566411972046
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.460 Test Loss: 1.681 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 148816133
model size : 582.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9041898250579834
Epoch: 1, Steps: 4 | Train Loss: 1.761 Vali Loss: 1.827 Vali Acc: 0.220 Test Loss: 1.827 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 1.9986557960510254
Epoch: 2, Steps: 4 | Train Loss: 1.399 Vali Loss: 1.530 Vali Acc: 0.320 Test Loss: 1.530 Test Acc: 0.320
Validation loss decreased (-0.219982 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.7531678676605225
Epoch: 3, Steps: 4 | Train Loss: 1.279 Vali Loss: 1.514 Vali Acc: 0.360 Test Loss: 1.514 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 2.276458978652954
Epoch: 4, Steps: 4 | Train Loss: 0.697 Vali Loss: 1.414 Vali Acc: 0.440 Test Loss: 1.414 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 3.0683515071868896
Epoch: 5, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.421 Vali Acc: 0.420 Test Loss: 1.421 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1317803859710693
Epoch: 6, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.348137140274048
Epoch: 7, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.455 Vali Acc: 0.440 Test Loss: 1.455 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4278435707092285
Epoch: 8, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.666 Vali Acc: 0.420 Test Loss: 1.666 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.166963577270508
Epoch: 9, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.465 Vali Acc: 0.460 Test Loss: 1.465 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459985).  Saving model ...
Epoch: 10 cost time: 2.202803134918213
Epoch: 10, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.706 Vali Acc: 0.460 Test Loss: 1.706 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2092387676239014
Epoch: 11, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.606 Vali Acc: 0.420 Test Loss: 1.606 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6715881824493408
Epoch: 12, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.822 Vali Acc: 0.440 Test Loss: 1.822 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.675076961517334
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.851 Vali Acc: 0.460 Test Loss: 1.851 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9137461185455322
Epoch: 14, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.779 Vali Acc: 0.440 Test Loss: 1.779 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.929542064666748
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.006 Vali Acc: 0.440 Test Loss: 2.006 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8573307991027832
Epoch: 16, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.854 Vali Acc: 0.460 Test Loss: 1.854 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8126099109649658
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.598 Vali Acc: 0.440 Test Loss: 1.598 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9058201313018799
Epoch: 18, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.934 Vali Acc: 0.460 Test Loss: 1.934 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8631856441497803
Epoch: 19, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.204 Vali Acc: 0.440 Test Loss: 2.204 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 148778501
model size : 582.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.715407371520996
Epoch: 1, Steps: 4 | Train Loss: 1.736 Vali Loss: 1.649 Vali Acc: 0.120 Test Loss: 1.649 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 2.531416177749634
Epoch: 2, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.368 Vali Acc: 0.320 Test Loss: 1.368 Test Acc: 0.320
Validation loss decreased (-0.119984 --> -0.319986).  Saving model ...
Epoch: 3 cost time: 1.9624042510986328
Epoch: 3, Steps: 4 | Train Loss: 1.088 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
Validation loss decreased (-0.319986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.9717366695404053
Epoch: 4, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.666 Vali Acc: 0.360 Test Loss: 1.666 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7700717449188232
Epoch: 5, Steps: 4 | Train Loss: 0.571 Vali Loss: 1.451 Vali Acc: 0.420 Test Loss: 1.451 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.913372278213501
Epoch: 6, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.602 Vali Acc: 0.400 Test Loss: 1.602 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.08530592918396
Epoch: 7, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.563 Vali Acc: 0.400 Test Loss: 1.563 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5179028511047363
Epoch: 8, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.806 Vali Acc: 0.420 Test Loss: 1.806 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.048447370529175
Epoch: 9, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.306 Vali Acc: 0.440 Test Loss: 1.306 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 2.097476005554199
Epoch: 10, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.763 Vali Acc: 0.480 Test Loss: 1.763 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479982).  Saving model ...
Epoch: 11 cost time: 2.3006203174591064
Epoch: 11, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.596 Vali Acc: 0.500 Test Loss: 1.596 Test Acc: 0.500
Validation loss decreased (-0.479982 --> -0.499984).  Saving model ...
Epoch: 12 cost time: 2.1417274475097656
Epoch: 12, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.107 Vali Acc: 0.460 Test Loss: 2.107 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1040022373199463
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.562 Vali Acc: 0.480 Test Loss: 1.562 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9810161590576172
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.716 Vali Acc: 0.500 Test Loss: 1.716 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6367578506469727
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.999 Vali Acc: 0.480 Test Loss: 1.999 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.915949821472168
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.571 Vali Acc: 0.520 Test Loss: 1.571 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519984).  Saving model ...
Epoch: 17 cost time: 2.873040199279785
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.525 Vali Acc: 0.520 Test Loss: 1.525 Test Acc: 0.520
Validation loss decreased (-0.519984 --> -0.519985).  Saving model ...
Epoch: 18 cost time: 2.2631587982177734
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.500 Test Loss: 1.790 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3691864013671875
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.038 Vali Acc: 0.460 Test Loss: 2.038 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5076839923858643
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.089 Vali Acc: 0.460 Test Loss: 2.089 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.142449378967285
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.440 Test Loss: 1.969 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5141940116882324
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.440 Test Loss: 1.898 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4924142360687256
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.460 Test Loss: 1.843 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.1025593280792236
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.921 Vali Acc: 0.440 Test Loss: 1.921 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8990583419799805
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.943 Vali Acc: 0.400 Test Loss: 1.943 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.4491004943847656
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.480 Test Loss: 1.884 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2273240089416504
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.500 Test Loss: 1.858 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 164364293
model size : 641.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6613595485687256
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.4140143394470215
Epoch: 2, Steps: 4 | Train Loss: 1.420 Vali Loss: 1.533 Vali Acc: 0.360 Test Loss: 1.533 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 2.4789254665374756
Epoch: 3, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.417 Vali Acc: 0.400 Test Loss: 1.417 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 2.4677841663360596
Epoch: 4, Steps: 4 | Train Loss: 0.653 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 2.8222219944000244
Epoch: 5, Steps: 4 | Train Loss: 0.386 Vali Loss: 1.558 Vali Acc: 0.480 Test Loss: 1.558 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6478142738342285
Epoch: 6, Steps: 4 | Train Loss: 0.417 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0497348308563232
Epoch: 7, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.533 Vali Acc: 0.480 Test Loss: 1.533 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.051229238510132
Epoch: 8, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.543 Vali Acc: 0.460 Test Loss: 1.543 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2928290367126465
Epoch: 9, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.515 Vali Acc: 0.500 Test Loss: 1.515 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 2.7970831394195557
Epoch: 10, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.761 Vali Acc: 0.440 Test Loss: 1.761 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2704343795776367
Epoch: 11, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.551 Vali Acc: 0.500 Test Loss: 1.551 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.584352970123291
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.926 Vali Acc: 0.440 Test Loss: 1.926 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5880537033081055
Epoch: 13, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.630 Vali Acc: 0.500 Test Loss: 1.630 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.255380392074585
Epoch: 14, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.121 Vali Acc: 0.440 Test Loss: 2.121 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5216400623321533
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.858 Vali Acc: 0.420 Test Loss: 1.858 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8680808544158936
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.736 Vali Acc: 0.440 Test Loss: 1.736 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8050153255462646
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.889 Vali Acc: 0.460 Test Loss: 1.889 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8608596324920654
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.018 Vali Acc: 0.480 Test Loss: 2.018 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0486350059509277
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.152 Vali Acc: 0.460 Test Loss: 2.152 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 164299781
model size : 641.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.608717918395996
Epoch: 1, Steps: 4 | Train Loss: 1.683 Vali Loss: 1.591 Vali Acc: 0.300 Test Loss: 1.591 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.4112324714660645
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.465 Vali Acc: 0.320 Test Loss: 1.465 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 2.292896270751953
Epoch: 3, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.360 Vali Acc: 0.380 Test Loss: 1.360 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 2.048476219177246
Epoch: 4, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.359 Vali Acc: 0.420 Test Loss: 1.359 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 1.9886300563812256
Epoch: 5, Steps: 4 | Train Loss: 0.446 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 2.1125752925872803
Epoch: 6, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.316 Vali Acc: 0.500 Test Loss: 1.316 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.139631748199463
Epoch: 7, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.359901189804077
Epoch: 8, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.516 Vali Acc: 0.500 Test Loss: 1.516 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.448225498199463
Epoch: 9, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.280 Vali Acc: 0.420 Test Loss: 1.280 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.267181634902954
Epoch: 10, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.655 Vali Acc: 0.460 Test Loss: 1.655 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.308230400085449
Epoch: 11, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.503 Vali Acc: 0.500 Test Loss: 1.503 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2276453971862793
Epoch: 12, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.713 Vali Acc: 0.500 Test Loss: 1.713 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3345227241516113
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.733 Vali Acc: 0.480 Test Loss: 1.733 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.27392840385437
Epoch: 14, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.397 Vali Acc: 0.440 Test Loss: 1.397 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.477419376373291
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.119502544403076
Epoch: 16, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.365 Vali Acc: 0.460 Test Loss: 1.365 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2031235694885254
Epoch: 17, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.378 Vali Acc: 0.520 Test Loss: 1.378 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519986).  Saving model ...
Epoch: 18 cost time: 1.9402666091918945
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.945 Vali Acc: 0.440 Test Loss: 1.945 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.85113525390625
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.279 Vali Acc: 0.420 Test Loss: 2.279 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.008962869644165
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.258 Vali Acc: 0.420 Test Loss: 2.258 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.058650255203247
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.052 Vali Acc: 0.440 Test Loss: 2.052 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2299816608428955
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.891 Vali Acc: 0.500 Test Loss: 1.891 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9507620334625244
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.500 Test Loss: 1.830 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2366995811462402
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.500 Test Loss: 1.850 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.713209629058838
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.500 Test Loss: 1.869 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9260351657867432
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.500 Test Loss: 1.881 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.107789993286133
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.500 Test Loss: 1.887 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 164267525
model size : 641.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.027297019958496
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.555 Vali Acc: 0.140 Test Loss: 1.555 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 2.051058292388916
Epoch: 2, Steps: 4 | Train Loss: 1.685 Vali Loss: 1.624 Vali Acc: 0.300 Test Loss: 1.624 Test Acc: 0.300
Validation loss decreased (-0.139984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.949115514755249
Epoch: 3, Steps: 4 | Train Loss: 1.182 Vali Loss: 1.572 Vali Acc: 0.340 Test Loss: 1.572 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.9315147399902344
Epoch: 4, Steps: 4 | Train Loss: 0.761 Vali Loss: 1.517 Vali Acc: 0.380 Test Loss: 1.517 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 2.430762529373169
Epoch: 5, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.609 Vali Acc: 0.380 Test Loss: 1.609 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4561524391174316
Epoch: 6, Steps: 4 | Train Loss: 0.476 Vali Loss: 1.695 Vali Acc: 0.440 Test Loss: 1.695 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439983).  Saving model ...
Epoch: 7 cost time: 2.767207384109497
Epoch: 7, Steps: 4 | Train Loss: 0.357 Vali Loss: 1.636 Vali Acc: 0.520 Test Loss: 1.636 Test Acc: 0.520
Validation loss decreased (-0.439983 --> -0.519984).  Saving model ...
Epoch: 8 cost time: 2.353402614593506
Epoch: 8, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.566 Vali Acc: 0.460 Test Loss: 1.566 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2780539989471436
Epoch: 9, Steps: 4 | Train Loss: 0.441 Vali Loss: 1.602 Vali Acc: 0.440 Test Loss: 1.602 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7083740234375
Epoch: 10, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.632 Vali Acc: 0.420 Test Loss: 1.632 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.075143575668335
Epoch: 11, Steps: 4 | Train Loss: 0.100 Vali Loss: 2.095 Vali Acc: 0.440 Test Loss: 2.095 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.255157709121704
Epoch: 12, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.962 Vali Acc: 0.480 Test Loss: 1.962 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5528440475463867
Epoch: 13, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.601 Vali Acc: 0.500 Test Loss: 1.601 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9900312423706055
Epoch: 14, Steps: 4 | Train Loss: 0.056 Vali Loss: 2.009 Vali Acc: 0.540 Test Loss: 2.009 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539980).  Saving model ...
Epoch: 15 cost time: 2.59122896194458
Epoch: 15, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.674 Vali Acc: 0.500 Test Loss: 1.674 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6168136596679688
Epoch: 16, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.730 Vali Acc: 0.480 Test Loss: 1.730 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3439888954162598
Epoch: 17, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.238 Vali Acc: 0.440 Test Loss: 2.238 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9104976654052734
Epoch: 18, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.889 Vali Acc: 0.480 Test Loss: 1.889 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7754642963409424
Epoch: 19, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.918 Vali Acc: 0.560 Test Loss: 1.918 Test Acc: 0.560
Validation loss decreased (-0.539980 --> -0.559981).  Saving model ...
Epoch: 20 cost time: 2.3237767219543457
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.972 Vali Acc: 0.500 Test Loss: 1.972 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.686398983001709
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.786 Vali Acc: 0.520 Test Loss: 1.786 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4386494159698486
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.725 Vali Acc: 0.540 Test Loss: 1.725 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3558359146118164
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.766 Vali Acc: 0.540 Test Loss: 1.766 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3819286823272705
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.520 Test Loss: 1.868 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.6562438011169434
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.988 Vali Acc: 0.540 Test Loss: 1.988 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.780433416366577
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.107 Vali Acc: 0.520 Test Loss: 2.107 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7192296981811523
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.207 Vali Acc: 0.520 Test Loss: 2.207 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.54841685295105
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.288 Vali Acc: 0.520 Test Loss: 2.288 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.1354076862335205
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.520 Test Loss: 2.340 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 182930693
model size : 712.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.2001988887786865
Epoch: 1, Steps: 4 | Train Loss: 1.832 Vali Loss: 1.610 Vali Acc: 0.180 Test Loss: 1.610 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.1091835498809814
Epoch: 2, Steps: 4 | Train Loss: 1.565 Vali Loss: 1.605 Vali Acc: 0.280 Test Loss: 1.605 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.325296401977539
Epoch: 3, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.544 Vali Acc: 0.400 Test Loss: 1.544 Test Acc: 0.400
Validation loss decreased (-0.279984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 2.8499462604522705
Epoch: 4, Steps: 4 | Train Loss: 0.724 Vali Loss: 1.593 Vali Acc: 0.440 Test Loss: 1.593 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439984).  Saving model ...
Epoch: 5 cost time: 1.579024314880371
Epoch: 5, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.464 Vali Acc: 0.420 Test Loss: 1.464 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5628037452697754
Epoch: 6, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.800 Vali Acc: 0.320 Test Loss: 1.800 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.392324686050415
Epoch: 7, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.721 Vali Acc: 0.340 Test Loss: 1.721 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5566318035125732
Epoch: 8, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.769 Vali Acc: 0.360 Test Loss: 1.769 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.42387318611145
Epoch: 9, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.622 Vali Acc: 0.360 Test Loss: 1.622 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9954311847686768
Epoch: 10, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7157883644104004
Epoch: 11, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.761 Vali Acc: 0.400 Test Loss: 1.761 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.775110960006714
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.589 Vali Acc: 0.400 Test Loss: 1.589 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0761749744415283
Epoch: 13, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.790 Vali Acc: 0.440 Test Loss: 1.790 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8150126934051514
Epoch: 14, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.778 Vali Acc: 0.400 Test Loss: 1.778 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 182882309
model size : 712.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4121627807617188
Epoch: 1, Steps: 4 | Train Loss: 1.727 Vali Loss: 1.774 Vali Acc: 0.240 Test Loss: 1.774 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 2.2982749938964844
Epoch: 2, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.549 Vali Acc: 0.240 Test Loss: 1.549 Test Acc: 0.240
Validation loss decreased (-0.239982 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 2.692016363143921
Epoch: 3, Steps: 4 | Train Loss: 0.912 Vali Loss: 1.385 Vali Acc: 0.380 Test Loss: 1.385 Test Acc: 0.380
Validation loss decreased (-0.239985 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 2.454763650894165
Epoch: 4, Steps: 4 | Train Loss: 0.732 Vali Loss: 1.349 Vali Acc: 0.440 Test Loss: 1.349 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439987).  Saving model ...
Epoch: 5 cost time: 2.6497726440429688
Epoch: 5, Steps: 4 | Train Loss: 0.557 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.41971755027771
Epoch: 6, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.513 Vali Acc: 0.380 Test Loss: 1.513 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.525493621826172
Epoch: 7, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.335 Vali Acc: 0.420 Test Loss: 1.335 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.521984338760376
Epoch: 8, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.603 Vali Acc: 0.400 Test Loss: 1.603 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.415041923522949
Epoch: 9, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.836 Vali Acc: 0.400 Test Loss: 1.836 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.963217258453369
Epoch: 10, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.535 Vali Acc: 0.400 Test Loss: 1.535 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7944464683532715
Epoch: 11, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.642 Vali Acc: 0.440 Test Loss: 1.642 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6500813961029053
Epoch: 12, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.863 Vali Acc: 0.420 Test Loss: 1.863 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7211973667144775
Epoch: 13, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.605 Vali Acc: 0.460 Test Loss: 1.605 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459984).  Saving model ...
Epoch: 14 cost time: 2.4863157272338867
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.684 Vali Acc: 0.440 Test Loss: 1.684 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8852593898773193
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.849 Vali Acc: 0.440 Test Loss: 1.849 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4324593544006348
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.934 Vali Acc: 0.440 Test Loss: 1.934 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.52752685546875
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.892 Vali Acc: 0.420 Test Loss: 1.892 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.097720146179199
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.852 Vali Acc: 0.440 Test Loss: 1.852 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.001939296722412
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.905 Vali Acc: 0.460 Test Loss: 1.905 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.335287094116211
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.994 Vali Acc: 0.440 Test Loss: 1.994 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.315079689025879
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.041 Vali Acc: 0.460 Test Loss: 2.041 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1851131916046143
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.040 Vali Acc: 0.460 Test Loss: 2.040 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.419729709625244
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.013 Vali Acc: 0.440 Test Loss: 2.013 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 182860805
model size : 712.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps54_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4845926761627197
Epoch: 1, Steps: 4 | Train Loss: 1.768 Vali Loss: 1.654 Vali Acc: 0.100 Test Loss: 1.654 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 2.8897273540496826
Epoch: 2, Steps: 4 | Train Loss: 1.320 Vali Loss: 1.422 Vali Acc: 0.380 Test Loss: 1.422 Test Acc: 0.380
Validation loss decreased (-0.099983 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 2.4856765270233154
Epoch: 3, Steps: 4 | Train Loss: 1.030 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 2.0474398136138916
Epoch: 4, Steps: 4 | Train Loss: 0.700 Vali Loss: 1.187 Vali Acc: 0.440 Test Loss: 1.187 Test Acc: 0.440
Validation loss decreased (-0.399988 --> -0.439988).  Saving model ...
Epoch: 5 cost time: 2.0061137676239014
Epoch: 5, Steps: 4 | Train Loss: 0.440 Vali Loss: 1.427 Vali Acc: 0.420 Test Loss: 1.427 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9008417129516602
Epoch: 6, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.425 Vali Acc: 0.380 Test Loss: 1.425 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.495628833770752
Epoch: 7, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.361 Vali Acc: 0.440 Test Loss: 1.361 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1220920085906982
Epoch: 8, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0758447647094727
Epoch: 9, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.496 Vali Acc: 0.460 Test Loss: 1.496 Test Acc: 0.460
Validation loss decreased (-0.439988 --> -0.459985).  Saving model ...
Epoch: 10 cost time: 2.7063980102539062
Epoch: 10, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.511 Vali Acc: 0.400 Test Loss: 1.511 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9620399475097656
Epoch: 11, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.539 Vali Acc: 0.440 Test Loss: 1.539 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.816023588180542
Epoch: 12, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.416 Vali Acc: 0.460 Test Loss: 1.416 Test Acc: 0.460
Validation loss decreased (-0.459985 --> -0.459986).  Saving model ...
Epoch: 13 cost time: 2.6022393703460693
Epoch: 13, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.607 Vali Acc: 0.460 Test Loss: 1.607 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8589377403259277
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.799 Vali Acc: 0.480 Test Loss: 1.799 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479982).  Saving model ...
Epoch: 15 cost time: 2.6043834686279297
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.854 Vali Acc: 0.460 Test Loss: 1.854 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5479209423065186
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8687424659729004
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.490 Vali Acc: 0.420 Test Loss: 1.490 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7576143741607666
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.600 Vali Acc: 0.440 Test Loss: 1.600 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.809471368789673
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.760 Vali Acc: 0.500 Test Loss: 1.760 Test Acc: 0.500
Validation loss decreased (-0.479982 --> -0.499982).  Saving model ...
Epoch: 20 cost time: 3.057255506515503
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.788 Vali Acc: 0.500 Test Loss: 1.788 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7917749881744385
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.809 Vali Acc: 0.480 Test Loss: 1.809 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7832863330841064
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.480 Test Loss: 1.814 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.013603925704956
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.480 Test Loss: 1.803 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3748393058776855
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.480 Test Loss: 1.810 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7960314750671387
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.480 Test Loss: 1.836 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.6759421825408936
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.480 Test Loss: 1.858 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.934735059738159
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.480 Test Loss: 1.879 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.7034380435943604
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.480 Test Loss: 1.898 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.422227382659912
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.480 Test Loss: 1.916 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps54_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 210804485
model size : 818.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.6223108768463135
Epoch: 1, Steps: 4 | Train Loss: 1.694 Vali Loss: 1.587 Vali Acc: 0.300 Test Loss: 1.587 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.3093655109405518
Epoch: 2, Steps: 4 | Train Loss: 1.420 Vali Loss: 1.527 Vali Acc: 0.320 Test Loss: 1.527 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 2.4412553310394287
Epoch: 3, Steps: 4 | Train Loss: 0.700 Vali Loss: 1.432 Vali Acc: 0.520 Test Loss: 1.432 Test Acc: 0.520
Validation loss decreased (-0.319985 --> -0.519986).  Saving model ...
Epoch: 4 cost time: 3.106468439102173
Epoch: 4, Steps: 4 | Train Loss: 0.535 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3635783195495605
Epoch: 5, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.378 Vali Acc: 0.520 Test Loss: 1.378 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 2.7688281536102295
Epoch: 6, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.591 Vali Acc: 0.480 Test Loss: 1.591 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.588779926300049
Epoch: 7, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.477 Vali Acc: 0.460 Test Loss: 1.477 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2895123958587646
Epoch: 8, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.308 Vali Acc: 0.540 Test Loss: 1.308 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 2.1606123447418213
Epoch: 9, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.709 Vali Acc: 0.500 Test Loss: 1.709 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1900222301483154
Epoch: 10, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.700 Vali Acc: 0.480 Test Loss: 1.700 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.478344678878784
Epoch: 11, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.814 Vali Acc: 0.460 Test Loss: 1.814 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6368560791015625
Epoch: 12, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.560 Vali Acc: 0.500 Test Loss: 1.560 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4511051177978516
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.429 Vali Acc: 0.560 Test Loss: 1.429 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559986).  Saving model ...
Epoch: 14 cost time: 2.634423017501831
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.559 Vali Acc: 0.520 Test Loss: 1.559 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0416259765625
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.871 Vali Acc: 0.480 Test Loss: 1.871 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4499425888061523
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.013 Vali Acc: 0.460 Test Loss: 2.013 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.701551914215088
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.787 Vali Acc: 0.500 Test Loss: 1.787 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5967557430267334
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.663 Vali Acc: 0.500 Test Loss: 1.663 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.68328857421875
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.480 Test Loss: 1.846 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7804009914398193
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.027 Vali Acc: 0.500 Test Loss: 2.027 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5837948322296143
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.131 Vali Acc: 0.480 Test Loss: 2.131 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2676329612731934
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.136 Vali Acc: 0.480 Test Loss: 2.136 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.321768283843994
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.048 Vali Acc: 0.500 Test Loss: 2.048 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 210766853
model size : 818.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps54_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.646294593811035
Epoch: 1, Steps: 4 | Train Loss: 1.746 Vali Loss: 1.696 Vali Acc: 0.160 Test Loss: 1.696 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.2437961101531982
Epoch: 2, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.620 Vali Acc: 0.300 Test Loss: 1.620 Test Acc: 0.300
Validation loss decreased (-0.159983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.097867727279663
Epoch: 3, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.363 Vali Acc: 0.340 Test Loss: 1.363 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339986).  Saving model ...
Epoch: 4 cost time: 1.8992106914520264
Epoch: 4, Steps: 4 | Train Loss: 0.626 Vali Loss: 1.378 Vali Acc: 0.380 Test Loss: 1.378 Test Acc: 0.380
Validation loss decreased (-0.339986 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 2.6388654708862305
Epoch: 5, Steps: 4 | Train Loss: 0.392 Vali Loss: 1.313 Vali Acc: 0.420 Test Loss: 1.313 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419987).  Saving model ...
Epoch: 6 cost time: 3.4072110652923584
Epoch: 6, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.296 Vali Acc: 0.420 Test Loss: 1.296 Test Acc: 0.420
Validation loss decreased (-0.419987 --> -0.419987).  Saving model ...
Epoch: 7 cost time: 2.4969284534454346
Epoch: 7, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.438 Vali Acc: 0.420 Test Loss: 1.438 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.631530523300171
Epoch: 8, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.415 Vali Acc: 0.440 Test Loss: 1.415 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439986).  Saving model ...
Epoch: 9 cost time: 3.5955185890197754
Epoch: 9, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.437 Vali Acc: 0.440 Test Loss: 1.437 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.732839584350586
Epoch: 10, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.756 Vali Acc: 0.400 Test Loss: 1.756 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.780698537826538
Epoch: 11, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.704 Vali Acc: 0.380 Test Loss: 1.704 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.226351022720337
Epoch: 12, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.544 Vali Acc: 0.480 Test Loss: 1.544 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479985).  Saving model ...
Epoch: 13 cost time: 3.0170412063598633
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.875 Vali Acc: 0.380 Test Loss: 1.875 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.52644681930542
Epoch: 14, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.574 Vali Acc: 0.440 Test Loss: 1.574 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0795199871063232
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.450 Vali Acc: 0.480 Test Loss: 1.450 Test Acc: 0.480
Validation loss decreased (-0.479985 --> -0.479986).  Saving model ...
Epoch: 16 cost time: 1.9574759006500244
Epoch: 16, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.727 Vali Acc: 0.460 Test Loss: 1.727 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2305688858032227
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.081 Vali Acc: 0.440 Test Loss: 2.081 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.972912549972534
Epoch: 18, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.944 Vali Acc: 0.420 Test Loss: 1.944 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9147331714630127
Epoch: 19, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.775 Vali Acc: 0.460 Test Loss: 1.775 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9340200424194336
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.927 Vali Acc: 0.440 Test Loss: 1.927 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.217747449874878
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.964 Vali Acc: 0.480 Test Loss: 1.964 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.987246513366699
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.480 Test Loss: 1.795 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.6767725944519043
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.736 Vali Acc: 0.520 Test Loss: 1.736 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519983).  Saving model ...
Epoch: 24 cost time: 2.3619136810302734
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3958017826080322
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.910 Vali Acc: 0.480 Test Loss: 1.910 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.5421981811523438
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.024 Vali Acc: 0.440 Test Loss: 2.024 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.414893388748169
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.093 Vali Acc: 0.440 Test Loss: 2.093 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.617659330368042
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.128 Vali Acc: 0.420 Test Loss: 2.128 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.757387399673462
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.141 Vali Acc: 0.420 Test Loss: 2.141 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.088081121444702
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.142 Vali Acc: 0.420 Test Loss: 2.142 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.9433746337890625
Epoch: 31, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.129 Vali Acc: 0.420 Test Loss: 2.129 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.612868547439575
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.114 Vali Acc: 0.420 Test Loss: 2.114 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.6335654258728027
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.420 Test Loss: 2.089 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el6_dm768_df768_ps54_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 210745349
model size : 818.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6018264293670654
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.612 Vali Acc: 0.120 Test Loss: 1.612 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.188107967376709
Epoch: 2, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.576 Vali Acc: 0.260 Test Loss: 1.576 Test Acc: 0.260
Validation loss decreased (-0.119984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.3688206672668457
Epoch: 3, Steps: 4 | Train Loss: 1.065 Vali Loss: 1.507 Vali Acc: 0.440 Test Loss: 1.507 Test Acc: 0.440
Validation loss decreased (-0.259984 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 1.0154883861541748
Epoch: 4, Steps: 4 | Train Loss: 0.887 Vali Loss: 1.359 Vali Acc: 0.460 Test Loss: 1.359 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.092484474182129
Epoch: 5, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.379 Vali Acc: 0.460 Test Loss: 1.379 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0230576992034912
Epoch: 6, Steps: 4 | Train Loss: 0.313 Vali Loss: 1.837 Vali Acc: 0.500 Test Loss: 1.837 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499982).  Saving model ...
Epoch: 7 cost time: 1.264495849609375
Epoch: 7, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.762 Vali Acc: 0.520 Test Loss: 1.762 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519982).  Saving model ...
Epoch: 8 cost time: 1.14194655418396
Epoch: 8, Steps: 4 | Train Loss: 0.196 Vali Loss: 2.350 Vali Acc: 0.540 Test Loss: 2.350 Test Acc: 0.540
Validation loss decreased (-0.519982 --> -0.539977).  Saving model ...
Epoch: 9 cost time: 1.1293745040893555
Epoch: 9, Steps: 4 | Train Loss: 0.091 Vali Loss: 2.009 Vali Acc: 0.420 Test Loss: 2.009 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6790473461151123
Epoch: 10, Steps: 4 | Train Loss: 0.087 Vali Loss: 2.678 Vali Acc: 0.460 Test Loss: 2.678 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2679684162139893
Epoch: 11, Steps: 4 | Train Loss: 0.072 Vali Loss: 2.006 Vali Acc: 0.360 Test Loss: 2.006 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2023425102233887
Epoch: 12, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.815 Vali Acc: 0.500 Test Loss: 1.815 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4287183284759521
Epoch: 13, Steps: 4 | Train Loss: 0.032 Vali Loss: 2.017 Vali Acc: 0.460 Test Loss: 2.017 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1953165531158447
Epoch: 14, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.682 Vali Acc: 0.540 Test Loss: 1.682 Test Acc: 0.540
Validation loss decreased (-0.539977 --> -0.539983).  Saving model ...
Epoch: 15 cost time: 1.1490459442138672
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.385 Vali Acc: 0.540 Test Loss: 2.385 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.209665298461914
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.394 Vali Acc: 0.540 Test Loss: 2.394 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.451828956604004
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.436 Vali Acc: 0.520 Test Loss: 2.436 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1780977249145508
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.550 Vali Acc: 0.480 Test Loss: 2.550 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.107215166091919
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.604 Vali Acc: 0.480 Test Loss: 2.604 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2120990753173828
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.575 Vali Acc: 0.500 Test Loss: 2.575 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5030243396759033
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.532 Vali Acc: 0.480 Test Loss: 2.532 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.416910171508789
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.528 Vali Acc: 0.480 Test Loss: 2.528 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2664780616760254
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.480 Test Loss: 2.549 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6353938579559326
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.600 Vali Acc: 0.480 Test Loss: 2.600 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 70846469
model size : 284.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4444940090179443
Epoch: 1, Steps: 4 | Train Loss: 1.741 Vali Loss: 1.631 Vali Acc: 0.120 Test Loss: 1.631 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.4856209754943848
Epoch: 2, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.555 Vali Acc: 0.240 Test Loss: 1.555 Test Acc: 0.240
Validation loss decreased (-0.119984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.1313118934631348
Epoch: 3, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.475 Vali Acc: 0.280 Test Loss: 1.475 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.1123380661010742
Epoch: 4, Steps: 4 | Train Loss: 0.855 Vali Loss: 1.421 Vali Acc: 0.520 Test Loss: 1.421 Test Acc: 0.520
Validation loss decreased (-0.279985 --> -0.519986).  Saving model ...
Epoch: 5 cost time: 1.1328420639038086
Epoch: 5, Steps: 4 | Train Loss: 0.661 Vali Loss: 1.604 Vali Acc: 0.440 Test Loss: 1.604 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3693952560424805
Epoch: 6, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.563 Vali Acc: 0.500 Test Loss: 1.563 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.002302646636963
Epoch: 7, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.422 Vali Acc: 0.560 Test Loss: 1.422 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559986).  Saving model ...
Epoch: 8 cost time: 1.2666349411010742
Epoch: 8, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.763 Vali Acc: 0.460 Test Loss: 1.763 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9162981510162354
Epoch: 9, Steps: 4 | Train Loss: 0.118 Vali Loss: 2.087 Vali Acc: 0.460 Test Loss: 2.087 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.105750560760498
Epoch: 10, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.602 Vali Acc: 0.460 Test Loss: 1.602 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3831284046173096
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.773 Vali Acc: 0.500 Test Loss: 1.773 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.132981777191162
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.487 Vali Acc: 0.540 Test Loss: 1.487 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2696928977966309
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.190 Vali Acc: 0.540 Test Loss: 2.190 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3475148677825928
Epoch: 14, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.305 Vali Acc: 0.540 Test Loss: 2.305 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.067643165588379
Epoch: 15, Steps: 4 | Train Loss: 0.059 Vali Loss: 2.039 Vali Acc: 0.540 Test Loss: 2.039 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9622311592102051
Epoch: 16, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.647 Vali Acc: 0.600 Test Loss: 1.647 Test Acc: 0.600
Validation loss decreased (-0.559986 --> -0.599984).  Saving model ...
Epoch: 17 cost time: 0.9846470355987549
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.512 Vali Acc: 0.560 Test Loss: 1.512 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2569701671600342
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.929 Vali Acc: 0.500 Test Loss: 1.929 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8832142353057861
Epoch: 19, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.970 Vali Acc: 0.520 Test Loss: 1.970 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2059109210968018
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.893 Vali Acc: 0.540 Test Loss: 1.893 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2424204349517822
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.931 Vali Acc: 0.500 Test Loss: 1.931 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2260699272155762
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.107 Vali Acc: 0.500 Test Loss: 2.107 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0193123817443848
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.258 Vali Acc: 0.500 Test Loss: 2.258 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3164482116699219
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.263 Vali Acc: 0.500 Test Loss: 2.263 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.116546392440796
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.500 Test Loss: 2.221 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0243885517120361
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.480 Test Loss: 2.183 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 70615301
model size : 284.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6266677379608154
Epoch: 1, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.636 Vali Acc: 0.220 Test Loss: 1.636 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0123744010925293
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.497 Vali Acc: 0.300 Test Loss: 1.497 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.011674165725708
Epoch: 3, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 1.030998945236206
Epoch: 4, Steps: 4 | Train Loss: 0.960 Vali Loss: 1.442 Vali Acc: 0.340 Test Loss: 1.442 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9540901184082031
Epoch: 5, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.398 Vali Acc: 0.540 Test Loss: 1.398 Test Acc: 0.540
Validation loss decreased (-0.379986 --> -0.539986).  Saving model ...
Epoch: 6 cost time: 1.0568492412567139
Epoch: 6, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.291 Vali Acc: 0.520 Test Loss: 1.291 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0104823112487793
Epoch: 7, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.180 Vali Acc: 0.520 Test Loss: 1.180 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.005838394165039
Epoch: 8, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.873 Vali Acc: 0.440 Test Loss: 1.873 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0438485145568848
Epoch: 9, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.684 Vali Acc: 0.520 Test Loss: 1.684 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9999291896820068
Epoch: 10, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.643 Vali Acc: 0.500 Test Loss: 1.643 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0371661186218262
Epoch: 11, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.268 Vali Acc: 0.520 Test Loss: 1.268 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0298385620117188
Epoch: 12, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.589 Vali Acc: 0.480 Test Loss: 1.589 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0345218181610107
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.704 Vali Acc: 0.480 Test Loss: 1.704 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2427995204925537
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.665 Vali Acc: 0.480 Test Loss: 1.665 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0323235988616943
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.806 Vali Acc: 0.500 Test Loss: 1.806 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 70507781
model size : 283.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5073139667510986
Epoch: 1, Steps: 4 | Train Loss: 1.953 Vali Loss: 1.676 Vali Acc: 0.200 Test Loss: 1.676 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.0878756046295166
Epoch: 2, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.492 Vali Acc: 0.220 Test Loss: 1.492 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219985).  Saving model ...
Epoch: 3 cost time: 1.2935810089111328
Epoch: 3, Steps: 4 | Train Loss: 1.328 Vali Loss: 1.461 Vali Acc: 0.420 Test Loss: 1.461 Test Acc: 0.420
Validation loss decreased (-0.219985 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 1.202627182006836
Epoch: 4, Steps: 4 | Train Loss: 0.774 Vali Loss: 1.400 Vali Acc: 0.440 Test Loss: 1.400 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.1574993133544922
Epoch: 5, Steps: 4 | Train Loss: 0.516 Vali Loss: 1.488 Vali Acc: 0.420 Test Loss: 1.488 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1850652694702148
Epoch: 6, Steps: 4 | Train Loss: 0.372 Vali Loss: 1.353 Vali Acc: 0.580 Test Loss: 1.353 Test Acc: 0.580
Validation loss decreased (-0.439986 --> -0.579986).  Saving model ...
Epoch: 7 cost time: 1.3348345756530762
Epoch: 7, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.201 Vali Acc: 0.600 Test Loss: 1.201 Test Acc: 0.600
Validation loss decreased (-0.579986 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 1.3823211193084717
Epoch: 8, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.772 Vali Acc: 0.560 Test Loss: 1.772 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.140690565109253
Epoch: 9, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.570 Vali Acc: 0.560 Test Loss: 1.570 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4121732711791992
Epoch: 10, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.614 Vali Acc: 0.480 Test Loss: 1.614 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4973182678222656
Epoch: 11, Steps: 4 | Train Loss: 0.060 Vali Loss: 2.749 Vali Acc: 0.500 Test Loss: 2.749 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.390629529953003
Epoch: 12, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.381 Vali Acc: 0.600 Test Loss: 1.381 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2856252193450928
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 2.123 Vali Acc: 0.580 Test Loss: 2.123 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3528571128845215
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.687 Vali Acc: 0.540 Test Loss: 2.687 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2803947925567627
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.715 Vali Acc: 0.560 Test Loss: 2.715 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2700674533843994
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.524 Vali Acc: 0.540 Test Loss: 2.524 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.247753381729126
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.383 Vali Acc: 0.520 Test Loss: 2.383 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 73945349
model size : 296.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.661062240600586
Epoch: 1, Steps: 4 | Train Loss: 1.733 Vali Loss: 1.655 Vali Acc: 0.200 Test Loss: 1.655 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.9944837093353271
Epoch: 2, Steps: 4 | Train Loss: 1.617 Vali Loss: 1.479 Vali Acc: 0.380 Test Loss: 1.479 Test Acc: 0.380
Validation loss decreased (-0.199983 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 0.9793701171875
Epoch: 3, Steps: 4 | Train Loss: 1.254 Vali Loss: 1.355 Vali Acc: 0.420 Test Loss: 1.355 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 1.179544448852539
Epoch: 4, Steps: 4 | Train Loss: 0.772 Vali Loss: 1.278 Vali Acc: 0.300 Test Loss: 1.278 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9070851802825928
Epoch: 5, Steps: 4 | Train Loss: 0.594 Vali Loss: 1.288 Vali Acc: 0.420 Test Loss: 1.288 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419987).  Saving model ...
Epoch: 6 cost time: 1.3405470848083496
Epoch: 6, Steps: 4 | Train Loss: 0.368 Vali Loss: 1.257 Vali Acc: 0.480 Test Loss: 1.257 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 1.1816661357879639
Epoch: 7, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 1.1871159076690674
Epoch: 8, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.402 Vali Acc: 0.460 Test Loss: 1.402 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9786956310272217
Epoch: 9, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.560 Vali Acc: 0.440 Test Loss: 1.560 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.175262689590454
Epoch: 10, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.512 Vali Acc: 0.460 Test Loss: 1.512 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9800572395324707
Epoch: 11, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.505 Vali Acc: 0.480 Test Loss: 1.505 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0030696392059326
Epoch: 12, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.394 Vali Acc: 0.540 Test Loss: 1.394 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539986).  Saving model ...
Epoch: 13 cost time: 0.9370536804199219
Epoch: 13, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.829 Vali Acc: 0.500 Test Loss: 1.829 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.903031587600708
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.016 Vali Acc: 0.500 Test Loss: 2.016 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9473943710327148
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.256 Vali Acc: 0.480 Test Loss: 2.256 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8965597152709961
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.536 Vali Acc: 0.440 Test Loss: 2.536 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8607814311981201
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.186 Vali Acc: 0.460 Test Loss: 2.186 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9366486072540283
Epoch: 18, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1633548736572266
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.954 Vali Acc: 0.540 Test Loss: 1.954 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0648653507232666
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.979 Vali Acc: 0.540 Test Loss: 1.979 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.008216381072998
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.840 Vali Acc: 0.560 Test Loss: 1.840 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559982).  Saving model ...
Epoch: 22 cost time: 1.1936113834381104
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.541 Vali Acc: 0.540 Test Loss: 1.541 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8685576915740967
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.825 Vali Acc: 0.540 Test Loss: 1.825 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0770316123962402
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.236 Vali Acc: 0.500 Test Loss: 2.236 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0134429931640625
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.361 Vali Acc: 0.500 Test Loss: 2.361 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1942245960235596
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.192 Vali Acc: 0.520 Test Loss: 2.192 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3734993934631348
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.520 Test Loss: 1.944 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2835514545440674
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.500 Test Loss: 1.830 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.107900619506836
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.520 Test Loss: 1.796 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9993278980255127
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.520 Test Loss: 1.780 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8744735717773438
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.540 Test Loss: 1.786 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 73714181
model size : 295.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4781174659729004
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.673 Vali Acc: 0.200 Test Loss: 1.673 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.2321500778198242
Epoch: 2, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.555 Vali Acc: 0.300 Test Loss: 1.555 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 0.9828817844390869
Epoch: 3, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.516 Vali Acc: 0.360 Test Loss: 1.516 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.0144846439361572
Epoch: 4, Steps: 4 | Train Loss: 0.893 Vali Loss: 1.355 Vali Acc: 0.460 Test Loss: 1.355 Test Acc: 0.460
Validation loss decreased (-0.359985 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.108811855316162
Epoch: 5, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9764046669006348
Epoch: 6, Steps: 4 | Train Loss: 0.319 Vali Loss: 1.323 Vali Acc: 0.580 Test Loss: 1.323 Test Acc: 0.580
Validation loss decreased (-0.459986 --> -0.579987).  Saving model ...
Epoch: 7 cost time: 0.9847762584686279
Epoch: 7, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.453 Vali Acc: 0.480 Test Loss: 1.453 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9794268608093262
Epoch: 8, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.565 Vali Acc: 0.460 Test Loss: 1.565 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.040450096130371
Epoch: 9, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.608 Vali Acc: 0.440 Test Loss: 1.608 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9422037601470947
Epoch: 10, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.493 Vali Acc: 0.440 Test Loss: 1.493 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8610913753509521
Epoch: 11, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.658 Vali Acc: 0.420 Test Loss: 1.658 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9937560558319092
Epoch: 12, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.581 Vali Acc: 0.420 Test Loss: 1.581 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.011002540588379
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.668 Vali Acc: 0.420 Test Loss: 1.668 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8337817192077637
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.899 Vali Acc: 0.400 Test Loss: 1.899 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8471946716308594
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.136 Vali Acc: 0.400 Test Loss: 2.136 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.095249891281128
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.050 Vali Acc: 0.400 Test Loss: 2.050 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 73595909
model size : 295.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8595008850097656
Epoch: 1, Steps: 4 | Train Loss: 1.743 Vali Loss: 1.609 Vali Acc: 0.260 Test Loss: 1.609 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3721187114715576
Epoch: 2, Steps: 4 | Train Loss: 1.705 Vali Loss: 1.599 Vali Acc: 0.240 Test Loss: 1.599 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9312963485717773
Epoch: 3, Steps: 4 | Train Loss: 1.080 Vali Loss: 1.545 Vali Acc: 0.480 Test Loss: 1.545 Test Acc: 0.480
Validation loss decreased (-0.259984 --> -0.479985).  Saving model ...
Epoch: 4 cost time: 1.3338558673858643
Epoch: 4, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.352 Vali Acc: 0.460 Test Loss: 1.352 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1885204315185547
Epoch: 5, Steps: 4 | Train Loss: 0.616 Vali Loss: 1.506 Vali Acc: 0.500 Test Loss: 1.506 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 1.0710482597351074
Epoch: 6, Steps: 4 | Train Loss: 0.374 Vali Loss: 1.555 Vali Acc: 0.440 Test Loss: 1.555 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2464091777801514
Epoch: 7, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.521 Vali Acc: 0.440 Test Loss: 1.521 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1082706451416016
Epoch: 8, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.9848206043243408
Epoch: 9, Steps: 4 | Train Loss: 0.275 Vali Loss: 2.125 Vali Acc: 0.500 Test Loss: 2.125 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0661349296569824
Epoch: 10, Steps: 4 | Train Loss: 0.154 Vali Loss: 1.844 Vali Acc: 0.400 Test Loss: 1.844 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0494332313537598
Epoch: 11, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.541 Vali Acc: 0.500 Test Loss: 1.541 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9808611869812012
Epoch: 12, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.983 Vali Acc: 0.460 Test Loss: 1.983 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0388989448547363
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.542 Vali Acc: 0.560 Test Loss: 1.542 Test Acc: 0.560
Validation loss decreased (-0.499987 --> -0.559985).  Saving model ...
Epoch: 14 cost time: 1.184051275253296
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.671 Vali Acc: 0.500 Test Loss: 1.671 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9556739330291748
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.976 Vali Acc: 0.540 Test Loss: 1.976 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3723928928375244
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.580 Test Loss: 1.816 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579982).  Saving model ...
Epoch: 17 cost time: 0.963320255279541
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.600 Test Loss: 1.691 Test Acc: 0.600
Validation loss decreased (-0.579982 --> -0.599983).  Saving model ...
Epoch: 18 cost time: 1.081432819366455
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.580 Test Loss: 1.661 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1262190341949463
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.620 Test Loss: 1.655 Test Acc: 0.620
Validation loss decreased (-0.599983 --> -0.619983).  Saving model ...
Epoch: 20 cost time: 1.0095672607421875
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.673 Vali Acc: 0.620 Test Loss: 1.673 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.025740385055542
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.620 Test Loss: 1.704 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9272196292877197
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.620 Test Loss: 1.731 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.037733793258667
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.640 Test Loss: 1.752 Test Acc: 0.640
Validation loss decreased (-0.619983 --> -0.639982).  Saving model ...
Epoch: 24 cost time: 1.118105411529541
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.640 Test Loss: 1.767 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1278965473175049
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.620 Test Loss: 1.778 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.239171028137207
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.620 Test Loss: 1.789 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0344500541687012
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.620 Test Loss: 1.798 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9846649169921875
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.620 Test Loss: 1.809 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.147156000137329
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.580 Test Loss: 1.828 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.894575834274292
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.580 Test Loss: 1.844 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.120962142944336
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.580 Test Loss: 1.855 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.115170955657959
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.864 Vali Acc: 0.580 Test Loss: 1.864 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.056004524230957
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.580 Test Loss: 1.869 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 76925957
model size : 308.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2527894973754883
Epoch: 1, Steps: 4 | Train Loss: 1.782 Vali Loss: 1.729 Vali Acc: 0.220 Test Loss: 1.729 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.3019731044769287
Epoch: 2, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.488 Vali Acc: 0.280 Test Loss: 1.488 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.03668212890625
Epoch: 3, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.310 Vali Acc: 0.460 Test Loss: 1.310 Test Acc: 0.460
Validation loss decreased (-0.279985 --> -0.459987).  Saving model ...
Epoch: 4 cost time: 1.2177793979644775
Epoch: 4, Steps: 4 | Train Loss: 0.804 Vali Loss: 1.413 Vali Acc: 0.420 Test Loss: 1.413 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0936517715454102
Epoch: 5, Steps: 4 | Train Loss: 0.689 Vali Loss: 1.336 Vali Acc: 0.440 Test Loss: 1.336 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2956616878509521
Epoch: 6, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2582721710205078
Epoch: 7, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.437 Vali Acc: 0.440 Test Loss: 1.437 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0144684314727783
Epoch: 8, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.373 Vali Acc: 0.460 Test Loss: 1.373 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9671106338500977
Epoch: 9, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.465 Vali Acc: 0.500 Test Loss: 1.465 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 1.045851469039917
Epoch: 10, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.678 Vali Acc: 0.480 Test Loss: 1.678 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2181870937347412
Epoch: 11, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.312 Vali Acc: 0.560 Test Loss: 1.312 Test Acc: 0.560
Validation loss decreased (-0.499985 --> -0.559987).  Saving model ...
Epoch: 12 cost time: 1.0228607654571533
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.049 Vali Acc: 0.420 Test Loss: 2.049 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.025214672088623
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.712 Vali Acc: 0.520 Test Loss: 1.712 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.078665018081665
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.563 Vali Acc: 0.540 Test Loss: 1.563 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.008338451385498
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.560 Test Loss: 1.715 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.181901454925537
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.979 Vali Acc: 0.500 Test Loss: 1.979 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9408388137817383
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.072 Vali Acc: 0.500 Test Loss: 2.072 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9489743709564209
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.086 Vali Acc: 0.500 Test Loss: 2.086 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8090543746948242
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.110 Vali Acc: 0.540 Test Loss: 2.110 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8595864772796631
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.125 Vali Acc: 0.540 Test Loss: 2.125 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.144930124282837
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.540 Test Loss: 2.132 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 76775429
model size : 307.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5848138332366943
Epoch: 1, Steps: 4 | Train Loss: 1.728 Vali Loss: 1.703 Vali Acc: 0.200 Test Loss: 1.703 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.9708693027496338
Epoch: 2, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.491 Vali Acc: 0.240 Test Loss: 1.491 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.1597537994384766
Epoch: 3, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
Validation loss decreased (-0.239985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.288820743560791
Epoch: 4, Steps: 4 | Train Loss: 0.935 Vali Loss: 1.294 Vali Acc: 0.460 Test Loss: 1.294 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459987).  Saving model ...
Epoch: 5 cost time: 1.2463231086730957
Epoch: 5, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.340 Vali Acc: 0.480 Test Loss: 1.340 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 1.047081470489502
Epoch: 6, Steps: 4 | Train Loss: 0.451 Vali Loss: 1.345 Vali Acc: 0.540 Test Loss: 1.345 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539987).  Saving model ...
Epoch: 7 cost time: 1.2140860557556152
Epoch: 7, Steps: 4 | Train Loss: 0.214 Vali Loss: 1.410 Vali Acc: 0.460 Test Loss: 1.410 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1934540271759033
Epoch: 8, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.614 Vali Acc: 0.420 Test Loss: 1.614 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1715717315673828
Epoch: 9, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.506 Vali Acc: 0.460 Test Loss: 1.506 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0556585788726807
Epoch: 10, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.610 Vali Acc: 0.460 Test Loss: 1.610 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1302976608276367
Epoch: 11, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.788 Vali Acc: 0.480 Test Loss: 1.788 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.14329195022583
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.057 Vali Acc: 0.520 Test Loss: 2.057 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2104802131652832
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2488157749176025
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.329 Vali Acc: 0.540 Test Loss: 1.329 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539987).  Saving model ...
Epoch: 15 cost time: 1.2914001941680908
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.620 Vali Acc: 0.500 Test Loss: 1.620 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.342641830444336
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.120 Vali Acc: 0.480 Test Loss: 2.120 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2075169086456299
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.025 Vali Acc: 0.480 Test Loss: 2.025 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.205296516418457
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.811 Vali Acc: 0.480 Test Loss: 1.811 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0912554264068604
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.500 Test Loss: 1.847 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2585723400115967
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.500 Test Loss: 1.870 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3360190391540527
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.520 Test Loss: 1.878 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0253734588623047
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.520 Test Loss: 1.904 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.223168134689331
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.500 Test Loss: 1.931 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.052894115447998
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.500 Test Loss: 1.957 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 76684037
model size : 307.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8748550415039062
Epoch: 1, Steps: 4 | Train Loss: 1.771 Vali Loss: 1.661 Vali Acc: 0.240 Test Loss: 1.661 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.23598051071167
Epoch: 2, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.541 Vali Acc: 0.340 Test Loss: 1.541 Test Acc: 0.340
Validation loss decreased (-0.239983 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.208089828491211
Epoch: 3, Steps: 4 | Train Loss: 1.173 Vali Loss: 1.447 Vali Acc: 0.500 Test Loss: 1.447 Test Acc: 0.500
Validation loss decreased (-0.339985 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 1.3532066345214844
Epoch: 4, Steps: 4 | Train Loss: 0.761 Vali Loss: 1.192 Vali Acc: 0.460 Test Loss: 1.192 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.236577033996582
Epoch: 5, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.484 Vali Acc: 0.340 Test Loss: 1.484 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1738471984863281
Epoch: 6, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.413 Vali Acc: 0.440 Test Loss: 1.413 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2306182384490967
Epoch: 7, Steps: 4 | Train Loss: 0.236 Vali Loss: 1.722 Vali Acc: 0.460 Test Loss: 1.722 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2381815910339355
Epoch: 8, Steps: 4 | Train Loss: 0.235 Vali Loss: 1.351 Vali Acc: 0.420 Test Loss: 1.351 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2044918537139893
Epoch: 9, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.970 Vali Acc: 0.460 Test Loss: 1.970 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1103031635284424
Epoch: 10, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.482 Vali Acc: 0.520 Test Loss: 1.482 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519985).  Saving model ...
Epoch: 11 cost time: 1.1022493839263916
Epoch: 11, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.153 Vali Acc: 0.440 Test Loss: 2.153 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2172813415527344
Epoch: 12, Steps: 4 | Train Loss: 0.105 Vali Loss: 2.090 Vali Acc: 0.540 Test Loss: 2.090 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539979).  Saving model ...
Epoch: 13 cost time: 1.0364172458648682
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.960 Vali Acc: 0.460 Test Loss: 1.960 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2556614875793457
Epoch: 14, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.862 Vali Acc: 0.540 Test Loss: 1.862 Test Acc: 0.540
Validation loss decreased (-0.539979 --> -0.539981).  Saving model ...
Epoch: 15 cost time: 0.9128139019012451
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.390 Vali Acc: 0.520 Test Loss: 2.390 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.522029161453247
Epoch: 16, Steps: 4 | Train Loss: 0.152 Vali Loss: 2.011 Vali Acc: 0.540 Test Loss: 2.011 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9861056804656982
Epoch: 17, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.778 Vali Acc: 0.560 Test Loss: 1.778 Test Acc: 0.560
Validation loss decreased (-0.539981 --> -0.559982).  Saving model ...
Epoch: 18 cost time: 1.511216402053833
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.806 Vali Acc: 0.540 Test Loss: 1.806 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2839105129241943
Epoch: 19, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.676 Vali Acc: 0.600 Test Loss: 1.676 Test Acc: 0.600
Validation loss decreased (-0.559982 --> -0.599983).  Saving model ...
Epoch: 20 cost time: 1.533179759979248
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.039 Vali Acc: 0.580 Test Loss: 2.039 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3415887355804443
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.385 Vali Acc: 0.540 Test Loss: 2.385 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.431307077407837
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.574 Vali Acc: 0.540 Test Loss: 2.574 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2681591510772705
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.641 Vali Acc: 0.540 Test Loss: 2.641 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.137014627456665
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.637 Vali Acc: 0.520 Test Loss: 2.637 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.300797462463379
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.597 Vali Acc: 0.520 Test Loss: 2.597 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1196362972259521
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.551 Vali Acc: 0.540 Test Loss: 2.551 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1383514404296875
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.503 Vali Acc: 0.540 Test Loss: 2.503 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1481430530548096
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.540 Test Loss: 2.450 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1045050621032715
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.540 Test Loss: 2.388 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 80024837
model size : 319.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4367010593414307
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.665 Vali Acc: 0.120 Test Loss: 1.665 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.207761526107788
Epoch: 2, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.642 Vali Acc: 0.240 Test Loss: 1.642 Test Acc: 0.240
Validation loss decreased (-0.119983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 0.9029724597930908
Epoch: 3, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.661 Vali Acc: 0.340 Test Loss: 1.661 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339983).  Saving model ...
Epoch: 4 cost time: 0.9936966896057129
Epoch: 4, Steps: 4 | Train Loss: 0.927 Vali Loss: 1.393 Vali Acc: 0.380 Test Loss: 1.393 Test Acc: 0.380
Validation loss decreased (-0.339983 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 1.1453213691711426
Epoch: 5, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.495 Vali Acc: 0.400 Test Loss: 1.495 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 1.2339308261871338
Epoch: 6, Steps: 4 | Train Loss: 0.386 Vali Loss: 1.311 Vali Acc: 0.520 Test Loss: 1.311 Test Acc: 0.520
Validation loss decreased (-0.399985 --> -0.519987).  Saving model ...
Epoch: 7 cost time: 1.1761963367462158
Epoch: 7, Steps: 4 | Train Loss: 0.691 Vali Loss: 1.553 Vali Acc: 0.480 Test Loss: 1.553 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2181487083435059
Epoch: 8, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1010749340057373
Epoch: 9, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.785 Vali Acc: 0.460 Test Loss: 1.785 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0008211135864258
Epoch: 10, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.570 Vali Acc: 0.520 Test Loss: 1.570 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1549420356750488
Epoch: 11, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2408030033111572
Epoch: 12, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.158 Vali Acc: 0.460 Test Loss: 2.158 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1322977542877197
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.926 Vali Acc: 0.440 Test Loss: 1.926 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0815894603729248
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.659 Vali Acc: 0.480 Test Loss: 1.659 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1005640029907227
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.520 Test Loss: 1.469 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.098243236541748
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.616 Vali Acc: 0.520 Test Loss: 1.616 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 79874309
model size : 319.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.652648448944092
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.548 Vali Acc: 0.260 Test Loss: 1.548 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.1038682460784912
Epoch: 2, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.549 Vali Acc: 0.300 Test Loss: 1.549 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.0771021842956543
Epoch: 3, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.613 Vali Acc: 0.360 Test Loss: 1.613 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.1117186546325684
Epoch: 4, Steps: 4 | Train Loss: 1.160 Vali Loss: 1.477 Vali Acc: 0.400 Test Loss: 1.477 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.1694512367248535
Epoch: 5, Steps: 4 | Train Loss: 0.612 Vali Loss: 1.350 Vali Acc: 0.480 Test Loss: 1.350 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.051199197769165
Epoch: 6, Steps: 4 | Train Loss: 0.451 Vali Loss: 1.320 Vali Acc: 0.460 Test Loss: 1.320 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0423080921173096
Epoch: 7, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.310 Vali Acc: 0.380 Test Loss: 1.310 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0573296546936035
Epoch: 8, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.247 Vali Acc: 0.440 Test Loss: 1.247 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0430076122283936
Epoch: 9, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.833 Vali Acc: 0.420 Test Loss: 1.833 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.059267282485962
Epoch: 10, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.381 Vali Acc: 0.460 Test Loss: 1.381 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9722261428833008
Epoch: 11, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 0.9728696346282959
Epoch: 12, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.240 Vali Acc: 0.540 Test Loss: 1.240 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539988).  Saving model ...
Epoch: 13 cost time: 1.5953712463378906
Epoch: 13, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.653 Vali Acc: 0.420 Test Loss: 1.653 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2445127964019775
Epoch: 14, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.735 Vali Acc: 0.440 Test Loss: 1.735 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2109498977661133
Epoch: 15, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.640 Vali Acc: 0.440 Test Loss: 1.640 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1526525020599365
Epoch: 16, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.769 Vali Acc: 0.440 Test Loss: 1.769 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2687437534332275
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.709 Vali Acc: 0.480 Test Loss: 1.709 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.189720630645752
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.815 Vali Acc: 0.480 Test Loss: 1.815 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0098602771759033
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.841 Vali Acc: 0.480 Test Loss: 1.841 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6007981300354004
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.827 Vali Acc: 0.440 Test Loss: 1.827 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4612836837768555
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.821 Vali Acc: 0.460 Test Loss: 1.821 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3221514225006104
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.812 Vali Acc: 0.460 Test Loss: 1.812 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 79777541
model size : 319.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9170029163360596
Epoch: 1, Steps: 4 | Train Loss: 1.731 Vali Loss: 1.604 Vali Acc: 0.200 Test Loss: 1.604 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.5132431983947754
Epoch: 2, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.149651288986206
Epoch: 3, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.493 Vali Acc: 0.400 Test Loss: 1.493 Test Acc: 0.400
Validation loss decreased (-0.239985 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.320814609527588
Epoch: 4, Steps: 4 | Train Loss: 0.777 Vali Loss: 1.540 Vali Acc: 0.340 Test Loss: 1.540 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3321962356567383
Epoch: 5, Steps: 4 | Train Loss: 0.530 Vali Loss: 1.705 Vali Acc: 0.420 Test Loss: 1.705 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419983).  Saving model ...
Epoch: 6 cost time: 1.2000422477722168
Epoch: 6, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.573 Vali Acc: 0.380 Test Loss: 1.573 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1486186981201172
Epoch: 7, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
Validation loss decreased (-0.419983 --> -0.419985).  Saving model ...
Epoch: 8 cost time: 1.0722737312316895
Epoch: 8, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.596 Vali Acc: 0.460 Test Loss: 1.596 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459984).  Saving model ...
Epoch: 9 cost time: 1.3590874671936035
Epoch: 9, Steps: 4 | Train Loss: 0.062 Vali Loss: 2.085 Vali Acc: 0.460 Test Loss: 2.085 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8637492656707764
Epoch: 10, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.455 Vali Acc: 0.520 Test Loss: 1.455 Test Acc: 0.520
Validation loss decreased (-0.459984 --> -0.519985).  Saving model ...
Epoch: 11 cost time: 1.2512621879577637
Epoch: 11, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.373 Vali Acc: 0.460 Test Loss: 2.373 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2288427352905273
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.927 Vali Acc: 0.460 Test Loss: 1.927 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1605005264282227
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.104 Vali Acc: 0.520 Test Loss: 2.104 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3479228019714355
Epoch: 14, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.653 Vali Acc: 0.560 Test Loss: 1.653 Test Acc: 0.560
Validation loss decreased (-0.519985 --> -0.559983).  Saving model ...
Epoch: 15 cost time: 0.93302321434021
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.781 Vali Acc: 0.440 Test Loss: 2.781 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8614599704742432
Epoch: 16, Steps: 4 | Train Loss: 0.048 Vali Loss: 3.277 Vali Acc: 0.340 Test Loss: 3.277 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1215879917144775
Epoch: 17, Steps: 4 | Train Loss: 0.084 Vali Loss: 2.809 Vali Acc: 0.440 Test Loss: 2.809 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.49165678024292
Epoch: 18, Steps: 4 | Train Loss: 0.036 Vali Loss: 2.255 Vali Acc: 0.560 Test Loss: 2.255 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0974411964416504
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.960 Vali Acc: 0.580 Test Loss: 1.960 Test Acc: 0.580
Validation loss decreased (-0.559983 --> -0.579980).  Saving model ...
Epoch: 20 cost time: 1.435964822769165
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.005 Vali Acc: 0.600 Test Loss: 2.005 Test Acc: 0.600
Validation loss decreased (-0.579980 --> -0.599980).  Saving model ...
Epoch: 21 cost time: 1.3066964149475098
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.869 Vali Acc: 0.540 Test Loss: 2.869 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4604122638702393
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.197 Vali Acc: 0.540 Test Loss: 3.197 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.196777105331421
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.979 Vali Acc: 0.500 Test Loss: 2.979 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3358380794525146
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.792 Vali Acc: 0.520 Test Loss: 2.792 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4680521488189697
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.677 Vali Acc: 0.560 Test Loss: 2.677 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3385353088378906
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.619 Vali Acc: 0.560 Test Loss: 2.619 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2665414810180664
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.606 Vali Acc: 0.540 Test Loss: 2.606 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4693799018859863
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.623 Vali Acc: 0.560 Test Loss: 2.623 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3370888233184814
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.669 Vali Acc: 0.540 Test Loss: 2.669 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2996013164520264
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.727 Vali Acc: 0.540 Test Loss: 2.727 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 83118341
model size : 331.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9936399459838867
Epoch: 1, Steps: 4 | Train Loss: 1.713 Vali Loss: 1.626 Vali Acc: 0.180 Test Loss: 1.626 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.3212151527404785
Epoch: 2, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.607 Vali Acc: 0.300 Test Loss: 1.607 Test Acc: 0.300
Validation loss decreased (-0.179984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.2265686988830566
Epoch: 3, Steps: 4 | Train Loss: 1.080 Vali Loss: 1.617 Vali Acc: 0.320 Test Loss: 1.617 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.1357083320617676
Epoch: 4, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.490 Vali Acc: 0.440 Test Loss: 1.490 Test Acc: 0.440
Validation loss decreased (-0.319984 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 1.151937484741211
Epoch: 5, Steps: 4 | Train Loss: 0.472 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.216604232788086
Epoch: 6, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.350 Vali Acc: 0.520 Test Loss: 1.350 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519987).  Saving model ...
Epoch: 7 cost time: 1.1174519062042236
Epoch: 7, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.536 Vali Acc: 0.540 Test Loss: 1.536 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539985).  Saving model ...
Epoch: 8 cost time: 1.152921199798584
Epoch: 8, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.904 Vali Acc: 0.440 Test Loss: 1.904 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0452985763549805
Epoch: 9, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.600 Vali Acc: 0.560 Test Loss: 1.600 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559984).  Saving model ...
Epoch: 10 cost time: 0.9123456478118896
Epoch: 10, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.896 Vali Acc: 0.520 Test Loss: 1.896 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.268446922302246
Epoch: 11, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.739 Vali Acc: 0.480 Test Loss: 1.739 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.302783489227295
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.470 Vali Acc: 0.540 Test Loss: 1.470 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6541357040405273
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.049 Vali Acc: 0.480 Test Loss: 2.049 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3896989822387695
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.641 Vali Acc: 0.460 Test Loss: 1.641 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5877838134765625
Epoch: 15, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.667 Vali Acc: 0.520 Test Loss: 1.667 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.433004379272461
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.701 Vali Acc: 0.540 Test Loss: 1.701 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4474339485168457
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.683 Vali Acc: 0.560 Test Loss: 1.683 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4296331405639648
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.810 Vali Acc: 0.520 Test Loss: 1.810 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1610310077667236
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.983 Vali Acc: 0.500 Test Loss: 1.983 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 82946309
model size : 331.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.126516342163086
Epoch: 1, Steps: 4 | Train Loss: 1.707 Vali Loss: 1.621 Vali Acc: 0.120 Test Loss: 1.621 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.1319169998168945
Epoch: 2, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.528 Vali Acc: 0.320 Test Loss: 1.528 Test Acc: 0.320
Validation loss decreased (-0.119984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.0363304615020752
Epoch: 3, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.476 Vali Acc: 0.360 Test Loss: 1.476 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 0.9760851860046387
Epoch: 4, Steps: 4 | Train Loss: 0.735 Vali Loss: 1.399 Vali Acc: 0.440 Test Loss: 1.399 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.2991173267364502
Epoch: 5, Steps: 4 | Train Loss: 0.427 Vali Loss: 1.401 Vali Acc: 0.420 Test Loss: 1.401 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0809104442596436
Epoch: 6, Steps: 4 | Train Loss: 0.382 Vali Loss: 1.402 Vali Acc: 0.460 Test Loss: 1.402 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.3637878894805908
Epoch: 7, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.383 Vali Acc: 0.440 Test Loss: 1.383 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1706461906433105
Epoch: 8, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 1.100670576095581
Epoch: 9, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.8602778911590576
Epoch: 10, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.479 Vali Acc: 0.460 Test Loss: 1.479 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9603629112243652
Epoch: 11, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.371 Vali Acc: 0.480 Test Loss: 1.371 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3019804954528809
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.669 Vali Acc: 0.460 Test Loss: 1.669 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2980923652648926
Epoch: 13, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.387 Vali Acc: 0.480 Test Loss: 1.387 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1263329982757568
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.215 Vali Acc: 0.540 Test Loss: 1.215 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539988).  Saving model ...
Epoch: 15 cost time: 1.3725590705871582
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.511 Vali Acc: 0.500 Test Loss: 1.511 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.082392692565918
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.947 Vali Acc: 0.460 Test Loss: 1.947 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9850692749023438
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.845 Vali Acc: 0.500 Test Loss: 1.845 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1662206649780273
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0550048351287842
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.759 Vali Acc: 0.520 Test Loss: 1.759 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.173433542251587
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.933 Vali Acc: 0.520 Test Loss: 1.933 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8835334777832031
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.970 Vali Acc: 0.500 Test Loss: 1.970 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0532937049865723
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.946 Vali Acc: 0.500 Test Loss: 1.946 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0878632068634033
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.520 Test Loss: 1.870 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9891571998596191
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.500 Test Loss: 1.805 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 82871045
model size : 330.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.682131290435791
Epoch: 1, Steps: 4 | Train Loss: 1.841 Vali Loss: 1.655 Vali Acc: 0.120 Test Loss: 1.655 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 0.8514184951782227
Epoch: 2, Steps: 4 | Train Loss: 1.594 Vali Loss: 1.579 Vali Acc: 0.300 Test Loss: 1.579 Test Acc: 0.300
Validation loss decreased (-0.119983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.0552988052368164
Epoch: 3, Steps: 4 | Train Loss: 1.088 Vali Loss: 1.532 Vali Acc: 0.480 Test Loss: 1.532 Test Acc: 0.480
Validation loss decreased (-0.299984 --> -0.479985).  Saving model ...
Epoch: 4 cost time: 1.3975493907928467
Epoch: 4, Steps: 4 | Train Loss: 0.639 Vali Loss: 1.548 Vali Acc: 0.440 Test Loss: 1.548 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9361672401428223
Epoch: 5, Steps: 4 | Train Loss: 0.357 Vali Loss: 1.608 Vali Acc: 0.380 Test Loss: 1.608 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4881362915039062
Epoch: 6, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.690 Vali Acc: 0.400 Test Loss: 1.690 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2182917594909668
Epoch: 7, Steps: 4 | Train Loss: 0.133 Vali Loss: 2.095 Vali Acc: 0.460 Test Loss: 2.095 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1890172958374023
Epoch: 8, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.967 Vali Acc: 0.460 Test Loss: 1.967 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2714669704437256
Epoch: 9, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.685 Vali Acc: 0.500 Test Loss: 1.685 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499983).  Saving model ...
Epoch: 10 cost time: 1.5857782363891602
Epoch: 10, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.306671380996704
Epoch: 11, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.471 Vali Acc: 0.460 Test Loss: 1.471 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2580535411834717
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.103 Vali Acc: 0.540 Test Loss: 2.103 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539979).  Saving model ...
Epoch: 13 cost time: 1.0918114185333252
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.195 Vali Acc: 0.560 Test Loss: 2.195 Test Acc: 0.560
Validation loss decreased (-0.539979 --> -0.559978).  Saving model ...
Epoch: 14 cost time: 1.029205560684204
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.989 Vali Acc: 0.540 Test Loss: 1.989 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9594252109527588
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.100 Vali Acc: 0.480 Test Loss: 2.100 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.118372917175293
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.247 Vali Acc: 0.480 Test Loss: 2.247 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1279489994049072
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.296 Vali Acc: 0.460 Test Loss: 2.296 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0900249481201172
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.316 Vali Acc: 0.440 Test Loss: 2.316 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1884222030639648
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.288 Vali Acc: 0.460 Test Loss: 2.288 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0900490283966064
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.460 Test Loss: 2.256 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.361159324645996
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.232 Vali Acc: 0.480 Test Loss: 2.232 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1030700206756592
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.215 Vali Acc: 0.520 Test Loss: 2.215 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2600786685943604
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.520 Test Loss: 2.206 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 86217221
model size : 343.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.508692741394043
Epoch: 1, Steps: 4 | Train Loss: 1.732 Vali Loss: 1.645 Vali Acc: 0.180 Test Loss: 1.645 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2233800888061523
Epoch: 2, Steps: 4 | Train Loss: 1.587 Vali Loss: 1.542 Vali Acc: 0.380 Test Loss: 1.542 Test Acc: 0.380
Validation loss decreased (-0.179984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 0.9831807613372803
Epoch: 3, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.391 Vali Acc: 0.480 Test Loss: 1.391 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479986).  Saving model ...
Epoch: 4 cost time: 0.9165456295013428
Epoch: 4, Steps: 4 | Train Loss: 0.580 Vali Loss: 1.345 Vali Acc: 0.480 Test Loss: 1.345 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 1.0346465110778809
Epoch: 5, Steps: 4 | Train Loss: 0.462 Vali Loss: 1.277 Vali Acc: 0.440 Test Loss: 1.277 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9659597873687744
Epoch: 6, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.472 Vali Acc: 0.460 Test Loss: 1.472 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9042665958404541
Epoch: 7, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.285 Vali Acc: 0.520 Test Loss: 1.285 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 1.223968744277954
Epoch: 8, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.385 Vali Acc: 0.460 Test Loss: 1.385 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3230273723602295
Epoch: 9, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.872 Vali Acc: 0.480 Test Loss: 1.872 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3012378215789795
Epoch: 10, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.469 Vali Acc: 0.500 Test Loss: 1.469 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2464780807495117
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.709 Vali Acc: 0.460 Test Loss: 1.709 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2383551597595215
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.377 Vali Acc: 0.540 Test Loss: 1.377 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539986).  Saving model ...
Epoch: 13 cost time: 0.9648513793945312
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.435 Vali Acc: 0.560 Test Loss: 1.435 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559986).  Saving model ...
Epoch: 14 cost time: 1.0696995258331299
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.086 Vali Acc: 0.500 Test Loss: 2.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.051471471786499
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.141 Vali Acc: 0.480 Test Loss: 2.141 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1124253273010254
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.897 Vali Acc: 0.500 Test Loss: 1.897 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0325427055358887
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.954 Vali Acc: 0.500 Test Loss: 1.954 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2434637546539307
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.520 Test Loss: 2.029 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9492909908294678
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.027 Vali Acc: 0.580 Test Loss: 2.027 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579980).  Saving model ...
Epoch: 20 cost time: 0.9139947891235352
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.560 Test Loss: 2.001 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2378618717193604
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.560 Test Loss: 1.973 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9322142601013184
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.580 Test Loss: 1.939 Test Acc: 0.580
Validation loss decreased (-0.579980 --> -0.579981).  Saving model ...
Epoch: 23 cost time: 0.9382174015045166
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.580 Test Loss: 1.900 Test Acc: 0.580
Validation loss decreased (-0.579981 --> -0.579981).  Saving model ...
Epoch: 24 cost time: 0.9433498382568359
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.600 Test Loss: 1.863 Test Acc: 0.600
Validation loss decreased (-0.579981 --> -0.599981).  Saving model ...
Epoch: 25 cost time: 1.4769246578216553
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.831 Vali Acc: 0.580 Test Loss: 1.831 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0313174724578857
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.600 Test Loss: 1.803 Test Acc: 0.600
Validation loss decreased (-0.599981 --> -0.599982).  Saving model ...
Epoch: 27 cost time: 1.3001081943511963
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.580 Test Loss: 1.776 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0936870574951172
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.600 Test Loss: 1.758 Test Acc: 0.600
Validation loss decreased (-0.599982 --> -0.599982).  Saving model ...
Epoch: 29 cost time: 1.562828779220581
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.600 Test Loss: 1.756 Test Acc: 0.600
Validation loss decreased (-0.599982 --> -0.599982).  Saving model ...
Epoch: 30 cost time: 1.1471328735351562
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.600 Test Loss: 1.763 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.41664719581604
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.600 Test Loss: 1.782 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0632598400115967
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.600 Test Loss: 1.807 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1265580654144287
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.600 Test Loss: 1.825 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.121457815170288
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.600 Test Loss: 1.840 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2704851627349854
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.600 Test Loss: 1.858 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0424587726593018
Epoch: 36, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.600 Test Loss: 1.870 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1694250106811523
Epoch: 37, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.600 Test Loss: 1.881 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9310002326965332
Epoch: 38, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.600 Test Loss: 1.890 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.912752628326416
Epoch: 39, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.600 Test Loss: 1.900 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 86045189
model size : 342.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6405110359191895
Epoch: 1, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.271238088607788
Epoch: 2, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.556 Vali Acc: 0.300 Test Loss: 1.556 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.0321533679962158
Epoch: 3, Steps: 4 | Train Loss: 1.091 Vali Loss: 1.410 Vali Acc: 0.440 Test Loss: 1.410 Test Acc: 0.440
Validation loss decreased (-0.299984 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 1.0139830112457275
Epoch: 4, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.445 Vali Acc: 0.380 Test Loss: 1.445 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0330281257629395
Epoch: 5, Steps: 4 | Train Loss: 0.569 Vali Loss: 1.459 Vali Acc: 0.420 Test Loss: 1.459 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2894954681396484
Epoch: 6, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.327 Vali Acc: 0.480 Test Loss: 1.327 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 1.0212018489837646
Epoch: 7, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.507 Vali Acc: 0.480 Test Loss: 1.507 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9580066204071045
Epoch: 8, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.817 Vali Acc: 0.420 Test Loss: 1.817 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9905693531036377
Epoch: 9, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.402 Vali Acc: 0.380 Test Loss: 1.402 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9657847881317139
Epoch: 10, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.683 Vali Acc: 0.420 Test Loss: 1.683 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0434982776641846
Epoch: 11, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.952 Vali Acc: 0.440 Test Loss: 1.952 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9532668590545654
Epoch: 12, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 0.9475724697113037
Epoch: 13, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.363 Vali Acc: 0.520 Test Loss: 1.363 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519986).  Saving model ...
Epoch: 14 cost time: 1.2159538269042969
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.958 Vali Acc: 0.460 Test Loss: 1.958 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1608738899230957
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.731 Vali Acc: 0.420 Test Loss: 1.731 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.029928207397461
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.728 Vali Acc: 0.400 Test Loss: 1.728 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8883492946624756
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.825 Vali Acc: 0.420 Test Loss: 1.825 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9734950065612793
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.787 Vali Acc: 0.420 Test Loss: 1.787 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0412979125976562
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.757 Vali Acc: 0.420 Test Loss: 1.757 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0687813758850098
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.440 Test Loss: 1.720 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9607160091400146
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.480 Test Loss: 1.694 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2191848754882812
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.703 Vali Acc: 0.480 Test Loss: 1.703 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9477872848510742
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.701 Vali Acc: 0.480 Test Loss: 1.701 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 85959173
model size : 342.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.110220432281494
Epoch: 1, Steps: 4 | Train Loss: 1.813 Vali Loss: 1.683 Vali Acc: 0.180 Test Loss: 1.683 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.2323486804962158
Epoch: 2, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.587 Vali Acc: 0.280 Test Loss: 1.587 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.2114927768707275
Epoch: 3, Steps: 4 | Train Loss: 1.118 Vali Loss: 1.404 Vali Acc: 0.360 Test Loss: 1.404 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 0.969287633895874
Epoch: 4, Steps: 4 | Train Loss: 0.615 Vali Loss: 1.513 Vali Acc: 0.380 Test Loss: 1.513 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.5777103900909424
Epoch: 5, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.712 Vali Acc: 0.380 Test Loss: 1.712 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6066398620605469
Epoch: 6, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.562 Vali Acc: 0.520 Test Loss: 1.562 Test Acc: 0.520
Validation loss decreased (-0.379985 --> -0.519984).  Saving model ...
Epoch: 7 cost time: 1.5131711959838867
Epoch: 7, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5765478610992432
Epoch: 8, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.650 Vali Acc: 0.520 Test Loss: 1.650 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3045604228973389
Epoch: 9, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.787 Vali Acc: 0.480 Test Loss: 1.787 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1795377731323242
Epoch: 10, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.451 Vali Acc: 0.520 Test Loss: 1.451 Test Acc: 0.520
Validation loss decreased (-0.519984 --> -0.519985).  Saving model ...
Epoch: 11 cost time: 1.222705602645874
Epoch: 11, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.820 Vali Acc: 0.540 Test Loss: 1.820 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539982).  Saving model ...
Epoch: 12 cost time: 1.1767141819000244
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.405 Vali Acc: 0.460 Test Loss: 2.405 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4857609272003174
Epoch: 13, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.560 Test Loss: 1.844 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559982).  Saving model ...
Epoch: 14 cost time: 1.3298988342285156
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.985 Vali Acc: 0.520 Test Loss: 1.985 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2412269115447998
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.201 Vali Acc: 0.500 Test Loss: 2.201 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5543217658996582
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.287 Vali Acc: 0.520 Test Loss: 2.287 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3765487670898438
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.255 Vali Acc: 0.540 Test Loss: 2.255 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1863138675689697
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.186 Vali Acc: 0.540 Test Loss: 2.186 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2201018333435059
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.125 Vali Acc: 0.520 Test Loss: 2.125 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1188328266143799
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.091 Vali Acc: 0.540 Test Loss: 2.091 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4261856079101562
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.540 Test Loss: 2.069 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2766923904418945
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.560 Test Loss: 2.056 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.152252197265625
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.058 Vali Acc: 0.560 Test Loss: 2.058 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 89246213
model size : 355.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.882037878036499
Epoch: 1, Steps: 4 | Train Loss: 1.788 Vali Loss: 1.580 Vali Acc: 0.180 Test Loss: 1.580 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.3320136070251465
Epoch: 2, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.1507246494293213
Epoch: 3, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.464 Vali Acc: 0.340 Test Loss: 1.464 Test Acc: 0.340
Validation loss decreased (-0.219984 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.1963856220245361
Epoch: 4, Steps: 4 | Train Loss: 0.657 Vali Loss: 1.339 Vali Acc: 0.480 Test Loss: 1.339 Test Acc: 0.480
Validation loss decreased (-0.339985 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 1.2294244766235352
Epoch: 5, Steps: 4 | Train Loss: 0.685 Vali Loss: 1.286 Vali Acc: 0.420 Test Loss: 1.286 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1084251403808594
Epoch: 6, Steps: 4 | Train Loss: 0.356 Vali Loss: 1.374 Vali Acc: 0.460 Test Loss: 1.374 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1014747619628906
Epoch: 7, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.331 Vali Acc: 0.460 Test Loss: 1.331 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0876500606536865
Epoch: 8, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.459 Vali Acc: 0.480 Test Loss: 1.459 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4277632236480713
Epoch: 9, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.617 Vali Acc: 0.420 Test Loss: 1.617 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.174489974975586
Epoch: 10, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.742 Vali Acc: 0.500 Test Loss: 1.742 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499983).  Saving model ...
Epoch: 11 cost time: 1.3576195240020752
Epoch: 11, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.457 Vali Acc: 0.520 Test Loss: 1.457 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519985).  Saving model ...
Epoch: 12 cost time: 1.112886667251587
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.380 Vali Acc: 0.540 Test Loss: 1.380 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539986).  Saving model ...
Epoch: 13 cost time: 1.2002224922180176
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.433 Vali Acc: 0.500 Test Loss: 1.433 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.170630693435669
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.520 Test Loss: 1.724 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4773519039154053
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.581 Vali Acc: 0.520 Test Loss: 1.581 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4002139568328857
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.560 Test Loss: 1.438 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559986).  Saving model ...
Epoch: 17 cost time: 1.3737318515777588
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.454 Vali Acc: 0.580 Test Loss: 1.454 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579985).  Saving model ...
Epoch: 18 cost time: 1.3752107620239258
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.610 Vali Acc: 0.560 Test Loss: 1.610 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4322412014007568
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.500 Test Loss: 1.749 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.26423978805542
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.520 Test Loss: 1.852 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1989972591400146
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.520 Test Loss: 1.918 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1994330883026123
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.520 Test Loss: 1.951 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4690806865692139
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.500 Test Loss: 1.977 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3440866470336914
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.981 Vali Acc: 0.520 Test Loss: 1.981 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.323767900466919
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.520 Test Loss: 1.944 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8198339939117432
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.540 Test Loss: 1.900 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1745421886444092
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.520 Test Loss: 1.856 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 89127941
model size : 354.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.643660545349121
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.586 Vali Acc: 0.280 Test Loss: 1.586 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.5036072731018066
Epoch: 2, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.446 Vali Acc: 0.340 Test Loss: 1.446 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339986).  Saving model ...
Epoch: 3 cost time: 1.2452044486999512
Epoch: 3, Steps: 4 | Train Loss: 1.044 Vali Loss: 1.315 Vali Acc: 0.380 Test Loss: 1.315 Test Acc: 0.380
Validation loss decreased (-0.339986 --> -0.379987).  Saving model ...
Epoch: 4 cost time: 1.447371244430542
Epoch: 4, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.249 Vali Acc: 0.440 Test Loss: 1.249 Test Acc: 0.440
Validation loss decreased (-0.379987 --> -0.439988).  Saving model ...
Epoch: 5 cost time: 1.4934124946594238
Epoch: 5, Steps: 4 | Train Loss: 0.650 Vali Loss: 1.238 Vali Acc: 0.440 Test Loss: 1.238 Test Acc: 0.440
Validation loss decreased (-0.439988 --> -0.439988).  Saving model ...
Epoch: 6 cost time: 1.0495848655700684
Epoch: 6, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.217 Vali Acc: 0.440 Test Loss: 1.217 Test Acc: 0.440
Validation loss decreased (-0.439988 --> -0.439988).  Saving model ...
Epoch: 7 cost time: 1.0577223300933838
Epoch: 7, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.340 Vali Acc: 0.420 Test Loss: 1.340 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.375340461730957
Epoch: 8, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
Validation loss decreased (-0.439988 --> -0.579988).  Saving model ...
Epoch: 9 cost time: 1.1423113346099854
Epoch: 9, Steps: 4 | Train Loss: 0.185 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 1.2215440273284912
Epoch: 10, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.651 Vali Acc: 0.420 Test Loss: 1.651 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2980053424835205
Epoch: 11, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.283203363418579
Epoch: 12, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.443 Vali Acc: 0.480 Test Loss: 1.443 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7073028087615967
Epoch: 13, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3063592910766602
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.242 Vali Acc: 0.480 Test Loss: 1.242 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4401767253875732
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.529 Vali Acc: 0.440 Test Loss: 1.529 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.298616886138916
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.883 Vali Acc: 0.420 Test Loss: 1.883 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.801182746887207
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.803 Vali Acc: 0.420 Test Loss: 1.803 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.487752914428711
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.460 Test Loss: 1.669 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3081228733062744
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.653 Vali Acc: 0.480 Test Loss: 1.653 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 89052677
model size : 354.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2778308391571045
Epoch: 1, Steps: 4 | Train Loss: 1.806 Vali Loss: 1.600 Vali Acc: 0.240 Test Loss: 1.600 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.553424596786499
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.557 Vali Acc: 0.400 Test Loss: 1.557 Test Acc: 0.400
Validation loss decreased (-0.239984 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 1.7838129997253418
Epoch: 3, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.554 Vali Acc: 0.300 Test Loss: 1.554 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5436475276947021
Epoch: 4, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.451 Vali Acc: 0.400 Test Loss: 1.451 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.3635802268981934
Epoch: 5, Steps: 4 | Train Loss: 0.564 Vali Loss: 1.501 Vali Acc: 0.440 Test Loss: 1.501 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 6 cost time: 1.6176443099975586
Epoch: 6, Steps: 4 | Train Loss: 0.323 Vali Loss: 1.572 Vali Acc: 0.500 Test Loss: 1.572 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 1.1281697750091553
Epoch: 7, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.686 Vali Acc: 0.400 Test Loss: 1.686 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1772050857543945
Epoch: 8, Steps: 4 | Train Loss: 0.065 Vali Loss: 2.022 Vali Acc: 0.320 Test Loss: 2.022 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1285374164581299
Epoch: 9, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.859 Vali Acc: 0.420 Test Loss: 1.859 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.681004524230957
Epoch: 10, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.932 Vali Acc: 0.480 Test Loss: 1.932 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2393763065338135
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.466 Vali Acc: 0.560 Test Loss: 1.466 Test Acc: 0.560
Validation loss decreased (-0.499984 --> -0.559985).  Saving model ...
Epoch: 12 cost time: 1.3474695682525635
Epoch: 12, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.085 Vali Acc: 0.520 Test Loss: 2.085 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3027620315551758
Epoch: 13, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.406 Vali Acc: 0.500 Test Loss: 2.406 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1283645629882812
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.498 Vali Acc: 0.540 Test Loss: 1.498 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3638815879821777
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.537 Vali Acc: 0.560 Test Loss: 1.537 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3381867408752441
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.789 Vali Acc: 0.560 Test Loss: 1.789 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9696013927459717
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.729 Vali Acc: 0.580 Test Loss: 1.729 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579983).  Saving model ...
Epoch: 18 cost time: 1.2149658203125
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.520 Test Loss: 1.722 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.312363862991333
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.925 Vali Acc: 0.500 Test Loss: 1.925 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2210047245025635
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.113 Vali Acc: 0.480 Test Loss: 2.113 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.543874740600586
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.239 Vali Acc: 0.480 Test Loss: 2.239 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.281874418258667
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.288 Vali Acc: 0.480 Test Loss: 2.288 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1613225936889648
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.500 Test Loss: 2.284 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2249763011932373
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.283 Vali Acc: 0.500 Test Loss: 2.283 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.32509183883667
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.278 Vali Acc: 0.500 Test Loss: 2.278 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3874902725219727
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.264 Vali Acc: 0.500 Test Loss: 2.264 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3100755214691162
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.246 Vali Acc: 0.500 Test Loss: 2.246 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 92345093
model size : 366.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9435346126556396
Epoch: 1, Steps: 4 | Train Loss: 1.751 Vali Loss: 1.691 Vali Acc: 0.160 Test Loss: 1.691 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.119164228439331
Epoch: 2, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.688 Vali Acc: 0.260 Test Loss: 1.688 Test Acc: 0.260
Validation loss decreased (-0.159983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.0906188488006592
Epoch: 3, Steps: 4 | Train Loss: 1.201 Vali Loss: 1.711 Vali Acc: 0.400 Test Loss: 1.711 Test Acc: 0.400
Validation loss decreased (-0.259983 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 0.9874563217163086
Epoch: 4, Steps: 4 | Train Loss: 0.839 Vali Loss: 1.614 Vali Acc: 0.480 Test Loss: 1.614 Test Acc: 0.480
Validation loss decreased (-0.399983 --> -0.479984).  Saving model ...
Epoch: 5 cost time: 1.4287762641906738
Epoch: 5, Steps: 4 | Train Loss: 0.445 Vali Loss: 1.427 Vali Acc: 0.460 Test Loss: 1.427 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5108704566955566
Epoch: 6, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.493 Vali Acc: 0.400 Test Loss: 1.493 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2357516288757324
Epoch: 7, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.370 Vali Acc: 0.480 Test Loss: 1.370 Test Acc: 0.480
Validation loss decreased (-0.479984 --> -0.479986).  Saving model ...
Epoch: 8 cost time: 1.1668369770050049
Epoch: 8, Steps: 4 | Train Loss: 0.454 Vali Loss: 1.369 Vali Acc: 0.480 Test Loss: 1.369 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479986).  Saving model ...
Epoch: 9 cost time: 1.4040982723236084
Epoch: 9, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.498 Vali Acc: 0.440 Test Loss: 1.498 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.282235860824585
Epoch: 10, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.791 Vali Acc: 0.460 Test Loss: 1.791 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6056063175201416
Epoch: 11, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.506 Vali Acc: 0.480 Test Loss: 1.506 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5887162685394287
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.468 Vali Acc: 0.500 Test Loss: 1.468 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499985).  Saving model ...
Epoch: 13 cost time: 1.3208227157592773
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.944 Vali Acc: 0.480 Test Loss: 1.944 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4536161422729492
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.054 Vali Acc: 0.460 Test Loss: 2.054 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6242105960845947
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.957 Vali Acc: 0.500 Test Loss: 1.957 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1328914165496826
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.971 Vali Acc: 0.540 Test Loss: 1.971 Test Acc: 0.540
Validation loss decreased (-0.499985 --> -0.539980).  Saving model ...
Epoch: 17 cost time: 1.17683744430542
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.001 Vali Acc: 0.540 Test Loss: 2.001 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5248777866363525
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.042 Vali Acc: 0.540 Test Loss: 2.042 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2254862785339355
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.076 Vali Acc: 0.540 Test Loss: 2.076 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.085266351699829
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.163 Vali Acc: 0.560 Test Loss: 2.163 Test Acc: 0.560
Validation loss decreased (-0.539980 --> -0.559978).  Saving model ...
Epoch: 21 cost time: 0.9412941932678223
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.311 Vali Acc: 0.520 Test Loss: 2.311 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3743865489959717
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.382 Vali Acc: 0.520 Test Loss: 2.382 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2402288913726807
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.406 Vali Acc: 0.520 Test Loss: 2.406 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3355729579925537
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.374 Vali Acc: 0.520 Test Loss: 2.374 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4733285903930664
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.520 Test Loss: 2.349 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4520823955535889
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.335 Vali Acc: 0.520 Test Loss: 2.335 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.375330924987793
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.337 Vali Acc: 0.520 Test Loss: 2.337 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5152349472045898
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.346 Vali Acc: 0.520 Test Loss: 2.346 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.253889799118042
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.351 Vali Acc: 0.520 Test Loss: 2.351 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1842703819274902
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.354 Vali Acc: 0.520 Test Loss: 2.354 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 92226821
model size : 366.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0876102447509766
Epoch: 1, Steps: 4 | Train Loss: 1.715 Vali Loss: 1.627 Vali Acc: 0.120 Test Loss: 1.627 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.4640953540802002
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.552 Vali Acc: 0.220 Test Loss: 1.552 Test Acc: 0.220
Validation loss decreased (-0.119984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.2846322059631348
Epoch: 3, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.483 Vali Acc: 0.320 Test Loss: 1.483 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.2729177474975586
Epoch: 4, Steps: 4 | Train Loss: 0.882 Vali Loss: 1.463 Vali Acc: 0.380 Test Loss: 1.463 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.308412790298462
Epoch: 5, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.341 Vali Acc: 0.440 Test Loss: 1.341 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 1.1319468021392822
Epoch: 6, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.260 Vali Acc: 0.520 Test Loss: 1.260 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519987).  Saving model ...
Epoch: 7 cost time: 1.2675468921661377
Epoch: 7, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.308 Vali Acc: 0.480 Test Loss: 1.308 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1081173419952393
Epoch: 8, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.509 Vali Acc: 0.480 Test Loss: 1.509 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.042750358581543
Epoch: 9, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1659846305847168
Epoch: 10, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.685 Vali Acc: 0.440 Test Loss: 1.685 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.141172170639038
Epoch: 11, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.329 Vali Acc: 0.480 Test Loss: 1.329 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.141007900238037
Epoch: 12, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.284 Vali Acc: 0.520 Test Loss: 1.284 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3009757995605469
Epoch: 13, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.318 Vali Acc: 0.600 Test Loss: 1.318 Test Acc: 0.600
Validation loss decreased (-0.519987 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 1.3239729404449463
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.584 Vali Acc: 0.520 Test Loss: 1.584 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.220015287399292
Epoch: 15, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.445 Vali Acc: 0.540 Test Loss: 1.445 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2303166389465332
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.335 Vali Acc: 0.480 Test Loss: 1.335 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.439917802810669
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.591 Vali Acc: 0.520 Test Loss: 1.591 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1639404296875
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.870 Vali Acc: 0.460 Test Loss: 1.870 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5111424922943115
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.924 Vali Acc: 0.480 Test Loss: 1.924 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.522815465927124
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.520 Test Loss: 1.853 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0932433605194092
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.758 Vali Acc: 0.580 Test Loss: 1.758 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5017280578613281
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.710 Vali Acc: 0.580 Test Loss: 1.710 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1595561504364014
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.707 Vali Acc: 0.580 Test Loss: 1.707 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 92151557
model size : 366.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1295948028564453
Epoch: 1, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.629 Vali Acc: 0.200 Test Loss: 1.629 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.289208173751831
Epoch: 2, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.511 Vali Acc: 0.380 Test Loss: 1.511 Test Acc: 0.380
Validation loss decreased (-0.199984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.187706470489502
Epoch: 3, Steps: 4 | Train Loss: 1.089 Vali Loss: 1.242 Vali Acc: 0.460 Test Loss: 1.242 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459988).  Saving model ...
Epoch: 4 cost time: 1.734121561050415
Epoch: 4, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.289 Vali Acc: 0.420 Test Loss: 1.289 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.810096025466919
Epoch: 5, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.471 Vali Acc: 0.480 Test Loss: 1.471 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479985).  Saving model ...
Epoch: 6 cost time: 1.1819398403167725
Epoch: 6, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.398 Vali Acc: 0.540 Test Loss: 1.398 Test Acc: 0.540
Validation loss decreased (-0.479985 --> -0.539986).  Saving model ...
Epoch: 7 cost time: 1.607604742050171
Epoch: 7, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.636 Vali Acc: 0.520 Test Loss: 1.636 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2595767974853516
Epoch: 8, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.398 Vali Acc: 0.540 Test Loss: 1.398 Test Acc: 0.540
Validation loss decreased (-0.539986 --> -0.539986).  Saving model ...
Epoch: 9 cost time: 1.3348164558410645
Epoch: 9, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.114 Vali Acc: 0.580 Test Loss: 1.114 Test Acc: 0.580
Validation loss decreased (-0.539986 --> -0.579989).  Saving model ...
Epoch: 10 cost time: 1.747950553894043
Epoch: 10, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.089 Vali Acc: 0.480 Test Loss: 2.089 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5283887386322021
Epoch: 11, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.396 Vali Acc: 0.540 Test Loss: 1.396 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6177215576171875
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.008 Vali Acc: 0.520 Test Loss: 2.008 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5652709007263184
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.495 Vali Acc: 0.480 Test Loss: 2.495 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5494768619537354
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.498 Vali Acc: 0.500 Test Loss: 2.498 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7033617496490479
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.513 Vali Acc: 0.500 Test Loss: 2.513 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.295837640762329
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.462 Vali Acc: 0.540 Test Loss: 2.462 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.239389419555664
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.353 Vali Acc: 0.520 Test Loss: 2.353 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3600614070892334
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.276 Vali Acc: 0.580 Test Loss: 2.276 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3929626941680908
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.208 Vali Acc: 0.580 Test Loss: 2.208 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 98542853
model size : 390.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3339500427246094
Epoch: 1, Steps: 4 | Train Loss: 1.686 Vali Loss: 1.653 Vali Acc: 0.180 Test Loss: 1.653 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.605830192565918
Epoch: 2, Steps: 4 | Train Loss: 1.491 Vali Loss: 1.498 Vali Acc: 0.300 Test Loss: 1.498 Test Acc: 0.300
Validation loss decreased (-0.179983 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.2138950824737549
Epoch: 3, Steps: 4 | Train Loss: 0.944 Vali Loss: 1.330 Vali Acc: 0.360 Test Loss: 1.330 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359987).  Saving model ...
Epoch: 4 cost time: 1.2577879428863525
Epoch: 4, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.421 Vali Acc: 0.380 Test Loss: 1.421 Test Acc: 0.380
Validation loss decreased (-0.359987 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 1.3379149436950684
Epoch: 5, Steps: 4 | Train Loss: 0.479 Vali Loss: 1.525 Vali Acc: 0.380 Test Loss: 1.525 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.858328104019165
Epoch: 6, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.251 Vali Acc: 0.460 Test Loss: 1.251 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 1.2404143810272217
Epoch: 7, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.684 Vali Acc: 0.440 Test Loss: 1.684 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2114713191986084
Epoch: 8, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.259 Vali Acc: 0.420 Test Loss: 1.259 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0363256931304932
Epoch: 9, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.563 Vali Acc: 0.420 Test Loss: 1.563 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.969538688659668
Epoch: 10, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.330 Vali Acc: 0.480 Test Loss: 1.330 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.075937032699585
Epoch: 11, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.800 Vali Acc: 0.500 Test Loss: 1.800 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499982).  Saving model ...
Epoch: 12 cost time: 1.2872052192687988
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.446 Vali Acc: 0.580 Test Loss: 1.446 Test Acc: 0.580
Validation loss decreased (-0.499982 --> -0.579986).  Saving model ...
Epoch: 13 cost time: 1.6018610000610352
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.625 Vali Acc: 0.500 Test Loss: 1.625 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3588602542877197
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.810 Vali Acc: 0.540 Test Loss: 1.810 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5339164733886719
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.846 Vali Acc: 0.520 Test Loss: 1.846 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5100979804992676
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.746 Vali Acc: 0.540 Test Loss: 1.746 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.659276008605957
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.552 Vali Acc: 0.540 Test Loss: 1.552 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4213709831237793
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.540 Test Loss: 1.474 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0274837017059326
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.540 Test Loss: 1.469 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.113417625427246
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.494 Vali Acc: 0.560 Test Loss: 1.494 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.055393695831299
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.580 Test Loss: 1.536 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.18342661857605
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.560 Test Loss: 1.599 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 98408453
model size : 390.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1106667518615723
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.679 Vali Acc: 0.120 Test Loss: 1.679 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.509092092514038
Epoch: 2, Steps: 4 | Train Loss: 1.514 Vali Loss: 1.591 Vali Acc: 0.320 Test Loss: 1.591 Test Acc: 0.320
Validation loss decreased (-0.119983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.3984460830688477
Epoch: 3, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.506 Vali Acc: 0.340 Test Loss: 1.506 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.4067554473876953
Epoch: 4, Steps: 4 | Train Loss: 0.712 Vali Loss: 1.461 Vali Acc: 0.380 Test Loss: 1.461 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.3159847259521484
Epoch: 5, Steps: 4 | Train Loss: 0.524 Vali Loss: 1.367 Vali Acc: 0.440 Test Loss: 1.367 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.6495931148529053
Epoch: 6, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.396 Vali Acc: 0.440 Test Loss: 1.396 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5409581661224365
Epoch: 7, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.3906383514404297
Epoch: 8, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.297 Vali Acc: 0.440 Test Loss: 1.297 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4370496273040771
Epoch: 9, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.411 Vali Acc: 0.400 Test Loss: 1.411 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.348160743713379
Epoch: 10, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.349 Vali Acc: 0.380 Test Loss: 1.349 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6263020038604736
Epoch: 11, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.456 Vali Acc: 0.420 Test Loss: 1.456 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2876300811767578
Epoch: 12, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.367 Vali Acc: 0.480 Test Loss: 1.367 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3673326969146729
Epoch: 13, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.443 Vali Acc: 0.420 Test Loss: 1.443 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4656178951263428
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.661 Vali Acc: 0.420 Test Loss: 1.661 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3990590572357178
Epoch: 15, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.605 Vali Acc: 0.420 Test Loss: 1.605 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.439579725265503
Epoch: 16, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.578 Vali Acc: 0.480 Test Loss: 1.578 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4253623485565186
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.943 Vali Acc: 0.420 Test Loss: 1.943 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 98338565
model size : 389.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6512982845306396
Epoch: 1, Steps: 4 | Train Loss: 1.817 Vali Loss: 1.645 Vali Acc: 0.240 Test Loss: 1.645 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.3106467723846436
Epoch: 2, Steps: 4 | Train Loss: 1.464 Vali Loss: 1.569 Vali Acc: 0.240 Test Loss: 1.569 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.1972501277923584
Epoch: 3, Steps: 4 | Train Loss: 1.180 Vali Loss: 1.441 Vali Acc: 0.460 Test Loss: 1.441 Test Acc: 0.460
Validation loss decreased (-0.239984 --> -0.459986).  Saving model ...
Epoch: 4 cost time: 1.2151429653167725
Epoch: 4, Steps: 4 | Train Loss: 0.719 Vali Loss: 1.409 Vali Acc: 0.520 Test Loss: 1.409 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519986).  Saving model ...
Epoch: 5 cost time: 1.386188268661499
Epoch: 5, Steps: 4 | Train Loss: 0.441 Vali Loss: 1.317 Vali Acc: 0.560 Test Loss: 1.317 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559987).  Saving model ...
Epoch: 6 cost time: 1.4379017353057861
Epoch: 6, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6878480911254883
Epoch: 7, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.355 Vali Acc: 0.480 Test Loss: 1.355 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1958668231964111
Epoch: 8, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.550 Vali Acc: 0.460 Test Loss: 1.550 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6528961658477783
Epoch: 9, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4106554985046387
Epoch: 10, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.519 Vali Acc: 0.580 Test Loss: 1.519 Test Acc: 0.580
Validation loss decreased (-0.559987 --> -0.579985).  Saving model ...
Epoch: 11 cost time: 1.383544921875
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.621 Vali Acc: 0.580 Test Loss: 1.621 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5697839260101318
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.722 Vali Acc: 0.560 Test Loss: 1.722 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4139137268066406
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.175 Vali Acc: 0.560 Test Loss: 2.175 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3405876159667969
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.246 Vali Acc: 0.560 Test Loss: 2.246 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.360949993133545
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.997 Vali Acc: 0.600 Test Loss: 1.997 Test Acc: 0.600
Validation loss decreased (-0.579985 --> -0.599980).  Saving model ...
Epoch: 16 cost time: 1.558366060256958
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.600 Test Loss: 1.676 Test Acc: 0.600
Validation loss decreased (-0.599980 --> -0.599983).  Saving model ...
Epoch: 17 cost time: 1.3275573253631592
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.600 Test Loss: 1.537 Test Acc: 0.600
Validation loss decreased (-0.599983 --> -0.599985).  Saving model ...
Epoch: 18 cost time: 1.1060166358947754
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.600 Test Loss: 1.578 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.299363374710083
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.580 Test Loss: 1.686 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2455754280090332
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.580 Test Loss: 1.793 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8710448741912842
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.560 Test Loss: 1.889 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4795968532562256
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.560 Test Loss: 1.973 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5422084331512451
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.560 Test Loss: 2.038 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6576454639434814
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.560 Test Loss: 2.098 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4710493087768555
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.560 Test Loss: 2.141 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7893178462982178
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.168 Vali Acc: 0.560 Test Loss: 2.168 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9307661056518555
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.186 Vali Acc: 0.560 Test Loss: 2.186 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 101593349
model size : 402.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8833084106445312
Epoch: 1, Steps: 4 | Train Loss: 1.766 Vali Loss: 1.658 Vali Acc: 0.140 Test Loss: 1.658 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.4179694652557373
Epoch: 2, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.681 Vali Acc: 0.240 Test Loss: 1.681 Test Acc: 0.240
Validation loss decreased (-0.139983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.0942316055297852
Epoch: 3, Steps: 4 | Train Loss: 1.212 Vali Loss: 1.698 Vali Acc: 0.260 Test Loss: 1.698 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.171571969985962
Epoch: 4, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.547 Vali Acc: 0.400 Test Loss: 1.547 Test Acc: 0.400
Validation loss decreased (-0.259983 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.0432803630828857
Epoch: 5, Steps: 4 | Train Loss: 0.594 Vali Loss: 1.375 Vali Acc: 0.380 Test Loss: 1.375 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9827048778533936
Epoch: 6, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 1.449113130569458
Epoch: 7, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.488 Vali Acc: 0.380 Test Loss: 1.488 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6006996631622314
Epoch: 8, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.671 Vali Acc: 0.380 Test Loss: 1.671 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7002055644989014
Epoch: 9, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.769 Vali Acc: 0.380 Test Loss: 1.769 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5373108386993408
Epoch: 10, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.300 Vali Acc: 0.460 Test Loss: 1.300 Test Acc: 0.460
Validation loss decreased (-0.399988 --> -0.459987).  Saving model ...
Epoch: 11 cost time: 1.4622564315795898
Epoch: 11, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.849 Vali Acc: 0.360 Test Loss: 1.849 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0081310272216797
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.969 Vali Acc: 0.420 Test Loss: 1.969 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5982441902160645
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.775 Vali Acc: 0.460 Test Loss: 1.775 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4052789211273193
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.577 Vali Acc: 0.480 Test Loss: 1.577 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479984).  Saving model ...
Epoch: 15 cost time: 1.271275520324707
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.480 Test Loss: 1.683 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.424612283706665
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.838 Vali Acc: 0.500 Test Loss: 1.838 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499982).  Saving model ...
Epoch: 17 cost time: 1.3998634815216064
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.954 Vali Acc: 0.480 Test Loss: 1.954 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.484018087387085
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.110 Vali Acc: 0.460 Test Loss: 2.110 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0369846820831299
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.163 Vali Acc: 0.440 Test Loss: 2.163 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3413562774658203
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.420 Test Loss: 2.166 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1953744888305664
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.420 Test Loss: 2.146 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4209914207458496
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.119 Vali Acc: 0.420 Test Loss: 2.119 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4136648178100586
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.460 Test Loss: 2.092 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1764247417449951
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.057 Vali Acc: 0.460 Test Loss: 2.057 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1790943145751953
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.460 Test Loss: 2.025 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5060713291168213
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.992 Vali Acc: 0.460 Test Loss: 1.992 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 101491205
model size : 401.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8630549907684326
Epoch: 1, Steps: 4 | Train Loss: 1.723 Vali Loss: 1.620 Vali Acc: 0.160 Test Loss: 1.620 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.5373177528381348
Epoch: 2, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.594 Vali Acc: 0.220 Test Loss: 1.594 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.6857523918151855
Epoch: 3, Steps: 4 | Train Loss: 1.203 Vali Loss: 1.569 Vali Acc: 0.300 Test Loss: 1.569 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.4389533996582031
Epoch: 4, Steps: 4 | Train Loss: 0.829 Vali Loss: 1.558 Vali Acc: 0.300 Test Loss: 1.558 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.5350165367126465
Epoch: 5, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.299984 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.2937533855438232
Epoch: 6, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.390 Vali Acc: 0.480 Test Loss: 1.390 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479986).  Saving model ...
Epoch: 7 cost time: 1.2749786376953125
Epoch: 7, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.550 Vali Acc: 0.500 Test Loss: 1.550 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499984).  Saving model ...
Epoch: 8 cost time: 1.2621791362762451
Epoch: 8, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.444 Vali Acc: 0.440 Test Loss: 1.444 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2303330898284912
Epoch: 9, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.576 Vali Acc: 0.400 Test Loss: 1.576 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1901640892028809
Epoch: 10, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.342 Vali Acc: 0.480 Test Loss: 1.342 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.201906681060791
Epoch: 11, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.591 Vali Acc: 0.440 Test Loss: 1.591 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1282589435577393
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.559 Vali Acc: 0.440 Test Loss: 1.559 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2411632537841797
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.518 Vali Acc: 0.440 Test Loss: 1.518 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.362605094909668
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.617 Vali Acc: 0.480 Test Loss: 1.617 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2128517627716064
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.729 Vali Acc: 0.440 Test Loss: 1.729 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7114996910095215
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.817 Vali Acc: 0.420 Test Loss: 1.817 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2850620746612549
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.893 Vali Acc: 0.420 Test Loss: 1.893 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 101432069
model size : 401.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.732172727584839
Epoch: 1, Steps: 4 | Train Loss: 1.811 Vali Loss: 1.630 Vali Acc: 0.280 Test Loss: 1.630 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1837806701660156
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.606 Vali Acc: 0.300 Test Loss: 1.606 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.3658463954925537
Epoch: 3, Steps: 4 | Train Loss: 1.248 Vali Loss: 1.501 Vali Acc: 0.340 Test Loss: 1.501 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.7040305137634277
Epoch: 4, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 1.718179702758789
Epoch: 5, Steps: 4 | Train Loss: 1.069 Vali Loss: 1.701 Vali Acc: 0.400 Test Loss: 1.701 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5563859939575195
Epoch: 6, Steps: 4 | Train Loss: 0.621 Vali Loss: 1.442 Vali Acc: 0.420 Test Loss: 1.442 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 1.3807024955749512
Epoch: 7, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.484 Vali Acc: 0.460 Test Loss: 1.484 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459985).  Saving model ...
Epoch: 8 cost time: 1.2884247303009033
Epoch: 8, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.987 Vali Acc: 0.400 Test Loss: 1.987 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4605555534362793
Epoch: 9, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.854 Vali Acc: 0.400 Test Loss: 1.854 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2298414707183838
Epoch: 10, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.946 Vali Acc: 0.340 Test Loss: 1.946 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4352374076843262
Epoch: 11, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.730 Vali Acc: 0.420 Test Loss: 1.730 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2909839153289795
Epoch: 12, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.510 Vali Acc: 0.440 Test Loss: 1.510 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2686231136322021
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.615 Vali Acc: 0.520 Test Loss: 1.615 Test Acc: 0.520
Validation loss decreased (-0.459985 --> -0.519984).  Saving model ...
Epoch: 14 cost time: 1.9647233486175537
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.500 Test Loss: 1.683 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3178892135620117
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.761 Vali Acc: 0.540 Test Loss: 1.761 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539982).  Saving model ...
Epoch: 16 cost time: 1.1989789009094238
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.520 Test Loss: 1.799 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2487869262695312
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.879 Vali Acc: 0.540 Test Loss: 1.879 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.203446865081787
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.927 Vali Acc: 0.480 Test Loss: 1.927 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.300649642944336
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.500 Test Loss: 1.956 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.370659351348877
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.500 Test Loss: 1.978 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2392847537994385
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.984 Vali Acc: 0.520 Test Loss: 1.984 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.345839023590088
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.520 Test Loss: 1.970 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7228150367736816
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.560 Test Loss: 1.967 Test Acc: 0.560
Validation loss decreased (-0.539982 --> -0.559980).  Saving model ...
Epoch: 24 cost time: 1.225287914276123
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.580 Test Loss: 1.978 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579980).  Saving model ...
Epoch: 25 cost time: 1.571502685546875
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.580 Test Loss: 2.005 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5197694301605225
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.036 Vali Acc: 0.580 Test Loss: 2.036 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.617384910583496
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.560 Test Loss: 2.083 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6261322498321533
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.114 Vali Acc: 0.540 Test Loss: 2.114 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6149606704711914
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.540 Test Loss: 2.129 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.726289987564087
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.128 Vali Acc: 0.540 Test Loss: 2.128 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7100296020507812
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.121 Vali Acc: 0.540 Test Loss: 2.121 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7949576377868652
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.108 Vali Acc: 0.540 Test Loss: 2.108 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.724534511566162
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.088 Vali Acc: 0.540 Test Loss: 2.088 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4999029636383057
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.540 Test Loss: 2.075 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 107791109
model size : 425.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.865065574645996
Epoch: 1, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.623 Vali Acc: 0.260 Test Loss: 1.623 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3636786937713623
Epoch: 2, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.752 Vali Acc: 0.260 Test Loss: 1.752 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1222608089447021
Epoch: 3, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.693 Vali Acc: 0.280 Test Loss: 1.693 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.2922277450561523
Epoch: 4, Steps: 4 | Train Loss: 0.666 Vali Loss: 1.441 Vali Acc: 0.380 Test Loss: 1.441 Test Acc: 0.380
Validation loss decreased (-0.279983 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 1.430168628692627
Epoch: 5, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.424 Vali Acc: 0.380 Test Loss: 1.424 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 6 cost time: 1.538438320159912
Epoch: 6, Steps: 4 | Train Loss: 0.533 Vali Loss: 1.507 Vali Acc: 0.340 Test Loss: 1.507 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6289193630218506
Epoch: 7, Steps: 4 | Train Loss: 0.516 Vali Loss: 1.455 Vali Acc: 0.420 Test Loss: 1.455 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419985).  Saving model ...
Epoch: 8 cost time: 1.702507734298706
Epoch: 8, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.564 Vali Acc: 0.440 Test Loss: 1.564 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439984).  Saving model ...
Epoch: 9 cost time: 1.8617568016052246
Epoch: 9, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.563 Vali Acc: 0.480 Test Loss: 1.563 Test Acc: 0.480
Validation loss decreased (-0.439984 --> -0.479984).  Saving model ...
Epoch: 10 cost time: 1.1473419666290283
Epoch: 10, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499984).  Saving model ...
Epoch: 11 cost time: 1.6516175270080566
Epoch: 11, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.413 Vali Acc: 0.440 Test Loss: 1.413 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3882603645324707
Epoch: 12, Steps: 4 | Train Loss: 0.039 Vali Loss: 2.179 Vali Acc: 0.420 Test Loss: 2.179 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3950984477996826
Epoch: 13, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.815 Vali Acc: 0.460 Test Loss: 1.815 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8857908248901367
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.639 Vali Acc: 0.480 Test Loss: 1.639 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3484838008880615
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.458745002746582
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.847 Vali Acc: 0.500 Test Loss: 1.847 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.190915822982788
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.975 Vali Acc: 0.500 Test Loss: 1.975 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8007996082305908
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.923 Vali Acc: 0.520 Test Loss: 1.923 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519981).  Saving model ...
Epoch: 19 cost time: 1.1615400314331055
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.520 Test Loss: 1.822 Test Acc: 0.520
Validation loss decreased (-0.519981 --> -0.519982).  Saving model ...
Epoch: 20 cost time: 1.7595140933990479
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.851 Vali Acc: 0.540 Test Loss: 1.851 Test Acc: 0.540
Validation loss decreased (-0.519982 --> -0.539981).  Saving model ...
Epoch: 21 cost time: 1.7805719375610352
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.002 Vali Acc: 0.540 Test Loss: 2.002 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9079790115356445
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.172 Vali Acc: 0.500 Test Loss: 2.172 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.860309362411499
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.311 Vali Acc: 0.500 Test Loss: 2.311 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.580601692199707
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.377 Vali Acc: 0.500 Test Loss: 2.377 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6186444759368896
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.380 Vali Acc: 0.520 Test Loss: 2.380 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.529416799545288
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.520 Test Loss: 2.388 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8256163597106934
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.381 Vali Acc: 0.520 Test Loss: 2.381 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5947108268737793
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.500 Test Loss: 2.369 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4911713600158691
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.358 Vali Acc: 0.500 Test Loss: 2.358 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2933688163757324
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.344 Vali Acc: 0.520 Test Loss: 2.344 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 107678213
model size : 425.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.732318639755249
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.638 Vali Acc: 0.280 Test Loss: 1.638 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.8272640705108643
Epoch: 2, Steps: 4 | Train Loss: 1.519 Vali Loss: 1.533 Vali Acc: 0.360 Test Loss: 1.533 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.1966381072998047
Epoch: 3, Steps: 4 | Train Loss: 1.069 Vali Loss: 1.473 Vali Acc: 0.440 Test Loss: 1.473 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 1.3361451625823975
Epoch: 4, Steps: 4 | Train Loss: 0.930 Vali Loss: 1.351 Vali Acc: 0.420 Test Loss: 1.351 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2677009105682373
Epoch: 5, Steps: 4 | Train Loss: 0.524 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5527946949005127
Epoch: 6, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.306 Vali Acc: 0.480 Test Loss: 1.306 Test Acc: 0.480
Validation loss decreased (-0.439985 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 1.3758773803710938
Epoch: 7, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.431 Vali Acc: 0.420 Test Loss: 1.431 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.50693941116333
Epoch: 8, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.241 Vali Acc: 0.440 Test Loss: 1.241 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6019644737243652
Epoch: 9, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.494 Vali Acc: 0.420 Test Loss: 1.494 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2290964126586914
Epoch: 10, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.515 Vali Acc: 0.460 Test Loss: 1.515 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.241391658782959
Epoch: 11, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.503 Vali Acc: 0.440 Test Loss: 1.503 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3602356910705566
Epoch: 12, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.496 Vali Acc: 0.440 Test Loss: 1.496 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.005540370941162
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.351 Vali Acc: 0.480 Test Loss: 1.351 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9386353492736816
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.685 Vali Acc: 0.440 Test Loss: 1.685 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8471457958221436
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.005 Vali Acc: 0.480 Test Loss: 2.005 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6899073123931885
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.965 Vali Acc: 0.460 Test Loss: 1.965 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 107624453
model size : 425.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.43501877784729
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.667 Vali Acc: 0.200 Test Loss: 1.667 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.4060306549072266
Epoch: 2, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.593 Vali Acc: 0.260 Test Loss: 1.593 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.7361211776733398
Epoch: 3, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.468 Vali Acc: 0.320 Test Loss: 1.468 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.1558012962341309
Epoch: 4, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.399 Vali Acc: 0.380 Test Loss: 1.399 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 2.296295642852783
Epoch: 5, Steps: 4 | Train Loss: 0.431 Vali Loss: 1.320 Vali Acc: 0.460 Test Loss: 1.320 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459987).  Saving model ...
Epoch: 6 cost time: 1.9876656532287598
Epoch: 6, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.197 Vali Acc: 0.520 Test Loss: 1.197 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 2.2085647583007812
Epoch: 7, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1384639739990234
Epoch: 8, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.823 Vali Acc: 0.480 Test Loss: 1.823 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5294761657714844
Epoch: 9, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.490 Vali Acc: 0.440 Test Loss: 1.490 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9330487251281738
Epoch: 10, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.880 Vali Acc: 0.380 Test Loss: 1.880 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8624331951141357
Epoch: 11, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.318 Vali Acc: 0.440 Test Loss: 1.318 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5906987190246582
Epoch: 12, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.917 Vali Acc: 0.460 Test Loss: 1.917 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7217187881469727
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.795 Vali Acc: 0.500 Test Loss: 1.795 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.252265691757202
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.646 Vali Acc: 0.580 Test Loss: 1.646 Test Acc: 0.580
Validation loss decreased (-0.519988 --> -0.579984).  Saving model ...
Epoch: 15 cost time: 1.622950792312622
Epoch: 15, Steps: 4 | Train Loss: 0.030 Vali Loss: 2.242 Vali Acc: 0.540 Test Loss: 2.242 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.468907117843628
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.616 Vali Acc: 0.560 Test Loss: 1.616 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8426642417907715
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.593 Vali Acc: 0.500 Test Loss: 1.593 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7783193588256836
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.028 Vali Acc: 0.600 Test Loss: 2.028 Test Acc: 0.600
Validation loss decreased (-0.579984 --> -0.599980).  Saving model ...
Epoch: 19 cost time: 1.9748046398162842
Epoch: 19, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.004 Vali Acc: 0.460 Test Loss: 2.004 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2181975841522217
Epoch: 20, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.112 Vali Acc: 0.580 Test Loss: 2.112 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.070317506790161
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.468 Vali Acc: 0.520 Test Loss: 2.468 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.02858829498291
Epoch: 22, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.275 Vali Acc: 0.520 Test Loss: 2.275 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1357715129852295
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.059 Vali Acc: 0.500 Test Loss: 2.059 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3828983306884766
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.480 Test Loss: 1.864 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.712040662765503
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.460 Test Loss: 1.780 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6362130641937256
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.500 Test Loss: 1.778 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7295722961425781
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.540 Test Loss: 1.827 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7277791500091553
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.540 Test Loss: 1.880 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 113956613
model size : 449.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.474501848220825
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9470055103302002
Epoch: 2, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.571 Vali Acc: 0.340 Test Loss: 1.571 Test Acc: 0.340
Validation loss decreased (-0.219984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.6583988666534424
Epoch: 3, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.637 Vali Acc: 0.340 Test Loss: 1.637 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5583832263946533
Epoch: 4, Steps: 4 | Train Loss: 0.863 Vali Loss: 1.613 Vali Acc: 0.360 Test Loss: 1.613 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 5 cost time: 2.001124143600464
Epoch: 5, Steps: 4 | Train Loss: 0.512 Vali Loss: 1.452 Vali Acc: 0.420 Test Loss: 1.452 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.5367143154144287
Epoch: 6, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.458 Vali Acc: 0.420 Test Loss: 1.458 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7452771663665771
Epoch: 7, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.735 Vali Acc: 0.360 Test Loss: 1.735 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8919246196746826
Epoch: 8, Steps: 4 | Train Loss: 0.098 Vali Loss: 2.068 Vali Acc: 0.400 Test Loss: 2.068 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0468451976776123
Epoch: 9, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.485 Vali Acc: 0.380 Test Loss: 1.485 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.871018409729004
Epoch: 10, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.825 Vali Acc: 0.400 Test Loss: 1.825 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5877604484558105
Epoch: 11, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.960 Vali Acc: 0.380 Test Loss: 1.960 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5574138164520264
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.864 Vali Acc: 0.400 Test Loss: 1.864 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9242398738861084
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.671 Vali Acc: 0.420 Test Loss: 1.671 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.396477460861206
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.671 Vali Acc: 0.420 Test Loss: 1.671 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5924608707427979
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.804 Vali Acc: 0.420 Test Loss: 1.804 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 113865221
model size : 449.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.194706916809082
Epoch: 1, Steps: 4 | Train Loss: 1.739 Vali Loss: 1.706 Vali Acc: 0.180 Test Loss: 1.706 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.5562808513641357
Epoch: 2, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.563 Vali Acc: 0.400 Test Loss: 1.563 Test Acc: 0.400
Validation loss decreased (-0.179983 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 2.026061773300171
Epoch: 3, Steps: 4 | Train Loss: 1.001 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 2.026777505874634
Epoch: 4, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.365 Vali Acc: 0.420 Test Loss: 1.365 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 2.2713470458984375
Epoch: 5, Steps: 4 | Train Loss: 0.489 Vali Loss: 1.266 Vali Acc: 0.480 Test Loss: 1.266 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 2.066342830657959
Epoch: 6, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.417 Vali Acc: 0.460 Test Loss: 1.417 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9391899108886719
Epoch: 7, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.6366097927093506
Epoch: 8, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.422 Vali Acc: 0.480 Test Loss: 1.422 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4706602096557617
Epoch: 9, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.392 Vali Acc: 0.520 Test Loss: 1.392 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519986).  Saving model ...
Epoch: 10 cost time: 1.7307565212249756
Epoch: 10, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.504 Vali Acc: 0.460 Test Loss: 1.504 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8501548767089844
Epoch: 11, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.490 Vali Acc: 0.500 Test Loss: 1.490 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.718313217163086
Epoch: 12, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.714 Vali Acc: 0.440 Test Loss: 1.714 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7263948917388916
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.661 Vali Acc: 0.460 Test Loss: 1.661 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8250043392181396
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0938796997070312
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.762 Vali Acc: 0.480 Test Loss: 1.762 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.673168420791626
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.072 Vali Acc: 0.460 Test Loss: 2.072 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5430538654327393
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.112 Vali Acc: 0.500 Test Loss: 2.112 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.218332052230835
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.025 Vali Acc: 0.480 Test Loss: 2.025 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9556066989898682
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.480 Test Loss: 1.917 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 113816837
model size : 448.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.31634259223938
Epoch: 1, Steps: 4 | Train Loss: 1.908 Vali Loss: 1.509 Vali Acc: 0.300 Test Loss: 1.509 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.7771034240722656
Epoch: 2, Steps: 4 | Train Loss: 1.509 Vali Loss: 1.488 Vali Acc: 0.480 Test Loss: 1.488 Test Acc: 0.480
Validation loss decreased (-0.299985 --> -0.479985).  Saving model ...
Epoch: 3 cost time: 2.228472948074341
Epoch: 3, Steps: 4 | Train Loss: 1.158 Vali Loss: 1.307 Vali Acc: 0.440 Test Loss: 1.307 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.090243339538574
Epoch: 4, Steps: 4 | Train Loss: 0.574 Vali Loss: 1.332 Vali Acc: 0.440 Test Loss: 1.332 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8889334201812744
Epoch: 5, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.447 Vali Acc: 0.420 Test Loss: 1.447 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.991715431213379
Epoch: 6, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.682 Vali Acc: 0.440 Test Loss: 1.682 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.063197374343872
Epoch: 7, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.780 Vali Acc: 0.500 Test Loss: 1.780 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499982).  Saving model ...
Epoch: 8 cost time: 1.7221429347991943
Epoch: 8, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.472 Vali Acc: 0.500 Test Loss: 1.472 Test Acc: 0.500
Validation loss decreased (-0.499982 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.5307350158691406
Epoch: 9, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.252 Vali Acc: 0.460 Test Loss: 1.252 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6744506359100342
Epoch: 10, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.462 Vali Acc: 0.500 Test Loss: 1.462 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 1.8097834587097168
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.875 Vali Acc: 0.420 Test Loss: 1.875 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3467345237731934
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.603 Vali Acc: 0.440 Test Loss: 1.603 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1753928661346436
Epoch: 13, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.852 Vali Acc: 0.500 Test Loss: 1.852 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7662413120269775
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.106 Vali Acc: 0.480 Test Loss: 2.106 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9075076580047607
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.962 Vali Acc: 0.420 Test Loss: 1.962 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2810628414154053
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.922 Vali Acc: 0.460 Test Loss: 1.922 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.238842010498047
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.073 Vali Acc: 0.440 Test Loss: 2.073 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.209541082382202
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.078 Vali Acc: 0.460 Test Loss: 2.078 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2060623168945312
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.015 Vali Acc: 0.500 Test Loss: 2.015 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.286717176437378
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.520 Test Loss: 1.990 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519980).  Saving model ...
Epoch: 21 cost time: 1.6412835121154785
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.520 Test Loss: 2.015 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9851727485656738
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.500 Test Loss: 2.050 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.092496871948242
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.080 Vali Acc: 0.500 Test Loss: 2.080 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.919642448425293
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.103 Vali Acc: 0.500 Test Loss: 2.103 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.03324294090271
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.119 Vali Acc: 0.500 Test Loss: 2.119 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8492023944854736
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.500 Test Loss: 2.146 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0650694370269775
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.169 Vali Acc: 0.500 Test Loss: 2.169 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.016711950302124
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.188 Vali Acc: 0.480 Test Loss: 2.188 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.884913682937622
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.205 Vali Acc: 0.480 Test Loss: 2.205 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.852156639099121
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.218 Vali Acc: 0.480 Test Loss: 2.218 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 120148997
model size : 473.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4734654426574707
Epoch: 1, Steps: 4 | Train Loss: 1.774 Vali Loss: 1.632 Vali Acc: 0.240 Test Loss: 1.632 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.990211009979248
Epoch: 2, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.745 Vali Acc: 0.260 Test Loss: 1.745 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 2.09383225440979
Epoch: 3, Steps: 4 | Train Loss: 1.428 Vali Loss: 1.673 Vali Acc: 0.280 Test Loss: 1.673 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.7358105182647705
Epoch: 4, Steps: 4 | Train Loss: 1.084 Vali Loss: 1.567 Vali Acc: 0.320 Test Loss: 1.567 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.9922840595245361
Epoch: 5, Steps: 4 | Train Loss: 0.844 Vali Loss: 1.490 Vali Acc: 0.380 Test Loss: 1.490 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 1.9195234775543213
Epoch: 6, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.494 Vali Acc: 0.440 Test Loss: 1.494 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 1.9842278957366943
Epoch: 7, Steps: 4 | Train Loss: 0.653 Vali Loss: 1.631 Vali Acc: 0.420 Test Loss: 1.631 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9719817638397217
Epoch: 8, Steps: 4 | Train Loss: 0.301 Vali Loss: 1.549 Vali Acc: 0.500 Test Loss: 1.549 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.4068613052368164
Epoch: 9, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.801 Vali Acc: 0.500 Test Loss: 1.801 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.521275281906128
Epoch: 10, Steps: 4 | Train Loss: 0.221 Vali Loss: 2.118 Vali Acc: 0.500 Test Loss: 2.118 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6228187084197998
Epoch: 11, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.538 Vali Acc: 0.500 Test Loss: 1.538 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 12 cost time: 2.130037784576416
Epoch: 12, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.682 Vali Acc: 0.440 Test Loss: 1.682 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5034856796264648
Epoch: 13, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.592 Vali Acc: 0.540 Test Loss: 1.592 Test Acc: 0.540
Validation loss decreased (-0.499985 --> -0.539984).  Saving model ...
Epoch: 14 cost time: 1.8218765258789062
Epoch: 14, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.755 Vali Acc: 0.520 Test Loss: 1.755 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.734246015548706
Epoch: 15, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.747 Vali Acc: 0.540 Test Loss: 1.747 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0714170932769775
Epoch: 16, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.617 Vali Acc: 0.540 Test Loss: 1.617 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.985177755355835
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.628 Vali Acc: 0.520 Test Loss: 1.628 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7631785869598389
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.715 Vali Acc: 0.540 Test Loss: 1.715 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.026339292526245
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.594 Vali Acc: 0.580 Test Loss: 1.594 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579984).  Saving model ...
Epoch: 20 cost time: 1.7959027290344238
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.500 Test Loss: 1.688 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9662446975708008
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.820 Vali Acc: 0.460 Test Loss: 1.820 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6957504749298096
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.907 Vali Acc: 0.460 Test Loss: 1.907 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.775475025177002
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.949 Vali Acc: 0.460 Test Loss: 1.949 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6139326095581055
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.991 Vali Acc: 0.500 Test Loss: 1.991 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3906035423278809
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.054 Vali Acc: 0.500 Test Loss: 2.054 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.675302505493164
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.091 Vali Acc: 0.500 Test Loss: 2.091 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.599315881729126
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.095 Vali Acc: 0.520 Test Loss: 2.095 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4733068943023682
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.076 Vali Acc: 0.520 Test Loss: 2.076 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6319019794464111
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.520 Test Loss: 2.049 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 120057605
model size : 472.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.160465955734253
Epoch: 1, Steps: 4 | Train Loss: 1.705 Vali Loss: 1.655 Vali Acc: 0.220 Test Loss: 1.655 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.6022727489471436
Epoch: 2, Steps: 4 | Train Loss: 1.528 Vali Loss: 1.596 Vali Acc: 0.320 Test Loss: 1.596 Test Acc: 0.320
Validation loss decreased (-0.219983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.730243444442749
Epoch: 3, Steps: 4 | Train Loss: 1.002 Vali Loss: 1.456 Vali Acc: 0.380 Test Loss: 1.456 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 1.4939322471618652
Epoch: 4, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.480 Vali Acc: 0.460 Test Loss: 1.480 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 1.9409215450286865
Epoch: 5, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.367 Vali Acc: 0.340 Test Loss: 1.367 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8350708484649658
Epoch: 6, Steps: 4 | Train Loss: 0.346 Vali Loss: 1.509 Vali Acc: 0.440 Test Loss: 1.509 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6969211101531982
Epoch: 7, Steps: 4 | Train Loss: 0.301 Vali Loss: 1.458 Vali Acc: 0.400 Test Loss: 1.458 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6848194599151611
Epoch: 8, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.412 Vali Acc: 0.380 Test Loss: 1.412 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9737217426300049
Epoch: 9, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.486 Vali Acc: 0.440 Test Loss: 1.486 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8104393482208252
Epoch: 10, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.561 Vali Acc: 0.400 Test Loss: 1.561 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9572420120239258
Epoch: 11, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.432 Vali Acc: 0.500 Test Loss: 1.432 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499986).  Saving model ...
Epoch: 12 cost time: 2.0628814697265625
Epoch: 12, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.442 Vali Acc: 0.560 Test Loss: 1.442 Test Acc: 0.560
Validation loss decreased (-0.499986 --> -0.559986).  Saving model ...
Epoch: 13 cost time: 1.9615130424499512
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.621 Vali Acc: 0.540 Test Loss: 1.621 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7224557399749756
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.660 Vali Acc: 0.540 Test Loss: 1.660 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6231095790863037
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.721 Vali Acc: 0.540 Test Loss: 1.721 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4954071044921875
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.786 Vali Acc: 0.500 Test Loss: 1.786 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4565386772155762
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.792 Vali Acc: 0.500 Test Loss: 1.792 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5598022937774658
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.687 Vali Acc: 0.520 Test Loss: 1.687 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6713440418243408
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.631 Vali Acc: 0.520 Test Loss: 1.631 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6955442428588867
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.688725233078003
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.500 Test Loss: 1.709 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7794296741485596
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.500 Test Loss: 1.724 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 120014597
model size : 472.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5316433906555176
Epoch: 1, Steps: 4 | Train Loss: 1.712 Vali Loss: 1.591 Vali Acc: 0.200 Test Loss: 1.591 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.028726577758789
Epoch: 2, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.563 Vali Acc: 0.280 Test Loss: 1.563 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.1737782955169678
Epoch: 3, Steps: 4 | Train Loss: 1.167 Vali Loss: 1.489 Vali Acc: 0.360 Test Loss: 1.489 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.5572960376739502
Epoch: 4, Steps: 4 | Train Loss: 0.826 Vali Loss: 1.443 Vali Acc: 0.460 Test Loss: 1.443 Test Acc: 0.460
Validation loss decreased (-0.359985 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.5715773105621338
Epoch: 5, Steps: 4 | Train Loss: 0.628 Vali Loss: 1.484 Vali Acc: 0.420 Test Loss: 1.484 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7633039951324463
Epoch: 6, Steps: 4 | Train Loss: 0.762 Vali Loss: 1.555 Vali Acc: 0.520 Test Loss: 1.555 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519984).  Saving model ...
Epoch: 7 cost time: 1.9504923820495605
Epoch: 7, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7289743423461914
Epoch: 8, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.532 Vali Acc: 0.480 Test Loss: 1.532 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6198599338531494
Epoch: 9, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.876 Vali Acc: 0.520 Test Loss: 1.876 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4890305995941162
Epoch: 10, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.621 Vali Acc: 0.500 Test Loss: 1.621 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5522985458374023
Epoch: 11, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.427 Vali Acc: 0.520 Test Loss: 1.427 Test Acc: 0.520
Validation loss decreased (-0.519984 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 1.6631488800048828
Epoch: 12, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.952 Vali Acc: 0.520 Test Loss: 1.952 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4502449035644531
Epoch: 13, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.572 Vali Acc: 0.500 Test Loss: 1.572 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.810201644897461
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.883 Vali Acc: 0.500 Test Loss: 1.883 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0956239700317383
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.436 Vali Acc: 0.520 Test Loss: 1.436 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7018358707427979
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.775 Vali Acc: 0.500 Test Loss: 1.775 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.774735689163208
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.258 Vali Acc: 0.480 Test Loss: 2.258 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7847342491149902
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.588 Vali Acc: 0.480 Test Loss: 2.588 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.923922061920166
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.506 Vali Acc: 0.480 Test Loss: 2.506 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0275449752807617
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.349 Vali Acc: 0.500 Test Loss: 2.349 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1596524715423584
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.219 Vali Acc: 0.500 Test Loss: 2.219 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 129424133
model size : 508.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2147164344787598
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.631 Vali Acc: 0.220 Test Loss: 1.631 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.7578673362731934
Epoch: 2, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.518 Vali Acc: 0.240 Test Loss: 1.518 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.7575154304504395
Epoch: 3, Steps: 4 | Train Loss: 0.960 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
Validation loss decreased (-0.239985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.1259839534759521
Epoch: 4, Steps: 4 | Train Loss: 0.662 Vali Loss: 1.358 Vali Acc: 0.460 Test Loss: 1.358 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.6251137256622314
Epoch: 5, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.442 Vali Acc: 0.460 Test Loss: 1.442 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.182199478149414
Epoch: 6, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.912916660308838
Epoch: 7, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.355 Vali Acc: 0.420 Test Loss: 1.355 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0557360649108887
Epoch: 8, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.618 Vali Acc: 0.460 Test Loss: 1.618 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0682003498077393
Epoch: 9, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.466 Vali Acc: 0.500 Test Loss: 1.466 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6132607460021973
Epoch: 10, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.860 Vali Acc: 0.440 Test Loss: 1.860 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0657520294189453
Epoch: 11, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.745 Vali Acc: 0.480 Test Loss: 1.745 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2042675018310547
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.729 Vali Acc: 0.420 Test Loss: 1.729 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.205474853515625
Epoch: 13, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.720 Vali Acc: 0.540 Test Loss: 1.720 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539983).  Saving model ...
Epoch: 14 cost time: 1.8893399238586426
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.756 Vali Acc: 0.480 Test Loss: 1.756 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0857417583465576
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 2.106 Vali Acc: 0.480 Test Loss: 2.106 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9330556392669678
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.337 Vali Acc: 0.420 Test Loss: 2.337 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9325144290924072
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.220 Vali Acc: 0.440 Test Loss: 2.220 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8523600101470947
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.013 Vali Acc: 0.480 Test Loss: 2.013 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2608296871185303
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.871 Vali Acc: 0.480 Test Loss: 1.871 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7915728092193604
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.540 Test Loss: 1.805 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7768735885620117
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.798 Vali Acc: 0.560 Test Loss: 1.798 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559982).  Saving model ...
Epoch: 22 cost time: 1.71468186378479
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.560 Test Loss: 1.816 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1370275020599365
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.540 Test Loss: 1.843 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.241757392883301
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.883 Vali Acc: 0.540 Test Loss: 1.883 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5097413063049316
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.917 Vali Acc: 0.540 Test Loss: 1.917 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6214768886566162
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.520 Test Loss: 1.940 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9532122611999512
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.520 Test Loss: 1.963 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9923198223114014
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.520 Test Loss: 1.983 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6987884044647217
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.500 Test Loss: 1.997 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.1959924697875977
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.500 Test Loss: 2.006 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.3069820404052734
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.500 Test Loss: 2.013 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 129348869
model size : 508.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.056329250335693
Epoch: 1, Steps: 4 | Train Loss: 1.788 Vali Loss: 1.676 Vali Acc: 0.180 Test Loss: 1.676 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.8871996402740479
Epoch: 2, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.688 Vali Acc: 0.400 Test Loss: 1.688 Test Acc: 0.400
Validation loss decreased (-0.179983 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 2.1353113651275635
Epoch: 3, Steps: 4 | Train Loss: 1.166 Vali Loss: 1.309 Vali Acc: 0.440 Test Loss: 1.309 Test Acc: 0.440
Validation loss decreased (-0.399983 --> -0.439987).  Saving model ...
Epoch: 4 cost time: 2.164433240890503
Epoch: 4, Steps: 4 | Train Loss: 0.784 Vali Loss: 1.372 Vali Acc: 0.420 Test Loss: 1.372 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2638018131256104
Epoch: 5, Steps: 4 | Train Loss: 0.564 Vali Loss: 1.397 Vali Acc: 0.380 Test Loss: 1.397 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3059043884277344
Epoch: 6, Steps: 4 | Train Loss: 0.424 Vali Loss: 1.111 Vali Acc: 0.520 Test Loss: 1.111 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519989).  Saving model ...
Epoch: 7 cost time: 1.6760215759277344
Epoch: 7, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 1.234395980834961
Epoch: 8, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.368 Vali Acc: 0.520 Test Loss: 1.368 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6178812980651855
Epoch: 9, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.339 Vali Acc: 0.580 Test Loss: 1.339 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579987).  Saving model ...
Epoch: 10 cost time: 1.7416081428527832
Epoch: 10, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.424 Vali Acc: 0.520 Test Loss: 1.424 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7443616390228271
Epoch: 11, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.394 Vali Acc: 0.580 Test Loss: 1.394 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7685565948486328
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.376 Vali Acc: 0.560 Test Loss: 1.376 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8502695560455322
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.464 Vali Acc: 0.540 Test Loss: 1.464 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8573100566864014
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.408 Vali Acc: 0.560 Test Loss: 1.408 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.860619068145752
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.600 Vali Acc: 0.560 Test Loss: 1.600 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6831603050231934
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.836 Vali Acc: 0.580 Test Loss: 1.836 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0043320655822754
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.955 Vali Acc: 0.540 Test Loss: 1.955 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1098532676696777
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.954 Vali Acc: 0.540 Test Loss: 1.954 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0522501468658447
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.929 Vali Acc: 0.520 Test Loss: 1.929 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 129305861
model size : 507.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.661970376968384
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.657 Vali Acc: 0.200 Test Loss: 1.657 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.0353047847747803
Epoch: 2, Steps: 4 | Train Loss: 1.449 Vali Loss: 1.544 Vali Acc: 0.320 Test Loss: 1.544 Test Acc: 0.320
Validation loss decreased (-0.199983 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.9267983436584473
Epoch: 3, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.406 Vali Acc: 0.360 Test Loss: 1.406 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 1.8942124843597412
Epoch: 4, Steps: 4 | Train Loss: 0.628 Vali Loss: 1.350 Vali Acc: 0.440 Test Loss: 1.350 Test Acc: 0.440
Validation loss decreased (-0.359986 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.5070819854736328
Epoch: 5, Steps: 4 | Train Loss: 0.455 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1298065185546875
Epoch: 6, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.595 Vali Acc: 0.380 Test Loss: 1.595 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3140614032745361
Epoch: 7, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.363 Vali Acc: 0.460 Test Loss: 1.363 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 8 cost time: 2.028326988220215
Epoch: 8, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.658 Vali Acc: 0.480 Test Loss: 1.658 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479983).  Saving model ...
Epoch: 9 cost time: 1.579125165939331
Epoch: 9, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.299 Vali Acc: 0.420 Test Loss: 1.299 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9356238842010498
Epoch: 10, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6891279220581055
Epoch: 11, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.481 Vali Acc: 0.460 Test Loss: 1.481 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5843124389648438
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.897 Vali Acc: 0.440 Test Loss: 1.897 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9779720306396484
Epoch: 13, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.468 Vali Acc: 0.480 Test Loss: 1.468 Test Acc: 0.480
Validation loss decreased (-0.479983 --> -0.479985).  Saving model ...
Epoch: 14 cost time: 1.920475959777832
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.472 Vali Acc: 0.460 Test Loss: 1.472 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8727731704711914
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.576 Vali Acc: 0.400 Test Loss: 1.576 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.044032573699951
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.737 Vali Acc: 0.460 Test Loss: 1.737 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1134510040283203
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.879 Vali Acc: 0.500 Test Loss: 1.879 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499981).  Saving model ...
Epoch: 18 cost time: 1.675274133682251
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.956 Vali Acc: 0.480 Test Loss: 1.956 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7316334247589111
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.983 Vali Acc: 0.500 Test Loss: 1.983 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6954641342163086
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.500 Test Loss: 1.966 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.65055251121521
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.460 Test Loss: 1.938 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6850099563598633
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.909 Vali Acc: 0.460 Test Loss: 1.909 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4992311000823975
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.480 Test Loss: 1.881 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.219156503677368
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.872 Vali Acc: 0.480 Test Loss: 1.872 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5868678092956543
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.864 Vali Acc: 0.500 Test Loss: 1.864 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499981).  Saving model ...
Epoch: 26 cost time: 1.9793965816497803
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.861 Vali Acc: 0.500 Test Loss: 1.861 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499981).  Saving model ...
Epoch: 27 cost time: 1.5754780769348145
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.861 Vali Acc: 0.500 Test Loss: 1.861 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499981).  Saving model ...
Epoch: 28 cost time: 2.4349639415740967
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.500 Test Loss: 1.870 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7789771556854248
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.500 Test Loss: 1.881 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.088330030441284
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.500 Test Loss: 1.895 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.1552796363830566
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.500 Test Loss: 1.910 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.065844774246216
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.500 Test Loss: 1.924 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.002220630645752
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.500 Test Loss: 1.934 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.028639316558838
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.946 Vali Acc: 0.500 Test Loss: 1.946 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.0242702960968018
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.500 Test Loss: 1.956 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9713459014892578
Epoch: 36, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.500 Test Loss: 1.962 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.9028551578521729
Epoch: 37, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.500 Test Loss: 1.970 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 141798149
model size : 555.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6019344329833984
Epoch: 1, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.728 Vali Acc: 0.140 Test Loss: 1.728 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.8454675674438477
Epoch: 2, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.563 Vali Acc: 0.280 Test Loss: 1.563 Test Acc: 0.280
Validation loss decreased (-0.139983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.9050965309143066
Epoch: 3, Steps: 4 | Train Loss: 1.071 Vali Loss: 1.487 Vali Acc: 0.320 Test Loss: 1.487 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.9740078449249268
Epoch: 4, Steps: 4 | Train Loss: 0.871 Vali Loss: 1.446 Vali Acc: 0.380 Test Loss: 1.446 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 1.7477948665618896
Epoch: 5, Steps: 4 | Train Loss: 0.550 Vali Loss: 1.442 Vali Acc: 0.420 Test Loss: 1.442 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 1.9195854663848877
Epoch: 6, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.520 Vali Acc: 0.440 Test Loss: 1.520 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 2.204353094100952
Epoch: 7, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.283 Vali Acc: 0.560 Test Loss: 1.283 Test Acc: 0.560
Validation loss decreased (-0.439985 --> -0.559987).  Saving model ...
Epoch: 8 cost time: 2.0410118103027344
Epoch: 8, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.529 Vali Acc: 0.480 Test Loss: 1.529 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1222243309020996
Epoch: 9, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.477 Vali Acc: 0.440 Test Loss: 1.477 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5028507709503174
Epoch: 10, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.573 Vali Acc: 0.480 Test Loss: 1.573 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8781487941741943
Epoch: 11, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.722 Vali Acc: 0.440 Test Loss: 1.722 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.960052728652954
Epoch: 12, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.680 Vali Acc: 0.460 Test Loss: 1.680 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9312796592712402
Epoch: 13, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.633 Vali Acc: 0.460 Test Loss: 1.633 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8128812313079834
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.974 Vali Acc: 0.420 Test Loss: 1.974 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.877880334854126
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.059 Vali Acc: 0.380 Test Loss: 2.059 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5955138206481934
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.975 Vali Acc: 0.420 Test Loss: 1.975 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7914671897888184
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.011 Vali Acc: 0.420 Test Loss: 2.011 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 141728261
model size : 555.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.567000389099121
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.823 Vali Acc: 0.240 Test Loss: 1.823 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 1.9243969917297363
Epoch: 2, Steps: 4 | Train Loss: 1.426 Vali Loss: 1.483 Vali Acc: 0.300 Test Loss: 1.483 Test Acc: 0.300
Validation loss decreased (-0.239982 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.9012293815612793
Epoch: 3, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.508 Vali Acc: 0.300 Test Loss: 1.508 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.116264581680298
Epoch: 4, Steps: 4 | Train Loss: 0.743 Vali Loss: 1.436 Vali Acc: 0.340 Test Loss: 1.436 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339986).  Saving model ...
Epoch: 5 cost time: 2.3201076984405518
Epoch: 5, Steps: 4 | Train Loss: 0.542 Vali Loss: 1.391 Vali Acc: 0.440 Test Loss: 1.391 Test Acc: 0.440
Validation loss decreased (-0.339986 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.9159669876098633
Epoch: 6, Steps: 4 | Train Loss: 0.480 Vali Loss: 1.315 Vali Acc: 0.440 Test Loss: 1.315 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 7 cost time: 1.850754737854004
Epoch: 7, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.423 Vali Acc: 0.420 Test Loss: 1.423 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6407959461212158
Epoch: 8, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.663 Vali Acc: 0.440 Test Loss: 1.663 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.804065465927124
Epoch: 9, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7352359294891357
Epoch: 10, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.677 Vali Acc: 0.440 Test Loss: 1.677 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.982386589050293
Epoch: 11, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.471 Vali Acc: 0.440 Test Loss: 1.471 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1838126182556152
Epoch: 12, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.883 Vali Acc: 0.400 Test Loss: 1.883 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.664381265640259
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.914 Vali Acc: 0.420 Test Loss: 1.914 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8345561027526855
Epoch: 14, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.885 Vali Acc: 0.420 Test Loss: 1.885 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.6850688457489014
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.104 Vali Acc: 0.400 Test Loss: 2.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.866107940673828
Epoch: 16, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.706 Vali Acc: 0.420 Test Loss: 1.706 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 141690629
model size : 555.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7287275791168213
Epoch: 1, Steps: 4 | Train Loss: 1.766 Vali Loss: 1.640 Vali Acc: 0.120 Test Loss: 1.640 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 2.047233819961548
Epoch: 2, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.326 Vali Acc: 0.360 Test Loss: 1.326 Test Acc: 0.360
Validation loss decreased (-0.119984 --> -0.359987).  Saving model ...
Epoch: 3 cost time: 2.275831460952759
Epoch: 3, Steps: 4 | Train Loss: 1.077 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
Validation loss decreased (-0.359987 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 2.1504101753234863
Epoch: 4, Steps: 4 | Train Loss: 0.574 Vali Loss: 1.521 Vali Acc: 0.400 Test Loss: 1.521 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.647490978240967
Epoch: 5, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.422 Vali Acc: 0.400 Test Loss: 1.422 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.371654510498047
Epoch: 6, Steps: 4 | Train Loss: 0.281 Vali Loss: 1.546 Vali Acc: 0.400 Test Loss: 1.546 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9039976596832275
Epoch: 7, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.847 Vali Acc: 0.400 Test Loss: 1.847 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0569117069244385
Epoch: 8, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.627 Vali Acc: 0.440 Test Loss: 1.627 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439984).  Saving model ...
Epoch: 9 cost time: 2.1214756965637207
Epoch: 9, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.379 Vali Acc: 0.460 Test Loss: 1.379 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459986).  Saving model ...
Epoch: 10 cost time: 1.761324167251587
Epoch: 10, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.827 Vali Acc: 0.420 Test Loss: 1.827 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9333202838897705
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.959 Vali Acc: 0.420 Test Loss: 1.959 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.151797294616699
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.568 Vali Acc: 0.400 Test Loss: 2.568 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.375453472137451
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.759 Vali Acc: 0.440 Test Loss: 1.759 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.149125814437866
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.869 Vali Acc: 0.460 Test Loss: 1.869 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.038907051086426
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.003 Vali Acc: 0.460 Test Loss: 2.003 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.01011323928833
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.604 Vali Acc: 0.520 Test Loss: 1.604 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519984).  Saving model ...
Epoch: 17 cost time: 1.9835987091064453
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.507 Vali Acc: 0.520 Test Loss: 1.507 Test Acc: 0.520
Validation loss decreased (-0.519984 --> -0.519985).  Saving model ...
Epoch: 18 cost time: 2.265636682510376
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.810 Vali Acc: 0.480 Test Loss: 1.810 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9731574058532715
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.378 Vali Acc: 0.440 Test Loss: 2.378 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8875114917755127
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.708 Vali Acc: 0.440 Test Loss: 2.708 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2031917572021484
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.826 Vali Acc: 0.420 Test Loss: 2.826 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1205921173095703
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.882 Vali Acc: 0.420 Test Loss: 2.882 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.108745574951172
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.860 Vali Acc: 0.440 Test Loss: 2.860 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.995729923248291
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.460 Test Loss: 2.774 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8580412864685059
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.678 Vali Acc: 0.460 Test Loss: 2.678 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0998966693878174
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.583 Vali Acc: 0.460 Test Loss: 2.583 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.205427885055542
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.494 Vali Acc: 0.460 Test Loss: 2.494 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 157276421
model size : 614.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3856961727142334
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.615 Vali Acc: 0.220 Test Loss: 1.615 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.9360802173614502
Epoch: 2, Steps: 4 | Train Loss: 1.350 Vali Loss: 1.614 Vali Acc: 0.340 Test Loss: 1.614 Test Acc: 0.340
Validation loss decreased (-0.219984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 2.0121684074401855
Epoch: 3, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.477 Vali Acc: 0.420 Test Loss: 1.477 Test Acc: 0.420
Validation loss decreased (-0.339984 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 2.1525964736938477
Epoch: 4, Steps: 4 | Train Loss: 0.554 Vali Loss: 1.528 Vali Acc: 0.440 Test Loss: 1.528 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 1.9836146831512451
Epoch: 5, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.415 Vali Acc: 0.480 Test Loss: 1.415 Test Acc: 0.480
Validation loss decreased (-0.439985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 2.0050950050354004
Epoch: 6, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.427 Vali Acc: 0.520 Test Loss: 1.427 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519986).  Saving model ...
Epoch: 7 cost time: 2.096738815307617
Epoch: 7, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.458 Vali Acc: 0.560 Test Loss: 1.458 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559985).  Saving model ...
Epoch: 8 cost time: 1.7529189586639404
Epoch: 8, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.652 Vali Acc: 0.540 Test Loss: 1.652 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.306741714477539
Epoch: 9, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.817 Vali Acc: 0.480 Test Loss: 1.817 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.195016860961914
Epoch: 10, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.616 Vali Acc: 0.540 Test Loss: 1.616 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9415464401245117
Epoch: 11, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.824 Vali Acc: 0.520 Test Loss: 1.824 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.090043544769287
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.561 Vali Acc: 0.540 Test Loss: 1.561 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8867089748382568
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.781 Vali Acc: 0.520 Test Loss: 1.781 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.178511381149292
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.767 Vali Acc: 0.520 Test Loss: 1.767 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1626546382904053
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.500 Test Loss: 1.641 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0434908866882324
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.721 Vali Acc: 0.500 Test Loss: 1.721 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.255300760269165
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.946 Vali Acc: 0.480 Test Loss: 1.946 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 157211909
model size : 614.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8484370708465576
Epoch: 1, Steps: 4 | Train Loss: 1.718 Vali Loss: 1.587 Vali Acc: 0.320 Test Loss: 1.587 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 2.1827502250671387
Epoch: 2, Steps: 4 | Train Loss: 1.517 Vali Loss: 1.554 Vali Acc: 0.300 Test Loss: 1.554 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8573262691497803
Epoch: 3, Steps: 4 | Train Loss: 0.992 Vali Loss: 1.403 Vali Acc: 0.380 Test Loss: 1.403 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 2.387631416320801
Epoch: 4, Steps: 4 | Train Loss: 0.787 Vali Loss: 1.307 Vali Acc: 0.480 Test Loss: 1.307 Test Acc: 0.480
Validation loss decreased (-0.379986 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 2.8644235134124756
Epoch: 5, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.283 Vali Acc: 0.480 Test Loss: 1.283 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 2.6336874961853027
Epoch: 6, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.443 Vali Acc: 0.500 Test Loss: 1.443 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 2.1645665168762207
Epoch: 7, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.463 Vali Acc: 0.400 Test Loss: 1.463 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1967029571533203
Epoch: 8, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.433 Vali Acc: 0.420 Test Loss: 1.433 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1536598205566406
Epoch: 9, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.283 Vali Acc: 0.460 Test Loss: 1.283 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.27524995803833
Epoch: 10, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.431 Vali Acc: 0.440 Test Loss: 1.431 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8318350315093994
Epoch: 11, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.386 Vali Acc: 0.520 Test Loss: 1.386 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 2.624631881713867
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.376 Vali Acc: 0.520 Test Loss: 1.376 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519986).  Saving model ...
Epoch: 13 cost time: 2.4253618717193604
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.899 Vali Acc: 0.460 Test Loss: 1.899 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7941620349884033
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.721 Vali Acc: 0.480 Test Loss: 1.721 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7743992805480957
Epoch: 15, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.359 Vali Acc: 0.480 Test Loss: 1.359 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.111543655395508
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.315 Vali Acc: 0.500 Test Loss: 1.315 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.9781816005706787
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.480 Vali Acc: 0.500 Test Loss: 1.480 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.128293752670288
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.730 Vali Acc: 0.460 Test Loss: 1.730 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9414710998535156
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.843 Vali Acc: 0.460 Test Loss: 1.843 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.440803050994873
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.778 Vali Acc: 0.460 Test Loss: 1.778 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5717058181762695
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.500 Test Loss: 1.705 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.383354425430298
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.697 Vali Acc: 0.480 Test Loss: 1.697 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 157179653
model size : 614.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.419389963150024
Epoch: 1, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.559 Vali Acc: 0.120 Test Loss: 1.559 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 2.3320469856262207
Epoch: 2, Steps: 4 | Train Loss: 1.690 Vali Loss: 1.728 Vali Acc: 0.260 Test Loss: 1.728 Test Acc: 0.260
Validation loss decreased (-0.119984 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 2.303645610809326
Epoch: 3, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.670 Vali Acc: 0.280 Test Loss: 1.670 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.6572604179382324
Epoch: 4, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.604 Vali Acc: 0.360 Test Loss: 1.604 Test Acc: 0.360
Validation loss decreased (-0.279983 --> -0.359984).  Saving model ...
Epoch: 5 cost time: 2.3603878021240234
Epoch: 5, Steps: 4 | Train Loss: 0.798 Vali Loss: 1.664 Vali Acc: 0.380 Test Loss: 1.664 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379983).  Saving model ...
Epoch: 6 cost time: 2.569673776626587
Epoch: 6, Steps: 4 | Train Loss: 0.462 Vali Loss: 1.713 Vali Acc: 0.440 Test Loss: 1.713 Test Acc: 0.440
Validation loss decreased (-0.379983 --> -0.439983).  Saving model ...
Epoch: 7 cost time: 2.641831159591675
Epoch: 7, Steps: 4 | Train Loss: 0.339 Vali Loss: 1.685 Vali Acc: 0.520 Test Loss: 1.685 Test Acc: 0.520
Validation loss decreased (-0.439983 --> -0.519983).  Saving model ...
Epoch: 8 cost time: 2.672931432723999
Epoch: 8, Steps: 4 | Train Loss: 0.249 Vali Loss: 1.741 Vali Acc: 0.420 Test Loss: 1.741 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.419536590576172
Epoch: 9, Steps: 4 | Train Loss: 0.468 Vali Loss: 1.826 Vali Acc: 0.460 Test Loss: 1.826 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.451491355895996
Epoch: 10, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.620 Vali Acc: 0.440 Test Loss: 1.620 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.742107391357422
Epoch: 11, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.989 Vali Acc: 0.440 Test Loss: 1.989 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.488396644592285
Epoch: 12, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.862 Vali Acc: 0.500 Test Loss: 1.862 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.642887592315674
Epoch: 13, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.544 Vali Acc: 0.520 Test Loss: 1.544 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519985).  Saving model ...
Epoch: 14 cost time: 2.2692787647247314
Epoch: 14, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.831 Vali Acc: 0.500 Test Loss: 1.831 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.325371503829956
Epoch: 15, Steps: 4 | Train Loss: 0.086 Vali Loss: 2.188 Vali Acc: 0.480 Test Loss: 2.188 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8552463054656982
Epoch: 16, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.709 Vali Acc: 0.460 Test Loss: 1.709 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0118582248687744
Epoch: 17, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.763 Vali Acc: 0.480 Test Loss: 1.763 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.197509288787842
Epoch: 18, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.634 Vali Acc: 0.520 Test Loss: 1.634 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0923032760620117
Epoch: 19, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.954 Vali Acc: 0.480 Test Loss: 1.954 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.979613780975342
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.358 Vali Acc: 0.440 Test Loss: 2.358 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.832026243209839
Epoch: 21, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.124 Vali Acc: 0.460 Test Loss: 2.124 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.1510472297668457
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.500 Test Loss: 1.682 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.9944334030151367
Epoch: 23, Steps: 4 | Train Loss: 0.044 Vali Loss: 2.011 Vali Acc: 0.540 Test Loss: 2.011 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539980).  Saving model ...
Epoch: 24 cost time: 2.667961597442627
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.134 Vali Acc: 0.440 Test Loss: 3.134 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.914821147918701
Epoch: 25, Steps: 4 | Train Loss: 0.043 Vali Loss: 3.180 Vali Acc: 0.460 Test Loss: 3.180 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.7628796100616455
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.839 Vali Acc: 0.540 Test Loss: 2.839 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.174675941467285
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.600 Vali Acc: 0.540 Test Loss: 2.600 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.025054931640625
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.480 Vali Acc: 0.500 Test Loss: 2.480 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.7538414001464844
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.403 Vali Acc: 0.480 Test Loss: 2.403 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.480910539627075
Epoch: 30, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.409 Vali Acc: 0.500 Test Loss: 2.409 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.4623873233795166
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.541 Vali Acc: 0.480 Test Loss: 2.541 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.6505842208862305
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.638 Vali Acc: 0.480 Test Loss: 2.638 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.820377826690674
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.460 Test Loss: 2.685 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 175842821
model size : 685.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.573684930801392
Epoch: 1, Steps: 4 | Train Loss: 1.798 Vali Loss: 1.616 Vali Acc: 0.160 Test Loss: 1.616 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.1505751609802246
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.604 Vali Acc: 0.280 Test Loss: 1.604 Test Acc: 0.280
Validation loss decreased (-0.159984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.2497100830078125
Epoch: 3, Steps: 4 | Train Loss: 0.925 Vali Loss: 1.616 Vali Acc: 0.380 Test Loss: 1.616 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 2.464313268661499
Epoch: 4, Steps: 4 | Train Loss: 0.639 Vali Loss: 1.459 Vali Acc: 0.400 Test Loss: 1.459 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 2.6179239749908447
Epoch: 5, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.687 Vali Acc: 0.320 Test Loss: 1.687 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7201032638549805
Epoch: 6, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.689 Vali Acc: 0.340 Test Loss: 1.689 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4940314292907715
Epoch: 7, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.544 Vali Acc: 0.380 Test Loss: 1.544 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7318434715270996
Epoch: 8, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.691 Vali Acc: 0.400 Test Loss: 1.691 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.64654541015625
Epoch: 9, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.269 Vali Acc: 0.420 Test Loss: 1.269 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419987).  Saving model ...
Epoch: 10 cost time: 2.3649399280548096
Epoch: 10, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.619 Vali Acc: 0.420 Test Loss: 1.619 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4091925621032715
Epoch: 11, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.851 Vali Acc: 0.400 Test Loss: 1.851 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.499720573425293
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.679 Vali Acc: 0.400 Test Loss: 1.679 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.893400192260742
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.949 Vali Acc: 0.400 Test Loss: 1.949 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.714063882827759
Epoch: 14, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.961 Vali Acc: 0.400 Test Loss: 1.961 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.705810785293579
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.692 Vali Acc: 0.380 Test Loss: 1.692 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5826292037963867
Epoch: 16, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.845 Vali Acc: 0.400 Test Loss: 1.845 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.0052618980407715
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.096 Vali Acc: 0.400 Test Loss: 2.096 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9306085109710693
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.171 Vali Acc: 0.380 Test Loss: 2.171 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1288421154022217
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.983 Vali Acc: 0.400 Test Loss: 1.983 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 175794437
model size : 685.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.575934410095215
Epoch: 1, Steps: 4 | Train Loss: 1.763 Vali Loss: 1.778 Vali Acc: 0.240 Test Loss: 1.778 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 2.414382219314575
Epoch: 2, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.602 Vali Acc: 0.260 Test Loss: 1.602 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.380965232849121
Epoch: 3, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.520 Vali Acc: 0.400 Test Loss: 1.520 Test Acc: 0.400
Validation loss decreased (-0.259984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 2.2423088550567627
Epoch: 4, Steps: 4 | Train Loss: 0.809 Vali Loss: 1.402 Vali Acc: 0.440 Test Loss: 1.402 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 2.1779141426086426
Epoch: 5, Steps: 4 | Train Loss: 0.718 Vali Loss: 1.385 Vali Acc: 0.420 Test Loss: 1.385 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.069819688796997
Epoch: 6, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.314 Vali Acc: 0.440 Test Loss: 1.314 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 7 cost time: 2.940108299255371
Epoch: 7, Steps: 4 | Train Loss: 0.179 Vali Loss: 1.293 Vali Acc: 0.480 Test Loss: 1.293 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 2.6312036514282227
Epoch: 8, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.260 Vali Acc: 0.460 Test Loss: 1.260 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7324893474578857
Epoch: 9, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.507 Vali Acc: 0.420 Test Loss: 1.507 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.295090436935425
Epoch: 10, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.402 Vali Acc: 0.480 Test Loss: 1.402 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3483989238739014
Epoch: 11, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.650 Vali Acc: 0.420 Test Loss: 1.650 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4760022163391113
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.912 Vali Acc: 0.440 Test Loss: 1.912 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4843013286590576
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.559 Vali Acc: 0.480 Test Loss: 1.559 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3657751083374023
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.569 Vali Acc: 0.460 Test Loss: 1.569 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.378117322921753
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.614 Vali Acc: 0.480 Test Loss: 1.614 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3448479175567627
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.555 Vali Acc: 0.480 Test Loss: 1.555 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.491117477416992
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.669 Vali Acc: 0.520 Test Loss: 1.669 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519983).  Saving model ...
Epoch: 18 cost time: 2.5128626823425293
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.795 Vali Acc: 0.460 Test Loss: 1.795 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5542445182800293
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.868 Vali Acc: 0.460 Test Loss: 1.868 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.843733072280884
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.872 Vali Acc: 0.460 Test Loss: 1.872 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.412199020385742
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.850 Vali Acc: 0.460 Test Loss: 1.850 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.47707200050354
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.440 Test Loss: 1.823 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4582622051239014
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.440 Test Loss: 1.795 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.615133285522461
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.460 Test Loss: 1.775 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.71844220161438
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.460 Test Loss: 1.763 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.991546869277954
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.460 Test Loss: 1.776 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.762721538543701
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.460 Test Loss: 1.786 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 175772933
model size : 685.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps54_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.180415630340576
Epoch: 1, Steps: 4 | Train Loss: 1.757 Vali Loss: 1.663 Vali Acc: 0.080 Test Loss: 1.663 Test Acc: 0.080
Validation loss decreased (inf --> -0.079983).  Saving model ...
Epoch: 2 cost time: 2.4568021297454834
Epoch: 2, Steps: 4 | Train Loss: 1.303 Vali Loss: 1.369 Vali Acc: 0.360 Test Loss: 1.369 Test Acc: 0.360
Validation loss decreased (-0.079983 --> -0.359986).  Saving model ...
Epoch: 3 cost time: 2.560889720916748
Epoch: 3, Steps: 4 | Train Loss: 1.091 Vali Loss: 1.267 Vali Acc: 0.380 Test Loss: 1.267 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379987).  Saving model ...
Epoch: 4 cost time: 3.132509469985962
Epoch: 4, Steps: 4 | Train Loss: 0.745 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
Validation loss decreased (-0.379987 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 2.6435790061950684
Epoch: 5, Steps: 4 | Train Loss: 0.600 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 2.7539162635803223
Epoch: 6, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.396 Vali Acc: 0.400 Test Loss: 1.396 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1447091102600098
Epoch: 7, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.000500440597534
Epoch: 8, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.643 Vali Acc: 0.340 Test Loss: 1.643 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.07135272026062
Epoch: 9, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.537 Vali Acc: 0.340 Test Loss: 1.537 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4553349018096924
Epoch: 10, Steps: 4 | Train Loss: 0.156 Vali Loss: 1.872 Vali Acc: 0.420 Test Loss: 1.872 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419981).  Saving model ...
Epoch: 11 cost time: 2.956679582595825
Epoch: 11, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.630 Vali Acc: 0.420 Test Loss: 1.630 Test Acc: 0.420
Validation loss decreased (-0.419981 --> -0.419984).  Saving model ...
Epoch: 12 cost time: 2.4429965019226074
Epoch: 12, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.426 Vali Acc: 0.440 Test Loss: 1.426 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439986).  Saving model ...
Epoch: 13 cost time: 1.8929061889648438
Epoch: 13, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.859 Vali Acc: 0.400 Test Loss: 1.859 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.391051769256592
Epoch: 14, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.695 Vali Acc: 0.400 Test Loss: 1.695 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4003326892852783
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.680 Vali Acc: 0.460 Test Loss: 1.680 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459983).  Saving model ...
Epoch: 16 cost time: 2.049011707305908
Epoch: 16, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.501 Vali Acc: 0.480 Test Loss: 1.501 Test Acc: 0.480
Validation loss decreased (-0.459983 --> -0.479985).  Saving model ...
Epoch: 17 cost time: 2.847313642501831
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.801 Vali Acc: 0.420 Test Loss: 1.801 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.852877140045166
Epoch: 18, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.172 Vali Acc: 0.420 Test Loss: 2.172 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.269981622695923
Epoch: 19, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.217 Vali Acc: 0.460 Test Loss: 2.217 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.61665678024292
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.509 Vali Acc: 0.460 Test Loss: 2.509 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.98154878616333
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.988 Vali Acc: 0.420 Test Loss: 2.988 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.58931565284729
Epoch: 22, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.032 Vali Acc: 0.420 Test Loss: 3.032 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.210078716278076
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.675 Vali Acc: 0.420 Test Loss: 2.675 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.8457438945770264
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.440 Test Loss: 2.372 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0443994998931885
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.202 Vali Acc: 0.440 Test Loss: 2.202 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.857672691345215
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.460 Test Loss: 2.131 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps54_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 203716613
model size : 791.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6664464473724365
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.592 Vali Acc: 0.320 Test Loss: 1.592 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 2.6423237323760986
Epoch: 2, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.525 Vali Acc: 0.280 Test Loss: 1.525 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8633768558502197
Epoch: 3, Steps: 4 | Train Loss: 0.696 Vali Loss: 1.420 Vali Acc: 0.380 Test Loss: 1.420 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 2.818830728530884
Epoch: 4, Steps: 4 | Train Loss: 0.551 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 2.5054357051849365
Epoch: 5, Steps: 4 | Train Loss: 0.305 Vali Loss: 1.529 Vali Acc: 0.440 Test Loss: 1.529 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 6 cost time: 2.473071575164795
Epoch: 6, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.470 Vali Acc: 0.440 Test Loss: 1.470 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 1.9829392433166504
Epoch: 7, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.471 Vali Acc: 0.400 Test Loss: 1.471 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.782698392868042
Epoch: 8, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.347 Vali Acc: 0.440 Test Loss: 1.347 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439987).  Saving model ...
Epoch: 9 cost time: 2.3448069095611572
Epoch: 9, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.300 Vali Acc: 0.460 Test Loss: 1.300 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 2.758819580078125
Epoch: 10, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.625 Vali Acc: 0.460 Test Loss: 1.625 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9403717517852783
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.080 Vali Acc: 0.460 Test Loss: 2.080 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.548931121826172
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.883 Vali Acc: 0.460 Test Loss: 1.883 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6543588638305664
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.828 Vali Acc: 0.440 Test Loss: 1.828 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6791868209838867
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.652 Vali Acc: 0.460 Test Loss: 1.652 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8039586544036865
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.528 Vali Acc: 0.500 Test Loss: 1.528 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499985).  Saving model ...
Epoch: 16 cost time: 2.4903724193573
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.557 Vali Acc: 0.480 Test Loss: 1.557 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9548497200012207
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.660 Vali Acc: 0.440 Test Loss: 1.660 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.443359613418579
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.810 Vali Acc: 0.460 Test Loss: 1.810 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.221043109893799
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.460 Test Loss: 1.938 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1695315837860107
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.005 Vali Acc: 0.460 Test Loss: 2.005 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2610771656036377
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.990 Vali Acc: 0.460 Test Loss: 1.990 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4928536415100098
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.460 Test Loss: 1.846 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7612640857696533
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.460 Test Loss: 1.771 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2944750785827637
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.767 Vali Acc: 0.480 Test Loss: 1.767 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5734851360321045
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.500 Test Loss: 1.847 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 203678981
model size : 791.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps54_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.3885064125061035
Epoch: 1, Steps: 4 | Train Loss: 1.826 Vali Loss: 1.699 Vali Acc: 0.160 Test Loss: 1.699 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.955033540725708
Epoch: 2, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.612 Vali Acc: 0.320 Test Loss: 1.612 Test Acc: 0.320
Validation loss decreased (-0.159983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 2.5012199878692627
Epoch: 3, Steps: 4 | Train Loss: 1.089 Vali Loss: 1.357 Vali Acc: 0.360 Test Loss: 1.357 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 3.080335855484009
Epoch: 4, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.340 Vali Acc: 0.440 Test Loss: 1.340 Test Acc: 0.440
Validation loss decreased (-0.359986 --> -0.439987).  Saving model ...
Epoch: 5 cost time: 3.1625115871429443
Epoch: 5, Steps: 4 | Train Loss: 0.452 Vali Loss: 1.321 Vali Acc: 0.440 Test Loss: 1.321 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 3.2098312377929688
Epoch: 6, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.261 Vali Acc: 0.440 Test Loss: 1.261 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439987).  Saving model ...
Epoch: 7 cost time: 2.4233949184417725
Epoch: 7, Steps: 4 | Train Loss: 0.331 Vali Loss: 1.358 Vali Acc: 0.440 Test Loss: 1.358 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5241527557373047
Epoch: 8, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.476 Vali Acc: 0.480 Test Loss: 1.476 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479985).  Saving model ...
Epoch: 9 cost time: 2.466491222381592
Epoch: 9, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.576 Vali Acc: 0.460 Test Loss: 1.576 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9621434211730957
Epoch: 10, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.531 Vali Acc: 0.520 Test Loss: 1.531 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519985).  Saving model ...
Epoch: 11 cost time: 2.5019404888153076
Epoch: 11, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.462 Vali Acc: 0.500 Test Loss: 1.462 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.916781187057495
Epoch: 12, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.183 Vali Acc: 0.560 Test Loss: 1.183 Test Acc: 0.560
Validation loss decreased (-0.519985 --> -0.559988).  Saving model ...
Epoch: 13 cost time: 2.673837900161743
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.619 Vali Acc: 0.500 Test Loss: 1.619 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.833656072616577
Epoch: 14, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.368 Vali Acc: 0.480 Test Loss: 1.368 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.761220693588257
Epoch: 15, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.428 Vali Acc: 0.460 Test Loss: 1.428 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7994513511657715
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.657 Vali Acc: 0.460 Test Loss: 1.657 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.744553565979004
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.881 Vali Acc: 0.400 Test Loss: 1.881 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0432326793670654
Epoch: 18, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.885 Vali Acc: 0.420 Test Loss: 1.885 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.9513986110687256
Epoch: 19, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.898 Vali Acc: 0.460 Test Loss: 1.898 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4304325580596924
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.175 Vali Acc: 0.400 Test Loss: 2.175 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4944567680358887
Epoch: 21, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.030 Vali Acc: 0.380 Test Loss: 2.030 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7331700325012207
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.573 Vali Acc: 0.480 Test Loss: 1.573 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el5_dm768_df768_ps54_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 203657477
model size : 791.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.741605520248413
Epoch: 1, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.610 Vali Acc: 0.140 Test Loss: 1.610 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.254451036453247
Epoch: 2, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.583 Vali Acc: 0.240 Test Loss: 1.583 Test Acc: 0.240
Validation loss decreased (-0.139984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.290869951248169
Epoch: 3, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.486 Vali Acc: 0.400 Test Loss: 1.486 Test Acc: 0.400
Validation loss decreased (-0.239984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.2098288536071777
Epoch: 4, Steps: 4 | Train Loss: 0.849 Vali Loss: 1.447 Vali Acc: 0.440 Test Loss: 1.447 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.1107473373413086
Epoch: 5, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.438 Vali Acc: 0.420 Test Loss: 1.438 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.147045373916626
Epoch: 6, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.931 Vali Acc: 0.480 Test Loss: 1.931 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479981).  Saving model ...
Epoch: 7 cost time: 1.1661202907562256
Epoch: 7, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.418 Vali Acc: 0.560 Test Loss: 1.418 Test Acc: 0.560
Validation loss decreased (-0.479981 --> -0.559986).  Saving model ...
Epoch: 8 cost time: 1.194563865661621
Epoch: 8, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.812 Vali Acc: 0.540 Test Loss: 1.812 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0371713638305664
Epoch: 9, Steps: 4 | Train Loss: 0.074 Vali Loss: 2.360 Vali Acc: 0.440 Test Loss: 2.360 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.020545482635498
Epoch: 10, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.642 Vali Acc: 0.480 Test Loss: 1.642 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2712790966033936
Epoch: 11, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.643 Vali Acc: 0.440 Test Loss: 1.643 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2049059867858887
Epoch: 12, Steps: 4 | Train Loss: 0.291 Vali Loss: 1.770 Vali Acc: 0.540 Test Loss: 1.770 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3274343013763428
Epoch: 13, Steps: 4 | Train Loss: 0.259 Vali Loss: 2.369 Vali Acc: 0.400 Test Loss: 2.369 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2069816589355469
Epoch: 14, Steps: 4 | Train Loss: 0.578 Vali Loss: 2.344 Vali Acc: 0.420 Test Loss: 2.344 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3826699256896973
Epoch: 15, Steps: 4 | Train Loss: 0.168 Vali Loss: 2.053 Vali Acc: 0.420 Test Loss: 2.053 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.377042531967163
Epoch: 16, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.055 Vali Acc: 0.460 Test Loss: 2.055 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2987382411956787
Epoch: 17, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.077 Vali Acc: 0.480 Test Loss: 2.077 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 63758597
model size : 257.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.918705940246582
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.652 Vali Acc: 0.100 Test Loss: 1.652 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 1.113232135772705
Epoch: 2, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.593 Vali Acc: 0.300 Test Loss: 1.593 Test Acc: 0.300
Validation loss decreased (-0.099983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.2287750244140625
Epoch: 3, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.526 Vali Acc: 0.300 Test Loss: 1.526 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.1984047889709473
Epoch: 4, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.489 Vali Acc: 0.400 Test Loss: 1.489 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.3900208473205566
Epoch: 5, Steps: 4 | Train Loss: 0.753 Vali Loss: 1.521 Vali Acc: 0.400 Test Loss: 1.521 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9832985401153564
Epoch: 6, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.422 Vali Acc: 0.460 Test Loss: 1.422 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.1892476081848145
Epoch: 7, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.778 Vali Acc: 0.460 Test Loss: 1.778 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2331228256225586
Epoch: 8, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.987 Vali Acc: 0.440 Test Loss: 1.987 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.115994930267334
Epoch: 9, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.656 Vali Acc: 0.480 Test Loss: 1.656 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479983).  Saving model ...
Epoch: 10 cost time: 1.1382691860198975
Epoch: 10, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.908 Vali Acc: 0.480 Test Loss: 1.908 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0564396381378174
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.854 Vali Acc: 0.520 Test Loss: 1.854 Test Acc: 0.520
Validation loss decreased (-0.479983 --> -0.519981).  Saving model ...
Epoch: 12 cost time: 1.1066761016845703
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.869 Vali Acc: 0.540 Test Loss: 1.869 Test Acc: 0.540
Validation loss decreased (-0.519981 --> -0.539981).  Saving model ...
Epoch: 13 cost time: 1.1983389854431152
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.659 Vali Acc: 0.620 Test Loss: 1.659 Test Acc: 0.620
Validation loss decreased (-0.539981 --> -0.619983).  Saving model ...
Epoch: 14 cost time: 1.2412500381469727
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.875 Vali Acc: 0.600 Test Loss: 1.875 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3337833881378174
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.284 Vali Acc: 0.500 Test Loss: 2.284 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1702241897583008
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.610 Vali Acc: 0.500 Test Loss: 2.610 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.180238962173462
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.744 Vali Acc: 0.500 Test Loss: 2.744 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1129322052001953
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.729 Vali Acc: 0.540 Test Loss: 2.729 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1376428604125977
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.529 Vali Acc: 0.540 Test Loss: 2.529 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1861941814422607
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.379 Vali Acc: 0.580 Test Loss: 2.379 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7801554203033447
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.288 Vali Acc: 0.580 Test Loss: 2.288 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2346000671386719
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.241 Vali Acc: 0.580 Test Loss: 2.241 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3040821552276611
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.580 Test Loss: 2.221 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 63527429
model size : 257.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0013248920440674
Epoch: 1, Steps: 4 | Train Loss: 1.693 Vali Loss: 1.640 Vali Acc: 0.220 Test Loss: 1.640 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0861530303955078
Epoch: 2, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.479 Vali Acc: 0.300 Test Loss: 1.479 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.1731576919555664
Epoch: 3, Steps: 4 | Train Loss: 1.105 Vali Loss: 1.436 Vali Acc: 0.360 Test Loss: 1.436 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 1.0830066204071045
Epoch: 4, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.441 Vali Acc: 0.320 Test Loss: 1.441 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9940574169158936
Epoch: 5, Steps: 4 | Train Loss: 0.687 Vali Loss: 1.420 Vali Acc: 0.480 Test Loss: 1.420 Test Acc: 0.480
Validation loss decreased (-0.359986 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.0942187309265137
Epoch: 6, Steps: 4 | Train Loss: 0.443 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.2546818256378174
Epoch: 7, Steps: 4 | Train Loss: 0.272 Vali Loss: 1.225 Vali Acc: 0.520 Test Loss: 1.225 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519988).  Saving model ...
Epoch: 8 cost time: 1.1524465084075928
Epoch: 8, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.614 Vali Acc: 0.440 Test Loss: 1.614 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2911262512207031
Epoch: 9, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.407 Vali Acc: 0.520 Test Loss: 1.407 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.136934757232666
Epoch: 10, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.514 Vali Acc: 0.500 Test Loss: 1.514 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1485753059387207
Epoch: 11, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3147923946380615
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.011 Vali Acc: 0.480 Test Loss: 2.011 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.497326374053955
Epoch: 13, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.868 Vali Acc: 0.520 Test Loss: 1.868 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4074149131774902
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.641 Vali Acc: 0.540 Test Loss: 1.641 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539984).  Saving model ...
Epoch: 15 cost time: 1.1739463806152344
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.550 Vali Acc: 0.580 Test Loss: 1.550 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579984).  Saving model ...
Epoch: 16 cost time: 1.3346376419067383
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.813 Vali Acc: 0.480 Test Loss: 1.813 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2797024250030518
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.810 Vali Acc: 0.480 Test Loss: 1.810 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1874268054962158
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.697 Vali Acc: 0.540 Test Loss: 1.697 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.211367130279541
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.652 Vali Acc: 0.540 Test Loss: 1.652 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9483044147491455
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.640 Vali Acc: 0.540 Test Loss: 1.640 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0868589878082275
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.540 Test Loss: 1.687 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0755980014801025
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.540 Test Loss: 1.788 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0879967212677002
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.872 Vali Acc: 0.520 Test Loss: 1.872 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0986905097961426
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.921 Vali Acc: 0.520 Test Loss: 1.921 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1258316040039062
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.520 Test Loss: 1.956 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 63419909
model size : 256.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1160624027252197
Epoch: 1, Steps: 4 | Train Loss: 2.000 Vali Loss: 1.674 Vali Acc: 0.200 Test Loss: 1.674 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.0268902778625488
Epoch: 2, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.433 Vali Acc: 0.240 Test Loss: 1.433 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239986).  Saving model ...
Epoch: 3 cost time: 1.6798276901245117
Epoch: 3, Steps: 4 | Train Loss: 1.320 Vali Loss: 1.433 Vali Acc: 0.420 Test Loss: 1.433 Test Acc: 0.420
Validation loss decreased (-0.239986 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 1.245927095413208
Epoch: 4, Steps: 4 | Train Loss: 0.832 Vali Loss: 1.307 Vali Acc: 0.460 Test Loss: 1.307 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 5 cost time: 1.3022398948669434
Epoch: 5, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.794 Vali Acc: 0.380 Test Loss: 1.794 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0529062747955322
Epoch: 6, Steps: 4 | Train Loss: 0.366 Vali Loss: 1.438 Vali Acc: 0.420 Test Loss: 1.438 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3448560237884521
Epoch: 7, Steps: 4 | Train Loss: 0.380 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.9421234130859375
Epoch: 8, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.710 Vali Acc: 0.540 Test Loss: 1.710 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539983).  Saving model ...
Epoch: 9 cost time: 1.4500551223754883
Epoch: 9, Steps: 4 | Train Loss: 0.104 Vali Loss: 2.213 Vali Acc: 0.500 Test Loss: 2.213 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.262892723083496
Epoch: 10, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.959 Vali Acc: 0.560 Test Loss: 1.959 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559980).  Saving model ...
Epoch: 11 cost time: 1.3765273094177246
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.048 Vali Acc: 0.520 Test Loss: 2.048 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2751357555389404
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.607 Vali Acc: 0.480 Test Loss: 2.607 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2813265323638916
Epoch: 13, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.542 Vali Acc: 0.480 Test Loss: 2.542 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3297221660614014
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 2.231 Vali Acc: 0.500 Test Loss: 2.231 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3778223991394043
Epoch: 15, Steps: 4 | Train Loss: 0.001 Vali Loss: 3.391 Vali Acc: 0.460 Test Loss: 3.391 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.169468641281128
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.660 Vali Acc: 0.480 Test Loss: 2.660 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2132205963134766
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.633 Vali Acc: 0.500 Test Loss: 2.633 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2914493083953857
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.209 Vali Acc: 0.500 Test Loss: 2.209 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2180202007293701
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.076 Vali Acc: 0.480 Test Loss: 2.076 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2967450618743896
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.079 Vali Acc: 0.500 Test Loss: 2.079 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 66857477
model size : 269.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7370076179504395
Epoch: 1, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.664 Vali Acc: 0.220 Test Loss: 1.664 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.0328192710876465
Epoch: 2, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.513 Vali Acc: 0.360 Test Loss: 1.513 Test Acc: 0.360
Validation loss decreased (-0.219983 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.0699660778045654
Epoch: 3, Steps: 4 | Train Loss: 1.267 Vali Loss: 1.383 Vali Acc: 0.360 Test Loss: 1.383 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 1.4179737567901611
Epoch: 4, Steps: 4 | Train Loss: 0.810 Vali Loss: 1.269 Vali Acc: 0.360 Test Loss: 1.269 Test Acc: 0.360
Validation loss decreased (-0.359986 --> -0.359987).  Saving model ...
Epoch: 5 cost time: 1.2522518634796143
Epoch: 5, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.240 Vali Acc: 0.460 Test Loss: 1.240 Test Acc: 0.460
Validation loss decreased (-0.359987 --> -0.459988).  Saving model ...
Epoch: 6 cost time: 1.3025665283203125
Epoch: 6, Steps: 4 | Train Loss: 0.323 Vali Loss: 1.338 Vali Acc: 0.440 Test Loss: 1.338 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1968207359313965
Epoch: 7, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.260608434677124
Epoch: 8, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.750 Vali Acc: 0.440 Test Loss: 1.750 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.111086368560791
Epoch: 9, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.686 Vali Acc: 0.500 Test Loss: 1.686 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1099853515625
Epoch: 10, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.430 Vali Acc: 0.440 Test Loss: 1.430 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1098616123199463
Epoch: 11, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.918 Vali Acc: 0.460 Test Loss: 1.918 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.177344560623169
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.469 Vali Acc: 0.500 Test Loss: 1.469 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2147536277770996
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.816 Vali Acc: 0.520 Test Loss: 1.816 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519982).  Saving model ...
Epoch: 14 cost time: 1.127206802368164
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.851 Vali Acc: 0.520 Test Loss: 1.851 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0949664115905762
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.829 Vali Acc: 0.620 Test Loss: 1.829 Test Acc: 0.620
Validation loss decreased (-0.519982 --> -0.619982).  Saving model ...
Epoch: 16 cost time: 1.0489447116851807
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.600 Test Loss: 1.799 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0059571266174316
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.620 Test Loss: 1.803 Test Acc: 0.620
Validation loss decreased (-0.619982 --> -0.619982).  Saving model ...
Epoch: 18 cost time: 1.0458483695983887
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.873 Vali Acc: 0.620 Test Loss: 1.873 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.131176233291626
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.560 Test Loss: 1.939 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0254836082458496
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.580 Test Loss: 1.994 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.432643175125122
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.560 Test Loss: 2.038 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0899512767791748
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.560 Test Loss: 2.064 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1285016536712646
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.540 Test Loss: 2.083 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0684034824371338
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.083 Vali Acc: 0.560 Test Loss: 2.083 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1417186260223389
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.560 Test Loss: 2.075 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3883764743804932
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.061 Vali Acc: 0.560 Test Loss: 2.061 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2869763374328613
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.048 Vali Acc: 0.560 Test Loss: 2.048 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 66626309
model size : 268.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0294010639190674
Epoch: 1, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.681 Vali Acc: 0.180 Test Loss: 1.681 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.3257203102111816
Epoch: 2, Steps: 4 | Train Loss: 1.618 Vali Loss: 1.535 Vali Acc: 0.340 Test Loss: 1.535 Test Acc: 0.340
Validation loss decreased (-0.179983 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.028022289276123
Epoch: 3, Steps: 4 | Train Loss: 1.190 Vali Loss: 1.457 Vali Acc: 0.360 Test Loss: 1.457 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 0.8796396255493164
Epoch: 4, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.353 Vali Acc: 0.440 Test Loss: 1.353 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.0862689018249512
Epoch: 5, Steps: 4 | Train Loss: 0.540 Vali Loss: 1.622 Vali Acc: 0.400 Test Loss: 1.622 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8609375953674316
Epoch: 6, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1052820682525635
Epoch: 7, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.425 Vali Acc: 0.440 Test Loss: 1.425 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0809767246246338
Epoch: 8, Steps: 4 | Train Loss: 0.133 Vali Loss: 1.479 Vali Acc: 0.400 Test Loss: 1.479 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1023855209350586
Epoch: 9, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.296 Vali Acc: 0.460 Test Loss: 1.296 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 1.312873363494873
Epoch: 10, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8153996467590332
Epoch: 11, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.573 Vali Acc: 0.440 Test Loss: 1.573 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8212478160858154
Epoch: 12, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499983).  Saving model ...
Epoch: 13 cost time: 0.8411328792572021
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.046 Vali Acc: 0.440 Test Loss: 2.046 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.923412561416626
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.049 Vali Acc: 0.480 Test Loss: 2.049 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.068800926208496
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.915 Vali Acc: 0.500 Test Loss: 1.915 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0674257278442383
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.786 Vali Acc: 0.500 Test Loss: 1.786 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.198514699935913
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.997 Vali Acc: 0.480 Test Loss: 1.997 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.070488452911377
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.302 Vali Acc: 0.480 Test Loss: 2.302 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0971324443817139
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.378 Vali Acc: 0.480 Test Loss: 2.378 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0158843994140625
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.156 Vali Acc: 0.520 Test Loss: 2.156 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519978).  Saving model ...
Epoch: 21 cost time: 1.0855700969696045
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.520 Test Loss: 1.977 Test Acc: 0.520
Validation loss decreased (-0.519978 --> -0.519980).  Saving model ...
Epoch: 22 cost time: 1.0775392055511475
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.540 Test Loss: 1.871 Test Acc: 0.540
Validation loss decreased (-0.519980 --> -0.539981).  Saving model ...
Epoch: 23 cost time: 1.204932451248169
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.540 Test Loss: 1.843 Test Acc: 0.540
Validation loss decreased (-0.539981 --> -0.539982).  Saving model ...
Epoch: 24 cost time: 0.9847421646118164
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.883 Vali Acc: 0.540 Test Loss: 1.883 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9583039283752441
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.943 Vali Acc: 0.540 Test Loss: 1.943 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1458663940429688
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.540 Test Loss: 2.003 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2249398231506348
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.046 Vali Acc: 0.520 Test Loss: 2.046 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1238305568695068
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.520 Test Loss: 2.067 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3875281810760498
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.072 Vali Acc: 0.520 Test Loss: 2.072 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1182727813720703
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.066 Vali Acc: 0.520 Test Loss: 2.066 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9911832809448242
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.059 Vali Acc: 0.520 Test Loss: 2.059 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1253623962402344
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.062 Vali Acc: 0.520 Test Loss: 2.062 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1894068717956543
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.073 Vali Acc: 0.520 Test Loss: 2.073 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 66508037
model size : 268.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8641843795776367
Epoch: 1, Steps: 4 | Train Loss: 1.763 Vali Loss: 1.602 Vali Acc: 0.260 Test Loss: 1.602 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 0.8301947116851807
Epoch: 2, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0244052410125732
Epoch: 3, Steps: 4 | Train Loss: 1.103 Vali Loss: 1.514 Vali Acc: 0.440 Test Loss: 1.514 Test Acc: 0.440
Validation loss decreased (-0.259984 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 1.3019981384277344
Epoch: 4, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.439 Vali Acc: 0.380 Test Loss: 1.439 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2395336627960205
Epoch: 5, Steps: 4 | Train Loss: 0.518 Vali Loss: 1.447 Vali Acc: 0.300 Test Loss: 1.447 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2328214645385742
Epoch: 6, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.887 Vali Acc: 0.440 Test Loss: 1.887 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2750039100646973
Epoch: 7, Steps: 4 | Train Loss: 0.226 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.3281383514404297
Epoch: 8, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.344 Vali Acc: 0.520 Test Loss: 1.344 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 1.306166410446167
Epoch: 9, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.811 Vali Acc: 0.380 Test Loss: 1.811 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2366447448730469
Epoch: 10, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.843 Vali Acc: 0.480 Test Loss: 1.843 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1687743663787842
Epoch: 11, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.252 Vali Acc: 0.620 Test Loss: 1.252 Test Acc: 0.620
Validation loss decreased (-0.519987 --> -0.619987).  Saving model ...
Epoch: 12 cost time: 1.4407503604888916
Epoch: 12, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.558 Vali Acc: 0.520 Test Loss: 1.558 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6809422969818115
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.665 Vali Acc: 0.560 Test Loss: 1.665 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5509302616119385
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.634 Vali Acc: 0.580 Test Loss: 1.634 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4896488189697266
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.747 Vali Acc: 0.600 Test Loss: 1.747 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3170642852783203
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.880 Vali Acc: 0.580 Test Loss: 1.880 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3589990139007568
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.540 Test Loss: 1.881 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3003146648406982
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.520 Test Loss: 1.853 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2523741722106934
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.890 Vali Acc: 0.480 Test Loss: 1.890 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3234593868255615
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.500 Test Loss: 1.958 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3123664855957031
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.500 Test Loss: 2.020 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 69838085
model size : 281.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5796101093292236
Epoch: 1, Steps: 4 | Train Loss: 1.787 Vali Loss: 1.724 Vali Acc: 0.220 Test Loss: 1.724 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.2266485691070557
Epoch: 2, Steps: 4 | Train Loss: 1.679 Vali Loss: 1.464 Vali Acc: 0.300 Test Loss: 1.464 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.105987787246704
Epoch: 3, Steps: 4 | Train Loss: 1.099 Vali Loss: 1.375 Vali Acc: 0.400 Test Loss: 1.375 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.3054001331329346
Epoch: 4, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.074605941772461
Epoch: 5, Steps: 4 | Train Loss: 0.538 Vali Loss: 1.364 Vali Acc: 0.440 Test Loss: 1.364 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.115380048751831
Epoch: 6, Steps: 4 | Train Loss: 0.454 Vali Loss: 1.383 Vali Acc: 0.480 Test Loss: 1.383 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 7 cost time: 1.1307055950164795
Epoch: 7, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.623 Vali Acc: 0.480 Test Loss: 1.623 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0826764106750488
Epoch: 8, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.369 Vali Acc: 0.520 Test Loss: 1.369 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519986).  Saving model ...
Epoch: 9 cost time: 1.0277225971221924
Epoch: 9, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.833 Vali Acc: 0.520 Test Loss: 1.833 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1064395904541016
Epoch: 10, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.685 Vali Acc: 0.440 Test Loss: 1.685 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0051946640014648
Epoch: 11, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1918632984161377
Epoch: 12, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.681 Vali Acc: 0.560 Test Loss: 1.681 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559983).  Saving model ...
Epoch: 13 cost time: 1.0831100940704346
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.680 Vali Acc: 0.520 Test Loss: 1.680 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0459811687469482
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.773 Vali Acc: 0.520 Test Loss: 1.773 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2434144020080566
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.948 Vali Acc: 0.520 Test Loss: 1.948 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0844080448150635
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.148 Vali Acc: 0.520 Test Loss: 2.148 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1285419464111328
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.185 Vali Acc: 0.540 Test Loss: 2.185 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2315034866333008
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.177 Vali Acc: 0.600 Test Loss: 2.177 Test Acc: 0.600
Validation loss decreased (-0.559983 --> -0.599978).  Saving model ...
Epoch: 19 cost time: 1.07877779006958
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.168 Vali Acc: 0.560 Test Loss: 2.168 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0372414588928223
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.176 Vali Acc: 0.560 Test Loss: 2.176 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2450096607208252
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.169 Vali Acc: 0.580 Test Loss: 2.169 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2297461032867432
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.168 Vali Acc: 0.600 Test Loss: 2.168 Test Acc: 0.600
Validation loss decreased (-0.599978 --> -0.599978).  Saving model ...
Epoch: 23 cost time: 1.295736312866211
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.186 Vali Acc: 0.580 Test Loss: 2.186 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1008789539337158
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.580 Test Loss: 2.197 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3517553806304932
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.203 Vali Acc: 0.580 Test Loss: 2.203 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2260711193084717
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.580 Test Loss: 2.204 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2464020252227783
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.580 Test Loss: 2.204 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2425787448883057
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.199 Vali Acc: 0.580 Test Loss: 2.199 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3830125331878662
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.580 Test Loss: 2.183 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2058415412902832
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.580 Test Loss: 2.166 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2156951427459717
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.156 Vali Acc: 0.580 Test Loss: 2.156 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1639699935913086
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.580 Test Loss: 2.150 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 69687557
model size : 280.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.835658311843872
Epoch: 1, Steps: 4 | Train Loss: 1.737 Vali Loss: 1.708 Vali Acc: 0.200 Test Loss: 1.708 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.2579872608184814
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.488 Vali Acc: 0.260 Test Loss: 1.488 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.2094087600708008
Epoch: 3, Steps: 4 | Train Loss: 1.148 Vali Loss: 1.436 Vali Acc: 0.420 Test Loss: 1.436 Test Acc: 0.420
Validation loss decreased (-0.259985 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 1.1986415386199951
Epoch: 4, Steps: 4 | Train Loss: 0.995 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9944205284118652
Epoch: 5, Steps: 4 | Train Loss: 0.766 Vali Loss: 1.319 Vali Acc: 0.440 Test Loss: 1.319 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 1.1418161392211914
Epoch: 6, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.468 Vali Acc: 0.520 Test Loss: 1.468 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519985).  Saving model ...
Epoch: 7 cost time: 1.1875026226043701
Epoch: 7, Steps: 4 | Train Loss: 0.249 Vali Loss: 1.406 Vali Acc: 0.460 Test Loss: 1.406 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.143171787261963
Epoch: 8, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.549 Vali Acc: 0.480 Test Loss: 1.549 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1984410285949707
Epoch: 9, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.552 Vali Acc: 0.440 Test Loss: 1.552 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.24595046043396
Epoch: 10, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.672 Vali Acc: 0.500 Test Loss: 1.672 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3382782936096191
Epoch: 11, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.592 Vali Acc: 0.540 Test Loss: 1.592 Test Acc: 0.540
Validation loss decreased (-0.519985 --> -0.539984).  Saving model ...
Epoch: 12 cost time: 1.130293369293213
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.582 Vali Acc: 0.580 Test Loss: 1.582 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579984).  Saving model ...
Epoch: 13 cost time: 1.1925349235534668
Epoch: 13, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.578 Vali Acc: 0.520 Test Loss: 1.578 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0351712703704834
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.463 Vali Acc: 0.560 Test Loss: 1.463 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.233027696609497
Epoch: 15, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.712 Vali Acc: 0.520 Test Loss: 1.712 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0312480926513672
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.245 Vali Acc: 0.520 Test Loss: 2.245 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0472450256347656
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.140 Vali Acc: 0.520 Test Loss: 2.140 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.170865774154663
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.281 Vali Acc: 0.500 Test Loss: 2.281 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8970851898193359
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.272 Vali Acc: 0.500 Test Loss: 2.272 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1283924579620361
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.210 Vali Acc: 0.500 Test Loss: 2.210 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.160752534866333
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.179 Vali Acc: 0.520 Test Loss: 2.179 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3586809635162354
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.171 Vali Acc: 0.520 Test Loss: 2.171 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 69596165
model size : 280.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9319143295288086
Epoch: 1, Steps: 4 | Train Loss: 1.810 Vali Loss: 1.638 Vali Acc: 0.240 Test Loss: 1.638 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.4272716045379639
Epoch: 2, Steps: 4 | Train Loss: 1.537 Vali Loss: 1.539 Vali Acc: 0.320 Test Loss: 1.539 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.4447314739227295
Epoch: 3, Steps: 4 | Train Loss: 1.131 Vali Loss: 1.527 Vali Acc: 0.400 Test Loss: 1.527 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.22066330909729
Epoch: 4, Steps: 4 | Train Loss: 0.756 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.2296783924102783
Epoch: 5, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.429 Vali Acc: 0.360 Test Loss: 1.429 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.265739917755127
Epoch: 6, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.683 Vali Acc: 0.380 Test Loss: 1.683 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2719032764434814
Epoch: 7, Steps: 4 | Train Loss: 0.360 Vali Loss: 1.220 Vali Acc: 0.480 Test Loss: 1.220 Test Acc: 0.480
Validation loss decreased (-0.399987 --> -0.479988).  Saving model ...
Epoch: 8 cost time: 1.4591882228851318
Epoch: 8, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.539 Vali Acc: 0.540 Test Loss: 1.539 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539985).  Saving model ...
Epoch: 9 cost time: 1.1568496227264404
Epoch: 9, Steps: 4 | Train Loss: 0.121 Vali Loss: 2.167 Vali Acc: 0.480 Test Loss: 2.167 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0060937404632568
Epoch: 10, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.628 Vali Acc: 0.540 Test Loss: 1.628 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2360475063323975
Epoch: 11, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.405 Vali Acc: 0.520 Test Loss: 1.405 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.261408805847168
Epoch: 12, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.677 Vali Acc: 0.560 Test Loss: 1.677 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559983).  Saving model ...
Epoch: 13 cost time: 1.2747249603271484
Epoch: 13, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.722 Vali Acc: 0.580 Test Loss: 1.722 Test Acc: 0.580
Validation loss decreased (-0.559983 --> -0.579983).  Saving model ...
Epoch: 14 cost time: 0.9215869903564453
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.722 Vali Acc: 0.520 Test Loss: 1.722 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2831611633300781
Epoch: 15, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.874 Vali Acc: 0.520 Test Loss: 1.874 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2809090614318848
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.864 Vali Acc: 0.580 Test Loss: 1.864 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2094826698303223
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.600 Test Loss: 1.822 Test Acc: 0.600
Validation loss decreased (-0.579983 --> -0.599982).  Saving model ...
Epoch: 18 cost time: 1.1677112579345703
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.902 Vali Acc: 0.560 Test Loss: 1.902 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.187281608581543
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.560 Test Loss: 1.972 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1622297763824463
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.133 Vali Acc: 0.560 Test Loss: 2.133 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0871391296386719
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.261 Vali Acc: 0.540 Test Loss: 2.261 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.07143235206604
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.353 Vali Acc: 0.540 Test Loss: 2.353 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0667767524719238
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.398 Vali Acc: 0.540 Test Loss: 2.398 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1217002868652344
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.406 Vali Acc: 0.540 Test Loss: 2.406 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1290020942687988
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.399 Vali Acc: 0.540 Test Loss: 2.399 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.227971076965332
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.384 Vali Acc: 0.540 Test Loss: 2.384 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2536087036132812
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.355 Vali Acc: 0.540 Test Loss: 2.355 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 72936965
model size : 292.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5460219383239746
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.676 Vali Acc: 0.200 Test Loss: 1.676 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.1450085639953613
Epoch: 2, Steps: 4 | Train Loss: 1.598 Vali Loss: 1.621 Vali Acc: 0.320 Test Loss: 1.621 Test Acc: 0.320
Validation loss decreased (-0.199983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.0872905254364014
Epoch: 3, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.555 Vali Acc: 0.360 Test Loss: 1.555 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.2218830585479736
Epoch: 4, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.350 Vali Acc: 0.420 Test Loss: 1.350 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 1.340073823928833
Epoch: 5, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.321 Vali Acc: 0.460 Test Loss: 1.321 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 6 cost time: 1.209984302520752
Epoch: 6, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.430 Vali Acc: 0.460 Test Loss: 1.430 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.207399606704712
Epoch: 7, Steps: 4 | Train Loss: 0.527 Vali Loss: 1.674 Vali Acc: 0.460 Test Loss: 1.674 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2411153316497803
Epoch: 8, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.656 Vali Acc: 0.400 Test Loss: 1.656 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.243607521057129
Epoch: 9, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.611 Vali Acc: 0.420 Test Loss: 1.611 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.204338550567627
Epoch: 10, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.288 Vali Acc: 0.520 Test Loss: 1.288 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 1.1593122482299805
Epoch: 11, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.492 Vali Acc: 0.540 Test Loss: 1.492 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539985).  Saving model ...
Epoch: 12 cost time: 1.162750005722046
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.485 Vali Acc: 0.540 Test Loss: 1.485 Test Acc: 0.540
Validation loss decreased (-0.539985 --> -0.539985).  Saving model ...
Epoch: 13 cost time: 1.3147687911987305
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.448 Vali Acc: 0.520 Test Loss: 1.448 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1195509433746338
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.480 Test Loss: 1.626 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2720911502838135
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.939 Vali Acc: 0.520 Test Loss: 1.939 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1017613410949707
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.792 Vali Acc: 0.520 Test Loss: 2.792 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.293792963027954
Epoch: 17, Steps: 4 | Train Loss: 0.053 Vali Loss: 2.492 Vali Acc: 0.500 Test Loss: 2.492 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1465201377868652
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.365 Vali Acc: 0.520 Test Loss: 2.365 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0463335514068604
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.498 Vali Acc: 0.560 Test Loss: 2.498 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559975).  Saving model ...
Epoch: 20 cost time: 1.124433994293213
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.449 Vali Acc: 0.560 Test Loss: 2.449 Test Acc: 0.560
Validation loss decreased (-0.559975 --> -0.559976).  Saving model ...
Epoch: 21 cost time: 1.0138933658599854
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.256 Vali Acc: 0.540 Test Loss: 2.256 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.355013132095337
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.241 Vali Acc: 0.500 Test Loss: 2.241 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9130885601043701
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.224 Vali Acc: 0.520 Test Loss: 2.224 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9270598888397217
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.972 Vali Acc: 0.540 Test Loss: 1.972 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0448696613311768
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.101 Vali Acc: 0.500 Test Loss: 2.101 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8472683429718018
Epoch: 26, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.265 Vali Acc: 0.500 Test Loss: 2.265 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0185291767120361
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.504 Vali Acc: 0.500 Test Loss: 2.504 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9005136489868164
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.638 Vali Acc: 0.460 Test Loss: 2.638 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9413712024688721
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.639 Vali Acc: 0.460 Test Loss: 2.639 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9709467887878418
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.551 Vali Acc: 0.460 Test Loss: 2.551 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 72786437
model size : 292.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3468024730682373
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.549 Vali Acc: 0.260 Test Loss: 1.549 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.121929407119751
Epoch: 2, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.548 Vali Acc: 0.260 Test Loss: 1.548 Test Acc: 0.260
Validation loss decreased (-0.259985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 0.9631683826446533
Epoch: 3, Steps: 4 | Train Loss: 1.374 Vali Loss: 1.686 Vali Acc: 0.320 Test Loss: 1.686 Test Acc: 0.320
Validation loss decreased (-0.259985 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 1.2942149639129639
Epoch: 4, Steps: 4 | Train Loss: 1.156 Vali Loss: 1.309 Vali Acc: 0.480 Test Loss: 1.309 Test Acc: 0.480
Validation loss decreased (-0.319983 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 1.251396656036377
Epoch: 5, Steps: 4 | Train Loss: 0.576 Vali Loss: 1.403 Vali Acc: 0.440 Test Loss: 1.403 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0336799621582031
Epoch: 6, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.295 Vali Acc: 0.420 Test Loss: 1.295 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9416506290435791
Epoch: 7, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.233 Vali Acc: 0.500 Test Loss: 1.233 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.0896587371826172
Epoch: 8, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.147 Vali Acc: 0.540 Test Loss: 1.147 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539989).  Saving model ...
Epoch: 9 cost time: 1.013843059539795
Epoch: 9, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.704 Vali Acc: 0.480 Test Loss: 1.704 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0215566158294678
Epoch: 10, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.611 Vali Acc: 0.520 Test Loss: 1.611 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0885708332061768
Epoch: 11, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.418 Vali Acc: 0.560 Test Loss: 1.418 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559986).  Saving model ...
Epoch: 12 cost time: 1.0562593936920166
Epoch: 12, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.489 Vali Acc: 0.520 Test Loss: 1.489 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.961237907409668
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.473 Vali Acc: 0.540 Test Loss: 1.473 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0242955684661865
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.444 Vali Acc: 0.540 Test Loss: 1.444 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0183124542236328
Epoch: 15, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.371 Vali Acc: 0.560 Test Loss: 1.371 Test Acc: 0.560
Validation loss decreased (-0.559986 --> -0.559986).  Saving model ...
Epoch: 16 cost time: 1.021993637084961
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.889 Vali Acc: 0.500 Test Loss: 1.889 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0487797260284424
Epoch: 17, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.742 Vali Acc: 0.520 Test Loss: 1.742 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9143493175506592
Epoch: 18, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.458 Vali Acc: 0.580 Test Loss: 1.458 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579985).  Saving model ...
Epoch: 19 cost time: 1.0642266273498535
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.590 Vali Acc: 0.540 Test Loss: 1.590 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0938713550567627
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.714 Vali Acc: 0.540 Test Loss: 1.714 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0093786716461182
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.784 Vali Acc: 0.560 Test Loss: 1.784 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0696194171905518
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.580 Test Loss: 1.630 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1542046070098877
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.435 Vali Acc: 0.600 Test Loss: 1.435 Test Acc: 0.600
Validation loss decreased (-0.579985 --> -0.599986).  Saving model ...
Epoch: 24 cost time: 1.0728120803833008
Epoch: 24, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.661 Vali Acc: 0.580 Test Loss: 1.661 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1050176620483398
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.560 Test Loss: 1.952 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9309310913085938
Epoch: 26, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.045 Vali Acc: 0.540 Test Loss: 2.045 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9728944301605225
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.996 Vali Acc: 0.560 Test Loss: 1.996 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9435727596282959
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.560 Test Loss: 1.895 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0021946430206299
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.580 Test Loss: 1.817 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0299859046936035
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.580 Test Loss: 1.764 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0434410572052002
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.560 Test Loss: 1.735 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9193518161773682
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.560 Test Loss: 1.739 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0377726554870605
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.600 Test Loss: 1.743 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 72689669
model size : 291.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5628132820129395
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.599 Vali Acc: 0.240 Test Loss: 1.599 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.5695996284484863
Epoch: 2, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.576 Vali Acc: 0.200 Test Loss: 1.576 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3588268756866455
Epoch: 3, Steps: 4 | Train Loss: 1.091 Vali Loss: 1.471 Vali Acc: 0.340 Test Loss: 1.471 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.1519687175750732
Epoch: 4, Steps: 4 | Train Loss: 0.815 Vali Loss: 1.481 Vali Acc: 0.340 Test Loss: 1.481 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9971973896026611
Epoch: 5, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.616 Vali Acc: 0.380 Test Loss: 1.616 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379984).  Saving model ...
Epoch: 6 cost time: 1.3793017864227295
Epoch: 6, Steps: 4 | Train Loss: 0.388 Vali Loss: 1.450 Vali Acc: 0.380 Test Loss: 1.450 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379986).  Saving model ...
Epoch: 7 cost time: 1.313689947128296
Epoch: 7, Steps: 4 | Train Loss: 0.369 Vali Loss: 1.669 Vali Acc: 0.440 Test Loss: 1.669 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439983).  Saving model ...
Epoch: 8 cost time: 1.4014537334442139
Epoch: 8, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.397 Vali Acc: 0.460 Test Loss: 1.397 Test Acc: 0.460
Validation loss decreased (-0.439983 --> -0.459986).  Saving model ...
Epoch: 9 cost time: 1.4136004447937012
Epoch: 9, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.973 Vali Acc: 0.440 Test Loss: 1.973 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4966092109680176
Epoch: 10, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.789 Vali Acc: 0.500 Test Loss: 1.789 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499982).  Saving model ...
Epoch: 11 cost time: 1.1770994663238525
Epoch: 11, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.801 Vali Acc: 0.500 Test Loss: 1.801 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0890986919403076
Epoch: 12, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.824 Vali Acc: 0.440 Test Loss: 1.824 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1839449405670166
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.275 Vali Acc: 0.460 Test Loss: 3.275 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.182447910308838
Epoch: 14, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.777 Vali Acc: 0.520 Test Loss: 1.777 Test Acc: 0.520
Validation loss decreased (-0.499982 --> -0.519982).  Saving model ...
Epoch: 15 cost time: 1.053062915802002
Epoch: 15, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.026 Vali Acc: 0.520 Test Loss: 2.026 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0149445533752441
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.530 Vali Acc: 0.500 Test Loss: 2.530 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1409111022949219
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 3.078 Vali Acc: 0.460 Test Loss: 3.078 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0894622802734375
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.400 Vali Acc: 0.520 Test Loss: 2.400 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1363203525543213
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.560 Test Loss: 1.829 Test Acc: 0.560
Validation loss decreased (-0.519982 --> -0.559982).  Saving model ...
Epoch: 20 cost time: 1.171645164489746
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.580 Test Loss: 1.790 Test Acc: 0.580
Validation loss decreased (-0.559982 --> -0.579982).  Saving model ...
Epoch: 21 cost time: 1.160684585571289
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.540 Test Loss: 1.948 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9926290512084961
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.161 Vali Acc: 0.580 Test Loss: 2.161 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0676906108856201
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.540 Test Loss: 2.225 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1196420192718506
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.347 Vali Acc: 0.540 Test Loss: 2.347 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.113265037536621
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.438 Vali Acc: 0.540 Test Loss: 2.438 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.216949224472046
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.507 Vali Acc: 0.540 Test Loss: 2.507 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.105079174041748
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.576 Vali Acc: 0.540 Test Loss: 2.576 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.269500970840454
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.621 Vali Acc: 0.540 Test Loss: 2.621 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1609995365142822
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.649 Vali Acc: 0.540 Test Loss: 2.649 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3992714881896973
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.666 Vali Acc: 0.540 Test Loss: 2.666 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 76030469
model size : 304.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8740310668945312
Epoch: 1, Steps: 4 | Train Loss: 1.747 Vali Loss: 1.628 Vali Acc: 0.180 Test Loss: 1.628 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.174755573272705
Epoch: 2, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.590 Vali Acc: 0.300 Test Loss: 1.590 Test Acc: 0.300
Validation loss decreased (-0.179984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.1760103702545166
Epoch: 3, Steps: 4 | Train Loss: 1.078 Vali Loss: 1.636 Vali Acc: 0.320 Test Loss: 1.636 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.1331136226654053
Epoch: 4, Steps: 4 | Train Loss: 0.654 Vali Loss: 1.596 Vali Acc: 0.480 Test Loss: 1.596 Test Acc: 0.480
Validation loss decreased (-0.319984 --> -0.479984).  Saving model ...
Epoch: 5 cost time: 1.0642704963684082
Epoch: 5, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.0589029788970947
Epoch: 6, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.320 Vali Acc: 0.460 Test Loss: 1.320 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.051151990890503
Epoch: 7, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.403 Vali Acc: 0.500 Test Loss: 1.403 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9681894779205322
Epoch: 8, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.910 Vali Acc: 0.440 Test Loss: 1.910 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.153548240661621
Epoch: 9, Steps: 4 | Train Loss: 0.133 Vali Loss: 1.374 Vali Acc: 0.460 Test Loss: 1.374 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1117146015167236
Epoch: 10, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.562 Vali Acc: 0.500 Test Loss: 1.562 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9855761528015137
Epoch: 11, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.301 Vali Acc: 0.540 Test Loss: 1.301 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539987).  Saving model ...
Epoch: 12 cost time: 1.0491037368774414
Epoch: 12, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.825 Vali Acc: 0.580 Test Loss: 1.825 Test Acc: 0.580
Validation loss decreased (-0.539987 --> -0.579982).  Saving model ...
Epoch: 13 cost time: 0.8420445919036865
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.305 Vali Acc: 0.520 Test Loss: 2.305 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8550920486450195
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.753 Vali Acc: 0.600 Test Loss: 1.753 Test Acc: 0.600
Validation loss decreased (-0.579982 --> -0.599982).  Saving model ...
Epoch: 15 cost time: 1.013526201248169
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.552 Vali Acc: 0.640 Test Loss: 1.552 Test Acc: 0.640
Validation loss decreased (-0.599982 --> -0.639984).  Saving model ...
Epoch: 16 cost time: 1.0647261142730713
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.692 Vali Acc: 0.640 Test Loss: 1.692 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1367106437683105
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.981 Vali Acc: 0.600 Test Loss: 1.981 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6081321239471436
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.925 Vali Acc: 0.600 Test Loss: 1.925 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5700099468231201
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.784 Vali Acc: 0.600 Test Loss: 1.784 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1896212100982666
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.660 Test Loss: 1.709 Test Acc: 0.660
Validation loss decreased (-0.639984 --> -0.659983).  Saving model ...
Epoch: 21 cost time: 1.1707048416137695
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.660 Test Loss: 1.717 Test Acc: 0.660
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0919647216796875
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.660 Test Loss: 1.748 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2511684894561768
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.660 Test Loss: 1.786 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2550411224365234
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.660 Test Loss: 1.807 Test Acc: 0.660
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.334949016571045
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.660 Test Loss: 1.825 Test Acc: 0.660
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2309026718139648
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.660 Test Loss: 1.838 Test Acc: 0.660
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3294141292572021
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.660 Test Loss: 1.853 Test Acc: 0.660
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.403306484222412
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.660 Test Loss: 1.866 Test Acc: 0.660
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.421109676361084
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.660 Test Loss: 1.880 Test Acc: 0.660
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.545320987701416
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.640 Test Loss: 1.887 Test Acc: 0.640
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 75858437
model size : 304.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8169708251953125
Epoch: 1, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.627 Vali Acc: 0.100 Test Loss: 1.627 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 1.2446367740631104
Epoch: 2, Steps: 4 | Train Loss: 1.594 Vali Loss: 1.510 Vali Acc: 0.320 Test Loss: 1.510 Test Acc: 0.320
Validation loss decreased (-0.099984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.427093744277954
Epoch: 3, Steps: 4 | Train Loss: 1.301 Vali Loss: 1.456 Vali Acc: 0.380 Test Loss: 1.456 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 1.0841469764709473
Epoch: 4, Steps: 4 | Train Loss: 0.648 Vali Loss: 1.369 Vali Acc: 0.440 Test Loss: 1.369 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.4825530052185059
Epoch: 5, Steps: 4 | Train Loss: 0.397 Vali Loss: 1.407 Vali Acc: 0.440 Test Loss: 1.407 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2927441596984863
Epoch: 6, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.349 Vali Acc: 0.420 Test Loss: 1.349 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4876794815063477
Epoch: 7, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.412 Vali Acc: 0.520 Test Loss: 1.412 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519986).  Saving model ...
Epoch: 8 cost time: 1.507472276687622
Epoch: 8, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.295 Vali Acc: 0.460 Test Loss: 1.295 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.350975751876831
Epoch: 9, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.535 Vali Acc: 0.460 Test Loss: 1.535 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4216973781585693
Epoch: 10, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.422 Vali Acc: 0.540 Test Loss: 1.422 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539986).  Saving model ...
Epoch: 11 cost time: 1.3671255111694336
Epoch: 11, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.234 Vali Acc: 0.560 Test Loss: 1.234 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559988).  Saving model ...
Epoch: 12 cost time: 1.3478221893310547
Epoch: 12, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3450407981872559
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.674 Vali Acc: 0.460 Test Loss: 1.674 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1086838245391846
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.039 Vali Acc: 0.420 Test Loss: 2.039 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3219423294067383
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.004 Vali Acc: 0.440 Test Loss: 2.004 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.296356201171875
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.859 Vali Acc: 0.460 Test Loss: 1.859 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0972802639007568
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.703 Vali Acc: 0.520 Test Loss: 1.703 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4350528717041016
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.540 Test Loss: 1.606 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3622922897338867
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.583 Vali Acc: 0.540 Test Loss: 1.583 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2358417510986328
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.520 Test Loss: 1.641 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9654479026794434
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.520 Test Loss: 1.689 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 75783173
model size : 303.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.19940447807312
Epoch: 1, Steps: 4 | Train Loss: 1.841 Vali Loss: 1.654 Vali Acc: 0.120 Test Loss: 1.654 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.4256269931793213
Epoch: 2, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.599 Vali Acc: 0.340 Test Loss: 1.599 Test Acc: 0.340
Validation loss decreased (-0.119983 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.3895399570465088
Epoch: 3, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.663 Vali Acc: 0.400 Test Loss: 1.663 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 1.3278601169586182
Epoch: 4, Steps: 4 | Train Loss: 0.633 Vali Loss: 1.532 Vali Acc: 0.460 Test Loss: 1.532 Test Acc: 0.460
Validation loss decreased (-0.399983 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 1.1968564987182617
Epoch: 5, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.604 Vali Acc: 0.440 Test Loss: 1.604 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1428732872009277
Epoch: 6, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.688 Vali Acc: 0.340 Test Loss: 1.688 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.19688081741333
Epoch: 7, Steps: 4 | Train Loss: 0.180 Vali Loss: 2.036 Vali Acc: 0.420 Test Loss: 2.036 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.190929889678955
Epoch: 8, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.896 Vali Acc: 0.440 Test Loss: 1.896 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2242913246154785
Epoch: 9, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.609 Vali Acc: 0.540 Test Loss: 1.609 Test Acc: 0.540
Validation loss decreased (-0.459985 --> -0.539984).  Saving model ...
Epoch: 10 cost time: 1.273902177810669
Epoch: 10, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.747 Vali Acc: 0.440 Test Loss: 1.747 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2733042240142822
Epoch: 11, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.460 Vali Acc: 0.520 Test Loss: 1.460 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2220776081085205
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 2.145 Vali Acc: 0.480 Test Loss: 2.145 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4185144901275635
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.696 Vali Acc: 0.440 Test Loss: 2.696 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1993756294250488
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.679 Vali Acc: 0.480 Test Loss: 1.679 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9410593509674072
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.054 Vali Acc: 0.560 Test Loss: 2.054 Test Acc: 0.560
Validation loss decreased (-0.539984 --> -0.559979).  Saving model ...
Epoch: 16 cost time: 1.361616611480713
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.547 Vali Acc: 0.460 Test Loss: 2.547 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1679129600524902
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.485 Vali Acc: 0.480 Test Loss: 2.485 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1917335987091064
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.306 Vali Acc: 0.460 Test Loss: 2.306 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2919409275054932
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.099 Vali Acc: 0.480 Test Loss: 2.099 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3440444469451904
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.005 Vali Acc: 0.460 Test Loss: 2.005 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.020557165145874
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.460 Test Loss: 2.006 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.42795729637146
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.048 Vali Acc: 0.480 Test Loss: 2.048 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.353369951248169
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.101 Vali Acc: 0.480 Test Loss: 2.101 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4377024173736572
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.192 Vali Acc: 0.460 Test Loss: 2.192 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3676867485046387
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.227 Vali Acc: 0.480 Test Loss: 2.227 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 79129349
model size : 316.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.784978151321411
Epoch: 1, Steps: 4 | Train Loss: 1.794 Vali Loss: 1.647 Vali Acc: 0.240 Test Loss: 1.647 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.1006159782409668
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.558 Vali Acc: 0.320 Test Loss: 1.558 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 0.9080417156219482
Epoch: 3, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.416 Vali Acc: 0.440 Test Loss: 1.416 Test Acc: 0.440
Validation loss decreased (-0.319984 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 1.0380191802978516
Epoch: 4, Steps: 4 | Train Loss: 0.699 Vali Loss: 1.278 Vali Acc: 0.540 Test Loss: 1.278 Test Acc: 0.540
Validation loss decreased (-0.439986 --> -0.539987).  Saving model ...
Epoch: 5 cost time: 1.1906862258911133
Epoch: 5, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.230 Vali Acc: 0.520 Test Loss: 1.230 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0225093364715576
Epoch: 6, Steps: 4 | Train Loss: 0.373 Vali Loss: 1.457 Vali Acc: 0.460 Test Loss: 1.457 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9729182720184326
Epoch: 7, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.640 Vali Acc: 0.480 Test Loss: 1.640 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1897428035736084
Epoch: 8, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.380 Vali Acc: 0.540 Test Loss: 1.380 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0203850269317627
Epoch: 9, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.128 Vali Acc: 0.460 Test Loss: 2.128 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2753751277923584
Epoch: 10, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.381 Vali Acc: 0.540 Test Loss: 1.381 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3189494609832764
Epoch: 11, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.826 Vali Acc: 0.480 Test Loss: 1.826 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1411941051483154
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.583 Vali Acc: 0.500 Test Loss: 1.583 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1148502826690674
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.720 Vali Acc: 0.480 Test Loss: 1.720 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0383329391479492
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.920 Vali Acc: 0.480 Test Loss: 1.920 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 78957317
model size : 315.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7375171184539795
Epoch: 1, Steps: 4 | Train Loss: 1.734 Vali Loss: 1.641 Vali Acc: 0.200 Test Loss: 1.641 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.074326515197754
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.582 Vali Acc: 0.260 Test Loss: 1.582 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.1152329444885254
Epoch: 3, Steps: 4 | Train Loss: 1.180 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
Validation loss decreased (-0.259984 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.2133171558380127
Epoch: 4, Steps: 4 | Train Loss: 0.793 Vali Loss: 1.432 Vali Acc: 0.320 Test Loss: 1.432 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1053895950317383
Epoch: 5, Steps: 4 | Train Loss: 0.600 Vali Loss: 1.476 Vali Acc: 0.440 Test Loss: 1.476 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439985).  Saving model ...
Epoch: 6 cost time: 1.058457612991333
Epoch: 6, Steps: 4 | Train Loss: 0.412 Vali Loss: 1.325 Vali Acc: 0.460 Test Loss: 1.325 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 1.2638623714447021
Epoch: 7, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.457 Vali Acc: 0.420 Test Loss: 1.457 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1248843669891357
Epoch: 8, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.787 Vali Acc: 0.420 Test Loss: 1.787 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0987915992736816
Epoch: 9, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.678 Vali Acc: 0.400 Test Loss: 1.678 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2607288360595703
Epoch: 10, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.639 Vali Acc: 0.460 Test Loss: 1.639 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1503140926361084
Epoch: 11, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.833 Vali Acc: 0.420 Test Loss: 1.833 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2495708465576172
Epoch: 12, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.626 Vali Acc: 0.460 Test Loss: 1.626 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1687474250793457
Epoch: 13, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.842 Vali Acc: 0.420 Test Loss: 1.842 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1711692810058594
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.794 Vali Acc: 0.420 Test Loss: 1.794 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1033141613006592
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.361 Vali Acc: 0.520 Test Loss: 1.361 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519986).  Saving model ...
Epoch: 16 cost time: 1.1550827026367188
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.357 Vali Acc: 0.480 Test Loss: 1.357 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0787060260772705
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.622 Vali Acc: 0.440 Test Loss: 1.622 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.163637399673462
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.440 Test Loss: 1.789 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1393859386444092
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.721 Vali Acc: 0.480 Test Loss: 1.721 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1296541690826416
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.532 Vali Acc: 0.480 Test Loss: 1.532 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9158248901367188
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.500 Vali Acc: 0.460 Test Loss: 1.500 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1271965503692627
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.480 Test Loss: 1.559 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1258223056793213
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.500 Test Loss: 1.664 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1727423667907715
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.480 Test Loss: 1.705 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1132323741912842
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.460 Test Loss: 1.713 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 78871301
model size : 315.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.0478599071502686
Epoch: 1, Steps: 4 | Train Loss: 1.833 Vali Loss: 1.697 Vali Acc: 0.180 Test Loss: 1.697 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.0686659812927246
Epoch: 2, Steps: 4 | Train Loss: 1.690 Vali Loss: 1.606 Vali Acc: 0.260 Test Loss: 1.606 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 0.8328983783721924
Epoch: 3, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.488 Vali Acc: 0.360 Test Loss: 1.488 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 0.9542732238769531
Epoch: 4, Steps: 4 | Train Loss: 0.669 Vali Loss: 1.487 Vali Acc: 0.440 Test Loss: 1.487 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 1.2201833724975586
Epoch: 5, Steps: 4 | Train Loss: 0.471 Vali Loss: 1.560 Vali Acc: 0.480 Test Loss: 1.560 Test Acc: 0.480
Validation loss decreased (-0.439985 --> -0.479984).  Saving model ...
Epoch: 6 cost time: 1.1716315746307373
Epoch: 6, Steps: 4 | Train Loss: 0.249 Vali Loss: 1.554 Vali Acc: 0.560 Test Loss: 1.554 Test Acc: 0.560
Validation loss decreased (-0.479984 --> -0.559984).  Saving model ...
Epoch: 7 cost time: 1.0998613834381104
Epoch: 7, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.305 Vali Acc: 0.600 Test Loss: 1.305 Test Acc: 0.600
Validation loss decreased (-0.559984 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 1.1828033924102783
Epoch: 8, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.603 Vali Acc: 0.580 Test Loss: 1.603 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8502447605133057
Epoch: 9, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.540 Vali Acc: 0.540 Test Loss: 1.540 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2413184642791748
Epoch: 10, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.696 Vali Acc: 0.560 Test Loss: 1.696 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0827867984771729
Epoch: 11, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.766 Vali Acc: 0.540 Test Loss: 1.766 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1583003997802734
Epoch: 12, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.579 Vali Acc: 0.540 Test Loss: 1.579 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0982937812805176
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.939 Vali Acc: 0.560 Test Loss: 1.939 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1778461933135986
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.783 Vali Acc: 0.580 Test Loss: 1.783 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3742904663085938
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.842 Vali Acc: 0.560 Test Loss: 1.842 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3511388301849365
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.219 Vali Acc: 0.540 Test Loss: 2.219 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5730876922607422
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.496 Vali Acc: 0.460 Test Loss: 2.496 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 82158341
model size : 328.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6429877281188965
Epoch: 1, Steps: 4 | Train Loss: 1.713 Vali Loss: 1.595 Vali Acc: 0.120 Test Loss: 1.595 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.1385226249694824
Epoch: 2, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
Validation loss decreased (-0.119984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.1320788860321045
Epoch: 3, Steps: 4 | Train Loss: 1.208 Vali Loss: 1.506 Vali Acc: 0.320 Test Loss: 1.506 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.11960768699646
Epoch: 4, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.328 Vali Acc: 0.500 Test Loss: 1.328 Test Acc: 0.500
Validation loss decreased (-0.319985 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 1.1266677379608154
Epoch: 5, Steps: 4 | Train Loss: 0.500 Vali Loss: 1.363 Vali Acc: 0.420 Test Loss: 1.363 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2620675563812256
Epoch: 6, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.471 Vali Acc: 0.420 Test Loss: 1.471 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.096484661102295
Epoch: 7, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.326 Vali Acc: 0.440 Test Loss: 1.326 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2472851276397705
Epoch: 8, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.772 Vali Acc: 0.420 Test Loss: 1.772 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.423224687576294
Epoch: 9, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.446249008178711
Epoch: 10, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.428 Vali Acc: 0.460 Test Loss: 1.428 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3591694831848145
Epoch: 11, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.603 Vali Acc: 0.480 Test Loss: 1.603 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2818901538848877
Epoch: 12, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.727 Vali Acc: 0.540 Test Loss: 1.727 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539983).  Saving model ...
Epoch: 13 cost time: 1.2933788299560547
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.502 Vali Acc: 0.520 Test Loss: 1.502 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2105865478515625
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.909 Vali Acc: 0.480 Test Loss: 1.909 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2373898029327393
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.117 Vali Acc: 0.480 Test Loss: 2.117 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3733642101287842
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.814 Vali Acc: 0.520 Test Loss: 1.814 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4985923767089844
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.741 Vali Acc: 0.580 Test Loss: 1.741 Test Acc: 0.580
Validation loss decreased (-0.539983 --> -0.579983).  Saving model ...
Epoch: 18 cost time: 1.1584792137145996
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.796 Vali Acc: 0.540 Test Loss: 1.796 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0739095211029053
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.540 Test Loss: 1.869 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2274765968322754
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.949 Vali Acc: 0.520 Test Loss: 1.949 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8900332450866699
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.998 Vali Acc: 0.560 Test Loss: 1.998 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2296643257141113
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.036 Vali Acc: 0.520 Test Loss: 2.036 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1734552383422852
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.036 Vali Acc: 0.520 Test Loss: 2.036 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2748997211456299
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.025 Vali Acc: 0.500 Test Loss: 2.025 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1204195022583008
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.500 Test Loss: 1.971 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3380155563354492
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.907 Vali Acc: 0.500 Test Loss: 1.907 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1770942211151123
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.500 Test Loss: 1.854 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 82040069
model size : 327.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.495089292526245
Epoch: 1, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.586 Vali Acc: 0.280 Test Loss: 1.586 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.445746898651123
Epoch: 2, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.442 Vali Acc: 0.400 Test Loss: 1.442 Test Acc: 0.400
Validation loss decreased (-0.279984 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 1.3609230518341064
Epoch: 3, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.2255778312683105
Epoch: 4, Steps: 4 | Train Loss: 0.776 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6017999649047852
Epoch: 5, Steps: 4 | Train Loss: 0.653 Vali Loss: 1.311 Vali Acc: 0.380 Test Loss: 1.311 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2659738063812256
Epoch: 6, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.261 Vali Acc: 0.420 Test Loss: 1.261 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419987).  Saving model ...
Epoch: 7 cost time: 1.3107590675354004
Epoch: 7, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.354132890701294
Epoch: 8, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1896612644195557
Epoch: 9, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.419987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.2518441677093506
Epoch: 10, Steps: 4 | Train Loss: 0.412 Vali Loss: 1.795 Vali Acc: 0.400 Test Loss: 1.795 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3540048599243164
Epoch: 11, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.222 Vali Acc: 0.460 Test Loss: 1.222 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5931377410888672
Epoch: 12, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.468 Vali Acc: 0.440 Test Loss: 1.468 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.404559850692749
Epoch: 13, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2934954166412354
Epoch: 14, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.828 Vali Acc: 0.460 Test Loss: 1.828 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2995522022247314
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.054 Vali Acc: 0.440 Test Loss: 2.054 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.319775104522705
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.721 Vali Acc: 0.480 Test Loss: 1.721 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2582955360412598
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3241980075836182
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.624 Vali Acc: 0.480 Test Loss: 1.624 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.309739589691162
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.669 Vali Acc: 0.460 Test Loss: 1.669 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 81964805
model size : 327.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.474013328552246
Epoch: 1, Steps: 4 | Train Loss: 1.745 Vali Loss: 1.611 Vali Acc: 0.260 Test Loss: 1.611 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.191525936126709
Epoch: 2, Steps: 4 | Train Loss: 1.522 Vali Loss: 1.544 Vali Acc: 0.380 Test Loss: 1.544 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.2448525428771973
Epoch: 3, Steps: 4 | Train Loss: 1.175 Vali Loss: 1.478 Vali Acc: 0.380 Test Loss: 1.478 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 1.2997939586639404
Epoch: 4, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.460 Vali Acc: 0.400 Test Loss: 1.460 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.6442186832427979
Epoch: 5, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.417 Vali Acc: 0.380 Test Loss: 1.417 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4996435642242432
Epoch: 6, Steps: 4 | Train Loss: 0.311 Vali Loss: 1.798 Vali Acc: 0.400 Test Loss: 1.798 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4266817569732666
Epoch: 7, Steps: 4 | Train Loss: 0.185 Vali Loss: 1.424 Vali Acc: 0.460 Test Loss: 1.424 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459986).  Saving model ...
Epoch: 8 cost time: 1.2541232109069824
Epoch: 8, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.889 Vali Acc: 0.440 Test Loss: 1.889 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2032780647277832
Epoch: 9, Steps: 4 | Train Loss: 0.059 Vali Loss: 2.225 Vali Acc: 0.440 Test Loss: 2.225 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.203629493713379
Epoch: 10, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.379 Vali Acc: 0.560 Test Loss: 1.379 Test Acc: 0.560
Validation loss decreased (-0.459986 --> -0.559986).  Saving model ...
Epoch: 11 cost time: 1.2756659984588623
Epoch: 11, Steps: 4 | Train Loss: 0.021 Vali Loss: 2.467 Vali Acc: 0.460 Test Loss: 2.467 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2363896369934082
Epoch: 12, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.884 Vali Acc: 0.520 Test Loss: 1.884 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3472917079925537
Epoch: 13, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.930 Vali Acc: 0.480 Test Loss: 1.930 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2102339267730713
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.906 Vali Acc: 0.460 Test Loss: 1.906 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2095658779144287
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.734 Vali Acc: 0.520 Test Loss: 1.734 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3313140869140625
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.661 Vali Acc: 0.520 Test Loss: 1.661 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1751654148101807
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.520 Test Loss: 1.689 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4516656398773193
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.480 Test Loss: 1.758 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4579203128814697
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.520 Test Loss: 1.832 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5677242279052734
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.500 Test Loss: 1.886 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 85257221
model size : 339.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.595438003540039
Epoch: 1, Steps: 4 | Train Loss: 1.771 Vali Loss: 1.684 Vali Acc: 0.180 Test Loss: 1.684 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.1612553596496582
Epoch: 2, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.700 Vali Acc: 0.320 Test Loss: 1.700 Test Acc: 0.320
Validation loss decreased (-0.179983 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 1.1423490047454834
Epoch: 3, Steps: 4 | Train Loss: 1.168 Vali Loss: 1.684 Vali Acc: 0.460 Test Loss: 1.684 Test Acc: 0.460
Validation loss decreased (-0.319983 --> -0.459983).  Saving model ...
Epoch: 4 cost time: 1.0382769107818604
Epoch: 4, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.584 Vali Acc: 0.480 Test Loss: 1.584 Test Acc: 0.480
Validation loss decreased (-0.459983 --> -0.479984).  Saving model ...
Epoch: 5 cost time: 1.1521999835968018
Epoch: 5, Steps: 4 | Train Loss: 0.444 Vali Loss: 1.369 Vali Acc: 0.480 Test Loss: 1.369 Test Acc: 0.480
Validation loss decreased (-0.479984 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.1855955123901367
Epoch: 6, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2392759323120117
Epoch: 7, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.341 Vali Acc: 0.420 Test Loss: 1.341 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.46333909034729
Epoch: 8, Steps: 4 | Train Loss: 0.540 Vali Loss: 2.031 Vali Acc: 0.400 Test Loss: 2.031 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.509606122970581
Epoch: 9, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.786 Vali Acc: 0.360 Test Loss: 1.786 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1253154277801514
Epoch: 10, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.614 Vali Acc: 0.440 Test Loss: 1.614 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2791574001312256
Epoch: 11, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.950 Vali Acc: 0.420 Test Loss: 1.950 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0228824615478516
Epoch: 12, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.663 Vali Acc: 0.500 Test Loss: 1.663 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499983).  Saving model ...
Epoch: 13 cost time: 1.2047631740570068
Epoch: 13, Steps: 4 | Train Loss: 0.041 Vali Loss: 2.138 Vali Acc: 0.460 Test Loss: 2.138 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2439446449279785
Epoch: 14, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.495 Vali Acc: 0.580 Test Loss: 1.495 Test Acc: 0.580
Validation loss decreased (-0.499983 --> -0.579985).  Saving model ...
Epoch: 15 cost time: 1.2712676525115967
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.506 Vali Acc: 0.580 Test Loss: 1.506 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3838748931884766
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.576 Vali Acc: 0.540 Test Loss: 1.576 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5487151145935059
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.615 Vali Acc: 0.580 Test Loss: 1.615 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4663434028625488
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.540 Test Loss: 1.724 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1918129920959473
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.967 Vali Acc: 0.540 Test Loss: 1.967 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1660544872283936
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.115 Vali Acc: 0.520 Test Loss: 2.115 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2965545654296875
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.185 Vali Acc: 0.520 Test Loss: 2.185 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1802444458007812
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.520 Test Loss: 2.165 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1058118343353271
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.093 Vali Acc: 0.540 Test Loss: 2.093 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1626887321472168
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.540 Test Loss: 1.937 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 85138949
model size : 339.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2486371994018555
Epoch: 1, Steps: 4 | Train Loss: 1.728 Vali Loss: 1.630 Vali Acc: 0.140 Test Loss: 1.630 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.0132975578308105
Epoch: 2, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.536 Vali Acc: 0.360 Test Loss: 1.536 Test Acc: 0.360
Validation loss decreased (-0.139984 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.17911958694458
Epoch: 3, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.470 Vali Acc: 0.360 Test Loss: 1.470 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.145064353942871
Epoch: 4, Steps: 4 | Train Loss: 0.897 Vali Loss: 1.451 Vali Acc: 0.400 Test Loss: 1.451 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.0339977741241455
Epoch: 5, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.123633623123169
Epoch: 6, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.251 Vali Acc: 0.480 Test Loss: 1.251 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 1.4582593441009521
Epoch: 7, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.254 Vali Acc: 0.480 Test Loss: 1.254 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4537978172302246
Epoch: 8, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.4404182434082031
Epoch: 9, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.123 Vali Acc: 0.520 Test Loss: 1.123 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519989).  Saving model ...
Epoch: 10 cost time: 1.1896545886993408
Epoch: 10, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.358 Vali Acc: 0.480 Test Loss: 1.358 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0693433284759521
Epoch: 11, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.195 Vali Acc: 0.480 Test Loss: 1.195 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0595710277557373
Epoch: 12, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.253 Vali Acc: 0.560 Test Loss: 1.253 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 1.0828473567962646
Epoch: 13, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.099714756011963
Epoch: 14, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.989 Vali Acc: 0.460 Test Loss: 1.989 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1228702068328857
Epoch: 15, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.540 Vali Acc: 0.540 Test Loss: 1.540 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0364654064178467
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.362 Vali Acc: 0.560 Test Loss: 1.362 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9451637268066406
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.518 Vali Acc: 0.520 Test Loss: 1.518 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0947511196136475
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.632 Vali Acc: 0.500 Test Loss: 1.632 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1419122219085693
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.520 Test Loss: 1.622 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1377546787261963
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.560 Test Loss: 1.626 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9669628143310547
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.645 Vali Acc: 0.540 Test Loss: 1.645 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0887491703033447
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.659 Vali Acc: 0.540 Test Loss: 1.659 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 85063685
model size : 339.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4214699268341064
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.5417845249176025
Epoch: 2, Steps: 4 | Train Loss: 1.460 Vali Loss: 1.531 Vali Acc: 0.380 Test Loss: 1.531 Test Acc: 0.380
Validation loss decreased (-0.239984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.3518762588500977
Epoch: 3, Steps: 4 | Train Loss: 1.091 Vali Loss: 1.285 Vali Acc: 0.480 Test Loss: 1.285 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479987).  Saving model ...
Epoch: 4 cost time: 1.2040233612060547
Epoch: 4, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9874413013458252
Epoch: 5, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.686 Vali Acc: 0.420 Test Loss: 1.686 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.086453914642334
Epoch: 6, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.441 Vali Acc: 0.480 Test Loss: 1.441 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3184568881988525
Epoch: 7, Steps: 4 | Train Loss: 0.605 Vali Loss: 1.357 Vali Acc: 0.420 Test Loss: 1.357 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.426137924194336
Epoch: 8, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.685 Vali Acc: 0.520 Test Loss: 1.685 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519983).  Saving model ...
Epoch: 9 cost time: 1.3105518817901611
Epoch: 9, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.590 Vali Acc: 0.480 Test Loss: 1.590 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0007591247558594
Epoch: 10, Steps: 4 | Train Loss: 0.199 Vali Loss: 2.090 Vali Acc: 0.520 Test Loss: 2.090 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4988048076629639
Epoch: 11, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.265733242034912
Epoch: 12, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.403 Vali Acc: 0.500 Test Loss: 1.403 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.239316463470459
Epoch: 13, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.616 Vali Acc: 0.460 Test Loss: 1.616 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3216030597686768
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.413 Vali Acc: 0.520 Test Loss: 2.413 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4831275939941406
Epoch: 15, Steps: 4 | Train Loss: 0.050 Vali Loss: 2.781 Vali Acc: 0.500 Test Loss: 2.781 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2201879024505615
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.798 Vali Acc: 0.520 Test Loss: 1.798 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3104503154754639
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.620 Vali Acc: 0.520 Test Loss: 1.620 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519984).  Saving model ...
Epoch: 18 cost time: 1.105193853378296
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.312 Vali Acc: 0.540 Test Loss: 2.312 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539977).  Saving model ...
Epoch: 19 cost time: 1.2920200824737549
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.587 Vali Acc: 0.520 Test Loss: 2.587 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2936296463012695
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.520 Test Loss: 2.711 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.444157600402832
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.816 Vali Acc: 0.520 Test Loss: 2.816 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4639742374420166
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.789 Vali Acc: 0.520 Test Loss: 2.789 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.275486707687378
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.658 Vali Acc: 0.520 Test Loss: 2.658 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.14029860496521
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.340 Vali Acc: 0.540 Test Loss: 2.340 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2952182292938232
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.091 Vali Acc: 0.560 Test Loss: 2.091 Test Acc: 0.560
Validation loss decreased (-0.539977 --> -0.559979).  Saving model ...
Epoch: 26 cost time: 1.2129101753234863
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.580 Test Loss: 1.931 Test Acc: 0.580
Validation loss decreased (-0.559979 --> -0.579981).  Saving model ...
Epoch: 27 cost time: 1.1507129669189453
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.600 Test Loss: 1.857 Test Acc: 0.600
Validation loss decreased (-0.579981 --> -0.599981).  Saving model ...
Epoch: 28 cost time: 1.1741700172424316
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.600 Test Loss: 1.839 Test Acc: 0.600
Validation loss decreased (-0.599981 --> -0.599982).  Saving model ...
Epoch: 29 cost time: 1.2078042030334473
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.580 Test Loss: 1.851 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9614396095275879
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.872 Vali Acc: 0.580 Test Loss: 1.872 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2657041549682617
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.580 Test Loss: 1.897 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.080979585647583
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.580 Test Loss: 1.927 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.087505578994751
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.580 Test Loss: 1.977 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2435555458068848
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.014 Vali Acc: 0.580 Test Loss: 2.014 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1498932838439941
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.054 Vali Acc: 0.580 Test Loss: 2.054 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.613691806793213
Epoch: 36, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.580 Test Loss: 2.098 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5805344581604004
Epoch: 37, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.560 Test Loss: 2.132 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.3351993560791016
Epoch: 38, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.560 Test Loss: 2.158 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 91454981
model size : 363.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.548215389251709
Epoch: 1, Steps: 4 | Train Loss: 1.771 Vali Loss: 1.659 Vali Acc: 0.200 Test Loss: 1.659 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3010101318359375
Epoch: 2, Steps: 4 | Train Loss: 1.440 Vali Loss: 1.471 Vali Acc: 0.300 Test Loss: 1.471 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.566070318222046
Epoch: 3, Steps: 4 | Train Loss: 0.877 Vali Loss: 1.352 Vali Acc: 0.340 Test Loss: 1.352 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339986).  Saving model ...
Epoch: 4 cost time: 1.0805153846740723
Epoch: 4, Steps: 4 | Train Loss: 0.599 Vali Loss: 1.406 Vali Acc: 0.460 Test Loss: 1.406 Test Acc: 0.460
Validation loss decreased (-0.339986 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.1597416400909424
Epoch: 5, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.440 Vali Acc: 0.420 Test Loss: 1.440 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0731000900268555
Epoch: 6, Steps: 4 | Train Loss: 0.379 Vali Loss: 1.233 Vali Acc: 0.460 Test Loss: 1.233 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459988).  Saving model ...
Epoch: 7 cost time: 1.151167869567871
Epoch: 7, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.413 Vali Acc: 0.440 Test Loss: 1.413 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2134945392608643
Epoch: 8, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.469 Vali Acc: 0.420 Test Loss: 1.469 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9987096786499023
Epoch: 9, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.946129560470581
Epoch: 10, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.669 Vali Acc: 0.480 Test Loss: 1.669 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.064535140991211
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.786 Vali Acc: 0.520 Test Loss: 1.786 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519982).  Saving model ...
Epoch: 12 cost time: 1.3718278408050537
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.510 Vali Acc: 0.520 Test Loss: 1.510 Test Acc: 0.520
Validation loss decreased (-0.519982 --> -0.519985).  Saving model ...
Epoch: 13 cost time: 1.1979210376739502
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.255 Vali Acc: 0.560 Test Loss: 1.255 Test Acc: 0.560
Validation loss decreased (-0.519985 --> -0.559987).  Saving model ...
Epoch: 14 cost time: 1.2739179134368896
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.236 Vali Acc: 0.500 Test Loss: 2.236 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4414150714874268
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.313 Vali Acc: 0.480 Test Loss: 2.313 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4634761810302734
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.609 Vali Acc: 0.500 Test Loss: 1.609 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2516579627990723
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.648 Vali Acc: 0.520 Test Loss: 1.648 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0998294353485107
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.844 Vali Acc: 0.480 Test Loss: 1.844 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0908043384552002
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.004 Vali Acc: 0.480 Test Loss: 2.004 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0407323837280273
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.021 Vali Acc: 0.520 Test Loss: 2.021 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1859796047210693
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.994 Vali Acc: 0.540 Test Loss: 1.994 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.083369493484497
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.540 Test Loss: 1.935 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9620928764343262
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.540 Test Loss: 1.865 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 91320581
model size : 363.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5920751094818115
Epoch: 1, Steps: 4 | Train Loss: 1.732 Vali Loss: 1.694 Vali Acc: 0.140 Test Loss: 1.694 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.4764189720153809
Epoch: 2, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.611 Vali Acc: 0.260 Test Loss: 1.611 Test Acc: 0.260
Validation loss decreased (-0.139983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.5139186382293701
Epoch: 3, Steps: 4 | Train Loss: 1.059 Vali Loss: 1.548 Vali Acc: 0.300 Test Loss: 1.548 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.33907151222229
Epoch: 4, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.361 Vali Acc: 0.440 Test Loss: 1.361 Test Acc: 0.440
Validation loss decreased (-0.299985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.216102123260498
Epoch: 5, Steps: 4 | Train Loss: 0.521 Vali Loss: 1.347 Vali Acc: 0.440 Test Loss: 1.347 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 1.069735050201416
Epoch: 6, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2069687843322754
Epoch: 7, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.279 Vali Acc: 0.420 Test Loss: 1.279 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2983953952789307
Epoch: 8, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.541 Vali Acc: 0.400 Test Loss: 1.541 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.265425682067871
Epoch: 9, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.238 Vali Acc: 0.520 Test Loss: 1.238 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 1.4265515804290771
Epoch: 10, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.418 Vali Acc: 0.480 Test Loss: 1.418 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.414067268371582
Epoch: 11, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.735 Vali Acc: 0.420 Test Loss: 1.735 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4998090267181396
Epoch: 12, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.609 Vali Acc: 0.440 Test Loss: 1.609 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5043690204620361
Epoch: 13, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.502 Vali Acc: 0.440 Test Loss: 1.502 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5838649272918701
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.846 Vali Acc: 0.440 Test Loss: 1.846 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5437943935394287
Epoch: 15, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.849 Vali Acc: 0.420 Test Loss: 1.849 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4899928569793701
Epoch: 16, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.662 Vali Acc: 0.520 Test Loss: 1.662 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3381001949310303
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.741 Vali Acc: 0.540 Test Loss: 1.741 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539983).  Saving model ...
Epoch: 18 cost time: 1.1407408714294434
Epoch: 18, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.762 Vali Acc: 0.500 Test Loss: 1.762 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1194343566894531
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.743 Vali Acc: 0.520 Test Loss: 1.743 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0390162467956543
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.899 Vali Acc: 0.480 Test Loss: 1.899 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1113829612731934
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.001 Vali Acc: 0.480 Test Loss: 2.001 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1195998191833496
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.052 Vali Acc: 0.480 Test Loss: 2.052 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1639559268951416
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.100 Vali Acc: 0.440 Test Loss: 2.100 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1544780731201172
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.089 Vali Acc: 0.440 Test Loss: 2.089 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1051714420318604
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.147 Vali Acc: 0.440 Test Loss: 2.147 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1094555854797363
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.143 Vali Acc: 0.460 Test Loss: 2.143 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9439725875854492
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.480 Test Loss: 2.141 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 91250693
model size : 362.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8824269771575928
Epoch: 1, Steps: 4 | Train Loss: 1.809 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.0950543880462646
Epoch: 2, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.679 Vali Acc: 0.320 Test Loss: 1.679 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 1.0810697078704834
Epoch: 3, Steps: 4 | Train Loss: 1.390 Vali Loss: 1.553 Vali Acc: 0.460 Test Loss: 1.553 Test Acc: 0.460
Validation loss decreased (-0.319983 --> -0.459984).  Saving model ...
Epoch: 4 cost time: 1.3759610652923584
Epoch: 4, Steps: 4 | Train Loss: 0.951 Vali Loss: 1.456 Vali Acc: 0.460 Test Loss: 1.456 Test Acc: 0.460
Validation loss decreased (-0.459984 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 1.3108711242675781
Epoch: 5, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.318 Vali Acc: 0.540 Test Loss: 1.318 Test Acc: 0.540
Validation loss decreased (-0.459985 --> -0.539987).  Saving model ...
Epoch: 6 cost time: 1.4072229862213135
Epoch: 6, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.310 Vali Acc: 0.520 Test Loss: 1.310 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2438116073608398
Epoch: 7, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.421 Vali Acc: 0.480 Test Loss: 1.421 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2861545085906982
Epoch: 8, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.282 Vali Acc: 0.500 Test Loss: 1.282 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9603383541107178
Epoch: 9, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.683 Vali Acc: 0.480 Test Loss: 1.683 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2426018714904785
Epoch: 10, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.345 Vali Acc: 0.460 Test Loss: 1.345 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2560005187988281
Epoch: 11, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.713 Vali Acc: 0.540 Test Loss: 1.713 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2342498302459717
Epoch: 12, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.711 Vali Acc: 0.480 Test Loss: 1.711 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9678845405578613
Epoch: 13, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.518 Vali Acc: 0.480 Test Loss: 1.518 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2332768440246582
Epoch: 14, Steps: 4 | Train Loss: 0.096 Vali Loss: 2.675 Vali Acc: 0.500 Test Loss: 2.675 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.250474452972412
Epoch: 15, Steps: 4 | Train Loss: 0.079 Vali Loss: 2.028 Vali Acc: 0.580 Test Loss: 2.028 Test Acc: 0.580
Validation loss decreased (-0.539987 --> -0.579980).  Saving model ...
Epoch: 16 cost time: 1.3760578632354736
Epoch: 16, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.513 Vali Acc: 0.620 Test Loss: 1.513 Test Acc: 0.620
Validation loss decreased (-0.579980 --> -0.619985).  Saving model ...
Epoch: 17 cost time: 1.349867820739746
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.972 Vali Acc: 0.540 Test Loss: 1.972 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.028439998626709
Epoch: 18, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.024 Vali Acc: 0.480 Test Loss: 2.024 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3549482822418213
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.167 Vali Acc: 0.480 Test Loss: 2.167 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3168091773986816
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.423 Vali Acc: 0.440 Test Loss: 2.423 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4200315475463867
Epoch: 21, Steps: 4 | Train Loss: 0.014 Vali Loss: 2.526 Vali Acc: 0.440 Test Loss: 2.526 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4554073810577393
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.694 Vali Acc: 0.440 Test Loss: 2.694 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4108130931854248
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.791 Vali Acc: 0.440 Test Loss: 2.791 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.544970989227295
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.400 Test Loss: 2.812 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3965823650360107
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.715 Vali Acc: 0.420 Test Loss: 2.715 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0191075801849365
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.621 Vali Acc: 0.460 Test Loss: 2.621 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 94505477
model size : 375.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7132437229156494
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.649 Vali Acc: 0.140 Test Loss: 1.649 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.2939448356628418
Epoch: 2, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.700 Vali Acc: 0.260 Test Loss: 1.700 Test Acc: 0.260
Validation loss decreased (-0.139984 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.1823949813842773
Epoch: 3, Steps: 4 | Train Loss: 1.188 Vali Loss: 1.622 Vali Acc: 0.300 Test Loss: 1.622 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.3657505512237549
Epoch: 4, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.480 Vali Acc: 0.360 Test Loss: 1.480 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 1.4786131381988525
Epoch: 5, Steps: 4 | Train Loss: 0.628 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.589944839477539
Epoch: 6, Steps: 4 | Train Loss: 0.364 Vali Loss: 1.281 Vali Acc: 0.360 Test Loss: 1.281 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9384915828704834
Epoch: 7, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.535 Vali Acc: 0.400 Test Loss: 1.535 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6230051517486572
Epoch: 8, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.499 Vali Acc: 0.380 Test Loss: 1.499 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2667946815490723
Epoch: 9, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.641 Vali Acc: 0.360 Test Loss: 1.641 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4497919082641602
Epoch: 10, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.349 Vali Acc: 0.360 Test Loss: 1.349 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3856251239776611
Epoch: 11, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.952 Vali Acc: 0.420 Test Loss: 1.952 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419980).  Saving model ...
Epoch: 12 cost time: 1.0073771476745605
Epoch: 12, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.506 Vali Acc: 0.480 Test Loss: 1.506 Test Acc: 0.480
Validation loss decreased (-0.419980 --> -0.479985).  Saving model ...
Epoch: 13 cost time: 1.5247793197631836
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.323 Vali Acc: 0.480 Test Loss: 1.323 Test Acc: 0.480
Validation loss decreased (-0.479985 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.4669444561004639
Epoch: 14, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.653 Vali Acc: 0.520 Test Loss: 1.653 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519983).  Saving model ...
Epoch: 15 cost time: 1.6090869903564453
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.477 Vali Acc: 0.560 Test Loss: 1.477 Test Acc: 0.560
Validation loss decreased (-0.519983 --> -0.559985).  Saving model ...
Epoch: 16 cost time: 1.4570364952087402
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.671 Vali Acc: 0.480 Test Loss: 1.671 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1290500164031982
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.922 Vali Acc: 0.460 Test Loss: 1.922 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2811377048492432
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.977 Vali Acc: 0.460 Test Loss: 1.977 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.362037181854248
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.692 Vali Acc: 0.500 Test Loss: 1.692 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.318312406539917
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.681 Vali Acc: 0.500 Test Loss: 1.681 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.322573184967041
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.949 Vali Acc: 0.460 Test Loss: 1.949 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3010919094085693
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.141 Vali Acc: 0.460 Test Loss: 2.141 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3801820278167725
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.294 Vali Acc: 0.460 Test Loss: 2.294 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4275927543640137
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.396 Vali Acc: 0.460 Test Loss: 2.396 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5107109546661377
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.424 Vali Acc: 0.440 Test Loss: 2.424 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 94403333
model size : 374.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0822815895080566
Epoch: 1, Steps: 4 | Train Loss: 1.718 Vali Loss: 1.616 Vali Acc: 0.180 Test Loss: 1.616 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.3226361274719238
Epoch: 2, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.635 Vali Acc: 0.220 Test Loss: 1.635 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.4701766967773438
Epoch: 3, Steps: 4 | Train Loss: 1.126 Vali Loss: 1.538 Vali Acc: 0.300 Test Loss: 1.538 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.382397174835205
Epoch: 4, Steps: 4 | Train Loss: 0.992 Vali Loss: 1.415 Vali Acc: 0.460 Test Loss: 1.415 Test Acc: 0.460
Validation loss decreased (-0.299985 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.1068010330200195
Epoch: 5, Steps: 4 | Train Loss: 0.621 Vali Loss: 1.464 Vali Acc: 0.440 Test Loss: 1.464 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2867431640625
Epoch: 6, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.440 Vali Acc: 0.420 Test Loss: 1.440 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3380520343780518
Epoch: 7, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.341 Vali Acc: 0.540 Test Loss: 1.341 Test Acc: 0.540
Validation loss decreased (-0.459986 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 1.5782225131988525
Epoch: 8, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.455 Vali Acc: 0.460 Test Loss: 1.455 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3095834255218506
Epoch: 9, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.334 Vali Acc: 0.440 Test Loss: 1.334 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3458309173583984
Epoch: 10, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.428 Vali Acc: 0.480 Test Loss: 1.428 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3829214572906494
Epoch: 11, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.583 Vali Acc: 0.400 Test Loss: 1.583 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4859261512756348
Epoch: 12, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.315 Vali Acc: 0.460 Test Loss: 1.315 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2878363132476807
Epoch: 13, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.933 Vali Acc: 0.400 Test Loss: 1.933 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2886230945587158
Epoch: 14, Steps: 4 | Train Loss: 0.068 Vali Loss: 2.107 Vali Acc: 0.440 Test Loss: 2.107 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5537233352661133
Epoch: 15, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.447 Vali Acc: 0.500 Test Loss: 1.447 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.33087158203125
Epoch: 16, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.036 Vali Acc: 0.440 Test Loss: 2.036 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3497800827026367
Epoch: 17, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.785 Vali Acc: 0.460 Test Loss: 1.785 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 94344197
model size : 374.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.560206651687622
Epoch: 1, Steps: 4 | Train Loss: 1.857 Vali Loss: 1.614 Vali Acc: 0.200 Test Loss: 1.614 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2862486839294434
Epoch: 2, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.551 Vali Acc: 0.360 Test Loss: 1.551 Test Acc: 0.360
Validation loss decreased (-0.199984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 1.2056665420532227
Epoch: 3, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.510 Vali Acc: 0.320 Test Loss: 1.510 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3979415893554688
Epoch: 4, Steps: 4 | Train Loss: 0.793 Vali Loss: 1.434 Vali Acc: 0.420 Test Loss: 1.434 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 1.3843603134155273
Epoch: 5, Steps: 4 | Train Loss: 0.830 Vali Loss: 1.578 Vali Acc: 0.400 Test Loss: 1.578 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.009244441986084
Epoch: 6, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.486 Vali Acc: 0.420 Test Loss: 1.486 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4323022365570068
Epoch: 7, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.690 Vali Acc: 0.500 Test Loss: 1.690 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499983).  Saving model ...
Epoch: 8 cost time: 1.222184181213379
Epoch: 8, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.618 Vali Acc: 0.480 Test Loss: 1.618 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.367894172668457
Epoch: 9, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.409 Vali Acc: 0.560 Test Loss: 1.409 Test Acc: 0.560
Validation loss decreased (-0.499983 --> -0.559986).  Saving model ...
Epoch: 10 cost time: 1.2910032272338867
Epoch: 10, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.150 Vali Acc: 0.460 Test Loss: 2.150 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.412853479385376
Epoch: 11, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5660045146942139
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.759 Vali Acc: 0.520 Test Loss: 1.759 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7472295761108398
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.005 Vali Acc: 0.520 Test Loss: 2.005 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.683229684829712
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.147 Vali Acc: 0.500 Test Loss: 2.147 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5492544174194336
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.629 Vali Acc: 0.460 Test Loss: 2.629 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5395722389221191
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.754 Vali Acc: 0.460 Test Loss: 2.754 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4465928077697754
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.539 Vali Acc: 0.500 Test Loss: 2.539 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3415226936340332
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.211 Vali Acc: 0.520 Test Loss: 2.211 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4335458278656006
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.085 Vali Acc: 0.520 Test Loss: 2.085 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 100703237
model size : 398.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.641169548034668
Epoch: 1, Steps: 4 | Train Loss: 1.748 Vali Loss: 1.621 Vali Acc: 0.260 Test Loss: 1.621 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3040094375610352
Epoch: 2, Steps: 4 | Train Loss: 1.474 Vali Loss: 1.767 Vali Acc: 0.260 Test Loss: 1.767 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4225270748138428
Epoch: 3, Steps: 4 | Train Loss: 1.160 Vali Loss: 1.708 Vali Acc: 0.260 Test Loss: 1.708 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.418708086013794
Epoch: 4, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.485 Vali Acc: 0.340 Test Loss: 1.485 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.225947380065918
Epoch: 5, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.460 Vali Acc: 0.420 Test Loss: 1.460 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.283776044845581
Epoch: 6, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.635 Vali Acc: 0.400 Test Loss: 1.635 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1190252304077148
Epoch: 7, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.434 Vali Acc: 0.340 Test Loss: 1.434 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.299555778503418
Epoch: 8, Steps: 4 | Train Loss: 0.305 Vali Loss: 1.725 Vali Acc: 0.400 Test Loss: 1.725 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3974218368530273
Epoch: 9, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.577 Vali Acc: 0.420 Test Loss: 1.577 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4271023273468018
Epoch: 10, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.492 Vali Acc: 0.460 Test Loss: 1.492 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459985).  Saving model ...
Epoch: 11 cost time: 1.3133113384246826
Epoch: 11, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.541 Vali Acc: 0.500 Test Loss: 1.541 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499985).  Saving model ...
Epoch: 12 cost time: 1.462740182876587
Epoch: 12, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.550 Vali Acc: 0.480 Test Loss: 1.550 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2860143184661865
Epoch: 13, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.515 Vali Acc: 0.500 Test Loss: 1.515 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 14 cost time: 1.265772819519043
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.670 Vali Acc: 0.520 Test Loss: 1.670 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519983).  Saving model ...
Epoch: 15 cost time: 1.4512927532196045
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.089 Vali Acc: 0.460 Test Loss: 2.089 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3975608348846436
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.087 Vali Acc: 0.440 Test Loss: 2.087 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4957807064056396
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.779 Vali Acc: 0.540 Test Loss: 1.779 Test Acc: 0.540
Validation loss decreased (-0.519983 --> -0.539982).  Saving model ...
Epoch: 18 cost time: 1.4032013416290283
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.635 Vali Acc: 0.520 Test Loss: 1.635 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3489880561828613
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.540 Test Loss: 1.608 Test Acc: 0.540
Validation loss decreased (-0.539982 --> -0.539984).  Saving model ...
Epoch: 20 cost time: 1.3882570266723633
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.540 Test Loss: 1.612 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1812074184417725
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.580 Test Loss: 1.651 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579983).  Saving model ...
Epoch: 22 cost time: 1.2842881679534912
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.560 Test Loss: 1.722 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1880812644958496
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.560 Test Loss: 1.835 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.243635654449463
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.540 Test Loss: 1.916 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1824390888214111
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.540 Test Loss: 1.942 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2843143939971924
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.560 Test Loss: 1.931 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1579132080078125
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.580 Test Loss: 1.908 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.365936040878296
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.580 Test Loss: 1.887 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4901604652404785
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.580 Test Loss: 1.869 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0006592273712158
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.580 Test Loss: 1.858 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0498855113983154
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.867 Vali Acc: 0.580 Test Loss: 1.867 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 100590341
model size : 398.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.864183187484741
Epoch: 1, Steps: 4 | Train Loss: 1.710 Vali Loss: 1.644 Vali Acc: 0.280 Test Loss: 1.644 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.3155508041381836
Epoch: 2, Steps: 4 | Train Loss: 1.583 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
Validation loss decreased (-0.279984 --> -0.419985).  Saving model ...
Epoch: 3 cost time: 1.2777080535888672
Epoch: 3, Steps: 4 | Train Loss: 1.103 Vali Loss: 1.438 Vali Acc: 0.360 Test Loss: 1.438 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.460007667541504
Epoch: 4, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.349 Vali Acc: 0.420 Test Loss: 1.349 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419987).  Saving model ...
Epoch: 5 cost time: 1.2840895652770996
Epoch: 5, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.391 Vali Acc: 0.340 Test Loss: 1.391 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5126261711120605
Epoch: 6, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.339 Vali Acc: 0.460 Test Loss: 1.339 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 1.370436429977417
Epoch: 7, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.4884397983551025
Epoch: 8, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.331 Vali Acc: 0.440 Test Loss: 1.331 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.395399808883667
Epoch: 9, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.248 Vali Acc: 0.480 Test Loss: 1.248 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4607923030853271
Epoch: 10, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.600 Vali Acc: 0.440 Test Loss: 1.600 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7905519008636475
Epoch: 11, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.575 Vali Acc: 0.460 Test Loss: 1.575 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.741410255432129
Epoch: 12, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.376 Vali Acc: 0.460 Test Loss: 1.376 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4601287841796875
Epoch: 13, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5492734909057617
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.707 Vali Acc: 0.480 Test Loss: 1.707 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4831995964050293
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.111 Vali Acc: 0.440 Test Loss: 2.111 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.491612434387207
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.060 Vali Acc: 0.440 Test Loss: 2.060 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4412963390350342
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.767 Vali Acc: 0.460 Test Loss: 1.767 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 100536581
model size : 398.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.130545139312744
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.665 Vali Acc: 0.260 Test Loss: 1.665 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.5625591278076172
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.559 Vali Acc: 0.240 Test Loss: 1.559 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.421473503112793
Epoch: 3, Steps: 4 | Train Loss: 1.136 Vali Loss: 1.412 Vali Acc: 0.320 Test Loss: 1.412 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319986).  Saving model ...
Epoch: 4 cost time: 1.3306849002838135
Epoch: 4, Steps: 4 | Train Loss: 0.618 Vali Loss: 1.346 Vali Acc: 0.340 Test Loss: 1.346 Test Acc: 0.340
Validation loss decreased (-0.319986 --> -0.339987).  Saving model ...
Epoch: 5 cost time: 1.5153148174285889
Epoch: 5, Steps: 4 | Train Loss: 0.433 Vali Loss: 1.320 Vali Acc: 0.440 Test Loss: 1.320 Test Acc: 0.440
Validation loss decreased (-0.339987 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 1.6151692867279053
Epoch: 6, Steps: 4 | Train Loss: 0.344 Vali Loss: 1.195 Vali Acc: 0.480 Test Loss: 1.195 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479988).  Saving model ...
Epoch: 7 cost time: 1.3803603649139404
Epoch: 7, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.389 Vali Acc: 0.480 Test Loss: 1.389 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4045023918151855
Epoch: 8, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.597 Vali Acc: 0.440 Test Loss: 1.597 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.535919427871704
Epoch: 9, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.462 Vali Acc: 0.540 Test Loss: 1.462 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539985).  Saving model ...
Epoch: 10 cost time: 1.3886504173278809
Epoch: 10, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.930 Vali Acc: 0.540 Test Loss: 1.930 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3176257610321045
Epoch: 11, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.709 Vali Acc: 0.560 Test Loss: 1.709 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559983).  Saving model ...
Epoch: 12 cost time: 1.1331911087036133
Epoch: 12, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.721 Vali Acc: 0.500 Test Loss: 1.721 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3237786293029785
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.684 Vali Acc: 0.520 Test Loss: 1.684 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2592182159423828
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.682 Vali Acc: 0.580 Test Loss: 1.682 Test Acc: 0.580
Validation loss decreased (-0.559983 --> -0.579983).  Saving model ...
Epoch: 15 cost time: 1.541924238204956
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.978 Vali Acc: 0.540 Test Loss: 1.978 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3176696300506592
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.277 Vali Acc: 0.520 Test Loss: 2.277 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.452322006225586
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.428 Vali Acc: 0.520 Test Loss: 2.428 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.608952283859253
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.444 Vali Acc: 0.520 Test Loss: 2.444 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2851836681365967
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.348 Vali Acc: 0.520 Test Loss: 2.348 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.421734094619751
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.540 Test Loss: 2.271 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1182584762573242
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.194 Vali Acc: 0.540 Test Loss: 2.194 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4514360427856445
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.161 Vali Acc: 0.540 Test Loss: 2.161 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.304136037826538
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.540 Test Loss: 2.173 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.303135871887207
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.186 Vali Acc: 0.540 Test Loss: 2.186 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 106868741
model size : 422.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6851377487182617
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.3278100490570068
Epoch: 2, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.575 Vali Acc: 0.340 Test Loss: 1.575 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.5022072792053223
Epoch: 3, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.565 Vali Acc: 0.380 Test Loss: 1.565 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 1.770923376083374
Epoch: 4, Steps: 4 | Train Loss: 0.921 Vali Loss: 1.569 Vali Acc: 0.400 Test Loss: 1.569 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.603898525238037
Epoch: 5, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.484 Vali Acc: 0.440 Test Loss: 1.484 Test Acc: 0.440
Validation loss decreased (-0.399984 --> -0.439985).  Saving model ...
Epoch: 6 cost time: 1.5432696342468262
Epoch: 6, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.677 Vali Acc: 0.360 Test Loss: 1.677 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7976844310760498
Epoch: 7, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.614 Vali Acc: 0.420 Test Loss: 1.614 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7046098709106445
Epoch: 8, Steps: 4 | Train Loss: 0.106 Vali Loss: 2.051 Vali Acc: 0.340 Test Loss: 2.051 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8487625122070312
Epoch: 9, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.407 Vali Acc: 0.400 Test Loss: 1.407 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7525238990783691
Epoch: 10, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.423 Vali Acc: 0.440 Test Loss: 1.423 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.6569645404815674
Epoch: 11, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.255 Vali Acc: 0.440 Test Loss: 1.255 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 12 cost time: 1.5215413570404053
Epoch: 12, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.751 Vali Acc: 0.460 Test Loss: 1.751 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459982).  Saving model ...
Epoch: 13 cost time: 1.4624440670013428
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.359 Vali Acc: 0.460 Test Loss: 2.359 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.432098150253296
Epoch: 14, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.740 Vali Acc: 0.480 Test Loss: 1.740 Test Acc: 0.480
Validation loss decreased (-0.459982 --> -0.479983).  Saving model ...
Epoch: 15 cost time: 1.5327863693237305
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.798 Vali Acc: 0.520 Test Loss: 1.798 Test Acc: 0.520
Validation loss decreased (-0.479983 --> -0.519982).  Saving model ...
Epoch: 16 cost time: 1.471423864364624
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.809 Vali Acc: 0.500 Test Loss: 1.809 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.490065574645996
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.849 Vali Acc: 0.500 Test Loss: 1.849 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5609242916107178
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.793 Vali Acc: 0.500 Test Loss: 1.793 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.451103925704956
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.861 Vali Acc: 0.500 Test Loss: 1.861 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6447815895080566
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.900 Vali Acc: 0.500 Test Loss: 1.900 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5514247417449951
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.974 Vali Acc: 0.500 Test Loss: 1.974 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4607017040252686
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.365 Vali Acc: 0.460 Test Loss: 2.365 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.607830286026001
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.475 Vali Acc: 0.460 Test Loss: 2.475 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3802759647369385
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.359 Vali Acc: 0.460 Test Loss: 2.359 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6100106239318848
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.234 Vali Acc: 0.480 Test Loss: 2.234 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 106777349
model size : 421.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.035430669784546
Epoch: 1, Steps: 4 | Train Loss: 1.798 Vali Loss: 1.704 Vali Acc: 0.180 Test Loss: 1.704 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.3740687370300293
Epoch: 2, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.571 Vali Acc: 0.380 Test Loss: 1.571 Test Acc: 0.380
Validation loss decreased (-0.179983 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 1.1611878871917725
Epoch: 3, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.2623977661132812
Epoch: 4, Steps: 4 | Train Loss: 0.621 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.446700096130371
Epoch: 5, Steps: 4 | Train Loss: 0.375 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4360547065734863
Epoch: 6, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.305382251739502
Epoch: 7, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.379 Vali Acc: 0.520 Test Loss: 1.379 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519986).  Saving model ...
Epoch: 8 cost time: 1.2551937103271484
Epoch: 8, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.442 Vali Acc: 0.500 Test Loss: 1.442 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3349144458770752
Epoch: 9, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.718 Vali Acc: 0.460 Test Loss: 1.718 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1224133968353271
Epoch: 10, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.412 Vali Acc: 0.540 Test Loss: 1.412 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539986).  Saving model ...
Epoch: 11 cost time: 1.3720760345458984
Epoch: 11, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.648 Vali Acc: 0.540 Test Loss: 1.648 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1168100833892822
Epoch: 12, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.780 Vali Acc: 0.520 Test Loss: 1.780 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2227723598480225
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.460 Vali Acc: 0.560 Test Loss: 1.460 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559985).  Saving model ...
Epoch: 14 cost time: 1.190514087677002
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.376 Vali Acc: 0.540 Test Loss: 1.376 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4431843757629395
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.571 Vali Acc: 0.520 Test Loss: 1.571 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0566389560699463
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.899 Vali Acc: 0.520 Test Loss: 1.899 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.542689561843872
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.033 Vali Acc: 0.500 Test Loss: 2.033 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.307347297668457
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.964 Vali Acc: 0.500 Test Loss: 1.964 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4782774448394775
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.852 Vali Acc: 0.500 Test Loss: 1.852 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3052997589111328
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.783 Vali Acc: 0.500 Test Loss: 1.783 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3797023296356201
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.500 Test Loss: 1.711 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3983938694000244
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.660 Vali Acc: 0.520 Test Loss: 1.660 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5107879638671875
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.520 Test Loss: 1.624 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 106728965
model size : 421.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8180012702941895
Epoch: 1, Steps: 4 | Train Loss: 1.875 Vali Loss: 1.509 Vali Acc: 0.300 Test Loss: 1.509 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.1234452724456787
Epoch: 2, Steps: 4 | Train Loss: 1.467 Vali Loss: 1.475 Vali Acc: 0.420 Test Loss: 1.475 Test Acc: 0.420
Validation loss decreased (-0.299985 --> -0.419985).  Saving model ...
Epoch: 3 cost time: 1.4426097869873047
Epoch: 3, Steps: 4 | Train Loss: 1.046 Vali Loss: 1.304 Vali Acc: 0.420 Test Loss: 1.304 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419987).  Saving model ...
Epoch: 4 cost time: 1.4957571029663086
Epoch: 4, Steps: 4 | Train Loss: 0.572 Vali Loss: 1.340 Vali Acc: 0.480 Test Loss: 1.340 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 1.3994438648223877
Epoch: 5, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.586 Vali Acc: 0.480 Test Loss: 1.586 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4287729263305664
Epoch: 6, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.549 Vali Acc: 0.460 Test Loss: 1.549 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2871882915496826
Epoch: 7, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.950 Vali Acc: 0.440 Test Loss: 1.950 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4527709484100342
Epoch: 8, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.615 Vali Acc: 0.480 Test Loss: 1.615 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5387508869171143
Epoch: 9, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.454 Vali Acc: 0.500 Test Loss: 1.454 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 1.6048314571380615
Epoch: 10, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.625 Vali Acc: 0.480 Test Loss: 1.625 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.169466257095337
Epoch: 11, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.654 Vali Acc: 0.480 Test Loss: 1.654 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4142985343933105
Epoch: 12, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.810 Vali Acc: 0.380 Test Loss: 1.810 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5463879108428955
Epoch: 13, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.453 Vali Acc: 0.480 Test Loss: 1.453 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4773211479187012
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.520 Vali Acc: 0.480 Test Loss: 1.520 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.42098069190979
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.500 Test Loss: 1.679 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4830570220947266
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.440 Test Loss: 1.822 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.368175983428955
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.440 Test Loss: 1.966 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.264939308166504
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.083 Vali Acc: 0.420 Test Loss: 2.083 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3202459812164307
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.149 Vali Acc: 0.420 Test Loss: 2.149 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 113061125
model size : 445.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3598382472991943
Epoch: 1, Steps: 4 | Train Loss: 1.819 Vali Loss: 1.636 Vali Acc: 0.240 Test Loss: 1.636 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.2683014869689941
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.742 Vali Acc: 0.300 Test Loss: 1.742 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.3242568969726562
Epoch: 3, Steps: 4 | Train Loss: 1.444 Vali Loss: 1.685 Vali Acc: 0.280 Test Loss: 1.685 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2661666870117188
Epoch: 4, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.572 Vali Acc: 0.320 Test Loss: 1.572 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.3268768787384033
Epoch: 5, Steps: 4 | Train Loss: 0.854 Vali Loss: 1.476 Vali Acc: 0.340 Test Loss: 1.476 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.4982781410217285
Epoch: 6, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.449 Vali Acc: 0.400 Test Loss: 1.449 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 1.2428624629974365
Epoch: 7, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.592 Vali Acc: 0.500 Test Loss: 1.592 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499984).  Saving model ...
Epoch: 8 cost time: 1.1687121391296387
Epoch: 8, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.530 Vali Acc: 0.500 Test Loss: 1.530 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.4079787731170654
Epoch: 9, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.873 Vali Acc: 0.500 Test Loss: 1.873 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3257408142089844
Epoch: 10, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.941 Vali Acc: 0.500 Test Loss: 1.941 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4527549743652344
Epoch: 11, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.736 Vali Acc: 0.520 Test Loss: 1.736 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519983).  Saving model ...
Epoch: 12 cost time: 1.634941816329956
Epoch: 12, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.334 Vali Acc: 0.560 Test Loss: 1.334 Test Acc: 0.560
Validation loss decreased (-0.519983 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 1.2395622730255127
Epoch: 13, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.814 Vali Acc: 0.520 Test Loss: 1.814 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3511698246002197
Epoch: 14, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.728 Vali Acc: 0.560 Test Loss: 1.728 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2007529735565186
Epoch: 15, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.405 Vali Acc: 0.560 Test Loss: 1.405 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3733139038085938
Epoch: 16, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6851654052734375
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.434 Vali Acc: 0.560 Test Loss: 1.434 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.629746913909912
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.443 Vali Acc: 0.520 Test Loss: 1.443 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6698853969573975
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.581 Vali Acc: 0.520 Test Loss: 1.581 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7081921100616455
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.737 Vali Acc: 0.520 Test Loss: 1.737 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6165766716003418
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.834 Vali Acc: 0.520 Test Loss: 1.834 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1929337978363037
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.520 Test Loss: 1.911 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 112969733
model size : 445.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.185706615447998
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.660 Vali Acc: 0.200 Test Loss: 1.660 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.2504241466522217
Epoch: 2, Steps: 4 | Train Loss: 1.535 Vali Loss: 1.618 Vali Acc: 0.300 Test Loss: 1.618 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.260352373123169
Epoch: 3, Steps: 4 | Train Loss: 0.958 Vali Loss: 1.440 Vali Acc: 0.400 Test Loss: 1.440 Test Acc: 0.400
Validation loss decreased (-0.299984 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.3296749591827393
Epoch: 4, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.409 Vali Acc: 0.420 Test Loss: 1.409 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 1.3446156978607178
Epoch: 5, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.244 Vali Acc: 0.480 Test Loss: 1.244 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479988).  Saving model ...
Epoch: 6 cost time: 1.310673475265503
Epoch: 6, Steps: 4 | Train Loss: 0.337 Vali Loss: 1.311 Vali Acc: 0.460 Test Loss: 1.311 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3580474853515625
Epoch: 7, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.507 Vali Acc: 0.420 Test Loss: 1.507 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2776365280151367
Epoch: 8, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.322 Vali Acc: 0.440 Test Loss: 1.322 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2888875007629395
Epoch: 9, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.554 Vali Acc: 0.440 Test Loss: 1.554 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4250354766845703
Epoch: 10, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.813 Vali Acc: 0.400 Test Loss: 1.813 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3071479797363281
Epoch: 11, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4501392841339111
Epoch: 12, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.499 Vali Acc: 0.460 Test Loss: 1.499 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3856174945831299
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.498 Vali Acc: 0.480 Test Loss: 1.498 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3601279258728027
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.699 Vali Acc: 0.480 Test Loss: 1.699 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2812905311584473
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.822 Vali Acc: 0.460 Test Loss: 1.822 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 112926725
model size : 445.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9254353046417236
Epoch: 1, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.594 Vali Acc: 0.220 Test Loss: 1.594 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3973393440246582
Epoch: 2, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.547 Vali Acc: 0.300 Test Loss: 1.547 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.0928771495819092
Epoch: 3, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.530 Vali Acc: 0.320 Test Loss: 1.530 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.1245429515838623
Epoch: 4, Steps: 4 | Train Loss: 0.827 Vali Loss: 1.489 Vali Acc: 0.460 Test Loss: 1.489 Test Acc: 0.460
Validation loss decreased (-0.319985 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 1.1651332378387451
Epoch: 5, Steps: 4 | Train Loss: 0.599 Vali Loss: 1.499 Vali Acc: 0.460 Test Loss: 1.499 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4485752582550049
Epoch: 6, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.472 Vali Acc: 0.580 Test Loss: 1.472 Test Acc: 0.580
Validation loss decreased (-0.459985 --> -0.579985).  Saving model ...
Epoch: 7 cost time: 1.5263745784759521
Epoch: 7, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.373 Vali Acc: 0.560 Test Loss: 1.373 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.507544994354248
Epoch: 8, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.948 Vali Acc: 0.540 Test Loss: 1.948 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3866736888885498
Epoch: 9, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.522 Vali Acc: 0.520 Test Loss: 1.522 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1822481155395508
Epoch: 10, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.645 Vali Acc: 0.540 Test Loss: 1.645 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7583799362182617
Epoch: 11, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.836 Vali Acc: 0.520 Test Loss: 1.836 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5542068481445312
Epoch: 12, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.589 Vali Acc: 0.560 Test Loss: 1.589 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6128873825073242
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.603 Vali Acc: 0.540 Test Loss: 1.603 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5735816955566406
Epoch: 14, Steps: 4 | Train Loss: 0.050 Vali Loss: 2.035 Vali Acc: 0.520 Test Loss: 2.035 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4648292064666748
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.354 Vali Acc: 0.600 Test Loss: 1.354 Test Acc: 0.600
Validation loss decreased (-0.579985 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 1.2097313404083252
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.987 Vali Acc: 0.480 Test Loss: 1.987 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4174747467041016
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.226 Vali Acc: 0.420 Test Loss: 3.226 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4356663227081299
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.544 Vali Acc: 0.420 Test Loss: 3.544 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4802827835083008
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.974 Vali Acc: 0.420 Test Loss: 2.974 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2874500751495361
Epoch: 20, Steps: 4 | Train Loss: 0.130 Vali Loss: 2.039 Vali Acc: 0.480 Test Loss: 2.039 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4945268630981445
Epoch: 21, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.154 Vali Acc: 0.380 Test Loss: 3.154 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4316623210906982
Epoch: 22, Steps: 4 | Train Loss: 0.027 Vali Loss: 2.685 Vali Acc: 0.420 Test Loss: 2.685 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4305016994476318
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.944 Vali Acc: 0.480 Test Loss: 1.944 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3869593143463135
Epoch: 24, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.154 Vali Acc: 0.480 Test Loss: 2.154 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5705535411834717
Epoch: 25, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.489 Vali Acc: 0.400 Test Loss: 2.489 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 122336261
model size : 481.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.935171127319336
Epoch: 1, Steps: 4 | Train Loss: 1.743 Vali Loss: 1.636 Vali Acc: 0.200 Test Loss: 1.636 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.7962946891784668
Epoch: 2, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.599 Vali Acc: 0.240 Test Loss: 1.599 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.6990060806274414
Epoch: 3, Steps: 4 | Train Loss: 1.029 Vali Loss: 1.589 Vali Acc: 0.320 Test Loss: 1.589 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.8838465213775635
Epoch: 4, Steps: 4 | Train Loss: 0.642 Vali Loss: 1.560 Vali Acc: 0.400 Test Loss: 1.560 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.6596176624298096
Epoch: 5, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.397 Vali Acc: 0.460 Test Loss: 1.397 Test Acc: 0.460
Validation loss decreased (-0.399984 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 1.467233657836914
Epoch: 6, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.585 Vali Acc: 0.460 Test Loss: 1.585 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5205106735229492
Epoch: 7, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.413 Vali Acc: 0.440 Test Loss: 1.413 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.452561616897583
Epoch: 8, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.519 Vali Acc: 0.460 Test Loss: 1.519 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.501633882522583
Epoch: 9, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 1.5324928760528564
Epoch: 10, Steps: 4 | Train Loss: 0.042 Vali Loss: 2.081 Vali Acc: 0.400 Test Loss: 2.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5783631801605225
Epoch: 11, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.481 Vali Acc: 0.460 Test Loss: 1.481 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6261711120605469
Epoch: 12, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.533 Vali Acc: 0.500 Test Loss: 1.533 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5192580223083496
Epoch: 13, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.798 Vali Acc: 0.520 Test Loss: 1.798 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519982).  Saving model ...
Epoch: 14 cost time: 1.6238322257995605
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.650 Vali Acc: 0.500 Test Loss: 1.650 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5979790687561035
Epoch: 15, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.181 Vali Acc: 0.460 Test Loss: 2.181 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6029000282287598
Epoch: 16, Steps: 4 | Train Loss: 0.031 Vali Loss: 2.159 Vali Acc: 0.440 Test Loss: 2.159 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.75142502784729
Epoch: 17, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.616 Vali Acc: 0.460 Test Loss: 1.616 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2136409282684326
Epoch: 18, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.567 Vali Acc: 0.440 Test Loss: 1.567 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6108758449554443
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.120 Vali Acc: 0.420 Test Loss: 2.120 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8272418975830078
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.118 Vali Acc: 0.440 Test Loss: 2.118 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5525610446929932
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.983 Vali Acc: 0.460 Test Loss: 1.983 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3480114936828613
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.906 Vali Acc: 0.480 Test Loss: 1.906 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.468381404876709
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.031 Vali Acc: 0.520 Test Loss: 2.031 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 122260997
model size : 481.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.03607177734375
Epoch: 1, Steps: 4 | Train Loss: 1.824 Vali Loss: 1.681 Vali Acc: 0.180 Test Loss: 1.681 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.5728881359100342
Epoch: 2, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.730 Vali Acc: 0.380 Test Loss: 1.730 Test Acc: 0.380
Validation loss decreased (-0.179983 --> -0.379983).  Saving model ...
Epoch: 3 cost time: 1.7344861030578613
Epoch: 3, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.485 Vali Acc: 0.360 Test Loss: 1.485 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4555044174194336
Epoch: 4, Steps: 4 | Train Loss: 0.724 Vali Loss: 1.469 Vali Acc: 0.400 Test Loss: 1.469 Test Acc: 0.400
Validation loss decreased (-0.379983 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.6308982372283936
Epoch: 5, Steps: 4 | Train Loss: 0.515 Vali Loss: 1.348 Vali Acc: 0.380 Test Loss: 1.348 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.533235788345337
Epoch: 6, Steps: 4 | Train Loss: 0.440 Vali Loss: 1.336 Vali Acc: 0.460 Test Loss: 1.336 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 1.485274314880371
Epoch: 7, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.383 Vali Acc: 0.480 Test Loss: 1.383 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479986).  Saving model ...
Epoch: 8 cost time: 1.3133387565612793
Epoch: 8, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.464 Vali Acc: 0.480 Test Loss: 1.464 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5553901195526123
Epoch: 9, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.662 Vali Acc: 0.500 Test Loss: 1.662 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499983).  Saving model ...
Epoch: 10 cost time: 1.4843435287475586
Epoch: 10, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.473 Vali Acc: 0.500 Test Loss: 1.473 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499985).  Saving model ...
Epoch: 11 cost time: 1.4546332359313965
Epoch: 11, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.507 Vali Acc: 0.500 Test Loss: 1.507 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4637863636016846
Epoch: 12, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.419 Vali Acc: 0.520 Test Loss: 1.419 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519986).  Saving model ...
Epoch: 13 cost time: 1.5234489440917969
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.563 Vali Acc: 0.440 Test Loss: 1.563 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7776551246643066
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.600 Vali Acc: 0.460 Test Loss: 1.600 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2442173957824707
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.769 Vali Acc: 0.480 Test Loss: 1.769 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5440747737884521
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.720 Vali Acc: 0.480 Test Loss: 1.720 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6949350833892822
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.687 Vali Acc: 0.520 Test Loss: 1.687 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9380083084106445
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.634 Vali Acc: 0.520 Test Loss: 1.634 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4990274906158447
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.657 Vali Acc: 0.520 Test Loss: 1.657 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7256097793579102
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.500 Test Loss: 1.775 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5106077194213867
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.480 Test Loss: 1.825 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.609485149383545
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.500 Test Loss: 1.829 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 122217989
model size : 480.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.213963270187378
Epoch: 1, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.669 Vali Acc: 0.240 Test Loss: 1.669 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.5140974521636963
Epoch: 2, Steps: 4 | Train Loss: 1.420 Vali Loss: 1.506 Vali Acc: 0.360 Test Loss: 1.506 Test Acc: 0.360
Validation loss decreased (-0.239983 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.895594596862793
Epoch: 3, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.245 Vali Acc: 0.380 Test Loss: 1.245 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379988).  Saving model ...
Epoch: 4 cost time: 1.380929708480835
Epoch: 4, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.329 Vali Acc: 0.480 Test Loss: 1.329 Test Acc: 0.480
Validation loss decreased (-0.379988 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 1.4090185165405273
Epoch: 5, Steps: 4 | Train Loss: 0.379 Vali Loss: 1.380 Vali Acc: 0.420 Test Loss: 1.380 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6249327659606934
Epoch: 6, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.366 Vali Acc: 0.460 Test Loss: 1.366 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4701874256134033
Epoch: 7, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.8807764053344727
Epoch: 8, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.779 Vali Acc: 0.440 Test Loss: 1.779 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4578838348388672
Epoch: 9, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.646 Vali Acc: 0.440 Test Loss: 1.646 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3720848560333252
Epoch: 10, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.278 Vali Acc: 0.480 Test Loss: 1.278 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.758286476135254
Epoch: 11, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.889 Vali Acc: 0.500 Test Loss: 1.889 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8402397632598877
Epoch: 12, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.639 Vali Acc: 0.520 Test Loss: 1.639 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519984).  Saving model ...
Epoch: 13 cost time: 1.6702888011932373
Epoch: 13, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.056 Vali Acc: 0.500 Test Loss: 2.056 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3130466938018799
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.811 Vali Acc: 0.440 Test Loss: 1.811 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8806343078613281
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.541 Vali Acc: 0.480 Test Loss: 1.541 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3172287940979004
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.567 Vali Acc: 0.500 Test Loss: 1.567 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2925872802734375
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.743 Vali Acc: 0.540 Test Loss: 1.743 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539983).  Saving model ...
Epoch: 18 cost time: 1.486058235168457
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.520 Test Loss: 1.895 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4833121299743652
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.037 Vali Acc: 0.520 Test Loss: 2.037 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3247082233428955
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.145 Vali Acc: 0.520 Test Loss: 2.145 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5197844505310059
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.213 Vali Acc: 0.520 Test Loss: 2.213 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5016939640045166
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.258 Vali Acc: 0.500 Test Loss: 2.258 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1488468647003174
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.236 Vali Acc: 0.520 Test Loss: 2.236 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.472332239151001
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.226 Vali Acc: 0.540 Test Loss: 2.226 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4693467617034912
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.215 Vali Acc: 0.540 Test Loss: 2.215 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4598393440246582
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.204 Vali Acc: 0.540 Test Loss: 2.204 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3893072605133057
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.189 Vali Acc: 0.540 Test Loss: 2.189 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 134710277
model size : 528.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.007256507873535
Epoch: 1, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.727 Vali Acc: 0.140 Test Loss: 1.727 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.5221693515777588
Epoch: 2, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.555 Vali Acc: 0.320 Test Loss: 1.555 Test Acc: 0.320
Validation loss decreased (-0.139983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.663118600845337
Epoch: 3, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.466 Vali Acc: 0.320 Test Loss: 1.466 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.875786542892456
Epoch: 4, Steps: 4 | Train Loss: 0.868 Vali Loss: 1.446 Vali Acc: 0.380 Test Loss: 1.446 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 1.936861276626587
Epoch: 5, Steps: 4 | Train Loss: 0.461 Vali Loss: 1.441 Vali Acc: 0.440 Test Loss: 1.441 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.5662024021148682
Epoch: 6, Steps: 4 | Train Loss: 0.323 Vali Loss: 1.353 Vali Acc: 0.460 Test Loss: 1.353 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.2725863456726074
Epoch: 7, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.281 Vali Acc: 0.480 Test Loss: 1.281 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 1.65553879737854
Epoch: 8, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.460 Vali Acc: 0.400 Test Loss: 1.460 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5246050357818604
Epoch: 9, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.398 Vali Acc: 0.460 Test Loss: 1.398 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2534003257751465
Epoch: 10, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 1.5716025829315186
Epoch: 11, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.629 Vali Acc: 0.460 Test Loss: 1.629 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7330396175384521
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.898 Vali Acc: 0.420 Test Loss: 1.898 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7787563800811768
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.811 Vali Acc: 0.440 Test Loss: 1.811 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4842853546142578
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.761 Vali Acc: 0.500 Test Loss: 1.761 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7103376388549805
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.853 Vali Acc: 0.480 Test Loss: 1.853 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.867903709411621
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.062 Vali Acc: 0.460 Test Loss: 2.062 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5577316284179688
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.173 Vali Acc: 0.460 Test Loss: 2.173 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.790905475616455
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.191 Vali Acc: 0.460 Test Loss: 2.191 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.857039213180542
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.903 Vali Acc: 0.500 Test Loss: 1.903 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8403141498565674
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.540 Test Loss: 1.722 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539983).  Saving model ...
Epoch: 21 cost time: 1.7799205780029297
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.540 Test Loss: 1.727 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7454042434692383
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.879 Vali Acc: 0.520 Test Loss: 1.879 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.768418312072754
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.258 Vali Acc: 0.460 Test Loss: 2.258 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9678843021392822
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.525 Vali Acc: 0.440 Test Loss: 2.525 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.614865779876709
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.645 Vali Acc: 0.440 Test Loss: 2.645 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7175488471984863
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.618 Vali Acc: 0.440 Test Loss: 2.618 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7215406894683838
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.522 Vali Acc: 0.440 Test Loss: 2.522 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8929240703582764
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.431 Vali Acc: 0.460 Test Loss: 2.431 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9296660423278809
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.480 Test Loss: 2.370 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9096980094909668
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.332 Vali Acc: 0.480 Test Loss: 2.332 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 134640389
model size : 528.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0826427936553955
Epoch: 1, Steps: 4 | Train Loss: 1.710 Vali Loss: 1.824 Vali Acc: 0.240 Test Loss: 1.824 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 1.9622340202331543
Epoch: 2, Steps: 4 | Train Loss: 1.411 Vali Loss: 1.546 Vali Acc: 0.360 Test Loss: 1.546 Test Acc: 0.360
Validation loss decreased (-0.239982 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.9164068698883057
Epoch: 3, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.485 Vali Acc: 0.340 Test Loss: 1.485 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.449249267578125
Epoch: 4, Steps: 4 | Train Loss: 0.639 Vali Loss: 1.396 Vali Acc: 0.340 Test Loss: 1.396 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.920334815979004
Epoch: 5, Steps: 4 | Train Loss: 0.446 Vali Loss: 1.404 Vali Acc: 0.420 Test Loss: 1.404 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 1.638800859451294
Epoch: 6, Steps: 4 | Train Loss: 0.441 Vali Loss: 1.458 Vali Acc: 0.420 Test Loss: 1.458 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6403417587280273
Epoch: 7, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.629 Vali Acc: 0.420 Test Loss: 1.629 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8689014911651611
Epoch: 8, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.596 Vali Acc: 0.380 Test Loss: 1.596 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8993000984191895
Epoch: 9, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7816956043243408
Epoch: 10, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.637 Vali Acc: 0.380 Test Loss: 1.637 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8669846057891846
Epoch: 11, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.718 Vali Acc: 0.420 Test Loss: 1.718 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.770930528640747
Epoch: 12, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.773 Vali Acc: 0.400 Test Loss: 1.773 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8180389404296875
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.919 Vali Acc: 0.400 Test Loss: 1.919 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7694737911224365
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.005 Vali Acc: 0.400 Test Loss: 2.005 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.802661418914795
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.050 Vali Acc: 0.400 Test Loss: 2.050 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 134602757
model size : 528.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.139549732208252
Epoch: 1, Steps: 4 | Train Loss: 1.711 Vali Loss: 1.650 Vali Acc: 0.160 Test Loss: 1.650 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.57175612449646
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.377 Vali Acc: 0.340 Test Loss: 1.377 Test Acc: 0.340
Validation loss decreased (-0.159984 --> -0.339986).  Saving model ...
Epoch: 3 cost time: 1.5030288696289062
Epoch: 3, Steps: 4 | Train Loss: 1.078 Vali Loss: 1.242 Vali Acc: 0.420 Test Loss: 1.242 Test Acc: 0.420
Validation loss decreased (-0.339986 --> -0.419988).  Saving model ...
Epoch: 4 cost time: 1.5127911567687988
Epoch: 4, Steps: 4 | Train Loss: 0.532 Vali Loss: 1.383 Vali Acc: 0.360 Test Loss: 1.383 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8137173652648926
Epoch: 5, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.392 Vali Acc: 0.380 Test Loss: 1.392 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6803038120269775
Epoch: 6, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.758 Vali Acc: 0.420 Test Loss: 1.758 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.336336374282837
Epoch: 7, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.474 Vali Acc: 0.440 Test Loss: 1.474 Test Acc: 0.440
Validation loss decreased (-0.419988 --> -0.439985).  Saving model ...
Epoch: 8 cost time: 1.4862205982208252
Epoch: 8, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.805 Vali Acc: 0.380 Test Loss: 1.805 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.797823429107666
Epoch: 9, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.880098581314087
Epoch: 10, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.743 Vali Acc: 0.420 Test Loss: 1.743 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6388332843780518
Epoch: 11, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.632 Vali Acc: 0.440 Test Loss: 1.632 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6552040576934814
Epoch: 12, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.497 Vali Acc: 0.400 Test Loss: 2.497 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.972008228302002
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.883 Vali Acc: 0.460 Test Loss: 1.883 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6543664932250977
Epoch: 14, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.852 Vali Acc: 0.460 Test Loss: 1.852 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7770442962646484
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.459 Vali Acc: 0.440 Test Loss: 2.459 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7558424472808838
Epoch: 16, Steps: 4 | Train Loss: 0.028 Vali Loss: 2.141 Vali Acc: 0.460 Test Loss: 2.141 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9162616729736328
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.558 Vali Acc: 0.520 Test Loss: 1.558 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519984).  Saving model ...
Epoch: 18 cost time: 1.586693525314331
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.512 Vali Acc: 0.560 Test Loss: 1.512 Test Acc: 0.560
Validation loss decreased (-0.519984 --> -0.559985).  Saving model ...
Epoch: 19 cost time: 2.0604493618011475
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.520 Test Loss: 1.715 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9221150875091553
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.480 Test Loss: 1.868 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9312705993652344
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.992 Vali Acc: 0.500 Test Loss: 1.992 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.810704231262207
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.100 Vali Acc: 0.480 Test Loss: 2.100 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7256009578704834
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.480 Test Loss: 2.172 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7956559658050537
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.218 Vali Acc: 0.480 Test Loss: 2.218 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.824890375137329
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.248 Vali Acc: 0.460 Test Loss: 2.248 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8105971813201904
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.258 Vali Acc: 0.460 Test Loss: 2.258 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.889305591583252
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.265 Vali Acc: 0.460 Test Loss: 2.265 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5143158435821533
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.263 Vali Acc: 0.460 Test Loss: 2.263 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 150188549
model size : 587.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.262908935546875
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.615 Vali Acc: 0.260 Test Loss: 1.615 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.6473500728607178
Epoch: 2, Steps: 4 | Train Loss: 1.379 Vali Loss: 1.570 Vali Acc: 0.320 Test Loss: 1.570 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.4115345478057861
Epoch: 3, Steps: 4 | Train Loss: 1.066 Vali Loss: 1.444 Vali Acc: 0.380 Test Loss: 1.444 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379986).  Saving model ...
Epoch: 4 cost time: 1.4135355949401855
Epoch: 4, Steps: 4 | Train Loss: 0.597 Vali Loss: 1.537 Vali Acc: 0.440 Test Loss: 1.537 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 1.6880245208740234
Epoch: 5, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.436 Vali Acc: 0.460 Test Loss: 1.436 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 1.4707551002502441
Epoch: 6, Steps: 4 | Train Loss: 0.258 Vali Loss: 1.410 Vali Acc: 0.460 Test Loss: 1.410 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.5554182529449463
Epoch: 7, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.495 Vali Acc: 0.540 Test Loss: 1.495 Test Acc: 0.540
Validation loss decreased (-0.459986 --> -0.539985).  Saving model ...
Epoch: 8 cost time: 2.084355354309082
Epoch: 8, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.467 Vali Acc: 0.500 Test Loss: 1.467 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.668247938156128
Epoch: 9, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6633625030517578
Epoch: 10, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.484 Vali Acc: 0.540 Test Loss: 1.484 Test Acc: 0.540
Validation loss decreased (-0.539985 --> -0.539985).  Saving model ...
Epoch: 11 cost time: 1.7604780197143555
Epoch: 11, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.600 Vali Acc: 0.540 Test Loss: 1.600 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8633291721343994
Epoch: 12, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.517 Vali Acc: 0.540 Test Loss: 1.517 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9263250827789307
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4047372341156006
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.675 Vali Acc: 0.480 Test Loss: 1.675 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.800856590270996
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.500 Test Loss: 1.641 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.887263536453247
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.654 Vali Acc: 0.520 Test Loss: 1.654 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5852456092834473
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.500 Test Loss: 1.752 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5731735229492188
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.500 Test Loss: 1.807 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2897984981536865
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.841 Vali Acc: 0.500 Test Loss: 1.841 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6809349060058594
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.861 Vali Acc: 0.520 Test Loss: 1.861 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 150124037
model size : 587.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.335911512374878
Epoch: 1, Steps: 4 | Train Loss: 1.712 Vali Loss: 1.581 Vali Acc: 0.280 Test Loss: 1.581 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.6571667194366455
Epoch: 2, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.528 Vali Acc: 0.300 Test Loss: 1.528 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.9625487327575684
Epoch: 3, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.938047170639038
Epoch: 4, Steps: 4 | Train Loss: 0.797 Vali Loss: 1.324 Vali Acc: 0.460 Test Loss: 1.324 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459987).  Saving model ...
Epoch: 5 cost time: 1.800095796585083
Epoch: 5, Steps: 4 | Train Loss: 0.466 Vali Loss: 1.301 Vali Acc: 0.540 Test Loss: 1.301 Test Acc: 0.540
Validation loss decreased (-0.459987 --> -0.539987).  Saving model ...
Epoch: 6 cost time: 1.6992981433868408
Epoch: 6, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.538 Vali Acc: 0.500 Test Loss: 1.538 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7364082336425781
Epoch: 7, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.503 Vali Acc: 0.480 Test Loss: 1.503 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6037774085998535
Epoch: 8, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.411 Vali Acc: 0.460 Test Loss: 1.411 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6049189567565918
Epoch: 9, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.446 Vali Acc: 0.460 Test Loss: 1.446 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7668921947479248
Epoch: 10, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.331 Vali Acc: 0.460 Test Loss: 1.331 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.142263174057007
Epoch: 11, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.443 Vali Acc: 0.460 Test Loss: 1.443 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5980405807495117
Epoch: 12, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.672 Vali Acc: 0.460 Test Loss: 1.672 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.702392816543579
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.786 Vali Acc: 0.440 Test Loss: 1.786 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9867808818817139
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.326 Vali Acc: 0.480 Test Loss: 1.326 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.717146396636963
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.459 Vali Acc: 0.440 Test Loss: 1.459 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 150091781
model size : 587.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6561973094940186
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.554 Vali Acc: 0.120 Test Loss: 1.554 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.3588225841522217
Epoch: 2, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.705 Vali Acc: 0.320 Test Loss: 1.705 Test Acc: 0.320
Validation loss decreased (-0.119984 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 1.7080354690551758
Epoch: 3, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.637 Vali Acc: 0.340 Test Loss: 1.637 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 2.0211760997772217
Epoch: 4, Steps: 4 | Train Loss: 0.774 Vali Loss: 1.537 Vali Acc: 0.460 Test Loss: 1.537 Test Acc: 0.460
Validation loss decreased (-0.339984 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 1.8628525733947754
Epoch: 5, Steps: 4 | Train Loss: 0.777 Vali Loss: 1.604 Vali Acc: 0.400 Test Loss: 1.604 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9056077003479004
Epoch: 6, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.650 Vali Acc: 0.460 Test Loss: 1.650 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.966521978378296
Epoch: 7, Steps: 4 | Train Loss: 0.299 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 2.060938835144043
Epoch: 8, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.406 Vali Acc: 0.500 Test Loss: 1.406 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 9 cost time: 2.2473509311676025
Epoch: 9, Steps: 4 | Train Loss: 0.281 Vali Loss: 1.736 Vali Acc: 0.440 Test Loss: 1.736 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0580387115478516
Epoch: 10, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.774 Vali Acc: 0.480 Test Loss: 1.774 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.23801589012146
Epoch: 11, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.616 Vali Acc: 0.500 Test Loss: 1.616 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.293924331665039
Epoch: 12, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.719 Vali Acc: 0.460 Test Loss: 1.719 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6565544605255127
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.709 Vali Acc: 0.480 Test Loss: 1.709 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9919135570526123
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.035 Vali Acc: 0.460 Test Loss: 2.035 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8877975940704346
Epoch: 15, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.129 Vali Acc: 0.460 Test Loss: 2.129 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9011976718902588
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.910 Vali Acc: 0.500 Test Loss: 1.910 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.877145528793335
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.971 Vali Acc: 0.500 Test Loss: 1.971 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.226243257522583
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.121 Vali Acc: 0.480 Test Loss: 2.121 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 168754949
model size : 658.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8472249507904053
Epoch: 1, Steps: 4 | Train Loss: 1.802 Vali Loss: 1.613 Vali Acc: 0.200 Test Loss: 1.613 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.153198480606079
Epoch: 2, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.565 Vali Acc: 0.300 Test Loss: 1.565 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.2352044582366943
Epoch: 3, Steps: 4 | Train Loss: 0.998 Vali Loss: 1.508 Vali Acc: 0.380 Test Loss: 1.508 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 2.1051840782165527
Epoch: 4, Steps: 4 | Train Loss: 0.589 Vali Loss: 1.577 Vali Acc: 0.420 Test Loss: 1.577 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419984).  Saving model ...
Epoch: 5 cost time: 2.2586262226104736
Epoch: 5, Steps: 4 | Train Loss: 0.403 Vali Loss: 1.370 Vali Acc: 0.480 Test Loss: 1.370 Test Acc: 0.480
Validation loss decreased (-0.419984 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.9397850036621094
Epoch: 6, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.457 Vali Acc: 0.420 Test Loss: 1.457 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7745261192321777
Epoch: 7, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2221519947052
Epoch: 8, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.555 Vali Acc: 0.420 Test Loss: 1.555 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.356828212738037
Epoch: 9, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.561 Vali Acc: 0.400 Test Loss: 1.561 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.028111457824707
Epoch: 10, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.919 Vali Acc: 0.400 Test Loss: 1.919 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7942891120910645
Epoch: 11, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.857 Vali Acc: 0.420 Test Loss: 1.857 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7647602558135986
Epoch: 12, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.555 Vali Acc: 0.400 Test Loss: 1.555 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7935032844543457
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.886 Vali Acc: 0.420 Test Loss: 1.886 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6211183071136475
Epoch: 14, Steps: 4 | Train Loss: 0.074 Vali Loss: 2.081 Vali Acc: 0.440 Test Loss: 2.081 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8948907852172852
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.685 Vali Acc: 0.420 Test Loss: 1.685 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 168706565
model size : 658.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.316828727722168
Epoch: 1, Steps: 4 | Train Loss: 1.747 Vali Loss: 1.780 Vali Acc: 0.240 Test Loss: 1.780 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 2.3364436626434326
Epoch: 2, Steps: 4 | Train Loss: 1.637 Vali Loss: 1.609 Vali Acc: 0.300 Test Loss: 1.609 Test Acc: 0.300
Validation loss decreased (-0.239982 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.7945940494537354
Epoch: 3, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.404 Vali Acc: 0.460 Test Loss: 1.404 Test Acc: 0.460
Validation loss decreased (-0.299984 --> -0.459986).  Saving model ...
Epoch: 4 cost time: 1.956944227218628
Epoch: 4, Steps: 4 | Train Loss: 0.650 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8737618923187256
Epoch: 5, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.394 Vali Acc: 0.440 Test Loss: 1.394 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2801668643951416
Epoch: 6, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.673 Vali Acc: 0.420 Test Loss: 1.673 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8755230903625488
Epoch: 7, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.325 Vali Acc: 0.480 Test Loss: 1.325 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 2.1024961471557617
Epoch: 8, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.485 Vali Acc: 0.440 Test Loss: 1.485 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.011530637741089
Epoch: 9, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.642 Vali Acc: 0.420 Test Loss: 1.642 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.914219856262207
Epoch: 10, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.486 Vali Acc: 0.460 Test Loss: 1.486 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.129655361175537
Epoch: 11, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.573 Vali Acc: 0.480 Test Loss: 1.573 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.097947120666504
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.789 Vali Acc: 0.440 Test Loss: 1.789 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.388582706451416
Epoch: 13, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.594 Vali Acc: 0.480 Test Loss: 1.594 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8932769298553467
Epoch: 14, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.888 Vali Acc: 0.440 Test Loss: 1.888 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0487754344940186
Epoch: 15, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.898 Vali Acc: 0.420 Test Loss: 1.898 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2633700370788574
Epoch: 16, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.647 Vali Acc: 0.440 Test Loss: 1.647 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.254406690597534
Epoch: 17, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.855 Vali Acc: 0.460 Test Loss: 1.855 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 168685061
model size : 658.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps54_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9009275436401367
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.663 Vali Acc: 0.080 Test Loss: 1.663 Test Acc: 0.080
Validation loss decreased (inf --> -0.079983).  Saving model ...
Epoch: 2 cost time: 2.360139846801758
Epoch: 2, Steps: 4 | Train Loss: 1.275 Vali Loss: 1.431 Vali Acc: 0.340 Test Loss: 1.431 Test Acc: 0.340
Validation loss decreased (-0.079983 --> -0.339986).  Saving model ...
Epoch: 3 cost time: 1.668821096420288
Epoch: 3, Steps: 4 | Train Loss: 0.922 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
Validation loss decreased (-0.339986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 2.2075159549713135
Epoch: 4, Steps: 4 | Train Loss: 0.688 Vali Loss: 1.342 Vali Acc: 0.460 Test Loss: 1.342 Test Acc: 0.460
Validation loss decreased (-0.399987 --> -0.459987).  Saving model ...
Epoch: 5 cost time: 2.143892765045166
Epoch: 5, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.460 Vali Acc: 0.380 Test Loss: 1.460 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.894469976425171
Epoch: 6, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.544 Vali Acc: 0.400 Test Loss: 1.544 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1395983695983887
Epoch: 7, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.591 Vali Acc: 0.440 Test Loss: 1.591 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2522153854370117
Epoch: 8, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.677 Vali Acc: 0.400 Test Loss: 1.677 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4847571849823
Epoch: 9, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.816 Vali Acc: 0.380 Test Loss: 1.816 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.377579689025879
Epoch: 10, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.577 Vali Acc: 0.440 Test Loss: 1.577 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.458942174911499
Epoch: 11, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.617 Vali Acc: 0.400 Test Loss: 1.617 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.157668352127075
Epoch: 12, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.700 Vali Acc: 0.400 Test Loss: 1.700 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4537343978881836
Epoch: 13, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.716 Vali Acc: 0.400 Test Loss: 1.716 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.076096773147583
Epoch: 14, Steps: 4 | Train Loss: 0.025 Vali Loss: 2.505 Vali Acc: 0.360 Test Loss: 2.505 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps54_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 196628741
model size : 764.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.696955680847168
Epoch: 1, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.593 Vali Acc: 0.300 Test Loss: 1.593 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 2.351945400238037
Epoch: 2, Steps: 4 | Train Loss: 1.461 Vali Loss: 1.483 Vali Acc: 0.340 Test Loss: 1.483 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 2.582473039627075
Epoch: 3, Steps: 4 | Train Loss: 0.732 Vali Loss: 1.400 Vali Acc: 0.360 Test Loss: 1.400 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 2.4463651180267334
Epoch: 4, Steps: 4 | Train Loss: 0.617 Vali Loss: 1.514 Vali Acc: 0.440 Test Loss: 1.514 Test Acc: 0.440
Validation loss decreased (-0.359986 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 2.374182939529419
Epoch: 5, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.553 Vali Acc: 0.440 Test Loss: 1.553 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5914392471313477
Epoch: 6, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.487 Vali Acc: 0.440 Test Loss: 1.487 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 2.385087490081787
Epoch: 7, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.623 Vali Acc: 0.460 Test Loss: 1.623 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459984).  Saving model ...
Epoch: 8 cost time: 2.5128564834594727
Epoch: 8, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.404850959777832
Epoch: 9, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.679521083831787
Epoch: 10, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.592 Vali Acc: 0.460 Test Loss: 1.592 Test Acc: 0.460
Validation loss decreased (-0.459984 --> -0.459984).  Saving model ...
Epoch: 11 cost time: 2.213789463043213
Epoch: 11, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.357 Vali Acc: 0.520 Test Loss: 1.357 Test Acc: 0.520
Validation loss decreased (-0.459984 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 2.2212631702423096
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.351 Vali Acc: 0.520 Test Loss: 1.351 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519986).  Saving model ...
Epoch: 13 cost time: 2.5513577461242676
Epoch: 13, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.599 Vali Acc: 0.440 Test Loss: 1.599 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.236783504486084
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.697 Vali Acc: 0.440 Test Loss: 1.697 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.019289016723633
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.691 Vali Acc: 0.440 Test Loss: 1.691 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6619577407836914
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.665 Vali Acc: 0.440 Test Loss: 1.665 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.54862380027771
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.633 Vali Acc: 0.440 Test Loss: 1.633 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6749515533447266
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.670 Vali Acc: 0.440 Test Loss: 1.670 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4826254844665527
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.440 Test Loss: 1.720 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.544280767440796
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.729 Vali Acc: 0.440 Test Loss: 1.729 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.8273158073425293
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.460 Test Loss: 1.722 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.363820791244507
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.460 Test Loss: 1.687 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 196591109
model size : 764.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps54_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8733108043670654
Epoch: 1, Steps: 4 | Train Loss: 1.728 Vali Loss: 1.701 Vali Acc: 0.160 Test Loss: 1.701 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.6306817531585693
Epoch: 2, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.591 Vali Acc: 0.280 Test Loss: 1.591 Test Acc: 0.280
Validation loss decreased (-0.159983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.9839417934417725
Epoch: 3, Steps: 4 | Train Loss: 1.023 Vali Loss: 1.426 Vali Acc: 0.320 Test Loss: 1.426 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319986).  Saving model ...
Epoch: 4 cost time: 2.1123194694519043
Epoch: 4, Steps: 4 | Train Loss: 0.663 Vali Loss: 1.426 Vali Acc: 0.400 Test Loss: 1.426 Test Acc: 0.400
Validation loss decreased (-0.319986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 2.4813549518585205
Epoch: 5, Steps: 4 | Train Loss: 0.542 Vali Loss: 1.289 Vali Acc: 0.440 Test Loss: 1.289 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 2.568000555038452
Epoch: 6, Steps: 4 | Train Loss: 0.501 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7261686325073242
Epoch: 7, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.329 Vali Acc: 0.440 Test Loss: 1.329 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5425920486450195
Epoch: 8, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.533795118331909
Epoch: 9, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1731269359588623
Epoch: 10, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.476 Vali Acc: 0.420 Test Loss: 1.476 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9937264919281006
Epoch: 11, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.314 Vali Acc: 0.520 Test Loss: 1.314 Test Acc: 0.520
Validation loss decreased (-0.439987 --> -0.519987).  Saving model ...
Epoch: 12 cost time: 2.1971869468688965
Epoch: 12, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.287 Vali Acc: 0.560 Test Loss: 1.287 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 2.3003063201904297
Epoch: 13, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.790 Vali Acc: 0.480 Test Loss: 1.790 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8376598358154297
Epoch: 14, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.428 Vali Acc: 0.480 Test Loss: 1.428 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.15553617477417
Epoch: 15, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.645 Vali Acc: 0.460 Test Loss: 1.645 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.290665626525879
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.666 Vali Acc: 0.460 Test Loss: 1.666 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2494099140167236
Epoch: 17, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.547 Vali Acc: 0.460 Test Loss: 1.547 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4461512565612793
Epoch: 18, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.465 Vali Acc: 0.460 Test Loss: 1.465 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0863420963287354
Epoch: 19, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.677 Vali Acc: 0.420 Test Loss: 1.677 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5688982009887695
Epoch: 20, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.144 Vali Acc: 0.400 Test Loss: 2.144 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.483778715133667
Epoch: 21, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.865 Vali Acc: 0.420 Test Loss: 1.865 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4038777351379395
Epoch: 22, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.726 Vali Acc: 0.540 Test Loss: 1.726 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el4_dm768_df768_ps54_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 196569605
model size : 764.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5611350536346436
Epoch: 1, Steps: 4 | Train Loss: 1.708 Vali Loss: 1.615 Vali Acc: 0.180 Test Loss: 1.615 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.0016121864318848
Epoch: 2, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.556 Vali Acc: 0.300 Test Loss: 1.556 Test Acc: 0.300
Validation loss decreased (-0.179984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.0047085285186768
Epoch: 3, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.540 Vali Acc: 0.380 Test Loss: 1.540 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 0.963831901550293
Epoch: 4, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.465 Vali Acc: 0.480 Test Loss: 1.465 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479985).  Saving model ...
Epoch: 5 cost time: 1.0130243301391602
Epoch: 5, Steps: 4 | Train Loss: 0.374 Vali Loss: 1.514 Vali Acc: 0.440 Test Loss: 1.514 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9299981594085693
Epoch: 6, Steps: 4 | Train Loss: 0.364 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.1085586547851562
Epoch: 7, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.781 Vali Acc: 0.500 Test Loss: 1.781 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0174570083618164
Epoch: 8, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.957 Vali Acc: 0.500 Test Loss: 1.957 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8851299285888672
Epoch: 9, Steps: 4 | Train Loss: 0.067 Vali Loss: 2.069 Vali Acc: 0.440 Test Loss: 2.069 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0811493396759033
Epoch: 10, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.512 Vali Acc: 0.480 Test Loss: 1.512 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1514692306518555
Epoch: 11, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.975 Vali Acc: 0.500 Test Loss: 1.975 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.184333324432373
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.198 Vali Acc: 0.500 Test Loss: 2.198 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0801036357879639
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 2.344 Vali Acc: 0.560 Test Loss: 2.344 Test Acc: 0.560
Validation loss decreased (-0.499986 --> -0.559977).  Saving model ...
Epoch: 14 cost time: 1.0117650032043457
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.574 Vali Acc: 0.520 Test Loss: 1.574 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1223185062408447
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.347 Vali Acc: 0.480 Test Loss: 2.347 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1842641830444336
Epoch: 16, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.335 Vali Acc: 0.560 Test Loss: 2.335 Test Acc: 0.560
Validation loss decreased (-0.559977 --> -0.559977).  Saving model ...
Epoch: 17 cost time: 1.066803216934204
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.269 Vali Acc: 0.500 Test Loss: 2.269 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8962736129760742
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.293 Vali Acc: 0.520 Test Loss: 2.293 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.907623291015625
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.269 Vali Acc: 0.560 Test Loss: 2.269 Test Acc: 0.560
Validation loss decreased (-0.559977 --> -0.559977).  Saving model ...
Epoch: 20 cost time: 0.9061086177825928
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.135 Vali Acc: 0.560 Test Loss: 2.135 Test Acc: 0.560
Validation loss decreased (-0.559977 --> -0.559979).  Saving model ...
Epoch: 21 cost time: 0.9721734523773193
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.027 Vali Acc: 0.560 Test Loss: 2.027 Test Acc: 0.560
Validation loss decreased (-0.559979 --> -0.559980).  Saving model ...
Epoch: 22 cost time: 1.090641736984253
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.985 Vali Acc: 0.580 Test Loss: 1.985 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579980).  Saving model ...
Epoch: 23 cost time: 1.065241813659668
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.004 Vali Acc: 0.540 Test Loss: 2.004 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9994585514068604
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.039 Vali Acc: 0.560 Test Loss: 2.039 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9969935417175293
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.063 Vali Acc: 0.580 Test Loss: 2.063 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9674599170684814
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.070 Vali Acc: 0.580 Test Loss: 2.070 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9236340522766113
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.063 Vali Acc: 0.580 Test Loss: 2.063 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.07576584815979
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.068 Vali Acc: 0.580 Test Loss: 2.068 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9019784927368164
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.087 Vali Acc: 0.580 Test Loss: 2.087 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9919638633728027
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.097 Vali Acc: 0.580 Test Loss: 2.097 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0062904357910156
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.126 Vali Acc: 0.580 Test Loss: 2.126 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0220494270324707
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.144 Vali Acc: 0.580 Test Loss: 2.144 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 56670725
model size : 230.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2492265701293945
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.660 Vali Acc: 0.120 Test Loss: 1.660 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 0.8402938842773438
Epoch: 2, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
Validation loss decreased (-0.119983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 0.8317999839782715
Epoch: 3, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.496 Vali Acc: 0.280 Test Loss: 1.496 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 0.8790585994720459
Epoch: 4, Steps: 4 | Train Loss: 0.905 Vali Loss: 1.396 Vali Acc: 0.440 Test Loss: 1.396 Test Acc: 0.440
Validation loss decreased (-0.279985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 0.8473930358886719
Epoch: 5, Steps: 4 | Train Loss: 0.740 Vali Loss: 1.437 Vali Acc: 0.480 Test Loss: 1.437 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 0.8770301342010498
Epoch: 6, Steps: 4 | Train Loss: 0.363 Vali Loss: 1.342 Vali Acc: 0.480 Test Loss: 1.342 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 0.8539509773254395
Epoch: 7, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.443 Vali Acc: 0.480 Test Loss: 1.443 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8333570957183838
Epoch: 8, Steps: 4 | Train Loss: 0.197 Vali Loss: 2.267 Vali Acc: 0.380 Test Loss: 2.267 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9146482944488525
Epoch: 9, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.797 Vali Acc: 0.460 Test Loss: 1.797 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9577198028564453
Epoch: 10, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.558 Vali Acc: 0.500 Test Loss: 1.558 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499984).  Saving model ...
Epoch: 11 cost time: 1.03509521484375
Epoch: 11, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.695 Vali Acc: 0.480 Test Loss: 1.695 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0331900119781494
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.457 Vali Acc: 0.480 Test Loss: 1.457 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8281300067901611
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 2.296 Vali Acc: 0.520 Test Loss: 2.296 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519977).  Saving model ...
Epoch: 14 cost time: 0.8921370506286621
Epoch: 14, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.786 Vali Acc: 0.560 Test Loss: 1.786 Test Acc: 0.560
Validation loss decreased (-0.519977 --> -0.559982).  Saving model ...
Epoch: 15 cost time: 1.0589141845703125
Epoch: 15, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.502 Vali Acc: 0.540 Test Loss: 1.502 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9688510894775391
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.663 Vali Acc: 0.580 Test Loss: 1.663 Test Acc: 0.580
Validation loss decreased (-0.559982 --> -0.579983).  Saving model ...
Epoch: 17 cost time: 1.0126113891601562
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.661 Vali Acc: 0.580 Test Loss: 1.661 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 18 cost time: 0.8361833095550537
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8144357204437256
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.606 Vali Acc: 0.560 Test Loss: 1.606 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8045246601104736
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.728 Vali Acc: 0.560 Test Loss: 1.728 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8421046733856201
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.832 Vali Acc: 0.560 Test Loss: 1.832 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8279378414154053
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.941 Vali Acc: 0.560 Test Loss: 1.941 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7406282424926758
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.995 Vali Acc: 0.560 Test Loss: 1.995 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.841099739074707
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.976 Vali Acc: 0.560 Test Loss: 1.976 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8392434120178223
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.540 Test Loss: 1.940 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7386858463287354
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.560 Test Loss: 1.927 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9182393550872803
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.560 Test Loss: 1.911 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 56439557
model size : 229.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.426027774810791
Epoch: 1, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.633 Vali Acc: 0.240 Test Loss: 1.633 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.043159008026123
Epoch: 2, Steps: 4 | Train Loss: 1.481 Vali Loss: 1.494 Vali Acc: 0.380 Test Loss: 1.494 Test Acc: 0.380
Validation loss decreased (-0.239984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 0.987313985824585
Epoch: 3, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.393 Vali Acc: 0.360 Test Loss: 1.393 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9340379238128662
Epoch: 4, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.458 Vali Acc: 0.360 Test Loss: 1.458 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9626541137695312
Epoch: 5, Steps: 4 | Train Loss: 0.623 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 0.9591350555419922
Epoch: 6, Steps: 4 | Train Loss: 0.431 Vali Loss: 1.428 Vali Acc: 0.400 Test Loss: 1.428 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9805402755737305
Epoch: 7, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.511 Vali Acc: 0.440 Test Loss: 1.511 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9228229522705078
Epoch: 8, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.621 Vali Acc: 0.460 Test Loss: 1.621 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459984).  Saving model ...
Epoch: 9 cost time: 1.0000941753387451
Epoch: 9, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.234 Vali Acc: 0.520 Test Loss: 1.234 Test Acc: 0.520
Validation loss decreased (-0.459984 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 1.0526025295257568
Epoch: 10, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.484 Vali Acc: 0.480 Test Loss: 1.484 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.133310317993164
Epoch: 11, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 1.0306775569915771
Epoch: 12, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.706 Vali Acc: 0.480 Test Loss: 1.706 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9871687889099121
Epoch: 13, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.512 Vali Acc: 0.480 Test Loss: 1.512 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7867748737335205
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.679 Vali Acc: 0.440 Test Loss: 1.679 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7524232864379883
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.097 Vali Acc: 0.460 Test Loss: 2.097 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7512562274932861
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.849 Vali Acc: 0.520 Test Loss: 1.849 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7912578582763672
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.425 Vali Acc: 0.540 Test Loss: 1.425 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7987818717956543
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.552 Vali Acc: 0.560 Test Loss: 1.552 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559984).  Saving model ...
Epoch: 19 cost time: 0.7983584403991699
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.500 Test Loss: 1.763 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7941112518310547
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.942 Vali Acc: 0.520 Test Loss: 1.942 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7962706089019775
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.010 Vali Acc: 0.520 Test Loss: 2.010 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7283542156219482
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.025 Vali Acc: 0.520 Test Loss: 2.025 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7948791980743408
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.012 Vali Acc: 0.520 Test Loss: 2.012 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9222261905670166
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.500 Test Loss: 2.000 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9565944671630859
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.976 Vali Acc: 0.520 Test Loss: 1.976 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9417769908905029
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.947 Vali Acc: 0.520 Test Loss: 1.947 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9439914226531982
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.920 Vali Acc: 0.540 Test Loss: 1.920 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9585933685302734
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.560 Test Loss: 1.900 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 56332037
model size : 229.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.357508420944214
Epoch: 1, Steps: 4 | Train Loss: 1.974 Vali Loss: 1.692 Vali Acc: 0.200 Test Loss: 1.692 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.9868373870849609
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.451 Vali Acc: 0.340 Test Loss: 1.451 Test Acc: 0.340
Validation loss decreased (-0.199983 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 0.9525108337402344
Epoch: 3, Steps: 4 | Train Loss: 1.278 Vali Loss: 1.447 Vali Acc: 0.420 Test Loss: 1.447 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 0.9127309322357178
Epoch: 4, Steps: 4 | Train Loss: 0.790 Vali Loss: 1.358 Vali Acc: 0.480 Test Loss: 1.358 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479986).  Saving model ...
Epoch: 5 cost time: 0.9690341949462891
Epoch: 5, Steps: 4 | Train Loss: 0.520 Vali Loss: 1.608 Vali Acc: 0.440 Test Loss: 1.608 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9478659629821777
Epoch: 6, Steps: 4 | Train Loss: 0.359 Vali Loss: 1.430 Vali Acc: 0.480 Test Loss: 1.430 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8053796291351318
Epoch: 7, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.245 Vali Acc: 0.460 Test Loss: 1.245 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1900644302368164
Epoch: 8, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.733 Vali Acc: 0.500 Test Loss: 1.733 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499983).  Saving model ...
Epoch: 9 cost time: 0.9087409973144531
Epoch: 9, Steps: 4 | Train Loss: 0.158 Vali Loss: 2.276 Vali Acc: 0.500 Test Loss: 2.276 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9472982883453369
Epoch: 10, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.744 Vali Acc: 0.440 Test Loss: 1.744 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0007777214050293
Epoch: 11, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.824 Vali Acc: 0.560 Test Loss: 1.824 Test Acc: 0.560
Validation loss decreased (-0.499983 --> -0.559982).  Saving model ...
Epoch: 12 cost time: 1.062706470489502
Epoch: 12, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.920 Vali Acc: 0.500 Test Loss: 1.920 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1182844638824463
Epoch: 13, Steps: 4 | Train Loss: 0.060 Vali Loss: 2.200 Vali Acc: 0.540 Test Loss: 2.200 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1584272384643555
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.556 Vali Acc: 0.600 Test Loss: 1.556 Test Acc: 0.600
Validation loss decreased (-0.559982 --> -0.599984).  Saving model ...
Epoch: 15 cost time: 1.00913405418396
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.130 Vali Acc: 0.540 Test Loss: 2.130 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9244332313537598
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.271 Vali Acc: 0.560 Test Loss: 2.271 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8948533535003662
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.834 Vali Acc: 0.460 Test Loss: 2.834 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0417988300323486
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.602 Vali Acc: 0.540 Test Loss: 2.602 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1686427593231201
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.473 Vali Acc: 0.620 Test Loss: 2.473 Test Acc: 0.620
Validation loss decreased (-0.599984 --> -0.619975).  Saving model ...
Epoch: 20 cost time: 1.052431344985962
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.408 Vali Acc: 0.560 Test Loss: 2.408 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.051792860031128
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.580 Test Loss: 2.388 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0251598358154297
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.358 Vali Acc: 0.580 Test Loss: 2.358 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.044020414352417
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.580 Test Loss: 2.331 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.054457664489746
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.312 Vali Acc: 0.580 Test Loss: 2.312 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9800145626068115
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.303 Vali Acc: 0.600 Test Loss: 2.303 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0633108615875244
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.298 Vali Acc: 0.600 Test Loss: 2.298 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2461395263671875
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.294 Vali Acc: 0.620 Test Loss: 2.294 Test Acc: 0.620
Validation loss decreased (-0.619975 --> -0.619977).  Saving model ...
Epoch: 28 cost time: 1.1924431324005127
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.292 Vali Acc: 0.620 Test Loss: 2.292 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 29 cost time: 1.0119187831878662
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.291 Vali Acc: 0.620 Test Loss: 2.291 Test Acc: 0.620
Validation loss decreased (-0.619977 --> -0.619977).  Saving model ...
Epoch: 30 cost time: 1.1634407043457031
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.294 Vali Acc: 0.620 Test Loss: 2.294 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1342623233795166
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.295 Vali Acc: 0.620 Test Loss: 2.295 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1113190650939941
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.297 Vali Acc: 0.620 Test Loss: 2.297 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1123909950256348
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.300 Vali Acc: 0.620 Test Loss: 2.300 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.165947437286377
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.310 Vali Acc: 0.620 Test Loss: 2.310 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2024354934692383
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.317 Vali Acc: 0.620 Test Loss: 2.317 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.170750379562378
Epoch: 36, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.323 Vali Acc: 0.620 Test Loss: 2.323 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1170756816864014
Epoch: 37, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.329 Vali Acc: 0.620 Test Loss: 2.329 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.180856704711914
Epoch: 38, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.332 Vali Acc: 0.620 Test Loss: 2.332 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.147024393081665
Epoch: 39, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.336 Vali Acc: 0.620 Test Loss: 2.336 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 59769605
model size : 242.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2678732872009277
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.630 Vali Acc: 0.200 Test Loss: 1.630 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.0931272506713867
Epoch: 2, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.486 Vali Acc: 0.380 Test Loss: 1.486 Test Acc: 0.380
Validation loss decreased (-0.199984 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.0342531204223633
Epoch: 3, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.0991079807281494
Epoch: 4, Steps: 4 | Train Loss: 0.825 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 1.1064715385437012
Epoch: 5, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.182 Vali Acc: 0.440 Test Loss: 1.182 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439988).  Saving model ...
Epoch: 6 cost time: 1.107480525970459
Epoch: 6, Steps: 4 | Train Loss: 0.359 Vali Loss: 1.171 Vali Acc: 0.540 Test Loss: 1.171 Test Acc: 0.540
Validation loss decreased (-0.439988 --> -0.539988).  Saving model ...
Epoch: 7 cost time: 1.0078229904174805
Epoch: 7, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.430 Vali Acc: 0.480 Test Loss: 1.430 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0619208812713623
Epoch: 8, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.359 Vali Acc: 0.520 Test Loss: 1.359 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8762333393096924
Epoch: 9, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.766 Vali Acc: 0.480 Test Loss: 1.766 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8981664180755615
Epoch: 10, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.388 Vali Acc: 0.440 Test Loss: 1.388 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7928328514099121
Epoch: 11, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.722 Vali Acc: 0.480 Test Loss: 1.722 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7640650272369385
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9175138473510742
Epoch: 13, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.520 Vali Acc: 0.520 Test Loss: 1.520 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9990391731262207
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.450 Vali Acc: 0.540 Test Loss: 1.450 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0311694145202637
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.921 Vali Acc: 0.560 Test Loss: 1.921 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559981).  Saving model ...
Epoch: 16 cost time: 0.9396636486053467
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.767 Vali Acc: 0.480 Test Loss: 2.767 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9735877513885498
Epoch: 17, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.406 Vali Acc: 0.520 Test Loss: 2.406 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8022630214691162
Epoch: 18, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.279 Vali Acc: 0.480 Test Loss: 2.279 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7142205238342285
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.051 Vali Acc: 0.480 Test Loss: 2.051 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2018299102783203
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.092 Vali Acc: 0.500 Test Loss: 2.092 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9420969486236572
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.168 Vali Acc: 0.520 Test Loss: 2.168 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.221740484237671
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.297 Vali Acc: 0.500 Test Loss: 2.297 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9340536594390869
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.353 Vali Acc: 0.480 Test Loss: 2.353 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9059693813323975
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.396 Vali Acc: 0.480 Test Loss: 2.396 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9390945434570312
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.622 Vali Acc: 0.500 Test Loss: 2.622 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 59538437
model size : 241.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.709731340408325
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.697 Vali Acc: 0.160 Test Loss: 1.697 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.1465165615081787
Epoch: 2, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.577 Vali Acc: 0.360 Test Loss: 1.577 Test Acc: 0.360
Validation loss decreased (-0.159983 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 0.9900436401367188
Epoch: 3, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.481 Vali Acc: 0.420 Test Loss: 1.481 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 0.9533514976501465
Epoch: 4, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.008829116821289
Epoch: 5, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.391 Vali Acc: 0.440 Test Loss: 1.391 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.0279228687286377
Epoch: 6, Steps: 4 | Train Loss: 0.373 Vali Loss: 1.656 Vali Acc: 0.520 Test Loss: 1.656 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519983).  Saving model ...
Epoch: 7 cost time: 0.9424710273742676
Epoch: 7, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.313 Vali Acc: 0.560 Test Loss: 1.313 Test Acc: 0.560
Validation loss decreased (-0.519983 --> -0.559987).  Saving model ...
Epoch: 8 cost time: 0.7763159275054932
Epoch: 8, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.532 Vali Acc: 0.460 Test Loss: 1.532 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9470276832580566
Epoch: 9, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.375 Vali Acc: 0.480 Test Loss: 1.375 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.942075252532959
Epoch: 10, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.813 Vali Acc: 0.420 Test Loss: 1.813 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0567994117736816
Epoch: 11, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9469249248504639
Epoch: 12, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.753 Vali Acc: 0.520 Test Loss: 1.753 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9764320850372314
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.866 Vali Acc: 0.500 Test Loss: 1.866 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8251564502716064
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2447590827941895
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.300 Vali Acc: 0.520 Test Loss: 1.300 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8852646350860596
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.391 Vali Acc: 0.540 Test Loss: 1.391 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0068368911743164
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.632 Vali Acc: 0.540 Test Loss: 1.632 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 59420165
model size : 241.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8146448135375977
Epoch: 1, Steps: 4 | Train Loss: 1.850 Vali Loss: 1.581 Vali Acc: 0.280 Test Loss: 1.581 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.0910775661468506
Epoch: 2, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.612 Vali Acc: 0.200 Test Loss: 1.612 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0568039417266846
Epoch: 3, Steps: 4 | Train Loss: 1.227 Vali Loss: 1.550 Vali Acc: 0.400 Test Loss: 1.550 Test Acc: 0.400
Validation loss decreased (-0.279984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.159900426864624
Epoch: 4, Steps: 4 | Train Loss: 0.779 Vali Loss: 1.377 Vali Acc: 0.460 Test Loss: 1.377 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.0331699848175049
Epoch: 5, Steps: 4 | Train Loss: 0.683 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 1.2121002674102783
Epoch: 6, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.505 Vali Acc: 0.560 Test Loss: 1.505 Test Acc: 0.560
Validation loss decreased (-0.499985 --> -0.559985).  Saving model ...
Epoch: 7 cost time: 1.0545318126678467
Epoch: 7, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.530 Vali Acc: 0.500 Test Loss: 1.530 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.113311529159546
Epoch: 8, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.704 Vali Acc: 0.500 Test Loss: 1.704 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7949166297912598
Epoch: 9, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.672 Vali Acc: 0.520 Test Loss: 1.672 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.933671236038208
Epoch: 10, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.801 Vali Acc: 0.480 Test Loss: 1.801 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9473507404327393
Epoch: 11, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.173 Vali Acc: 0.560 Test Loss: 1.173 Test Acc: 0.560
Validation loss decreased (-0.559985 --> -0.559988).  Saving model ...
Epoch: 12 cost time: 0.8120548725128174
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.637 Vali Acc: 0.440 Test Loss: 1.637 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0987346172332764
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.705 Vali Acc: 0.500 Test Loss: 1.705 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0425424575805664
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.617 Vali Acc: 0.500 Test Loss: 1.617 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3612298965454102
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.881 Vali Acc: 0.520 Test Loss: 1.881 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.263258934020996
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.949 Vali Acc: 0.540 Test Loss: 1.949 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.270085096359253
Epoch: 17, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.864 Vali Acc: 0.520 Test Loss: 1.864 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0440034866333008
Epoch: 18, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.500 Test Loss: 1.851 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.26645827293396
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.480 Test Loss: 1.855 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0426466464996338
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.460 Test Loss: 1.843 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0649497509002686
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.420 Test Loss: 1.874 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 62750213
model size : 254.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.261631965637207
Epoch: 1, Steps: 4 | Train Loss: 1.783 Vali Loss: 1.718 Vali Acc: 0.240 Test Loss: 1.718 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.116962194442749
Epoch: 2, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.485 Vali Acc: 0.260 Test Loss: 1.485 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 0.7373621463775635
Epoch: 3, Steps: 4 | Train Loss: 1.089 Vali Loss: 1.351 Vali Acc: 0.440 Test Loss: 1.351 Test Acc: 0.440
Validation loss decreased (-0.259985 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 1.0090968608856201
Epoch: 4, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.353 Vali Acc: 0.440 Test Loss: 1.353 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0078177452087402
Epoch: 5, Steps: 4 | Train Loss: 0.486 Vali Loss: 1.487 Vali Acc: 0.440 Test Loss: 1.487 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9570844173431396
Epoch: 6, Steps: 4 | Train Loss: 0.371 Vali Loss: 1.442 Vali Acc: 0.480 Test Loss: 1.442 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 7 cost time: 0.8723249435424805
Epoch: 7, Steps: 4 | Train Loss: 0.249 Vali Loss: 1.328 Vali Acc: 0.520 Test Loss: 1.328 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 0.8575947284698486
Epoch: 8, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.534 Vali Acc: 0.500 Test Loss: 1.534 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9888367652893066
Epoch: 9, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.371 Vali Acc: 0.480 Test Loss: 1.371 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1605315208435059
Epoch: 10, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.384 Vali Acc: 0.440 Test Loss: 1.384 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2009854316711426
Epoch: 11, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.305 Vali Acc: 0.400 Test Loss: 1.305 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9263820648193359
Epoch: 12, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.760 Vali Acc: 0.420 Test Loss: 1.760 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9166393280029297
Epoch: 13, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.721 Vali Acc: 0.460 Test Loss: 1.721 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.942274808883667
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.728 Vali Acc: 0.480 Test Loss: 1.728 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9181804656982422
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.264 Vali Acc: 0.440 Test Loss: 2.264 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9002299308776855
Epoch: 16, Steps: 4 | Train Loss: 0.043 Vali Loss: 2.277 Vali Acc: 0.440 Test Loss: 2.277 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9040212631225586
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.784 Vali Acc: 0.420 Test Loss: 1.784 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 62599685
model size : 253.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.256554365158081
Epoch: 1, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.732 Vali Acc: 0.200 Test Loss: 1.732 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.1533334255218506
Epoch: 2, Steps: 4 | Train Loss: 1.726 Vali Loss: 1.540 Vali Acc: 0.280 Test Loss: 1.540 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 0.9792008399963379
Epoch: 3, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (-0.279985 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.0965533256530762
Epoch: 4, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.269 Vali Acc: 0.380 Test Loss: 1.269 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1931178569793701
Epoch: 5, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.293 Vali Acc: 0.380 Test Loss: 1.293 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1066553592681885
Epoch: 6, Steps: 4 | Train Loss: 0.446 Vali Loss: 1.267 Vali Acc: 0.440 Test Loss: 1.267 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439987).  Saving model ...
Epoch: 7 cost time: 1.215402603149414
Epoch: 7, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.405 Vali Acc: 0.440 Test Loss: 1.405 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0648136138916016
Epoch: 8, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.396 Vali Acc: 0.440 Test Loss: 1.396 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9446938037872314
Epoch: 9, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.547 Vali Acc: 0.480 Test Loss: 1.547 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479985).  Saving model ...
Epoch: 10 cost time: 0.98809814453125
Epoch: 10, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.679 Vali Acc: 0.440 Test Loss: 1.679 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8852999210357666
Epoch: 11, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.724 Vali Acc: 0.500 Test Loss: 1.724 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499983).  Saving model ...
Epoch: 12 cost time: 0.9153251647949219
Epoch: 12, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.784 Vali Acc: 0.540 Test Loss: 1.784 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539982).  Saving model ...
Epoch: 13 cost time: 0.950721025466919
Epoch: 13, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.571 Vali Acc: 0.540 Test Loss: 1.571 Test Acc: 0.540
Validation loss decreased (-0.539982 --> -0.539984).  Saving model ...
Epoch: 14 cost time: 1.043609380722046
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.482 Vali Acc: 0.520 Test Loss: 1.482 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9998910427093506
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.617 Vali Acc: 0.580 Test Loss: 1.617 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579984).  Saving model ...
Epoch: 16 cost time: 0.9226474761962891
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.844 Vali Acc: 0.480 Test Loss: 1.844 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9352164268493652
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.881 Vali Acc: 0.460 Test Loss: 1.881 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9035623073577881
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.803 Vali Acc: 0.520 Test Loss: 1.803 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1729984283447266
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.560 Test Loss: 1.690 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7901737689971924
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.540 Test Loss: 1.619 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.878704309463501
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.500 Test Loss: 1.620 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.002934217453003
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.540 Test Loss: 1.689 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.202392578125
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.580 Test Loss: 1.749 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.132817268371582
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.580 Test Loss: 1.794 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9238929748535156
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.580 Test Loss: 1.812 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 62508293
model size : 253.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6229114532470703
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.618 Vali Acc: 0.180 Test Loss: 1.618 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.0619451999664307
Epoch: 2, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.527 Vali Acc: 0.340 Test Loss: 1.527 Test Acc: 0.340
Validation loss decreased (-0.179984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.1210143566131592
Epoch: 3, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.439 Vali Acc: 0.340 Test Loss: 1.439 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339986).  Saving model ...
Epoch: 4 cost time: 1.148439645767212
Epoch: 4, Steps: 4 | Train Loss: 0.812 Vali Loss: 1.261 Vali Acc: 0.420 Test Loss: 1.261 Test Acc: 0.420
Validation loss decreased (-0.339986 --> -0.419987).  Saving model ...
Epoch: 5 cost time: 1.1406776905059814
Epoch: 5, Steps: 4 | Train Loss: 0.561 Vali Loss: 1.399 Vali Acc: 0.440 Test Loss: 1.399 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.361541986465454
Epoch: 6, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.182 Vali Acc: 0.520 Test Loss: 1.182 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 1.1308987140655518
Epoch: 7, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.923 Vali Acc: 0.340 Test Loss: 1.923 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1806018352508545
Epoch: 8, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.434 Vali Acc: 0.520 Test Loss: 1.434 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0171129703521729
Epoch: 9, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1163487434387207
Epoch: 10, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.489 Vali Acc: 0.540 Test Loss: 1.489 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539985).  Saving model ...
Epoch: 11 cost time: 1.0961108207702637
Epoch: 11, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.479 Vali Acc: 0.500 Test Loss: 1.479 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0377190113067627
Epoch: 12, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.002 Vali Acc: 0.500 Test Loss: 2.002 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3397674560546875
Epoch: 13, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.342 Vali Acc: 0.600 Test Loss: 1.342 Test Acc: 0.600
Validation loss decreased (-0.539985 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 1.239182472229004
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.267 Vali Acc: 0.540 Test Loss: 2.267 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8741867542266846
Epoch: 15, Steps: 4 | Train Loss: 0.034 Vali Loss: 2.022 Vali Acc: 0.580 Test Loss: 2.022 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0404279232025146
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.854 Vali Acc: 0.520 Test Loss: 1.854 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9632461071014404
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.259 Vali Acc: 0.540 Test Loss: 2.259 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1135280132293701
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.102 Vali Acc: 0.420 Test Loss: 3.102 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2090859413146973
Epoch: 19, Steps: 4 | Train Loss: 0.054 Vali Loss: 2.368 Vali Acc: 0.460 Test Loss: 2.368 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3677480220794678
Epoch: 20, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.773 Vali Acc: 0.560 Test Loss: 1.773 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.319859504699707
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.833 Vali Acc: 0.520 Test Loss: 1.833 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0371572971343994
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.795 Vali Acc: 0.500 Test Loss: 1.795 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8915767669677734
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.699 Vali Acc: 0.540 Test Loss: 1.699 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 65849093
model size : 265.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.892929792404175
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.670 Vali Acc: 0.180 Test Loss: 1.670 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.16452956199646
Epoch: 2, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.575 Vali Acc: 0.340 Test Loss: 1.575 Test Acc: 0.340
Validation loss decreased (-0.179983 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 0.9575669765472412
Epoch: 3, Steps: 4 | Train Loss: 1.137 Vali Loss: 1.551 Vali Acc: 0.360 Test Loss: 1.551 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.1953504085540771
Epoch: 4, Steps: 4 | Train Loss: 0.924 Vali Loss: 1.382 Vali Acc: 0.360 Test Loss: 1.382 Test Acc: 0.360
Validation loss decreased (-0.359984 --> -0.359986).  Saving model ...
Epoch: 5 cost time: 1.0346598625183105
Epoch: 5, Steps: 4 | Train Loss: 0.520 Vali Loss: 1.308 Vali Acc: 0.480 Test Loss: 1.308 Test Acc: 0.480
Validation loss decreased (-0.359986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 0.8706445693969727
Epoch: 6, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.360 Vali Acc: 0.540 Test Loss: 1.360 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539986).  Saving model ...
Epoch: 7 cost time: 0.8807716369628906
Epoch: 7, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.675 Vali Acc: 0.420 Test Loss: 1.675 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8324604034423828
Epoch: 8, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.881 Vali Acc: 0.420 Test Loss: 1.881 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0175387859344482
Epoch: 9, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.455 Vali Acc: 0.520 Test Loss: 1.455 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8395907878875732
Epoch: 10, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.473 Vali Acc: 0.500 Test Loss: 1.473 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0070841312408447
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.554 Vali Acc: 0.520 Test Loss: 1.554 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9570403099060059
Epoch: 12, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.888 Vali Acc: 0.520 Test Loss: 1.888 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2358527183532715
Epoch: 13, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.912 Vali Acc: 0.480 Test Loss: 1.912 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.332507848739624
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.612 Vali Acc: 0.560 Test Loss: 1.612 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559984).  Saving model ...
Epoch: 15 cost time: 1.1006560325622559
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.476 Vali Acc: 0.600 Test Loss: 1.476 Test Acc: 0.600
Validation loss decreased (-0.559984 --> -0.599985).  Saving model ...
Epoch: 16 cost time: 1.0872337818145752
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.480 Vali Acc: 0.600 Test Loss: 1.480 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0002152919769287
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.600 Test Loss: 1.631 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.029630422592163
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.580 Test Loss: 1.830 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1100399494171143
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.560 Test Loss: 1.997 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9409186840057373
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.097 Vali Acc: 0.560 Test Loss: 2.097 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2154300212860107
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.560 Test Loss: 2.146 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3179779052734375
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.580 Test Loss: 2.149 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2861239910125732
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.135 Vali Acc: 0.580 Test Loss: 2.135 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3252365589141846
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.124 Vali Acc: 0.580 Test Loss: 2.124 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3131747245788574
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.082 Vali Acc: 0.580 Test Loss: 2.082 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 65698565
model size : 265.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.332223892211914
Epoch: 1, Steps: 4 | Train Loss: 1.782 Vali Loss: 1.550 Vali Acc: 0.240 Test Loss: 1.550 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 0.8707411289215088
Epoch: 2, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.503 Vali Acc: 0.280 Test Loss: 1.503 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.0477724075317383
Epoch: 3, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.520 Vali Acc: 0.320 Test Loss: 1.520 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.034536361694336
Epoch: 4, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.415 Vali Acc: 0.380 Test Loss: 1.415 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 1.1447453498840332
Epoch: 5, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.339 Vali Acc: 0.480 Test Loss: 1.339 Test Acc: 0.480
Validation loss decreased (-0.379986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 1.0827958583831787
Epoch: 6, Steps: 4 | Train Loss: 0.450 Vali Loss: 1.216 Vali Acc: 0.460 Test Loss: 1.216 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1208298206329346
Epoch: 7, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.150 Vali Acc: 0.540 Test Loss: 1.150 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 1.309253215789795
Epoch: 8, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.418 Vali Acc: 0.420 Test Loss: 1.418 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3036210536956787
Epoch: 9, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.653 Vali Acc: 0.460 Test Loss: 1.653 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9983119964599609
Epoch: 10, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.362 Vali Acc: 0.540 Test Loss: 1.362 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0169391632080078
Epoch: 11, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.803 Vali Acc: 0.440 Test Loss: 1.803 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0998525619506836
Epoch: 12, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.323 Vali Acc: 0.540 Test Loss: 1.323 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0552818775177002
Epoch: 13, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.597 Vali Acc: 0.520 Test Loss: 1.597 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0903289318084717
Epoch: 14, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.433 Vali Acc: 0.480 Test Loss: 1.433 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1005663871765137
Epoch: 15, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.612 Vali Acc: 0.500 Test Loss: 1.612 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.010631799697876
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.706 Vali Acc: 0.480 Test Loss: 1.706 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8626477718353271
Epoch: 17, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.753 Vali Acc: 0.460 Test Loss: 1.753 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 65601797
model size : 264.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6353235244750977
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.599 Vali Acc: 0.280 Test Loss: 1.599 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 0.962346076965332
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.614 Vali Acc: 0.220 Test Loss: 1.614 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0475420951843262
Epoch: 3, Steps: 4 | Train Loss: 1.159 Vali Loss: 1.497 Vali Acc: 0.360 Test Loss: 1.497 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 0.9354360103607178
Epoch: 4, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.428 Vali Acc: 0.320 Test Loss: 1.428 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.09012770652771
Epoch: 5, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.654 Vali Acc: 0.420 Test Loss: 1.654 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419983).  Saving model ...
Epoch: 6 cost time: 1.3420677185058594
Epoch: 6, Steps: 4 | Train Loss: 0.398 Vali Loss: 1.466 Vali Acc: 0.420 Test Loss: 1.466 Test Acc: 0.420
Validation loss decreased (-0.419983 --> -0.419985).  Saving model ...
Epoch: 7 cost time: 1.2519114017486572
Epoch: 7, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.533 Vali Acc: 0.460 Test Loss: 1.533 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459985).  Saving model ...
Epoch: 8 cost time: 1.3826487064361572
Epoch: 8, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.331 Vali Acc: 0.500 Test Loss: 1.331 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 1.1310765743255615
Epoch: 9, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.968 Vali Acc: 0.480 Test Loss: 1.968 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3310675621032715
Epoch: 10, Steps: 4 | Train Loss: 0.063 Vali Loss: 2.224 Vali Acc: 0.480 Test Loss: 2.224 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.372821569442749
Epoch: 11, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.846 Vali Acc: 0.500 Test Loss: 1.846 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3801944255828857
Epoch: 12, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.708 Vali Acc: 0.540 Test Loss: 1.708 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539983).  Saving model ...
Epoch: 13 cost time: 1.4657227993011475
Epoch: 13, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.069 Vali Acc: 0.520 Test Loss: 2.069 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9678001403808594
Epoch: 14, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.290 Vali Acc: 0.540 Test Loss: 2.290 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.057924747467041
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.821 Vali Acc: 0.540 Test Loss: 1.821 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.081749439239502
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.698 Vali Acc: 0.520 Test Loss: 1.698 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0600779056549072
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.877 Vali Acc: 0.540 Test Loss: 1.877 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1135222911834717
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.982 Vali Acc: 0.540 Test Loss: 1.982 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1314122676849365
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.560 Test Loss: 2.013 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559980).  Saving model ...
Epoch: 20 cost time: 1.434326410293579
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.981 Vali Acc: 0.580 Test Loss: 1.981 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579980).  Saving model ...
Epoch: 21 cost time: 1.2073862552642822
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.580 Test Loss: 1.932 Test Acc: 0.580
Validation loss decreased (-0.579980 --> -0.579981).  Saving model ...
Epoch: 22 cost time: 1.3192832469940186
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.903 Vali Acc: 0.580 Test Loss: 1.903 Test Acc: 0.580
Validation loss decreased (-0.579981 --> -0.579981).  Saving model ...
Epoch: 23 cost time: 0.9903233051300049
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.580 Test Loss: 1.859 Test Acc: 0.580
Validation loss decreased (-0.579981 --> -0.579981).  Saving model ...
Epoch: 24 cost time: 1.0911567211151123
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.915 Vali Acc: 0.560 Test Loss: 1.915 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.073258876800537
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.961 Vali Acc: 0.520 Test Loss: 1.961 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0784542560577393
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.999 Vali Acc: 0.520 Test Loss: 1.999 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9011843204498291
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.520 Test Loss: 2.023 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9869527816772461
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.039 Vali Acc: 0.520 Test Loss: 2.039 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1281538009643555
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.520 Test Loss: 2.050 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1565206050872803
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.052 Vali Acc: 0.520 Test Loss: 2.052 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.022660255432129
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.520 Test Loss: 2.049 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3751585483551025
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.048 Vali Acc: 0.520 Test Loss: 2.048 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4082050323486328
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.045 Vali Acc: 0.520 Test Loss: 2.045 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 68942597
model size : 277.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.479748249053955
Epoch: 1, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.638 Vali Acc: 0.280 Test Loss: 1.638 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.0033578872680664
Epoch: 2, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.609 Vali Acc: 0.340 Test Loss: 1.609 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.0655879974365234
Epoch: 3, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.585 Vali Acc: 0.280 Test Loss: 1.585 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8414349555969238
Epoch: 4, Steps: 4 | Train Loss: 0.754 Vali Loss: 1.483 Vali Acc: 0.340 Test Loss: 1.483 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 0.9752309322357178
Epoch: 5, Steps: 4 | Train Loss: 0.654 Vali Loss: 1.429 Vali Acc: 0.380 Test Loss: 1.429 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379986).  Saving model ...
Epoch: 6 cost time: 1.2756993770599365
Epoch: 6, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.279 Vali Acc: 0.460 Test Loss: 1.279 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 0.9605953693389893
Epoch: 7, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.643 Vali Acc: 0.460 Test Loss: 1.643 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9779653549194336
Epoch: 8, Steps: 4 | Train Loss: 0.265 Vali Loss: 1.368 Vali Acc: 0.480 Test Loss: 1.368 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479986).  Saving model ...
Epoch: 9 cost time: 0.9372961521148682
Epoch: 9, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.656 Vali Acc: 0.460 Test Loss: 1.656 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0431270599365234
Epoch: 10, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.700 Vali Acc: 0.500 Test Loss: 1.700 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499983).  Saving model ...
Epoch: 11 cost time: 1.0799376964569092
Epoch: 11, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.373 Vali Acc: 0.540 Test Loss: 1.373 Test Acc: 0.540
Validation loss decreased (-0.499983 --> -0.539986).  Saving model ...
Epoch: 12 cost time: 0.8984405994415283
Epoch: 12, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.794 Vali Acc: 0.500 Test Loss: 1.794 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.005671501159668
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.826 Vali Acc: 0.480 Test Loss: 1.826 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1074457168579102
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.618 Vali Acc: 0.560 Test Loss: 1.618 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559984).  Saving model ...
Epoch: 15 cost time: 1.1126489639282227
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.577 Vali Acc: 0.600 Test Loss: 1.577 Test Acc: 0.600
Validation loss decreased (-0.559984 --> -0.599984).  Saving model ...
Epoch: 16 cost time: 0.9345693588256836
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.781 Vali Acc: 0.580 Test Loss: 1.781 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2775802612304688
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.979 Vali Acc: 0.500 Test Loss: 1.979 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1234543323516846
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.118 Vali Acc: 0.500 Test Loss: 2.118 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.127887487411499
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.140 Vali Acc: 0.500 Test Loss: 2.140 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1190965175628662
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.108 Vali Acc: 0.500 Test Loss: 2.108 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2448675632476807
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.095 Vali Acc: 0.520 Test Loss: 2.095 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3044588565826416
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.520 Test Loss: 2.089 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0338282585144043
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.520 Test Loss: 2.089 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0176911354064941
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.090 Vali Acc: 0.500 Test Loss: 2.090 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9756209850311279
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.096 Vali Acc: 0.500 Test Loss: 2.096 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 68770565
model size : 277.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8205299377441406
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.636 Vali Acc: 0.140 Test Loss: 1.636 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.0203328132629395
Epoch: 2, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.583 Vali Acc: 0.220 Test Loss: 1.583 Test Acc: 0.220
Validation loss decreased (-0.139984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.107192039489746
Epoch: 3, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.505 Vali Acc: 0.380 Test Loss: 1.505 Test Acc: 0.380
Validation loss decreased (-0.219984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 0.9388508796691895
Epoch: 4, Steps: 4 | Train Loss: 0.766 Vali Loss: 1.415 Vali Acc: 0.440 Test Loss: 1.415 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.0943520069122314
Epoch: 5, Steps: 4 | Train Loss: 0.497 Vali Loss: 1.347 Vali Acc: 0.480 Test Loss: 1.347 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 1.2214462757110596
Epoch: 6, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.494 Vali Acc: 0.440 Test Loss: 1.494 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9507722854614258
Epoch: 7, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.578 Vali Acc: 0.400 Test Loss: 1.578 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1733999252319336
Epoch: 8, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.329 Vali Acc: 0.460 Test Loss: 1.329 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1936514377593994
Epoch: 9, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.398 Vali Acc: 0.520 Test Loss: 1.398 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519986).  Saving model ...
Epoch: 10 cost time: 1.364511489868164
Epoch: 10, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3679354190826416
Epoch: 11, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.443 Vali Acc: 0.460 Test Loss: 1.443 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0399093627929688
Epoch: 12, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.159341812133789
Epoch: 13, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.162 Vali Acc: 0.540 Test Loss: 1.162 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539988).  Saving model ...
Epoch: 14 cost time: 1.1131536960601807
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.196 Vali Acc: 0.540 Test Loss: 1.196 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0363357067108154
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.555 Vali Acc: 0.540 Test Loss: 1.555 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.884188175201416
Epoch: 16, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.634 Vali Acc: 0.500 Test Loss: 1.634 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0463697910308838
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.530 Vali Acc: 0.520 Test Loss: 1.530 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9805855751037598
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.874 Vali Acc: 0.500 Test Loss: 1.874 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0053420066833496
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.249 Vali Acc: 0.440 Test Loss: 2.249 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9710862636566162
Epoch: 20, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.855 Vali Acc: 0.500 Test Loss: 1.855 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.02801513671875
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.757 Vali Acc: 0.500 Test Loss: 1.757 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9957773685455322
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.951 Vali Acc: 0.500 Test Loss: 1.951 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9061863422393799
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.109 Vali Acc: 0.480 Test Loss: 2.109 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 68695301
model size : 276.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.3703296184539795
Epoch: 1, Steps: 4 | Train Loss: 1.775 Vali Loss: 1.657 Vali Acc: 0.140 Test Loss: 1.657 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 0.8448302745819092
Epoch: 2, Steps: 4 | Train Loss: 1.528 Vali Loss: 1.584 Vali Acc: 0.380 Test Loss: 1.584 Test Acc: 0.380
Validation loss decreased (-0.139983 --> -0.379984).  Saving model ...
Epoch: 3 cost time: 1.074263095855713
Epoch: 3, Steps: 4 | Train Loss: 1.108 Vali Loss: 1.668 Vali Acc: 0.400 Test Loss: 1.668 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 1.140502691268921
Epoch: 4, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.402 Vali Acc: 0.340 Test Loss: 1.402 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2270088195800781
Epoch: 5, Steps: 4 | Train Loss: 0.476 Vali Loss: 1.517 Vali Acc: 0.400 Test Loss: 1.517 Test Acc: 0.400
Validation loss decreased (-0.399983 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 1.0233030319213867
Epoch: 6, Steps: 4 | Train Loss: 0.348 Vali Loss: 1.495 Vali Acc: 0.420 Test Loss: 1.495 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 7 cost time: 0.8882956504821777
Epoch: 7, Steps: 4 | Train Loss: 0.225 Vali Loss: 2.053 Vali Acc: 0.380 Test Loss: 2.053 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.993375301361084
Epoch: 8, Steps: 4 | Train Loss: 0.179 Vali Loss: 2.059 Vali Acc: 0.460 Test Loss: 2.059 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459979).  Saving model ...
Epoch: 9 cost time: 1.056731939315796
Epoch: 9, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.529 Vali Acc: 0.440 Test Loss: 1.529 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0391385555267334
Epoch: 10, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.761 Vali Acc: 0.440 Test Loss: 1.761 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9514024257659912
Epoch: 11, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.414 Vali Acc: 0.480 Test Loss: 1.414 Test Acc: 0.480
Validation loss decreased (-0.459979 --> -0.479986).  Saving model ...
Epoch: 12 cost time: 0.95827317237854
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.017 Vali Acc: 0.520 Test Loss: 2.017 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519980).  Saving model ...
Epoch: 13 cost time: 0.992154598236084
Epoch: 13, Steps: 4 | Train Loss: 0.017 Vali Loss: 2.178 Vali Acc: 0.520 Test Loss: 2.178 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9603126049041748
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.830 Vali Acc: 0.480 Test Loss: 1.830 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9740204811096191
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.115 Vali Acc: 0.480 Test Loss: 2.115 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9556348323822021
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.262 Vali Acc: 0.440 Test Loss: 2.262 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9061729907989502
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.389 Vali Acc: 0.440 Test Loss: 2.389 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9674527645111084
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.449 Vali Acc: 0.500 Test Loss: 2.449 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9750869274139404
Epoch: 19, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.413 Vali Acc: 0.480 Test Loss: 2.413 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9406318664550781
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.395 Vali Acc: 0.460 Test Loss: 2.395 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9367530345916748
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.381 Vali Acc: 0.500 Test Loss: 2.381 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9628093242645264
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.376 Vali Acc: 0.520 Test Loss: 2.376 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 72041477
model size : 289.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4786360263824463
Epoch: 1, Steps: 4 | Train Loss: 1.768 Vali Loss: 1.664 Vali Acc: 0.200 Test Loss: 1.664 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.8855276107788086
Epoch: 2, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.536 Vali Acc: 0.320 Test Loss: 1.536 Test Acc: 0.320
Validation loss decreased (-0.199983 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 0.9200177192687988
Epoch: 3, Steps: 4 | Train Loss: 1.159 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
Validation loss decreased (-0.319985 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.9518129825592041
Epoch: 4, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.307 Vali Acc: 0.480 Test Loss: 1.307 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7830810546875
Epoch: 5, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.272 Vali Acc: 0.420 Test Loss: 1.272 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8126580715179443
Epoch: 6, Steps: 4 | Train Loss: 0.428 Vali Loss: 1.747 Vali Acc: 0.500 Test Loss: 1.747 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8186311721801758
Epoch: 7, Steps: 4 | Train Loss: 0.243 Vali Loss: 1.350 Vali Acc: 0.520 Test Loss: 1.350 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 0.8505263328552246
Epoch: 8, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.525 Vali Acc: 0.480 Test Loss: 1.525 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8070347309112549
Epoch: 9, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.329 Vali Acc: 0.500 Test Loss: 1.329 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8405373096466064
Epoch: 10, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.680 Vali Acc: 0.500 Test Loss: 1.680 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8133831024169922
Epoch: 11, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.226 Vali Acc: 0.520 Test Loss: 1.226 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519988).  Saving model ...
Epoch: 12 cost time: 0.9795293807983398
Epoch: 12, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.386 Vali Acc: 0.540 Test Loss: 1.386 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539986).  Saving model ...
Epoch: 13 cost time: 1.1046907901763916
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.634 Vali Acc: 0.500 Test Loss: 1.634 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9956538677215576
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.423 Vali Acc: 0.480 Test Loss: 1.423 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0050315856933594
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0391793251037598
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.549 Vali Acc: 0.580 Test Loss: 1.549 Test Acc: 0.580
Validation loss decreased (-0.539986 --> -0.579985).  Saving model ...
Epoch: 17 cost time: 1.0055367946624756
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.420 Vali Acc: 0.600 Test Loss: 1.420 Test Acc: 0.600
Validation loss decreased (-0.579985 --> -0.599986).  Saving model ...
Epoch: 18 cost time: 1.046607255935669
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.483 Vali Acc: 0.520 Test Loss: 1.483 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.01004958152771
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.708 Vali Acc: 0.560 Test Loss: 1.708 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.966374397277832
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.500 Test Loss: 1.928 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8129477500915527
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.111 Vali Acc: 0.480 Test Loss: 2.111 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9186022281646729
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.249 Vali Acc: 0.480 Test Loss: 2.249 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9271984100341797
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.289 Vali Acc: 0.520 Test Loss: 2.289 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9802579879760742
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.282 Vali Acc: 0.500 Test Loss: 2.282 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9513635635375977
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.222 Vali Acc: 0.540 Test Loss: 2.222 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0395393371582031
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.141 Vali Acc: 0.560 Test Loss: 2.141 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9587111473083496
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.071 Vali Acc: 0.560 Test Loss: 2.071 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 71869445
model size : 288.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.381951332092285
Epoch: 1, Steps: 4 | Train Loss: 1.767 Vali Loss: 1.652 Vali Acc: 0.200 Test Loss: 1.652 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.943690299987793
Epoch: 2, Steps: 4 | Train Loss: 1.637 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 0.8194522857666016
Epoch: 3, Steps: 4 | Train Loss: 1.124 Vali Loss: 1.459 Vali Acc: 0.440 Test Loss: 1.459 Test Acc: 0.440
Validation loss decreased (-0.239984 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 0.9631986618041992
Epoch: 4, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.310 Vali Acc: 0.440 Test Loss: 1.310 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439987).  Saving model ...
Epoch: 5 cost time: 1.0073609352111816
Epoch: 5, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.334 Vali Acc: 0.460 Test Loss: 1.334 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459987).  Saving model ...
Epoch: 6 cost time: 0.987595796585083
Epoch: 6, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.8999035358428955
Epoch: 7, Steps: 4 | Train Loss: 0.303 Vali Loss: 1.333 Vali Acc: 0.440 Test Loss: 1.333 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9132184982299805
Epoch: 8, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.558 Vali Acc: 0.460 Test Loss: 1.558 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9709782600402832
Epoch: 9, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9413282871246338
Epoch: 10, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.771 Vali Acc: 0.460 Test Loss: 1.771 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8028268814086914
Epoch: 11, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.584 Vali Acc: 0.440 Test Loss: 1.584 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9222879409790039
Epoch: 12, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9295268058776855
Epoch: 13, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.558 Vali Acc: 0.460 Test Loss: 1.558 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9451518058776855
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.498 Vali Acc: 0.460 Test Loss: 1.498 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.063018798828125
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.382 Vali Acc: 0.480 Test Loss: 1.382 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9830713272094727
Epoch: 16, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.374 Vali Acc: 0.500 Test Loss: 1.374 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 71783429
model size : 288.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.296839714050293
Epoch: 1, Steps: 4 | Train Loss: 1.820 Vali Loss: 1.703 Vali Acc: 0.200 Test Loss: 1.703 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.1215453147888184
Epoch: 2, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.606 Vali Acc: 0.300 Test Loss: 1.606 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.1293084621429443
Epoch: 3, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.472 Vali Acc: 0.340 Test Loss: 1.472 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.1706526279449463
Epoch: 4, Steps: 4 | Train Loss: 0.785 Vali Loss: 1.460 Vali Acc: 0.420 Test Loss: 1.460 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 1.111851453781128
Epoch: 5, Steps: 4 | Train Loss: 0.461 Vali Loss: 1.671 Vali Acc: 0.400 Test Loss: 1.671 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0746612548828125
Epoch: 6, Steps: 4 | Train Loss: 0.303 Vali Loss: 1.709 Vali Acc: 0.500 Test Loss: 1.709 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499983).  Saving model ...
Epoch: 7 cost time: 1.0773632526397705
Epoch: 7, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.761 Vali Acc: 0.480 Test Loss: 1.761 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0405688285827637
Epoch: 8, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.681 Vali Acc: 0.520 Test Loss: 1.681 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519983).  Saving model ...
Epoch: 9 cost time: 1.091555118560791
Epoch: 9, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.789 Vali Acc: 0.480 Test Loss: 1.789 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9486432075500488
Epoch: 10, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.465 Vali Acc: 0.540 Test Loss: 1.465 Test Acc: 0.540
Validation loss decreased (-0.519983 --> -0.539985).  Saving model ...
Epoch: 11 cost time: 0.8671505451202393
Epoch: 11, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.291 Vali Acc: 0.380 Test Loss: 3.291 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0553476810455322
Epoch: 12, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.782 Vali Acc: 0.460 Test Loss: 1.782 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0657837390899658
Epoch: 13, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.878 Vali Acc: 0.500 Test Loss: 1.878 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0348412990570068
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.760 Vali Acc: 0.400 Test Loss: 1.760 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0954344272613525
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.441 Vali Acc: 0.480 Test Loss: 1.441 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.169569730758667
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.755 Vali Acc: 0.520 Test Loss: 1.755 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1860699653625488
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.953 Vali Acc: 0.540 Test Loss: 1.953 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8316073417663574
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.003 Vali Acc: 0.560 Test Loss: 2.003 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559980).  Saving model ...
Epoch: 19 cost time: 1.0822601318359375
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.994 Vali Acc: 0.560 Test Loss: 1.994 Test Acc: 0.560
Validation loss decreased (-0.559980 --> -0.559980).  Saving model ...
Epoch: 20 cost time: 1.0991308689117432
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.580 Test Loss: 2.003 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579980).  Saving model ...
Epoch: 21 cost time: 1.156604290008545
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.560 Test Loss: 2.015 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1487011909484863
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.032 Vali Acc: 0.560 Test Loss: 2.032 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1016252040863037
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.054 Vali Acc: 0.560 Test Loss: 2.054 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0948739051818848
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.095 Vali Acc: 0.560 Test Loss: 2.095 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1574311256408691
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.580 Test Loss: 2.129 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2024712562561035
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.153 Vali Acc: 0.600 Test Loss: 2.153 Test Acc: 0.600
Validation loss decreased (-0.579980 --> -0.599978).  Saving model ...
Epoch: 27 cost time: 1.2154529094696045
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.166 Vali Acc: 0.600 Test Loss: 2.166 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2050697803497314
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.600 Test Loss: 2.164 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.072523593902588
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.600 Test Loss: 2.149 Test Acc: 0.600
Validation loss decreased (-0.599978 --> -0.599979).  Saving model ...
Epoch: 30 cost time: 1.2339284420013428
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.600 Test Loss: 2.136 Test Acc: 0.600
Validation loss decreased (-0.599979 --> -0.599979).  Saving model ...
Epoch: 31 cost time: 1.1800603866577148
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.128 Vali Acc: 0.600 Test Loss: 2.128 Test Acc: 0.600
Validation loss decreased (-0.599979 --> -0.599979).  Saving model ...
Epoch: 32 cost time: 1.2084152698516846
Epoch: 32, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.580 Test Loss: 2.111 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1813008785247803
Epoch: 33, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.078 Vali Acc: 0.560 Test Loss: 2.078 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.177443504333496
Epoch: 34, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.560 Test Loss: 2.067 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1568350791931152
Epoch: 35, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.068 Vali Acc: 0.560 Test Loss: 2.068 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2039809226989746
Epoch: 36, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.070 Vali Acc: 0.560 Test Loss: 2.070 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2157626152038574
Epoch: 37, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.560 Test Loss: 2.064 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2277331352233887
Epoch: 38, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.063 Vali Acc: 0.560 Test Loss: 2.063 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1849370002746582
Epoch: 39, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.560 Test Loss: 2.064 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1692442893981934
Epoch: 40, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.066 Vali Acc: 0.560 Test Loss: 2.066 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0634474754333496
Epoch: 41, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.072 Vali Acc: 0.560 Test Loss: 2.072 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps17_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 75070469
model size : 301.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.519758939743042
Epoch: 1, Steps: 4 | Train Loss: 1.775 Vali Loss: 1.605 Vali Acc: 0.200 Test Loss: 1.605 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.0892231464385986
Epoch: 2, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.556 Vali Acc: 0.240 Test Loss: 1.556 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.0320758819580078
Epoch: 3, Steps: 4 | Train Loss: 1.160 Vali Loss: 1.486 Vali Acc: 0.280 Test Loss: 1.486 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.0964510440826416
Epoch: 4, Steps: 4 | Train Loss: 0.666 Vali Loss: 1.413 Vali Acc: 0.420 Test Loss: 1.413 Test Acc: 0.420
Validation loss decreased (-0.279985 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 1.1012308597564697
Epoch: 5, Steps: 4 | Train Loss: 0.541 Vali Loss: 1.325 Vali Acc: 0.460 Test Loss: 1.325 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 6 cost time: 1.1235430240631104
Epoch: 6, Steps: 4 | Train Loss: 0.384 Vali Loss: 1.315 Vali Acc: 0.440 Test Loss: 1.315 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0478887557983398
Epoch: 7, Steps: 4 | Train Loss: 0.238 Vali Loss: 1.281 Vali Acc: 0.520 Test Loss: 1.281 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 1.0990912914276123
Epoch: 8, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.408 Vali Acc: 0.500 Test Loss: 1.408 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.123934030532837
Epoch: 9, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.450 Vali Acc: 0.480 Test Loss: 1.450 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0960798263549805
Epoch: 10, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.872 Vali Acc: 0.420 Test Loss: 1.872 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0673749446868896
Epoch: 11, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.603 Vali Acc: 0.480 Test Loss: 1.603 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0437395572662354
Epoch: 12, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.521 Vali Acc: 0.520 Test Loss: 1.521 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.173264503479004
Epoch: 13, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.565 Vali Acc: 0.540 Test Loss: 1.565 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539984).  Saving model ...
Epoch: 14 cost time: 1.0294435024261475
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.632 Vali Acc: 0.540 Test Loss: 1.632 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1706461906433105
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.531 Vali Acc: 0.500 Test Loss: 1.531 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.149827241897583
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.535 Vali Acc: 0.580 Test Loss: 1.535 Test Acc: 0.580
Validation loss decreased (-0.539984 --> -0.579985).  Saving model ...
Epoch: 17 cost time: 1.1337511539459229
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.604 Vali Acc: 0.580 Test Loss: 1.604 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2155001163482666
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.540 Test Loss: 1.744 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1374492645263672
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.838 Vali Acc: 0.520 Test Loss: 1.838 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1913871765136719
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.540 Test Loss: 1.898 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0888702869415283
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.540 Test Loss: 2.005 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.215688705444336
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.520 Test Loss: 2.092 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2114894390106201
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.520 Test Loss: 2.064 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1911695003509521
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.520 Test Loss: 1.960 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.051100730895996
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.580 Test Loss: 1.796 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1982572078704834
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.560 Test Loss: 1.702 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps17_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 74952197
model size : 300.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8085482120513916
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.577 Vali Acc: 0.340 Test Loss: 1.577 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.1429119110107422
Epoch: 2, Steps: 4 | Train Loss: 1.483 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379986).  Saving model ...
Epoch: 3 cost time: 1.132309913635254
Epoch: 3, Steps: 4 | Train Loss: 1.101 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.0796120166778564
Epoch: 4, Steps: 4 | Train Loss: 0.824 Vali Loss: 1.313 Vali Acc: 0.380 Test Loss: 1.313 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1065664291381836
Epoch: 5, Steps: 4 | Train Loss: 0.739 Vali Loss: 1.461 Vali Acc: 0.400 Test Loss: 1.461 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.036919355392456
Epoch: 6, Steps: 4 | Train Loss: 0.362 Vali Loss: 1.268 Vali Acc: 0.400 Test Loss: 1.268 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 1.1701304912567139
Epoch: 7, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.289 Vali Acc: 0.440 Test Loss: 1.289 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439987).  Saving model ...
Epoch: 8 cost time: 1.116499900817871
Epoch: 8, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.392 Vali Acc: 0.400 Test Loss: 1.392 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0934641361236572
Epoch: 9, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1367008686065674
Epoch: 10, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.837 Vali Acc: 0.320 Test Loss: 1.837 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1162068843841553
Epoch: 11, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.364 Vali Acc: 0.460 Test Loss: 1.364 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459986).  Saving model ...
Epoch: 12 cost time: 1.1033494472503662
Epoch: 12, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.693 Vali Acc: 0.440 Test Loss: 1.693 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0745103359222412
Epoch: 13, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.455 Vali Acc: 0.480 Test Loss: 1.455 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479985).  Saving model ...
Epoch: 14 cost time: 1.1723549365997314
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.546 Vali Acc: 0.460 Test Loss: 1.546 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.075782060623169
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.932 Vali Acc: 0.420 Test Loss: 1.932 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0912115573883057
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.119 Vali Acc: 0.440 Test Loss: 2.119 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0877151489257812
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.846 Vali Acc: 0.440 Test Loss: 1.846 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0928795337677002
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.406 Vali Acc: 0.540 Test Loss: 1.406 Test Acc: 0.540
Validation loss decreased (-0.479985 --> -0.539986).  Saving model ...
Epoch: 19 cost time: 1.1403326988220215
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.547 Vali Acc: 0.500 Test Loss: 1.547 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.119779348373413
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.902 Vali Acc: 0.440 Test Loss: 1.902 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0866146087646484
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.163 Vali Acc: 0.440 Test Loss: 2.163 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.079118013381958
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.263 Vali Acc: 0.440 Test Loss: 2.263 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.05926513671875
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.220 Vali Acc: 0.420 Test Loss: 2.220 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1451301574707031
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.126 Vali Acc: 0.420 Test Loss: 2.126 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1363461017608643
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.460 Test Loss: 2.038 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1630899906158447
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.460 Test Loss: 1.971 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9460005760192871
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.460 Test Loss: 1.936 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0503957271575928
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.480 Test Loss: 1.934 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps17_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 74876933
model size : 300.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.2498779296875
Epoch: 1, Steps: 4 | Train Loss: 1.888 Vali Loss: 1.599 Vali Acc: 0.260 Test Loss: 1.599 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 0.9506936073303223
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.487 Vali Acc: 0.400 Test Loss: 1.487 Test Acc: 0.400
Validation loss decreased (-0.259984 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 1.077925682067871
Epoch: 3, Steps: 4 | Train Loss: 1.083 Vali Loss: 1.426 Vali Acc: 0.480 Test Loss: 1.426 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479986).  Saving model ...
Epoch: 4 cost time: 1.0381100177764893
Epoch: 4, Steps: 4 | Train Loss: 0.700 Vali Loss: 1.300 Vali Acc: 0.360 Test Loss: 1.300 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0153605937957764
Epoch: 5, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.407 Vali Acc: 0.400 Test Loss: 1.407 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9542062282562256
Epoch: 6, Steps: 4 | Train Loss: 0.336 Vali Loss: 1.362 Vali Acc: 0.460 Test Loss: 1.362 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1031994819641113
Epoch: 7, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.897 Vali Acc: 0.420 Test Loss: 1.897 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0357074737548828
Epoch: 8, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.612 Vali Acc: 0.400 Test Loss: 1.612 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.040349006652832
Epoch: 9, Steps: 4 | Train Loss: 0.093 Vali Loss: 2.017 Vali Acc: 0.440 Test Loss: 2.017 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0592639446258545
Epoch: 10, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.675 Vali Acc: 0.460 Test Loss: 1.675 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9890933036804199
Epoch: 11, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.468 Vali Acc: 0.540 Test Loss: 1.468 Test Acc: 0.540
Validation loss decreased (-0.479986 --> -0.539985).  Saving model ...
Epoch: 12 cost time: 0.9483942985534668
Epoch: 12, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.346 Vali Acc: 0.580 Test Loss: 1.346 Test Acc: 0.580
Validation loss decreased (-0.539985 --> -0.579987).  Saving model ...
Epoch: 13 cost time: 0.878821849822998
Epoch: 13, Steps: 4 | Train Loss: 0.016 Vali Loss: 2.907 Vali Acc: 0.480 Test Loss: 2.907 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0150816440582275
Epoch: 14, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.591 Vali Acc: 0.560 Test Loss: 1.591 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0802831649780273
Epoch: 15, Steps: 4 | Train Loss: 0.112 Vali Loss: 2.077 Vali Acc: 0.520 Test Loss: 2.077 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9842662811279297
Epoch: 16, Steps: 4 | Train Loss: 0.108 Vali Loss: 2.435 Vali Acc: 0.500 Test Loss: 2.435 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0064914226531982
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.412 Vali Acc: 0.480 Test Loss: 2.412 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8767213821411133
Epoch: 18, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.182 Vali Acc: 0.480 Test Loss: 2.182 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0349020957946777
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.075 Vali Acc: 0.500 Test Loss: 2.075 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8638837337493896
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.078 Vali Acc: 0.540 Test Loss: 2.078 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9675943851470947
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.177 Vali Acc: 0.500 Test Loss: 2.177 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0134479999542236
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.240 Vali Acc: 0.460 Test Loss: 2.240 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 78169349
model size : 312.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.482309341430664
Epoch: 1, Steps: 4 | Train Loss: 1.840 Vali Loss: 1.637 Vali Acc: 0.180 Test Loss: 1.637 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.1001386642456055
Epoch: 2, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.641 Vali Acc: 0.340 Test Loss: 1.641 Test Acc: 0.340
Validation loss decreased (-0.179984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.0856812000274658
Epoch: 3, Steps: 4 | Train Loss: 1.029 Vali Loss: 1.607 Vali Acc: 0.360 Test Loss: 1.607 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.0422947406768799
Epoch: 4, Steps: 4 | Train Loss: 0.909 Vali Loss: 1.591 Vali Acc: 0.420 Test Loss: 1.591 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419984).  Saving model ...
Epoch: 5 cost time: 1.017347812652588
Epoch: 5, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.481 Vali Acc: 0.400 Test Loss: 1.481 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.103261947631836
Epoch: 6, Steps: 4 | Train Loss: 0.364 Vali Loss: 1.482 Vali Acc: 0.400 Test Loss: 1.482 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9886155128479004
Epoch: 7, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.374 Vali Acc: 0.440 Test Loss: 1.374 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 0.9933257102966309
Epoch: 8, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.562 Vali Acc: 0.440 Test Loss: 1.562 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0445997714996338
Epoch: 9, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.510 Vali Acc: 0.460 Test Loss: 1.510 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459985).  Saving model ...
Epoch: 10 cost time: 1.0450739860534668
Epoch: 10, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.731 Vali Acc: 0.400 Test Loss: 1.731 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0579118728637695
Epoch: 11, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.407 Vali Acc: 0.520 Test Loss: 1.407 Test Acc: 0.520
Validation loss decreased (-0.459985 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 1.044306993484497
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.740 Vali Acc: 0.500 Test Loss: 1.740 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0256195068359375
Epoch: 13, Steps: 4 | Train Loss: 0.013 Vali Loss: 2.195 Vali Acc: 0.460 Test Loss: 2.195 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.073056697845459
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.472 Vali Acc: 0.600 Test Loss: 1.472 Test Acc: 0.600
Validation loss decreased (-0.519986 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 1.0209789276123047
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.729 Vali Acc: 0.620 Test Loss: 1.729 Test Acc: 0.620
Validation loss decreased (-0.599985 --> -0.619983).  Saving model ...
Epoch: 16 cost time: 0.9683103561401367
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.761 Vali Acc: 0.600 Test Loss: 1.761 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0512473583221436
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.560 Test Loss: 1.644 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9763762950897217
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.636 Vali Acc: 0.540 Test Loss: 1.636 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0111949443817139
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.717 Vali Acc: 0.560 Test Loss: 1.717 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9746189117431641
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.909 Vali Acc: 0.580 Test Loss: 1.909 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.050107717514038
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.064 Vali Acc: 0.580 Test Loss: 2.064 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0398459434509277
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.085 Vali Acc: 0.580 Test Loss: 2.085 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0467734336853027
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.085 Vali Acc: 0.560 Test Loss: 2.085 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.053452730178833
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.560 Test Loss: 2.069 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9987573623657227
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.053 Vali Acc: 0.560 Test Loss: 2.053 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 78051077
model size : 312.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6430001258850098
Epoch: 1, Steps: 4 | Train Loss: 1.769 Vali Loss: 1.641 Vali Acc: 0.160 Test Loss: 1.641 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.1253032684326172
Epoch: 2, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.543 Vali Acc: 0.300 Test Loss: 1.543 Test Acc: 0.300
Validation loss decreased (-0.159984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.0896594524383545
Epoch: 3, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.472 Vali Acc: 0.360 Test Loss: 1.472 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.1127650737762451
Epoch: 4, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.475 Vali Acc: 0.380 Test Loss: 1.475 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.0740776062011719
Epoch: 5, Steps: 4 | Train Loss: 0.611 Vali Loss: 1.363 Vali Acc: 0.440 Test Loss: 1.363 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 1.1055505275726318
Epoch: 6, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.251 Vali Acc: 0.460 Test Loss: 1.251 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 1.112138032913208
Epoch: 7, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.320 Vali Acc: 0.520 Test Loss: 1.320 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 1.1005463600158691
Epoch: 8, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.381 Vali Acc: 0.500 Test Loss: 1.381 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0990674495697021
Epoch: 9, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.083 Vali Acc: 0.540 Test Loss: 1.083 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539989).  Saving model ...
Epoch: 10 cost time: 1.1394312381744385
Epoch: 10, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.521 Vali Acc: 0.460 Test Loss: 1.521 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0162804126739502
Epoch: 11, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.247 Vali Acc: 0.480 Test Loss: 1.247 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0170555114746094
Epoch: 12, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.358 Vali Acc: 0.540 Test Loss: 1.358 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8680558204650879
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.754 Vali Acc: 0.460 Test Loss: 1.754 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0216686725616455
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.483 Vali Acc: 0.520 Test Loss: 1.483 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0622882843017578
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.419 Vali Acc: 0.540 Test Loss: 1.419 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9660241603851318
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.613 Vali Acc: 0.520 Test Loss: 1.613 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9554252624511719
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.876 Vali Acc: 0.500 Test Loss: 1.876 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8898568153381348
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.870 Vali Acc: 0.500 Test Loss: 1.870 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9964430332183838
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.700 Vali Acc: 0.540 Test Loss: 1.700 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 77975813
model size : 312.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4309792518615723
Epoch: 1, Steps: 4 | Train Loss: 1.725 Vali Loss: 1.662 Vali Acc: 0.240 Test Loss: 1.662 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.1004705429077148
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.478 Vali Acc: 0.340 Test Loss: 1.478 Test Acc: 0.340
Validation loss decreased (-0.239983 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.1222710609436035
Epoch: 3, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.321 Vali Acc: 0.420 Test Loss: 1.321 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419987).  Saving model ...
Epoch: 4 cost time: 1.0004777908325195
Epoch: 4, Steps: 4 | Train Loss: 0.857 Vali Loss: 1.300 Vali Acc: 0.440 Test Loss: 1.300 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439987).  Saving model ...
Epoch: 5 cost time: 1.1425890922546387
Epoch: 5, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.321 Vali Acc: 0.540 Test Loss: 1.321 Test Acc: 0.540
Validation loss decreased (-0.439987 --> -0.539987).  Saving model ...
Epoch: 6 cost time: 1.0369691848754883
Epoch: 6, Steps: 4 | Train Loss: 0.614 Vali Loss: 1.263 Vali Acc: 0.460 Test Loss: 1.263 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0463461875915527
Epoch: 7, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.319 Vali Acc: 0.540 Test Loss: 1.319 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 1.0934474468231201
Epoch: 8, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 1.0848314762115479
Epoch: 9, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.986 Vali Acc: 0.500 Test Loss: 1.986 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0699524879455566
Epoch: 10, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.801 Vali Acc: 0.500 Test Loss: 1.801 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.107344388961792
Epoch: 11, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.985 Vali Acc: 0.480 Test Loss: 1.985 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.098543643951416
Epoch: 12, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.560 Vali Acc: 0.500 Test Loss: 1.560 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1026270389556885
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.994 Vali Acc: 0.480 Test Loss: 1.994 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0497729778289795
Epoch: 14, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.998 Vali Acc: 0.560 Test Loss: 1.998 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559980).  Saving model ...
Epoch: 15 cost time: 1.0912742614746094
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.626 Vali Acc: 0.580 Test Loss: 1.626 Test Acc: 0.580
Validation loss decreased (-0.559980 --> -0.579984).  Saving model ...
Epoch: 16 cost time: 1.1148319244384766
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.121 Vali Acc: 0.500 Test Loss: 2.121 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9728426933288574
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.759 Vali Acc: 0.500 Test Loss: 2.759 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0740272998809814
Epoch: 18, Steps: 4 | Train Loss: 0.071 Vali Loss: 3.149 Vali Acc: 0.480 Test Loss: 3.149 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1300334930419922
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 3.472 Vali Acc: 0.500 Test Loss: 3.472 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1059062480926514
Epoch: 20, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.820 Vali Acc: 0.560 Test Loss: 1.820 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.076338529586792
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.133 Vali Acc: 0.540 Test Loss: 2.133 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0679333209991455
Epoch: 22, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.696 Vali Acc: 0.500 Test Loss: 1.696 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0834813117980957
Epoch: 23, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.639 Vali Acc: 0.520 Test Loss: 1.639 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9762513637542725
Epoch: 24, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.097 Vali Acc: 0.520 Test Loss: 2.097 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1102464199066162
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.161 Vali Acc: 0.500 Test Loss: 2.161 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps20_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 84367109
model size : 336.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4930431842803955
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.652 Vali Acc: 0.220 Test Loss: 1.652 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.0645828247070312
Epoch: 2, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.467 Vali Acc: 0.320 Test Loss: 1.467 Test Acc: 0.320
Validation loss decreased (-0.219983 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.1060733795166016
Epoch: 3, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 1.1335546970367432
Epoch: 4, Steps: 4 | Train Loss: 0.639 Vali Loss: 1.323 Vali Acc: 0.420 Test Loss: 1.323 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 5 cost time: 1.0303919315338135
Epoch: 5, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1227803230285645
Epoch: 6, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.314 Vali Acc: 0.460 Test Loss: 1.314 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 1.1522026062011719
Epoch: 7, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.203 Vali Acc: 0.460 Test Loss: 1.203 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 8 cost time: 1.1345431804656982
Epoch: 8, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.727 Vali Acc: 0.380 Test Loss: 1.727 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0749404430389404
Epoch: 9, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.148 Vali Acc: 0.520 Test Loss: 1.148 Test Acc: 0.520
Validation loss decreased (-0.459988 --> -0.519989).  Saving model ...
Epoch: 10 cost time: 1.063070297241211
Epoch: 10, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.751 Vali Acc: 0.440 Test Loss: 1.751 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0793733596801758
Epoch: 11, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.209 Vali Acc: 0.460 Test Loss: 1.209 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1179347038269043
Epoch: 12, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.583 Vali Acc: 0.460 Test Loss: 1.583 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0955452919006348
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.736 Vali Acc: 0.460 Test Loss: 1.736 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9595611095428467
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.425 Vali Acc: 0.540 Test Loss: 1.425 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539986).  Saving model ...
Epoch: 15 cost time: 0.9396719932556152
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.856 Vali Acc: 0.520 Test Loss: 1.856 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9019992351531982
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.093 Vali Acc: 0.480 Test Loss: 2.093 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9496309757232666
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.591 Vali Acc: 0.540 Test Loss: 1.591 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9375669956207275
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.445 Vali Acc: 0.540 Test Loss: 1.445 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9263432025909424
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.822 Vali Acc: 0.480 Test Loss: 1.822 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1598789691925049
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.099 Vali Acc: 0.460 Test Loss: 2.099 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1423187255859375
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.213 Vali Acc: 0.460 Test Loss: 2.213 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1645686626434326
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.192 Vali Acc: 0.460 Test Loss: 2.192 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.195472002029419
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.128 Vali Acc: 0.480 Test Loss: 2.128 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2365570068359375
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.480 Test Loss: 2.055 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps20_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 84232709
model size : 335.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4119713306427
Epoch: 1, Steps: 4 | Train Loss: 1.749 Vali Loss: 1.682 Vali Acc: 0.120 Test Loss: 1.682 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.0341684818267822
Epoch: 2, Steps: 4 | Train Loss: 1.447 Vali Loss: 1.556 Vali Acc: 0.300 Test Loss: 1.556 Test Acc: 0.300
Validation loss decreased (-0.119983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.227762222290039
Epoch: 3, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.497 Vali Acc: 0.320 Test Loss: 1.497 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.299034595489502
Epoch: 4, Steps: 4 | Train Loss: 0.802 Vali Loss: 1.379 Vali Acc: 0.480 Test Loss: 1.379 Test Acc: 0.480
Validation loss decreased (-0.319985 --> -0.479986).  Saving model ...
Epoch: 5 cost time: 1.2886338233947754
Epoch: 5, Steps: 4 | Train Loss: 0.479 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.2707290649414062
Epoch: 6, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.296 Vali Acc: 0.440 Test Loss: 1.296 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.076085090637207
Epoch: 7, Steps: 4 | Train Loss: 0.258 Vali Loss: 1.154 Vali Acc: 0.480 Test Loss: 1.154 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2138783931732178
Epoch: 8, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.288 Vali Acc: 0.480 Test Loss: 1.288 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2556228637695312
Epoch: 9, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.203 Vali Acc: 0.520 Test Loss: 1.203 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 1.3195762634277344
Epoch: 10, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.453 Vali Acc: 0.480 Test Loss: 1.453 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.228912353515625
Epoch: 11, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.407 Vali Acc: 0.440 Test Loss: 1.407 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1897013187408447
Epoch: 12, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.845 Vali Acc: 0.420 Test Loss: 1.845 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2787342071533203
Epoch: 13, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.530 Vali Acc: 0.480 Test Loss: 1.530 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2137222290039062
Epoch: 14, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.665 Vali Acc: 0.480 Test Loss: 1.665 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2486653327941895
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.086 Vali Acc: 0.440 Test Loss: 2.086 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1914916038513184
Epoch: 16, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.631 Vali Acc: 0.520 Test Loss: 1.631 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0271530151367188
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.807 Vali Acc: 0.460 Test Loss: 1.807 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2673008441925049
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.838 Vali Acc: 0.460 Test Loss: 1.838 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2055931091308594
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.882 Vali Acc: 0.480 Test Loss: 1.882 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps20_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 84162821
model size : 335.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.404869556427002
Epoch: 1, Steps: 4 | Train Loss: 1.852 Vali Loss: 1.698 Vali Acc: 0.100 Test Loss: 1.698 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 1.2216224670410156
Epoch: 2, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.674 Vali Acc: 0.280 Test Loss: 1.674 Test Acc: 0.280
Validation loss decreased (-0.099983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 1.2085609436035156
Epoch: 3, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.547 Vali Acc: 0.400 Test Loss: 1.547 Test Acc: 0.400
Validation loss decreased (-0.279983 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.2320239543914795
Epoch: 4, Steps: 4 | Train Loss: 0.781 Vali Loss: 1.508 Vali Acc: 0.480 Test Loss: 1.508 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479985).  Saving model ...
Epoch: 5 cost time: 1.2360007762908936
Epoch: 5, Steps: 4 | Train Loss: 0.443 Vali Loss: 1.454 Vali Acc: 0.540 Test Loss: 1.454 Test Acc: 0.540
Validation loss decreased (-0.479985 --> -0.539985).  Saving model ...
Epoch: 6 cost time: 1.2529363632202148
Epoch: 6, Steps: 4 | Train Loss: 0.361 Vali Loss: 1.278 Vali Acc: 0.600 Test Loss: 1.278 Test Acc: 0.600
Validation loss decreased (-0.539985 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 1.2312242984771729
Epoch: 7, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.733 Vali Acc: 0.540 Test Loss: 1.733 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.235276460647583
Epoch: 8, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.286 Vali Acc: 0.520 Test Loss: 1.286 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1997394561767578
Epoch: 9, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.394 Vali Acc: 0.560 Test Loss: 1.394 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2057294845581055
Epoch: 10, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2292885780334473
Epoch: 11, Steps: 4 | Train Loss: 0.037 Vali Loss: 2.359 Vali Acc: 0.540 Test Loss: 2.359 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2038958072662354
Epoch: 12, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.761 Vali Acc: 0.580 Test Loss: 1.761 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.03956937789917
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.390 Vali Acc: 0.620 Test Loss: 1.390 Test Acc: 0.620
Validation loss decreased (-0.599987 --> -0.619986).  Saving model ...
Epoch: 14 cost time: 1.221247673034668
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.523 Vali Acc: 0.560 Test Loss: 1.523 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1609609127044678
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.558 Vali Acc: 0.520 Test Loss: 1.558 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9454560279846191
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.545 Vali Acc: 0.540 Test Loss: 1.545 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.167983055114746
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.765 Vali Acc: 0.540 Test Loss: 1.765 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9025235176086426
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.963 Vali Acc: 0.540 Test Loss: 1.963 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.152562141418457
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.118 Vali Acc: 0.540 Test Loss: 2.118 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.144214391708374
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.237 Vali Acc: 0.500 Test Loss: 2.237 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1855223178863525
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.163 Vali Acc: 0.500 Test Loss: 2.163 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.174959421157837
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.068 Vali Acc: 0.500 Test Loss: 2.068 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1381747722625732
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.157 Vali Acc: 0.520 Test Loss: 2.157 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 87417605
model size : 348.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.822547435760498
Epoch: 1, Steps: 4 | Train Loss: 1.845 Vali Loss: 1.637 Vali Acc: 0.180 Test Loss: 1.637 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2697114944458008
Epoch: 2, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.598 Vali Acc: 0.280 Test Loss: 1.598 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.0514230728149414
Epoch: 3, Steps: 4 | Train Loss: 1.243 Vali Loss: 1.577 Vali Acc: 0.420 Test Loss: 1.577 Test Acc: 0.420
Validation loss decreased (-0.279984 --> -0.419984).  Saving model ...
Epoch: 4 cost time: 1.3192753791809082
Epoch: 4, Steps: 4 | Train Loss: 0.683 Vali Loss: 1.362 Vali Acc: 0.460 Test Loss: 1.362 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.2527616024017334
Epoch: 5, Steps: 4 | Train Loss: 0.842 Vali Loss: 1.213 Vali Acc: 0.420 Test Loss: 1.213 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2570078372955322
Epoch: 6, Steps: 4 | Train Loss: 0.346 Vali Loss: 1.224 Vali Acc: 0.380 Test Loss: 1.224 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.105726957321167
Epoch: 7, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.290 Vali Acc: 0.420 Test Loss: 1.290 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2858598232269287
Epoch: 8, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2643067836761475
Epoch: 9, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2329795360565186
Epoch: 10, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.514 Vali Acc: 0.400 Test Loss: 1.514 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.228489637374878
Epoch: 11, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.364 Vali Acc: 0.460 Test Loss: 1.364 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2113337516784668
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2804539203643799
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.517 Vali Acc: 0.440 Test Loss: 1.517 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2223422527313232
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.830 Vali Acc: 0.440 Test Loss: 1.830 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 87315461
model size : 347.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.296909809112549
Epoch: 1, Steps: 4 | Train Loss: 1.772 Vali Loss: 1.609 Vali Acc: 0.180 Test Loss: 1.609 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2863717079162598
Epoch: 2, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.594 Vali Acc: 0.260 Test Loss: 1.594 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.0836012363433838
Epoch: 3, Steps: 4 | Train Loss: 1.246 Vali Loss: 1.568 Vali Acc: 0.280 Test Loss: 1.568 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.2709379196166992
Epoch: 4, Steps: 4 | Train Loss: 0.839 Vali Loss: 1.492 Vali Acc: 0.300 Test Loss: 1.492 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.0474753379821777
Epoch: 5, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.393 Vali Acc: 0.380 Test Loss: 1.393 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379986).  Saving model ...
Epoch: 6 cost time: 1.0018458366394043
Epoch: 6, Steps: 4 | Train Loss: 0.368 Vali Loss: 1.492 Vali Acc: 0.420 Test Loss: 1.492 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419985).  Saving model ...
Epoch: 7 cost time: 0.9938058853149414
Epoch: 7, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.547 Vali Acc: 0.380 Test Loss: 1.547 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9722521305084229
Epoch: 8, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.354 Vali Acc: 0.420 Test Loss: 1.354 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 9 cost time: 1.0047607421875
Epoch: 9, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.771 Vali Acc: 0.420 Test Loss: 1.771 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9764513969421387
Epoch: 10, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.442 Vali Acc: 0.500 Test Loss: 1.442 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 1.2144582271575928
Epoch: 11, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.516 Vali Acc: 0.480 Test Loss: 1.516 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1814122200012207
Epoch: 12, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.837 Vali Acc: 0.420 Test Loss: 1.837 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.028595209121704
Epoch: 13, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.724 Vali Acc: 0.420 Test Loss: 1.724 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1395542621612549
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.659 Vali Acc: 0.460 Test Loss: 1.659 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1766445636749268
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.749 Vali Acc: 0.440 Test Loss: 1.749 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.165294885635376
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.907 Vali Acc: 0.440 Test Loss: 1.907 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0231547355651855
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.983 Vali Acc: 0.420 Test Loss: 1.983 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0985589027404785
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.060 Vali Acc: 0.420 Test Loss: 2.060 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0119247436523438
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.050 Vali Acc: 0.460 Test Loss: 2.050 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.138425350189209
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.011 Vali Acc: 0.460 Test Loss: 2.011 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 87256325
model size : 347.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7517170906066895
Epoch: 1, Steps: 4 | Train Loss: 1.781 Vali Loss: 1.597 Vali Acc: 0.180 Test Loss: 1.597 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.1323871612548828
Epoch: 2, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.551 Vali Acc: 0.360 Test Loss: 1.551 Test Acc: 0.360
Validation loss decreased (-0.179984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 1.1930077075958252
Epoch: 3, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.441 Vali Acc: 0.320 Test Loss: 1.441 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1414892673492432
Epoch: 4, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.384 Vali Acc: 0.440 Test Loss: 1.384 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 1.1740472316741943
Epoch: 5, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.528 Vali Acc: 0.400 Test Loss: 1.528 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1520988941192627
Epoch: 6, Steps: 4 | Train Loss: 0.500 Vali Loss: 1.326 Vali Acc: 0.460 Test Loss: 1.326 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 1.1322379112243652
Epoch: 7, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.263 Vali Acc: 0.520 Test Loss: 1.263 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 1.138841152191162
Epoch: 8, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.504 Vali Acc: 0.520 Test Loss: 1.504 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1164805889129639
Epoch: 9, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.626 Vali Acc: 0.520 Test Loss: 1.626 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0924031734466553
Epoch: 10, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.884 Vali Acc: 0.480 Test Loss: 1.884 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0273222923278809
Epoch: 11, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.819 Vali Acc: 0.480 Test Loss: 1.819 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9335575103759766
Epoch: 12, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.600 Vali Acc: 0.480 Test Loss: 1.600 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1143226623535156
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.651 Vali Acc: 0.480 Test Loss: 1.651 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0886309146881104
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.468 Vali Acc: 0.420 Test Loss: 2.468 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1118392944335938
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.467 Vali Acc: 0.480 Test Loss: 1.467 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1338136196136475
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.826 Vali Acc: 0.460 Test Loss: 1.826 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.074578046798706
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.805 Vali Acc: 0.500 Test Loss: 1.805 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 93615365
model size : 371.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.770293712615967
Epoch: 1, Steps: 4 | Train Loss: 1.804 Vali Loss: 1.605 Vali Acc: 0.260 Test Loss: 1.605 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.1945462226867676
Epoch: 2, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.723 Vali Acc: 0.300 Test Loss: 1.723 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.1355881690979004
Epoch: 3, Steps: 4 | Train Loss: 1.158 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.1847269535064697
Epoch: 4, Steps: 4 | Train Loss: 0.853 Vali Loss: 1.696 Vali Acc: 0.320 Test Loss: 1.696 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 5 cost time: 1.2799110412597656
Epoch: 5, Steps: 4 | Train Loss: 0.608 Vali Loss: 1.648 Vali Acc: 0.380 Test Loss: 1.648 Test Acc: 0.380
Validation loss decreased (-0.319983 --> -0.379984).  Saving model ...
Epoch: 6 cost time: 1.248556137084961
Epoch: 6, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.630 Vali Acc: 0.420 Test Loss: 1.630 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419984).  Saving model ...
Epoch: 7 cost time: 1.2125895023345947
Epoch: 7, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.318 Vali Acc: 0.460 Test Loss: 1.318 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459987).  Saving model ...
Epoch: 8 cost time: 1.1090795993804932
Epoch: 8, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.486 Vali Acc: 0.480 Test Loss: 1.486 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479985).  Saving model ...
Epoch: 9 cost time: 1.0196001529693604
Epoch: 9, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.661 Vali Acc: 0.480 Test Loss: 1.661 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.078627347946167
Epoch: 10, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.578 Vali Acc: 0.440 Test Loss: 1.578 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0107104778289795
Epoch: 11, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499985).  Saving model ...
Epoch: 12 cost time: 1.000701904296875
Epoch: 12, Steps: 4 | Train Loss: 0.030 Vali Loss: 2.037 Vali Acc: 0.460 Test Loss: 2.037 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.187293291091919
Epoch: 13, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.488 Vali Acc: 0.440 Test Loss: 1.488 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1561377048492432
Epoch: 14, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.662 Vali Acc: 0.460 Test Loss: 1.662 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1198384761810303
Epoch: 15, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.456 Vali Acc: 0.520 Test Loss: 1.456 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519985).  Saving model ...
Epoch: 16 cost time: 1.1660115718841553
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.548 Vali Acc: 0.500 Test Loss: 1.548 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0615379810333252
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.666 Vali Acc: 0.500 Test Loss: 1.666 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0626122951507568
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.833 Vali Acc: 0.520 Test Loss: 1.833 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0052926540374756
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.941 Vali Acc: 0.460 Test Loss: 1.941 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1269853115081787
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.965 Vali Acc: 0.460 Test Loss: 1.965 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.170501947402954
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.480 Test Loss: 1.953 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0452520847320557
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.480 Test Loss: 1.938 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0922253131866455
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.954 Vali Acc: 0.480 Test Loss: 1.954 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0305800437927246
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.480 Test Loss: 1.938 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.185567855834961
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.520 Test Loss: 1.909 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 93502469
model size : 371.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5902633666992188
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.662 Vali Acc: 0.260 Test Loss: 1.662 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.077354907989502
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.259983 --> -0.419985).  Saving model ...
Epoch: 3 cost time: 1.1508283615112305
Epoch: 3, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.400 Vali Acc: 0.480 Test Loss: 1.400 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479986).  Saving model ...
Epoch: 4 cost time: 1.1274306774139404
Epoch: 4, Steps: 4 | Train Loss: 0.739 Vali Loss: 1.270 Vali Acc: 0.560 Test Loss: 1.270 Test Acc: 0.560
Validation loss decreased (-0.479986 --> -0.559987).  Saving model ...
Epoch: 5 cost time: 1.1718041896820068
Epoch: 5, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2043685913085938
Epoch: 6, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.248 Vali Acc: 0.520 Test Loss: 1.248 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1292502880096436
Epoch: 7, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.049001932144165
Epoch: 8, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1563055515289307
Epoch: 9, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.307 Vali Acc: 0.540 Test Loss: 1.307 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1524014472961426
Epoch: 10, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1395249366760254
Epoch: 11, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.591 Vali Acc: 0.500 Test Loss: 1.591 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.139521598815918
Epoch: 12, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.366 Vali Acc: 0.500 Test Loss: 1.366 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1709794998168945
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.316 Vali Acc: 0.440 Test Loss: 1.316 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2420084476470947
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.609 Vali Acc: 0.460 Test Loss: 1.609 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 93448709
model size : 371.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps25_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.687762498855591
Epoch: 1, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.681 Vali Acc: 0.260 Test Loss: 1.681 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.2584037780761719
Epoch: 2, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.562 Vali Acc: 0.260 Test Loss: 1.562 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.2493529319763184
Epoch: 3, Steps: 4 | Train Loss: 1.243 Vali Loss: 1.483 Vali Acc: 0.380 Test Loss: 1.483 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 1.188324213027954
Epoch: 4, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.364 Vali Acc: 0.380 Test Loss: 1.364 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 5 cost time: 1.267232894897461
Epoch: 5, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.444 Vali Acc: 0.460 Test Loss: 1.444 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 1.1354141235351562
Epoch: 6, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.409 Vali Acc: 0.460 Test Loss: 1.409 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.2132883071899414
Epoch: 7, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.319 Vali Acc: 0.480 Test Loss: 1.319 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 1.2300376892089844
Epoch: 8, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.430 Vali Acc: 0.540 Test Loss: 1.430 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539986).  Saving model ...
Epoch: 9 cost time: 1.1265616416931152
Epoch: 9, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.508 Vali Acc: 0.480 Test Loss: 1.508 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0668916702270508
Epoch: 10, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.907 Vali Acc: 0.480 Test Loss: 1.907 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1933691501617432
Epoch: 11, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.429 Vali Acc: 0.620 Test Loss: 1.429 Test Acc: 0.620
Validation loss decreased (-0.539986 --> -0.619986).  Saving model ...
Epoch: 12 cost time: 1.1735074520111084
Epoch: 12, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.319 Vali Acc: 0.540 Test Loss: 1.319 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1815855503082275
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.850 Vali Acc: 0.480 Test Loss: 1.850 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2382607460021973
Epoch: 14, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.409 Vali Acc: 0.460 Test Loss: 1.409 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1450738906860352
Epoch: 15, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.807 Vali Acc: 0.540 Test Loss: 1.807 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.171870231628418
Epoch: 16, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.776 Vali Acc: 0.520 Test Loss: 1.776 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1839699745178223
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 2.109 Vali Acc: 0.480 Test Loss: 2.109 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.291534662246704
Epoch: 18, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.781 Vali Acc: 0.520 Test Loss: 1.781 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1094412803649902
Epoch: 19, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1259050369262695
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.340 Vali Acc: 0.460 Test Loss: 2.340 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.112757921218872
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.358 Vali Acc: 0.520 Test Loss: 2.358 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps25_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 99780869
model size : 395.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps25_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.783121347427368
Epoch: 1, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.600 Vali Acc: 0.260 Test Loss: 1.600 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.210566520690918
Epoch: 2, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.579 Vali Acc: 0.280 Test Loss: 1.579 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.3113524913787842
Epoch: 3, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.573 Vali Acc: 0.320 Test Loss: 1.573 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.2746663093566895
Epoch: 4, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.603 Vali Acc: 0.360 Test Loss: 1.603 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 5 cost time: 1.201024055480957
Epoch: 5, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.471 Vali Acc: 0.400 Test Loss: 1.471 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 1.0544471740722656
Epoch: 6, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.613 Vali Acc: 0.420 Test Loss: 1.613 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419984).  Saving model ...
Epoch: 7 cost time: 1.2308621406555176
Epoch: 7, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.637 Vali Acc: 0.380 Test Loss: 1.637 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.189612627029419
Epoch: 8, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.727 Vali Acc: 0.400 Test Loss: 1.727 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1251990795135498
Epoch: 9, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.445 Vali Acc: 0.440 Test Loss: 1.445 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439986).  Saving model ...
Epoch: 10 cost time: 1.258167028427124
Epoch: 10, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.756 Vali Acc: 0.440 Test Loss: 1.756 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0096299648284912
Epoch: 11, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.512 Vali Acc: 0.460 Test Loss: 1.512 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459985).  Saving model ...
Epoch: 12 cost time: 1.249826431274414
Epoch: 12, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.550 Vali Acc: 0.460 Test Loss: 1.550 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1133158206939697
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.782 Vali Acc: 0.420 Test Loss: 1.782 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1855947971343994
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.500 Test Loss: 1.400 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499986).  Saving model ...
Epoch: 15 cost time: 1.2803502082824707
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.847 Vali Acc: 0.500 Test Loss: 1.847 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.265397310256958
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.030 Vali Acc: 0.460 Test Loss: 2.030 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1930968761444092
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.902 Vali Acc: 0.460 Test Loss: 1.902 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2185773849487305
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.667 Vali Acc: 0.480 Test Loss: 1.667 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9933676719665527
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.480 Test Loss: 1.639 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2481906414031982
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.636 Vali Acc: 0.480 Test Loss: 1.636 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2427561283111572
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.480 Test Loss: 1.680 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.237489938735962
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.480 Test Loss: 1.770 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1599068641662598
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.480 Test Loss: 1.853 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0694682598114014
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.480 Test Loss: 1.912 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps25_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 99689477
model size : 394.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps25_str25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7674641609191895
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.731 Vali Acc: 0.180 Test Loss: 1.731 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.301769495010376
Epoch: 2, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.526 Vali Acc: 0.360 Test Loss: 1.526 Test Acc: 0.360
Validation loss decreased (-0.179983 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 1.2569079399108887
Epoch: 3, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.437 Vali Acc: 0.360 Test Loss: 1.437 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 1.2535955905914307
Epoch: 4, Steps: 4 | Train Loss: 0.752 Vali Loss: 1.327 Vali Acc: 0.380 Test Loss: 1.327 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379987).  Saving model ...
Epoch: 5 cost time: 1.236955165863037
Epoch: 5, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.338 Vali Acc: 0.480 Test Loss: 1.338 Test Acc: 0.480
Validation loss decreased (-0.379987 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 1.2098515033721924
Epoch: 6, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.265 Vali Acc: 0.480 Test Loss: 1.265 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 1.1262049674987793
Epoch: 7, Steps: 4 | Train Loss: 0.382 Vali Loss: 1.365 Vali Acc: 0.480 Test Loss: 1.365 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1546714305877686
Epoch: 8, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.506 Vali Acc: 0.460 Test Loss: 1.506 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.212266206741333
Epoch: 9, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.413 Vali Acc: 0.460 Test Loss: 1.413 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2238743305206299
Epoch: 10, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.605 Vali Acc: 0.460 Test Loss: 1.605 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2554306983947754
Epoch: 11, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.665 Vali Acc: 0.440 Test Loss: 1.665 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1867196559906006
Epoch: 12, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.379 Vali Acc: 0.500 Test Loss: 1.379 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 1.0735085010528564
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.427 Vali Acc: 0.520 Test Loss: 1.427 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519986).  Saving model ...
Epoch: 14 cost time: 1.146838665008545
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.516 Vali Acc: 0.520 Test Loss: 1.516 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0831212997436523
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.596 Vali Acc: 0.480 Test Loss: 1.596 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0857744216918945
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.696 Vali Acc: 0.500 Test Loss: 1.696 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0805799961090088
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.722 Vali Acc: 0.480 Test Loss: 1.722 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.15087890625
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.730 Vali Acc: 0.500 Test Loss: 1.730 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4215247631072998
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.480 Test Loss: 1.706 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4211456775665283
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.480 Test Loss: 1.697 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1501069068908691
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.480 Test Loss: 1.728 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.419022798538208
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.634 Vali Acc: 0.500 Test Loss: 1.634 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4166734218597412
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps25_str25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 99641093
model size : 394.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.820266008377075
Epoch: 1, Steps: 4 | Train Loss: 1.779 Vali Loss: 1.524 Vali Acc: 0.260 Test Loss: 1.524 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.0673530101776123
Epoch: 2, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.408 Vali Acc: 0.360 Test Loss: 1.408 Test Acc: 0.360
Validation loss decreased (-0.259985 --> -0.359986).  Saving model ...
Epoch: 3 cost time: 1.320329189300537
Epoch: 3, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
Validation loss decreased (-0.359986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 1.3483855724334717
Epoch: 4, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.351 Vali Acc: 0.420 Test Loss: 1.351 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 1.3295910358428955
Epoch: 5, Steps: 4 | Train Loss: 0.321 Vali Loss: 1.643 Vali Acc: 0.420 Test Loss: 1.643 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3034093379974365
Epoch: 6, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.496 Vali Acc: 0.460 Test Loss: 1.496 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459985).  Saving model ...
Epoch: 7 cost time: 1.3309061527252197
Epoch: 7, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.649 Vali Acc: 0.400 Test Loss: 1.649 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3640186786651611
Epoch: 8, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.623 Vali Acc: 0.420 Test Loss: 1.623 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3617467880249023
Epoch: 9, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.249 Vali Acc: 0.420 Test Loss: 1.249 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2987754344940186
Epoch: 10, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.378 Vali Acc: 0.480 Test Loss: 1.378 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479986).  Saving model ...
Epoch: 11 cost time: 1.1969647407531738
Epoch: 11, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.705 Vali Acc: 0.420 Test Loss: 1.705 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3837835788726807
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 1.378617286682129
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.686 Vali Acc: 0.480 Test Loss: 1.686 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.378586769104004
Epoch: 14, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.005 Vali Acc: 0.480 Test Loss: 2.005 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.173905611038208
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.984 Vali Acc: 0.480 Test Loss: 1.984 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3891525268554688
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.838 Vali Acc: 0.500 Test Loss: 1.838 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3866140842437744
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.520 Test Loss: 1.853 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519981).  Saving model ...
Epoch: 18 cost time: 1.3806557655334473
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.057 Vali Acc: 0.520 Test Loss: 2.057 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3665237426757812
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.247 Vali Acc: 0.520 Test Loss: 2.247 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.377199411392212
Epoch: 20, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.325 Vali Acc: 0.500 Test Loss: 2.325 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.348437786102295
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.362 Vali Acc: 0.500 Test Loss: 2.362 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3653333187103271
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.362 Vali Acc: 0.500 Test Loss: 2.362 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3326334953308105
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.332 Vali Acc: 0.500 Test Loss: 2.332 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3242783546447754
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.299 Vali Acc: 0.500 Test Loss: 2.299 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3222072124481201
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.242 Vali Acc: 0.500 Test Loss: 2.242 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3856139183044434
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.214 Vali Acc: 0.500 Test Loss: 2.214 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3735384941101074
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.200 Vali Acc: 0.500 Test Loss: 2.200 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps27_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 105973253
model size : 418.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8142409324645996
Epoch: 1, Steps: 4 | Train Loss: 1.837 Vali Loss: 1.658 Vali Acc: 0.200 Test Loss: 1.658 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.0700201988220215
Epoch: 2, Steps: 4 | Train Loss: 1.571 Vali Loss: 1.729 Vali Acc: 0.280 Test Loss: 1.729 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 1.326186180114746
Epoch: 3, Steps: 4 | Train Loss: 1.410 Vali Loss: 1.679 Vali Acc: 0.280 Test Loss: 1.679 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.1659066677093506
Epoch: 4, Steps: 4 | Train Loss: 1.098 Vali Loss: 1.569 Vali Acc: 0.320 Test Loss: 1.569 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.4176552295684814
Epoch: 5, Steps: 4 | Train Loss: 0.890 Vali Loss: 1.454 Vali Acc: 0.400 Test Loss: 1.454 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 1.2400414943695068
Epoch: 6, Steps: 4 | Train Loss: 0.616 Vali Loss: 1.499 Vali Acc: 0.460 Test Loss: 1.499 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459985).  Saving model ...
Epoch: 7 cost time: 1.312223196029663
Epoch: 7, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.781 Vali Acc: 0.480 Test Loss: 1.781 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479982).  Saving model ...
Epoch: 8 cost time: 1.0968413352966309
Epoch: 8, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.602 Vali Acc: 0.520 Test Loss: 1.602 Test Acc: 0.520
Validation loss decreased (-0.479982 --> -0.519984).  Saving model ...
Epoch: 9 cost time: 1.4235856533050537
Epoch: 9, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.554 Vali Acc: 0.520 Test Loss: 1.554 Test Acc: 0.520
Validation loss decreased (-0.519984 --> -0.519984).  Saving model ...
Epoch: 10 cost time: 1.4034123420715332
Epoch: 10, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.800 Vali Acc: 0.540 Test Loss: 1.800 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539982).  Saving model ...
Epoch: 11 cost time: 1.445969820022583
Epoch: 11, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3851206302642822
Epoch: 12, Steps: 4 | Train Loss: 0.093 Vali Loss: 2.133 Vali Acc: 0.500 Test Loss: 2.133 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.419072151184082
Epoch: 13, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.668 Vali Acc: 0.500 Test Loss: 1.668 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.228318452835083
Epoch: 14, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.593 Vali Acc: 0.540 Test Loss: 1.593 Test Acc: 0.540
Validation loss decreased (-0.539982 --> -0.539984).  Saving model ...
Epoch: 15 cost time: 1.3963451385498047
Epoch: 15, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.130 Vali Acc: 0.420 Test Loss: 2.130 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3891053199768066
Epoch: 16, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.844 Vali Acc: 0.440 Test Loss: 1.844 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.34022855758667
Epoch: 17, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.827 Vali Acc: 0.460 Test Loss: 1.827 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3964567184448242
Epoch: 18, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.942 Vali Acc: 0.440 Test Loss: 1.942 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4353265762329102
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.918 Vali Acc: 0.440 Test Loss: 1.918 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2466654777526855
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.101 Vali Acc: 0.440 Test Loss: 2.101 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4404585361480713
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.194 Vali Acc: 0.460 Test Loss: 2.194 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4065518379211426
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.392 Vali Acc: 0.440 Test Loss: 2.392 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1412971019744873
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.481 Vali Acc: 0.420 Test Loss: 2.481 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3796050548553467
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.488 Vali Acc: 0.420 Test Loss: 2.488 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps27_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 105881861
model size : 418.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7408220767974854
Epoch: 1, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.678 Vali Acc: 0.240 Test Loss: 1.678 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.4024770259857178
Epoch: 2, Steps: 4 | Train Loss: 1.569 Vali Loss: 1.607 Vali Acc: 0.360 Test Loss: 1.607 Test Acc: 0.360
Validation loss decreased (-0.239983 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 1.3667762279510498
Epoch: 3, Steps: 4 | Train Loss: 0.988 Vali Loss: 1.539 Vali Acc: 0.340 Test Loss: 1.539 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4180176258087158
Epoch: 4, Steps: 4 | Train Loss: 0.670 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 1.449862003326416
Epoch: 5, Steps: 4 | Train Loss: 0.561 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.470024824142456
Epoch: 6, Steps: 4 | Train Loss: 0.344 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4164025783538818
Epoch: 7, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.502 Vali Acc: 0.400 Test Loss: 1.502 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4969823360443115
Epoch: 8, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.200 Vali Acc: 0.460 Test Loss: 1.200 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459988).  Saving model ...
Epoch: 9 cost time: 1.4699206352233887
Epoch: 9, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.314 Vali Acc: 0.440 Test Loss: 1.314 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4474108219146729
Epoch: 10, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.472 Vali Acc: 0.480 Test Loss: 1.472 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479985).  Saving model ...
Epoch: 11 cost time: 1.31980299949646
Epoch: 11, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.273348331451416
Epoch: 12, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.391 Vali Acc: 0.460 Test Loss: 1.391 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3849561214447021
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.646 Vali Acc: 0.420 Test Loss: 1.646 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2164361476898193
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.642 Vali Acc: 0.440 Test Loss: 1.642 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.07723069190979
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.658 Vali Acc: 0.480 Test Loss: 1.658 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1196362972259521
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.845 Vali Acc: 0.460 Test Loss: 1.845 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1469125747680664
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.835 Vali Acc: 0.460 Test Loss: 1.835 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.112774133682251
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.500 Test Loss: 1.720 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499983).  Saving model ...
Epoch: 19 cost time: 1.2023346424102783
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.500 Test Loss: 1.662 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 20 cost time: 1.3442423343658447
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.679 Vali Acc: 0.500 Test Loss: 1.679 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2758588790893555
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.500 Test Loss: 1.711 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1945910453796387
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.759 Vali Acc: 0.500 Test Loss: 1.759 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3542592525482178
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.480 Test Loss: 1.841 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.359982967376709
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.925 Vali Acc: 0.480 Test Loss: 1.925 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3776884078979492
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.981 Vali Acc: 0.480 Test Loss: 1.981 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3709402084350586
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.007 Vali Acc: 0.480 Test Loss: 2.007 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3517615795135498
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.014 Vali Acc: 0.480 Test Loss: 2.014 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3490798473358154
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.989 Vali Acc: 0.500 Test Loss: 1.989 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2939543724060059
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.958 Vali Acc: 0.500 Test Loss: 1.958 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps27_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 105838853
model size : 418.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0261356830596924
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.596 Vali Acc: 0.220 Test Loss: 1.596 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.4646713733673096
Epoch: 2, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.591 Vali Acc: 0.240 Test Loss: 1.591 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.4197988510131836
Epoch: 3, Steps: 4 | Train Loss: 1.093 Vali Loss: 1.550 Vali Acc: 0.400 Test Loss: 1.550 Test Acc: 0.400
Validation loss decreased (-0.239984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.4287383556365967
Epoch: 4, Steps: 4 | Train Loss: 0.656 Vali Loss: 1.550 Vali Acc: 0.440 Test Loss: 1.550 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 1.3635015487670898
Epoch: 5, Steps: 4 | Train Loss: 0.465 Vali Loss: 1.456 Vali Acc: 0.440 Test Loss: 1.456 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439985).  Saving model ...
Epoch: 6 cost time: 1.1759729385375977
Epoch: 6, Steps: 4 | Train Loss: 0.627 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
Validation loss decreased (-0.439985 --> -0.519986).  Saving model ...
Epoch: 7 cost time: 1.5665514469146729
Epoch: 7, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5682024955749512
Epoch: 8, Steps: 4 | Train Loss: 0.154 Vali Loss: 1.864 Vali Acc: 0.460 Test Loss: 1.864 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1710376739501953
Epoch: 9, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4229044914245605
Epoch: 10, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.535 Vali Acc: 0.460 Test Loss: 1.535 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4474091529846191
Epoch: 11, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.862 Vali Acc: 0.480 Test Loss: 1.862 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.442892074584961
Epoch: 12, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.528 Vali Acc: 0.540 Test Loss: 1.528 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539985).  Saving model ...
Epoch: 13 cost time: 1.354135274887085
Epoch: 13, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.948 Vali Acc: 0.480 Test Loss: 1.948 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3125646114349365
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.991 Vali Acc: 0.500 Test Loss: 1.991 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2729339599609375
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.125 Vali Acc: 0.500 Test Loss: 2.125 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4805901050567627
Epoch: 16, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.057 Vali Acc: 0.500 Test Loss: 2.057 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.332064151763916
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.972 Vali Acc: 0.540 Test Loss: 1.972 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4559926986694336
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.078 Vali Acc: 0.540 Test Loss: 2.078 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1548826694488525
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.086 Vali Acc: 0.540 Test Loss: 2.086 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4157700538635254
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.117 Vali Acc: 0.540 Test Loss: 2.117 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4297125339508057
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.198 Vali Acc: 0.540 Test Loss: 2.198 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4539763927459717
Epoch: 22, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.241 Vali Acc: 0.540 Test Loss: 2.241 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 115248389
model size : 454.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.618912696838379
Epoch: 1, Steps: 4 | Train Loss: 1.729 Vali Loss: 1.650 Vali Acc: 0.200 Test Loss: 1.650 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.4600648880004883
Epoch: 2, Steps: 4 | Train Loss: 1.284 Vali Loss: 1.531 Vali Acc: 0.240 Test Loss: 1.531 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.507962942123413
Epoch: 3, Steps: 4 | Train Loss: 0.931 Vali Loss: 1.475 Vali Acc: 0.360 Test Loss: 1.475 Test Acc: 0.360
Validation loss decreased (-0.239985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 1.2809937000274658
Epoch: 4, Steps: 4 | Train Loss: 0.572 Vali Loss: 1.657 Vali Acc: 0.340 Test Loss: 1.657 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4429216384887695
Epoch: 5, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.431 Vali Acc: 0.520 Test Loss: 1.431 Test Acc: 0.520
Validation loss decreased (-0.359985 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 1.4479777812957764
Epoch: 6, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.546 Vali Acc: 0.460 Test Loss: 1.546 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5004770755767822
Epoch: 7, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.411 Vali Acc: 0.480 Test Loss: 1.411 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4994289875030518
Epoch: 8, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.571 Vali Acc: 0.500 Test Loss: 1.571 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4490289688110352
Epoch: 9, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.834 Vali Acc: 0.420 Test Loss: 1.834 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4219613075256348
Epoch: 10, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.444 Vali Acc: 0.520 Test Loss: 1.444 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4356510639190674
Epoch: 11, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.681 Vali Acc: 0.480 Test Loss: 1.681 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5146121978759766
Epoch: 12, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.723 Vali Acc: 0.440 Test Loss: 1.723 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4798672199249268
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.519 Vali Acc: 0.460 Test Loss: 1.519 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1848609447479248
Epoch: 14, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.886 Vali Acc: 0.480 Test Loss: 1.886 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4454915523529053
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.970 Vali Acc: 0.500 Test Loss: 1.970 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 115173125
model size : 454.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.821682929992676
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.704 Vali Acc: 0.200 Test Loss: 1.704 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3652386665344238
Epoch: 2, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.760 Vali Acc: 0.400 Test Loss: 1.760 Test Acc: 0.400
Validation loss decreased (-0.199983 --> -0.399982).  Saving model ...
Epoch: 3 cost time: 1.3948054313659668
Epoch: 3, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.374 Vali Acc: 0.440 Test Loss: 1.374 Test Acc: 0.440
Validation loss decreased (-0.399982 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 1.43943452835083
Epoch: 4, Steps: 4 | Train Loss: 0.691 Vali Loss: 1.362 Vali Acc: 0.360 Test Loss: 1.362 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2875702381134033
Epoch: 5, Steps: 4 | Train Loss: 0.418 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.439610481262207
Epoch: 6, Steps: 4 | Train Loss: 0.446 Vali Loss: 1.240 Vali Acc: 0.520 Test Loss: 1.240 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 1.4860584735870361
Epoch: 7, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.234 Vali Acc: 0.540 Test Loss: 1.234 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 1.4777495861053467
Epoch: 8, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.420 Vali Acc: 0.480 Test Loss: 1.420 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.490211009979248
Epoch: 9, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.407 Vali Acc: 0.500 Test Loss: 1.407 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.170682430267334
Epoch: 10, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.276 Vali Acc: 0.520 Test Loss: 1.276 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4601693153381348
Epoch: 11, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.389 Vali Acc: 0.500 Test Loss: 1.389 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4053289890289307
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.320 Vali Acc: 0.560 Test Loss: 1.320 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 1.523406744003296
Epoch: 13, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.445 Vali Acc: 0.500 Test Loss: 1.445 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.355787754058838
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.574 Vali Acc: 0.500 Test Loss: 1.574 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3042762279510498
Epoch: 15, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.752 Vali Acc: 0.500 Test Loss: 1.752 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3895456790924072
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.702 Vali Acc: 0.500 Test Loss: 1.702 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2344574928283691
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.306816577911377
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.544 Vali Acc: 0.560 Test Loss: 1.544 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3691520690917969
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.734 Vali Acc: 0.540 Test Loss: 1.734 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4054877758026123
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.180 Vali Acc: 0.480 Test Loss: 2.180 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4629597663879395
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.624 Vali Acc: 0.500 Test Loss: 1.624 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5166864395141602
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.800 Vali Acc: 0.500 Test Loss: 1.800 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 115130117
model size : 453.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps34_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8686413764953613
Epoch: 1, Steps: 4 | Train Loss: 1.723 Vali Loss: 1.682 Vali Acc: 0.200 Test Loss: 1.682 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.4702186584472656
Epoch: 2, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.509 Vali Acc: 0.340 Test Loss: 1.509 Test Acc: 0.340
Validation loss decreased (-0.199983 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.458678960800171
Epoch: 3, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.422 Vali Acc: 0.340 Test Loss: 1.422 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339986).  Saving model ...
Epoch: 4 cost time: 1.3592753410339355
Epoch: 4, Steps: 4 | Train Loss: 0.692 Vali Loss: 1.365 Vali Acc: 0.460 Test Loss: 1.365 Test Acc: 0.460
Validation loss decreased (-0.339986 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 1.4898192882537842
Epoch: 5, Steps: 4 | Train Loss: 0.555 Vali Loss: 1.395 Vali Acc: 0.420 Test Loss: 1.395 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2591850757598877
Epoch: 6, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.388 Vali Acc: 0.440 Test Loss: 1.388 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2723777294158936
Epoch: 7, Steps: 4 | Train Loss: 0.264 Vali Loss: 1.336 Vali Acc: 0.480 Test Loss: 1.336 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 1.2167048454284668
Epoch: 8, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.586 Vali Acc: 0.480 Test Loss: 1.586 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2087619304656982
Epoch: 9, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.513 Vali Acc: 0.500 Test Loss: 1.513 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 1.450798511505127
Epoch: 10, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.644 Vali Acc: 0.500 Test Loss: 1.644 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1499042510986328
Epoch: 11, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.540 Vali Acc: 0.480 Test Loss: 1.540 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.416038990020752
Epoch: 12, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.808 Vali Acc: 0.420 Test Loss: 1.808 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2551987171173096
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.824 Vali Acc: 0.420 Test Loss: 1.824 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2788496017456055
Epoch: 14, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.604 Vali Acc: 0.440 Test Loss: 1.604 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.197812557220459
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.610 Vali Acc: 0.520 Test Loss: 1.610 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519984).  Saving model ...
Epoch: 16 cost time: 1.3509573936462402
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.635 Vali Acc: 0.480 Test Loss: 1.635 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2085371017456055
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.556 Vali Acc: 0.540 Test Loss: 1.556 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539984).  Saving model ...
Epoch: 18 cost time: 1.4301230907440186
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.525 Vali Acc: 0.540 Test Loss: 1.525 Test Acc: 0.540
Validation loss decreased (-0.539984 --> -0.539985).  Saving model ...
Epoch: 19 cost time: 1.3408753871917725
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2229418754577637
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.500 Test Loss: 1.690 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4199984073638916
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.740 Vali Acc: 0.460 Test Loss: 1.740 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4697139263153076
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.480 Test Loss: 1.739 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.415395736694336
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.520 Test Loss: 1.722 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4451923370361328
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.480 Test Loss: 1.711 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4906020164489746
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.500 Test Loss: 1.691 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4719223976135254
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.520 Test Loss: 1.685 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4331457614898682
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.520 Test Loss: 1.680 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4703800678253174
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.500 Test Loss: 1.685 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps34_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 127622405
model size : 501.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps34_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5508828163146973
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.761 Vali Acc: 0.100 Test Loss: 1.761 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 1.476609706878662
Epoch: 2, Steps: 4 | Train Loss: 1.512 Vali Loss: 1.546 Vali Acc: 0.340 Test Loss: 1.546 Test Acc: 0.340
Validation loss decreased (-0.099982 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.2897422313690186
Epoch: 3, Steps: 4 | Train Loss: 1.012 Vali Loss: 1.422 Vali Acc: 0.360 Test Loss: 1.422 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359986).  Saving model ...
Epoch: 4 cost time: 1.4577739238739014
Epoch: 4, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.502 Vali Acc: 0.360 Test Loss: 1.502 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2947306632995605
Epoch: 5, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.411 Vali Acc: 0.420 Test Loss: 1.411 Test Acc: 0.420
Validation loss decreased (-0.359986 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 1.4327754974365234
Epoch: 6, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.407 Vali Acc: 0.520 Test Loss: 1.407 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519986).  Saving model ...
Epoch: 7 cost time: 1.5079576969146729
Epoch: 7, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.271 Vali Acc: 0.540 Test Loss: 1.271 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 1.3784427642822266
Epoch: 8, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.318 Vali Acc: 0.460 Test Loss: 1.318 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3294565677642822
Epoch: 9, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.551 Vali Acc: 0.480 Test Loss: 1.551 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3424718379974365
Epoch: 10, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.560 Vali Acc: 0.460 Test Loss: 1.560 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5078458786010742
Epoch: 11, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.484 Vali Acc: 0.460 Test Loss: 1.484 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3337130546569824
Epoch: 12, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.634 Vali Acc: 0.440 Test Loss: 1.634 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3567571640014648
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.641 Vali Acc: 0.460 Test Loss: 1.641 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4044020175933838
Epoch: 14, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.660 Vali Acc: 0.460 Test Loss: 1.660 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5097455978393555
Epoch: 15, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.776 Vali Acc: 0.440 Test Loss: 1.776 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4354987144470215
Epoch: 16, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.871 Vali Acc: 0.440 Test Loss: 1.871 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.337036371231079
Epoch: 17, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.460 Test Loss: 1.928 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps34_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 127552517
model size : 501.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps34_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.922140598297119
Epoch: 1, Steps: 4 | Train Loss: 1.899 Vali Loss: 1.832 Vali Acc: 0.240 Test Loss: 1.832 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 1.5663487911224365
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.542 Vali Acc: 0.300 Test Loss: 1.542 Test Acc: 0.300
Validation loss decreased (-0.239982 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.4822683334350586
Epoch: 3, Steps: 4 | Train Loss: 1.188 Vali Loss: 1.529 Vali Acc: 0.400 Test Loss: 1.529 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 1.501720905303955
Epoch: 4, Steps: 4 | Train Loss: 0.794 Vali Loss: 1.495 Vali Acc: 0.360 Test Loss: 1.495 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5675618648529053
Epoch: 5, Steps: 4 | Train Loss: 0.609 Vali Loss: 1.479 Vali Acc: 0.420 Test Loss: 1.479 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.5252516269683838
Epoch: 6, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.434 Vali Acc: 0.460 Test Loss: 1.434 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459986).  Saving model ...
Epoch: 7 cost time: 1.510631799697876
Epoch: 7, Steps: 4 | Train Loss: 0.398 Vali Loss: 1.390 Vali Acc: 0.380 Test Loss: 1.390 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.49397611618042
Epoch: 8, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.619 Vali Acc: 0.440 Test Loss: 1.619 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4967682361602783
Epoch: 9, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.563 Vali Acc: 0.400 Test Loss: 1.563 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.503270149230957
Epoch: 10, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.339 Vali Acc: 0.420 Test Loss: 1.339 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4269158840179443
Epoch: 11, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.467 Vali Acc: 0.440 Test Loss: 1.467 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4807779788970947
Epoch: 12, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.799 Vali Acc: 0.400 Test Loss: 1.799 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.544349193572998
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.428 Vali Acc: 0.440 Test Loss: 1.428 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5029184818267822
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.706 Vali Acc: 0.480 Test Loss: 1.706 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479983).  Saving model ...
Epoch: 15 cost time: 1.5696601867675781
Epoch: 15, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.715 Vali Acc: 0.500 Test Loss: 1.715 Test Acc: 0.500
Validation loss decreased (-0.479983 --> -0.499983).  Saving model ...
Epoch: 16 cost time: 1.6037580966949463
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.503 Vali Acc: 0.480 Test Loss: 1.503 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5181868076324463
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.604 Vali Acc: 0.520 Test Loss: 1.604 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519984).  Saving model ...
Epoch: 18 cost time: 1.5728135108947754
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.764 Vali Acc: 0.460 Test Loss: 1.764 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4665865898132324
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.795 Vali Acc: 0.480 Test Loss: 1.795 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4234709739685059
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.500 Test Loss: 1.688 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5410404205322266
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.638 Vali Acc: 0.500 Test Loss: 1.638 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.650338888168335
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.731 Vali Acc: 0.500 Test Loss: 1.731 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4743506908416748
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.947 Vali Acc: 0.500 Test Loss: 1.947 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5024762153625488
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.003 Vali Acc: 0.500 Test Loss: 2.003 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5837187767028809
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.980 Vali Acc: 0.480 Test Loss: 1.980 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5825932025909424
Epoch: 26, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.841 Vali Acc: 0.500 Test Loss: 1.841 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.669111728668213
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.500 Test Loss: 1.719 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps34_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 127514885
model size : 501.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps39_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.038339853286743
Epoch: 1, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.683 Vali Acc: 0.180 Test Loss: 1.683 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.508230447769165
Epoch: 2, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.404 Vali Acc: 0.420 Test Loss: 1.404 Test Acc: 0.420
Validation loss decreased (-0.179983 --> -0.419986).  Saving model ...
Epoch: 3 cost time: 1.447070598602295
Epoch: 3, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.242 Vali Acc: 0.440 Test Loss: 1.242 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439988).  Saving model ...
Epoch: 4 cost time: 1.6002395153045654
Epoch: 4, Steps: 4 | Train Loss: 0.609 Vali Loss: 1.376 Vali Acc: 0.420 Test Loss: 1.376 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6318809986114502
Epoch: 5, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.319 Vali Acc: 0.480 Test Loss: 1.319 Test Acc: 0.480
Validation loss decreased (-0.439988 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 1.558100938796997
Epoch: 6, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.409 Vali Acc: 0.460 Test Loss: 1.409 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3964755535125732
Epoch: 7, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.416 Vali Acc: 0.440 Test Loss: 1.416 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.447444200515747
Epoch: 8, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.649 Vali Acc: 0.420 Test Loss: 1.649 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6061317920684814
Epoch: 9, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.417 Vali Acc: 0.460 Test Loss: 1.417 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4447383880615234
Epoch: 10, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.788 Vali Acc: 0.480 Test Loss: 1.788 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4839177131652832
Epoch: 11, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.676 Vali Acc: 0.440 Test Loss: 1.676 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5725085735321045
Epoch: 12, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.017 Vali Acc: 0.460 Test Loss: 2.017 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5590357780456543
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.532 Vali Acc: 0.520 Test Loss: 1.532 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519985).  Saving model ...
Epoch: 14 cost time: 1.6060645580291748
Epoch: 14, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.657 Vali Acc: 0.480 Test Loss: 1.657 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5202431678771973
Epoch: 15, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.065 Vali Acc: 0.460 Test Loss: 2.065 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.522376537322998
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.773 Vali Acc: 0.460 Test Loss: 1.773 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5701260566711426
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.654 Vali Acc: 0.480 Test Loss: 1.654 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5812196731567383
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.834 Vali Acc: 0.480 Test Loss: 1.834 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5385794639587402
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.056 Vali Acc: 0.460 Test Loss: 2.056 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5683491230010986
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.179 Vali Acc: 0.460 Test Loss: 2.179 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6286170482635498
Epoch: 21, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.220 Vali Acc: 0.440 Test Loss: 2.220 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3706490993499756
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.248 Vali Acc: 0.480 Test Loss: 2.248 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4610798358917236
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.500 Test Loss: 2.233 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps39_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 143100677
model size : 560.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps39_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.026892900466919
Epoch: 1, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.6222772598266602
Epoch: 2, Steps: 4 | Train Loss: 1.437 Vali Loss: 1.507 Vali Acc: 0.320 Test Loss: 1.507 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.7381672859191895
Epoch: 3, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.411 Vali Acc: 0.460 Test Loss: 1.411 Test Acc: 0.460
Validation loss decreased (-0.319985 --> -0.459986).  Saving model ...
Epoch: 4 cost time: 1.7711198329925537
Epoch: 4, Steps: 4 | Train Loss: 0.654 Vali Loss: 1.338 Vali Acc: 0.480 Test Loss: 1.338 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 5 cost time: 1.795323133468628
Epoch: 5, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.659 Vali Acc: 0.460 Test Loss: 1.659 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.764235019683838
Epoch: 6, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 1.3536651134490967
Epoch: 7, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.422 Vali Acc: 0.500 Test Loss: 1.422 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 1.7872745990753174
Epoch: 8, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.648 Vali Acc: 0.480 Test Loss: 1.648 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2813053131103516
Epoch: 9, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.707 Vali Acc: 0.520 Test Loss: 1.707 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519983).  Saving model ...
Epoch: 10 cost time: 1.7633774280548096
Epoch: 10, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.664 Vali Acc: 0.520 Test Loss: 1.664 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519983).  Saving model ...
Epoch: 11 cost time: 1.8887810707092285
Epoch: 11, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.827 Vali Acc: 0.480 Test Loss: 1.827 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.827976942062378
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.624 Vali Acc: 0.520 Test Loss: 1.624 Test Acc: 0.520
Validation loss decreased (-0.519983 --> -0.519984).  Saving model ...
Epoch: 13 cost time: 1.897667646408081
Epoch: 13, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.808 Vali Acc: 0.480 Test Loss: 1.808 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9145889282226562
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.493 Vali Acc: 0.540 Test Loss: 1.493 Test Acc: 0.540
Validation loss decreased (-0.519984 --> -0.539985).  Saving model ...
Epoch: 15 cost time: 1.9211413860321045
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.561 Vali Acc: 0.560 Test Loss: 1.561 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559984).  Saving model ...
Epoch: 16 cost time: 1.8882083892822266
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.821 Vali Acc: 0.500 Test Loss: 1.821 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8300902843475342
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.180 Vali Acc: 0.460 Test Loss: 2.180 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8779056072235107
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.277 Vali Acc: 0.480 Test Loss: 2.277 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8469007015228271
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.212 Vali Acc: 0.480 Test Loss: 2.212 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6570024490356445
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.082 Vali Acc: 0.500 Test Loss: 2.082 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7162108421325684
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.029 Vali Acc: 0.480 Test Loss: 2.029 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8515851497650146
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.035 Vali Acc: 0.480 Test Loss: 2.035 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8378455638885498
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.083 Vali Acc: 0.480 Test Loss: 2.083 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8746726512908936
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 2.143 Vali Acc: 0.500 Test Loss: 2.143 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8124380111694336
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 2.187 Vali Acc: 0.500 Test Loss: 2.187 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps39_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 143036165
model size : 560.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps39_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.224712371826172
Epoch: 1, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.575 Vali Acc: 0.300 Test Loss: 1.575 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.7369966506958008
Epoch: 2, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.579 Vali Acc: 0.340 Test Loss: 1.579 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 1.7560136318206787
Epoch: 3, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.476 Vali Acc: 0.380 Test Loss: 1.476 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 1.4957654476165771
Epoch: 4, Steps: 4 | Train Loss: 0.912 Vali Loss: 1.279 Vali Acc: 0.520 Test Loss: 1.279 Test Acc: 0.520
Validation loss decreased (-0.379985 --> -0.519987).  Saving model ...
Epoch: 5 cost time: 1.7465276718139648
Epoch: 5, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.302 Vali Acc: 0.520 Test Loss: 1.302 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5606167316436768
Epoch: 6, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.623 Vali Acc: 0.460 Test Loss: 1.623 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7521677017211914
Epoch: 7, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.577 Vali Acc: 0.440 Test Loss: 1.577 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.74721360206604
Epoch: 8, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.415 Vali Acc: 0.480 Test Loss: 1.415 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.718388319015503
Epoch: 9, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.466 Vali Acc: 0.460 Test Loss: 1.466 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.774341106414795
Epoch: 10, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.459 Vali Acc: 0.480 Test Loss: 1.459 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6435461044311523
Epoch: 11, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.484 Vali Acc: 0.480 Test Loss: 1.484 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8274943828582764
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.592 Vali Acc: 0.500 Test Loss: 1.592 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7525429725646973
Epoch: 13, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.884 Vali Acc: 0.480 Test Loss: 1.884 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8832941055297852
Epoch: 14, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.883 Vali Acc: 0.480 Test Loss: 1.883 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps39_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 143003909
model size : 560.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.472092866897583
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.539 Vali Acc: 0.160 Test Loss: 1.539 Test Acc: 0.160
Validation loss decreased (inf --> -0.159985).  Saving model ...
Epoch: 2 cost time: 1.735579013824463
Epoch: 2, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.689 Vali Acc: 0.240 Test Loss: 1.689 Test Acc: 0.240
Validation loss decreased (-0.159985 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.6367204189300537
Epoch: 3, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.576 Vali Acc: 0.360 Test Loss: 1.576 Test Acc: 0.360
Validation loss decreased (-0.239983 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.8065028190612793
Epoch: 4, Steps: 4 | Train Loss: 0.754 Vali Loss: 1.496 Vali Acc: 0.420 Test Loss: 1.496 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 1.6849777698516846
Epoch: 5, Steps: 4 | Train Loss: 0.815 Vali Loss: 1.581 Vali Acc: 0.360 Test Loss: 1.581 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8170063495635986
Epoch: 6, Steps: 4 | Train Loss: 0.527 Vali Loss: 1.676 Vali Acc: 0.500 Test Loss: 1.676 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499983).  Saving model ...
Epoch: 7 cost time: 1.8651437759399414
Epoch: 7, Steps: 4 | Train Loss: 0.346 Vali Loss: 1.727 Vali Acc: 0.520 Test Loss: 1.727 Test Acc: 0.520
Validation loss decreased (-0.499983 --> -0.519983).  Saving model ...
Epoch: 8 cost time: 1.4016356468200684
Epoch: 8, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.476 Vali Acc: 0.540 Test Loss: 1.476 Test Acc: 0.540
Validation loss decreased (-0.519983 --> -0.539985).  Saving model ...
Epoch: 9 cost time: 1.6774075031280518
Epoch: 9, Steps: 4 | Train Loss: 0.311 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6555795669555664
Epoch: 10, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.738 Vali Acc: 0.440 Test Loss: 1.738 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7441563606262207
Epoch: 11, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.685 Vali Acc: 0.460 Test Loss: 1.685 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.727783441543579
Epoch: 12, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.421 Vali Acc: 0.460 Test Loss: 1.421 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3450701236724854
Epoch: 13, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.504 Vali Acc: 0.480 Test Loss: 1.504 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6298506259918213
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.738 Vali Acc: 0.500 Test Loss: 1.738 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6713342666625977
Epoch: 15, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.641 Vali Acc: 0.480 Test Loss: 1.641 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7518961429595947
Epoch: 16, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.521 Vali Acc: 0.520 Test Loss: 1.521 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.708695888519287
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.342 Vali Acc: 0.440 Test Loss: 2.342 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.417534589767456
Epoch: 18, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.159 Vali Acc: 0.460 Test Loss: 2.159 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps45_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 161667077
model size : 631.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2084531784057617
Epoch: 1, Steps: 4 | Train Loss: 1.855 Vali Loss: 1.627 Vali Acc: 0.160 Test Loss: 1.627 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.7040231227874756
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.547 Vali Acc: 0.280 Test Loss: 1.547 Test Acc: 0.280
Validation loss decreased (-0.159984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.7820558547973633
Epoch: 3, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.279985 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 1.7600135803222656
Epoch: 4, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.552 Vali Acc: 0.480 Test Loss: 1.552 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479984).  Saving model ...
Epoch: 5 cost time: 1.7871272563934326
Epoch: 5, Steps: 4 | Train Loss: 0.458 Vali Loss: 1.481 Vali Acc: 0.420 Test Loss: 1.481 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7889671325683594
Epoch: 6, Steps: 4 | Train Loss: 0.353 Vali Loss: 1.742 Vali Acc: 0.360 Test Loss: 1.742 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8656084537506104
Epoch: 7, Steps: 4 | Train Loss: 0.331 Vali Loss: 1.746 Vali Acc: 0.360 Test Loss: 1.746 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8374087810516357
Epoch: 8, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7989330291748047
Epoch: 9, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.653 Vali Acc: 0.400 Test Loss: 1.653 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.871652603149414
Epoch: 10, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.650 Vali Acc: 0.420 Test Loss: 1.650 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8364791870117188
Epoch: 11, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.623 Vali Acc: 0.400 Test Loss: 1.623 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8440430164337158
Epoch: 12, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.625 Vali Acc: 0.440 Test Loss: 1.625 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5862298011779785
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.586 Vali Acc: 0.460 Test Loss: 1.586 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8162662982940674
Epoch: 14, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.610 Vali Acc: 0.460 Test Loss: 1.610 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 161618693
model size : 631.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2367327213287354
Epoch: 1, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.801 Vali Acc: 0.260 Test Loss: 1.801 Test Acc: 0.260
Validation loss decreased (inf --> -0.259982).  Saving model ...
Epoch: 2 cost time: 1.739957332611084
Epoch: 2, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.472 Vali Acc: 0.320 Test Loss: 1.472 Test Acc: 0.320
Validation loss decreased (-0.259982 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 1.4024317264556885
Epoch: 3, Steps: 4 | Train Loss: 0.884 Vali Loss: 1.387 Vali Acc: 0.480 Test Loss: 1.387 Test Acc: 0.480
Validation loss decreased (-0.319985 --> -0.479986).  Saving model ...
Epoch: 4 cost time: 1.698319435119629
Epoch: 4, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.248 Vali Acc: 0.480 Test Loss: 1.248 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479988).  Saving model ...
Epoch: 5 cost time: 1.8074860572814941
Epoch: 5, Steps: 4 | Train Loss: 0.452 Vali Loss: 1.265 Vali Acc: 0.440 Test Loss: 1.265 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7503154277801514
Epoch: 6, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.322 Vali Acc: 0.440 Test Loss: 1.322 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5877747535705566
Epoch: 7, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.100 Vali Acc: 0.540 Test Loss: 1.100 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539989).  Saving model ...
Epoch: 8 cost time: 1.798415184020996
Epoch: 8, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.373 Vali Acc: 0.520 Test Loss: 1.373 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8260154724121094
Epoch: 9, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.434 Vali Acc: 0.440 Test Loss: 1.434 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8170888423919678
Epoch: 10, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7898368835449219
Epoch: 11, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.504 Vali Acc: 0.440 Test Loss: 1.504 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7917225360870361
Epoch: 12, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.626 Vali Acc: 0.440 Test Loss: 1.626 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6401951313018799
Epoch: 13, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.474 Vali Acc: 0.460 Test Loss: 1.474 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6592023372650146
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.615 Vali Acc: 0.480 Test Loss: 1.615 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6052377223968506
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.800 Vali Acc: 0.420 Test Loss: 1.800 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7933523654937744
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.776 Vali Acc: 0.440 Test Loss: 1.776 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7572638988494873
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.815 Vali Acc: 0.460 Test Loss: 1.815 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps45_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 161597189
model size : 631.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps54_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3062338829040527
Epoch: 1, Steps: 4 | Train Loss: 1.723 Vali Loss: 1.694 Vali Acc: 0.140 Test Loss: 1.694 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.8521430492401123
Epoch: 2, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.344 Vali Acc: 0.420 Test Loss: 1.344 Test Acc: 0.420
Validation loss decreased (-0.139983 --> -0.419987).  Saving model ...
Epoch: 3 cost time: 1.9690115451812744
Epoch: 3, Steps: 4 | Train Loss: 1.085 Vali Loss: 1.272 Vali Acc: 0.460 Test Loss: 1.272 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459987).  Saving model ...
Epoch: 4 cost time: 1.9527006149291992
Epoch: 4, Steps: 4 | Train Loss: 0.709 Vali Loss: 1.287 Vali Acc: 0.460 Test Loss: 1.287 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.972290277481079
Epoch: 5, Steps: 4 | Train Loss: 0.565 Vali Loss: 1.284 Vali Acc: 0.440 Test Loss: 1.284 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9557907581329346
Epoch: 6, Steps: 4 | Train Loss: 0.305 Vali Loss: 1.402 Vali Acc: 0.400 Test Loss: 1.402 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8779163360595703
Epoch: 7, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.329 Vali Acc: 0.460 Test Loss: 1.329 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0419421195983887
Epoch: 8, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9597759246826172
Epoch: 9, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.447 Vali Acc: 0.440 Test Loss: 1.447 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.967639446258545
Epoch: 10, Steps: 4 | Train Loss: 0.133 Vali Loss: 1.613 Vali Acc: 0.480 Test Loss: 1.613 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479984).  Saving model ...
Epoch: 11 cost time: 2.028409719467163
Epoch: 11, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.398 Vali Acc: 0.500 Test Loss: 1.398 Test Acc: 0.500
Validation loss decreased (-0.479984 --> -0.499986).  Saving model ...
Epoch: 12 cost time: 1.6518909931182861
Epoch: 12, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.438 Vali Acc: 0.500 Test Loss: 1.438 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6562414169311523
Epoch: 13, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.694 Vali Acc: 0.480 Test Loss: 1.694 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9370427131652832
Epoch: 14, Steps: 4 | Train Loss: 0.026 Vali Loss: 2.120 Vali Acc: 0.420 Test Loss: 2.120 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0335028171539307
Epoch: 15, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.763 Vali Acc: 0.480 Test Loss: 1.763 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.982046365737915
Epoch: 16, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.759 Vali Acc: 0.480 Test Loss: 1.759 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9043679237365723
Epoch: 17, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.798 Vali Acc: 0.460 Test Loss: 1.798 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0874836444854736
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.928 Vali Acc: 0.460 Test Loss: 1.928 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.004080057144165
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 2.094 Vali Acc: 0.420 Test Loss: 2.094 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8606171607971191
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.960 Vali Acc: 0.420 Test Loss: 1.960 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7640376091003418
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.901 Vali Acc: 0.460 Test Loss: 1.901 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps54_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 189540869
model size : 737.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps54_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4953198432922363
Epoch: 1, Steps: 4 | Train Loss: 1.746 Vali Loss: 1.600 Vali Acc: 0.320 Test Loss: 1.600 Test Acc: 0.320
Validation loss decreased (inf --> -0.319984).  Saving model ...
Epoch: 2 cost time: 2.1557788848876953
Epoch: 2, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.486 Vali Acc: 0.360 Test Loss: 1.486 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 2.1101484298706055
Epoch: 3, Steps: 4 | Train Loss: 0.828 Vali Loss: 1.536 Vali Acc: 0.340 Test Loss: 1.536 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8908486366271973
Epoch: 4, Steps: 4 | Train Loss: 0.746 Vali Loss: 1.471 Vali Acc: 0.460 Test Loss: 1.471 Test Acc: 0.460
Validation loss decreased (-0.359985 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 1.9040372371673584
Epoch: 5, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 1.9828338623046875
Epoch: 6, Steps: 4 | Train Loss: 0.267 Vali Loss: 1.383 Vali Acc: 0.440 Test Loss: 1.383 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.079395294189453
Epoch: 7, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.405 Vali Acc: 0.460 Test Loss: 1.405 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0952959060668945
Epoch: 8, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.415 Vali Acc: 0.480 Test Loss: 1.415 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8946361541748047
Epoch: 9, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.493 Vali Acc: 0.540 Test Loss: 1.493 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539985).  Saving model ...
Epoch: 10 cost time: 2.0471863746643066
Epoch: 10, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.581 Vali Acc: 0.520 Test Loss: 1.581 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.133635997772217
Epoch: 11, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.397 Vali Acc: 0.480 Test Loss: 1.397 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0162556171417236
Epoch: 12, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.431 Vali Acc: 0.460 Test Loss: 1.431 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9316370487213135
Epoch: 13, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1183359622955322
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.519 Vali Acc: 0.460 Test Loss: 1.519 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0637359619140625
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.494 Vali Acc: 0.480 Test Loss: 1.494 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.047261953353882
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.556 Vali Acc: 0.500 Test Loss: 1.556 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1290009021759033
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.565 Vali Acc: 0.520 Test Loss: 1.565 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8416085243225098
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.500 Test Loss: 1.551 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9140818119049072
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.518 Vali Acc: 0.520 Test Loss: 1.518 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps54_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 189503237
model size : 737.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps54_str54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.66144061088562
Epoch: 1, Steps: 4 | Train Loss: 1.713 Vali Loss: 1.712 Vali Acc: 0.180 Test Loss: 1.712 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.0674986839294434
Epoch: 2, Steps: 4 | Train Loss: 1.565 Vali Loss: 1.552 Vali Acc: 0.280 Test Loss: 1.552 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.167667865753174
Epoch: 3, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.474 Vali Acc: 0.320 Test Loss: 1.474 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 2.0753300189971924
Epoch: 4, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.451 Vali Acc: 0.360 Test Loss: 1.451 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 2.1764440536499023
Epoch: 5, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.287 Vali Acc: 0.420 Test Loss: 1.287 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419987).  Saving model ...
Epoch: 6 cost time: 2.173044204711914
Epoch: 6, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.081817865371704
Epoch: 7, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.310 Vali Acc: 0.440 Test Loss: 1.310 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439987).  Saving model ...
Epoch: 8 cost time: 2.0562119483947754
Epoch: 8, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.599 Vali Acc: 0.420 Test Loss: 1.599 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1089587211608887
Epoch: 9, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.458 Vali Acc: 0.480 Test Loss: 1.458 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479985).  Saving model ...
Epoch: 10 cost time: 2.1803834438323975
Epoch: 10, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.490 Vali Acc: 0.460 Test Loss: 1.490 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9074852466583252
Epoch: 11, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.430 Vali Acc: 0.460 Test Loss: 1.430 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0356693267822266
Epoch: 12, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.289 Vali Acc: 0.480 Test Loss: 1.289 Test Acc: 0.480
Validation loss decreased (-0.479985 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 2.1028459072113037
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.615 Vali Acc: 0.440 Test Loss: 1.615 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1690473556518555
Epoch: 14, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.491 Vali Acc: 0.440 Test Loss: 1.491 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9042043685913086
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.342 Vali Acc: 0.460 Test Loss: 1.342 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9498178958892822
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.462 Vali Acc: 0.460 Test Loss: 1.462 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1328940391540527
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.771 Vali Acc: 0.420 Test Loss: 1.771 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1719343662261963
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.906 Vali Acc: 0.420 Test Loss: 1.906 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.089348554611206
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.882 Vali Acc: 0.420 Test Loss: 1.882 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0199339389801025
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.804 Vali Acc: 0.420 Test Loss: 1.804 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.168921947479248
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.689 Vali Acc: 0.440 Test Loss: 1.689 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9096643924713135
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.480 Test Loss: 1.581 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_GPT4TS_UEA_ftM_sl270_ll0_pl0_el3_dm768_df768_ps54_str54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 189481733
model size : 737.48MB
