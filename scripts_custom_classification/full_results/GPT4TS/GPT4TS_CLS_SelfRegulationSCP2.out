Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps47_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2797281742095947
Epoch: 1, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.720 Vali Acc: 0.494 Test Loss: 0.720 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.9402666091918945
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.734 Vali Acc: 0.539 Test Loss: 0.734 Test Acc: 0.539
Validation loss decreased (-0.494437 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 3.5234158039093018
Epoch: 3, Steps: 13 | Train Loss: 0.817 Vali Loss: 0.749 Vali Acc: 0.494 Test Loss: 0.749 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.692434549331665
Epoch: 4, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.727 Vali Acc: 0.511 Test Loss: 0.727 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.556438684463501
Epoch: 5, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.698 Vali Acc: 0.561 Test Loss: 0.698 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561104).  Saving model ...
Epoch: 6 cost time: 3.3770687580108643
Epoch: 6, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.829 Vali Acc: 0.500 Test Loss: 0.829 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.522414207458496
Epoch: 7, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.901 Vali Acc: 0.517 Test Loss: 0.901 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4114160537719727
Epoch: 8, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.824 Vali Acc: 0.494 Test Loss: 0.824 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8685688972473145
Epoch: 9, Steps: 13 | Train Loss: 0.762 Vali Loss: 1.133 Vali Acc: 0.506 Test Loss: 1.133 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.184199333190918
Epoch: 10, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.990 Vali Acc: 0.500 Test Loss: 0.990 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4026272296905518
Epoch: 11, Steps: 13 | Train Loss: 0.519 Vali Loss: 1.052 Vali Acc: 0.456 Test Loss: 1.052 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.3600504398345947
Epoch: 12, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.024 Vali Acc: 0.483 Test Loss: 1.024 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.743077516555786
Epoch: 13, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.485 Vali Acc: 0.478 Test Loss: 1.485 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.489546298980713
Epoch: 14, Steps: 13 | Train Loss: 0.540 Vali Loss: 1.788 Vali Acc: 0.472 Test Loss: 1.788 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.4615087509155273
Epoch: 15, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.379 Vali Acc: 0.472 Test Loss: 1.379 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps47_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 44420354
model size : 184.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps47_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.7240684032440186
Epoch: 1, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.786 Vali Acc: 0.500 Test Loss: 0.786 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.1275410652160645
Epoch: 2, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1416103839874268
Epoch: 3, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.703 Vali Acc: 0.550 Test Loss: 0.703 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.057922840118408
Epoch: 4, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.702 Vali Acc: 0.528 Test Loss: 0.702 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.349496603012085
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.772 Vali Acc: 0.528 Test Loss: 0.772 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.471430778503418
Epoch: 6, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.839 Vali Acc: 0.544 Test Loss: 0.839 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.800558567047119
Epoch: 7, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.916 Vali Acc: 0.483 Test Loss: 0.916 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0011179447174072
Epoch: 8, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.722 Vali Acc: 0.522 Test Loss: 0.722 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.844815731048584
Epoch: 9, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.839 Vali Acc: 0.550 Test Loss: 0.839 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4391398429870605
Epoch: 10, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.313 Vali Acc: 0.528 Test Loss: 1.313 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1021010875701904
Epoch: 11, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.201 Vali Acc: 0.517 Test Loss: 1.201 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.047393798828125
Epoch: 12, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.124 Vali Acc: 0.522 Test Loss: 1.124 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.55999755859375
Epoch: 13, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.414 Vali Acc: 0.467 Test Loss: 1.414 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps47_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 44279042
model size : 183.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps47_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.038936138153076
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.696 Vali Acc: 0.489 Test Loss: 0.696 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 2.379530668258667
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.693 Vali Acc: 0.494 Test Loss: 0.693 Test Acc: 0.494
Validation loss decreased (-0.488882 --> -0.494438).  Saving model ...
Epoch: 3 cost time: 1.8454225063323975
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (-0.494438 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.7168669700622559
Epoch: 4, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.723 Vali Acc: 0.489 Test Loss: 0.723 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8709306716918945
Epoch: 5, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.517 Test Loss: 0.710 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 6 cost time: 1.6843814849853516
Epoch: 6, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.737 Vali Acc: 0.517 Test Loss: 0.737 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8359413146972656
Epoch: 7, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.711 Vali Acc: 0.506 Test Loss: 0.711 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6718471050262451
Epoch: 8, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.847 Vali Acc: 0.517 Test Loss: 0.847 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9742083549499512
Epoch: 9, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.841 Vali Acc: 0.539 Test Loss: 0.841 Test Acc: 0.539
Validation loss decreased (-0.516660 --> -0.538880).  Saving model ...
Epoch: 10 cost time: 2.1181323528289795
Epoch: 10, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.971 Vali Acc: 0.506 Test Loss: 0.971 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7053942680358887
Epoch: 11, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.902 Vali Acc: 0.544 Test Loss: 0.902 Test Acc: 0.544
Validation loss decreased (-0.538880 --> -0.544435).  Saving model ...
Epoch: 12 cost time: 1.821578025817871
Epoch: 12, Steps: 13 | Train Loss: 0.382 Vali Loss: 1.038 Vali Acc: 0.539 Test Loss: 1.038 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9448556900024414
Epoch: 13, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.121 Vali Acc: 0.528 Test Loss: 1.121 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7278614044189453
Epoch: 14, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.152 Vali Acc: 0.511 Test Loss: 1.152 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9233307838439941
Epoch: 15, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.224 Vali Acc: 0.506 Test Loss: 1.224 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0567052364349365
Epoch: 16, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.344 Vali Acc: 0.489 Test Loss: 1.344 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.256439208984375
Epoch: 17, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.411 Vali Acc: 0.506 Test Loss: 1.411 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.111583948135376
Epoch: 18, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.427 Vali Acc: 0.489 Test Loss: 1.427 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.006869316101074
Epoch: 19, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.580 Vali Acc: 0.517 Test Loss: 1.580 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9510626792907715
Epoch: 20, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.745 Vali Acc: 0.522 Test Loss: 1.745 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.907003402709961
Epoch: 21, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.825 Vali Acc: 0.494 Test Loss: 1.825 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps47_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 44208386
model size : 183.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5853466987609863
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.698 Vali Acc: 0.533 Test Loss: 0.698 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 2.516232490539551
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6290483474731445
Epoch: 3, Steps: 13 | Train Loss: 0.811 Vali Loss: 0.941 Vali Acc: 0.500 Test Loss: 0.941 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3953890800476074
Epoch: 4, Steps: 13 | Train Loss: 0.824 Vali Loss: 0.770 Vali Acc: 0.550 Test Loss: 0.770 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 2.730583906173706
Epoch: 5, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.902 Vali Acc: 0.494 Test Loss: 0.902 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0559017658233643
Epoch: 6, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1838431358337402
Epoch: 7, Steps: 13 | Train Loss: 0.648 Vali Loss: 1.069 Vali Acc: 0.506 Test Loss: 1.069 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2757503986358643
Epoch: 8, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.810 Vali Acc: 0.506 Test Loss: 0.810 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8774073123931885
Epoch: 9, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.880 Vali Acc: 0.550 Test Loss: 0.880 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9543824195861816
Epoch: 10, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.915 Vali Acc: 0.467 Test Loss: 0.915 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0814287662506104
Epoch: 11, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.325 Vali Acc: 0.533 Test Loss: 1.325 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9255571365356445
Epoch: 12, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.540 Vali Acc: 0.500 Test Loss: 1.540 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.338778018951416
Epoch: 13, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.253 Vali Acc: 0.511 Test Loss: 1.253 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3808581829071045
Epoch: 14, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.577 Vali Acc: 0.539 Test Loss: 1.577 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 44436482
model size : 184.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.0921008586883545
Epoch: 1, Steps: 13 | Train Loss: 0.843 Vali Loss: 0.809 Vali Acc: 0.517 Test Loss: 0.809 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 0.7980518341064453
Epoch: 2, Steps: 13 | Train Loss: 0.809 Vali Loss: 0.839 Vali Acc: 0.500 Test Loss: 0.839 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8443739414215088
Epoch: 3, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.764 Vali Acc: 0.506 Test Loss: 0.764 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9180896282196045
Epoch: 4, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.709 Vali Acc: 0.583 Test Loss: 0.709 Test Acc: 0.583
Validation loss decreased (-0.516659 --> -0.583326).  Saving model ...
Epoch: 5 cost time: 0.8480782508850098
Epoch: 5, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.748 Vali Acc: 0.517 Test Loss: 0.748 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.022209644317627
Epoch: 6, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.728 Vali Acc: 0.528 Test Loss: 0.728 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0679097175598145
Epoch: 7, Steps: 13 | Train Loss: 0.836 Vali Loss: 1.050 Vali Acc: 0.500 Test Loss: 1.050 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.689730167388916
Epoch: 8, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.922 Vali Acc: 0.522 Test Loss: 0.922 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7711069583892822
Epoch: 9, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.845 Vali Acc: 0.478 Test Loss: 0.845 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.707745313644409
Epoch: 10, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.810 Vali Acc: 0.511 Test Loss: 0.810 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.491593599319458
Epoch: 11, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.179 Vali Acc: 0.478 Test Loss: 1.179 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.735706329345703
Epoch: 12, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.151 Vali Acc: 0.489 Test Loss: 1.151 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0611071586608887
Epoch: 13, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.063 Vali Acc: 0.483 Test Loss: 1.063 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6923956871032715
Epoch: 14, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.468 Vali Acc: 0.467 Test Loss: 1.468 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 44295170
model size : 183.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8919427394866943
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.715 Vali Acc: 0.439 Test Loss: 0.715 Test Acc: 0.439
Validation loss decreased (inf --> -0.438882).  Saving model ...
Epoch: 2 cost time: 2.272190809249878
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
Validation loss decreased (-0.438882 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 2.259901523590088
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.687 Vali Acc: 0.511 Test Loss: 0.687 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.4002058506011963
Epoch: 4, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.776 Vali Acc: 0.522 Test Loss: 0.776 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522214).  Saving model ...
Epoch: 5 cost time: 1.7698936462402344
Epoch: 5, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.819 Vali Acc: 0.494 Test Loss: 0.819 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3793299198150635
Epoch: 6, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.867 Vali Acc: 0.533 Test Loss: 0.867 Test Acc: 0.533
Validation loss decreased (-0.522214 --> -0.533325).  Saving model ...
Epoch: 7 cost time: 1.8080530166625977
Epoch: 7, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
Validation loss decreased (-0.533325 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 2.280411958694458
Epoch: 8, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.814 Vali Acc: 0.550 Test Loss: 0.814 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3967161178588867
Epoch: 9, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.800 Vali Acc: 0.467 Test Loss: 0.800 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4818174839019775
Epoch: 10, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.919 Vali Acc: 0.528 Test Loss: 0.919 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5907702445983887
Epoch: 11, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.908 Vali Acc: 0.506 Test Loss: 0.908 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.359834909439087
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.023 Vali Acc: 0.478 Test Loss: 1.023 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7688703536987305
Epoch: 13, Steps: 13 | Train Loss: 0.420 Vali Loss: 1.202 Vali Acc: 0.489 Test Loss: 1.202 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1604819297790527
Epoch: 14, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.851793050765991
Epoch: 15, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.370 Vali Acc: 0.522 Test Loss: 1.370 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.26975679397583
Epoch: 16, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.344 Vali Acc: 0.506 Test Loss: 1.344 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7693517208099365
Epoch: 17, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.362 Vali Acc: 0.556 Test Loss: 1.362 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555542).  Saving model ...
Epoch: 18 cost time: 2.778697967529297
Epoch: 18, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.691 Vali Acc: 0.506 Test Loss: 1.691 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.346306562423706
Epoch: 19, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.538 Vali Acc: 0.489 Test Loss: 1.538 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7820472717285156
Epoch: 20, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.766 Vali Acc: 0.444 Test Loss: 1.766 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.959500789642334
Epoch: 21, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.905 Vali Acc: 0.467 Test Loss: 1.905 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2891457080841064
Epoch: 22, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.919 Vali Acc: 0.483 Test Loss: 1.919 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.934208631515503
Epoch: 23, Steps: 13 | Train Loss: 0.209 Vali Loss: 2.110 Vali Acc: 0.500 Test Loss: 2.110 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4329543113708496
Epoch: 24, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.281 Vali Acc: 0.444 Test Loss: 2.281 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6200189590454102
Epoch: 25, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.618 Vali Acc: 0.433 Test Loss: 2.618 Test Acc: 0.433
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6277217864990234
Epoch: 26, Steps: 13 | Train Loss: 0.091 Vali Loss: 2.397 Vali Acc: 0.467 Test Loss: 2.397 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.0627362728118896
Epoch: 27, Steps: 13 | Train Loss: 0.078 Vali Loss: 2.381 Vali Acc: 0.511 Test Loss: 2.381 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 44224514
model size : 183.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.436314582824707
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 3.223649740219116
Epoch: 2, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.852 Vali Acc: 0.517 Test Loss: 0.852 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516658).  Saving model ...
Epoch: 3 cost time: 2.141583204269409
Epoch: 3, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.699 Vali Acc: 0.528 Test Loss: 0.699 Test Acc: 0.528
Validation loss decreased (-0.516658 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 2.742018461227417
Epoch: 4, Steps: 13 | Train Loss: 0.867 Vali Loss: 0.804 Vali Acc: 0.494 Test Loss: 0.804 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5453505516052246
Epoch: 5, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.876 Vali Acc: 0.517 Test Loss: 0.876 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.922807455062866
Epoch: 6, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.714 Vali Acc: 0.550 Test Loss: 0.714 Test Acc: 0.550
Validation loss decreased (-0.527771 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 2.5489978790283203
Epoch: 7, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.807 Vali Acc: 0.539 Test Loss: 0.807 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5324501991271973
Epoch: 8, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.946 Vali Acc: 0.433 Test Loss: 0.946 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.554903745651245
Epoch: 9, Steps: 13 | Train Loss: 0.600 Vali Loss: 1.096 Vali Acc: 0.506 Test Loss: 1.096 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4012250900268555
Epoch: 10, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.177 Vali Acc: 0.506 Test Loss: 1.177 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7174718379974365
Epoch: 11, Steps: 13 | Train Loss: 0.458 Vali Loss: 1.075 Vali Acc: 0.483 Test Loss: 1.075 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.79189395904541
Epoch: 12, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.841 Vali Acc: 0.483 Test Loss: 1.841 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6235857009887695
Epoch: 13, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.511 Vali Acc: 0.478 Test Loss: 1.511 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8495538234710693
Epoch: 14, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.451 Vali Acc: 0.533 Test Loss: 1.451 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.85361909866333
Epoch: 15, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.461 Vali Acc: 0.550 Test Loss: 1.461 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.897920608520508
Epoch: 16, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.878 Vali Acc: 0.567 Test Loss: 1.878 Test Acc: 0.567
Validation loss decreased (-0.549993 --> -0.566648).  Saving model ...
Epoch: 17 cost time: 2.969778537750244
Epoch: 17, Steps: 13 | Train Loss: 0.292 Vali Loss: 2.145 Vali Acc: 0.461 Test Loss: 2.145 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.872485876083374
Epoch: 18, Steps: 13 | Train Loss: 0.188 Vali Loss: 2.610 Vali Acc: 0.450 Test Loss: 2.610 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.721163749694824
Epoch: 19, Steps: 13 | Train Loss: 0.280 Vali Loss: 2.635 Vali Acc: 0.533 Test Loss: 2.635 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.887773275375366
Epoch: 20, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.944 Vali Acc: 0.494 Test Loss: 1.944 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0426623821258545
Epoch: 21, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.829 Vali Acc: 0.461 Test Loss: 2.829 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5845260620117188
Epoch: 22, Steps: 13 | Train Loss: 0.122 Vali Loss: 2.846 Vali Acc: 0.511 Test Loss: 2.846 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8103935718536377
Epoch: 23, Steps: 13 | Train Loss: 0.127 Vali Loss: 2.993 Vali Acc: 0.528 Test Loss: 2.993 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7993524074554443
Epoch: 24, Steps: 13 | Train Loss: 0.249 Vali Loss: 2.950 Vali Acc: 0.494 Test Loss: 2.950 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9722743034362793
Epoch: 25, Steps: 13 | Train Loss: 0.064 Vali Loss: 4.317 Vali Acc: 0.467 Test Loss: 4.317 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.563650608062744
Epoch: 26, Steps: 13 | Train Loss: 0.200 Vali Loss: 5.021 Vali Acc: 0.461 Test Loss: 5.021 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 44460290
model size : 184.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6802399158477783
Epoch: 1, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.0791053771972656
Epoch: 2, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.717 Vali Acc: 0.539 Test Loss: 0.717 Test Acc: 0.539
Validation loss decreased (-0.499991 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 2.0077881813049316
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.795 Vali Acc: 0.472 Test Loss: 0.795 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0019686222076416
Epoch: 4, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.720 Vali Acc: 0.522 Test Loss: 0.720 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.020617961883545
Epoch: 5, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.792 Vali Acc: 0.489 Test Loss: 0.792 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8846087455749512
Epoch: 6, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.791 Vali Acc: 0.528 Test Loss: 0.791 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8547093868255615
Epoch: 7, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.900 Vali Acc: 0.467 Test Loss: 0.900 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.790949821472168
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.867 Vali Acc: 0.522 Test Loss: 0.867 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0219054222106934
Epoch: 9, Steps: 13 | Train Loss: 0.540 Vali Loss: 1.115 Vali Acc: 0.450 Test Loss: 1.115 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4176042079925537
Epoch: 10, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.818 Vali Acc: 0.533 Test Loss: 0.818 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8974637985229492
Epoch: 11, Steps: 13 | Train Loss: 0.419 Vali Loss: 1.117 Vali Acc: 0.556 Test Loss: 1.117 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555544).  Saving model ...
Epoch: 12 cost time: 1.9416224956512451
Epoch: 12, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.077 Vali Acc: 0.500 Test Loss: 1.077 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9472172260284424
Epoch: 13, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.178 Vali Acc: 0.506 Test Loss: 1.178 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.227667808532715
Epoch: 14, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.424 Vali Acc: 0.528 Test Loss: 1.424 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.243521213531494
Epoch: 15, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.299 Vali Acc: 0.533 Test Loss: 1.299 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1275713443756104
Epoch: 16, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.823 Vali Acc: 0.483 Test Loss: 1.823 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2011940479278564
Epoch: 17, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.671 Vali Acc: 0.528 Test Loss: 1.671 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1079914569854736
Epoch: 18, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.846 Vali Acc: 0.522 Test Loss: 1.846 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.273822069168091
Epoch: 19, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.900 Vali Acc: 0.500 Test Loss: 1.900 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3341305255889893
Epoch: 20, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.822 Vali Acc: 0.533 Test Loss: 1.822 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2857766151428223
Epoch: 21, Steps: 13 | Train Loss: 0.176 Vali Loss: 2.014 Vali Acc: 0.500 Test Loss: 2.014 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 44331266
model size : 183.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.93446946144104
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.718 Vali Acc: 0.511 Test Loss: 0.718 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.4423530101776123
Epoch: 2, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.736 Vali Acc: 0.489 Test Loss: 0.736 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9018304347991943
Epoch: 3, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3702991008758545
Epoch: 4, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.719 Vali Acc: 0.533 Test Loss: 0.719 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 1.9922559261322021
Epoch: 5, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.771 Vali Acc: 0.539 Test Loss: 0.771 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538881).  Saving model ...
Epoch: 6 cost time: 2.160221576690674
Epoch: 6, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.763 Vali Acc: 0.467 Test Loss: 0.763 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9392750263214111
Epoch: 7, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.920 Vali Acc: 0.506 Test Loss: 0.920 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.77073073387146
Epoch: 8, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.921 Vali Acc: 0.494 Test Loss: 0.921 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8161897659301758
Epoch: 9, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4774878025054932
Epoch: 10, Steps: 13 | Train Loss: 0.551 Vali Loss: 1.022 Vali Acc: 0.472 Test Loss: 1.022 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1392691135406494
Epoch: 11, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4463562965393066
Epoch: 12, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.003 Vali Acc: 0.500 Test Loss: 1.003 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.608341932296753
Epoch: 13, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.250 Vali Acc: 0.489 Test Loss: 1.250 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.423410177230835
Epoch: 14, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.290 Vali Acc: 0.500 Test Loss: 1.290 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1200830936431885
Epoch: 15, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.358 Vali Acc: 0.489 Test Loss: 1.358 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 44266754
model size : 183.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.652549743652344
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.715 Vali Acc: 0.506 Test Loss: 0.715 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 3.3575847148895264
Epoch: 2, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.773 Vali Acc: 0.489 Test Loss: 0.773 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3115603923797607
Epoch: 3, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.757 Vali Acc: 0.511 Test Loss: 0.757 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 2.561613082885742
Epoch: 4, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.768 Vali Acc: 0.522 Test Loss: 0.768 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 5 cost time: 3.3017020225524902
Epoch: 5, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.869 Vali Acc: 0.467 Test Loss: 0.869 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.66131591796875
Epoch: 6, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.765 Vali Acc: 0.539 Test Loss: 0.765 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538881).  Saving model ...
Epoch: 7 cost time: 3.6263484954833984
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.018 Vali Acc: 0.528 Test Loss: 1.018 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.206831455230713
Epoch: 8, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.880 Vali Acc: 0.511 Test Loss: 0.880 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3767306804656982
Epoch: 9, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.175 Vali Acc: 0.478 Test Loss: 1.175 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5698633193969727
Epoch: 10, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.357 Vali Acc: 0.450 Test Loss: 1.357 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.426572799682617
Epoch: 11, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.362 Vali Acc: 0.511 Test Loss: 1.362 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.204275608062744
Epoch: 12, Steps: 13 | Train Loss: 0.681 Vali Loss: 1.403 Vali Acc: 0.533 Test Loss: 1.403 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.288113832473755
Epoch: 13, Steps: 13 | Train Loss: 0.587 Vali Loss: 1.391 Vali Acc: 0.572 Test Loss: 1.391 Test Acc: 0.572
Validation loss decreased (-0.538881 --> -0.572208).  Saving model ...
Epoch: 14 cost time: 3.1673481464385986
Epoch: 14, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.503 Vali Acc: 0.539 Test Loss: 1.503 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.151146173477173
Epoch: 15, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.698 Vali Acc: 0.544 Test Loss: 1.698 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9432528018951416
Epoch: 16, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.784 Vali Acc: 0.556 Test Loss: 1.784 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.279005289077759
Epoch: 17, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.863 Vali Acc: 0.572 Test Loss: 1.863 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.61104679107666
Epoch: 18, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.626 Vali Acc: 0.606 Test Loss: 1.626 Test Acc: 0.606
Validation loss decreased (-0.572208 --> -0.605539).  Saving model ...
Epoch: 19 cost time: 2.7262489795684814
Epoch: 19, Steps: 13 | Train Loss: 0.194 Vali Loss: 2.005 Vali Acc: 0.600 Test Loss: 2.005 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.630577802658081
Epoch: 20, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.982 Vali Acc: 0.561 Test Loss: 1.982 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5342445373535156
Epoch: 21, Steps: 13 | Train Loss: 0.243 Vali Loss: 2.976 Vali Acc: 0.506 Test Loss: 2.976 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.577787399291992
Epoch: 22, Steps: 13 | Train Loss: 0.265 Vali Loss: 2.586 Vali Acc: 0.522 Test Loss: 2.586 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.882728099822998
Epoch: 23, Steps: 13 | Train Loss: 0.285 Vali Loss: 2.738 Vali Acc: 0.539 Test Loss: 2.738 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0944130420684814
Epoch: 24, Steps: 13 | Train Loss: 0.158 Vali Loss: 3.012 Vali Acc: 0.500 Test Loss: 3.012 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.019507884979248
Epoch: 25, Steps: 13 | Train Loss: 0.147 Vali Loss: 3.089 Vali Acc: 0.506 Test Loss: 3.089 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.98614239692688
Epoch: 26, Steps: 13 | Train Loss: 0.142 Vali Loss: 3.470 Vali Acc: 0.517 Test Loss: 3.470 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.9919772148132324
Epoch: 27, Steps: 13 | Train Loss: 0.202 Vali Loss: 3.188 Vali Acc: 0.522 Test Loss: 3.188 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.6668808460235596
Epoch: 28, Steps: 13 | Train Loss: 0.121 Vali Loss: 4.061 Vali Acc: 0.511 Test Loss: 4.061 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6055555555555555
model parameter : 44474114
model size : 184.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.706960678100586
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8487143516540527
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.686 Vali Acc: 0.494 Test Loss: 0.686 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.491880416870117
Epoch: 3, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.687 Vali Acc: 0.544 Test Loss: 0.687 Test Acc: 0.544
Validation loss decreased (-0.499993 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 2.5496177673339844
Epoch: 4, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.730 Vali Acc: 0.483 Test Loss: 0.730 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4100520610809326
Epoch: 5, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.686 Vali Acc: 0.567 Test Loss: 0.686 Test Acc: 0.567
Validation loss decreased (-0.544438 --> -0.566660).  Saving model ...
Epoch: 6 cost time: 2.367952585220337
Epoch: 6, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.695 Vali Acc: 0.511 Test Loss: 0.695 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.156812906265259
Epoch: 7, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.707 Vali Acc: 0.561 Test Loss: 0.707 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.147674560546875
Epoch: 8, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.753 Vali Acc: 0.544 Test Loss: 0.753 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.508880615234375
Epoch: 9, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.788 Vali Acc: 0.561 Test Loss: 0.788 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5249974727630615
Epoch: 10, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.857 Vali Acc: 0.561 Test Loss: 0.857 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1716911792755127
Epoch: 11, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.856 Vali Acc: 0.483 Test Loss: 0.856 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.249218702316284
Epoch: 12, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.969 Vali Acc: 0.511 Test Loss: 0.969 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.156512498855591
Epoch: 13, Steps: 13 | Train Loss: 0.439 Vali Loss: 1.396 Vali Acc: 0.528 Test Loss: 1.396 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.099651336669922
Epoch: 14, Steps: 13 | Train Loss: 0.484 Vali Loss: 1.296 Vali Acc: 0.550 Test Loss: 1.296 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.911799669265747
Epoch: 15, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.113 Vali Acc: 0.544 Test Loss: 1.113 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 44357378
model size : 183.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3517401218414307
Epoch: 1, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.734 Vali Acc: 0.450 Test Loss: 0.734 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.6139459609985352
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.714 Vali Acc: 0.489 Test Loss: 0.714 Test Acc: 0.489
Validation loss decreased (-0.449993 --> -0.488882).  Saving model ...
Epoch: 3 cost time: 1.8867299556732178
Epoch: 3, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.744 Vali Acc: 0.517 Test Loss: 0.744 Test Acc: 0.517
Validation loss decreased (-0.488882 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.380380392074585
Epoch: 4, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.744 Vali Acc: 0.478 Test Loss: 0.744 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.442399024963379
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.735 Vali Acc: 0.489 Test Loss: 0.735 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4883034229278564
Epoch: 6, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.701 Vali Acc: 0.539 Test Loss: 0.701 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538882).  Saving model ...
Epoch: 7 cost time: 1.3057191371917725
Epoch: 7, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5545945167541504
Epoch: 8, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.780 Vali Acc: 0.533 Test Loss: 0.780 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5728583335876465
Epoch: 9, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.755 Vali Acc: 0.494 Test Loss: 0.755 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8953464031219482
Epoch: 10, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.882 Vali Acc: 0.533 Test Loss: 0.882 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6764037609100342
Epoch: 11, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.881 Vali Acc: 0.511 Test Loss: 0.881 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7318580150604248
Epoch: 12, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.904 Vali Acc: 0.511 Test Loss: 0.904 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8012604713439941
Epoch: 13, Steps: 13 | Train Loss: 0.517 Vali Loss: 1.088 Vali Acc: 0.472 Test Loss: 1.088 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6696090698242188
Epoch: 14, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.223 Vali Acc: 0.517 Test Loss: 1.223 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9163942337036133
Epoch: 15, Steps: 13 | Train Loss: 0.377 Vali Loss: 1.083 Vali Acc: 0.483 Test Loss: 1.083 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7631382942199707
Epoch: 16, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.106 Vali Acc: 0.461 Test Loss: 1.106 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 44295938
model size : 183.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.553177833557129
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.772 Vali Acc: 0.506 Test Loss: 0.772 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 2.4579973220825195
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.744 Vali Acc: 0.506 Test Loss: 0.744 Test Acc: 0.506
Validation loss decreased (-0.505548 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 2.3771004676818848
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.764 Vali Acc: 0.494 Test Loss: 0.764 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.492349624633789
Epoch: 4, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.834 Vali Acc: 0.506 Test Loss: 0.834 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.627946138381958
Epoch: 5, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.841 Vali Acc: 0.456 Test Loss: 0.841 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4497296810150146
Epoch: 6, Steps: 13 | Train Loss: 0.813 Vali Loss: 0.755 Vali Acc: 0.528 Test Loss: 0.755 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527770).  Saving model ...
Epoch: 7 cost time: 2.5060620307922363
Epoch: 7, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4447174072265625
Epoch: 8, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.855 Vali Acc: 0.517 Test Loss: 0.855 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6398675441741943
Epoch: 9, Steps: 13 | Train Loss: 0.464 Vali Loss: 1.286 Vali Acc: 0.522 Test Loss: 1.286 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.176201105117798
Epoch: 10, Steps: 13 | Train Loss: 0.505 Vali Loss: 1.339 Vali Acc: 0.472 Test Loss: 1.339 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1465628147125244
Epoch: 11, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.418 Vali Acc: 0.539 Test Loss: 1.418 Test Acc: 0.539
Validation loss decreased (-0.527770 --> -0.538875).  Saving model ...
Epoch: 12 cost time: 1.7066116333007812
Epoch: 12, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.171 Vali Acc: 0.478 Test Loss: 1.171 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4315781593322754
Epoch: 13, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.405 Vali Acc: 0.506 Test Loss: 1.405 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8965258598327637
Epoch: 14, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.880 Vali Acc: 0.472 Test Loss: 1.880 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.303056478500366
Epoch: 15, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.834 Vali Acc: 0.517 Test Loss: 1.834 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.938153028488159
Epoch: 16, Steps: 13 | Train Loss: 0.468 Vali Loss: 2.175 Vali Acc: 0.483 Test Loss: 2.175 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.823822021484375
Epoch: 17, Steps: 13 | Train Loss: 0.264 Vali Loss: 2.077 Vali Acc: 0.506 Test Loss: 2.077 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.864182710647583
Epoch: 18, Steps: 13 | Train Loss: 0.230 Vali Loss: 2.238 Vali Acc: 0.494 Test Loss: 2.238 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6726670265197754
Epoch: 19, Steps: 13 | Train Loss: 0.205 Vali Loss: 2.308 Vali Acc: 0.522 Test Loss: 2.308 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.8384385108947754
Epoch: 20, Steps: 13 | Train Loss: 0.201 Vali Loss: 2.144 Vali Acc: 0.494 Test Loss: 2.144 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1371781826019287
Epoch: 21, Steps: 13 | Train Loss: 0.146 Vali Loss: 2.552 Vali Acc: 0.511 Test Loss: 2.552 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 44506370
model size : 184.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.4033684730529785
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.901 Vali Acc: 0.500 Test Loss: 0.901 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.307229995727539
Epoch: 2, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.737 Vali Acc: 0.522 Test Loss: 0.737 Test Acc: 0.522
Validation loss decreased (-0.499991 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 2.6741178035736084
Epoch: 3, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.727 Vali Acc: 0.522 Test Loss: 0.727 Test Acc: 0.522
Validation loss decreased (-0.522215 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 2.7245161533355713
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.720 Vali Acc: 0.489 Test Loss: 0.720 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.741086006164551
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.736 Vali Acc: 0.511 Test Loss: 0.736 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.282902956008911
Epoch: 6, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.863 Vali Acc: 0.517 Test Loss: 0.863 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5245721340179443
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.781 Vali Acc: 0.522 Test Loss: 0.781 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.68070650100708
Epoch: 8, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.828 Vali Acc: 0.550 Test Loss: 0.828 Test Acc: 0.550
Validation loss decreased (-0.522215 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 2.9064126014709473
Epoch: 9, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.006 Vali Acc: 0.478 Test Loss: 1.006 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6789188385009766
Epoch: 10, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.969 Vali Acc: 0.572 Test Loss: 0.969 Test Acc: 0.572
Validation loss decreased (-0.549992 --> -0.572213).  Saving model ...
Epoch: 11 cost time: 2.0582115650177
Epoch: 11, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.103 Vali Acc: 0.528 Test Loss: 1.103 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.322126626968384
Epoch: 12, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.679178476333618
Epoch: 13, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.478 Vali Acc: 0.522 Test Loss: 1.478 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5687930583953857
Epoch: 14, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.536 Vali Acc: 0.539 Test Loss: 1.536 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.379448652267456
Epoch: 15, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.768 Vali Acc: 0.483 Test Loss: 1.768 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.471165418624878
Epoch: 16, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.646 Vali Acc: 0.500 Test Loss: 1.646 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6687116622924805
Epoch: 17, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.658 Vali Acc: 0.494 Test Loss: 1.658 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3956100940704346
Epoch: 18, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.838 Vali Acc: 0.506 Test Loss: 1.838 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3936643600463867
Epoch: 19, Steps: 13 | Train Loss: 0.124 Vali Loss: 2.374 Vali Acc: 0.517 Test Loss: 2.374 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.712844133377075
Epoch: 20, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.912 Vali Acc: 0.511 Test Loss: 1.912 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 44386562
model size : 184.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6391489505767822
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.725 Vali Acc: 0.489 Test Loss: 0.725 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.9479138851165771
Epoch: 2, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.979353427886963
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (-0.488882 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.9673864841461182
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.719 Vali Acc: 0.489 Test Loss: 0.719 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6816391944885254
Epoch: 5, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.741 Vali Acc: 0.483 Test Loss: 0.741 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7120068073272705
Epoch: 6, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.733 Vali Acc: 0.483 Test Loss: 0.733 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5319552421569824
Epoch: 7, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.791 Vali Acc: 0.494 Test Loss: 0.791 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6486914157867432
Epoch: 8, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.774 Vali Acc: 0.539 Test Loss: 0.774 Test Acc: 0.539
Validation loss decreased (-0.499993 --> -0.538881).  Saving model ...
Epoch: 9 cost time: 1.664241075515747
Epoch: 9, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.953 Vali Acc: 0.494 Test Loss: 0.953 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.89784836769104
Epoch: 10, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.024 Vali Acc: 0.522 Test Loss: 1.024 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.744042158126831
Epoch: 11, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.223 Vali Acc: 0.506 Test Loss: 1.223 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7736389636993408
Epoch: 12, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.998 Vali Acc: 0.489 Test Loss: 0.998 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9348688125610352
Epoch: 13, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.057 Vali Acc: 0.489 Test Loss: 1.057 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9200589656829834
Epoch: 14, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.240 Vali Acc: 0.472 Test Loss: 1.240 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4926989078521729
Epoch: 15, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.605 Vali Acc: 0.517 Test Loss: 1.605 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8195998668670654
Epoch: 16, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.452 Vali Acc: 0.483 Test Loss: 1.452 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8059062957763672
Epoch: 17, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.305 Vali Acc: 0.483 Test Loss: 1.305 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7879269123077393
Epoch: 18, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.454 Vali Acc: 0.506 Test Loss: 1.454 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 44325122
model size : 183.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7824649810791016
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.793 Vali Acc: 0.511 Test Loss: 0.793 Test Acc: 0.511
Validation loss decreased (inf --> -0.511103).  Saving model ...
Epoch: 2 cost time: 1.8223662376403809
Epoch: 2, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.749 Vali Acc: 0.517 Test Loss: 0.749 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 2.100095510482788
Epoch: 3, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.750 Vali Acc: 0.528 Test Loss: 0.750 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 2.1058237552642822
Epoch: 4, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.768 Vali Acc: 0.528 Test Loss: 0.768 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1469736099243164
Epoch: 5, Steps: 13 | Train Loss: 0.766 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.710904598236084
Epoch: 6, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.890 Vali Acc: 0.522 Test Loss: 0.890 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2279083728790283
Epoch: 7, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.25675106048584
Epoch: 8, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.782 Vali Acc: 0.517 Test Loss: 0.782 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3299386501312256
Epoch: 9, Steps: 13 | Train Loss: 0.544 Vali Loss: 1.196 Vali Acc: 0.489 Test Loss: 1.196 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2509233951568604
Epoch: 10, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.955 Vali Acc: 0.517 Test Loss: 0.955 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2210941314697266
Epoch: 11, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.209 Vali Acc: 0.494 Test Loss: 1.209 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1220905780792236
Epoch: 12, Steps: 13 | Train Loss: 0.330 Vali Loss: 1.422 Vali Acc: 0.556 Test Loss: 1.422 Test Acc: 0.556
Validation loss decreased (-0.527770 --> -0.555541).  Saving model ...
Epoch: 13 cost time: 2.201704978942871
Epoch: 13, Steps: 13 | Train Loss: 0.472 Vali Loss: 1.460 Vali Acc: 0.456 Test Loss: 1.460 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.015778064727783
Epoch: 14, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.410 Vali Acc: 0.522 Test Loss: 1.410 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7634611129760742
Epoch: 15, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.784 Vali Acc: 0.511 Test Loss: 1.784 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7888603210449219
Epoch: 16, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.634 Vali Acc: 0.522 Test Loss: 1.634 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5287470817565918
Epoch: 17, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.934 Vali Acc: 0.500 Test Loss: 1.934 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6876237392425537
Epoch: 18, Steps: 13 | Train Loss: 0.177 Vali Loss: 3.017 Vali Acc: 0.517 Test Loss: 3.017 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6462867259979248
Epoch: 19, Steps: 13 | Train Loss: 0.190 Vali Loss: 2.548 Vali Acc: 0.550 Test Loss: 2.548 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6057612895965576
Epoch: 20, Steps: 13 | Train Loss: 0.514 Vali Loss: 1.834 Vali Acc: 0.506 Test Loss: 1.834 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1408565044403076
Epoch: 21, Steps: 13 | Train Loss: 0.175 Vali Loss: 2.273 Vali Acc: 0.550 Test Loss: 2.273 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6873412132263184
Epoch: 22, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.155 Vali Acc: 0.522 Test Loss: 2.155 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 44536322
model size : 184.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0707755088806152
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.740 Vali Acc: 0.506 Test Loss: 0.740 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.4600601196289062
Epoch: 2, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.709 Vali Acc: 0.489 Test Loss: 0.709 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5857467651367188
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6476731300354004
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.753617763519287
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.716 Vali Acc: 0.506 Test Loss: 0.716 Test Acc: 0.506
Validation loss decreased (-0.505548 --> -0.505548).  Saving model ...
Epoch: 6 cost time: 1.8362183570861816
Epoch: 6, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.747 Vali Acc: 0.511 Test Loss: 0.747 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511104).  Saving model ...
Epoch: 7 cost time: 1.937401533126831
Epoch: 7, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.967 Vali Acc: 0.506 Test Loss: 0.967 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.765136957168579
Epoch: 8, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.867 Vali Acc: 0.489 Test Loss: 0.867 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.247326135635376
Epoch: 9, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.762 Vali Acc: 0.556 Test Loss: 0.762 Test Acc: 0.556
Validation loss decreased (-0.511104 --> -0.555548).  Saving model ...
Epoch: 10 cost time: 1.7051453590393066
Epoch: 10, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.859 Vali Acc: 0.494 Test Loss: 0.859 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.168952703475952
Epoch: 11, Steps: 13 | Train Loss: 0.547 Vali Loss: 1.046 Vali Acc: 0.461 Test Loss: 1.046 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7294671535491943
Epoch: 12, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.096 Vali Acc: 0.544 Test Loss: 1.096 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4780962467193604
Epoch: 13, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.940 Vali Acc: 0.506 Test Loss: 0.940 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2025208473205566
Epoch: 14, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.962 Vali Acc: 0.544 Test Loss: 0.962 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8422422409057617
Epoch: 15, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.316 Vali Acc: 0.561 Test Loss: 1.316 Test Acc: 0.561
Validation loss decreased (-0.555548 --> -0.561098).  Saving model ...
Epoch: 16 cost time: 1.8501856327056885
Epoch: 16, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.283 Vali Acc: 0.478 Test Loss: 1.283 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.667205572128296
Epoch: 17, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.411 Vali Acc: 0.517 Test Loss: 1.411 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7778475284576416
Epoch: 18, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.866 Vali Acc: 0.494 Test Loss: 1.866 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8167612552642822
Epoch: 19, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.615 Vali Acc: 0.550 Test Loss: 1.615 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.09248685836792
Epoch: 20, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.513 Vali Acc: 0.561 Test Loss: 1.513 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8617134094238281
Epoch: 21, Steps: 13 | Train Loss: 0.172 Vali Loss: 2.120 Vali Acc: 0.533 Test Loss: 2.120 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9008374214172363
Epoch: 22, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.733 Vali Acc: 0.528 Test Loss: 1.733 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.891362190246582
Epoch: 23, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.899 Vali Acc: 0.533 Test Loss: 1.899 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6645548343658447
Epoch: 24, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.912 Vali Acc: 0.494 Test Loss: 1.912 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7253479957580566
Epoch: 25, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.516 Vali Acc: 0.461 Test Loss: 2.516 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 44428802
model size : 184.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.674428939819336
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.706 Vali Acc: 0.494 Test Loss: 0.706 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.483271598815918
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.734 Vali Acc: 0.539 Test Loss: 0.734 Test Acc: 0.539
Validation loss decreased (-0.494437 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.4373486042022705
Epoch: 3, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.707 Vali Acc: 0.478 Test Loss: 0.707 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5530166625976562
Epoch: 4, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.705 Vali Acc: 0.533 Test Loss: 0.705 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.261049747467041
Epoch: 5, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.726 Vali Acc: 0.511 Test Loss: 0.726 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5478265285491943
Epoch: 6, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.794 Vali Acc: 0.511 Test Loss: 0.794 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.056694746017456
Epoch: 7, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.909 Vali Acc: 0.483 Test Loss: 0.909 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0205464363098145
Epoch: 8, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.781 Vali Acc: 0.478 Test Loss: 0.781 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6686787605285645
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.845 Vali Acc: 0.472 Test Loss: 0.845 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6974706649780273
Epoch: 10, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.896 Vali Acc: 0.533 Test Loss: 0.896 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4549469947814941
Epoch: 11, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.938 Vali Acc: 0.517 Test Loss: 0.938 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6030056476593018
Epoch: 12, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 44370434
model size : 183.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps61_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.160042762756348
Epoch: 1, Steps: 13 | Train Loss: 0.845 Vali Loss: 0.682 Vali Acc: 0.567 Test Loss: 0.682 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 2.573467493057251
Epoch: 2, Steps: 13 | Train Loss: 0.817 Vali Loss: 0.703 Vali Acc: 0.528 Test Loss: 0.703 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.507534980773926
Epoch: 3, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.809 Vali Acc: 0.500 Test Loss: 0.809 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.446004629135132
Epoch: 4, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6512327194213867
Epoch: 5, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.741 Vali Acc: 0.517 Test Loss: 0.741 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.00834059715271
Epoch: 6, Steps: 13 | Train Loss: 0.786 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.987621784210205
Epoch: 7, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.695 Vali Acc: 0.533 Test Loss: 0.695 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.507028102874756
Epoch: 8, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.825 Vali Acc: 0.567 Test Loss: 0.825 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.315309524536133
Epoch: 9, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.832 Vali Acc: 0.456 Test Loss: 0.832 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.462254047393799
Epoch: 10, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.903 Vali Acc: 0.528 Test Loss: 0.903 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.119506597518921
Epoch: 11, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.141 Vali Acc: 0.511 Test Loss: 1.141 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps61_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 44572418
model size : 184.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.071976900100708
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.700 Vali Acc: 0.494 Test Loss: 0.700 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.382643461227417
Epoch: 2, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.3934557437896729
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.703 Vali Acc: 0.533 Test Loss: 0.703 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.512892246246338
Epoch: 4, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.718 Vali Acc: 0.500 Test Loss: 0.718 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2698471546173096
Epoch: 5, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.709 Vali Acc: 0.494 Test Loss: 0.709 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4221141338348389
Epoch: 6, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.827 Vali Acc: 0.483 Test Loss: 0.827 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6858484745025635
Epoch: 7, Steps: 13 | Train Loss: 0.618 Vali Loss: 1.110 Vali Acc: 0.506 Test Loss: 1.110 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2877311706542969
Epoch: 8, Steps: 13 | Train Loss: 0.611 Vali Loss: 1.307 Vali Acc: 0.506 Test Loss: 1.307 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3002870082855225
Epoch: 9, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.853 Vali Acc: 0.517 Test Loss: 0.853 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6637580394744873
Epoch: 10, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.821 Vali Acc: 0.461 Test Loss: 0.821 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6914539337158203
Epoch: 11, Steps: 13 | Train Loss: 0.519 Vali Loss: 1.049 Vali Acc: 0.522 Test Loss: 1.049 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2636449337005615
Epoch: 12, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.924 Vali Acc: 0.450 Test Loss: 0.924 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2831320762634277
Epoch: 13, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.177 Vali Acc: 0.494 Test Loss: 1.177 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 44471042
model size : 184.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps61_str61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1752331256866455
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.703 Vali Acc: 0.483 Test Loss: 0.703 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.4843618869781494
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.700 Vali Acc: 0.528 Test Loss: 0.700 Test Acc: 0.528
Validation loss decreased (-0.483326 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.33986496925354
Epoch: 3, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.687 Vali Acc: 0.511 Test Loss: 0.687 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4102466106414795
Epoch: 4, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.703 Vali Acc: 0.511 Test Loss: 0.703 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4002034664154053
Epoch: 5, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.693 Vali Acc: 0.539 Test Loss: 0.693 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 6 cost time: 1.397486925125122
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.775 Vali Acc: 0.494 Test Loss: 0.775 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2321209907531738
Epoch: 7, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.763 Vali Acc: 0.544 Test Loss: 0.763 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544437).  Saving model ...
Epoch: 8 cost time: 0.7751109600067139
Epoch: 8, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.812 Vali Acc: 0.483 Test Loss: 0.812 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2821598052978516
Epoch: 9, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.748 Vali Acc: 0.544 Test Loss: 0.748 Test Acc: 0.544
Validation loss decreased (-0.544437 --> -0.544437).  Saving model ...
Epoch: 10 cost time: 1.1112031936645508
Epoch: 10, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.821 Vali Acc: 0.544 Test Loss: 0.821 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2811462879180908
Epoch: 11, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.876 Vali Acc: 0.506 Test Loss: 0.876 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2877652645111084
Epoch: 12, Steps: 13 | Train Loss: 0.519 Vali Loss: 1.142 Vali Acc: 0.494 Test Loss: 1.142 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3260488510131836
Epoch: 13, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.902 Vali Acc: 0.528 Test Loss: 0.902 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1988270282745361
Epoch: 14, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.135 Vali Acc: 0.494 Test Loss: 1.135 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1964492797851562
Epoch: 15, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.093 Vali Acc: 0.472 Test Loss: 1.093 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3360698223114014
Epoch: 16, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.121 Vali Acc: 0.528 Test Loss: 1.121 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4727234840393066
Epoch: 17, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.248 Vali Acc: 0.522 Test Loss: 1.248 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2119488716125488
Epoch: 18, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.652 Vali Acc: 0.528 Test Loss: 1.652 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3222384452819824
Epoch: 19, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.124 Vali Acc: 0.511 Test Loss: 1.124 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps61_str61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 44415746
model size : 184.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.9492595195770264
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.1665096282958984
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.706 Vali Acc: 0.517 Test Loss: 0.706 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 2.300079822540283
Epoch: 3, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.829 Vali Acc: 0.517 Test Loss: 0.829 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.189011573791504
Epoch: 4, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.819 Vali Acc: 0.511 Test Loss: 0.819 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.159141778945923
Epoch: 5, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.710 Vali Acc: 0.572 Test Loss: 0.710 Test Acc: 0.572
Validation loss decreased (-0.516660 --> -0.572215).  Saving model ...
Epoch: 6 cost time: 2.648794412612915
Epoch: 6, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.403607130050659
Epoch: 7, Steps: 13 | Train Loss: 0.672 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3630294799804688
Epoch: 8, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.974 Vali Acc: 0.483 Test Loss: 0.974 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.423543691635132
Epoch: 9, Steps: 13 | Train Loss: 0.507 Vali Loss: 1.169 Vali Acc: 0.511 Test Loss: 1.169 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6995856761932373
Epoch: 10, Steps: 13 | Train Loss: 0.565 Vali Loss: 1.067 Vali Acc: 0.511 Test Loss: 1.067 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1414384841918945
Epoch: 11, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.171 Vali Acc: 0.511 Test Loss: 1.171 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3379616737365723
Epoch: 12, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.685 Vali Acc: 0.522 Test Loss: 1.685 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.406635284423828
Epoch: 13, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.724 Vali Acc: 0.517 Test Loss: 1.724 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.532261371612549
Epoch: 14, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.596 Vali Acc: 0.517 Test Loss: 1.596 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.304102659225464
Epoch: 15, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.720 Vali Acc: 0.556 Test Loss: 1.720 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 44620802
model size : 184.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6276960372924805
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.698 Vali Acc: 0.517 Test Loss: 0.698 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.205075979232788
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.730 Vali Acc: 0.517 Test Loss: 0.730 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3473315238952637
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.689 Vali Acc: 0.533 Test Loss: 0.689 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.3271949291229248
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.820 Vali Acc: 0.511 Test Loss: 0.820 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.760479211807251
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.714 Vali Acc: 0.533 Test Loss: 0.714 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4052906036376953
Epoch: 6, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.739 Vali Acc: 0.517 Test Loss: 0.739 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2969849109649658
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.862 Vali Acc: 0.539 Test Loss: 0.862 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538880).  Saving model ...
Epoch: 8 cost time: 1.5082025527954102
Epoch: 8, Steps: 13 | Train Loss: 0.576 Vali Loss: 1.029 Vali Acc: 0.556 Test Loss: 1.029 Test Acc: 0.556
Validation loss decreased (-0.538880 --> -0.555545).  Saving model ...
Epoch: 9 cost time: 1.660928726196289
Epoch: 9, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.941335916519165
Epoch: 10, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.888 Vali Acc: 0.511 Test Loss: 0.888 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5686166286468506
Epoch: 11, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.978 Vali Acc: 0.483 Test Loss: 0.978 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4674460887908936
Epoch: 12, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.308 Vali Acc: 0.472 Test Loss: 1.308 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2735159397125244
Epoch: 13, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.663 Vali Acc: 0.444 Test Loss: 1.663 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.45218825340271
Epoch: 14, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.421 Vali Acc: 0.478 Test Loss: 1.421 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6369247436523438
Epoch: 15, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.651 Vali Acc: 0.522 Test Loss: 1.651 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9402945041656494
Epoch: 16, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.434 Vali Acc: 0.483 Test Loss: 1.434 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.001993179321289
Epoch: 17, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.468 Vali Acc: 0.417 Test Loss: 1.468 Test Acc: 0.417
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.463791847229004
Epoch: 18, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.830 Vali Acc: 0.444 Test Loss: 1.830 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 44516354
model size : 184.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.441546678543091
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.677 Vali Acc: 0.583 Test Loss: 0.677 Test Acc: 0.583
Validation loss decreased (inf --> -0.583327).  Saving model ...
Epoch: 2 cost time: 1.4270620346069336
Epoch: 2, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.696 Vali Acc: 0.500 Test Loss: 0.696 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5923891067504883
Epoch: 3, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.713 Vali Acc: 0.500 Test Loss: 0.713 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5374629497528076
Epoch: 4, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.714 Vali Acc: 0.517 Test Loss: 0.714 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1964097023010254
Epoch: 5, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.699 Vali Acc: 0.506 Test Loss: 0.699 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1802232265472412
Epoch: 6, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.756 Vali Acc: 0.506 Test Loss: 0.756 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1365559101104736
Epoch: 7, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.740 Vali Acc: 0.556 Test Loss: 0.740 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.226038932800293
Epoch: 8, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2214984893798828
Epoch: 9, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.851 Vali Acc: 0.539 Test Loss: 0.851 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.236541748046875
Epoch: 10, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.168 Vali Acc: 0.450 Test Loss: 1.168 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3124876022338867
Epoch: 11, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.848 Vali Acc: 0.539 Test Loss: 0.848 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 44464130
model size : 184.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.162652015686035
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.0672616958618164
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.695 Vali Acc: 0.539 Test Loss: 0.695 Test Acc: 0.539
Validation loss decreased (-0.499993 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 2.1361305713653564
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.696 Vali Acc: 0.539 Test Loss: 0.696 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.878119707107544
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.788 Vali Acc: 0.561 Test Loss: 0.788 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561103).  Saving model ...
Epoch: 5 cost time: 1.8313040733337402
Epoch: 5, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.771 Vali Acc: 0.528 Test Loss: 0.771 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9927260875701904
Epoch: 6, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.862 Vali Acc: 0.511 Test Loss: 0.862 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.723008155822754
Epoch: 7, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.805 Vali Acc: 0.500 Test Loss: 0.805 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0182716846466064
Epoch: 8, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.844 Vali Acc: 0.561 Test Loss: 0.844 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.121351480484009
Epoch: 9, Steps: 13 | Train Loss: 0.499 Vali Loss: 1.033 Vali Acc: 0.578 Test Loss: 1.033 Test Acc: 0.578
Validation loss decreased (-0.561103 --> -0.577767).  Saving model ...
Epoch: 10 cost time: 2.0805091857910156
Epoch: 10, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.820 Vali Acc: 0.511 Test Loss: 0.820 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0447821617126465
Epoch: 11, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.964 Vali Acc: 0.517 Test Loss: 0.964 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9784417152404785
Epoch: 12, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.200 Vali Acc: 0.511 Test Loss: 1.200 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9898898601531982
Epoch: 13, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.261 Vali Acc: 0.494 Test Loss: 1.261 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1498799324035645
Epoch: 14, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.157 Vali Acc: 0.544 Test Loss: 1.157 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.165562152862549
Epoch: 15, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.553 Vali Acc: 0.556 Test Loss: 1.553 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1211600303649902
Epoch: 16, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.580 Vali Acc: 0.506 Test Loss: 1.580 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5412747859954834
Epoch: 17, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.635 Vali Acc: 0.489 Test Loss: 1.635 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7157838344573975
Epoch: 18, Steps: 13 | Train Loss: 0.392 Vali Loss: 2.065 Vali Acc: 0.522 Test Loss: 2.065 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7533879280090332
Epoch: 19, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.416 Vali Acc: 0.550 Test Loss: 1.416 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 44669954
model size : 185.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0143375396728516
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.706 Vali Acc: 0.522 Test Loss: 0.706 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.5454497337341309
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.696 Vali Acc: 0.511 Test Loss: 0.696 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5897727012634277
Epoch: 3, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.721 Vali Acc: 0.500 Test Loss: 0.721 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6113781929016113
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.698 Vali Acc: 0.539 Test Loss: 0.698 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538882).  Saving model ...
Epoch: 5 cost time: 1.2902195453643799
Epoch: 5, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.609114646911621
Epoch: 6, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4498097896575928
Epoch: 7, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.996 Vali Acc: 0.500 Test Loss: 0.996 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9114999771118164
Epoch: 8, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.737 Vali Acc: 0.506 Test Loss: 0.737 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8417408466339111
Epoch: 9, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.796 Vali Acc: 0.522 Test Loss: 0.796 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4948768615722656
Epoch: 10, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.091 Vali Acc: 0.517 Test Loss: 1.091 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.543720006942749
Epoch: 11, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.970 Vali Acc: 0.522 Test Loss: 0.970 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7391688823699951
Epoch: 12, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.120 Vali Acc: 0.489 Test Loss: 1.120 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7624685764312744
Epoch: 13, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.438 Vali Acc: 0.533 Test Loss: 1.438 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5819828510284424
Epoch: 14, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.264 Vali Acc: 0.561 Test Loss: 1.264 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561098).  Saving model ...
Epoch: 15 cost time: 1.6288478374481201
Epoch: 15, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.400 Vali Acc: 0.539 Test Loss: 1.400 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7325654029846191
Epoch: 16, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.584 Vali Acc: 0.539 Test Loss: 1.584 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9174778461456299
Epoch: 17, Steps: 13 | Train Loss: 0.254 Vali Loss: 2.009 Vali Acc: 0.550 Test Loss: 2.009 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6388914585113525
Epoch: 18, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.515 Vali Acc: 0.522 Test Loss: 1.515 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8760030269622803
Epoch: 19, Steps: 13 | Train Loss: 0.267 Vali Loss: 2.079 Vali Acc: 0.517 Test Loss: 2.079 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5603992938995361
Epoch: 20, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.717 Vali Acc: 0.556 Test Loss: 1.717 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.610440969467163
Epoch: 21, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.936 Vali Acc: 0.528 Test Loss: 1.936 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9211037158966064
Epoch: 22, Steps: 13 | Train Loss: 0.077 Vali Loss: 2.884 Vali Acc: 0.511 Test Loss: 2.884 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5984036922454834
Epoch: 23, Steps: 13 | Train Loss: 0.375 Vali Loss: 2.046 Vali Acc: 0.522 Test Loss: 2.046 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4338579177856445
Epoch: 24, Steps: 13 | Train Loss: 0.189 Vali Loss: 2.101 Vali Acc: 0.550 Test Loss: 2.101 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 44571650
model size : 184.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.267793893814087
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.714 Vali Acc: 0.500 Test Loss: 0.714 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2573292255401611
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.694 Vali Acc: 0.472 Test Loss: 0.694 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6107885837554932
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.696 Vali Acc: 0.517 Test Loss: 0.696 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.6912293434143066
Epoch: 4, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.724 Vali Acc: 0.522 Test Loss: 0.724 Test Acc: 0.522
Validation loss decreased (-0.516660 --> -0.522215).  Saving model ...
Epoch: 5 cost time: 1.5610427856445312
Epoch: 5, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.696 Vali Acc: 0.533 Test Loss: 0.696 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 1.3333721160888672
Epoch: 6, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.577558994293213
Epoch: 7, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.760 Vali Acc: 0.489 Test Loss: 0.760 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0960097312927246
Epoch: 8, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.779 Vali Acc: 0.517 Test Loss: 0.779 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5482728481292725
Epoch: 9, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.893 Vali Acc: 0.467 Test Loss: 0.893 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.320664405822754
Epoch: 10, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.841 Vali Acc: 0.511 Test Loss: 0.841 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6468207836151123
Epoch: 11, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.924 Vali Acc: 0.544 Test Loss: 0.924 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544435).  Saving model ...
Epoch: 12 cost time: 1.2224156856536865
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.050 Vali Acc: 0.500 Test Loss: 1.050 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6101384162902832
Epoch: 13, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.043 Vali Acc: 0.539 Test Loss: 1.043 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5080573558807373
Epoch: 14, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.020 Vali Acc: 0.478 Test Loss: 1.020 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4792592525482178
Epoch: 15, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.281 Vali Acc: 0.511 Test Loss: 1.281 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4971745014190674
Epoch: 16, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.284 Vali Acc: 0.539 Test Loss: 1.284 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6416711807250977
Epoch: 17, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.445 Vali Acc: 0.533 Test Loss: 1.445 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3453328609466553
Epoch: 18, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.300 Vali Acc: 0.539 Test Loss: 1.300 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4314522743225098
Epoch: 19, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3353464603424072
Epoch: 20, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.448 Vali Acc: 0.517 Test Loss: 1.448 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.949444055557251
Epoch: 21, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.608 Vali Acc: 0.506 Test Loss: 1.608 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 44522498
model size : 184.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps72_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.826887845993042
Epoch: 1, Steps: 13 | Train Loss: 0.792 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.076493501663208
Epoch: 2, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.697 Vali Acc: 0.544 Test Loss: 0.697 Test Acc: 0.544
Validation loss decreased (-0.499992 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 2.167402505874634
Epoch: 3, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.725 Vali Acc: 0.528 Test Loss: 0.725 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2689096927642822
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9092671871185303
Epoch: 5, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.735 Vali Acc: 0.544 Test Loss: 0.735 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9156675338745117
Epoch: 6, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.794 Vali Acc: 0.506 Test Loss: 0.794 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6980845928192139
Epoch: 7, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.807 Vali Acc: 0.489 Test Loss: 0.807 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7523036003112793
Epoch: 8, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.841 Vali Acc: 0.489 Test Loss: 0.841 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8443856239318848
Epoch: 9, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.925 Vali Acc: 0.517 Test Loss: 0.925 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0186562538146973
Epoch: 10, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.049889326095581
Epoch: 11, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.073 Vali Acc: 0.511 Test Loss: 1.073 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8221149444580078
Epoch: 12, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.405 Vali Acc: 0.522 Test Loss: 1.405 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps72_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 44725250
model size : 185.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps72_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.945467948913574
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.717 Vali Acc: 0.500 Test Loss: 0.717 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.8410327434539795
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.688 Vali Acc: 0.539 Test Loss: 0.688 Test Acc: 0.539
Validation loss decreased (-0.499993 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.7040228843688965
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.712 Vali Acc: 0.494 Test Loss: 0.712 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6339821815490723
Epoch: 4, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.7154815196990967
Epoch: 5, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7120873928070068
Epoch: 6, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.745 Vali Acc: 0.511 Test Loss: 0.745 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.703383445739746
Epoch: 7, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.784 Vali Acc: 0.517 Test Loss: 0.784 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6629738807678223
Epoch: 8, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.796 Vali Acc: 0.539 Test Loss: 0.796 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5560615062713623
Epoch: 9, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.913 Vali Acc: 0.478 Test Loss: 0.913 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5988702774047852
Epoch: 10, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.904 Vali Acc: 0.528 Test Loss: 0.904 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1382291316986084
Epoch: 11, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.403 Vali Acc: 0.511 Test Loss: 1.403 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9999611377716064
Epoch: 12, Steps: 13 | Train Loss: 0.588 Vali Loss: 1.269 Vali Acc: 0.444 Test Loss: 1.269 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9047625064849854
Epoch: 13, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.023 Vali Acc: 0.506 Test Loss: 1.023 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1111907958984375
Epoch: 14, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.315 Vali Acc: 0.494 Test Loss: 1.315 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps72_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 44633090
model size : 184.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps72_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.615004777908325
Epoch: 1, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.698 Vali Acc: 0.533 Test Loss: 0.698 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.1808769702911377
Epoch: 2, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.689 Vali Acc: 0.478 Test Loss: 0.689 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0562739372253418
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.692 Vali Acc: 0.556 Test Loss: 0.692 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555549).  Saving model ...
Epoch: 4 cost time: 1.7959802150726318
Epoch: 4, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.535961389541626
Epoch: 5, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.705 Vali Acc: 0.483 Test Loss: 0.705 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1034860610961914
Epoch: 6, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.766 Vali Acc: 0.517 Test Loss: 0.766 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2069339752197266
Epoch: 7, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.999 Vali Acc: 0.439 Test Loss: 0.999 Test Acc: 0.439
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7320456504821777
Epoch: 8, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.994 Vali Acc: 0.511 Test Loss: 0.994 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9440805912017822
Epoch: 9, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.808 Vali Acc: 0.511 Test Loss: 0.808 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3110284805297852
Epoch: 10, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.849 Vali Acc: 0.522 Test Loss: 0.849 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.577197790145874
Epoch: 11, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.014 Vali Acc: 0.483 Test Loss: 1.014 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3800692558288574
Epoch: 12, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3159120082855225
Epoch: 13, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.185 Vali Acc: 0.483 Test Loss: 1.185 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps72_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 44587010
model size : 184.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8339805603027344
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.770 Vali Acc: 0.483 Test Loss: 0.770 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 2.4939591884613037
Epoch: 2, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.699 Vali Acc: 0.539 Test Loss: 0.699 Test Acc: 0.539
Validation loss decreased (-0.483326 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.9928059577941895
Epoch: 3, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.858 Vali Acc: 0.500 Test Loss: 0.858 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6456685066223145
Epoch: 4, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.730 Vali Acc: 0.494 Test Loss: 0.730 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.232125997543335
Epoch: 5, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.721 Vali Acc: 0.550 Test Loss: 0.721 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.230552911758423
Epoch: 6, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.871 Vali Acc: 0.506 Test Loss: 0.871 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8257641792297363
Epoch: 7, Steps: 13 | Train Loss: 0.716 Vali Loss: 1.035 Vali Acc: 0.506 Test Loss: 1.035 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5981857776641846
Epoch: 8, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.905 Vali Acc: 0.517 Test Loss: 0.905 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1326520442962646
Epoch: 9, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6050379276275635
Epoch: 10, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.080 Vali Acc: 0.494 Test Loss: 1.080 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7604379653930664
Epoch: 11, Steps: 13 | Train Loss: 0.568 Vali Loss: 1.114 Vali Acc: 0.506 Test Loss: 1.114 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.42034912109375
Epoch: 12, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.128 Vali Acc: 0.517 Test Loss: 1.128 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0310542583465576
Epoch: 13, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.597 Vali Acc: 0.478 Test Loss: 1.597 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1948139667510986
Epoch: 14, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.787 Vali Acc: 0.533 Test Loss: 1.787 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0489320755004883
Epoch: 15, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.585 Vali Acc: 0.528 Test Loss: 1.585 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 44784386
model size : 185.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.100350618362427
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.711 Vali Acc: 0.483 Test Loss: 0.711 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.671839714050293
Epoch: 2, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.721 Vali Acc: 0.494 Test Loss: 0.721 Test Acc: 0.494
Validation loss decreased (-0.483326 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 2.1387367248535156
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.688 Vali Acc: 0.533 Test Loss: 0.688 Test Acc: 0.533
Validation loss decreased (-0.494437 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.7078790664672852
Epoch: 4, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3155150413513184
Epoch: 5, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.719 Vali Acc: 0.528 Test Loss: 0.719 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5882823467254639
Epoch: 6, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.760 Vali Acc: 0.500 Test Loss: 0.760 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.244155168533325
Epoch: 7, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.748 Vali Acc: 0.494 Test Loss: 0.748 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.840669870376587
Epoch: 8, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.865 Vali Acc: 0.494 Test Loss: 0.865 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1140174865722656
Epoch: 9, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.852 Vali Acc: 0.489 Test Loss: 0.852 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3934240341186523
Epoch: 10, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.894 Vali Acc: 0.506 Test Loss: 0.894 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1685867309570312
Epoch: 11, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.953 Vali Acc: 0.489 Test Loss: 0.953 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7227363586425781
Epoch: 12, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.915 Vali Acc: 0.533 Test Loss: 0.915 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3469908237457275
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.976 Vali Acc: 0.500 Test Loss: 0.976 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 44704514
model size : 185.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7860851287841797
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.701 Vali Acc: 0.517 Test Loss: 0.701 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.204662799835205
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.733 Vali Acc: 0.533 Test Loss: 0.733 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.5132226943969727
Epoch: 3, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.687 Vali Acc: 0.544 Test Loss: 0.687 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 1.424628734588623
Epoch: 4, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.710 Vali Acc: 0.533 Test Loss: 0.710 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8575341701507568
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3812928199768066
Epoch: 6, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.718 Vali Acc: 0.517 Test Loss: 0.718 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3634145259857178
Epoch: 7, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.751 Vali Acc: 0.528 Test Loss: 0.751 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2348036766052246
Epoch: 8, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.805 Vali Acc: 0.478 Test Loss: 0.805 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4003026485443115
Epoch: 9, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.997 Vali Acc: 0.494 Test Loss: 0.997 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3881597518920898
Epoch: 10, Steps: 13 | Train Loss: 0.524 Vali Loss: 1.002 Vali Acc: 0.478 Test Loss: 1.002 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3793120384216309
Epoch: 11, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.909 Vali Acc: 0.500 Test Loss: 0.909 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2632107734680176
Epoch: 12, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.060 Vali Acc: 0.483 Test Loss: 1.060 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5240588188171387
Epoch: 13, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.205 Vali Acc: 0.489 Test Loss: 1.205 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 44661506
model size : 185.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps83_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.188558578491211
Epoch: 1, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.725 Vali Acc: 0.506 Test Loss: 0.725 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.659534215927124
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.721 Vali Acc: 0.539 Test Loss: 0.721 Test Acc: 0.539
Validation loss decreased (-0.505548 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.6428003311157227
Epoch: 3, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.715 Vali Acc: 0.472 Test Loss: 0.715 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3956689834594727
Epoch: 4, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.717 Vali Acc: 0.494 Test Loss: 0.717 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.31953763961792
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.721 Vali Acc: 0.528 Test Loss: 0.721 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3682804107666016
Epoch: 6, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.059054374694824
Epoch: 7, Steps: 13 | Train Loss: 0.607 Vali Loss: 1.038 Vali Acc: 0.506 Test Loss: 1.038 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7329165935516357
Epoch: 8, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.892949104309082
Epoch: 9, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.834 Vali Acc: 0.539 Test Loss: 0.834 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.10711932182312
Epoch: 10, Steps: 13 | Train Loss: 0.532 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8379523754119873
Epoch: 11, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.942 Vali Acc: 0.544 Test Loss: 0.942 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544435).  Saving model ...
Epoch: 12 cost time: 2.1477622985839844
Epoch: 12, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.228 Vali Acc: 0.533 Test Loss: 1.228 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7105839252471924
Epoch: 13, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.352 Vali Acc: 0.478 Test Loss: 1.352 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.054671287536621
Epoch: 14, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.451 Vali Acc: 0.483 Test Loss: 1.451 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.214080810546875
Epoch: 15, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.431 Vali Acc: 0.511 Test Loss: 1.431 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.016387462615967
Epoch: 16, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.665 Vali Acc: 0.506 Test Loss: 1.665 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6334178447723389
Epoch: 17, Steps: 13 | Train Loss: 0.219 Vali Loss: 2.193 Vali Acc: 0.506 Test Loss: 2.193 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9098000526428223
Epoch: 18, Steps: 13 | Train Loss: 0.218 Vali Loss: 2.307 Vali Acc: 0.517 Test Loss: 2.307 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.4856655597686768
Epoch: 19, Steps: 13 | Train Loss: 0.253 Vali Loss: 2.034 Vali Acc: 0.511 Test Loss: 2.034 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.38551926612854
Epoch: 20, Steps: 13 | Train Loss: 0.363 Vali Loss: 1.637 Vali Acc: 0.467 Test Loss: 1.637 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2581470012664795
Epoch: 21, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.783 Vali Acc: 0.533 Test Loss: 1.783 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps83_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 44871938
model size : 185.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps83_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6916399002075195
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.711 Vali Acc: 0.433 Test Loss: 0.711 Test Acc: 0.433
Validation loss decreased (inf --> -0.433326).  Saving model ...
Epoch: 2 cost time: 1.6231727600097656
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.729 Vali Acc: 0.461 Test Loss: 0.729 Test Acc: 0.461
Validation loss decreased (-0.433326 --> -0.461104).  Saving model ...
Epoch: 3 cost time: 1.805905818939209
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.706 Vali Acc: 0.489 Test Loss: 0.706 Test Acc: 0.489
Validation loss decreased (-0.461104 --> -0.488882).  Saving model ...
Epoch: 4 cost time: 1.6656608581542969
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.716 Vali Acc: 0.478 Test Loss: 0.716 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.203998565673828
Epoch: 5, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.726 Vali Acc: 0.522 Test Loss: 0.726 Test Acc: 0.522
Validation loss decreased (-0.488882 --> -0.522215).  Saving model ...
Epoch: 6 cost time: 1.9798498153686523
Epoch: 6, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.734 Vali Acc: 0.572 Test Loss: 0.734 Test Acc: 0.572
Validation loss decreased (-0.522215 --> -0.572215).  Saving model ...
Epoch: 7 cost time: 1.8564395904541016
Epoch: 7, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.906 Vali Acc: 0.483 Test Loss: 0.906 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6177048683166504
Epoch: 8, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.830 Vali Acc: 0.506 Test Loss: 0.830 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.934321641921997
Epoch: 9, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.891 Vali Acc: 0.467 Test Loss: 0.891 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8716342449188232
Epoch: 10, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.941 Vali Acc: 0.500 Test Loss: 0.941 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.294457197189331
Epoch: 11, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.995 Vali Acc: 0.511 Test Loss: 0.995 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0835511684417725
Epoch: 12, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.101 Vali Acc: 0.522 Test Loss: 1.101 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4166004657745361
Epoch: 13, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.345 Vali Acc: 0.533 Test Loss: 1.345 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1849658489227295
Epoch: 14, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.590 Vali Acc: 0.511 Test Loss: 1.590 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5862460136413574
Epoch: 15, Steps: 13 | Train Loss: 0.252 Vali Loss: 1.638 Vali Acc: 0.517 Test Loss: 1.638 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5186681747436523
Epoch: 16, Steps: 13 | Train Loss: 0.256 Vali Loss: 1.467 Vali Acc: 0.450 Test Loss: 1.467 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps83_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 44795138
model size : 185.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps83_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6854114532470703
Epoch: 1, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.674 Vali Acc: 0.567 Test Loss: 0.674 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 1.0804345607757568
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.677 Vali Acc: 0.533 Test Loss: 0.677 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.854804277420044
Epoch: 3, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.671 Vali Acc: 0.578 Test Loss: 0.671 Test Acc: 0.578
Validation loss decreased (-0.566660 --> -0.577771).  Saving model ...
Epoch: 4 cost time: 1.0045912265777588
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.682 Vali Acc: 0.578 Test Loss: 0.682 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.075697422027588
Epoch: 5, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.813 Vali Acc: 0.528 Test Loss: 0.813 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.292855978012085
Epoch: 6, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.757 Vali Acc: 0.528 Test Loss: 0.757 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4163658618927002
Epoch: 7, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.813 Vali Acc: 0.478 Test Loss: 0.813 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0389654636383057
Epoch: 8, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.853 Vali Acc: 0.506 Test Loss: 0.853 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2897799015045166
Epoch: 9, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.965 Vali Acc: 0.494 Test Loss: 0.965 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3212265968322754
Epoch: 10, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.928 Vali Acc: 0.528 Test Loss: 0.928 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1046993732452393
Epoch: 11, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.989 Vali Acc: 0.444 Test Loss: 0.989 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3687822818756104
Epoch: 12, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.995 Vali Acc: 0.489 Test Loss: 0.995 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2470777034759521
Epoch: 13, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.159 Vali Acc: 0.517 Test Loss: 1.159 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps83_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 44755202
model size : 185.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps89_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8810112476348877
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.807 Vali Acc: 0.500 Test Loss: 0.807 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.0689313411712646
Epoch: 2, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.697 Vali Acc: 0.506 Test Loss: 0.697 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505549).  Saving model ...
Epoch: 3 cost time: 1.8583264350891113
Epoch: 3, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.704 Vali Acc: 0.517 Test Loss: 0.704 Test Acc: 0.517
Validation loss decreased (-0.505549 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.549032211303711
Epoch: 4, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
Validation loss decreased (-0.516660 --> -0.527771).  Saving model ...
Epoch: 5 cost time: 1.0498948097229004
Epoch: 5, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.878 Vali Acc: 0.494 Test Loss: 0.878 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.248286485671997
Epoch: 6, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.860 Vali Acc: 0.544 Test Loss: 0.860 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544436).  Saving model ...
Epoch: 7 cost time: 1.0425736904144287
Epoch: 7, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.868 Vali Acc: 0.494 Test Loss: 0.868 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4266185760498047
Epoch: 8, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.029 Vali Acc: 0.489 Test Loss: 1.029 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0959043502807617
Epoch: 9, Steps: 13 | Train Loss: 0.550 Vali Loss: 1.019 Vali Acc: 0.511 Test Loss: 1.019 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2437257766723633
Epoch: 10, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.923 Vali Acc: 0.517 Test Loss: 0.923 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.583411455154419
Epoch: 11, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.957 Vali Acc: 0.506 Test Loss: 0.957 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.436004638671875
Epoch: 12, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.159 Vali Acc: 0.539 Test Loss: 1.159 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.494727611541748
Epoch: 13, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.268 Vali Acc: 0.483 Test Loss: 1.268 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4592232704162598
Epoch: 14, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.181 Vali Acc: 0.517 Test Loss: 1.181 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3856046199798584
Epoch: 15, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.600 Vali Acc: 0.439 Test Loss: 1.600 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8485841751098633
Epoch: 16, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.605 Vali Acc: 0.428 Test Loss: 1.605 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps89_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 44956418
model size : 186.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps89_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6300957202911377
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.710 Vali Acc: 0.511 Test Loss: 0.710 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.9338314533233643
Epoch: 2, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.712 Vali Acc: 0.483 Test Loss: 0.712 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9382691383361816
Epoch: 3, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.690 Vali Acc: 0.539 Test Loss: 0.690 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.273252248764038
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.791 Vali Acc: 0.506 Test Loss: 0.791 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9801087379455566
Epoch: 5, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.737 Vali Acc: 0.522 Test Loss: 0.737 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2457547187805176
Epoch: 6, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.909 Vali Acc: 0.489 Test Loss: 0.909 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.480224847793579
Epoch: 7, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.827 Vali Acc: 0.517 Test Loss: 0.827 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1562976837158203
Epoch: 8, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.890 Vali Acc: 0.500 Test Loss: 0.890 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3358957767486572
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.940 Vali Acc: 0.511 Test Loss: 0.940 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.568523645401001
Epoch: 10, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.936 Vali Acc: 0.456 Test Loss: 0.936 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4219565391540527
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.343 Vali Acc: 0.472 Test Loss: 1.343 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3736424446105957
Epoch: 12, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.259 Vali Acc: 0.433 Test Loss: 1.259 Test Acc: 0.433
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.852290391921997
Epoch: 13, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.185 Vali Acc: 0.489 Test Loss: 1.185 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps89_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 44885762
model size : 185.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps89_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.319922685623169
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.734 Vali Acc: 0.489 Test Loss: 0.734 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.077277421951294
Epoch: 2, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.705 Vali Acc: 0.539 Test Loss: 0.705 Test Acc: 0.539
Validation loss decreased (-0.488882 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.2640125751495361
Epoch: 3, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.688 Vali Acc: 0.556 Test Loss: 0.688 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555549).  Saving model ...
Epoch: 4 cost time: 1.399876356124878
Epoch: 4, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.698 Vali Acc: 0.544 Test Loss: 0.698 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.944415807723999
Epoch: 5, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.696 Vali Acc: 0.544 Test Loss: 0.696 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.230393886566162
Epoch: 6, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.758 Vali Acc: 0.539 Test Loss: 0.758 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4031331539154053
Epoch: 7, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.829 Vali Acc: 0.544 Test Loss: 0.829 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.278892993927002
Epoch: 8, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.854 Vali Acc: 0.539 Test Loss: 0.854 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9550285339355469
Epoch: 9, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.965 Vali Acc: 0.517 Test Loss: 0.965 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.168339490890503
Epoch: 10, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.928 Vali Acc: 0.528 Test Loss: 0.928 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9995133876800537
Epoch: 11, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.979 Vali Acc: 0.500 Test Loss: 0.979 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2337980270385742
Epoch: 12, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.045 Vali Acc: 0.561 Test Loss: 1.045 Test Acc: 0.561
Validation loss decreased (-0.555549 --> -0.561101).  Saving model ...
Epoch: 13 cost time: 1.3339083194732666
Epoch: 13, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.195 Vali Acc: 0.533 Test Loss: 1.195 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1605727672576904
Epoch: 14, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.041 Vali Acc: 0.589 Test Loss: 1.041 Test Acc: 0.589
Validation loss decreased (-0.561101 --> -0.588878).  Saving model ...
Epoch: 15 cost time: 0.9059977531433105
Epoch: 15, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.204 Vali Acc: 0.583 Test Loss: 1.204 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8683381080627441
Epoch: 16, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.312 Vali Acc: 0.533 Test Loss: 1.312 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9314451217651367
Epoch: 17, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.591 Vali Acc: 0.506 Test Loss: 1.591 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0842649936676025
Epoch: 18, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.305 Vali Acc: 0.550 Test Loss: 1.305 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0190412998199463
Epoch: 19, Steps: 13 | Train Loss: 0.178 Vali Loss: 1.410 Vali Acc: 0.528 Test Loss: 1.410 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.06911039352417
Epoch: 20, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.464 Vali Acc: 0.567 Test Loss: 1.464 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0631499290466309
Epoch: 21, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.566 Vali Acc: 0.567 Test Loss: 1.566 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1402804851531982
Epoch: 22, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.577 Vali Acc: 0.522 Test Loss: 1.577 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9420475959777832
Epoch: 23, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.841 Vali Acc: 0.550 Test Loss: 1.841 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8637990951538086
Epoch: 24, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.728 Vali Acc: 0.578 Test Loss: 1.728 Test Acc: 0.578
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps89_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 44848898
model size : 185.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps96_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3622097969055176
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.717 Vali Acc: 0.478 Test Loss: 0.717 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 0.8875625133514404
Epoch: 2, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.719 Vali Acc: 0.528 Test Loss: 0.719 Test Acc: 0.528
Validation loss decreased (-0.477771 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.1545584201812744
Epoch: 3, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.739 Vali Acc: 0.506 Test Loss: 0.739 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1478323936462402
Epoch: 4, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.720 Vali Acc: 0.511 Test Loss: 0.720 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2639892101287842
Epoch: 5, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.844 Vali Acc: 0.506 Test Loss: 0.844 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1508405208587646
Epoch: 6, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.901 Vali Acc: 0.483 Test Loss: 0.901 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7913880348205566
Epoch: 7, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.849 Vali Acc: 0.494 Test Loss: 0.849 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6523771286010742
Epoch: 8, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.917 Vali Acc: 0.489 Test Loss: 0.917 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.167283773422241
Epoch: 9, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.264 Vali Acc: 0.489 Test Loss: 1.264 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7643728256225586
Epoch: 10, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.948 Vali Acc: 0.528 Test Loss: 0.948 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.973301649093628
Epoch: 11, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.104 Vali Acc: 0.483 Test Loss: 1.104 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9779877662658691
Epoch: 12, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.258 Vali Acc: 0.539 Test Loss: 1.258 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538876).  Saving model ...
Epoch: 13 cost time: 1.5976951122283936
Epoch: 13, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.622 Vali Acc: 0.494 Test Loss: 1.622 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.043060541152954
Epoch: 14, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.586 Vali Acc: 0.483 Test Loss: 1.586 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.883387804031372
Epoch: 15, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.434 Vali Acc: 0.494 Test Loss: 1.434 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.748061180114746
Epoch: 16, Steps: 13 | Train Loss: 0.359 Vali Loss: 2.134 Vali Acc: 0.533 Test Loss: 2.134 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2864830493927002
Epoch: 17, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.516 Vali Acc: 0.539 Test Loss: 1.516 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1469171047210693
Epoch: 18, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.294 Vali Acc: 0.511 Test Loss: 1.294 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6069698333740234
Epoch: 19, Steps: 13 | Train Loss: 0.356 Vali Loss: 2.359 Vali Acc: 0.511 Test Loss: 2.359 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9330987930297852
Epoch: 20, Steps: 13 | Train Loss: 0.272 Vali Loss: 2.854 Vali Acc: 0.500 Test Loss: 2.854 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8157410621643066
Epoch: 21, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.994 Vali Acc: 0.539 Test Loss: 1.994 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.709338903427124
Epoch: 22, Steps: 13 | Train Loss: 0.237 Vali Loss: 2.035 Vali Acc: 0.517 Test Loss: 2.035 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps96_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 45063170
model size : 186.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9228148460388184
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.701 Vali Acc: 0.511 Test Loss: 0.701 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.143333911895752
Epoch: 2, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.688 Vali Acc: 0.544 Test Loss: 0.688 Test Acc: 0.544
Validation loss decreased (-0.511104 --> -0.544438).  Saving model ...
Epoch: 3 cost time: 0.8721063137054443
Epoch: 3, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.695 Vali Acc: 0.500 Test Loss: 0.695 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0077526569366455
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
Validation loss decreased (-0.544438 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.0424509048461914
Epoch: 5, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.714 Vali Acc: 0.511 Test Loss: 0.714 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2921562194824219
Epoch: 6, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.722 Vali Acc: 0.544 Test Loss: 0.722 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.300328016281128
Epoch: 7, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.945 Vali Acc: 0.489 Test Loss: 0.945 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.410912036895752
Epoch: 8, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.840 Vali Acc: 0.544 Test Loss: 0.840 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6457788944244385
Epoch: 9, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.155 Vali Acc: 0.522 Test Loss: 1.155 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4499142169952393
Epoch: 10, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.017 Vali Acc: 0.511 Test Loss: 1.017 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2545454502105713
Epoch: 11, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.024 Vali Acc: 0.506 Test Loss: 1.024 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.309997320175171
Epoch: 12, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.128 Vali Acc: 0.517 Test Loss: 1.128 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.184056043624878
Epoch: 13, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.202 Vali Acc: 0.561 Test Loss: 1.202 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561099).  Saving model ...
Epoch: 14 cost time: 1.7069766521453857
Epoch: 14, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.176 Vali Acc: 0.494 Test Loss: 1.176 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7879924774169922
Epoch: 15, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.273 Vali Acc: 0.472 Test Loss: 1.273 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7400927543640137
Epoch: 16, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.394 Vali Acc: 0.539 Test Loss: 1.394 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2176411151885986
Epoch: 17, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1482717990875244
Epoch: 18, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.472 Vali Acc: 0.517 Test Loss: 1.472 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5443835258483887
Epoch: 19, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.717 Vali Acc: 0.522 Test Loss: 1.717 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4592299461364746
Epoch: 20, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.411 Vali Acc: 0.539 Test Loss: 1.411 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.01261043548584
Epoch: 21, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.505 Vali Acc: 0.522 Test Loss: 1.505 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5534117221832275
Epoch: 22, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.821 Vali Acc: 0.517 Test Loss: 1.821 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.348931074142456
Epoch: 23, Steps: 13 | Train Loss: 0.237 Vali Loss: 2.120 Vali Acc: 0.444 Test Loss: 2.120 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 44995586
model size : 186.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps96_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.108870267868042
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.689 Vali Acc: 0.528 Test Loss: 0.689 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 1.017061710357666
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.710 Vali Acc: 0.522 Test Loss: 0.710 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9348082542419434
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.720 Vali Acc: 0.517 Test Loss: 0.720 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.83970046043396
Epoch: 4, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.743 Vali Acc: 0.511 Test Loss: 0.743 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9194023609161377
Epoch: 5, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.700 Vali Acc: 0.561 Test Loss: 0.700 Test Acc: 0.561
Validation loss decreased (-0.527771 --> -0.561104).  Saving model ...
Epoch: 6 cost time: 1.0522096157073975
Epoch: 6, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.708 Vali Acc: 0.567 Test Loss: 0.708 Test Acc: 0.567
Validation loss decreased (-0.561104 --> -0.566660).  Saving model ...
Epoch: 7 cost time: 1.033914566040039
Epoch: 7, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.783 Vali Acc: 0.478 Test Loss: 0.783 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9342141151428223
Epoch: 8, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.824 Vali Acc: 0.511 Test Loss: 0.824 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9408445358276367
Epoch: 9, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.813 Vali Acc: 0.506 Test Loss: 0.813 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9159832000732422
Epoch: 10, Steps: 13 | Train Loss: 0.547 Vali Loss: 1.012 Vali Acc: 0.472 Test Loss: 1.012 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.403449296951294
Epoch: 11, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.925 Vali Acc: 0.467 Test Loss: 0.925 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2065880298614502
Epoch: 12, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.069 Vali Acc: 0.456 Test Loss: 1.069 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3102576732635498
Epoch: 13, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.014 Vali Acc: 0.511 Test Loss: 1.014 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0348944664001465
Epoch: 14, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.160 Vali Acc: 0.456 Test Loss: 1.160 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2795579433441162
Epoch: 15, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.239 Vali Acc: 0.478 Test Loss: 1.239 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.145110845565796
Epoch: 16, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.212 Vali Acc: 0.478 Test Loss: 1.212 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps96_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 44961794
model size : 186.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6878199577331543
Epoch: 1, Steps: 13 | Train Loss: 0.810 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.425220012664795
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.704 Vali Acc: 0.528 Test Loss: 0.704 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.8751740455627441
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.730 Vali Acc: 0.467 Test Loss: 0.730 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.000004529953003
Epoch: 4, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.696 Vali Acc: 0.572 Test Loss: 0.696 Test Acc: 0.572
Validation loss decreased (-0.527771 --> -0.572215).  Saving model ...
Epoch: 5 cost time: 2.3144900798797607
Epoch: 5, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.739 Vali Acc: 0.489 Test Loss: 0.739 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2098472118377686
Epoch: 6, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.447727680206299
Epoch: 7, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.814 Vali Acc: 0.511 Test Loss: 0.814 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7906148433685303
Epoch: 8, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.927 Vali Acc: 0.550 Test Loss: 0.927 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.248102903366089
Epoch: 9, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.885 Vali Acc: 0.567 Test Loss: 0.885 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5949325561523438
Epoch: 10, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.947 Vali Acc: 0.483 Test Loss: 0.947 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4032373428344727
Epoch: 11, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.940 Vali Acc: 0.483 Test Loss: 0.940 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.30466890335083
Epoch: 12, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.087 Vali Acc: 0.444 Test Loss: 1.087 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7804794311523438
Epoch: 13, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2828617095947266
Epoch: 14, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.474 Vali Acc: 0.550 Test Loss: 1.474 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 45189890
model size : 187.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.563873052597046
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.681 Vali Acc: 0.556 Test Loss: 0.681 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 1.0914349555969238
Epoch: 2, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.722 Vali Acc: 0.467 Test Loss: 0.722 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9881625175476074
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.694 Vali Acc: 0.522 Test Loss: 0.694 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0743615627288818
Epoch: 4, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.709 Vali Acc: 0.489 Test Loss: 0.709 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5404503345489502
Epoch: 5, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.751 Vali Acc: 0.433 Test Loss: 0.751 Test Acc: 0.433
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3759965896606445
Epoch: 6, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.778 Vali Acc: 0.556 Test Loss: 0.778 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2542119026184082
Epoch: 7, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.806 Vali Acc: 0.550 Test Loss: 0.806 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3686277866363525
Epoch: 8, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.926 Vali Acc: 0.489 Test Loss: 0.926 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.493762493133545
Epoch: 9, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.971 Vali Acc: 0.517 Test Loss: 0.971 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8225746154785156
Epoch: 10, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.905 Vali Acc: 0.467 Test Loss: 0.905 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.78877592086792
Epoch: 11, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.017 Vali Acc: 0.511 Test Loss: 1.017 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 45131522
model size : 186.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7235913276672363
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1828441619873047
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.679 Vali Acc: 0.544 Test Loss: 0.679 Test Acc: 0.544
Validation loss decreased (-0.499993 --> -0.544438).  Saving model ...
Epoch: 3 cost time: 1.4661202430725098
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.695 Vali Acc: 0.528 Test Loss: 0.695 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.45359468460083
Epoch: 4, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.707 Vali Acc: 0.478 Test Loss: 0.707 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3273813724517822
Epoch: 5, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.707 Vali Acc: 0.517 Test Loss: 0.707 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3497025966644287
Epoch: 6, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.835 Vali Acc: 0.533 Test Loss: 0.835 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4946167469024658
Epoch: 7, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.795 Vali Acc: 0.556 Test Loss: 0.795 Test Acc: 0.556
Validation loss decreased (-0.544438 --> -0.555548).  Saving model ...
Epoch: 8 cost time: 1.0231366157531738
Epoch: 8, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.797 Vali Acc: 0.489 Test Loss: 0.797 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2255959510803223
Epoch: 9, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.850 Vali Acc: 0.472 Test Loss: 0.850 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4109575748443604
Epoch: 10, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.957 Vali Acc: 0.472 Test Loss: 0.957 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8991563320159912
Epoch: 11, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.087 Vali Acc: 0.461 Test Loss: 1.087 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4595680236816406
Epoch: 12, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.091 Vali Acc: 0.444 Test Loss: 1.091 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9983289241790771
Epoch: 13, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.177 Vali Acc: 0.461 Test Loss: 1.177 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3853816986083984
Epoch: 14, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.152 Vali Acc: 0.478 Test Loss: 1.152 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.196711540222168
Epoch: 15, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.312 Vali Acc: 0.517 Test Loss: 1.312 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2947931289672852
Epoch: 16, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.060 Vali Acc: 0.522 Test Loss: 1.060 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2914714813232422
Epoch: 17, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.164 Vali Acc: 0.522 Test Loss: 1.164 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 45100802
model size : 186.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps116_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.255765438079834
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.679 Vali Acc: 0.567 Test Loss: 0.679 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 1.756230354309082
Epoch: 2, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.698 Vali Acc: 0.506 Test Loss: 0.698 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7317569255828857
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2055652141571045
Epoch: 4, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.761 Vali Acc: 0.506 Test Loss: 0.761 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.937915563583374
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.737 Vali Acc: 0.528 Test Loss: 0.737 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2115042209625244
Epoch: 6, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.742 Vali Acc: 0.494 Test Loss: 0.742 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8806593418121338
Epoch: 7, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.831 Vali Acc: 0.522 Test Loss: 0.831 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8798718452453613
Epoch: 8, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6490049362182617
Epoch: 9, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.924 Vali Acc: 0.511 Test Loss: 0.924 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1933681964874268
Epoch: 10, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.020 Vali Acc: 0.517 Test Loss: 1.020 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4198966026306152
Epoch: 11, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.093 Vali Acc: 0.522 Test Loss: 1.093 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps116_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 45358082
model size : 187.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.702380657196045
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.716 Vali Acc: 0.494 Test Loss: 0.716 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.1744730472564697
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.674 Vali Acc: 0.578 Test Loss: 0.674 Test Acc: 0.578
Validation loss decreased (-0.494437 --> -0.577771).  Saving model ...
Epoch: 3 cost time: 1.4445555210113525
Epoch: 3, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.677 Vali Acc: 0.556 Test Loss: 0.677 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1386916637420654
Epoch: 4, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.710 Vali Acc: 0.544 Test Loss: 0.710 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.56557035446167
Epoch: 5, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.752 Vali Acc: 0.489 Test Loss: 0.752 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4674577713012695
Epoch: 6, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.730 Vali Acc: 0.528 Test Loss: 0.730 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2141873836517334
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.773 Vali Acc: 0.511 Test Loss: 0.773 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3956708908081055
Epoch: 8, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.789 Vali Acc: 0.583 Test Loss: 0.789 Test Acc: 0.583
Validation loss decreased (-0.577771 --> -0.583325).  Saving model ...
Epoch: 9 cost time: 1.383094072341919
Epoch: 9, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.851 Vali Acc: 0.556 Test Loss: 0.851 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1587839126586914
Epoch: 10, Steps: 13 | Train Loss: 0.495 Vali Loss: 1.044 Vali Acc: 0.511 Test Loss: 1.044 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9368846416473389
Epoch: 11, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.989 Vali Acc: 0.550 Test Loss: 0.989 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2746999263763428
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.959 Vali Acc: 0.511 Test Loss: 0.959 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.856229305267334
Epoch: 13, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.135 Vali Acc: 0.517 Test Loss: 1.135 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6245410442352295
Epoch: 14, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.126 Vali Acc: 0.461 Test Loss: 1.126 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2890288829803467
Epoch: 15, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.337 Vali Acc: 0.528 Test Loss: 1.337 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7615036964416504
Epoch: 16, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.347 Vali Acc: 0.528 Test Loss: 1.347 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0762481689453125
Epoch: 17, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.607 Vali Acc: 0.500 Test Loss: 1.607 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9409701824188232
Epoch: 18, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.518 Vali Acc: 0.494 Test Loss: 1.518 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 45302786
model size : 187.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps116_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4587197303771973
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.731 Vali Acc: 0.517 Test Loss: 0.731 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 0.6778230667114258
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.690 Vali Acc: 0.517 Test Loss: 0.690 Test Acc: 0.517
Validation loss decreased (-0.516659 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 1.0691969394683838
Epoch: 3, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.706 Vali Acc: 0.511 Test Loss: 0.706 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0723333358764648
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.717 Vali Acc: 0.517 Test Loss: 0.717 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1178357601165771
Epoch: 5, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.729 Vali Acc: 0.528 Test Loss: 0.729 Test Acc: 0.528
Validation loss decreased (-0.516660 --> -0.527770).  Saving model ...
Epoch: 6 cost time: 1.2750656604766846
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.776 Vali Acc: 0.472 Test Loss: 0.776 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9319741725921631
Epoch: 7, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.857 Vali Acc: 0.528 Test Loss: 0.857 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2813260555267334
Epoch: 8, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.949 Vali Acc: 0.500 Test Loss: 0.949 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8814651966094971
Epoch: 9, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.031 Vali Acc: 0.489 Test Loss: 1.031 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.083571195602417
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0767409801483154
Epoch: 11, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.055 Vali Acc: 0.494 Test Loss: 1.055 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1292991638183594
Epoch: 12, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.375 Vali Acc: 0.483 Test Loss: 1.375 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9317605495452881
Epoch: 13, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.198 Vali Acc: 0.472 Test Loss: 1.198 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0455222129821777
Epoch: 14, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2748417854309082
Epoch: 15, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.295 Vali Acc: 0.478 Test Loss: 1.295 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps116_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 45275138
model size : 187.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.554421901702881
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.715 Vali Acc: 0.428 Test Loss: 0.715 Test Acc: 0.428
Validation loss decreased (inf --> -0.427771).  Saving model ...
Epoch: 2 cost time: 1.68782377243042
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.732 Vali Acc: 0.489 Test Loss: 0.732 Test Acc: 0.489
Validation loss decreased (-0.427771 --> -0.488882).  Saving model ...
Epoch: 3 cost time: 1.5254499912261963
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.712 Vali Acc: 0.539 Test Loss: 0.712 Test Acc: 0.539
Validation loss decreased (-0.488882 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.5266191959381104
Epoch: 4, Steps: 13 | Train Loss: 0.728 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3251466751098633
Epoch: 5, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.781 Vali Acc: 0.478 Test Loss: 0.781 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8592698574066162
Epoch: 6, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.783 Vali Acc: 0.500 Test Loss: 0.783 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5071277618408203
Epoch: 7, Steps: 13 | Train Loss: 0.557 Vali Loss: 1.017 Vali Acc: 0.478 Test Loss: 1.017 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8387470245361328
Epoch: 8, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.921 Vali Acc: 0.478 Test Loss: 0.921 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6822221279144287
Epoch: 9, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.015 Vali Acc: 0.444 Test Loss: 1.015 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8881335258483887
Epoch: 10, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.190 Vali Acc: 0.494 Test Loss: 1.190 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5058228969573975
Epoch: 11, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.537 Vali Acc: 0.483 Test Loss: 1.537 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.517129898071289
Epoch: 12, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.246 Vali Acc: 0.444 Test Loss: 1.246 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6700961589813232
Epoch: 13, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.401 Vali Acc: 0.522 Test Loss: 1.401 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 45542402
model size : 188.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.682704448699951
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.725 Vali Acc: 0.489 Test Loss: 0.725 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.0834424495697021
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.696 Vali Acc: 0.533 Test Loss: 0.696 Test Acc: 0.533
Validation loss decreased (-0.488882 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.1767687797546387
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.696 Vali Acc: 0.567 Test Loss: 0.696 Test Acc: 0.567
Validation loss decreased (-0.533326 --> -0.566660).  Saving model ...
Epoch: 4 cost time: 1.5313911437988281
Epoch: 4, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.702 Vali Acc: 0.533 Test Loss: 0.702 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8809452056884766
Epoch: 5, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.741 Vali Acc: 0.506 Test Loss: 0.741 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4272575378417969
Epoch: 6, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.787 Vali Acc: 0.494 Test Loss: 0.787 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9287221431732178
Epoch: 7, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.836 Vali Acc: 0.494 Test Loss: 0.836 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.704805612564087
Epoch: 8, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.865 Vali Acc: 0.483 Test Loss: 0.865 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6528935432434082
Epoch: 9, Steps: 13 | Train Loss: 0.516 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4756903648376465
Epoch: 10, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.966 Vali Acc: 0.506 Test Loss: 0.966 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7988243103027344
Epoch: 11, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.029 Vali Acc: 0.522 Test Loss: 1.029 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4429295063018799
Epoch: 12, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.977 Vali Acc: 0.522 Test Loss: 0.977 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5605249404907227
Epoch: 13, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.237 Vali Acc: 0.544 Test Loss: 1.237 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 45493250
model size : 188.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.087723970413208
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.707 Vali Acc: 0.511 Test Loss: 0.707 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.8322062492370605
Epoch: 2, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.686 Vali Acc: 0.539 Test Loss: 0.686 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.1097066402435303
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.706 Vali Acc: 0.522 Test Loss: 0.706 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1075215339660645
Epoch: 4, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 0.8234782218933105
Epoch: 5, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.710 Vali Acc: 0.517 Test Loss: 0.710 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9198319911956787
Epoch: 6, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.724 Vali Acc: 0.506 Test Loss: 0.724 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9545631408691406
Epoch: 7, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.801 Vali Acc: 0.539 Test Loss: 0.801 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.131685733795166
Epoch: 8, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.957 Vali Acc: 0.467 Test Loss: 0.957 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0054917335510254
Epoch: 9, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.992 Vali Acc: 0.517 Test Loss: 0.992 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0496323108673096
Epoch: 10, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.870 Vali Acc: 0.511 Test Loss: 0.870 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9464116096496582
Epoch: 11, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.918 Vali Acc: 0.500 Test Loss: 0.918 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0616583824157715
Epoch: 12, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.970 Vali Acc: 0.511 Test Loss: 0.970 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2750864028930664
Epoch: 13, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.119 Vali Acc: 0.494 Test Loss: 1.119 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1842811107635498
Epoch: 14, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.237 Vali Acc: 0.506 Test Loss: 1.237 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 45468674
model size : 188.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps144_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.7769765853881836
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.7168426513671875
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.744 Vali Acc: 0.489 Test Loss: 0.744 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5976696014404297
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2715368270874023
Epoch: 4, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.734 Vali Acc: 0.494 Test Loss: 0.734 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6305453777313232
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.771 Vali Acc: 0.478 Test Loss: 0.771 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1357967853546143
Epoch: 6, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.811 Vali Acc: 0.506 Test Loss: 0.811 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505547).  Saving model ...
Epoch: 7 cost time: 2.0682528018951416
Epoch: 7, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.876 Vali Acc: 0.494 Test Loss: 0.876 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4847052097320557
Epoch: 8, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.752 Vali Acc: 0.506 Test Loss: 0.752 Test Acc: 0.506
Validation loss decreased (-0.505547 --> -0.505548).  Saving model ...
Epoch: 9 cost time: 1.5063889026641846
Epoch: 9, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.818 Vali Acc: 0.461 Test Loss: 0.818 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8711028099060059
Epoch: 10, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.677473783493042
Epoch: 11, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.888 Vali Acc: 0.472 Test Loss: 0.888 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7541382312774658
Epoch: 12, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.945 Vali Acc: 0.467 Test Loss: 0.945 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5905311107635498
Epoch: 13, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.970 Vali Acc: 0.528 Test Loss: 0.970 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527768).  Saving model ...
Epoch: 14 cost time: 1.6809656620025635
Epoch: 14, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.195 Vali Acc: 0.556 Test Loss: 1.195 Test Acc: 0.556
Validation loss decreased (-0.527768 --> -0.555544).  Saving model ...
Epoch: 15 cost time: 1.5085735321044922
Epoch: 15, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.170 Vali Acc: 0.533 Test Loss: 1.170 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5662083625793457
Epoch: 16, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.215 Vali Acc: 0.533 Test Loss: 1.215 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3800179958343506
Epoch: 17, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.434 Vali Acc: 0.478 Test Loss: 1.434 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5700316429138184
Epoch: 18, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.415 Vali Acc: 0.567 Test Loss: 1.415 Test Acc: 0.567
Validation loss decreased (-0.555544 --> -0.566653).  Saving model ...
Epoch: 19 cost time: 1.5706491470336914
Epoch: 19, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.292 Vali Acc: 0.528 Test Loss: 1.292 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2645056247711182
Epoch: 20, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.614 Vali Acc: 0.522 Test Loss: 1.614 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3704328536987305
Epoch: 21, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.593 Vali Acc: 0.517 Test Loss: 1.593 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.657395362854004
Epoch: 22, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.697 Vali Acc: 0.506 Test Loss: 1.697 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6251699924468994
Epoch: 23, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.650 Vali Acc: 0.528 Test Loss: 1.650 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8403029441833496
Epoch: 24, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.733 Vali Acc: 0.489 Test Loss: 1.733 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.704850435256958
Epoch: 25, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.804 Vali Acc: 0.556 Test Loss: 1.804 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4792842864990234
Epoch: 26, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.881 Vali Acc: 0.511 Test Loss: 1.881 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.569640874862671
Epoch: 27, Steps: 13 | Train Loss: 0.064 Vali Loss: 2.514 Vali Acc: 0.528 Test Loss: 2.514 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.578691005706787
Epoch: 28, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.931 Vali Acc: 0.511 Test Loss: 1.931 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps144_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 45788162
model size : 189.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps144_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.762122869491577
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.694 Vali Acc: 0.522 Test Loss: 0.694 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.9930474758148193
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.693 Vali Acc: 0.556 Test Loss: 0.693 Test Acc: 0.556
Validation loss decreased (-0.522215 --> -0.555549).  Saving model ...
Epoch: 3 cost time: 1.2179069519042969
Epoch: 3, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.688 Vali Acc: 0.539 Test Loss: 0.688 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1280107498168945
Epoch: 4, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.725 Vali Acc: 0.528 Test Loss: 0.725 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0002739429473877
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.739 Vali Acc: 0.544 Test Loss: 0.739 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2544221878051758
Epoch: 6, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.779 Vali Acc: 0.533 Test Loss: 0.779 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1211020946502686
Epoch: 7, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.753 Vali Acc: 0.528 Test Loss: 0.753 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8982431888580322
Epoch: 8, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.773 Vali Acc: 0.506 Test Loss: 0.773 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9195902347564697
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.946 Vali Acc: 0.483 Test Loss: 0.946 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3292131423950195
Epoch: 10, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3452506065368652
Epoch: 11, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.119 Vali Acc: 0.556 Test Loss: 1.119 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2494595050811768
Epoch: 12, Steps: 13 | Train Loss: 0.555 Vali Loss: 1.103 Vali Acc: 0.456 Test Loss: 1.103 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps144_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 45745154
model size : 189.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps144_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.831988573074341
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1340100765228271
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.711 Vali Acc: 0.456 Test Loss: 0.711 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9069857597351074
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.686 Vali Acc: 0.517 Test Loss: 0.686 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.0964572429656982
Epoch: 4, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.711 Vali Acc: 0.533 Test Loss: 0.711 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 1.0005221366882324
Epoch: 5, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.692 Vali Acc: 0.511 Test Loss: 0.692 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0462775230407715
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.695 Vali Acc: 0.556 Test Loss: 0.695 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555549).  Saving model ...
Epoch: 7 cost time: 1.0643284320831299
Epoch: 7, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.727 Vali Acc: 0.522 Test Loss: 0.727 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9548516273498535
Epoch: 8, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.853 Vali Acc: 0.528 Test Loss: 0.853 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.932842493057251
Epoch: 9, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.943 Vali Acc: 0.511 Test Loss: 0.943 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2389843463897705
Epoch: 10, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.840 Vali Acc: 0.539 Test Loss: 0.840 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2548158168792725
Epoch: 11, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.882 Vali Acc: 0.511 Test Loss: 0.882 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2925198078155518
Epoch: 12, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.977 Vali Acc: 0.517 Test Loss: 0.977 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0573627948760986
Epoch: 13, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.951 Vali Acc: 0.506 Test Loss: 0.951 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1129133701324463
Epoch: 14, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.101 Vali Acc: 0.483 Test Loss: 1.101 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2021207809448242
Epoch: 15, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.211 Vali Acc: 0.506 Test Loss: 1.211 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1157734394073486
Epoch: 16, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.298 Vali Acc: 0.450 Test Loss: 1.298 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps144_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 45723650
model size : 189.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps165_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.069297552108765
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.714 Vali Acc: 0.422 Test Loss: 0.714 Test Acc: 0.422
Validation loss decreased (inf --> -0.422215).  Saving model ...
Epoch: 2 cost time: 1.3179643154144287
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.707 Vali Acc: 0.528 Test Loss: 0.707 Test Acc: 0.528
Validation loss decreased (-0.422215 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.8325738906860352
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.722 Vali Acc: 0.489 Test Loss: 0.722 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7615790367126465
Epoch: 4, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.837 Vali Acc: 0.511 Test Loss: 0.837 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8780150413513184
Epoch: 5, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.724 Vali Acc: 0.528 Test Loss: 0.724 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7685790061950684
Epoch: 6, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.734 Vali Acc: 0.489 Test Loss: 0.734 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7857215404510498
Epoch: 7, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.948 Vali Acc: 0.506 Test Loss: 0.948 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6208035945892334
Epoch: 8, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.902 Vali Acc: 0.500 Test Loss: 0.902 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.930373191833496
Epoch: 9, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.989 Vali Acc: 0.533 Test Loss: 0.989 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 1.7315220832824707
Epoch: 10, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.922 Vali Acc: 0.522 Test Loss: 0.922 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6261358261108398
Epoch: 11, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.035 Vali Acc: 0.494 Test Loss: 1.035 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5509495735168457
Epoch: 12, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.039 Vali Acc: 0.511 Test Loss: 1.039 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5535600185394287
Epoch: 13, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.005 Vali Acc: 0.511 Test Loss: 1.005 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2027850151062012
Epoch: 14, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.578 Vali Acc: 0.500 Test Loss: 1.578 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9565694332122803
Epoch: 15, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.206 Vali Acc: 0.533 Test Loss: 1.206 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4160256385803223
Epoch: 16, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.537 Vali Acc: 0.539 Test Loss: 1.537 Test Acc: 0.539
Validation loss decreased (-0.533323 --> -0.538874).  Saving model ...
Epoch: 17 cost time: 1.427645206451416
Epoch: 17, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.202 Vali Acc: 0.517 Test Loss: 1.202 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4580349922180176
Epoch: 18, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.420 Vali Acc: 0.483 Test Loss: 1.420 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9597587585449219
Epoch: 19, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.661 Vali Acc: 0.528 Test Loss: 1.661 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5412793159484863
Epoch: 20, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.795 Vali Acc: 0.556 Test Loss: 1.795 Test Acc: 0.556
Validation loss decreased (-0.538874 --> -0.555538).  Saving model ...
Epoch: 21 cost time: 1.2137231826782227
Epoch: 21, Steps: 13 | Train Loss: 0.137 Vali Loss: 1.642 Vali Acc: 0.511 Test Loss: 1.642 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1452858448028564
Epoch: 22, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4864838123321533
Epoch: 23, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.628 Vali Acc: 0.517 Test Loss: 1.628 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8413922786712646
Epoch: 24, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.041 Vali Acc: 0.483 Test Loss: 2.041 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0785210132598877
Epoch: 25, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.834 Vali Acc: 0.478 Test Loss: 1.834 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6459035873413086
Epoch: 26, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.900 Vali Acc: 0.467 Test Loss: 1.900 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2984514236450195
Epoch: 27, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.948 Vali Acc: 0.506 Test Loss: 1.948 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4657361507415771
Epoch: 28, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.973 Vali Acc: 0.533 Test Loss: 1.973 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.535961627960205
Epoch: 29, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.971 Vali Acc: 0.517 Test Loss: 1.971 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3565495014190674
Epoch: 30, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.962 Vali Acc: 0.544 Test Loss: 1.962 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps165_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 46111490
model size : 190.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps165_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7290754318237305
Epoch: 1, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.692 Vali Acc: 0.522 Test Loss: 0.692 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.021399974822998
Epoch: 2, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.705 Vali Acc: 0.533 Test Loss: 0.705 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.4628183841705322
Epoch: 3, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.693 Vali Acc: 0.544 Test Loss: 0.693 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 1.2647557258605957
Epoch: 4, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.741 Vali Acc: 0.456 Test Loss: 0.741 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.239027976989746
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.736 Vali Acc: 0.550 Test Loss: 0.736 Test Acc: 0.550
Validation loss decreased (-0.544438 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.0070416927337646
Epoch: 6, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.758 Vali Acc: 0.506 Test Loss: 0.758 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4237499237060547
Epoch: 7, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.744 Vali Acc: 0.567 Test Loss: 0.744 Test Acc: 0.567
Validation loss decreased (-0.549993 --> -0.566659).  Saving model ...
Epoch: 8 cost time: 1.336522102355957
Epoch: 8, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4473075866699219
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.829 Vali Acc: 0.506 Test Loss: 0.829 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3440284729003906
Epoch: 10, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.795 Vali Acc: 0.506 Test Loss: 0.795 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0998709201812744
Epoch: 11, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.054 Vali Acc: 0.511 Test Loss: 1.054 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5197374820709229
Epoch: 12, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4903080463409424
Epoch: 13, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.087 Vali Acc: 0.511 Test Loss: 1.087 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1421599388122559
Epoch: 14, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.126 Vali Acc: 0.511 Test Loss: 1.126 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.387568473815918
Epoch: 15, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0449187755584717
Epoch: 16, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.207 Vali Acc: 0.506 Test Loss: 1.207 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.326871395111084
Epoch: 17, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.284 Vali Acc: 0.533 Test Loss: 1.284 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps165_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 46074626
model size : 190.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps165_str165_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2470295429229736
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.716 Vali Acc: 0.444 Test Loss: 0.716 Test Acc: 0.444
Validation loss decreased (inf --> -0.444437).  Saving model ...
Epoch: 2 cost time: 1.2235541343688965
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.719 Vali Acc: 0.506 Test Loss: 0.719 Test Acc: 0.506
Validation loss decreased (-0.444437 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.2624802589416504
Epoch: 3, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.724 Vali Acc: 0.489 Test Loss: 0.724 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2378928661346436
Epoch: 4, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.691 Vali Acc: 0.539 Test Loss: 0.691 Test Acc: 0.539
Validation loss decreased (-0.505548 --> -0.538882).  Saving model ...
Epoch: 5 cost time: 1.126183032989502
Epoch: 5, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.709 Vali Acc: 0.511 Test Loss: 0.709 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3360021114349365
Epoch: 6, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.719 Vali Acc: 0.500 Test Loss: 0.719 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2228045463562012
Epoch: 7, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1480324268341064
Epoch: 8, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.929 Vali Acc: 0.506 Test Loss: 0.929 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1956748962402344
Epoch: 9, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.931 Vali Acc: 0.522 Test Loss: 0.931 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0708608627319336
Epoch: 10, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.886 Vali Acc: 0.489 Test Loss: 0.886 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.057058572769165
Epoch: 11, Steps: 13 | Train Loss: 0.357 Vali Loss: 1.002 Vali Acc: 0.494 Test Loss: 1.002 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.07835054397583
Epoch: 12, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.969 Vali Acc: 0.472 Test Loss: 0.969 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9688539505004883
Epoch: 13, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.135 Vali Acc: 0.511 Test Loss: 1.135 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9718482494354248
Epoch: 14, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.999 Vali Acc: 0.517 Test Loss: 0.999 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps165_str165_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 46056194
model size : 190.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps192_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3003575801849365
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.726 Vali Acc: 0.539 Test Loss: 0.726 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.433499813079834
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2971851825714111
Epoch: 3, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.724 Vali Acc: 0.567 Test Loss: 0.724 Test Acc: 0.567
Validation loss decreased (-0.538882 --> -0.566659).  Saving model ...
Epoch: 4 cost time: 1.4033193588256836
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1204195022583008
Epoch: 5, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1098659038543701
Epoch: 6, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.793 Vali Acc: 0.494 Test Loss: 0.793 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7672195434570312
Epoch: 7, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.827 Vali Acc: 0.522 Test Loss: 0.827 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0685150623321533
Epoch: 8, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.798 Vali Acc: 0.500 Test Loss: 0.798 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.170964002609253
Epoch: 9, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.226 Vali Acc: 0.494 Test Loss: 1.226 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1810295581817627
Epoch: 10, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.896 Vali Acc: 0.489 Test Loss: 0.896 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9027338027954102
Epoch: 11, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.916 Vali Acc: 0.522 Test Loss: 0.916 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5042147636413574
Epoch: 12, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.426 Vali Acc: 0.500 Test Loss: 1.426 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8531970977783203
Epoch: 13, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.150 Vali Acc: 0.567 Test Loss: 1.150 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps192_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 46537730
model size : 192.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps192_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.484452962875366
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.697 Vali Acc: 0.489 Test Loss: 0.697 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.2942149639129639
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.714 Vali Acc: 0.472 Test Loss: 0.714 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1872961521148682
Epoch: 3, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.693 Vali Acc: 0.511 Test Loss: 0.693 Test Acc: 0.511
Validation loss decreased (-0.488882 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.4338023662567139
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.709 Vali Acc: 0.478 Test Loss: 0.709 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.029045581817627
Epoch: 5, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.749 Vali Acc: 0.494 Test Loss: 0.749 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3416790962219238
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.822 Vali Acc: 0.456 Test Loss: 0.822 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1840488910675049
Epoch: 7, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.779 Vali Acc: 0.528 Test Loss: 0.779 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527770).  Saving model ...
Epoch: 8 cost time: 1.3914358615875244
Epoch: 8, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.813 Vali Acc: 0.539 Test Loss: 0.813 Test Acc: 0.539
Validation loss decreased (-0.527770 --> -0.538881).  Saving model ...
Epoch: 9 cost time: 1.1401441097259521
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.153 Vali Acc: 0.539 Test Loss: 1.153 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.382673978805542
Epoch: 10, Steps: 13 | Train Loss: 0.476 Vali Loss: 1.037 Vali Acc: 0.472 Test Loss: 1.037 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2157964706420898
Epoch: 11, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.954 Vali Acc: 0.500 Test Loss: 0.954 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3357787132263184
Epoch: 12, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.042 Vali Acc: 0.506 Test Loss: 1.042 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2363290786743164
Epoch: 13, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.106 Vali Acc: 0.528 Test Loss: 1.106 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1706109046936035
Epoch: 14, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.166 Vali Acc: 0.494 Test Loss: 1.166 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8969986438751221
Epoch: 15, Steps: 13 | Train Loss: 0.236 Vali Loss: 1.207 Vali Acc: 0.528 Test Loss: 1.207 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0653250217437744
Epoch: 16, Steps: 13 | Train Loss: 0.150 Vali Loss: 1.329 Vali Acc: 0.506 Test Loss: 1.329 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1402204036712646
Epoch: 17, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.483 Vali Acc: 0.528 Test Loss: 1.483 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.93845534324646
Epoch: 18, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.284 Vali Acc: 0.522 Test Loss: 1.284 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps192_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 46507010
model size : 192.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps192_str192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.723818063735962
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1527447700500488
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.710 Vali Acc: 0.450 Test Loss: 0.710 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9204080104827881
Epoch: 3, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.693 Vali Acc: 0.517 Test Loss: 0.693 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.1679012775421143
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.711 Vali Acc: 0.494 Test Loss: 0.711 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0247697830200195
Epoch: 5, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.766 Vali Acc: 0.522 Test Loss: 0.766 Test Acc: 0.522
Validation loss decreased (-0.516660 --> -0.522215).  Saving model ...
Epoch: 6 cost time: 0.9691882133483887
Epoch: 6, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.785 Vali Acc: 0.483 Test Loss: 0.785 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0225963592529297
Epoch: 7, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.758 Vali Acc: 0.533 Test Loss: 0.758 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 8 cost time: 0.8837089538574219
Epoch: 8, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.883 Vali Acc: 0.528 Test Loss: 0.883 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9933898448944092
Epoch: 9, Steps: 13 | Train Loss: 0.489 Vali Loss: 1.126 Vali Acc: 0.517 Test Loss: 1.126 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.884878396987915
Epoch: 10, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.019 Vali Acc: 0.550 Test Loss: 1.019 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549990).  Saving model ...
Epoch: 11 cost time: 1.1207654476165771
Epoch: 11, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.906 Vali Acc: 0.511 Test Loss: 0.906 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9269027709960938
Epoch: 12, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.002 Vali Acc: 0.511 Test Loss: 1.002 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8730928897857666
Epoch: 13, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.059 Vali Acc: 0.556 Test Loss: 1.059 Test Acc: 0.556
Validation loss decreased (-0.549990 --> -0.555545).  Saving model ...
Epoch: 14 cost time: 0.8664937019348145
Epoch: 14, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.001 Vali Acc: 0.533 Test Loss: 1.001 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9788668155670166
Epoch: 15, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.088 Vali Acc: 0.567 Test Loss: 1.088 Test Acc: 0.567
Validation loss decreased (-0.555545 --> -0.566656).  Saving model ...
Epoch: 16 cost time: 0.9843044281005859
Epoch: 16, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.209 Vali Acc: 0.533 Test Loss: 1.209 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0922601222991943
Epoch: 17, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0672798156738281
Epoch: 18, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.252 Vali Acc: 0.506 Test Loss: 1.252 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9364745616912842
Epoch: 19, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.426 Vali Acc: 0.517 Test Loss: 1.426 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2812912464141846
Epoch: 20, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.460 Vali Acc: 0.467 Test Loss: 1.460 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1003620624542236
Epoch: 21, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.346 Vali Acc: 0.506 Test Loss: 1.346 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2150886058807373
Epoch: 22, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.523 Vali Acc: 0.533 Test Loss: 1.523 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9910497665405273
Epoch: 23, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9394540786743164
Epoch: 24, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.436 Vali Acc: 0.533 Test Loss: 1.436 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1059093475341797
Epoch: 25, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.714 Vali Acc: 0.494 Test Loss: 1.714 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps192_str192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 46491650
model size : 192.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.736983060836792
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.720 Vali Acc: 0.511 Test Loss: 0.720 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.5287604331970215
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.688 Vali Acc: 0.539 Test Loss: 0.688 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.256531000137329
Epoch: 3, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.734 Vali Acc: 0.511 Test Loss: 0.734 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2523279190063477
Epoch: 4, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.736 Vali Acc: 0.506 Test Loss: 0.736 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7251956462860107
Epoch: 5, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.794 Vali Acc: 0.456 Test Loss: 0.794 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.618088960647583
Epoch: 6, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.812 Vali Acc: 0.528 Test Loss: 0.812 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1689467430114746
Epoch: 7, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.867 Vali Acc: 0.511 Test Loss: 0.867 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6409623622894287
Epoch: 8, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.911 Vali Acc: 0.500 Test Loss: 0.911 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0439326763153076
Epoch: 9, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.026 Vali Acc: 0.511 Test Loss: 1.026 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.55741548538208
Epoch: 10, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.966 Vali Acc: 0.533 Test Loss: 0.966 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.179868459701538
Epoch: 11, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.931 Vali Acc: 0.517 Test Loss: 0.931 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.872560977935791
Epoch: 12, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.163 Vali Acc: 0.472 Test Loss: 1.163 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 47151362
model size : 194.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.77236008644104
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.692 Vali Acc: 0.522 Test Loss: 0.692 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.2355141639709473
Epoch: 2, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
Validation loss decreased (-0.522215 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.1627697944641113
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.712 Vali Acc: 0.494 Test Loss: 0.712 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2574913501739502
Epoch: 4, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.729 Vali Acc: 0.489 Test Loss: 0.729 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0849285125732422
Epoch: 5, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.752 Vali Acc: 0.461 Test Loss: 0.752 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3366341590881348
Epoch: 6, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.777 Vali Acc: 0.494 Test Loss: 0.777 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0899755954742432
Epoch: 7, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.807 Vali Acc: 0.528 Test Loss: 0.807 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.09855318069458
Epoch: 8, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.863 Vali Acc: 0.522 Test Loss: 0.863 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0651874542236328
Epoch: 9, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.884 Vali Acc: 0.544 Test Loss: 0.884 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.140763521194458
Epoch: 10, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.924 Vali Acc: 0.489 Test Loss: 0.924 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0662024021148682
Epoch: 11, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.996 Vali Acc: 0.517 Test Loss: 0.996 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8711514472961426
Epoch: 12, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.043 Vali Acc: 0.561 Test Loss: 1.043 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561101).  Saving model ...
Epoch: 13 cost time: 0.8607380390167236
Epoch: 13, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.009 Vali Acc: 0.528 Test Loss: 1.009 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8977196216583252
Epoch: 14, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.076 Vali Acc: 0.517 Test Loss: 1.076 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7957191467285156
Epoch: 15, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.300 Vali Acc: 0.483 Test Loss: 1.300 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0790932178497314
Epoch: 16, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.060 Vali Acc: 0.483 Test Loss: 1.060 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1998441219329834
Epoch: 17, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.230 Vali Acc: 0.494 Test Loss: 1.230 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9846348762512207
Epoch: 18, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.216 Vali Acc: 0.483 Test Loss: 1.216 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0038726329803467
Epoch: 19, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.264 Vali Acc: 0.511 Test Loss: 1.264 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8565442562103271
Epoch: 20, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.442 Vali Acc: 0.489 Test Loss: 1.442 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9708805084228516
Epoch: 21, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.379 Vali Acc: 0.528 Test Loss: 1.379 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0851593017578125
Epoch: 22, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.631 Vali Acc: 0.478 Test Loss: 1.631 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 47126786
model size : 194.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9462852478027344
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.686 Vali Acc: 0.550 Test Loss: 0.686 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.0664000511169434
Epoch: 2, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.691 Vali Acc: 0.578 Test Loss: 0.691 Test Acc: 0.578
Validation loss decreased (-0.549993 --> -0.577771).  Saving model ...
Epoch: 3 cost time: 1.0314075946807861
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.706 Vali Acc: 0.533 Test Loss: 0.706 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2274134159088135
Epoch: 4, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.726 Vali Acc: 0.533 Test Loss: 0.726 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.028019666671753
Epoch: 5, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.755 Vali Acc: 0.489 Test Loss: 0.755 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9393413066864014
Epoch: 6, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.810 Vali Acc: 0.511 Test Loss: 0.810 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0237846374511719
Epoch: 7, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.833 Vali Acc: 0.489 Test Loss: 0.833 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1947336196899414
Epoch: 8, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.899 Vali Acc: 0.511 Test Loss: 0.899 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1747872829437256
Epoch: 9, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.046 Vali Acc: 0.461 Test Loss: 1.046 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9027092456817627
Epoch: 10, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.944 Vali Acc: 0.506 Test Loss: 0.944 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8625056743621826
Epoch: 11, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.160 Vali Acc: 0.483 Test Loss: 1.160 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1943655014038086
Epoch: 12, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.038 Vali Acc: 0.517 Test Loss: 1.038 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el6_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 47114498
model size : 194.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps47_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4514636993408203
Epoch: 1, Steps: 13 | Train Loss: 0.803 Vali Loss: 0.716 Vali Acc: 0.489 Test Loss: 0.716 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 2.222439765930176
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.694 Vali Acc: 0.578 Test Loss: 0.694 Test Acc: 0.578
Validation loss decreased (-0.488882 --> -0.577771).  Saving model ...
Epoch: 3 cost time: 2.260361433029175
Epoch: 3, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.767 Vali Acc: 0.506 Test Loss: 0.767 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3751888275146484
Epoch: 4, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.722 Vali Acc: 0.506 Test Loss: 0.722 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1804726123809814
Epoch: 5, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.995 Vali Acc: 0.511 Test Loss: 0.995 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.401660203933716
Epoch: 6, Steps: 13 | Train Loss: 0.944 Vali Loss: 0.883 Vali Acc: 0.506 Test Loss: 0.883 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9427099227905273
Epoch: 7, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.862 Vali Acc: 0.472 Test Loss: 0.862 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.003596305847168
Epoch: 8, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.878 Vali Acc: 0.539 Test Loss: 0.878 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7813527584075928
Epoch: 9, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.796 Vali Acc: 0.522 Test Loss: 0.796 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7014846801757812
Epoch: 10, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.894 Vali Acc: 0.494 Test Loss: 0.894 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.285876989364624
Epoch: 11, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.234 Vali Acc: 0.533 Test Loss: 1.234 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5547053813934326
Epoch: 12, Steps: 13 | Train Loss: 0.769 Vali Loss: 1.141 Vali Acc: 0.539 Test Loss: 1.141 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps47_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 37332482
model size : 157.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps47_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8472859859466553
Epoch: 1, Steps: 13 | Train Loss: 0.791 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.934964895248413
Epoch: 2, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.831 Vali Acc: 0.500 Test Loss: 0.831 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6109814643859863
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.7667689323425293
Epoch: 4, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.698 Vali Acc: 0.517 Test Loss: 0.698 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 5 cost time: 1.7005186080932617
Epoch: 5, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.681 Vali Acc: 0.578 Test Loss: 0.681 Test Acc: 0.578
Validation loss decreased (-0.516660 --> -0.577771).  Saving model ...
Epoch: 6 cost time: 1.703244924545288
Epoch: 6, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.771 Vali Acc: 0.494 Test Loss: 0.771 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3421094417572021
Epoch: 7, Steps: 13 | Train Loss: 0.540 Vali Loss: 1.089 Vali Acc: 0.456 Test Loss: 1.089 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4956841468811035
Epoch: 8, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.884 Vali Acc: 0.544 Test Loss: 0.884 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8058485984802246
Epoch: 9, Steps: 13 | Train Loss: 0.621 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6074965000152588
Epoch: 10, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5783991813659668
Epoch: 11, Steps: 13 | Train Loss: 0.477 Vali Loss: 1.032 Vali Acc: 0.506 Test Loss: 1.032 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2018513679504395
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.233 Vali Acc: 0.533 Test Loss: 1.233 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.612565279006958
Epoch: 13, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.181 Vali Acc: 0.572 Test Loss: 1.181 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.013357162475586
Epoch: 14, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.533 Vali Acc: 0.544 Test Loss: 1.533 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1714885234832764
Epoch: 15, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.333 Vali Acc: 0.550 Test Loss: 1.333 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps47_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 37191170
model size : 156.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps47_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.105903148651123
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.695 Vali Acc: 0.517 Test Loss: 0.695 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.5624449253082275
Epoch: 2, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.696 Vali Acc: 0.489 Test Loss: 0.696 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.556098222732544
Epoch: 3, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.707 Vali Acc: 0.511 Test Loss: 0.707 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.554694414138794
Epoch: 4, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.696 Vali Acc: 0.561 Test Loss: 0.696 Test Acc: 0.561
Validation loss decreased (-0.516660 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 1.716740608215332
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.696 Vali Acc: 0.522 Test Loss: 0.696 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3860900402069092
Epoch: 6, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.723 Vali Acc: 0.500 Test Loss: 0.723 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4558563232421875
Epoch: 7, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.781 Vali Acc: 0.528 Test Loss: 0.781 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2546319961547852
Epoch: 8, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.907 Vali Acc: 0.511 Test Loss: 0.907 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2802834510803223
Epoch: 9, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.891 Vali Acc: 0.539 Test Loss: 0.891 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2801728248596191
Epoch: 10, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.927 Vali Acc: 0.511 Test Loss: 0.927 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1588046550750732
Epoch: 11, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.940 Vali Acc: 0.550 Test Loss: 0.940 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1477439403533936
Epoch: 12, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.059 Vali Acc: 0.494 Test Loss: 1.059 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2539527416229248
Epoch: 13, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1131963729858398
Epoch: 14, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.122 Vali Acc: 0.506 Test Loss: 1.122 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps47_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 37120514
model size : 156.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5530388355255127
Epoch: 1, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.688 Vali Acc: 0.550 Test Loss: 0.688 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.3497180938720703
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.797 Vali Acc: 0.500 Test Loss: 0.797 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6513326168060303
Epoch: 3, Steps: 13 | Train Loss: 0.746 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1695988178253174
Epoch: 4, Steps: 13 | Train Loss: 0.841 Vali Loss: 0.769 Vali Acc: 0.528 Test Loss: 0.769 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.192655563354492
Epoch: 5, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.840 Vali Acc: 0.494 Test Loss: 0.840 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8822929859161377
Epoch: 6, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.841 Vali Acc: 0.494 Test Loss: 0.841 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.123974323272705
Epoch: 7, Steps: 13 | Train Loss: 0.685 Vali Loss: 1.001 Vali Acc: 0.494 Test Loss: 1.001 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9088311195373535
Epoch: 8, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.697 Vali Acc: 0.456 Test Loss: 1.697 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1813600063323975
Epoch: 9, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.854 Vali Acc: 0.544 Test Loss: 0.854 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.543571949005127
Epoch: 10, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.894 Vali Acc: 0.533 Test Loss: 0.894 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.947566032409668
Epoch: 11, Steps: 13 | Train Loss: 0.509 Vali Loss: 1.084 Vali Acc: 0.511 Test Loss: 1.084 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 37348610
model size : 157.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1242294311523438
Epoch: 1, Steps: 13 | Train Loss: 0.849 Vali Loss: 0.820 Vali Acc: 0.506 Test Loss: 0.820 Test Acc: 0.506
Validation loss decreased (inf --> -0.505547).  Saving model ...
Epoch: 2 cost time: 1.2147438526153564
Epoch: 2, Steps: 13 | Train Loss: 0.823 Vali Loss: 0.854 Vali Acc: 0.500 Test Loss: 0.854 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0805456638336182
Epoch: 3, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4440476894378662
Epoch: 4, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.709 Vali Acc: 0.583 Test Loss: 0.709 Test Acc: 0.583
Validation loss decreased (-0.505547 --> -0.583326).  Saving model ...
Epoch: 5 cost time: 1.294205665588379
Epoch: 5, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.732 Vali Acc: 0.483 Test Loss: 0.732 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.157994270324707
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.749 Vali Acc: 0.494 Test Loss: 0.749 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4344136714935303
Epoch: 7, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.845 Vali Acc: 0.494 Test Loss: 0.845 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0453100204467773
Epoch: 8, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.867 Vali Acc: 0.500 Test Loss: 0.867 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6360063552856445
Epoch: 9, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.783 Vali Acc: 0.544 Test Loss: 0.783 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8098011016845703
Epoch: 10, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.850 Vali Acc: 0.528 Test Loss: 0.850 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1450116634368896
Epoch: 11, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.025 Vali Acc: 0.506 Test Loss: 1.025 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.725722074508667
Epoch: 12, Steps: 13 | Train Loss: 0.568 Vali Loss: 1.126 Vali Acc: 0.456 Test Loss: 1.126 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0473999977111816
Epoch: 13, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.482 Vali Acc: 0.483 Test Loss: 1.482 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.691110610961914
Epoch: 14, Steps: 13 | Train Loss: 0.484 Vali Loss: 1.033 Vali Acc: 0.506 Test Loss: 1.033 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 37207298
model size : 156.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.781846284866333
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 0.9415771961212158
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.706 Vali Acc: 0.494 Test Loss: 0.706 Test Acc: 0.494
Validation loss decreased (-0.449993 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.0430371761322021
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.690 Vali Acc: 0.500 Test Loss: 0.690 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 0.9807631969451904
Epoch: 4, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.770 Vali Acc: 0.533 Test Loss: 0.770 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 0.9521934986114502
Epoch: 5, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.907 Vali Acc: 0.494 Test Loss: 0.907 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8089759349822998
Epoch: 6, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.836 Vali Acc: 0.528 Test Loss: 0.836 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9425168037414551
Epoch: 7, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.757 Vali Acc: 0.517 Test Loss: 0.757 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0685718059539795
Epoch: 8, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.842 Vali Acc: 0.522 Test Loss: 0.842 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2086296081542969
Epoch: 9, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.814 Vali Acc: 0.467 Test Loss: 0.814 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0624771118164062
Epoch: 10, Steps: 13 | Train Loss: 0.557 Vali Loss: 1.137 Vali Acc: 0.517 Test Loss: 1.137 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2423954010009766
Epoch: 11, Steps: 13 | Train Loss: 0.540 Vali Loss: 1.055 Vali Acc: 0.478 Test Loss: 1.055 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9484593868255615
Epoch: 12, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.918 Vali Acc: 0.467 Test Loss: 0.918 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9891359806060791
Epoch: 13, Steps: 13 | Train Loss: 0.443 Vali Loss: 1.058 Vali Acc: 0.472 Test Loss: 1.058 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2654263973236084
Epoch: 14, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 37136642
model size : 156.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1292972564697266
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.056163787841797
Epoch: 2, Steps: 13 | Train Loss: 0.790 Vali Loss: 0.801 Vali Acc: 0.517 Test Loss: 0.801 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.6743347644805908
Epoch: 3, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.688 Vali Acc: 0.544 Test Loss: 0.688 Test Acc: 0.544
Validation loss decreased (-0.516659 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 1.5267765522003174
Epoch: 4, Steps: 13 | Train Loss: 0.846 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.583076000213623
Epoch: 5, Steps: 13 | Train Loss: 0.797 Vali Loss: 0.895 Vali Acc: 0.500 Test Loss: 0.895 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0226752758026123
Epoch: 6, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.785 Vali Acc: 0.506 Test Loss: 0.785 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.321526050567627
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.788 Vali Acc: 0.506 Test Loss: 0.788 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9138374328613281
Epoch: 8, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.997 Vali Acc: 0.500 Test Loss: 0.997 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0160579681396484
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 1.074 Vali Acc: 0.517 Test Loss: 1.074 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0106630325317383
Epoch: 10, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.219 Vali Acc: 0.533 Test Loss: 1.219 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7361352443695068
Epoch: 11, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1390109062194824
Epoch: 12, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.385 Vali Acc: 0.472 Test Loss: 1.385 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.090751886367798
Epoch: 13, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.398 Vali Acc: 0.500 Test Loss: 1.398 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 37372418
model size : 157.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.123778820037842
Epoch: 1, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.5999751091003418
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.688 Vali Acc: 0.567 Test Loss: 0.688 Test Acc: 0.567
Validation loss decreased (-0.499992 --> -0.566660).  Saving model ...
Epoch: 3 cost time: 1.766322374343872
Epoch: 3, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.742 Vali Acc: 0.511 Test Loss: 0.742 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5850770473480225
Epoch: 4, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.750 Vali Acc: 0.517 Test Loss: 0.750 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4797427654266357
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.769 Vali Acc: 0.511 Test Loss: 0.769 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.992645502090454
Epoch: 6, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.955 Vali Acc: 0.511 Test Loss: 0.955 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7281506061553955
Epoch: 7, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.802 Vali Acc: 0.522 Test Loss: 0.802 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2695937156677246
Epoch: 8, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.756 Vali Acc: 0.539 Test Loss: 0.756 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6838674545288086
Epoch: 9, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.869 Vali Acc: 0.461 Test Loss: 0.869 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.535552978515625
Epoch: 10, Steps: 13 | Train Loss: 0.484 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7657268047332764
Epoch: 11, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.173 Vali Acc: 0.550 Test Loss: 1.173 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.820613145828247
Epoch: 12, Steps: 13 | Train Loss: 0.489 Vali Loss: 1.481 Vali Acc: 0.556 Test Loss: 1.481 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 37243394
model size : 156.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.020221710205078
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.728 Vali Acc: 0.494 Test Loss: 0.728 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.715357780456543
Epoch: 2, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.718 Vali Acc: 0.467 Test Loss: 0.718 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0301077365875244
Epoch: 3, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.737 Vali Acc: 0.506 Test Loss: 0.737 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505548).  Saving model ...
Epoch: 4 cost time: 1.3164303302764893
Epoch: 4, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.822 Vali Acc: 0.511 Test Loss: 0.822 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511103).  Saving model ...
Epoch: 5 cost time: 1.2483835220336914
Epoch: 5, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.745 Vali Acc: 0.461 Test Loss: 0.745 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7726707458496094
Epoch: 6, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.755 Vali Acc: 0.494 Test Loss: 0.755 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3891656398773193
Epoch: 7, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.813 Vali Acc: 0.483 Test Loss: 0.813 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.690288782119751
Epoch: 8, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.951 Vali Acc: 0.522 Test Loss: 0.951 Test Acc: 0.522
Validation loss decreased (-0.511103 --> -0.522213).  Saving model ...
Epoch: 9 cost time: 1.5503482818603516
Epoch: 9, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.858 Vali Acc: 0.550 Test Loss: 0.858 Test Acc: 0.550
Validation loss decreased (-0.522213 --> -0.549991).  Saving model ...
Epoch: 10 cost time: 1.8417587280273438
Epoch: 10, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.890 Vali Acc: 0.489 Test Loss: 0.890 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4647343158721924
Epoch: 11, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.834 Vali Acc: 0.517 Test Loss: 0.834 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3002541065216064
Epoch: 12, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7384006977081299
Epoch: 13, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2325341701507568
Epoch: 14, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.976 Vali Acc: 0.517 Test Loss: 0.976 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5357897281646729
Epoch: 15, Steps: 13 | Train Loss: 0.334 Vali Loss: 1.102 Vali Acc: 0.478 Test Loss: 1.102 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1665878295898438
Epoch: 16, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.274 Vali Acc: 0.522 Test Loss: 1.274 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.96907639503479
Epoch: 17, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.287 Vali Acc: 0.522 Test Loss: 1.287 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0376675128936768
Epoch: 18, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.335 Vali Acc: 0.511 Test Loss: 1.335 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3303754329681396
Epoch: 19, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.537 Vali Acc: 0.506 Test Loss: 1.537 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 37178882
model size : 156.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4927752017974854
Epoch: 1, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.3528947830200195
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.775 Vali Acc: 0.494 Test Loss: 0.775 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6813654899597168
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.781 Vali Acc: 0.533 Test Loss: 0.781 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0713274478912354
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.784 Vali Acc: 0.522 Test Loss: 0.784 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3098762035369873
Epoch: 5, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.841 Vali Acc: 0.489 Test Loss: 0.841 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8378393650054932
Epoch: 6, Steps: 13 | Train Loss: 0.645 Vali Loss: 1.548 Vali Acc: 0.500 Test Loss: 1.548 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8859736919403076
Epoch: 7, Steps: 13 | Train Loss: 0.846 Vali Loss: 1.059 Vali Acc: 0.511 Test Loss: 1.059 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.039767265319824
Epoch: 8, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.872 Vali Acc: 0.494 Test Loss: 0.872 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.971221923828125
Epoch: 9, Steps: 13 | Train Loss: 0.569 Vali Loss: 1.211 Vali Acc: 0.494 Test Loss: 1.211 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1450581550598145
Epoch: 10, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.943 Vali Acc: 0.461 Test Loss: 0.943 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4145097732543945
Epoch: 11, Steps: 13 | Train Loss: 0.452 Vali Loss: 1.094 Vali Acc: 0.511 Test Loss: 1.094 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 37386242
model size : 157.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4747092723846436
Epoch: 1, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.509791612625122
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.715 Vali Acc: 0.456 Test Loss: 0.715 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9133992195129395
Epoch: 3, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.752 Vali Acc: 0.517 Test Loss: 0.752 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.8244271278381348
Epoch: 4, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.818 Vali Acc: 0.517 Test Loss: 0.818 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2953393459320068
Epoch: 5, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.706 Vali Acc: 0.511 Test Loss: 0.706 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.462451457977295
Epoch: 6, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3960340023040771
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.702 Vali Acc: 0.594 Test Loss: 0.702 Test Acc: 0.594
Validation loss decreased (-0.516659 --> -0.594437).  Saving model ...
Epoch: 8 cost time: 1.3946568965911865
Epoch: 8, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.727 Vali Acc: 0.589 Test Loss: 0.727 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2653706073760986
Epoch: 9, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.865 Vali Acc: 0.506 Test Loss: 0.865 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0973517894744873
Epoch: 10, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.901 Vali Acc: 0.533 Test Loss: 0.901 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0917553901672363
Epoch: 11, Steps: 13 | Train Loss: 0.716 Vali Loss: 1.082 Vali Acc: 0.494 Test Loss: 1.082 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6168296337127686
Epoch: 12, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.880 Vali Acc: 0.506 Test Loss: 0.880 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1812710762023926
Epoch: 13, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.067 Vali Acc: 0.533 Test Loss: 1.067 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6770274639129639
Epoch: 14, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.372 Vali Acc: 0.472 Test Loss: 1.372 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2012341022491455
Epoch: 15, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.528 Vali Acc: 0.456 Test Loss: 1.528 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.193098545074463
Epoch: 16, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.614 Vali Acc: 0.467 Test Loss: 1.614 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.097477912902832
Epoch: 17, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.618 Vali Acc: 0.500 Test Loss: 1.618 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5944444444444444
model parameter : 37269506
model size : 156.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.292307138442993
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.726 Vali Acc: 0.444 Test Loss: 0.726 Test Acc: 0.444
Validation loss decreased (inf --> -0.444437).  Saving model ...
Epoch: 2 cost time: 1.4204354286193848
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.716 Vali Acc: 0.456 Test Loss: 0.716 Test Acc: 0.456
Validation loss decreased (-0.444437 --> -0.455548).  Saving model ...
Epoch: 3 cost time: 1.0706117153167725
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.753 Vali Acc: 0.528 Test Loss: 0.753 Test Acc: 0.528
Validation loss decreased (-0.455548 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 1.4227068424224854
Epoch: 4, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.748 Vali Acc: 0.478 Test Loss: 0.748 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1072289943695068
Epoch: 5, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.722 Vali Acc: 0.517 Test Loss: 0.722 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5654711723327637
Epoch: 6, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.708 Vali Acc: 0.567 Test Loss: 0.708 Test Acc: 0.567
Validation loss decreased (-0.527770 --> -0.566660).  Saving model ...
Epoch: 7 cost time: 1.220592737197876
Epoch: 7, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.866 Vali Acc: 0.450 Test Loss: 0.866 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.460221767425537
Epoch: 8, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.807 Vali Acc: 0.533 Test Loss: 0.807 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9164865016937256
Epoch: 9, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.777 Vali Acc: 0.461 Test Loss: 0.777 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5236883163452148
Epoch: 10, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.871 Vali Acc: 0.528 Test Loss: 0.871 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1149275302886963
Epoch: 11, Steps: 13 | Train Loss: 0.624 Vali Loss: 1.242 Vali Acc: 0.461 Test Loss: 1.242 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6575374603271484
Epoch: 12, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.915 Vali Acc: 0.506 Test Loss: 0.915 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3277394771575928
Epoch: 13, Steps: 13 | Train Loss: 0.483 Vali Loss: 1.019 Vali Acc: 0.489 Test Loss: 1.019 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.675462007522583
Epoch: 14, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.047 Vali Acc: 0.450 Test Loss: 1.047 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0790138244628906
Epoch: 15, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.221 Vali Acc: 0.511 Test Loss: 1.221 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3818738460540771
Epoch: 16, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.111 Vali Acc: 0.539 Test Loss: 1.111 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 37208066
model size : 156.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.126119613647461
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.749 Vali Acc: 0.506 Test Loss: 0.749 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.4903185367584229
Epoch: 2, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.825 Vali Acc: 0.511 Test Loss: 0.825 Test Acc: 0.511
Validation loss decreased (-0.505548 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 1.9071502685546875
Epoch: 3, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.801 Vali Acc: 0.472 Test Loss: 0.801 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5098118782043457
Epoch: 4, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.910 Vali Acc: 0.511 Test Loss: 0.910 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5552752017974854
Epoch: 5, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.785 Vali Acc: 0.461 Test Loss: 0.785 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.461925745010376
Epoch: 6, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.874 Vali Acc: 0.494 Test Loss: 0.874 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8848252296447754
Epoch: 7, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.822 Vali Acc: 0.517 Test Loss: 0.822 Test Acc: 0.517
Validation loss decreased (-0.511103 --> -0.516658).  Saving model ...
Epoch: 8 cost time: 1.417529821395874
Epoch: 8, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.806 Vali Acc: 0.506 Test Loss: 0.806 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1353087425231934
Epoch: 9, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1270647048950195
Epoch: 10, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.104 Vali Acc: 0.528 Test Loss: 1.104 Test Acc: 0.528
Validation loss decreased (-0.516658 --> -0.527767).  Saving model ...
Epoch: 11 cost time: 1.7869367599487305
Epoch: 11, Steps: 13 | Train Loss: 0.654 Vali Loss: 1.169 Vali Acc: 0.522 Test Loss: 1.169 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7033307552337646
Epoch: 12, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.269 Vali Acc: 0.489 Test Loss: 1.269 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.095745801925659
Epoch: 13, Steps: 13 | Train Loss: 0.460 Vali Loss: 1.309 Vali Acc: 0.500 Test Loss: 1.309 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.606091022491455
Epoch: 14, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.231 Vali Acc: 0.533 Test Loss: 1.231 Test Acc: 0.533
Validation loss decreased (-0.527767 --> -0.533321).  Saving model ...
Epoch: 15 cost time: 2.1998555660247803
Epoch: 15, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.392 Vali Acc: 0.528 Test Loss: 1.392 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.124373435974121
Epoch: 16, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.592 Vali Acc: 0.506 Test Loss: 1.592 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7011778354644775
Epoch: 17, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.783 Vali Acc: 0.500 Test Loss: 1.783 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4168970584869385
Epoch: 18, Steps: 13 | Train Loss: 0.174 Vali Loss: 2.041 Vali Acc: 0.478 Test Loss: 2.041 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2403953075408936
Epoch: 19, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.974 Vali Acc: 0.517 Test Loss: 1.974 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9545600414276123
Epoch: 20, Steps: 13 | Train Loss: 0.252 Vali Loss: 2.395 Vali Acc: 0.483 Test Loss: 2.395 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.976050853729248
Epoch: 21, Steps: 13 | Train Loss: 0.265 Vali Loss: 2.387 Vali Acc: 0.522 Test Loss: 2.387 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.208752393722534
Epoch: 22, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.672 Vali Acc: 0.506 Test Loss: 2.672 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9449560642242432
Epoch: 23, Steps: 13 | Train Loss: 0.082 Vali Loss: 3.475 Vali Acc: 0.506 Test Loss: 3.475 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8862364292144775
Epoch: 24, Steps: 13 | Train Loss: 0.213 Vali Loss: 2.826 Vali Acc: 0.500 Test Loss: 2.826 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 37418498
model size : 157.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9470632076263428
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.813 Vali Acc: 0.494 Test Loss: 0.813 Test Acc: 0.494
Validation loss decreased (inf --> -0.494436).  Saving model ...
Epoch: 2 cost time: 1.3038365840911865
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.725 Vali Acc: 0.528 Test Loss: 0.725 Test Acc: 0.528
Validation loss decreased (-0.494436 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.1259431838989258
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.711 Vali Acc: 0.517 Test Loss: 0.711 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6011261940002441
Epoch: 4, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9689085483551025
Epoch: 5, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.709 Vali Acc: 0.517 Test Loss: 0.709 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6912455558776855
Epoch: 6, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.846 Vali Acc: 0.456 Test Loss: 0.846 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4714162349700928
Epoch: 7, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.924 Vali Acc: 0.511 Test Loss: 0.924 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4760158061981201
Epoch: 8, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.992 Vali Acc: 0.528 Test Loss: 0.992 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7587323188781738
Epoch: 9, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.992 Vali Acc: 0.489 Test Loss: 0.992 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.372920274734497
Epoch: 10, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.969 Vali Acc: 0.522 Test Loss: 0.969 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5793001651763916
Epoch: 11, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.073 Vali Acc: 0.578 Test Loss: 1.073 Test Acc: 0.578
Validation loss decreased (-0.527771 --> -0.577767).  Saving model ...
Epoch: 12 cost time: 1.840928316116333
Epoch: 12, Steps: 13 | Train Loss: 0.579 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2964441776275635
Epoch: 13, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.242 Vali Acc: 0.539 Test Loss: 1.242 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5228972434997559
Epoch: 14, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.967 Vali Acc: 0.500 Test Loss: 1.967 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1301164627075195
Epoch: 15, Steps: 13 | Train Loss: 0.458 Vali Loss: 1.310 Vali Acc: 0.467 Test Loss: 1.310 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1945147514343262
Epoch: 16, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.357 Vali Acc: 0.522 Test Loss: 1.357 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5247011184692383
Epoch: 17, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.603 Vali Acc: 0.489 Test Loss: 1.603 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2033729553222656
Epoch: 18, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.667 Vali Acc: 0.511 Test Loss: 1.667 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2918953895568848
Epoch: 19, Steps: 13 | Train Loss: 0.196 Vali Loss: 2.112 Vali Acc: 0.433 Test Loss: 2.112 Test Acc: 0.433
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4204602241516113
Epoch: 20, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.558 Vali Acc: 0.533 Test Loss: 1.558 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4058053493499756
Epoch: 21, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.907 Vali Acc: 0.539 Test Loss: 1.907 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 37298690
model size : 156.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.668325424194336
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.739 Vali Acc: 0.494 Test Loss: 0.739 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.0671513080596924
Epoch: 2, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.743 Vali Acc: 0.467 Test Loss: 0.743 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4043025970458984
Epoch: 3, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.721 Vali Acc: 0.494 Test Loss: 0.721 Test Acc: 0.494
Validation loss decreased (-0.494437 --> -0.494437).  Saving model ...
Epoch: 4 cost time: 1.16025710105896
Epoch: 4, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.744 Vali Acc: 0.461 Test Loss: 0.744 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7189633846282959
Epoch: 5, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.846 Vali Acc: 0.500 Test Loss: 0.846 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499992).  Saving model ...
Epoch: 6 cost time: 1.3008651733398438
Epoch: 6, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.726 Vali Acc: 0.539 Test Loss: 0.726 Test Acc: 0.539
Validation loss decreased (-0.499992 --> -0.538882).  Saving model ...
Epoch: 7 cost time: 0.9834709167480469
Epoch: 7, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.799 Vali Acc: 0.517 Test Loss: 0.799 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2908873558044434
Epoch: 8, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.780 Vali Acc: 0.506 Test Loss: 0.780 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1645886898040771
Epoch: 9, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.890 Vali Acc: 0.506 Test Loss: 0.890 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0433037281036377
Epoch: 10, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.916 Vali Acc: 0.494 Test Loss: 0.916 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9167053699493408
Epoch: 11, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.009 Vali Acc: 0.517 Test Loss: 1.009 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.397860050201416
Epoch: 12, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.949 Vali Acc: 0.478 Test Loss: 0.949 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9419219493865967
Epoch: 13, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.002 Vali Acc: 0.483 Test Loss: 1.002 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2070834636688232
Epoch: 14, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.187 Vali Acc: 0.511 Test Loss: 1.187 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9670939445495605
Epoch: 15, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.240 Vali Acc: 0.483 Test Loss: 1.240 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.158787488937378
Epoch: 16, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.694 Vali Acc: 0.494 Test Loss: 1.694 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 37237250
model size : 156.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.876297950744629
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.5366246700286865
Epoch: 2, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.728 Vali Acc: 0.517 Test Loss: 0.728 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 1.4451851844787598
Epoch: 3, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.736 Vali Acc: 0.533 Test Loss: 0.736 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 2.036375045776367
Epoch: 4, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.859 Vali Acc: 0.533 Test Loss: 0.859 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7547454833984375
Epoch: 5, Steps: 13 | Train Loss: 0.747 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6443657875061035
Epoch: 6, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.890 Vali Acc: 0.494 Test Loss: 0.890 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5841255187988281
Epoch: 7, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.803 Vali Acc: 0.550 Test Loss: 0.803 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 1.6779699325561523
Epoch: 8, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.912 Vali Acc: 0.539 Test Loss: 0.912 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7642080783843994
Epoch: 9, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.887 Vali Acc: 0.517 Test Loss: 0.887 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1242337226867676
Epoch: 10, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.009 Vali Acc: 0.500 Test Loss: 1.009 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4365899562835693
Epoch: 11, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.059 Vali Acc: 0.483 Test Loss: 1.059 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4049968719482422
Epoch: 12, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.285 Vali Acc: 0.494 Test Loss: 1.285 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5649635791778564
Epoch: 13, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.703 Vali Acc: 0.461 Test Loss: 1.703 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9064340591430664
Epoch: 14, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.621 Vali Acc: 0.478 Test Loss: 1.621 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6433792114257812
Epoch: 15, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.575 Vali Acc: 0.494 Test Loss: 1.575 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6696577072143555
Epoch: 16, Steps: 13 | Train Loss: 0.247 Vali Loss: 2.309 Vali Acc: 0.478 Test Loss: 2.309 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3320982456207275
Epoch: 17, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.578 Vali Acc: 0.556 Test Loss: 1.578 Test Acc: 0.556
Validation loss decreased (-0.549992 --> -0.555540).  Saving model ...
Epoch: 18 cost time: 2.1384856700897217
Epoch: 18, Steps: 13 | Train Loss: 0.183 Vali Loss: 2.715 Vali Acc: 0.506 Test Loss: 2.715 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9399216175079346
Epoch: 19, Steps: 13 | Train Loss: 0.328 Vali Loss: 2.776 Vali Acc: 0.533 Test Loss: 2.776 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7771813869476318
Epoch: 20, Steps: 13 | Train Loss: 0.272 Vali Loss: 2.732 Vali Acc: 0.506 Test Loss: 2.732 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5946979522705078
Epoch: 21, Steps: 13 | Train Loss: 0.116 Vali Loss: 2.672 Vali Acc: 0.517 Test Loss: 2.672 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.474510669708252
Epoch: 22, Steps: 13 | Train Loss: 0.325 Vali Loss: 3.141 Vali Acc: 0.533 Test Loss: 3.141 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9421055316925049
Epoch: 23, Steps: 13 | Train Loss: 0.113 Vali Loss: 3.273 Vali Acc: 0.533 Test Loss: 3.273 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5068464279174805
Epoch: 24, Steps: 13 | Train Loss: 0.051 Vali Loss: 3.181 Vali Acc: 0.528 Test Loss: 3.181 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6043095588684082
Epoch: 25, Steps: 13 | Train Loss: 0.100 Vali Loss: 3.146 Vali Acc: 0.517 Test Loss: 3.146 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4912290573120117
Epoch: 26, Steps: 13 | Train Loss: 0.095 Vali Loss: 3.896 Vali Acc: 0.539 Test Loss: 3.896 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2963731288909912
Epoch: 27, Steps: 13 | Train Loss: 0.091 Vali Loss: 3.668 Vali Acc: 0.522 Test Loss: 3.668 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 37448450
model size : 157.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4681434631347656
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.771691083908081
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.716 Vali Acc: 0.483 Test Loss: 0.716 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.867882490158081
Epoch: 3, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.720 Vali Acc: 0.539 Test Loss: 0.720 Test Acc: 0.539
Validation loss decreased (-0.499993 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.1297683715820312
Epoch: 4, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.875 Vali Acc: 0.494 Test Loss: 0.875 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0653443336486816
Epoch: 5, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.736 Vali Acc: 0.522 Test Loss: 0.736 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9842350482940674
Epoch: 6, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.817 Vali Acc: 0.522 Test Loss: 0.817 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4788236618041992
Epoch: 7, Steps: 13 | Train Loss: 0.627 Vali Loss: 1.133 Vali Acc: 0.506 Test Loss: 1.133 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9430577754974365
Epoch: 8, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.847 Vali Acc: 0.533 Test Loss: 0.847 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4813759326934814
Epoch: 9, Steps: 13 | Train Loss: 0.635 Vali Loss: 1.026 Vali Acc: 0.467 Test Loss: 1.026 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.014482259750366
Epoch: 10, Steps: 13 | Train Loss: 0.553 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6558384895324707
Epoch: 11, Steps: 13 | Train Loss: 0.509 Vali Loss: 1.037 Vali Acc: 0.517 Test Loss: 1.037 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0275626182556152
Epoch: 12, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.061 Vali Acc: 0.483 Test Loss: 1.061 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4045376777648926
Epoch: 13, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.531 Vali Acc: 0.528 Test Loss: 1.531 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 37340930
model size : 157.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.634406328201294
Epoch: 1, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.709 Vali Acc: 0.478 Test Loss: 0.709 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 0.8352756500244141
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.727 Vali Acc: 0.517 Test Loss: 0.727 Test Acc: 0.517
Validation loss decreased (-0.477771 --> -0.516659).  Saving model ...
Epoch: 3 cost time: 0.9089109897613525
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.700 Vali Acc: 0.506 Test Loss: 0.700 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7917587757110596
Epoch: 4, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.703 Vali Acc: 0.533 Test Loss: 0.703 Test Acc: 0.533
Validation loss decreased (-0.516659 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 0.7630264759063721
Epoch: 5, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.705 Vali Acc: 0.533 Test Loss: 0.705 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9185085296630859
Epoch: 6, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.831 Vali Acc: 0.494 Test Loss: 0.831 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0314950942993164
Epoch: 7, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.827 Vali Acc: 0.494 Test Loss: 0.827 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9556224346160889
Epoch: 8, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.828 Vali Acc: 0.467 Test Loss: 0.828 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8844869136810303
Epoch: 9, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.804 Vali Acc: 0.544 Test Loss: 0.804 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544436).  Saving model ...
Epoch: 10 cost time: 0.8396861553192139
Epoch: 10, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.891 Vali Acc: 0.511 Test Loss: 0.891 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9185359477996826
Epoch: 11, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.027 Vali Acc: 0.494 Test Loss: 1.027 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.293938159942627
Epoch: 12, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.480 Vali Acc: 0.494 Test Loss: 1.480 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0186936855316162
Epoch: 13, Steps: 13 | Train Loss: 0.614 Vali Loss: 1.024 Vali Acc: 0.450 Test Loss: 1.024 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8457934856414795
Epoch: 14, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.067 Vali Acc: 0.483 Test Loss: 1.067 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9302961826324463
Epoch: 15, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.157 Vali Acc: 0.478 Test Loss: 1.157 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.23348069190979
Epoch: 16, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4015178680419922
Epoch: 17, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.338 Vali Acc: 0.489 Test Loss: 1.338 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1963748931884766
Epoch: 18, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.463 Vali Acc: 0.506 Test Loss: 1.463 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.858391523361206
Epoch: 19, Steps: 13 | Train Loss: 0.190 Vali Loss: 1.460 Vali Acc: 0.494 Test Loss: 1.460 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 37282562
model size : 156.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps61_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.762606143951416
Epoch: 1, Steps: 13 | Train Loss: 0.839 Vali Loss: 0.681 Vali Acc: 0.589 Test Loss: 0.681 Test Acc: 0.589
Validation loss decreased (inf --> -0.588882).  Saving model ...
Epoch: 2 cost time: 1.4852826595306396
Epoch: 2, Steps: 13 | Train Loss: 0.837 Vali Loss: 0.734 Vali Acc: 0.500 Test Loss: 0.734 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7219939231872559
Epoch: 3, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2192177772521973
Epoch: 4, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9557914733886719
Epoch: 5, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.831 Vali Acc: 0.511 Test Loss: 0.831 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.986297607421875
Epoch: 6, Steps: 13 | Train Loss: 0.787 Vali Loss: 0.917 Vali Acc: 0.506 Test Loss: 0.917 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0103707313537598
Epoch: 7, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.872 Vali Acc: 0.506 Test Loss: 0.872 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1040585041046143
Epoch: 8, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.762 Vali Acc: 0.506 Test Loss: 0.762 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3264217376708984
Epoch: 9, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.916 Vali Acc: 0.500 Test Loss: 0.916 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.015085220336914
Epoch: 10, Steps: 13 | Train Loss: 0.756 Vali Loss: 1.009 Vali Acc: 0.500 Test Loss: 1.009 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7661666870117188
Epoch: 11, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.884 Vali Acc: 0.472 Test Loss: 0.884 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps61_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 37484546
model size : 157.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0018351078033447
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.695 Vali Acc: 0.533 Test Loss: 0.695 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.7730021476745605
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.735 Vali Acc: 0.489 Test Loss: 0.735 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4871604442596436
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.697 Vali Acc: 0.578 Test Loss: 0.697 Test Acc: 0.578
Validation loss decreased (-0.533326 --> -0.577771).  Saving model ...
Epoch: 4 cost time: 1.224613904953003
Epoch: 4, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.745 Vali Acc: 0.511 Test Loss: 0.745 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1989984512329102
Epoch: 5, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.712 Vali Acc: 0.472 Test Loss: 0.712 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1543078422546387
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.756 Vali Acc: 0.522 Test Loss: 0.756 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5189220905303955
Epoch: 7, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.757 Vali Acc: 0.483 Test Loss: 0.757 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3135883808135986
Epoch: 8, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.940 Vali Acc: 0.517 Test Loss: 0.940 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6156694889068604
Epoch: 9, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.955 Vali Acc: 0.528 Test Loss: 0.955 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4452428817749023
Epoch: 10, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.273 Vali Acc: 0.422 Test Loss: 1.273 Test Acc: 0.422
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6859171390533447
Epoch: 11, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.962 Vali Acc: 0.500 Test Loss: 0.962 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5032703876495361
Epoch: 12, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8314087390899658
Epoch: 13, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.116 Vali Acc: 0.478 Test Loss: 1.116 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 37383170
model size : 157.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps61_str61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7859156131744385
Epoch: 1, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.704 Vali Acc: 0.467 Test Loss: 0.704 Test Acc: 0.467
Validation loss decreased (inf --> -0.466660).  Saving model ...
Epoch: 2 cost time: 1.291503667831421
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.702 Vali Acc: 0.533 Test Loss: 0.702 Test Acc: 0.533
Validation loss decreased (-0.466660 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.3591938018798828
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.698 Vali Acc: 0.494 Test Loss: 0.698 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4007675647735596
Epoch: 4, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.731 Vali Acc: 0.506 Test Loss: 0.731 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0481352806091309
Epoch: 5, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.722 Vali Acc: 0.533 Test Loss: 0.722 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3756122589111328
Epoch: 6, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.904 Vali Acc: 0.511 Test Loss: 0.904 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2013936042785645
Epoch: 7, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.026191234588623
Epoch: 8, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.754 Vali Acc: 0.528 Test Loss: 0.754 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9370882511138916
Epoch: 9, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.822 Vali Acc: 0.478 Test Loss: 0.822 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.932727575302124
Epoch: 10, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.806 Vali Acc: 0.567 Test Loss: 0.806 Test Acc: 0.567
Validation loss decreased (-0.533326 --> -0.566659).  Saving model ...
Epoch: 11 cost time: 0.9017250537872314
Epoch: 11, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.852 Vali Acc: 0.522 Test Loss: 0.852 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9334268569946289
Epoch: 12, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.909 Vali Acc: 0.539 Test Loss: 0.909 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.191051721572876
Epoch: 13, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.093 Vali Acc: 0.561 Test Loss: 1.093 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3860340118408203
Epoch: 14, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.058 Vali Acc: 0.511 Test Loss: 1.058 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0327200889587402
Epoch: 15, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.986 Vali Acc: 0.511 Test Loss: 0.986 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3248672485351562
Epoch: 16, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.110 Vali Acc: 0.533 Test Loss: 1.110 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2141120433807373
Epoch: 17, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8164680004119873
Epoch: 18, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.368 Vali Acc: 0.544 Test Loss: 1.368 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7250514030456543
Epoch: 19, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.258 Vali Acc: 0.567 Test Loss: 1.258 Test Acc: 0.567
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7523999214172363
Epoch: 20, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.857 Vali Acc: 0.500 Test Loss: 1.857 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps61_str61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 37327874
model size : 157.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.964686632156372
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.767 Vali Acc: 0.500 Test Loss: 0.767 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.6025869846343994
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.714 Vali Acc: 0.533 Test Loss: 0.714 Test Acc: 0.533
Validation loss decreased (-0.499992 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 2.388056993484497
Epoch: 3, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.728 Vali Acc: 0.550 Test Loss: 0.728 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.0763309001922607
Epoch: 4, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.749 Vali Acc: 0.511 Test Loss: 0.749 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8598129749298096
Epoch: 5, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.891 Vali Acc: 0.517 Test Loss: 0.891 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0966544151306152
Epoch: 6, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.909 Vali Acc: 0.522 Test Loss: 0.909 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8276114463806152
Epoch: 7, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.061 Vali Acc: 0.450 Test Loss: 1.061 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.860318899154663
Epoch: 8, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.816 Vali Acc: 0.594 Test Loss: 0.816 Test Acc: 0.594
Validation loss decreased (-0.549993 --> -0.594436).  Saving model ...
Epoch: 9 cost time: 1.7760846614837646
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.899 Vali Acc: 0.539 Test Loss: 0.899 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4671850204467773
Epoch: 10, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.050 Vali Acc: 0.511 Test Loss: 1.050 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0501437187194824
Epoch: 11, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.444 Vali Acc: 0.478 Test Loss: 1.444 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.588376522064209
Epoch: 12, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.310 Vali Acc: 0.544 Test Loss: 1.310 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6782066822052002
Epoch: 13, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.220 Vali Acc: 0.561 Test Loss: 1.220 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.220522165298462
Epoch: 14, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.184 Vali Acc: 0.533 Test Loss: 1.184 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9602830410003662
Epoch: 15, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.573 Vali Acc: 0.517 Test Loss: 1.573 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.670877456665039
Epoch: 16, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.705 Vali Acc: 0.511 Test Loss: 1.705 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.187333345413208
Epoch: 17, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.784 Vali Acc: 0.478 Test Loss: 1.784 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6628775596618652
Epoch: 18, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.946 Vali Acc: 0.533 Test Loss: 1.946 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5944444444444444
model parameter : 37532930
model size : 157.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.742753744125366
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.695 Vali Acc: 0.539 Test Loss: 0.695 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.5617172718048096
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.728 Vali Acc: 0.506 Test Loss: 0.728 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2151803970336914
Epoch: 3, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.686 Vali Acc: 0.567 Test Loss: 0.686 Test Acc: 0.567
Validation loss decreased (-0.538882 --> -0.566660).  Saving model ...
Epoch: 4 cost time: 1.2513885498046875
Epoch: 4, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2769155502319336
Epoch: 5, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.721 Vali Acc: 0.561 Test Loss: 0.721 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0891916751861572
Epoch: 6, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.706 Vali Acc: 0.539 Test Loss: 0.706 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4828417301177979
Epoch: 7, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.763 Vali Acc: 0.550 Test Loss: 0.763 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9359633922576904
Epoch: 8, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.884 Vali Acc: 0.561 Test Loss: 0.884 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6979074478149414
Epoch: 9, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.890 Vali Acc: 0.533 Test Loss: 0.890 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.978456974029541
Epoch: 10, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.988 Vali Acc: 0.489 Test Loss: 0.988 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.486799716949463
Epoch: 11, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.971 Vali Acc: 0.517 Test Loss: 0.971 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8512914180755615
Epoch: 12, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.151 Vali Acc: 0.483 Test Loss: 1.151 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2817816734313965
Epoch: 13, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.298 Vali Acc: 0.506 Test Loss: 1.298 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 37428482
model size : 157.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2887587547302246
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.674 Vali Acc: 0.550 Test Loss: 0.674 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.2336277961730957
Epoch: 2, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.697 Vali Acc: 0.522 Test Loss: 0.697 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2470076084136963
Epoch: 3, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.706 Vali Acc: 0.511 Test Loss: 0.706 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1393637657165527
Epoch: 4, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.719 Vali Acc: 0.511 Test Loss: 0.719 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.299452304840088
Epoch: 5, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.670 Vali Acc: 0.556 Test Loss: 0.670 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555549).  Saving model ...
Epoch: 6 cost time: 1.0509834289550781
Epoch: 6, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.782 Vali Acc: 0.500 Test Loss: 0.782 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2022478580474854
Epoch: 7, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.763 Vali Acc: 0.528 Test Loss: 0.763 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0744836330413818
Epoch: 8, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.756 Vali Acc: 0.511 Test Loss: 0.756 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8276462554931641
Epoch: 9, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.811 Vali Acc: 0.528 Test Loss: 0.811 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0729215145111084
Epoch: 10, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.265 Vali Acc: 0.456 Test Loss: 1.265 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1582810878753662
Epoch: 11, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.914 Vali Acc: 0.528 Test Loss: 0.914 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.138197422027588
Epoch: 12, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.867 Vali Acc: 0.528 Test Loss: 0.867 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.401036262512207
Epoch: 13, Steps: 13 | Train Loss: 0.537 Vali Loss: 1.109 Vali Acc: 0.494 Test Loss: 1.109 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3144164085388184
Epoch: 14, Steps: 13 | Train Loss: 0.456 Vali Loss: 1.096 Vali Acc: 0.511 Test Loss: 1.096 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6676251888275146
Epoch: 15, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 37376258
model size : 157.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.808851480484009
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.8505353927612305
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.689 Vali Acc: 0.556 Test Loss: 0.689 Test Acc: 0.556
Validation loss decreased (-0.499993 --> -0.555549).  Saving model ...
Epoch: 3 cost time: 2.0113396644592285
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.686 Vali Acc: 0.539 Test Loss: 0.686 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.640434980392456
Epoch: 4, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.801 Vali Acc: 0.533 Test Loss: 0.801 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7313196659088135
Epoch: 5, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.730 Vali Acc: 0.533 Test Loss: 0.730 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1485679149627686
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.798 Vali Acc: 0.533 Test Loss: 0.798 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3136065006256104
Epoch: 7, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.832 Vali Acc: 0.550 Test Loss: 0.832 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7549166679382324
Epoch: 8, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.824 Vali Acc: 0.578 Test Loss: 0.824 Test Acc: 0.578
Validation loss decreased (-0.555549 --> -0.577770).  Saving model ...
Epoch: 9 cost time: 2.0215461254119873
Epoch: 9, Steps: 13 | Train Loss: 0.533 Vali Loss: 1.129 Vali Acc: 0.556 Test Loss: 1.129 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5805225372314453
Epoch: 10, Steps: 13 | Train Loss: 0.650 Vali Loss: 1.243 Vali Acc: 0.494 Test Loss: 1.243 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3418221473693848
Epoch: 11, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.016 Vali Acc: 0.489 Test Loss: 1.016 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2683584690093994
Epoch: 12, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.497 Vali Acc: 0.489 Test Loss: 1.497 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.528024911880493
Epoch: 13, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.417 Vali Acc: 0.506 Test Loss: 1.417 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9240500926971436
Epoch: 14, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.500 Vali Acc: 0.522 Test Loss: 1.500 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.002563953399658
Epoch: 15, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.390 Vali Acc: 0.528 Test Loss: 1.390 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1069753170013428
Epoch: 16, Steps: 13 | Train Loss: 0.263 Vali Loss: 2.043 Vali Acc: 0.472 Test Loss: 2.043 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.165808916091919
Epoch: 17, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.913 Vali Acc: 0.494 Test Loss: 1.913 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0619335174560547
Epoch: 18, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.691 Vali Acc: 0.533 Test Loss: 1.691 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 37582082
model size : 158.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.167999505996704
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.703 Vali Acc: 0.500 Test Loss: 0.703 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.4241111278533936
Epoch: 2, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.699 Vali Acc: 0.533 Test Loss: 0.699 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.5468487739562988
Epoch: 3, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.719 Vali Acc: 0.506 Test Loss: 0.719 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0039970874786377
Epoch: 4, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.717 Vali Acc: 0.533 Test Loss: 0.717 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4042599201202393
Epoch: 5, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.864 Vali Acc: 0.511 Test Loss: 0.864 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7272050380706787
Epoch: 6, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.731 Vali Acc: 0.511 Test Loss: 0.731 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3386600017547607
Epoch: 7, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.800 Vali Acc: 0.528 Test Loss: 0.800 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3783178329467773
Epoch: 8, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.776 Vali Acc: 0.511 Test Loss: 0.776 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.144469976425171
Epoch: 9, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.826 Vali Acc: 0.533 Test Loss: 0.826 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.510176420211792
Epoch: 10, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.914 Vali Acc: 0.556 Test Loss: 0.914 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555546).  Saving model ...
Epoch: 11 cost time: 2.02040433883667
Epoch: 11, Steps: 13 | Train Loss: 0.567 Vali Loss: 1.075 Vali Acc: 0.494 Test Loss: 1.075 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3722739219665527
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.947 Vali Acc: 0.511 Test Loss: 0.947 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.591261863708496
Epoch: 13, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.201 Vali Acc: 0.517 Test Loss: 1.201 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.380753755569458
Epoch: 14, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.547 Vali Acc: 0.472 Test Loss: 1.547 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5285475254058838
Epoch: 15, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.722 Vali Acc: 0.478 Test Loss: 1.722 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2334978580474854
Epoch: 16, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.564 Vali Acc: 0.511 Test Loss: 1.564 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.245243787765503
Epoch: 17, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.612 Vali Acc: 0.528 Test Loss: 1.612 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7459378242492676
Epoch: 18, Steps: 13 | Train Loss: 0.563 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4778237342834473
Epoch: 19, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.708 Vali Acc: 0.506 Test Loss: 1.708 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5266168117523193
Epoch: 20, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.642 Vali Acc: 0.517 Test Loss: 1.642 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 37483778
model size : 157.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.220970630645752
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.705 Vali Acc: 0.494 Test Loss: 0.705 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.6236567497253418
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.690 Vali Acc: 0.533 Test Loss: 0.690 Test Acc: 0.533
Validation loss decreased (-0.494437 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.076174259185791
Epoch: 3, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.704 Vali Acc: 0.506 Test Loss: 0.704 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4584987163543701
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.263697624206543
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.707 Vali Acc: 0.489 Test Loss: 0.707 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5077385902404785
Epoch: 6, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.761 Vali Acc: 0.483 Test Loss: 0.761 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5417003631591797
Epoch: 7, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.794 Vali Acc: 0.456 Test Loss: 0.794 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2292695045471191
Epoch: 8, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.834 Vali Acc: 0.472 Test Loss: 0.834 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3562910556793213
Epoch: 9, Steps: 13 | Train Loss: 0.574 Vali Loss: 1.042 Vali Acc: 0.439 Test Loss: 1.042 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2765836715698242
Epoch: 10, Steps: 13 | Train Loss: 0.521 Vali Loss: 1.054 Vali Acc: 0.533 Test Loss: 1.054 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4246065616607666
Epoch: 11, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.845 Vali Acc: 0.517 Test Loss: 0.845 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2438111305236816
Epoch: 12, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.959 Vali Acc: 0.489 Test Loss: 0.959 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 37434626
model size : 157.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps72_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.038339138031006
Epoch: 1, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.5703823566436768
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.8553805351257324
Epoch: 3, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.939 Vali Acc: 0.494 Test Loss: 0.939 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7578604221343994
Epoch: 4, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.731 Vali Acc: 0.528 Test Loss: 0.731 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7233006954193115
Epoch: 5, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.855 Vali Acc: 0.500 Test Loss: 0.855 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7447855472564697
Epoch: 6, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.756 Vali Acc: 0.489 Test Loss: 0.756 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8663341999053955
Epoch: 7, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.772 Vali Acc: 0.478 Test Loss: 0.772 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.426884651184082
Epoch: 8, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.960 Vali Acc: 0.450 Test Loss: 0.960 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0245628356933594
Epoch: 9, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.281 Vali Acc: 0.483 Test Loss: 1.281 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1582553386688232
Epoch: 10, Steps: 13 | Train Loss: 0.512 Vali Loss: 1.214 Vali Acc: 0.450 Test Loss: 1.214 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.043672800064087
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.550 Vali Acc: 0.461 Test Loss: 1.550 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.993211269378662
Epoch: 12, Steps: 13 | Train Loss: 0.524 Vali Loss: 1.138 Vali Acc: 0.511 Test Loss: 1.138 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps72_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 37637378
model size : 158.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps72_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1378421783447266
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2546710968017578
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.693 Vali Acc: 0.528 Test Loss: 0.693 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.4325416088104248
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3596446514129639
Epoch: 4, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.725 Vali Acc: 0.556 Test Loss: 0.725 Test Acc: 0.556
Validation loss decreased (-0.527771 --> -0.555548).  Saving model ...
Epoch: 5 cost time: 1.3689172267913818
Epoch: 5, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.560973882675171
Epoch: 6, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.754 Vali Acc: 0.544 Test Loss: 0.754 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.435819149017334
Epoch: 7, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.970 Vali Acc: 0.483 Test Loss: 0.970 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5107500553131104
Epoch: 8, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.819 Vali Acc: 0.500 Test Loss: 0.819 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1678788661956787
Epoch: 9, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.935 Vali Acc: 0.467 Test Loss: 0.935 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9519703388214111
Epoch: 10, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.272 Vali Acc: 0.506 Test Loss: 1.272 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6025302410125732
Epoch: 11, Steps: 13 | Train Loss: 0.479 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3554537296295166
Epoch: 12, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.171 Vali Acc: 0.494 Test Loss: 1.171 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.750758409500122
Epoch: 13, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.414 Vali Acc: 0.483 Test Loss: 1.414 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1182334423065186
Epoch: 14, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.043 Vali Acc: 0.511 Test Loss: 1.043 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps72_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 37545218
model size : 157.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps72_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6050658226013184
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.688 Vali Acc: 0.539 Test Loss: 0.688 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.625014066696167
Epoch: 2, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.693 Vali Acc: 0.500 Test Loss: 0.693 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3173565864562988
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.692 Vali Acc: 0.544 Test Loss: 0.692 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 1.7210118770599365
Epoch: 4, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.699 Vali Acc: 0.506 Test Loss: 0.699 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4714367389678955
Epoch: 5, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.701 Vali Acc: 0.539 Test Loss: 0.701 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2671117782592773
Epoch: 6, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.722 Vali Acc: 0.506 Test Loss: 0.722 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8336331844329834
Epoch: 7, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.760 Vali Acc: 0.472 Test Loss: 0.760 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7701201438903809
Epoch: 8, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.785 Vali Acc: 0.506 Test Loss: 0.785 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.84025239944458
Epoch: 9, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.624178171157837
Epoch: 10, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.915 Vali Acc: 0.550 Test Loss: 0.915 Test Acc: 0.550
Validation loss decreased (-0.544438 --> -0.549991).  Saving model ...
Epoch: 11 cost time: 1.9584124088287354
Epoch: 11, Steps: 13 | Train Loss: 0.477 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4419991970062256
Epoch: 12, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.091 Vali Acc: 0.483 Test Loss: 1.091 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9584624767303467
Epoch: 13, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.177 Vali Acc: 0.478 Test Loss: 1.177 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8768699169158936
Epoch: 14, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.241 Vali Acc: 0.506 Test Loss: 1.241 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.893817663192749
Epoch: 15, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.357 Vali Acc: 0.494 Test Loss: 1.357 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7024264335632324
Epoch: 16, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.290 Vali Acc: 0.472 Test Loss: 1.290 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9658539295196533
Epoch: 17, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.429 Vali Acc: 0.494 Test Loss: 1.429 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1602528095245361
Epoch: 18, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.615 Vali Acc: 0.461 Test Loss: 1.615 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2189695835113525
Epoch: 19, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.720 Vali Acc: 0.478 Test Loss: 1.720 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5211350917816162
Epoch: 20, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.660 Vali Acc: 0.456 Test Loss: 1.660 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps72_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 37499138
model size : 157.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.893263339996338
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.760 Vali Acc: 0.456 Test Loss: 0.760 Test Acc: 0.456
Validation loss decreased (inf --> -0.455548).  Saving model ...
Epoch: 2 cost time: 1.556736707687378
Epoch: 2, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.708 Vali Acc: 0.533 Test Loss: 0.708 Test Acc: 0.533
Validation loss decreased (-0.455548 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.3537085056304932
Epoch: 3, Steps: 13 | Train Loss: 0.760 Vali Loss: 1.000 Vali Acc: 0.500 Test Loss: 1.000 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.329373598098755
Epoch: 4, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.830 Vali Acc: 0.489 Test Loss: 0.830 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9603302478790283
Epoch: 5, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.719 Vali Acc: 0.539 Test Loss: 0.719 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 6 cost time: 2.140582323074341
Epoch: 6, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.722 Vali Acc: 0.511 Test Loss: 0.722 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9641327857971191
Epoch: 7, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.842 Vali Acc: 0.506 Test Loss: 0.842 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6268932819366455
Epoch: 8, Steps: 13 | Train Loss: 0.545 Vali Loss: 1.047 Vali Acc: 0.489 Test Loss: 1.047 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.450324535369873
Epoch: 9, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.791 Vali Acc: 0.522 Test Loss: 0.791 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6707062721252441
Epoch: 10, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.138 Vali Acc: 0.511 Test Loss: 1.138 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.398491382598877
Epoch: 11, Steps: 13 | Train Loss: 0.607 Vali Loss: 1.039 Vali Acc: 0.550 Test Loss: 1.039 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549990).  Saving model ...
Epoch: 12 cost time: 1.3854541778564453
Epoch: 12, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.360 Vali Acc: 0.533 Test Loss: 1.360 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5340428352355957
Epoch: 13, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.881 Vali Acc: 0.494 Test Loss: 1.881 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5217092037200928
Epoch: 14, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.195 Vali Acc: 0.606 Test Loss: 1.195 Test Acc: 0.606
Validation loss decreased (-0.549990 --> -0.605544).  Saving model ...
Epoch: 15 cost time: 1.7388296127319336
Epoch: 15, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.426 Vali Acc: 0.572 Test Loss: 1.426 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4516313076019287
Epoch: 16, Steps: 13 | Train Loss: 0.251 Vali Loss: 2.078 Vali Acc: 0.467 Test Loss: 2.078 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.184286594390869
Epoch: 17, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.794 Vali Acc: 0.533 Test Loss: 1.794 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6779966354370117
Epoch: 18, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.966 Vali Acc: 0.544 Test Loss: 1.966 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.043949842453003
Epoch: 19, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.981 Vali Acc: 0.494 Test Loss: 1.981 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6525816917419434
Epoch: 20, Steps: 13 | Train Loss: 0.122 Vali Loss: 2.069 Vali Acc: 0.539 Test Loss: 2.069 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.152625560760498
Epoch: 21, Steps: 13 | Train Loss: 0.246 Vali Loss: 2.492 Vali Acc: 0.506 Test Loss: 2.492 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5140507221221924
Epoch: 22, Steps: 13 | Train Loss: 0.252 Vali Loss: 2.133 Vali Acc: 0.528 Test Loss: 2.133 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9636828899383545
Epoch: 23, Steps: 13 | Train Loss: 0.179 Vali Loss: 2.454 Vali Acc: 0.500 Test Loss: 2.454 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9179611206054688
Epoch: 24, Steps: 13 | Train Loss: 0.104 Vali Loss: 2.590 Vali Acc: 0.506 Test Loss: 2.590 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6055555555555555
model parameter : 37696514
model size : 158.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.340801239013672
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.700 Vali Acc: 0.483 Test Loss: 0.700 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.8072090148925781
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.723 Vali Acc: 0.494 Test Loss: 0.723 Test Acc: 0.494
Validation loss decreased (-0.483326 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.7731192111968994
Epoch: 3, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.681 Vali Acc: 0.517 Test Loss: 0.681 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.28830885887146
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.721 Vali Acc: 0.517 Test Loss: 0.721 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4984800815582275
Epoch: 5, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.790 Vali Acc: 0.511 Test Loss: 0.790 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3815631866455078
Epoch: 6, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.813 Vali Acc: 0.556 Test Loss: 0.813 Test Acc: 0.556
Validation loss decreased (-0.516660 --> -0.555547).  Saving model ...
Epoch: 7 cost time: 1.727318525314331
Epoch: 7, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.848 Vali Acc: 0.483 Test Loss: 0.848 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0692036151885986
Epoch: 8, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.847 Vali Acc: 0.478 Test Loss: 0.847 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1020195484161377
Epoch: 9, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.929 Vali Acc: 0.500 Test Loss: 0.929 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.280186414718628
Epoch: 10, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.923 Vali Acc: 0.483 Test Loss: 0.923 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5014457702636719
Epoch: 11, Steps: 13 | Train Loss: 0.469 Vali Loss: 1.073 Vali Acc: 0.522 Test Loss: 1.073 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4911916255950928
Epoch: 12, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.229 Vali Acc: 0.506 Test Loss: 1.229 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8011677265167236
Epoch: 13, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.138 Vali Acc: 0.489 Test Loss: 1.138 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4471290111541748
Epoch: 14, Steps: 13 | Train Loss: 0.384 Vali Loss: 1.292 Vali Acc: 0.433 Test Loss: 1.292 Test Acc: 0.433
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8700916767120361
Epoch: 15, Steps: 13 | Train Loss: 0.333 Vali Loss: 1.390 Vali Acc: 0.494 Test Loss: 1.390 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.479210615158081
Epoch: 16, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.320 Vali Acc: 0.456 Test Loss: 1.320 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 37616642
model size : 158.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7428441047668457
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.700 Vali Acc: 0.506 Test Loss: 0.700 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 1.3474674224853516
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.755 Vali Acc: 0.522 Test Loss: 0.755 Test Acc: 0.522
Validation loss decreased (-0.505549 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 0.8592581748962402
Epoch: 3, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.692 Vali Acc: 0.544 Test Loss: 0.692 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 1.175926685333252
Epoch: 4, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.701 Vali Acc: 0.544 Test Loss: 0.701 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1690328121185303
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.713 Vali Acc: 0.533 Test Loss: 0.713 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1575334072113037
Epoch: 6, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.782 Vali Acc: 0.472 Test Loss: 0.782 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3285300731658936
Epoch: 7, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.701 Vali Acc: 0.528 Test Loss: 0.701 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2650184631347656
Epoch: 8, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.836 Vali Acc: 0.517 Test Loss: 0.836 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.351090908050537
Epoch: 9, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.890 Vali Acc: 0.567 Test Loss: 0.890 Test Acc: 0.567
Validation loss decreased (-0.544438 --> -0.566658).  Saving model ...
Epoch: 10 cost time: 1.0381548404693604
Epoch: 10, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.973 Vali Acc: 0.533 Test Loss: 0.973 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2699065208435059
Epoch: 11, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.018 Vali Acc: 0.528 Test Loss: 1.018 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3185973167419434
Epoch: 12, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.119 Vali Acc: 0.506 Test Loss: 1.119 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0501484870910645
Epoch: 13, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.067 Vali Acc: 0.500 Test Loss: 1.067 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.983130931854248
Epoch: 14, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.286 Vali Acc: 0.428 Test Loss: 1.286 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4567506313323975
Epoch: 15, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.111 Vali Acc: 0.511 Test Loss: 1.111 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.246368408203125
Epoch: 16, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.199 Vali Acc: 0.550 Test Loss: 1.199 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7173240184783936
Epoch: 17, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.396 Vali Acc: 0.517 Test Loss: 1.396 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5503056049346924
Epoch: 18, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.458 Vali Acc: 0.506 Test Loss: 1.458 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.371086835861206
Epoch: 19, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.472 Vali Acc: 0.539 Test Loss: 1.472 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 37573634
model size : 158.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps83_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.990776062011719
Epoch: 1, Steps: 13 | Train Loss: 0.843 Vali Loss: 0.717 Vali Acc: 0.511 Test Loss: 0.717 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 2.5933356285095215
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.730 Vali Acc: 0.539 Test Loss: 0.730 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.8747131824493408
Epoch: 3, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.275506019592285
Epoch: 4, Steps: 13 | Train Loss: 0.837 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.959923505783081
Epoch: 5, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.736 Vali Acc: 0.472 Test Loss: 0.736 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9701471328735352
Epoch: 6, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.783 Vali Acc: 0.478 Test Loss: 0.783 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.636883497238159
Epoch: 7, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.773 Vali Acc: 0.539 Test Loss: 0.773 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.762465476989746
Epoch: 8, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.757 Vali Acc: 0.511 Test Loss: 0.757 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.058086395263672
Epoch: 9, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.948 Vali Acc: 0.556 Test Loss: 0.948 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555546).  Saving model ...
Epoch: 10 cost time: 2.121891975402832
Epoch: 10, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.185 Vali Acc: 0.472 Test Loss: 1.185 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.187962055206299
Epoch: 11, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9070298671722412
Epoch: 12, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.201 Vali Acc: 0.511 Test Loss: 1.201 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8377997875213623
Epoch: 13, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8994221687316895
Epoch: 14, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.369 Vali Acc: 0.494 Test Loss: 1.369 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.1838128566741943
Epoch: 15, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.580 Vali Acc: 0.444 Test Loss: 1.580 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9203526973724365
Epoch: 16, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.625 Vali Acc: 0.494 Test Loss: 1.625 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9009153842926025
Epoch: 17, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.729 Vali Acc: 0.472 Test Loss: 1.729 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8809669017791748
Epoch: 18, Steps: 13 | Train Loss: 0.152 Vali Loss: 2.138 Vali Acc: 0.494 Test Loss: 2.138 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8567256927490234
Epoch: 19, Steps: 13 | Train Loss: 0.181 Vali Loss: 2.218 Vali Acc: 0.511 Test Loss: 2.218 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps83_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 37784066
model size : 158.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps83_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.240734338760376
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.710 Vali Acc: 0.467 Test Loss: 0.710 Test Acc: 0.467
Validation loss decreased (inf --> -0.466660).  Saving model ...
Epoch: 2 cost time: 1.1653602123260498
Epoch: 2, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.719 Vali Acc: 0.478 Test Loss: 0.719 Test Acc: 0.478
Validation loss decreased (-0.466660 --> -0.477771).  Saving model ...
Epoch: 3 cost time: 1.2837460041046143
Epoch: 3, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.704 Vali Acc: 0.539 Test Loss: 0.704 Test Acc: 0.539
Validation loss decreased (-0.477771 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.0620625019073486
Epoch: 4, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.706 Vali Acc: 0.511 Test Loss: 0.706 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0036225318908691
Epoch: 5, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0482878684997559
Epoch: 6, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.789 Vali Acc: 0.500 Test Loss: 0.789 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0713181495666504
Epoch: 7, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.899 Vali Acc: 0.533 Test Loss: 0.899 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7344322204589844
Epoch: 8, Steps: 13 | Train Loss: 0.625 Vali Loss: 1.015 Vali Acc: 0.517 Test Loss: 1.015 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7939033508300781
Epoch: 9, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.815 Vali Acc: 0.511 Test Loss: 0.815 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.65505051612854
Epoch: 10, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.963 Vali Acc: 0.489 Test Loss: 0.963 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1396043300628662
Epoch: 11, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.983 Vali Acc: 0.506 Test Loss: 0.983 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9809422492980957
Epoch: 12, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.020 Vali Acc: 0.506 Test Loss: 1.020 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0029699802398682
Epoch: 13, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.028 Vali Acc: 0.483 Test Loss: 1.028 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps83_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 37707266
model size : 158.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps83_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.824807643890381
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.683 Vali Acc: 0.544 Test Loss: 0.683 Test Acc: 0.544
Validation loss decreased (inf --> -0.544438).  Saving model ...
Epoch: 2 cost time: 0.8312838077545166
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.676 Vali Acc: 0.561 Test Loss: 0.676 Test Acc: 0.561
Validation loss decreased (-0.544438 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 1.256455898284912
Epoch: 3, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.682 Vali Acc: 0.533 Test Loss: 0.682 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1654980182647705
Epoch: 4, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.696 Vali Acc: 0.539 Test Loss: 0.696 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0917789936065674
Epoch: 5, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.753 Vali Acc: 0.494 Test Loss: 0.753 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0230958461761475
Epoch: 6, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.730 Vali Acc: 0.544 Test Loss: 0.730 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.969313383102417
Epoch: 7, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.874 Vali Acc: 0.467 Test Loss: 0.874 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0008790493011475
Epoch: 8, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.827 Vali Acc: 0.483 Test Loss: 0.827 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.114558458328247
Epoch: 9, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.915 Vali Acc: 0.533 Test Loss: 0.915 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9891884326934814
Epoch: 10, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.904 Vali Acc: 0.511 Test Loss: 0.904 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9864943027496338
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.026 Vali Acc: 0.461 Test Loss: 1.026 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2720651626586914
Epoch: 12, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.998 Vali Acc: 0.450 Test Loss: 0.998 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps83_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 37667330
model size : 158.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps89_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.8511948585510254
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.813 Vali Acc: 0.500 Test Loss: 0.813 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.9966709613800049
Epoch: 2, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.698 Vali Acc: 0.544 Test Loss: 0.698 Test Acc: 0.544
Validation loss decreased (-0.499992 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.5945580005645752
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.713 Vali Acc: 0.450 Test Loss: 0.713 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.406048536300659
Epoch: 4, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.705 Vali Acc: 0.544 Test Loss: 0.705 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4237134456634521
Epoch: 5, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.791 Vali Acc: 0.522 Test Loss: 0.791 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7861707210540771
Epoch: 6, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.781 Vali Acc: 0.506 Test Loss: 0.781 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2235066890716553
Epoch: 7, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.823 Vali Acc: 0.522 Test Loss: 0.823 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.749516487121582
Epoch: 8, Steps: 13 | Train Loss: 0.506 Vali Loss: 1.069 Vali Acc: 0.472 Test Loss: 1.069 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5690193176269531
Epoch: 9, Steps: 13 | Train Loss: 0.521 Vali Loss: 1.057 Vali Acc: 0.456 Test Loss: 1.057 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7742376327514648
Epoch: 10, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5475738048553467
Epoch: 11, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.878744125366211
Epoch: 12, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.306 Vali Acc: 0.444 Test Loss: 1.306 Test Acc: 0.444
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps89_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 37868546
model size : 159.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps89_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.166348695755005
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.701 Vali Acc: 0.517 Test Loss: 0.701 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 0.935312032699585
Epoch: 2, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.728 Vali Acc: 0.478 Test Loss: 0.728 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.875178337097168
Epoch: 3, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.690 Vali Acc: 0.544 Test Loss: 0.690 Test Acc: 0.544
Validation loss decreased (-0.516660 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 0.9152679443359375
Epoch: 4, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.757 Vali Acc: 0.489 Test Loss: 0.757 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.584146499633789
Epoch: 5, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.812 Vali Acc: 0.511 Test Loss: 0.812 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4759764671325684
Epoch: 6, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.713 Vali Acc: 0.544 Test Loss: 0.713 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.245816946029663
Epoch: 7, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.798 Vali Acc: 0.467 Test Loss: 0.798 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8835582733154297
Epoch: 8, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.743 Vali Acc: 0.489 Test Loss: 0.743 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.789668321609497
Epoch: 9, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.858 Vali Acc: 0.500 Test Loss: 0.858 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6559031009674072
Epoch: 10, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.988 Vali Acc: 0.517 Test Loss: 0.988 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.876594066619873
Epoch: 11, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.965 Vali Acc: 0.472 Test Loss: 0.965 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9574298858642578
Epoch: 12, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.128 Vali Acc: 0.511 Test Loss: 1.128 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4886343479156494
Epoch: 13, Steps: 13 | Train Loss: 0.496 Vali Loss: 1.060 Vali Acc: 0.517 Test Loss: 1.060 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps89_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 37797890
model size : 158.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps89_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8547565937042236
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.732 Vali Acc: 0.489 Test Loss: 0.732 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.1475934982299805
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.706 Vali Acc: 0.528 Test Loss: 0.706 Test Acc: 0.528
Validation loss decreased (-0.488882 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.8277032375335693
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.688 Vali Acc: 0.539 Test Loss: 0.688 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.2742829322814941
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.699 Vali Acc: 0.561 Test Loss: 0.699 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 1.5454578399658203
Epoch: 5, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.696 Vali Acc: 0.544 Test Loss: 0.696 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4106061458587646
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.774 Vali Acc: 0.522 Test Loss: 0.774 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.020639181137085
Epoch: 7, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.803 Vali Acc: 0.511 Test Loss: 0.803 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1597528457641602
Epoch: 8, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.845 Vali Acc: 0.511 Test Loss: 0.845 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9852087497711182
Epoch: 9, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.827 Vali Acc: 0.494 Test Loss: 0.827 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3863325119018555
Epoch: 10, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.920 Vali Acc: 0.494 Test Loss: 0.920 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1837568283081055
Epoch: 11, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.909 Vali Acc: 0.489 Test Loss: 0.909 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.256852149963379
Epoch: 12, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.898 Vali Acc: 0.511 Test Loss: 0.898 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.422490119934082
Epoch: 13, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.015 Vali Acc: 0.533 Test Loss: 1.015 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2570209503173828
Epoch: 14, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.109 Vali Acc: 0.511 Test Loss: 1.109 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps89_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 37761026
model size : 158.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps96_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.166549921035767
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.715 Vali Acc: 0.461 Test Loss: 0.715 Test Acc: 0.461
Validation loss decreased (inf --> -0.461104).  Saving model ...
Epoch: 2 cost time: 1.869316577911377
Epoch: 2, Steps: 13 | Train Loss: 0.760 Vali Loss: 0.726 Vali Acc: 0.522 Test Loss: 0.726 Test Acc: 0.522
Validation loss decreased (-0.461104 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.7443318367004395
Epoch: 3, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.964 Vali Acc: 0.506 Test Loss: 0.964 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5420541763305664
Epoch: 4, Steps: 13 | Train Loss: 0.840 Vali Loss: 0.739 Vali Acc: 0.544 Test Loss: 0.739 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.3195858001708984
Epoch: 5, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.744 Vali Acc: 0.506 Test Loss: 0.744 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.791534662246704
Epoch: 6, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.811 Vali Acc: 0.478 Test Loss: 0.811 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3179190158843994
Epoch: 7, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.748 Vali Acc: 0.517 Test Loss: 0.748 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.856792688369751
Epoch: 8, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.896 Vali Acc: 0.533 Test Loss: 0.896 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6760332584381104
Epoch: 9, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.884 Vali Acc: 0.544 Test Loss: 0.884 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2958881855010986
Epoch: 10, Steps: 13 | Train Loss: 0.487 Vali Loss: 1.114 Vali Acc: 0.517 Test Loss: 1.114 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7260348796844482
Epoch: 11, Steps: 13 | Train Loss: 0.456 Vali Loss: 1.153 Vali Acc: 0.472 Test Loss: 1.153 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.68180513381958
Epoch: 12, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.674 Vali Acc: 0.489 Test Loss: 1.674 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5680756568908691
Epoch: 13, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.309 Vali Acc: 0.483 Test Loss: 1.309 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.123795986175537
Epoch: 14, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.309 Vali Acc: 0.467 Test Loss: 1.309 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps96_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 37975298
model size : 159.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.062821388244629
Epoch: 1, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.704 Vali Acc: 0.500 Test Loss: 0.704 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.3358650207519531
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.677 Vali Acc: 0.550 Test Loss: 0.677 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.271467685699463
Epoch: 3, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.680 Vali Acc: 0.561 Test Loss: 0.680 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561104).  Saving model ...
Epoch: 4 cost time: 1.3201768398284912
Epoch: 4, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8064374923706055
Epoch: 5, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.693 Vali Acc: 0.544 Test Loss: 0.693 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1144843101501465
Epoch: 6, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.711 Vali Acc: 0.561 Test Loss: 0.711 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3836002349853516
Epoch: 7, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.940 Vali Acc: 0.528 Test Loss: 0.940 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.747274398803711
Epoch: 8, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.823 Vali Acc: 0.556 Test Loss: 0.823 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1708967685699463
Epoch: 9, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.876 Vali Acc: 0.483 Test Loss: 0.876 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9981918334960938
Epoch: 10, Steps: 13 | Train Loss: 0.396 Vali Loss: 1.076 Vali Acc: 0.483 Test Loss: 1.076 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6445362567901611
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2908029556274414
Epoch: 12, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.225 Vali Acc: 0.489 Test Loss: 1.225 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0802030563354492
Epoch: 13, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.112 Vali Acc: 0.511 Test Loss: 1.112 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 37907714
model size : 159.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps96_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1959798336029053
Epoch: 1, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.678 Vali Acc: 0.539 Test Loss: 0.678 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.1605818271636963
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.694 Vali Acc: 0.511 Test Loss: 0.694 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2485110759735107
Epoch: 3, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.734 Vali Acc: 0.483 Test Loss: 0.734 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1176741123199463
Epoch: 4, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.703 Vali Acc: 0.533 Test Loss: 0.703 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9756612777709961
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.704 Vali Acc: 0.517 Test Loss: 0.704 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8621904850006104
Epoch: 6, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.742 Vali Acc: 0.533 Test Loss: 0.742 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0763421058654785
Epoch: 7, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.773 Vali Acc: 0.489 Test Loss: 0.773 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0828502178192139
Epoch: 8, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.919 Vali Acc: 0.489 Test Loss: 0.919 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5100924968719482
Epoch: 9, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.814 Vali Acc: 0.533 Test Loss: 0.814 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2801756858825684
Epoch: 10, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.903 Vali Acc: 0.494 Test Loss: 0.903 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0937480926513672
Epoch: 11, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.928 Vali Acc: 0.450 Test Loss: 0.928 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps96_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 37873922
model size : 159.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.21094274520874
Epoch: 1, Steps: 13 | Train Loss: 0.786 Vali Loss: 0.759 Vali Acc: 0.500 Test Loss: 0.759 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.76314115524292
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.713 Vali Acc: 0.533 Test Loss: 0.713 Test Acc: 0.533
Validation loss decreased (-0.499992 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 2.406721353530884
Epoch: 3, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.766 Vali Acc: 0.472 Test Loss: 0.766 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9778311252593994
Epoch: 4, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.706 Vali Acc: 0.550 Test Loss: 0.706 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 2.206221103668213
Epoch: 5, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.758 Vali Acc: 0.511 Test Loss: 0.758 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9279274940490723
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.757 Vali Acc: 0.528 Test Loss: 0.757 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2252659797668457
Epoch: 7, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.831 Vali Acc: 0.456 Test Loss: 0.831 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0617733001708984
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.853 Vali Acc: 0.556 Test Loss: 0.853 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555547).  Saving model ...
Epoch: 9 cost time: 1.916938066482544
Epoch: 9, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.896 Vali Acc: 0.506 Test Loss: 0.896 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1468846797943115
Epoch: 10, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.131 Vali Acc: 0.522 Test Loss: 1.131 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8362324237823486
Epoch: 11, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.998 Vali Acc: 0.494 Test Loss: 0.998 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.167029857635498
Epoch: 12, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.307 Vali Acc: 0.478 Test Loss: 1.307 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6859443187713623
Epoch: 13, Steps: 13 | Train Loss: 0.606 Vali Loss: 1.000 Vali Acc: 0.556 Test Loss: 1.000 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1537115573883057
Epoch: 14, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.969 Vali Acc: 0.522 Test Loss: 0.969 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7204084396362305
Epoch: 15, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.298 Vali Acc: 0.494 Test Loss: 1.298 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4000697135925293
Epoch: 16, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.168 Vali Acc: 0.517 Test Loss: 1.168 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2831876277923584
Epoch: 17, Steps: 13 | Train Loss: 0.235 Vali Loss: 1.497 Vali Acc: 0.511 Test Loss: 1.497 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4508044719696045
Epoch: 18, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.676 Vali Acc: 0.522 Test Loss: 1.676 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 38102018
model size : 160.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.359236240386963
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.680 Vali Acc: 0.578 Test Loss: 0.680 Test Acc: 0.578
Validation loss decreased (inf --> -0.577771).  Saving model ...
Epoch: 2 cost time: 1.565596580505371
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.731 Vali Acc: 0.456 Test Loss: 0.731 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9536018371582031
Epoch: 3, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.692 Vali Acc: 0.578 Test Loss: 0.692 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.599313735961914
Epoch: 4, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.702 Vali Acc: 0.478 Test Loss: 0.702 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.403487205505371
Epoch: 5, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.766 Vali Acc: 0.439 Test Loss: 0.766 Test Acc: 0.439
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.75575852394104
Epoch: 6, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.750 Vali Acc: 0.567 Test Loss: 0.750 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6087596416473389
Epoch: 7, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.742 Vali Acc: 0.522 Test Loss: 0.742 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6360304355621338
Epoch: 8, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.834 Vali Acc: 0.572 Test Loss: 0.834 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1961309909820557
Epoch: 9, Steps: 13 | Train Loss: 0.427 Vali Loss: 1.180 Vali Acc: 0.478 Test Loss: 1.180 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7475826740264893
Epoch: 10, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.961 Vali Acc: 0.539 Test Loss: 0.961 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6677896976470947
Epoch: 11, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 38043650
model size : 159.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1079399585723877
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.694 Vali Acc: 0.511 Test Loss: 0.694 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.171830177307129
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.681 Vali Acc: 0.528 Test Loss: 0.681 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.0756053924560547
Epoch: 3, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.702 Vali Acc: 0.533 Test Loss: 0.702 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.3272144794464111
Epoch: 4, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.715 Vali Acc: 0.528 Test Loss: 0.715 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0349106788635254
Epoch: 5, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.705 Vali Acc: 0.556 Test Loss: 0.705 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555549).  Saving model ...
Epoch: 6 cost time: 1.314082384109497
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.758 Vali Acc: 0.511 Test Loss: 0.758 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0695722103118896
Epoch: 7, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.797 Vali Acc: 0.533 Test Loss: 0.797 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9197630882263184
Epoch: 8, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.817 Vali Acc: 0.483 Test Loss: 0.817 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8556950092315674
Epoch: 9, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.885 Vali Acc: 0.478 Test Loss: 0.885 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9923460483551025
Epoch: 10, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.938 Vali Acc: 0.472 Test Loss: 0.938 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.053689956665039
Epoch: 11, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.124 Vali Acc: 0.461 Test Loss: 1.124 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9587295055389404
Epoch: 12, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.018 Vali Acc: 0.489 Test Loss: 1.018 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1998591423034668
Epoch: 13, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.006 Vali Acc: 0.472 Test Loss: 1.006 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9586515426635742
Epoch: 14, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.347 Vali Acc: 0.500 Test Loss: 1.347 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1731586456298828
Epoch: 15, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.198 Vali Acc: 0.456 Test Loss: 1.198 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 38012930
model size : 159.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps116_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0990757942199707
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.674 Vali Acc: 0.589 Test Loss: 0.674 Test Acc: 0.589
Validation loss decreased (inf --> -0.588882).  Saving model ...
Epoch: 2 cost time: 1.7084457874298096
Epoch: 2, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.689 Vali Acc: 0.544 Test Loss: 0.689 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2123982906341553
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.872 Vali Acc: 0.500 Test Loss: 0.872 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6137311458587646
Epoch: 4, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.748 Vali Acc: 0.517 Test Loss: 0.748 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2904419898986816
Epoch: 5, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.733 Vali Acc: 0.533 Test Loss: 0.733 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2264902591705322
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.775 Vali Acc: 0.528 Test Loss: 0.775 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7388956546783447
Epoch: 7, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.796 Vali Acc: 0.478 Test Loss: 0.796 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.448993444442749
Epoch: 8, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.986 Vali Acc: 0.439 Test Loss: 0.986 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.495980978012085
Epoch: 9, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.872 Vali Acc: 0.494 Test Loss: 0.872 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.357163906097412
Epoch: 10, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.028 Vali Acc: 0.494 Test Loss: 1.028 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7948946952819824
Epoch: 11, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps116_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 38270210
model size : 160.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.815162420272827
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.711 Vali Acc: 0.500 Test Loss: 0.711 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.2681024074554443
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.678 Vali Acc: 0.556 Test Loss: 0.678 Test Acc: 0.556
Validation loss decreased (-0.499993 --> -0.555549).  Saving model ...
Epoch: 3 cost time: 1.6093497276306152
Epoch: 3, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.676 Vali Acc: 0.578 Test Loss: 0.676 Test Acc: 0.578
Validation loss decreased (-0.555549 --> -0.577771).  Saving model ...
Epoch: 4 cost time: 1.2118892669677734
Epoch: 4, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.751 Vali Acc: 0.489 Test Loss: 0.751 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.035355567932129
Epoch: 5, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.739 Vali Acc: 0.522 Test Loss: 0.739 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.840090274810791
Epoch: 6, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.799 Vali Acc: 0.456 Test Loss: 0.799 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.383018970489502
Epoch: 7, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.798 Vali Acc: 0.511 Test Loss: 0.798 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1377933025360107
Epoch: 8, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.844 Vali Acc: 0.494 Test Loss: 0.844 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7716484069824219
Epoch: 9, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.016 Vali Acc: 0.478 Test Loss: 1.016 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4691307544708252
Epoch: 10, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.974 Vali Acc: 0.494 Test Loss: 0.974 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4117705821990967
Epoch: 11, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.132 Vali Acc: 0.483 Test Loss: 1.132 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.935389518737793
Epoch: 12, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.241 Vali Acc: 0.461 Test Loss: 1.241 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4415054321289062
Epoch: 13, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.137 Vali Acc: 0.522 Test Loss: 1.137 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 38214914
model size : 160.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps116_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1221137046813965
Epoch: 1, Steps: 13 | Train Loss: 0.825 Vali Loss: 0.719 Vali Acc: 0.511 Test Loss: 0.719 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.0901315212249756
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.709 Vali Acc: 0.494 Test Loss: 0.709 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0768606662750244
Epoch: 3, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.696 Vali Acc: 0.533 Test Loss: 0.696 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 0.9549086093902588
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.093695878982544
Epoch: 5, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.732 Vali Acc: 0.511 Test Loss: 0.732 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9960505962371826
Epoch: 6, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.780 Vali Acc: 0.494 Test Loss: 0.780 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8043172359466553
Epoch: 7, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.833 Vali Acc: 0.517 Test Loss: 0.833 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1152772903442383
Epoch: 8, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.819 Vali Acc: 0.467 Test Loss: 0.819 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9256687164306641
Epoch: 9, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.884 Vali Acc: 0.461 Test Loss: 0.884 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8578004837036133
Epoch: 10, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.925 Vali Acc: 0.517 Test Loss: 0.925 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9211883544921875
Epoch: 11, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.040 Vali Acc: 0.506 Test Loss: 1.040 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9376089572906494
Epoch: 12, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.225 Vali Acc: 0.489 Test Loss: 1.225 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.251753568649292
Epoch: 13, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.087 Vali Acc: 0.478 Test Loss: 1.087 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps116_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 38187266
model size : 160.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.923204183578491
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.711 Vali Acc: 0.461 Test Loss: 0.711 Test Acc: 0.461
Validation loss decreased (inf --> -0.461104).  Saving model ...
Epoch: 2 cost time: 1.6149487495422363
Epoch: 2, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.742 Vali Acc: 0.489 Test Loss: 0.742 Test Acc: 0.489
Validation loss decreased (-0.461104 --> -0.488881).  Saving model ...
Epoch: 3 cost time: 2.2592689990997314
Epoch: 3, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.717 Vali Acc: 0.522 Test Loss: 0.717 Test Acc: 0.522
Validation loss decreased (-0.488881 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.738856315612793
Epoch: 4, Steps: 13 | Train Loss: 0.691 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.503359317779541
Epoch: 5, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.768 Vali Acc: 0.506 Test Loss: 0.768 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.829411268234253
Epoch: 6, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.781 Vali Acc: 0.494 Test Loss: 0.781 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.276954174041748
Epoch: 7, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.094 Vali Acc: 0.472 Test Loss: 1.094 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.729257345199585
Epoch: 8, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.004 Vali Acc: 0.461 Test Loss: 1.004 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.751671314239502
Epoch: 9, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.968 Vali Acc: 0.478 Test Loss: 0.968 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4806995391845703
Epoch: 10, Steps: 13 | Train Loss: 0.399 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4511771202087402
Epoch: 11, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.493 Vali Acc: 0.467 Test Loss: 1.493 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4491307735443115
Epoch: 12, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.419 Vali Acc: 0.450 Test Loss: 1.419 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.930840015411377
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.284 Vali Acc: 0.483 Test Loss: 1.284 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 38454530
model size : 161.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7743313312530518
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.722 Vali Acc: 0.483 Test Loss: 0.722 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.027292013168335
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.691 Vali Acc: 0.550 Test Loss: 0.691 Test Acc: 0.550
Validation loss decreased (-0.483326 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 0.9533898830413818
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0178301334381104
Epoch: 4, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.731 Vali Acc: 0.522 Test Loss: 0.731 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6611411571502686
Epoch: 5, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.775 Vali Acc: 0.511 Test Loss: 0.775 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6285254955291748
Epoch: 6, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.807 Vali Acc: 0.478 Test Loss: 0.807 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4802391529083252
Epoch: 7, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.790 Vali Acc: 0.556 Test Loss: 0.790 Test Acc: 0.556
Validation loss decreased (-0.549993 --> -0.555548).  Saving model ...
Epoch: 8 cost time: 1.2975349426269531
Epoch: 8, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.923 Vali Acc: 0.472 Test Loss: 0.923 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5046746730804443
Epoch: 9, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.910 Vali Acc: 0.483 Test Loss: 0.910 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4049291610717773
Epoch: 10, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.083 Vali Acc: 0.528 Test Loss: 1.083 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.390538215637207
Epoch: 11, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.111 Vali Acc: 0.428 Test Loss: 1.111 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6116611957550049
Epoch: 12, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.145 Vali Acc: 0.528 Test Loss: 1.145 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3223984241485596
Epoch: 13, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.241 Vali Acc: 0.489 Test Loss: 1.241 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1076467037200928
Epoch: 14, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1935276985168457
Epoch: 15, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.492 Vali Acc: 0.517 Test Loss: 1.492 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.893770694732666
Epoch: 16, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.551 Vali Acc: 0.467 Test Loss: 1.551 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6042449474334717
Epoch: 17, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.573 Vali Acc: 0.472 Test Loss: 1.573 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 38405378
model size : 161.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.195220947265625
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.709 Vali Acc: 0.483 Test Loss: 0.709 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.017951488494873
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.689 Vali Acc: 0.533 Test Loss: 0.689 Test Acc: 0.533
Validation loss decreased (-0.483326 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.0799601078033447
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.735 Vali Acc: 0.467 Test Loss: 0.735 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.101806402206421
Epoch: 4, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.682 Vali Acc: 0.561 Test Loss: 0.682 Test Acc: 0.561
Validation loss decreased (-0.533326 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 0.9106757640838623
Epoch: 5, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.712 Vali Acc: 0.517 Test Loss: 0.712 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.138108730316162
Epoch: 6, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.731 Vali Acc: 0.517 Test Loss: 0.731 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0700585842132568
Epoch: 7, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.756 Vali Acc: 0.561 Test Loss: 0.756 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8872244358062744
Epoch: 8, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.857 Vali Acc: 0.500 Test Loss: 0.857 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.071455955505371
Epoch: 9, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.892 Vali Acc: 0.544 Test Loss: 0.892 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8878128528594971
Epoch: 10, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.867 Vali Acc: 0.533 Test Loss: 0.867 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8540403842926025
Epoch: 11, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.848 Vali Acc: 0.550 Test Loss: 0.848 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0013127326965332
Epoch: 12, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.943 Vali Acc: 0.494 Test Loss: 0.943 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.872856855392456
Epoch: 13, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.101 Vali Acc: 0.478 Test Loss: 1.101 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7896378040313721
Epoch: 14, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.041 Vali Acc: 0.483 Test Loss: 1.041 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 38380802
model size : 161.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps144_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.309093713760376
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.715 Vali Acc: 0.494 Test Loss: 0.715 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.7612972259521484
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.729 Vali Acc: 0.489 Test Loss: 0.729 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4695603847503662
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.719 Vali Acc: 0.467 Test Loss: 0.719 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4050235748291016
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.757 Vali Acc: 0.456 Test Loss: 0.757 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6774232387542725
Epoch: 5, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.775 Vali Acc: 0.517 Test Loss: 0.775 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516659).  Saving model ...
Epoch: 6 cost time: 1.83437180519104
Epoch: 6, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.779 Vali Acc: 0.428 Test Loss: 0.779 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3200783729553223
Epoch: 7, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.842 Vali Acc: 0.444 Test Loss: 0.842 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.353806734085083
Epoch: 8, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.842 Vali Acc: 0.489 Test Loss: 0.842 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5469763278961182
Epoch: 9, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.956 Vali Acc: 0.478 Test Loss: 0.956 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3420991897583008
Epoch: 10, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.248 Vali Acc: 0.483 Test Loss: 1.248 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.755033254623413
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.453 Vali Acc: 0.467 Test Loss: 1.453 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.373706340789795
Epoch: 12, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.352 Vali Acc: 0.439 Test Loss: 1.352 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8292455673217773
Epoch: 13, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.150 Vali Acc: 0.472 Test Loss: 1.150 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2695677280426025
Epoch: 14, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.489 Vali Acc: 0.494 Test Loss: 1.489 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.533874750137329
Epoch: 15, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.433 Vali Acc: 0.528 Test Loss: 1.433 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527763).  Saving model ...
Epoch: 16 cost time: 1.2145650386810303
Epoch: 16, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.747 Vali Acc: 0.467 Test Loss: 1.747 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3186743259429932
Epoch: 17, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.923 Vali Acc: 0.500 Test Loss: 1.923 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1798961162567139
Epoch: 18, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.883 Vali Acc: 0.539 Test Loss: 1.883 Test Acc: 0.539
Validation loss decreased (-0.527763 --> -0.538870).  Saving model ...
Epoch: 19 cost time: 1.2354779243469238
Epoch: 19, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.973 Vali Acc: 0.517 Test Loss: 1.973 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1624178886413574
Epoch: 20, Steps: 13 | Train Loss: 0.167 Vali Loss: 2.054 Vali Acc: 0.467 Test Loss: 2.054 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1221611499786377
Epoch: 21, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.807 Vali Acc: 0.517 Test Loss: 1.807 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0964038372039795
Epoch: 22, Steps: 13 | Train Loss: 0.093 Vali Loss: 2.630 Vali Acc: 0.450 Test Loss: 2.630 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3359241485595703
Epoch: 23, Steps: 13 | Train Loss: 0.218 Vali Loss: 2.615 Vali Acc: 0.489 Test Loss: 2.615 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2293691635131836
Epoch: 24, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.231 Vali Acc: 0.528 Test Loss: 2.231 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.409367561340332
Epoch: 25, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.554 Vali Acc: 0.483 Test Loss: 2.554 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4169495105743408
Epoch: 26, Steps: 13 | Train Loss: 0.133 Vali Loss: 2.793 Vali Acc: 0.522 Test Loss: 2.793 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3419148921966553
Epoch: 27, Steps: 13 | Train Loss: 0.032 Vali Loss: 3.453 Vali Acc: 0.467 Test Loss: 3.453 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.490816593170166
Epoch: 28, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.895 Vali Acc: 0.511 Test Loss: 2.895 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps144_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 38700290
model size : 162.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps144_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5980641841888428
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.694 Vali Acc: 0.567 Test Loss: 0.694 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 1.2223577499389648
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.700 Vali Acc: 0.533 Test Loss: 0.700 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.061279058456421
Epoch: 3, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.687 Vali Acc: 0.522 Test Loss: 0.687 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1079528331756592
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.693 Vali Acc: 0.483 Test Loss: 0.693 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9284830093383789
Epoch: 5, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.716 Vali Acc: 0.539 Test Loss: 0.716 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3122546672821045
Epoch: 6, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.270059585571289
Epoch: 7, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.805 Vali Acc: 0.561 Test Loss: 0.805 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2199623584747314
Epoch: 8, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.776 Vali Acc: 0.528 Test Loss: 0.776 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4003040790557861
Epoch: 9, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.842 Vali Acc: 0.533 Test Loss: 0.842 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1927855014801025
Epoch: 10, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.926 Vali Acc: 0.533 Test Loss: 0.926 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2807931900024414
Epoch: 11, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.194 Vali Acc: 0.544 Test Loss: 1.194 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps144_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 38657282
model size : 162.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps144_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.708019256591797
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.730 Vali Acc: 0.500 Test Loss: 0.730 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.8131794929504395
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.727 Vali Acc: 0.511 Test Loss: 0.727 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.0829930305480957
Epoch: 3, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.705 Vali Acc: 0.506 Test Loss: 0.705 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9294161796569824
Epoch: 4, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.707 Vali Acc: 0.533 Test Loss: 0.707 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 0.8778245449066162
Epoch: 5, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.724 Vali Acc: 0.461 Test Loss: 0.724 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8748915195465088
Epoch: 6, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.716 Vali Acc: 0.544 Test Loss: 0.716 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544437).  Saving model ...
Epoch: 7 cost time: 0.9998948574066162
Epoch: 7, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.813 Vali Acc: 0.494 Test Loss: 0.813 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0402424335479736
Epoch: 8, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 1.0653376579284668
Epoch: 9, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.910 Vali Acc: 0.567 Test Loss: 0.910 Test Acc: 0.567
Validation loss decreased (-0.549992 --> -0.566658).  Saving model ...
Epoch: 10 cost time: 1.1917059421539307
Epoch: 10, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.895 Vali Acc: 0.506 Test Loss: 0.895 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2276575565338135
Epoch: 11, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.896 Vali Acc: 0.511 Test Loss: 0.896 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0637476444244385
Epoch: 12, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.027 Vali Acc: 0.528 Test Loss: 1.027 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2737021446228027
Epoch: 13, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9761574268341064
Epoch: 14, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.994 Vali Acc: 0.561 Test Loss: 0.994 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0451548099517822
Epoch: 15, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.115 Vali Acc: 0.561 Test Loss: 1.115 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.251641035079956
Epoch: 16, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.010 Vali Acc: 0.556 Test Loss: 1.010 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9830081462860107
Epoch: 17, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.088 Vali Acc: 0.550 Test Loss: 1.088 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1863908767700195
Epoch: 18, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.087 Vali Acc: 0.522 Test Loss: 1.087 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.971534252166748
Epoch: 19, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.201 Vali Acc: 0.517 Test Loss: 1.201 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps144_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 38635778
model size : 162.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps165_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3692920207977295
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.721 Vali Acc: 0.444 Test Loss: 0.721 Test Acc: 0.444
Validation loss decreased (inf --> -0.444437).  Saving model ...
Epoch: 2 cost time: 0.8629746437072754
Epoch: 2, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.717 Vali Acc: 0.550 Test Loss: 0.717 Test Acc: 0.550
Validation loss decreased (-0.444437 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.3442366123199463
Epoch: 3, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.750 Vali Acc: 0.528 Test Loss: 0.750 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9226715564727783
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.758 Vali Acc: 0.478 Test Loss: 0.758 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7626688480377197
Epoch: 5, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.772 Vali Acc: 0.533 Test Loss: 0.772 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0120255947113037
Epoch: 6, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.772 Vali Acc: 0.483 Test Loss: 0.772 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5339868068695068
Epoch: 7, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.971 Vali Acc: 0.522 Test Loss: 0.971 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9267804622650146
Epoch: 8, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.900 Vali Acc: 0.494 Test Loss: 0.900 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.015084743499756
Epoch: 9, Steps: 13 | Train Loss: 0.443 Vali Loss: 1.011 Vali Acc: 0.456 Test Loss: 1.011 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.351341962814331
Epoch: 10, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.123 Vali Acc: 0.522 Test Loss: 1.123 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.581408977508545
Epoch: 11, Steps: 13 | Train Loss: 0.454 Vali Loss: 1.069 Vali Acc: 0.483 Test Loss: 1.069 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1935899257659912
Epoch: 12, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.046 Vali Acc: 0.522 Test Loss: 1.046 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps165_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 39023618
model size : 163.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps165_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.567826986312866
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.693 Vali Acc: 0.506 Test Loss: 0.693 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 0.9109928607940674
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.727 Vali Acc: 0.472 Test Loss: 0.727 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8449997901916504
Epoch: 3, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.685 Vali Acc: 0.578 Test Loss: 0.685 Test Acc: 0.578
Validation loss decreased (-0.505549 --> -0.577771).  Saving model ...
Epoch: 4 cost time: 0.8982186317443848
Epoch: 4, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.713 Vali Acc: 0.489 Test Loss: 0.713 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8573017120361328
Epoch: 5, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.714 Vali Acc: 0.561 Test Loss: 0.714 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9796524047851562
Epoch: 6, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.722 Vali Acc: 0.506 Test Loss: 0.722 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8140344619750977
Epoch: 7, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.787 Vali Acc: 0.494 Test Loss: 0.787 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.108748197555542
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.832 Vali Acc: 0.500 Test Loss: 0.832 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9096584320068359
Epoch: 9, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.806 Vali Acc: 0.494 Test Loss: 0.806 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0583913326263428
Epoch: 10, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.918 Vali Acc: 0.533 Test Loss: 0.918 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9709951877593994
Epoch: 11, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.948 Vali Acc: 0.489 Test Loss: 0.948 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.425445556640625
Epoch: 12, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.040 Vali Acc: 0.494 Test Loss: 1.040 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.108567237854004
Epoch: 13, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.188 Vali Acc: 0.472 Test Loss: 1.188 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps165_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 38986754
model size : 163.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps165_str165_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.530221700668335
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.718 Vali Acc: 0.417 Test Loss: 0.718 Test Acc: 0.417
Validation loss decreased (inf --> -0.416659).  Saving model ...
Epoch: 2 cost time: 1.0982306003570557
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.698 Vali Acc: 0.539 Test Loss: 0.698 Test Acc: 0.539
Validation loss decreased (-0.416659 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.0515613555908203
Epoch: 3, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.717 Vali Acc: 0.483 Test Loss: 0.717 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1567981243133545
Epoch: 4, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.689 Vali Acc: 0.533 Test Loss: 0.689 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.986065149307251
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.690 Vali Acc: 0.539 Test Loss: 0.690 Test Acc: 0.539
Validation loss decreased (-0.538882 --> -0.538882).  Saving model ...
Epoch: 6 cost time: 0.9341487884521484
Epoch: 6, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.716 Vali Acc: 0.522 Test Loss: 0.716 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0815134048461914
Epoch: 7, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.810 Vali Acc: 0.472 Test Loss: 0.810 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.055614709854126
Epoch: 8, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.867 Vali Acc: 0.472 Test Loss: 0.867 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8673412799835205
Epoch: 9, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.852 Vali Acc: 0.544 Test Loss: 0.852 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544436).  Saving model ...
Epoch: 10 cost time: 1.0355021953582764
Epoch: 10, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.950 Vali Acc: 0.472 Test Loss: 0.950 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9389653205871582
Epoch: 11, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.000 Vali Acc: 0.444 Test Loss: 1.000 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0421862602233887
Epoch: 12, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.976 Vali Acc: 0.511 Test Loss: 0.976 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.99283766746521
Epoch: 13, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.116 Vali Acc: 0.539 Test Loss: 1.116 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9571707248687744
Epoch: 14, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.258 Vali Acc: 0.517 Test Loss: 1.258 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8992085456848145
Epoch: 15, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.167 Vali Acc: 0.494 Test Loss: 1.167 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8764448165893555
Epoch: 16, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.221 Vali Acc: 0.511 Test Loss: 1.221 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7842175960540771
Epoch: 17, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.208 Vali Acc: 0.533 Test Loss: 1.208 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1670947074890137
Epoch: 18, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.324 Vali Acc: 0.478 Test Loss: 1.324 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8805508613586426
Epoch: 19, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.421 Vali Acc: 0.506 Test Loss: 1.421 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps165_str165_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 38968322
model size : 163.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps192_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 4.0167763233184814
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.709 Vali Acc: 0.511 Test Loss: 0.709 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.355863094329834
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.737 Vali Acc: 0.494 Test Loss: 0.737 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6128253936767578
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.739 Vali Acc: 0.533 Test Loss: 0.739 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.079627275466919
Epoch: 4, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.720 Vali Acc: 0.511 Test Loss: 0.720 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5134565830230713
Epoch: 5, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.683 Vali Acc: 0.550 Test Loss: 0.683 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 2.150663375854492
Epoch: 6, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.774 Vali Acc: 0.483 Test Loss: 0.774 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.38545560836792
Epoch: 7, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.755 Vali Acc: 0.528 Test Loss: 0.755 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8437025547027588
Epoch: 8, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.900 Vali Acc: 0.467 Test Loss: 0.900 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.029667854309082
Epoch: 9, Steps: 13 | Train Loss: 0.587 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5705420970916748
Epoch: 10, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.979 Vali Acc: 0.489 Test Loss: 0.979 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.262207269668579
Epoch: 11, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.929 Vali Acc: 0.489 Test Loss: 0.929 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9192883968353271
Epoch: 12, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.406 Vali Acc: 0.517 Test Loss: 1.406 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3657138347625732
Epoch: 13, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.372 Vali Acc: 0.478 Test Loss: 1.372 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.443939447402954
Epoch: 14, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.429 Vali Acc: 0.522 Test Loss: 1.429 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.325361728668213
Epoch: 15, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.462 Vali Acc: 0.506 Test Loss: 1.462 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps192_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 39449858
model size : 165.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps192_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5083627700805664
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.696 Vali Acc: 0.522 Test Loss: 0.696 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.8288788795471191
Epoch: 2, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.706 Vali Acc: 0.444 Test Loss: 0.706 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9366054534912109
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.686 Vali Acc: 0.511 Test Loss: 0.686 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0169904232025146
Epoch: 4, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.728 Vali Acc: 0.472 Test Loss: 0.728 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0398778915405273
Epoch: 5, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.758 Vali Acc: 0.533 Test Loss: 0.758 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 1.4481937885284424
Epoch: 6, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.857 Vali Acc: 0.478 Test Loss: 0.857 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1190202236175537
Epoch: 7, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.884 Vali Acc: 0.522 Test Loss: 0.884 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2430078983306885
Epoch: 8, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.956 Vali Acc: 0.517 Test Loss: 0.956 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.406273603439331
Epoch: 9, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.985 Vali Acc: 0.494 Test Loss: 0.985 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.158172607421875
Epoch: 10, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.942 Vali Acc: 0.506 Test Loss: 0.942 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.018540382385254
Epoch: 11, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.006 Vali Acc: 0.494 Test Loss: 1.006 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4891695976257324
Epoch: 12, Steps: 13 | Train Loss: 0.266 Vali Loss: 1.186 Vali Acc: 0.506 Test Loss: 1.186 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1498382091522217
Epoch: 13, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.236 Vali Acc: 0.550 Test Loss: 1.236 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 1.446197748184204
Epoch: 14, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.141 Vali Acc: 0.494 Test Loss: 1.141 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.35829758644104
Epoch: 15, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.631 Vali Acc: 0.494 Test Loss: 1.631 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1338303089141846
Epoch: 16, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.417 Vali Acc: 0.478 Test Loss: 1.417 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.168330192565918
Epoch: 17, Steps: 13 | Train Loss: 0.222 Vali Loss: 1.597 Vali Acc: 0.489 Test Loss: 1.597 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4670798778533936
Epoch: 18, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.408 Vali Acc: 0.517 Test Loss: 1.408 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.076880693435669
Epoch: 19, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.294 Vali Acc: 0.522 Test Loss: 1.294 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.072568655014038
Epoch: 20, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.598 Vali Acc: 0.511 Test Loss: 1.598 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9664502143859863
Epoch: 21, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.391 Vali Acc: 0.494 Test Loss: 1.391 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0492191314697266
Epoch: 22, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.527 Vali Acc: 0.544 Test Loss: 1.527 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1564805507659912
Epoch: 23, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.662 Vali Acc: 0.550 Test Loss: 1.662 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps192_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 39419138
model size : 165.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps192_str192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.64740252494812
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.729 Vali Acc: 0.494 Test Loss: 0.729 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.8487799167633057
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.716 Vali Acc: 0.467 Test Loss: 0.716 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.24025297164917
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.701 Vali Acc: 0.511 Test Loss: 0.701 Test Acc: 0.511
Validation loss decreased (-0.494437 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.114776849746704
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.731 Vali Acc: 0.489 Test Loss: 0.731 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.177168369293213
Epoch: 5, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.756 Vali Acc: 0.511 Test Loss: 0.756 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0300793647766113
Epoch: 6, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.795 Vali Acc: 0.444 Test Loss: 0.795 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8371367454528809
Epoch: 7, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.739 Vali Acc: 0.539 Test Loss: 0.739 Test Acc: 0.539
Validation loss decreased (-0.511104 --> -0.538881).  Saving model ...
Epoch: 8 cost time: 0.7931852340698242
Epoch: 8, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.851 Vali Acc: 0.511 Test Loss: 0.851 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7798628807067871
Epoch: 9, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.969 Vali Acc: 0.556 Test Loss: 0.969 Test Acc: 0.556
Validation loss decreased (-0.538881 --> -0.555546).  Saving model ...
Epoch: 10 cost time: 1.056947946548462
Epoch: 10, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.912 Vali Acc: 0.544 Test Loss: 0.912 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0450658798217773
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.896 Vali Acc: 0.567 Test Loss: 0.896 Test Acc: 0.567
Validation loss decreased (-0.555546 --> -0.566658).  Saving model ...
Epoch: 12 cost time: 1.1173818111419678
Epoch: 12, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.972 Vali Acc: 0.539 Test Loss: 0.972 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1599090099334717
Epoch: 13, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.033 Vali Acc: 0.539 Test Loss: 1.033 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1409165859222412
Epoch: 14, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.153 Vali Acc: 0.528 Test Loss: 1.153 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0168700218200684
Epoch: 15, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1764440536499023
Epoch: 16, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.160 Vali Acc: 0.528 Test Loss: 1.160 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0522921085357666
Epoch: 17, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.101 Vali Acc: 0.517 Test Loss: 1.101 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.099898338317871
Epoch: 18, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.388 Vali Acc: 0.511 Test Loss: 1.388 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.206968069076538
Epoch: 19, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.372 Vali Acc: 0.528 Test Loss: 1.372 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1530396938323975
Epoch: 20, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.631 Vali Acc: 0.433 Test Loss: 1.631 Test Acc: 0.433
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0469903945922852
Epoch: 21, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.341 Vali Acc: 0.550 Test Loss: 1.341 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps192_str192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 39403778
model size : 164.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.193131923675537
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.738 Vali Acc: 0.522 Test Loss: 0.738 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.9907419681549072
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.690 Vali Acc: 0.489 Test Loss: 0.690 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7654805183410645
Epoch: 3, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.721 Vali Acc: 0.528 Test Loss: 0.721 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 0.8469469547271729
Epoch: 4, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.720 Vali Acc: 0.517 Test Loss: 0.720 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9587407112121582
Epoch: 5, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.754 Vali Acc: 0.506 Test Loss: 0.754 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0936923027038574
Epoch: 6, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.792 Vali Acc: 0.533 Test Loss: 0.792 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533325).  Saving model ...
Epoch: 7 cost time: 1.598745346069336
Epoch: 7, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.963 Vali Acc: 0.483 Test Loss: 0.963 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1875216960906982
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.977 Vali Acc: 0.522 Test Loss: 0.977 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5871431827545166
Epoch: 9, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.070 Vali Acc: 0.506 Test Loss: 1.070 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2646405696868896
Epoch: 10, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.097 Vali Acc: 0.489 Test Loss: 1.097 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.722830057144165
Epoch: 11, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.267 Vali Acc: 0.494 Test Loss: 1.267 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.086298942565918
Epoch: 12, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5323021411895752
Epoch: 13, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.247 Vali Acc: 0.517 Test Loss: 1.247 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.983231782913208
Epoch: 14, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.371 Vali Acc: 0.489 Test Loss: 1.371 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7672622203826904
Epoch: 15, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.357 Vali Acc: 0.511 Test Loss: 1.357 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1848199367523193
Epoch: 16, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.627 Vali Acc: 0.517 Test Loss: 1.627 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 40063490
model size : 167.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.747108221054077
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.691 Vali Acc: 0.511 Test Loss: 0.691 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.8601474761962891
Epoch: 2, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.691 Vali Acc: 0.517 Test Loss: 0.691 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 0.8852641582489014
Epoch: 3, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.716 Vali Acc: 0.539 Test Loss: 0.716 Test Acc: 0.539
Validation loss decreased (-0.516660 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 0.936744213104248
Epoch: 4, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.787 Vali Acc: 0.439 Test Loss: 0.787 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9706413745880127
Epoch: 5, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8548579216003418
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.772 Vali Acc: 0.467 Test Loss: 0.772 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8226675987243652
Epoch: 7, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.876 Vali Acc: 0.450 Test Loss: 0.876 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7292964458465576
Epoch: 8, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.891 Vali Acc: 0.450 Test Loss: 0.891 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7198705673217773
Epoch: 9, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.913 Vali Acc: 0.522 Test Loss: 0.913 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8168022632598877
Epoch: 10, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.820 Vali Acc: 0.511 Test Loss: 0.820 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8705415725708008
Epoch: 11, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.042 Vali Acc: 0.528 Test Loss: 1.042 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8347434997558594
Epoch: 12, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.033189296722412
Epoch: 13, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.974 Vali Acc: 0.511 Test Loss: 0.974 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 40038914
model size : 167.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.868256092071533
Epoch: 1, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.695 Vali Acc: 0.506 Test Loss: 0.695 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 1.3379325866699219
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.697 Vali Acc: 0.572 Test Loss: 0.697 Test Acc: 0.572
Validation loss decreased (-0.505549 --> -0.572215).  Saving model ...
Epoch: 3 cost time: 1.121408462524414
Epoch: 3, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.741 Vali Acc: 0.478 Test Loss: 0.741 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.187394618988037
Epoch: 4, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.720 Vali Acc: 0.533 Test Loss: 0.720 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.241241693496704
Epoch: 5, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.768 Vali Acc: 0.511 Test Loss: 0.768 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8493103981018066
Epoch: 6, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.824 Vali Acc: 0.528 Test Loss: 0.824 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1244957447052002
Epoch: 7, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.795 Vali Acc: 0.494 Test Loss: 0.795 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9753427505493164
Epoch: 8, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.873 Vali Acc: 0.544 Test Loss: 0.873 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0466935634613037
Epoch: 9, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.976 Vali Acc: 0.472 Test Loss: 0.976 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1096000671386719
Epoch: 10, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.972 Vali Acc: 0.539 Test Loss: 0.972 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4209930896759033
Epoch: 11, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.039 Vali Acc: 0.483 Test Loss: 1.039 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0971486568450928
Epoch: 12, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.021 Vali Acc: 0.511 Test Loss: 1.021 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el5_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 40026626
model size : 167.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps47_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.897610902786255
Epoch: 1, Steps: 13 | Train Loss: 0.813 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.4346680641174316
Epoch: 2, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.745 Vali Acc: 0.494 Test Loss: 0.745 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.096876621246338
Epoch: 3, Steps: 13 | Train Loss: 0.885 Vali Loss: 0.780 Vali Acc: 0.517 Test Loss: 0.780 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.4903104305267334
Epoch: 4, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.736 Vali Acc: 0.489 Test Loss: 0.736 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6938700675964355
Epoch: 5, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.848 Vali Acc: 0.517 Test Loss: 0.848 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4365243911743164
Epoch: 6, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.812 Vali Acc: 0.511 Test Loss: 0.812 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4465653896331787
Epoch: 7, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.939 Vali Acc: 0.522 Test Loss: 0.939 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522213).  Saving model ...
Epoch: 8 cost time: 1.3339242935180664
Epoch: 8, Steps: 13 | Train Loss: 0.582 Vali Loss: 1.010 Vali Acc: 0.506 Test Loss: 1.010 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3445730209350586
Epoch: 9, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.910 Vali Acc: 0.511 Test Loss: 0.910 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7490406036376953
Epoch: 10, Steps: 13 | Train Loss: 0.587 Vali Loss: 1.190 Vali Acc: 0.478 Test Loss: 1.190 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7850310802459717
Epoch: 11, Steps: 13 | Train Loss: 0.560 Vali Loss: 1.185 Vali Acc: 0.450 Test Loss: 1.185 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7900896072387695
Epoch: 12, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.942 Vali Acc: 0.506 Test Loss: 0.942 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1149840354919434
Epoch: 13, Steps: 13 | Train Loss: 0.626 Vali Loss: 1.566 Vali Acc: 0.478 Test Loss: 1.566 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.681570053100586
Epoch: 14, Steps: 13 | Train Loss: 0.493 Vali Loss: 1.691 Vali Acc: 0.489 Test Loss: 1.691 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.134756326675415
Epoch: 15, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.681 Vali Acc: 0.544 Test Loss: 1.681 Test Acc: 0.544
Validation loss decreased (-0.522213 --> -0.544428).  Saving model ...
Epoch: 16 cost time: 2.046617269515991
Epoch: 16, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.946 Vali Acc: 0.556 Test Loss: 1.946 Test Acc: 0.556
Validation loss decreased (-0.544428 --> -0.555536).  Saving model ...
Epoch: 17 cost time: 2.2041258811950684
Epoch: 17, Steps: 13 | Train Loss: 0.441 Vali Loss: 2.413 Vali Acc: 0.533 Test Loss: 2.413 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9098808765411377
Epoch: 18, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.665 Vali Acc: 0.489 Test Loss: 1.665 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.977360486984253
Epoch: 19, Steps: 13 | Train Loss: 0.392 Vali Loss: 2.014 Vali Acc: 0.550 Test Loss: 2.014 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9531755447387695
Epoch: 20, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.843 Vali Acc: 0.528 Test Loss: 1.843 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.591911792755127
Epoch: 21, Steps: 13 | Train Loss: 0.177 Vali Loss: 2.433 Vali Acc: 0.511 Test Loss: 2.433 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0231595039367676
Epoch: 22, Steps: 13 | Train Loss: 0.112 Vali Loss: 2.916 Vali Acc: 0.478 Test Loss: 2.916 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4260928630828857
Epoch: 23, Steps: 13 | Train Loss: 0.095 Vali Loss: 3.272 Vali Acc: 0.528 Test Loss: 3.272 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7651073932647705
Epoch: 24, Steps: 13 | Train Loss: 0.206 Vali Loss: 3.177 Vali Acc: 0.494 Test Loss: 3.177 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.72454833984375
Epoch: 25, Steps: 13 | Train Loss: 0.125 Vali Loss: 3.832 Vali Acc: 0.483 Test Loss: 3.832 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8155174255371094
Epoch: 26, Steps: 13 | Train Loss: 0.117 Vali Loss: 3.370 Vali Acc: 0.472 Test Loss: 3.370 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps47_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 30244610
model size : 130.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps47_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1404671669006348
Epoch: 1, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.2767255306243896
Epoch: 2, Steps: 13 | Train Loss: 0.797 Vali Loss: 0.767 Vali Acc: 0.506 Test Loss: 0.767 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.4009137153625488
Epoch: 3, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.711 Vali Acc: 0.528 Test Loss: 0.711 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 1.6024866104125977
Epoch: 4, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.693 Vali Acc: 0.511 Test Loss: 0.693 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4147694110870361
Epoch: 5, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.717 Vali Acc: 0.517 Test Loss: 0.717 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3501250743865967
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.763 Vali Acc: 0.511 Test Loss: 0.763 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3313543796539307
Epoch: 7, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.860 Vali Acc: 0.489 Test Loss: 0.860 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0523974895477295
Epoch: 8, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.967 Vali Acc: 0.489 Test Loss: 0.967 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7807347774505615
Epoch: 9, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.811 Vali Acc: 0.489 Test Loss: 0.811 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8737585544586182
Epoch: 10, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.836 Vali Acc: 0.533 Test Loss: 0.836 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533325).  Saving model ...
Epoch: 11 cost time: 1.169480562210083
Epoch: 11, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.032 Vali Acc: 0.561 Test Loss: 1.032 Test Acc: 0.561
Validation loss decreased (-0.533325 --> -0.561101).  Saving model ...
Epoch: 12 cost time: 1.5595736503601074
Epoch: 12, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.953 Vali Acc: 0.506 Test Loss: 0.953 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0275661945343018
Epoch: 13, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.086 Vali Acc: 0.506 Test Loss: 1.086 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2528233528137207
Epoch: 14, Steps: 13 | Train Loss: 0.351 Vali Loss: 1.785 Vali Acc: 0.517 Test Loss: 1.785 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1560664176940918
Epoch: 15, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.713 Vali Acc: 0.572 Test Loss: 1.713 Test Acc: 0.572
Validation loss decreased (-0.561101 --> -0.572205).  Saving model ...
Epoch: 16 cost time: 1.0202815532684326
Epoch: 16, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.632 Vali Acc: 0.550 Test Loss: 1.632 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7680060863494873
Epoch: 17, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.501 Vali Acc: 0.500 Test Loss: 1.501 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2110185623168945
Epoch: 18, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.924 Vali Acc: 0.567 Test Loss: 1.924 Test Acc: 0.567
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.684051752090454
Epoch: 19, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.959 Vali Acc: 0.550 Test Loss: 1.959 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2278916835784912
Epoch: 20, Steps: 13 | Train Loss: 0.205 Vali Loss: 2.129 Vali Acc: 0.528 Test Loss: 2.129 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3367412090301514
Epoch: 21, Steps: 13 | Train Loss: 0.149 Vali Loss: 2.436 Vali Acc: 0.511 Test Loss: 2.436 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7851481437683105
Epoch: 22, Steps: 13 | Train Loss: 0.227 Vali Loss: 2.306 Vali Acc: 0.567 Test Loss: 2.306 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0802428722381592
Epoch: 23, Steps: 13 | Train Loss: 0.123 Vali Loss: 2.646 Vali Acc: 0.522 Test Loss: 2.646 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3648903369903564
Epoch: 24, Steps: 13 | Train Loss: 0.072 Vali Loss: 2.612 Vali Acc: 0.561 Test Loss: 2.612 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2768809795379639
Epoch: 25, Steps: 13 | Train Loss: 0.104 Vali Loss: 2.468 Vali Acc: 0.578 Test Loss: 2.468 Test Acc: 0.578
Validation loss decreased (-0.572205 --> -0.577753).  Saving model ...
Epoch: 26 cost time: 1.1774940490722656
Epoch: 26, Steps: 13 | Train Loss: 0.067 Vali Loss: 2.591 Vali Acc: 0.517 Test Loss: 2.591 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4252305030822754
Epoch: 27, Steps: 13 | Train Loss: 0.048 Vali Loss: 3.038 Vali Acc: 0.539 Test Loss: 3.038 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4912278652191162
Epoch: 28, Steps: 13 | Train Loss: 0.204 Vali Loss: 2.683 Vali Acc: 0.556 Test Loss: 2.683 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1905219554901123
Epoch: 29, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.723 Vali Acc: 0.494 Test Loss: 2.723 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.336857557296753
Epoch: 30, Steps: 13 | Train Loss: 0.043 Vali Loss: 2.900 Vali Acc: 0.544 Test Loss: 2.900 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3386952877044678
Epoch: 31, Steps: 13 | Train Loss: 0.098 Vali Loss: 3.033 Vali Acc: 0.544 Test Loss: 3.033 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6441423892974854
Epoch: 32, Steps: 13 | Train Loss: 0.074 Vali Loss: 2.990 Vali Acc: 0.539 Test Loss: 2.990 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4944255352020264
Epoch: 33, Steps: 13 | Train Loss: 0.036 Vali Loss: 3.924 Vali Acc: 0.556 Test Loss: 3.924 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.432603359222412
Epoch: 34, Steps: 13 | Train Loss: 0.224 Vali Loss: 2.626 Vali Acc: 0.506 Test Loss: 2.626 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.462583065032959
Epoch: 35, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.704 Vali Acc: 0.500 Test Loss: 2.704 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps47_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 30103298
model size : 129.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps47_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8586792945861816
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.9327363967895508
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.687 Vali Acc: 0.533 Test Loss: 0.687 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.2110648155212402
Epoch: 3, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.757 Vali Acc: 0.483 Test Loss: 0.757 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2310504913330078
Epoch: 4, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.710 Vali Acc: 0.517 Test Loss: 0.710 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9490656852722168
Epoch: 5, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6601946353912354
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.771 Vali Acc: 0.533 Test Loss: 0.771 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1244029998779297
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.890 Vali Acc: 0.517 Test Loss: 0.890 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1951324939727783
Epoch: 8, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.953 Vali Acc: 0.506 Test Loss: 0.953 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0963184833526611
Epoch: 9, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.905 Vali Acc: 0.539 Test Loss: 0.905 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538880).  Saving model ...
Epoch: 10 cost time: 1.5305027961730957
Epoch: 10, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7176909446716309
Epoch: 11, Steps: 13 | Train Loss: 0.415 Vali Loss: 1.012 Vali Acc: 0.539 Test Loss: 1.012 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3814740180969238
Epoch: 12, Steps: 13 | Train Loss: 0.385 Vali Loss: 1.063 Vali Acc: 0.522 Test Loss: 1.063 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8009240627288818
Epoch: 13, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.131 Vali Acc: 0.533 Test Loss: 1.131 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2328922748565674
Epoch: 14, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.303 Vali Acc: 0.517 Test Loss: 1.303 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5903196334838867
Epoch: 15, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.175 Vali Acc: 0.522 Test Loss: 1.175 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2354114055633545
Epoch: 16, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.393 Vali Acc: 0.544 Test Loss: 1.393 Test Acc: 0.544
Validation loss decreased (-0.538880 --> -0.544431).  Saving model ...
Epoch: 17 cost time: 1.4115142822265625
Epoch: 17, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.562 Vali Acc: 0.467 Test Loss: 1.562 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5898175239562988
Epoch: 18, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3378856182098389
Epoch: 19, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.520 Vali Acc: 0.539 Test Loss: 1.520 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.579268217086792
Epoch: 20, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.784 Vali Acc: 0.472 Test Loss: 1.784 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3222429752349854
Epoch: 21, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.779 Vali Acc: 0.444 Test Loss: 1.779 Test Acc: 0.444
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3099086284637451
Epoch: 22, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.571 Vali Acc: 0.511 Test Loss: 1.571 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.396939754486084
Epoch: 23, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.669 Vali Acc: 0.506 Test Loss: 1.669 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2022664546966553
Epoch: 24, Steps: 13 | Train Loss: 0.066 Vali Loss: 2.069 Vali Acc: 0.494 Test Loss: 2.069 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3939812183380127
Epoch: 25, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.021 Vali Acc: 0.456 Test Loss: 2.021 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3809382915496826
Epoch: 26, Steps: 13 | Train Loss: 0.090 Vali Loss: 2.321 Vali Acc: 0.489 Test Loss: 2.321 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps47_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 30032642
model size : 129.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5384109020233154
Epoch: 1, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.706 Vali Acc: 0.517 Test Loss: 0.706 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.5515851974487305
Epoch: 2, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2008299827575684
Epoch: 3, Steps: 13 | Train Loss: 0.776 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5561885833740234
Epoch: 4, Steps: 13 | Train Loss: 0.943 Vali Loss: 0.712 Vali Acc: 0.567 Test Loss: 0.712 Test Acc: 0.567
Validation loss decreased (-0.516660 --> -0.566660).  Saving model ...
Epoch: 5 cost time: 2.1825857162475586
Epoch: 5, Steps: 13 | Train Loss: 0.797 Vali Loss: 0.804 Vali Acc: 0.489 Test Loss: 0.804 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.220419406890869
Epoch: 6, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.748 Vali Acc: 0.517 Test Loss: 0.748 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.268552541732788
Epoch: 7, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.787 Vali Acc: 0.517 Test Loss: 0.787 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9991116523742676
Epoch: 8, Steps: 13 | Train Loss: 0.628 Vali Loss: 1.321 Vali Acc: 0.483 Test Loss: 1.321 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4008731842041016
Epoch: 9, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.868 Vali Acc: 0.550 Test Loss: 0.868 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.123234510421753
Epoch: 10, Steps: 13 | Train Loss: 0.559 Vali Loss: 1.026 Vali Acc: 0.506 Test Loss: 1.026 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7271084785461426
Epoch: 11, Steps: 13 | Train Loss: 0.704 Vali Loss: 1.092 Vali Acc: 0.489 Test Loss: 1.092 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8812928199768066
Epoch: 12, Steps: 13 | Train Loss: 0.427 Vali Loss: 1.538 Vali Acc: 0.494 Test Loss: 1.538 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3464624881744385
Epoch: 13, Steps: 13 | Train Loss: 0.275 Vali Loss: 1.555 Vali Acc: 0.528 Test Loss: 1.555 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.915454387664795
Epoch: 14, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.673 Vali Acc: 0.522 Test Loss: 1.673 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 30260738
model size : 130.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2224345207214355
Epoch: 1, Steps: 13 | Train Loss: 0.847 Vali Loss: 0.775 Vali Acc: 0.517 Test Loss: 0.775 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.9807660579681396
Epoch: 2, Steps: 13 | Train Loss: 0.817 Vali Loss: 0.892 Vali Acc: 0.500 Test Loss: 0.892 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5622000694274902
Epoch: 3, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.741 Vali Acc: 0.517 Test Loss: 0.741 Test Acc: 0.517
Validation loss decreased (-0.516659 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.4406189918518066
Epoch: 4, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.712 Vali Acc: 0.511 Test Loss: 0.712 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7351877689361572
Epoch: 5, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5776169300079346
Epoch: 6, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.753 Vali Acc: 0.522 Test Loss: 0.753 Test Acc: 0.522
Validation loss decreased (-0.516659 --> -0.522215).  Saving model ...
Epoch: 7 cost time: 1.931617259979248
Epoch: 7, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.804 Vali Acc: 0.483 Test Loss: 0.804 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.404517412185669
Epoch: 8, Steps: 13 | Train Loss: 0.665 Vali Loss: 1.056 Vali Acc: 0.483 Test Loss: 1.056 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2320976257324219
Epoch: 9, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.797 Vali Acc: 0.461 Test Loss: 0.797 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2874066829681396
Epoch: 10, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.881 Vali Acc: 0.511 Test Loss: 0.881 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.170783519744873
Epoch: 11, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.045 Vali Acc: 0.511 Test Loss: 1.045 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.117276191711426
Epoch: 12, Steps: 13 | Train Loss: 0.528 Vali Loss: 1.251 Vali Acc: 0.506 Test Loss: 1.251 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5468621253967285
Epoch: 13, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.998 Vali Acc: 0.472 Test Loss: 0.998 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.679062843322754
Epoch: 14, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5550503730773926
Epoch: 15, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.455 Vali Acc: 0.489 Test Loss: 1.455 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5052249431610107
Epoch: 16, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.865 Vali Acc: 0.544 Test Loss: 1.865 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544426).  Saving model ...
Epoch: 17 cost time: 1.4589040279388428
Epoch: 17, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.563 Vali Acc: 0.489 Test Loss: 1.563 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1769521236419678
Epoch: 18, Steps: 13 | Train Loss: 0.400 Vali Loss: 2.072 Vali Acc: 0.456 Test Loss: 2.072 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5892610549926758
Epoch: 19, Steps: 13 | Train Loss: 0.373 Vali Loss: 1.782 Vali Acc: 0.517 Test Loss: 1.782 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3758103847503662
Epoch: 20, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.822 Vali Acc: 0.472 Test Loss: 1.822 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5936291217803955
Epoch: 21, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.805 Vali Acc: 0.528 Test Loss: 1.805 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.144500494003296
Epoch: 22, Steps: 13 | Train Loss: 0.155 Vali Loss: 2.141 Vali Acc: 0.528 Test Loss: 2.141 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.970299243927002
Epoch: 23, Steps: 13 | Train Loss: 0.190 Vali Loss: 2.463 Vali Acc: 0.500 Test Loss: 2.463 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5260324478149414
Epoch: 24, Steps: 13 | Train Loss: 0.130 Vali Loss: 2.526 Vali Acc: 0.500 Test Loss: 2.526 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.345684289932251
Epoch: 25, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.822 Vali Acc: 0.472 Test Loss: 2.822 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.235917329788208
Epoch: 26, Steps: 13 | Train Loss: 0.217 Vali Loss: 2.393 Vali Acc: 0.528 Test Loss: 2.393 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 30119426
model size : 129.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3823165893554688
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.715 Vali Acc: 0.472 Test Loss: 0.715 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.2538604736328125
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
Validation loss decreased (-0.472215 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.7001168727874756
Epoch: 3, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.674 Vali Acc: 0.556 Test Loss: 0.674 Test Acc: 0.556
Validation loss decreased (-0.499993 --> -0.555549).  Saving model ...
Epoch: 4 cost time: 1.3955578804016113
Epoch: 4, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.728 Vali Acc: 0.533 Test Loss: 0.728 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6987602710723877
Epoch: 5, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.754 Vali Acc: 0.528 Test Loss: 0.754 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1660444736480713
Epoch: 6, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.936 Vali Acc: 0.494 Test Loss: 0.936 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4437639713287354
Epoch: 7, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.735 Vali Acc: 0.517 Test Loss: 0.735 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7310771942138672
Epoch: 8, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.959 Vali Acc: 0.511 Test Loss: 0.959 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2014245986938477
Epoch: 9, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.783 Vali Acc: 0.489 Test Loss: 0.783 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2165956497192383
Epoch: 10, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.967 Vali Acc: 0.506 Test Loss: 0.967 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.001023530960083
Epoch: 11, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.993 Vali Acc: 0.489 Test Loss: 0.993 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0456163883209229
Epoch: 12, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.927 Vali Acc: 0.494 Test Loss: 0.927 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.995980978012085
Epoch: 13, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 30048770
model size : 129.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3511478900909424
Epoch: 1, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.775 Vali Acc: 0.500 Test Loss: 0.775 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4345099925994873
Epoch: 2, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.856 Vali Acc: 0.511 Test Loss: 0.856 Test Acc: 0.511
Validation loss decreased (-0.499992 --> -0.511103).  Saving model ...
Epoch: 3 cost time: 2.0044643878936768
Epoch: 3, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.692 Vali Acc: 0.539 Test Loss: 0.692 Test Acc: 0.539
Validation loss decreased (-0.511103 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.5478150844573975
Epoch: 4, Steps: 13 | Train Loss: 0.873 Vali Loss: 0.837 Vali Acc: 0.511 Test Loss: 0.837 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7318692207336426
Epoch: 5, Steps: 13 | Train Loss: 0.799 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5090677738189697
Epoch: 6, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.811 Vali Acc: 0.528 Test Loss: 0.811 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5624582767486572
Epoch: 7, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.806 Vali Acc: 0.522 Test Loss: 0.806 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.166691780090332
Epoch: 8, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.934 Vali Acc: 0.528 Test Loss: 0.934 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.716238021850586
Epoch: 9, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 2.2521257400512695
Epoch: 10, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.940 Vali Acc: 0.506 Test Loss: 0.940 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6235990524291992
Epoch: 11, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.094 Vali Acc: 0.517 Test Loss: 1.094 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4128353595733643
Epoch: 12, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.089 Vali Acc: 0.489 Test Loss: 1.089 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1422131061553955
Epoch: 13, Steps: 13 | Train Loss: 0.360 Vali Loss: 1.376 Vali Acc: 0.500 Test Loss: 1.376 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5660102367401123
Epoch: 14, Steps: 13 | Train Loss: 0.287 Vali Loss: 2.220 Vali Acc: 0.539 Test Loss: 2.220 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9347412586212158
Epoch: 15, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.605 Vali Acc: 0.467 Test Loss: 1.605 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5108461380004883
Epoch: 16, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.837 Vali Acc: 0.522 Test Loss: 1.837 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4583134651184082
Epoch: 17, Steps: 13 | Train Loss: 0.264 Vali Loss: 2.198 Vali Acc: 0.511 Test Loss: 2.198 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.716243028640747
Epoch: 18, Steps: 13 | Train Loss: 0.229 Vali Loss: 2.819 Vali Acc: 0.517 Test Loss: 2.819 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.478651762008667
Epoch: 19, Steps: 13 | Train Loss: 0.305 Vali Loss: 2.946 Vali Acc: 0.550 Test Loss: 2.946 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30284546
model size : 130.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.170586347579956
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.862 Vali Acc: 0.500 Test Loss: 0.862 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.9197773933410645
Epoch: 2, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.703 Vali Acc: 0.556 Test Loss: 0.703 Test Acc: 0.556
Validation loss decreased (-0.499991 --> -0.555549).  Saving model ...
Epoch: 3 cost time: 1.7932398319244385
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.722 Vali Acc: 0.511 Test Loss: 0.722 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.414696455001831
Epoch: 4, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.73061203956604
Epoch: 5, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.710 Vali Acc: 0.489 Test Loss: 0.710 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3072879314422607
Epoch: 6, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.781 Vali Acc: 0.483 Test Loss: 0.781 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2292518615722656
Epoch: 7, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.797 Vali Acc: 0.528 Test Loss: 0.797 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4010002613067627
Epoch: 8, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.758 Vali Acc: 0.511 Test Loss: 0.758 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4772372245788574
Epoch: 9, Steps: 13 | Train Loss: 0.562 Vali Loss: 1.181 Vali Acc: 0.494 Test Loss: 1.181 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9938967227935791
Epoch: 10, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.843 Vali Acc: 0.533 Test Loss: 0.843 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7860920429229736
Epoch: 11, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.317 Vali Acc: 0.472 Test Loss: 1.317 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5673093795776367
Epoch: 12, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.959 Vali Acc: 0.472 Test Loss: 0.959 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 30155522
model size : 129.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.050506591796875
Epoch: 1, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.719 Vali Acc: 0.511 Test Loss: 0.719 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.4841649532318115
Epoch: 2, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.727 Vali Acc: 0.461 Test Loss: 0.727 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3928751945495605
Epoch: 3, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.742 Vali Acc: 0.494 Test Loss: 0.742 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7136940956115723
Epoch: 4, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.809 Vali Acc: 0.494 Test Loss: 0.809 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4610819816589355
Epoch: 5, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.724 Vali Acc: 0.489 Test Loss: 0.724 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7761881351470947
Epoch: 6, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.771 Vali Acc: 0.500 Test Loss: 0.771 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4791765213012695
Epoch: 7, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.803 Vali Acc: 0.422 Test Loss: 0.803 Test Acc: 0.422
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0542128086090088
Epoch: 8, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.722 Vali Acc: 0.522 Test Loss: 0.722 Test Acc: 0.522
Validation loss decreased (-0.511104 --> -0.522215).  Saving model ...
Epoch: 9 cost time: 1.7516100406646729
Epoch: 9, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.841 Vali Acc: 0.550 Test Loss: 0.841 Test Acc: 0.550
Validation loss decreased (-0.522215 --> -0.549992).  Saving model ...
Epoch: 10 cost time: 1.4802415370941162
Epoch: 10, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.896 Vali Acc: 0.467 Test Loss: 0.896 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.517413854598999
Epoch: 11, Steps: 13 | Train Loss: 0.522 Vali Loss: 1.044 Vali Acc: 0.506 Test Loss: 1.044 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.512044906616211
Epoch: 12, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.021 Vali Acc: 0.550 Test Loss: 1.021 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.429316520690918
Epoch: 13, Steps: 13 | Train Loss: 0.434 Vali Loss: 1.185 Vali Acc: 0.489 Test Loss: 1.185 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1059174537658691
Epoch: 14, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.024 Vali Acc: 0.489 Test Loss: 1.024 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2040126323699951
Epoch: 15, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.992 Vali Acc: 0.456 Test Loss: 0.992 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.223280906677246
Epoch: 16, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.116 Vali Acc: 0.511 Test Loss: 1.116 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.194883108139038
Epoch: 17, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.068251371383667
Epoch: 18, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.349 Vali Acc: 0.483 Test Loss: 1.349 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1561212539672852
Epoch: 19, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.850 Vali Acc: 0.489 Test Loss: 1.850 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30091010
model size : 129.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.6059393882751465
Epoch: 1, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.6091465950012207
Epoch: 2, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.765 Vali Acc: 0.494 Test Loss: 0.765 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3871502876281738
Epoch: 3, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.912 Vali Acc: 0.517 Test Loss: 0.912 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516658).  Saving model ...
Epoch: 4 cost time: 2.145968437194824
Epoch: 4, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.809 Vali Acc: 0.478 Test Loss: 0.809 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.644935131072998
Epoch: 5, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.935 Vali Acc: 0.494 Test Loss: 0.935 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1237690448760986
Epoch: 6, Steps: 13 | Train Loss: 0.610 Vali Loss: 1.021 Vali Acc: 0.517 Test Loss: 1.021 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.780994176864624
Epoch: 7, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.932 Vali Acc: 0.522 Test Loss: 0.932 Test Acc: 0.522
Validation loss decreased (-0.516658 --> -0.522213).  Saving model ...
Epoch: 8 cost time: 2.0639255046844482
Epoch: 8, Steps: 13 | Train Loss: 0.517 Vali Loss: 1.116 Vali Acc: 0.506 Test Loss: 1.116 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.657114028930664
Epoch: 9, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.047 Vali Acc: 0.511 Test Loss: 1.047 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1640191078186035
Epoch: 10, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.109 Vali Acc: 0.506 Test Loss: 1.109 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5299482345581055
Epoch: 11, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.501 Vali Acc: 0.461 Test Loss: 1.501 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6068229675292969
Epoch: 12, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.722 Vali Acc: 0.506 Test Loss: 1.722 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.551990270614624
Epoch: 13, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.968 Vali Acc: 0.478 Test Loss: 1.968 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2210845947265625
Epoch: 14, Steps: 13 | Train Loss: 0.347 Vali Loss: 2.583 Vali Acc: 0.472 Test Loss: 2.583 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5190610885620117
Epoch: 15, Steps: 13 | Train Loss: 0.643 Vali Loss: 2.107 Vali Acc: 0.522 Test Loss: 2.107 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4579031467437744
Epoch: 16, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.995 Vali Acc: 0.472 Test Loss: 1.995 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.12882137298584
Epoch: 17, Steps: 13 | Train Loss: 0.221 Vali Loss: 2.706 Vali Acc: 0.411 Test Loss: 2.706 Test Acc: 0.411
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 30298370
model size : 130.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1507551670074463
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.734 Vali Acc: 0.494 Test Loss: 0.734 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.6290040016174316
Epoch: 2, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.780 Vali Acc: 0.506 Test Loss: 0.780 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.4181413650512695
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.712 Vali Acc: 0.517 Test Loss: 0.712 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.6739535331726074
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.688 Vali Acc: 0.544 Test Loss: 0.688 Test Acc: 0.544
Validation loss decreased (-0.516660 --> -0.544438).  Saving model ...
Epoch: 5 cost time: 1.4700779914855957
Epoch: 5, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.695 Vali Acc: 0.578 Test Loss: 0.695 Test Acc: 0.578
Validation loss decreased (-0.544438 --> -0.577771).  Saving model ...
Epoch: 6 cost time: 2.082043170928955
Epoch: 6, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.717 Vali Acc: 0.511 Test Loss: 0.717 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4425201416015625
Epoch: 7, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.699 Vali Acc: 0.556 Test Loss: 0.699 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1446385383605957
Epoch: 8, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.732 Vali Acc: 0.511 Test Loss: 0.732 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7732832431793213
Epoch: 9, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.875 Vali Acc: 0.506 Test Loss: 0.875 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3043527603149414
Epoch: 10, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.987 Vali Acc: 0.494 Test Loss: 0.987 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6668508052825928
Epoch: 11, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.847 Vali Acc: 0.506 Test Loss: 0.847 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2132291793823242
Epoch: 12, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.890 Vali Acc: 0.506 Test Loss: 0.890 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8878278732299805
Epoch: 13, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.102 Vali Acc: 0.572 Test Loss: 1.102 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2864201068878174
Epoch: 14, Steps: 13 | Train Loss: 0.359 Vali Loss: 1.395 Vali Acc: 0.506 Test Loss: 1.395 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.713468313217163
Epoch: 15, Steps: 13 | Train Loss: 0.447 Vali Loss: 1.147 Vali Acc: 0.511 Test Loss: 1.147 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 30181634
model size : 129.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1155669689178467
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.721 Vali Acc: 0.483 Test Loss: 0.721 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.3625731468200684
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.729 Vali Acc: 0.500 Test Loss: 0.729 Test Acc: 0.500
Validation loss decreased (-0.483326 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.196019172668457
Epoch: 3, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.760 Vali Acc: 0.522 Test Loss: 0.760 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.7028827667236328
Epoch: 4, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.746 Vali Acc: 0.461 Test Loss: 0.746 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3151583671569824
Epoch: 5, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.722 Vali Acc: 0.494 Test Loss: 0.722 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8064334392547607
Epoch: 6, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.704 Vali Acc: 0.567 Test Loss: 0.704 Test Acc: 0.567
Validation loss decreased (-0.522215 --> -0.566660).  Saving model ...
Epoch: 7 cost time: 1.4556677341461182
Epoch: 7, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.797 Vali Acc: 0.494 Test Loss: 0.797 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0677711963653564
Epoch: 8, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.740 Vali Acc: 0.506 Test Loss: 0.740 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.183692455291748
Epoch: 9, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.796 Vali Acc: 0.472 Test Loss: 0.796 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.125365972518921
Epoch: 10, Steps: 13 | Train Loss: 0.532 Vali Loss: 1.152 Vali Acc: 0.517 Test Loss: 1.152 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8151640892028809
Epoch: 11, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.927 Vali Acc: 0.467 Test Loss: 0.927 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2710487842559814
Epoch: 12, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.984 Vali Acc: 0.478 Test Loss: 0.984 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0500380992889404
Epoch: 13, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.056 Vali Acc: 0.478 Test Loss: 1.056 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.228881597518921
Epoch: 14, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.152 Vali Acc: 0.489 Test Loss: 1.152 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3029558658599854
Epoch: 15, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.161 Vali Acc: 0.533 Test Loss: 1.161 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1653778553009033
Epoch: 16, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.415 Vali Acc: 0.489 Test Loss: 1.415 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 30120194
model size : 129.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.973468065261841
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.759 Vali Acc: 0.506 Test Loss: 0.759 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 1.553407907485962
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.777 Vali Acc: 0.528 Test Loss: 0.777 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527770).  Saving model ...
Epoch: 3 cost time: 2.076537847518921
Epoch: 3, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.834 Vali Acc: 0.506 Test Loss: 0.834 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4085750579833984
Epoch: 4, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.786 Vali Acc: 0.506 Test Loss: 0.786 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9368236064910889
Epoch: 5, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.747 Vali Acc: 0.517 Test Loss: 0.747 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7004234790802002
Epoch: 6, Steps: 13 | Train Loss: 0.681 Vali Loss: 1.037 Vali Acc: 0.511 Test Loss: 1.037 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.383206844329834
Epoch: 7, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.818 Vali Acc: 0.489 Test Loss: 0.818 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1229872703552246
Epoch: 8, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.820 Vali Acc: 0.467 Test Loss: 0.820 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.865558385848999
Epoch: 9, Steps: 13 | Train Loss: 0.590 Vali Loss: 1.083 Vali Acc: 0.444 Test Loss: 1.083 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.604557752609253
Epoch: 10, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.955 Vali Acc: 0.544 Test Loss: 0.955 Test Acc: 0.544
Validation loss decreased (-0.527770 --> -0.544435).  Saving model ...
Epoch: 11 cost time: 1.841862678527832
Epoch: 11, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.227 Vali Acc: 0.506 Test Loss: 1.227 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.052511215209961
Epoch: 12, Steps: 13 | Train Loss: 0.426 Vali Loss: 1.260 Vali Acc: 0.511 Test Loss: 1.260 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0999464988708496
Epoch: 13, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.363 Vali Acc: 0.506 Test Loss: 1.363 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1014745235443115
Epoch: 14, Steps: 13 | Train Loss: 0.600 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1385231018066406
Epoch: 15, Steps: 13 | Train Loss: 0.580 Vali Loss: 1.616 Vali Acc: 0.506 Test Loss: 1.616 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.745629072189331
Epoch: 16, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.508 Vali Acc: 0.478 Test Loss: 1.508 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8229091167449951
Epoch: 17, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.545 Vali Acc: 0.506 Test Loss: 1.545 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.094278573989868
Epoch: 18, Steps: 13 | Train Loss: 0.157 Vali Loss: 2.346 Vali Acc: 0.511 Test Loss: 2.346 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4369094371795654
Epoch: 19, Steps: 13 | Train Loss: 0.363 Vali Loss: 2.055 Vali Acc: 0.533 Test Loss: 2.055 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8096942901611328
Epoch: 20, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.737 Vali Acc: 0.544 Test Loss: 1.737 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 30330626
model size : 130.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7487823963165283
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 1.223867416381836
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.746 Vali Acc: 0.522 Test Loss: 0.746 Test Acc: 0.522
Validation loss decreased (-0.499991 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.9106268882751465
Epoch: 3, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4475607872009277
Epoch: 4, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.719 Vali Acc: 0.483 Test Loss: 0.719 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.21061372756958
Epoch: 5, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.801332712173462
Epoch: 6, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.870 Vali Acc: 0.494 Test Loss: 0.870 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.758009433746338
Epoch: 7, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.944 Vali Acc: 0.500 Test Loss: 0.944 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5472996234893799
Epoch: 8, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.817 Vali Acc: 0.511 Test Loss: 0.817 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5888454914093018
Epoch: 9, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.854 Vali Acc: 0.506 Test Loss: 0.854 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4320428371429443
Epoch: 10, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.876 Vali Acc: 0.522 Test Loss: 0.876 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7614033222198486
Epoch: 11, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.992 Vali Acc: 0.489 Test Loss: 0.992 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1546745300292969
Epoch: 12, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.312 Vali Acc: 0.511 Test Loss: 1.312 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5222222222222223
model parameter : 30210818
model size : 129.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.873465061187744
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.5891289710998535
Epoch: 2, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.738 Vali Acc: 0.450 Test Loss: 0.738 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3984301090240479
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 1.2575485706329346
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.737 Vali Acc: 0.461 Test Loss: 0.737 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.23795485496521
Epoch: 5, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.761 Vali Acc: 0.494 Test Loss: 0.761 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8396775722503662
Epoch: 6, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.719 Vali Acc: 0.517 Test Loss: 0.719 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516659).  Saving model ...
Epoch: 7 cost time: 1.227095127105713
Epoch: 7, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.760 Vali Acc: 0.539 Test Loss: 0.760 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538881).  Saving model ...
Epoch: 8 cost time: 0.8777432441711426
Epoch: 8, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.782 Vali Acc: 0.472 Test Loss: 0.782 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8039124011993408
Epoch: 9, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.937 Vali Acc: 0.483 Test Loss: 0.937 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.884589433670044
Epoch: 10, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.941 Vali Acc: 0.478 Test Loss: 0.941 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9193174839019775
Epoch: 11, Steps: 13 | Train Loss: 0.596 Vali Loss: 1.012 Vali Acc: 0.461 Test Loss: 1.012 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8466541767120361
Epoch: 12, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.050 Vali Acc: 0.472 Test Loss: 1.050 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7461802959442139
Epoch: 13, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.209 Vali Acc: 0.439 Test Loss: 1.209 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9431345462799072
Epoch: 14, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.581 Vali Acc: 0.494 Test Loss: 1.581 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9292197227478027
Epoch: 15, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.424 Vali Acc: 0.478 Test Loss: 1.424 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9562876224517822
Epoch: 16, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.442 Vali Acc: 0.461 Test Loss: 1.442 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8312294483184814
Epoch: 17, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.309 Vali Acc: 0.483 Test Loss: 1.309 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 30149378
model size : 129.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2519309520721436
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.740 Vali Acc: 0.517 Test Loss: 0.740 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 2.056953191757202
Epoch: 2, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.745 Vali Acc: 0.517 Test Loss: 0.745 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6445515155792236
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.737 Vali Acc: 0.539 Test Loss: 0.737 Test Acc: 0.539
Validation loss decreased (-0.516659 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 1.0544145107269287
Epoch: 4, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.919 Vali Acc: 0.506 Test Loss: 0.919 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4443097114562988
Epoch: 5, Steps: 13 | Train Loss: 0.774 Vali Loss: 1.390 Vali Acc: 0.500 Test Loss: 1.390 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1254515647888184
Epoch: 6, Steps: 13 | Train Loss: 0.849 Vali Loss: 0.973 Vali Acc: 0.511 Test Loss: 0.973 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.77144455909729
Epoch: 7, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.869 Vali Acc: 0.506 Test Loss: 0.869 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.417754888534546
Epoch: 8, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.760 Vali Acc: 0.561 Test Loss: 0.760 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561104).  Saving model ...
Epoch: 9 cost time: 2.1343917846679688
Epoch: 9, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.976 Vali Acc: 0.461 Test Loss: 0.976 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4970769882202148
Epoch: 10, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.019 Vali Acc: 0.489 Test Loss: 1.019 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6838314533233643
Epoch: 11, Steps: 13 | Train Loss: 0.457 Vali Loss: 1.157 Vali Acc: 0.489 Test Loss: 1.157 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.717188835144043
Epoch: 12, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.391 Vali Acc: 0.522 Test Loss: 1.391 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.105424642562866
Epoch: 13, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.660 Vali Acc: 0.506 Test Loss: 1.660 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7934093475341797
Epoch: 14, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.431 Vali Acc: 0.522 Test Loss: 1.431 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9716544151306152
Epoch: 15, Steps: 13 | Train Loss: 0.305 Vali Loss: 2.398 Vali Acc: 0.517 Test Loss: 2.398 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2995996475219727
Epoch: 16, Steps: 13 | Train Loss: 0.457 Vali Loss: 2.334 Vali Acc: 0.511 Test Loss: 2.334 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8576562404632568
Epoch: 17, Steps: 13 | Train Loss: 0.198 Vali Loss: 2.381 Vali Acc: 0.472 Test Loss: 2.381 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5733575820922852
Epoch: 18, Steps: 13 | Train Loss: 0.164 Vali Loss: 3.190 Vali Acc: 0.506 Test Loss: 3.190 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 30360578
model size : 130.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4526078701019287
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.727 Vali Acc: 0.511 Test Loss: 0.727 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.1101973056793213
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.727 Vali Acc: 0.506 Test Loss: 0.727 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2208020687103271
Epoch: 3, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.713 Vali Acc: 0.533 Test Loss: 0.713 Test Acc: 0.533
Validation loss decreased (-0.511104 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 1.2222387790679932
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.802 Vali Acc: 0.533 Test Loss: 0.802 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2318792343139648
Epoch: 5, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.698 Vali Acc: 0.539 Test Loss: 0.698 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 6 cost time: 1.2886781692504883
Epoch: 6, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.760 Vali Acc: 0.483 Test Loss: 0.760 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1585373878479004
Epoch: 7, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.747 Vali Acc: 0.539 Test Loss: 0.747 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4741075038909912
Epoch: 8, Steps: 13 | Train Loss: 0.564 Vali Loss: 1.221 Vali Acc: 0.506 Test Loss: 1.221 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0935628414154053
Epoch: 9, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.866 Vali Acc: 0.522 Test Loss: 0.866 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.593179702758789
Epoch: 10, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.330796480178833
Epoch: 11, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.059 Vali Acc: 0.489 Test Loss: 1.059 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5352461338043213
Epoch: 12, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.062 Vali Acc: 0.483 Test Loss: 1.062 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9457712173461914
Epoch: 13, Steps: 13 | Train Loss: 0.347 Vali Loss: 1.312 Vali Acc: 0.511 Test Loss: 1.312 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4694104194641113
Epoch: 14, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.248 Vali Acc: 0.467 Test Loss: 1.248 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.055406093597412
Epoch: 15, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.444 Vali Acc: 0.522 Test Loss: 1.444 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 30253058
model size : 130.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.586246967315674
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.706 Vali Acc: 0.533 Test Loss: 0.706 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 0.8833796977996826
Epoch: 2, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.727 Vali Acc: 0.528 Test Loss: 0.727 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.006967544555664
Epoch: 3, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.708 Vali Acc: 0.478 Test Loss: 0.708 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7775156497955322
Epoch: 4, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.729 Vali Acc: 0.517 Test Loss: 0.729 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.044525384902954
Epoch: 5, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.709 Vali Acc: 0.517 Test Loss: 0.709 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9973139762878418
Epoch: 6, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.801 Vali Acc: 0.483 Test Loss: 0.801 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8622176647186279
Epoch: 7, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.803 Vali Acc: 0.483 Test Loss: 0.803 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9747786521911621
Epoch: 8, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.920 Vali Acc: 0.483 Test Loss: 0.920 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.958200216293335
Epoch: 9, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.831 Vali Acc: 0.533 Test Loss: 0.831 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4498815536499023
Epoch: 10, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.943 Vali Acc: 0.517 Test Loss: 0.943 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9620957374572754
Epoch: 11, Steps: 13 | Train Loss: 0.452 Vali Loss: 1.020 Vali Acc: 0.539 Test Loss: 1.020 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538879).  Saving model ...
Epoch: 12 cost time: 1.4755120277404785
Epoch: 12, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.281 Vali Acc: 0.478 Test Loss: 1.281 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8655838966369629
Epoch: 13, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.970 Vali Acc: 0.533 Test Loss: 0.970 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6937339305877686
Epoch: 14, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.276 Vali Acc: 0.478 Test Loss: 1.276 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7645800113677979
Epoch: 15, Steps: 13 | Train Loss: 0.285 Vali Loss: 1.265 Vali Acc: 0.494 Test Loss: 1.265 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0184147357940674
Epoch: 16, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.176 Vali Acc: 0.539 Test Loss: 1.176 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5891392230987549
Epoch: 17, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.281 Vali Acc: 0.528 Test Loss: 1.281 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0072212219238281
Epoch: 18, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.298 Vali Acc: 0.511 Test Loss: 1.298 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4466452598571777
Epoch: 19, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.384 Vali Acc: 0.544 Test Loss: 1.384 Test Acc: 0.544
Validation loss decreased (-0.538879 --> -0.544431).  Saving model ...
Epoch: 20 cost time: 1.1526520252227783
Epoch: 20, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.590 Vali Acc: 0.494 Test Loss: 1.590 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.907912015914917
Epoch: 21, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.469 Vali Acc: 0.511 Test Loss: 1.469 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.635756492614746
Epoch: 22, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.724 Vali Acc: 0.528 Test Loss: 1.724 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.273223638534546
Epoch: 23, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.928 Vali Acc: 0.539 Test Loss: 1.928 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.698594331741333
Epoch: 24, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.815 Vali Acc: 0.533 Test Loss: 1.815 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4851086139678955
Epoch: 25, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.967 Vali Acc: 0.528 Test Loss: 1.967 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2132582664489746
Epoch: 26, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.717 Vali Acc: 0.550 Test Loss: 1.717 Test Acc: 0.550
Validation loss decreased (-0.544431 --> -0.549983).  Saving model ...
Epoch: 27 cost time: 1.2093346118927002
Epoch: 27, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.737 Vali Acc: 0.511 Test Loss: 1.737 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9734911918640137
Epoch: 28, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.852 Vali Acc: 0.511 Test Loss: 1.852 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9684689044952393
Epoch: 29, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.175 Vali Acc: 0.506 Test Loss: 2.175 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0523624420166016
Epoch: 30, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.976 Vali Acc: 0.533 Test Loss: 1.976 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6155579090118408
Epoch: 31, Steps: 13 | Train Loss: 0.105 Vali Loss: 2.126 Vali Acc: 0.494 Test Loss: 2.126 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5355253219604492
Epoch: 32, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.165 Vali Acc: 0.494 Test Loss: 2.165 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3199265003204346
Epoch: 33, Steps: 13 | Train Loss: 0.052 Vali Loss: 2.162 Vali Acc: 0.539 Test Loss: 2.162 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.155951738357544
Epoch: 34, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.304 Vali Acc: 0.494 Test Loss: 2.304 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.407496690750122
Epoch: 35, Steps: 13 | Train Loss: 0.058 Vali Loss: 2.373 Vali Acc: 0.494 Test Loss: 2.373 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9447026252746582
Epoch: 36, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.436 Vali Acc: 0.494 Test Loss: 2.436 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30194690
model size : 129.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps61_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1797494888305664
Epoch: 1, Steps: 13 | Train Loss: 0.830 Vali Loss: 0.683 Vali Acc: 0.556 Test Loss: 0.683 Test Acc: 0.556
Validation loss decreased (inf --> -0.555549).  Saving model ...
Epoch: 2 cost time: 1.6354327201843262
Epoch: 2, Steps: 13 | Train Loss: 0.839 Vali Loss: 0.711 Vali Acc: 0.483 Test Loss: 0.711 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6565239429473877
Epoch: 3, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9686381816864014
Epoch: 4, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.745 Vali Acc: 0.494 Test Loss: 0.745 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3525266647338867
Epoch: 5, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.822 Vali Acc: 0.522 Test Loss: 0.822 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6178669929504395
Epoch: 6, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.870 Vali Acc: 0.500 Test Loss: 0.870 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3017590045928955
Epoch: 7, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.734 Vali Acc: 0.522 Test Loss: 0.734 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6714491844177246
Epoch: 8, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.756 Vali Acc: 0.533 Test Loss: 0.756 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.087350368499756
Epoch: 9, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.835 Vali Acc: 0.533 Test Loss: 0.835 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4947068691253662
Epoch: 10, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.954 Vali Acc: 0.528 Test Loss: 0.954 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4658493995666504
Epoch: 11, Steps: 13 | Train Loss: 0.476 Vali Loss: 1.151 Vali Acc: 0.544 Test Loss: 1.151 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps61_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 30396674
model size : 130.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9274089336395264
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.700 Vali Acc: 0.472 Test Loss: 0.700 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.721562147140503
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.719 Vali Acc: 0.494 Test Loss: 0.719 Test Acc: 0.494
Validation loss decreased (-0.472215 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.830939769744873
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.683 Vali Acc: 0.533 Test Loss: 0.683 Test Acc: 0.533
Validation loss decreased (-0.494437 --> -0.533327).  Saving model ...
Epoch: 4 cost time: 0.9287705421447754
Epoch: 4, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
Validation loss decreased (-0.533327 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.659045696258545
Epoch: 5, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.732 Vali Acc: 0.444 Test Loss: 0.732 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1370654106140137
Epoch: 6, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.877 Vali Acc: 0.506 Test Loss: 0.877 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.558716058731079
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.757 Vali Acc: 0.544 Test Loss: 0.757 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0954022407531738
Epoch: 8, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.940 Vali Acc: 0.506 Test Loss: 0.940 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4907352924346924
Epoch: 9, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.975 Vali Acc: 0.517 Test Loss: 0.975 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.199601173400879
Epoch: 10, Steps: 13 | Train Loss: 0.500 Vali Loss: 1.108 Vali Acc: 0.472 Test Loss: 1.108 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6544876098632812
Epoch: 11, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.914 Vali Acc: 0.483 Test Loss: 0.914 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2615652084350586
Epoch: 12, Steps: 13 | Train Loss: 0.411 Vali Loss: 1.359 Vali Acc: 0.522 Test Loss: 1.359 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6915194988250732
Epoch: 13, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.991 Vali Acc: 0.500 Test Loss: 0.991 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3242416381835938
Epoch: 14, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.143 Vali Acc: 0.483 Test Loss: 1.143 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30295298
model size : 130.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps61_str61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.660911798477173
Epoch: 1, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.3162720203399658
Epoch: 2, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.703 Vali Acc: 0.544 Test Loss: 0.703 Test Acc: 0.544
Validation loss decreased (-0.449993 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.6385226249694824
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.692 Vali Acc: 0.539 Test Loss: 0.692 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1011979579925537
Epoch: 4, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.684 Vali Acc: 0.511 Test Loss: 0.684 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9416093826293945
Epoch: 5, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.684 Vali Acc: 0.556 Test Loss: 0.684 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555549).  Saving model ...
Epoch: 6 cost time: 1.1778738498687744
Epoch: 6, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.917 Vali Acc: 0.511 Test Loss: 0.917 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0106358528137207
Epoch: 7, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.839 Vali Acc: 0.517 Test Loss: 0.839 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5770068168640137
Epoch: 8, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.733 Vali Acc: 0.517 Test Loss: 0.733 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.199885606765747
Epoch: 9, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.784 Vali Acc: 0.494 Test Loss: 0.784 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4868552684783936
Epoch: 10, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.816 Vali Acc: 0.550 Test Loss: 0.816 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0178248882293701
Epoch: 11, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.868 Vali Acc: 0.467 Test Loss: 0.868 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4046046733856201
Epoch: 12, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.982 Vali Acc: 0.511 Test Loss: 0.982 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4426510334014893
Epoch: 13, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.840 Vali Acc: 0.522 Test Loss: 0.840 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8511769771575928
Epoch: 14, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.941 Vali Acc: 0.506 Test Loss: 0.941 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6023128032684326
Epoch: 15, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.971 Vali Acc: 0.511 Test Loss: 0.971 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps61_str61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 30240002
model size : 130.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.060850143432617
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.820 Vali Acc: 0.500 Test Loss: 0.820 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4711716175079346
Epoch: 2, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.723 Vali Acc: 0.483 Test Loss: 0.723 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4435656070709229
Epoch: 3, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.733 Vali Acc: 0.517 Test Loss: 0.733 Test Acc: 0.517
Validation loss decreased (-0.499992 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 1.5182464122772217
Epoch: 4, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.784 Vali Acc: 0.506 Test Loss: 0.784 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5343425273895264
Epoch: 5, Steps: 13 | Train Loss: 0.619 Vali Loss: 1.020 Vali Acc: 0.500 Test Loss: 1.020 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.648568868637085
Epoch: 6, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5089852809906006
Epoch: 7, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
Validation loss decreased (-0.516659 --> -0.549991).  Saving model ...
Epoch: 8 cost time: 1.4708116054534912
Epoch: 8, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.851 Vali Acc: 0.494 Test Loss: 0.851 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.130147933959961
Epoch: 9, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.920 Vali Acc: 0.494 Test Loss: 0.920 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8535280227661133
Epoch: 10, Steps: 13 | Train Loss: 0.537 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4414896965026855
Epoch: 11, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.990 Vali Acc: 0.494 Test Loss: 0.990 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4121382236480713
Epoch: 12, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.171 Vali Acc: 0.494 Test Loss: 1.171 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7593538761138916
Epoch: 13, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.488 Vali Acc: 0.456 Test Loss: 1.488 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7069659233093262
Epoch: 14, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.694 Vali Acc: 0.494 Test Loss: 1.694 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1714272499084473
Epoch: 15, Steps: 13 | Train Loss: 0.402 Vali Loss: 1.647 Vali Acc: 0.517 Test Loss: 1.647 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1501522064208984
Epoch: 16, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.555 Vali Acc: 0.550 Test Loss: 1.555 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1270012855529785
Epoch: 17, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.629 Vali Acc: 0.522 Test Loss: 1.629 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30445058
model size : 130.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0143256187438965
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.695 Vali Acc: 0.561 Test Loss: 0.695 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 1.5061569213867188
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1219732761383057
Epoch: 3, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.686 Vali Acc: 0.572 Test Loss: 0.686 Test Acc: 0.572
Validation loss decreased (-0.561104 --> -0.572215).  Saving model ...
Epoch: 4 cost time: 0.936730146408081
Epoch: 4, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.790 Vali Acc: 0.511 Test Loss: 0.790 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9828228950500488
Epoch: 5, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.764 Vali Acc: 0.572 Test Loss: 0.764 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3617393970489502
Epoch: 6, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.746 Vali Acc: 0.517 Test Loss: 0.746 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.44655179977417
Epoch: 7, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.776 Vali Acc: 0.539 Test Loss: 0.776 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3915910720825195
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.929 Vali Acc: 0.539 Test Loss: 0.929 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.619704008102417
Epoch: 9, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.869 Vali Acc: 0.506 Test Loss: 0.869 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1219875812530518
Epoch: 10, Steps: 13 | Train Loss: 0.480 Vali Loss: 1.038 Vali Acc: 0.500 Test Loss: 1.038 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.214345932006836
Epoch: 11, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.037 Vali Acc: 0.489 Test Loss: 1.037 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5251705646514893
Epoch: 12, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.300 Vali Acc: 0.472 Test Loss: 1.300 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9605906009674072
Epoch: 13, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.371 Vali Acc: 0.489 Test Loss: 1.371 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 30340610
model size : 130.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.824650526046753
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.673 Vali Acc: 0.550 Test Loss: 0.673 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 0.9607055187225342
Epoch: 2, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.715 Vali Acc: 0.539 Test Loss: 0.715 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6842975616455078
Epoch: 3, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.702 Vali Acc: 0.539 Test Loss: 0.702 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6381595134735107
Epoch: 4, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.692 Vali Acc: 0.533 Test Loss: 0.692 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6439156532287598
Epoch: 5, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.691 Vali Acc: 0.511 Test Loss: 0.691 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0792853832244873
Epoch: 6, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.715 Vali Acc: 0.483 Test Loss: 0.715 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7459161281585693
Epoch: 7, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.717 Vali Acc: 0.533 Test Loss: 0.717 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.369579553604126
Epoch: 8, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.718 Vali Acc: 0.517 Test Loss: 0.718 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.052433729171753
Epoch: 9, Steps: 13 | Train Loss: 0.565 Vali Loss: 1.037 Vali Acc: 0.489 Test Loss: 1.037 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1558747291564941
Epoch: 10, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.760 Vali Acc: 0.478 Test Loss: 0.760 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1866815090179443
Epoch: 11, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.845 Vali Acc: 0.528 Test Loss: 0.845 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30288386
model size : 130.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.390484571456909
Epoch: 1, Steps: 13 | Train Loss: 0.749 Vali Loss: 0.745 Vali Acc: 0.500 Test Loss: 0.745 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.251692056655884
Epoch: 2, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.692 Vali Acc: 0.500 Test Loss: 0.692 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.8182132244110107
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.776 Vali Acc: 0.500 Test Loss: 0.776 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0758605003356934
Epoch: 4, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.941 Vali Acc: 0.500 Test Loss: 0.941 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2195885181427002
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.722 Vali Acc: 0.572 Test Loss: 0.722 Test Acc: 0.572
Validation loss decreased (-0.499993 --> -0.572215).  Saving model ...
Epoch: 6 cost time: 1.9368364810943604
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.735 Vali Acc: 0.544 Test Loss: 0.735 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.22564959526062
Epoch: 7, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.828 Vali Acc: 0.533 Test Loss: 0.828 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7231559753417969
Epoch: 8, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.882 Vali Acc: 0.561 Test Loss: 0.882 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7832880020141602
Epoch: 9, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.236 Vali Acc: 0.533 Test Loss: 1.236 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2815661430358887
Epoch: 10, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.876 Vali Acc: 0.544 Test Loss: 0.876 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5391242504119873
Epoch: 11, Steps: 13 | Train Loss: 0.521 Vali Loss: 1.449 Vali Acc: 0.439 Test Loss: 1.449 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7652640342712402
Epoch: 12, Steps: 13 | Train Loss: 0.473 Vali Loss: 1.141 Vali Acc: 0.533 Test Loss: 1.141 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.47261643409729
Epoch: 13, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.217 Vali Acc: 0.528 Test Loss: 1.217 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.866478681564331
Epoch: 14, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.331 Vali Acc: 0.517 Test Loss: 1.331 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1887612342834473
Epoch: 15, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.384 Vali Acc: 0.472 Test Loss: 1.384 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 30494210
model size : 131.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0503480434417725
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.701 Vali Acc: 0.506 Test Loss: 0.701 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 1.1171143054962158
Epoch: 2, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.688 Vali Acc: 0.539 Test Loss: 0.688 Test Acc: 0.539
Validation loss decreased (-0.505549 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.084613561630249
Epoch: 3, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.705 Vali Acc: 0.533 Test Loss: 0.705 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0170142650604248
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.1034502983093262
Epoch: 5, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.903 Vali Acc: 0.511 Test Loss: 0.903 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.127199649810791
Epoch: 6, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.711 Vali Acc: 0.517 Test Loss: 0.711 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7192189693450928
Epoch: 7, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.791 Vali Acc: 0.528 Test Loss: 0.791 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.044302225112915
Epoch: 8, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.830 Vali Acc: 0.494 Test Loss: 0.830 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.978081464767456
Epoch: 9, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.906 Vali Acc: 0.483 Test Loss: 0.906 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5544943809509277
Epoch: 10, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.962 Vali Acc: 0.511 Test Loss: 0.962 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.271336555480957
Epoch: 11, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.908 Vali Acc: 0.483 Test Loss: 0.908 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0107619762420654
Epoch: 12, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.946 Vali Acc: 0.494 Test Loss: 0.946 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1643993854522705
Epoch: 13, Steps: 13 | Train Loss: 0.406 Vali Loss: 1.545 Vali Acc: 0.533 Test Loss: 1.545 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3705720901489258
Epoch: 14, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.181 Vali Acc: 0.511 Test Loss: 1.181 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30395906
model size : 130.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.507171630859375
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.708 Vali Acc: 0.489 Test Loss: 0.708 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.729771614074707
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.691 Vali Acc: 0.539 Test Loss: 0.691 Test Acc: 0.539
Validation loss decreased (-0.488882 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.0913336277008057
Epoch: 3, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.710 Vali Acc: 0.517 Test Loss: 0.710 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.909904956817627
Epoch: 4, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.731 Vali Acc: 0.506 Test Loss: 0.731 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9961352348327637
Epoch: 5, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.731 Vali Acc: 0.506 Test Loss: 0.731 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9179883003234863
Epoch: 6, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.730 Vali Acc: 0.478 Test Loss: 0.730 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8314509391784668
Epoch: 7, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.715 Vali Acc: 0.533 Test Loss: 0.715 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7914693355560303
Epoch: 8, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.824 Vali Acc: 0.511 Test Loss: 0.824 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.313023328781128
Epoch: 9, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.905 Vali Acc: 0.472 Test Loss: 0.905 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0710391998291016
Epoch: 10, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.965 Vali Acc: 0.528 Test Loss: 0.965 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8105213642120361
Epoch: 11, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.913 Vali Acc: 0.478 Test Loss: 0.913 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8434555530548096
Epoch: 12, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.936 Vali Acc: 0.489 Test Loss: 0.936 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 30346754
model size : 130.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps72_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0564537048339844
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.741 Vali Acc: 0.500 Test Loss: 0.741 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.6128993034362793
Epoch: 2, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.722 Vali Acc: 0.522 Test Loss: 0.722 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 2.012265205383301
Epoch: 3, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.841 Vali Acc: 0.511 Test Loss: 0.841 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.575881004333496
Epoch: 4, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.757 Vali Acc: 0.456 Test Loss: 0.757 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1775856018066406
Epoch: 5, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.702 Vali Acc: 0.567 Test Loss: 0.702 Test Acc: 0.567
Validation loss decreased (-0.522215 --> -0.566660).  Saving model ...
Epoch: 6 cost time: 1.4340660572052002
Epoch: 6, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.817 Vali Acc: 0.472 Test Loss: 0.817 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.480595588684082
Epoch: 7, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.885 Vali Acc: 0.500 Test Loss: 0.885 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.092251777648926
Epoch: 8, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.988 Vali Acc: 0.522 Test Loss: 0.988 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2795360088348389
Epoch: 9, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.930 Vali Acc: 0.528 Test Loss: 0.930 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6367239952087402
Epoch: 10, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.950 Vali Acc: 0.528 Test Loss: 0.950 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3161911964416504
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.321 Vali Acc: 0.478 Test Loss: 1.321 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4707984924316406
Epoch: 12, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.486 Vali Acc: 0.478 Test Loss: 1.486 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0055930614471436
Epoch: 13, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.483 Vali Acc: 0.461 Test Loss: 1.483 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5390679836273193
Epoch: 14, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.778 Vali Acc: 0.506 Test Loss: 1.778 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4899251461029053
Epoch: 15, Steps: 13 | Train Loss: 0.342 Vali Loss: 2.874 Vali Acc: 0.494 Test Loss: 2.874 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps72_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 30549506
model size : 131.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps72_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.266500473022461
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.764 Vali Acc: 0.500 Test Loss: 0.764 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.068528175354004
Epoch: 2, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.701 Vali Acc: 0.472 Test Loss: 0.701 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9809756278991699
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.716 Vali Acc: 0.506 Test Loss: 0.716 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505548).  Saving model ...
Epoch: 4 cost time: 1.2619166374206543
Epoch: 4, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.702 Vali Acc: 0.517 Test Loss: 0.702 Test Acc: 0.517
Validation loss decreased (-0.505548 --> -0.516660).  Saving model ...
Epoch: 5 cost time: 1.1920008659362793
Epoch: 5, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.714 Vali Acc: 0.511 Test Loss: 0.714 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.515270709991455
Epoch: 6, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.784 Vali Acc: 0.506 Test Loss: 0.784 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3131794929504395
Epoch: 7, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.847 Vali Acc: 0.456 Test Loss: 0.847 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3286867141723633
Epoch: 8, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.940 Vali Acc: 0.517 Test Loss: 0.940 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6039619445800781
Epoch: 9, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.900 Vali Acc: 0.489 Test Loss: 0.900 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2268860340118408
Epoch: 10, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.960 Vali Acc: 0.528 Test Loss: 0.960 Test Acc: 0.528
Validation loss decreased (-0.516660 --> -0.527768).  Saving model ...
Epoch: 11 cost time: 1.6936373710632324
Epoch: 11, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.304 Vali Acc: 0.528 Test Loss: 1.304 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0369668006896973
Epoch: 12, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.984 Vali Acc: 0.522 Test Loss: 0.984 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.593092918395996
Epoch: 13, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.163 Vali Acc: 0.517 Test Loss: 1.163 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.047307014465332
Epoch: 14, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.270 Vali Acc: 0.533 Test Loss: 1.270 Test Acc: 0.533
Validation loss decreased (-0.527768 --> -0.533321).  Saving model ...
Epoch: 15 cost time: 1.0153756141662598
Epoch: 15, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.428 Vali Acc: 0.511 Test Loss: 1.428 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5624895095825195
Epoch: 16, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.637 Vali Acc: 0.533 Test Loss: 1.637 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.067612648010254
Epoch: 17, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.361 Vali Acc: 0.533 Test Loss: 1.361 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2868201732635498
Epoch: 18, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.395 Vali Acc: 0.522 Test Loss: 1.395 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5332939624786377
Epoch: 19, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.650 Vali Acc: 0.550 Test Loss: 1.650 Test Acc: 0.550
Validation loss decreased (-0.533321 --> -0.549983).  Saving model ...
Epoch: 20 cost time: 0.986236572265625
Epoch: 20, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.697 Vali Acc: 0.511 Test Loss: 1.697 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8876383304595947
Epoch: 21, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.886 Vali Acc: 0.494 Test Loss: 1.886 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3979496955871582
Epoch: 22, Steps: 13 | Train Loss: 0.186 Vali Loss: 2.064 Vali Acc: 0.500 Test Loss: 2.064 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9004521369934082
Epoch: 23, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.254 Vali Acc: 0.511 Test Loss: 2.254 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5834095478057861
Epoch: 24, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.869 Vali Acc: 0.567 Test Loss: 1.869 Test Acc: 0.567
Validation loss decreased (-0.549983 --> -0.566648).  Saving model ...
Epoch: 25 cost time: 1.215216875076294
Epoch: 25, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.324 Vali Acc: 0.517 Test Loss: 2.324 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7771801948547363
Epoch: 26, Steps: 13 | Train Loss: 0.072 Vali Loss: 2.348 Vali Acc: 0.528 Test Loss: 2.348 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2312753200531006
Epoch: 27, Steps: 13 | Train Loss: 0.057 Vali Loss: 2.326 Vali Acc: 0.533 Test Loss: 2.326 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6915879249572754
Epoch: 28, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.292 Vali Acc: 0.561 Test Loss: 2.292 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0786466598510742
Epoch: 29, Steps: 13 | Train Loss: 0.112 Vali Loss: 2.547 Vali Acc: 0.539 Test Loss: 2.547 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1934187412261963
Epoch: 30, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.628 Vali Acc: 0.550 Test Loss: 2.628 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3791050910949707
Epoch: 31, Steps: 13 | Train Loss: 0.068 Vali Loss: 2.574 Vali Acc: 0.506 Test Loss: 2.574 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9216001033782959
Epoch: 32, Steps: 13 | Train Loss: 0.045 Vali Loss: 2.995 Vali Acc: 0.522 Test Loss: 2.995 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.4487407207489014
Epoch: 33, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.940 Vali Acc: 0.544 Test Loss: 2.940 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8708393573760986
Epoch: 34, Steps: 13 | Train Loss: 0.051 Vali Loss: 2.868 Vali Acc: 0.528 Test Loss: 2.868 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps72_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 30457346
model size : 130.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps72_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.746310234069824
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.693 Vali Acc: 0.517 Test Loss: 0.693 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 0.7403147220611572
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.685 Vali Acc: 0.506 Test Loss: 0.685 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9678316116333008
Epoch: 3, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.684 Vali Acc: 0.556 Test Loss: 0.684 Test Acc: 0.556
Validation loss decreased (-0.516660 --> -0.555549).  Saving model ...
Epoch: 4 cost time: 0.9722051620483398
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.725 Vali Acc: 0.528 Test Loss: 0.725 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8361415863037109
Epoch: 5, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.694 Vali Acc: 0.539 Test Loss: 0.694 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7591350078582764
Epoch: 6, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.700 Vali Acc: 0.489 Test Loss: 0.700 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7649774551391602
Epoch: 7, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.715 Vali Acc: 0.489 Test Loss: 0.715 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8756499290466309
Epoch: 8, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.890 Vali Acc: 0.511 Test Loss: 0.890 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8401415348052979
Epoch: 9, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.835 Vali Acc: 0.528 Test Loss: 0.835 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8048126697540283
Epoch: 10, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.809 Vali Acc: 0.539 Test Loss: 0.809 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8370583057403564
Epoch: 11, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.899 Vali Acc: 0.506 Test Loss: 0.899 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7895355224609375
Epoch: 12, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.930 Vali Acc: 0.494 Test Loss: 0.930 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0094890594482422
Epoch: 13, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.047 Vali Acc: 0.500 Test Loss: 1.047 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps72_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 30411266
model size : 130.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0579965114593506
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.763 Vali Acc: 0.472 Test Loss: 0.763 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.2501938343048096
Epoch: 2, Steps: 13 | Train Loss: 0.794 Vali Loss: 0.712 Vali Acc: 0.506 Test Loss: 0.712 Test Acc: 0.506
Validation loss decreased (-0.472215 --> -0.505548).  Saving model ...
Epoch: 3 cost time: 1.374370813369751
Epoch: 3, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.961 Vali Acc: 0.500 Test Loss: 0.961 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1129226684570312
Epoch: 4, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4567961692810059
Epoch: 5, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.804 Vali Acc: 0.506 Test Loss: 0.804 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3174970149993896
Epoch: 6, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.861 Vali Acc: 0.500 Test Loss: 0.861 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6235928535461426
Epoch: 7, Steps: 13 | Train Loss: 0.853 Vali Loss: 1.440 Vali Acc: 0.500 Test Loss: 1.440 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1301162242889404
Epoch: 8, Steps: 13 | Train Loss: 0.718 Vali Loss: 1.440 Vali Acc: 0.483 Test Loss: 1.440 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3237812519073486
Epoch: 9, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.775 Vali Acc: 0.544 Test Loss: 0.775 Test Acc: 0.544
Validation loss decreased (-0.505548 --> -0.544437).  Saving model ...
Epoch: 10 cost time: 2.0496366024017334
Epoch: 10, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.101 Vali Acc: 0.517 Test Loss: 1.101 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2459897994995117
Epoch: 11, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.999 Vali Acc: 0.500 Test Loss: 0.999 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1041662693023682
Epoch: 12, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.980 Vali Acc: 0.500 Test Loss: 0.980 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1553599834442139
Epoch: 13, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.208 Vali Acc: 0.506 Test Loss: 1.208 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.935497760772705
Epoch: 14, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.893 Vali Acc: 0.578 Test Loss: 0.893 Test Acc: 0.578
Validation loss decreased (-0.544437 --> -0.577769).  Saving model ...
Epoch: 15 cost time: 1.4795103073120117
Epoch: 15, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.189 Vali Acc: 0.483 Test Loss: 1.189 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.971308946609497
Epoch: 16, Steps: 13 | Train Loss: 0.406 Vali Loss: 1.413 Vali Acc: 0.500 Test Loss: 1.413 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.892195701599121
Epoch: 17, Steps: 13 | Train Loss: 0.574 Vali Loss: 1.165 Vali Acc: 0.572 Test Loss: 1.165 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8509907722473145
Epoch: 18, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.527 Vali Acc: 0.578 Test Loss: 1.527 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3016102313995361
Epoch: 19, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.305 Vali Acc: 0.528 Test Loss: 1.305 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4628582000732422
Epoch: 20, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.345 Vali Acc: 0.556 Test Loss: 1.345 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9830725193023682
Epoch: 21, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.585 Vali Acc: 0.494 Test Loss: 1.585 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4813787937164307
Epoch: 22, Steps: 13 | Train Loss: 0.175 Vali Loss: 2.281 Vali Acc: 0.489 Test Loss: 2.281 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9893054962158203
Epoch: 23, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.827 Vali Acc: 0.539 Test Loss: 1.827 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4557366371154785
Epoch: 24, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.747 Vali Acc: 0.506 Test Loss: 1.747 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 30608642
model size : 131.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.4519009590148926
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.702 Vali Acc: 0.506 Test Loss: 0.702 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 1.8620266914367676
Epoch: 2, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.728 Vali Acc: 0.489 Test Loss: 0.728 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4286680221557617
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.688 Vali Acc: 0.528 Test Loss: 0.688 Test Acc: 0.528
Validation loss decreased (-0.505549 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 1.6314258575439453
Epoch: 4, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.763 Vali Acc: 0.494 Test Loss: 0.763 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0799942016601562
Epoch: 5, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.778 Vali Acc: 0.478 Test Loss: 0.778 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4693481922149658
Epoch: 6, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.719 Vali Acc: 0.506 Test Loss: 0.719 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0405352115631104
Epoch: 7, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.781 Vali Acc: 0.483 Test Loss: 0.781 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0090715885162354
Epoch: 8, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.770 Vali Acc: 0.522 Test Loss: 0.770 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5041184425354004
Epoch: 9, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.787 Vali Acc: 0.500 Test Loss: 0.787 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2348120212554932
Epoch: 10, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.882 Vali Acc: 0.511 Test Loss: 0.882 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6256518363952637
Epoch: 11, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.037 Vali Acc: 0.511 Test Loss: 1.037 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1859540939331055
Epoch: 12, Steps: 13 | Train Loss: 0.410 Vali Loss: 1.291 Vali Acc: 0.478 Test Loss: 1.291 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.202796220779419
Epoch: 13, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.244 Vali Acc: 0.489 Test Loss: 1.244 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 30528770
model size : 131.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.543377161026001
Epoch: 1, Steps: 13 | Train Loss: 0.766 Vali Loss: 0.707 Vali Acc: 0.506 Test Loss: 0.707 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.8748724460601807
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.724 Vali Acc: 0.533 Test Loss: 0.724 Test Acc: 0.533
Validation loss decreased (-0.505548 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.117372989654541
Epoch: 3, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.693 Vali Acc: 0.544 Test Loss: 0.693 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 1.227268934249878
Epoch: 4, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.704 Vali Acc: 0.544 Test Loss: 0.704 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.84212327003479
Epoch: 5, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.723 Vali Acc: 0.533 Test Loss: 0.723 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0674619674682617
Epoch: 6, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.263235330581665
Epoch: 7, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.723 Vali Acc: 0.550 Test Loss: 0.723 Test Acc: 0.550
Validation loss decreased (-0.544438 --> -0.549993).  Saving model ...
Epoch: 8 cost time: 0.9639897346496582
Epoch: 8, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.761 Vali Acc: 0.539 Test Loss: 0.761 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8772139549255371
Epoch: 9, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.830 Vali Acc: 0.533 Test Loss: 0.830 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7990117073059082
Epoch: 10, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.958 Vali Acc: 0.550 Test Loss: 0.958 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1064515113830566
Epoch: 11, Steps: 13 | Train Loss: 0.412 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.184581995010376
Epoch: 12, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.942 Vali Acc: 0.461 Test Loss: 0.942 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8558974266052246
Epoch: 13, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.064 Vali Acc: 0.450 Test Loss: 1.064 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8917841911315918
Epoch: 14, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.105 Vali Acc: 0.456 Test Loss: 1.105 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0775973796844482
Epoch: 15, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.082 Vali Acc: 0.517 Test Loss: 1.082 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2993030548095703
Epoch: 16, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.191 Vali Acc: 0.533 Test Loss: 1.191 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3065037727355957
Epoch: 17, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.637 Vali Acc: 0.528 Test Loss: 1.637 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30485762
model size : 130.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps83_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.5678606033325195
Epoch: 1, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.709 Vali Acc: 0.522 Test Loss: 0.709 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 2.303751230239868
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7347800731658936
Epoch: 3, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4233191013336182
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.821 Vali Acc: 0.483 Test Loss: 0.821 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2888133525848389
Epoch: 5, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.751 Vali Acc: 0.489 Test Loss: 0.751 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8937726020812988
Epoch: 6, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.776 Vali Acc: 0.511 Test Loss: 0.776 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1035666465759277
Epoch: 7, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.769 Vali Acc: 0.472 Test Loss: 0.769 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.686490535736084
Epoch: 8, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.820 Vali Acc: 0.517 Test Loss: 0.820 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.273825168609619
Epoch: 9, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.985 Vali Acc: 0.539 Test Loss: 0.985 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538879).  Saving model ...
Epoch: 10 cost time: 1.6799075603485107
Epoch: 10, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.817 Vali Acc: 0.550 Test Loss: 0.817 Test Acc: 0.550
Validation loss decreased (-0.538879 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 2.19853138923645
Epoch: 11, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.869 Vali Acc: 0.489 Test Loss: 0.869 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.302964448928833
Epoch: 12, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.101 Vali Acc: 0.528 Test Loss: 1.101 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9214727878570557
Epoch: 13, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.241 Vali Acc: 0.533 Test Loss: 1.241 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.389249086380005
Epoch: 14, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8385097980499268
Epoch: 15, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.628 Vali Acc: 0.511 Test Loss: 1.628 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.24006986618042
Epoch: 16, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.619 Vali Acc: 0.483 Test Loss: 1.619 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4128856658935547
Epoch: 17, Steps: 13 | Train Loss: 0.559 Vali Loss: 2.540 Vali Acc: 0.433 Test Loss: 2.540 Test Acc: 0.433
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9870049953460693
Epoch: 18, Steps: 13 | Train Loss: 0.346 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.214458703994751
Epoch: 19, Steps: 13 | Train Loss: 0.158 Vali Loss: 2.265 Vali Acc: 0.472 Test Loss: 2.265 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9586241245269775
Epoch: 20, Steps: 13 | Train Loss: 0.244 Vali Loss: 2.468 Vali Acc: 0.483 Test Loss: 2.468 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps83_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30696194
model size : 131.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps83_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1082146167755127
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.713 Vali Acc: 0.450 Test Loss: 0.713 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.8050789833068848
Epoch: 2, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.2314023971557617
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.699 Vali Acc: 0.528 Test Loss: 0.699 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527771).  Saving model ...
Epoch: 4 cost time: 1.6417412757873535
Epoch: 4, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.712 Vali Acc: 0.528 Test Loss: 0.712 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3486456871032715
Epoch: 5, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.712 Vali Acc: 0.522 Test Loss: 0.712 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.41945219039917
Epoch: 6, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.744 Vali Acc: 0.544 Test Loss: 0.744 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544437).  Saving model ...
Epoch: 7 cost time: 1.8608424663543701
Epoch: 7, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.825 Vali Acc: 0.478 Test Loss: 0.825 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3953239917755127
Epoch: 8, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.966 Vali Acc: 0.533 Test Loss: 0.966 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9189493656158447
Epoch: 9, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.844 Vali Acc: 0.472 Test Loss: 0.844 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7825267314910889
Epoch: 10, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.909 Vali Acc: 0.472 Test Loss: 0.909 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3209419250488281
Epoch: 11, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.958 Vali Acc: 0.506 Test Loss: 0.958 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6794145107269287
Epoch: 12, Steps: 13 | Train Loss: 0.415 Vali Loss: 1.025 Vali Acc: 0.500 Test Loss: 1.025 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5959067344665527
Epoch: 13, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.124 Vali Acc: 0.572 Test Loss: 1.124 Test Acc: 0.572
Validation loss decreased (-0.544437 --> -0.572211).  Saving model ...
Epoch: 14 cost time: 1.277461051940918
Epoch: 14, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.212 Vali Acc: 0.506 Test Loss: 1.212 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7694244384765625
Epoch: 15, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.714 Vali Acc: 0.528 Test Loss: 1.714 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7180089950561523
Epoch: 16, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.429 Vali Acc: 0.506 Test Loss: 1.429 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2801711559295654
Epoch: 17, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.394 Vali Acc: 0.472 Test Loss: 1.394 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.697854995727539
Epoch: 18, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.584 Vali Acc: 0.500 Test Loss: 1.584 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7611284255981445
Epoch: 19, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.664 Vali Acc: 0.478 Test Loss: 1.664 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3478293418884277
Epoch: 20, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.711 Vali Acc: 0.483 Test Loss: 1.711 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7596631050109863
Epoch: 21, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.382 Vali Acc: 0.517 Test Loss: 1.382 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6862945556640625
Epoch: 22, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.677 Vali Acc: 0.539 Test Loss: 1.677 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3337674140930176
Epoch: 23, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.672 Vali Acc: 0.483 Test Loss: 1.672 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps83_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 30619394
model size : 131.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps83_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7704849243164062
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.679 Vali Acc: 0.561 Test Loss: 0.679 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 1.086568832397461
Epoch: 2, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.696 Vali Acc: 0.528 Test Loss: 0.696 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6574411392211914
Epoch: 3, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.692 Vali Acc: 0.544 Test Loss: 0.692 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6033995151519775
Epoch: 4, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.709 Vali Acc: 0.561 Test Loss: 0.709 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.576371431350708
Epoch: 5, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.859 Vali Acc: 0.539 Test Loss: 0.859 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5969855785369873
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.732 Vali Acc: 0.528 Test Loss: 0.732 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5750494003295898
Epoch: 7, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.773 Vali Acc: 0.506 Test Loss: 0.773 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5918378829956055
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.787 Vali Acc: 0.539 Test Loss: 0.787 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5667717456817627
Epoch: 9, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.780 Vali Acc: 0.483 Test Loss: 0.780 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5420658588409424
Epoch: 10, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.894 Vali Acc: 0.522 Test Loss: 0.894 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6566603183746338
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.055 Vali Acc: 0.472 Test Loss: 1.055 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps83_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 30579458
model size : 131.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps89_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.733494520187378
Epoch: 1, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.887441635131836
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.695 Vali Acc: 0.572 Test Loss: 0.695 Test Acc: 0.572
Validation loss decreased (-0.499992 --> -0.572215).  Saving model ...
Epoch: 3 cost time: 2.120328903198242
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.739 Vali Acc: 0.522 Test Loss: 0.739 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6034870147705078
Epoch: 4, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1690406799316406
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.784 Vali Acc: 0.494 Test Loss: 0.784 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7148609161376953
Epoch: 6, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.918400764465332
Epoch: 7, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.863 Vali Acc: 0.489 Test Loss: 0.863 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9489877223968506
Epoch: 8, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.001 Vali Acc: 0.511 Test Loss: 1.001 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3675599098205566
Epoch: 9, Steps: 13 | Train Loss: 0.541 Vali Loss: 1.017 Vali Acc: 0.517 Test Loss: 1.017 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7477002143859863
Epoch: 10, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.991 Vali Acc: 0.500 Test Loss: 0.991 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.531712532043457
Epoch: 11, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.114 Vali Acc: 0.483 Test Loss: 1.114 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.57716965675354
Epoch: 12, Steps: 13 | Train Loss: 0.510 Vali Loss: 1.014 Vali Acc: 0.483 Test Loss: 1.014 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps89_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 30780674
model size : 132.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps89_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.72236704826355
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.715 Vali Acc: 0.483 Test Loss: 0.715 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.6458408832550049
Epoch: 2, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.715 Vali Acc: 0.511 Test Loss: 0.715 Test Acc: 0.511
Validation loss decreased (-0.483326 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 1.3807001113891602
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.687 Vali Acc: 0.550 Test Loss: 0.687 Test Acc: 0.550
Validation loss decreased (-0.511104 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.6284759044647217
Epoch: 4, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3240437507629395
Epoch: 5, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.791 Vali Acc: 0.478 Test Loss: 0.791 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.598114013671875
Epoch: 6, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.731 Vali Acc: 0.550 Test Loss: 0.731 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.635545015335083
Epoch: 7, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.806 Vali Acc: 0.461 Test Loss: 0.806 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.264815092086792
Epoch: 8, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.481165885925293
Epoch: 9, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.927 Vali Acc: 0.533 Test Loss: 0.927 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6175084114074707
Epoch: 10, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.992 Vali Acc: 0.483 Test Loss: 0.992 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4381513595581055
Epoch: 11, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8737287521362305
Epoch: 12, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3801021575927734
Epoch: 13, Steps: 13 | Train Loss: 0.523 Vali Loss: 1.249 Vali Acc: 0.478 Test Loss: 1.249 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps89_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 30710018
model size : 131.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps89_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.2310538291931152
Epoch: 1, Steps: 13 | Train Loss: 0.798 Vali Loss: 0.731 Vali Acc: 0.494 Test Loss: 0.731 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.9041464328765869
Epoch: 2, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.699 Vali Acc: 0.550 Test Loss: 0.699 Test Acc: 0.550
Validation loss decreased (-0.494437 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 0.8579874038696289
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.694 Vali Acc: 0.572 Test Loss: 0.694 Test Acc: 0.572
Validation loss decreased (-0.549993 --> -0.572215).  Saving model ...
Epoch: 4 cost time: 0.7348942756652832
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.704 Vali Acc: 0.494 Test Loss: 0.704 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7992093563079834
Epoch: 5, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.685 Vali Acc: 0.594 Test Loss: 0.685 Test Acc: 0.594
Validation loss decreased (-0.572215 --> -0.594438).  Saving model ...
Epoch: 6 cost time: 0.8843295574188232
Epoch: 6, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.850 Vali Acc: 0.511 Test Loss: 0.850 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0776169300079346
Epoch: 7, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.861 Vali Acc: 0.533 Test Loss: 0.861 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1384248733520508
Epoch: 8, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.775 Vali Acc: 0.544 Test Loss: 0.775 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0853509902954102
Epoch: 9, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.757 Vali Acc: 0.567 Test Loss: 0.757 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1946089267730713
Epoch: 10, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.923 Vali Acc: 0.539 Test Loss: 0.923 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0237627029418945
Epoch: 11, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.015 Vali Acc: 0.517 Test Loss: 1.015 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8412933349609375
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.011 Vali Acc: 0.589 Test Loss: 1.011 Test Acc: 0.589
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.797637939453125
Epoch: 13, Steps: 13 | Train Loss: 0.374 Vali Loss: 1.104 Vali Acc: 0.494 Test Loss: 1.104 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.892535924911499
Epoch: 14, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.956 Vali Acc: 0.561 Test Loss: 0.956 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6976699829101562
Epoch: 15, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.250 Vali Acc: 0.500 Test Loss: 1.250 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps89_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5944444444444444
model parameter : 30673154
model size : 131.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps96_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.860955238342285
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.743 Vali Acc: 0.450 Test Loss: 0.743 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.2219436168670654
Epoch: 2, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.700 Vali Acc: 0.533 Test Loss: 0.700 Test Acc: 0.533
Validation loss decreased (-0.449993 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 1.629667043685913
Epoch: 3, Steps: 13 | Train Loss: 0.800 Vali Loss: 1.101 Vali Acc: 0.511 Test Loss: 1.101 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5210373401641846
Epoch: 4, Steps: 13 | Train Loss: 0.815 Vali Loss: 0.719 Vali Acc: 0.561 Test Loss: 0.719 Test Acc: 0.561
Validation loss decreased (-0.533326 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 2.2213683128356934
Epoch: 5, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.743 Vali Acc: 0.478 Test Loss: 0.743 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4134647846221924
Epoch: 6, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.762 Vali Acc: 0.467 Test Loss: 0.762 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7336235046386719
Epoch: 7, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.773 Vali Acc: 0.494 Test Loss: 0.773 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1459338665008545
Epoch: 8, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.894 Vali Acc: 0.522 Test Loss: 0.894 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.099226474761963
Epoch: 9, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.885 Vali Acc: 0.472 Test Loss: 0.885 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.309565305709839
Epoch: 10, Steps: 13 | Train Loss: 0.444 Vali Loss: 1.160 Vali Acc: 0.472 Test Loss: 1.160 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9708201885223389
Epoch: 11, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.309 Vali Acc: 0.472 Test Loss: 1.309 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1444313526153564
Epoch: 12, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.383 Vali Acc: 0.472 Test Loss: 1.383 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6563026905059814
Epoch: 13, Steps: 13 | Train Loss: 0.304 Vali Loss: 1.458 Vali Acc: 0.517 Test Loss: 1.458 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.544992446899414
Epoch: 14, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.624 Vali Acc: 0.478 Test Loss: 1.624 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps96_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 30887426
model size : 132.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.060593605041504
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.704 Vali Acc: 0.489 Test Loss: 0.704 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.0918331146240234
Epoch: 2, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.682 Vali Acc: 0.539 Test Loss: 0.682 Test Acc: 0.539
Validation loss decreased (-0.488882 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.8154335021972656
Epoch: 3, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.703 Vali Acc: 0.506 Test Loss: 0.703 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2189915180206299
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.716 Vali Acc: 0.556 Test Loss: 0.716 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555548).  Saving model ...
Epoch: 5 cost time: 1.5077743530273438
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.685 Vali Acc: 0.533 Test Loss: 0.685 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3883056640625
Epoch: 6, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.694 Vali Acc: 0.544 Test Loss: 0.694 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7837183475494385
Epoch: 7, Steps: 13 | Train Loss: 0.517 Vali Loss: 1.211 Vali Acc: 0.533 Test Loss: 1.211 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5299303531646729
Epoch: 8, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.800 Vali Acc: 0.556 Test Loss: 0.800 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7463195323944092
Epoch: 9, Steps: 13 | Train Loss: 0.435 Vali Loss: 1.143 Vali Acc: 0.494 Test Loss: 1.143 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9894442558288574
Epoch: 10, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.938 Vali Acc: 0.506 Test Loss: 0.938 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2630338668823242
Epoch: 11, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.953 Vali Acc: 0.483 Test Loss: 0.953 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2722768783569336
Epoch: 12, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.043 Vali Acc: 0.500 Test Loss: 1.043 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5214097499847412
Epoch: 13, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.004 Vali Acc: 0.556 Test Loss: 1.004 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.779496669769287
Epoch: 14, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.059 Vali Acc: 0.550 Test Loss: 1.059 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 30819842
model size : 132.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps96_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.996777057647705
Epoch: 1, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.686 Vali Acc: 0.539 Test Loss: 0.686 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.2031073570251465
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.675 Vali Acc: 0.522 Test Loss: 0.675 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1343724727630615
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.711 Vali Acc: 0.572 Test Loss: 0.711 Test Acc: 0.572
Validation loss decreased (-0.538882 --> -0.572215).  Saving model ...
Epoch: 4 cost time: 1.295034646987915
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.715 Vali Acc: 0.528 Test Loss: 0.715 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3007266521453857
Epoch: 5, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.703 Vali Acc: 0.511 Test Loss: 0.703 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0442276000976562
Epoch: 6, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.700 Vali Acc: 0.578 Test Loss: 0.700 Test Acc: 0.578
Validation loss decreased (-0.572215 --> -0.577771).  Saving model ...
Epoch: 7 cost time: 0.9040517807006836
Epoch: 7, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.727 Vali Acc: 0.506 Test Loss: 0.727 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3091886043548584
Epoch: 8, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.812 Vali Acc: 0.494 Test Loss: 0.812 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1644530296325684
Epoch: 9, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.812 Vali Acc: 0.539 Test Loss: 0.812 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0264346599578857
Epoch: 10, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.948 Vali Acc: 0.539 Test Loss: 0.948 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8641252517700195
Epoch: 11, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.864 Vali Acc: 0.506 Test Loss: 0.864 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.320465087890625
Epoch: 12, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.993 Vali Acc: 0.517 Test Loss: 0.993 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.362370252609253
Epoch: 13, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.961 Vali Acc: 0.522 Test Loss: 0.961 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0684609413146973
Epoch: 14, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.069 Vali Acc: 0.511 Test Loss: 1.069 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.178131103515625
Epoch: 15, Steps: 13 | Train Loss: 0.242 Vali Loss: 1.395 Vali Acc: 0.483 Test Loss: 1.395 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2478489875793457
Epoch: 16, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.140 Vali Acc: 0.528 Test Loss: 1.140 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps96_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 30786050
model size : 132.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.017267942428589
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.744 Vali Acc: 0.500 Test Loss: 0.744 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.616105556488037
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.701 Vali Acc: 0.544 Test Loss: 0.701 Test Acc: 0.544
Validation loss decreased (-0.499993 --> -0.544437).  Saving model ...
Epoch: 3 cost time: 1.8270115852355957
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.757 Vali Acc: 0.511 Test Loss: 0.757 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3019754886627197
Epoch: 4, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.698 Vali Acc: 0.556 Test Loss: 0.698 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555549).  Saving model ...
Epoch: 5 cost time: 2.0846688747406006
Epoch: 5, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.745 Vali Acc: 0.522 Test Loss: 0.745 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5130693912506104
Epoch: 6, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.781 Vali Acc: 0.511 Test Loss: 0.781 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9919562339782715
Epoch: 7, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.814 Vali Acc: 0.467 Test Loss: 0.814 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3772070407867432
Epoch: 8, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.891 Vali Acc: 0.550 Test Loss: 0.891 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6697630882263184
Epoch: 9, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.813 Vali Acc: 0.528 Test Loss: 0.813 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9788808822631836
Epoch: 10, Steps: 13 | Train Loss: 0.504 Vali Loss: 1.421 Vali Acc: 0.456 Test Loss: 1.421 Test Acc: 0.456
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.263195276260376
Epoch: 11, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.897 Vali Acc: 0.511 Test Loss: 0.897 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8831729888916016
Epoch: 12, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.034 Vali Acc: 0.511 Test Loss: 1.034 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.892552137374878
Epoch: 13, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.506 Vali Acc: 0.506 Test Loss: 1.506 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2386701107025146
Epoch: 14, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.212 Vali Acc: 0.489 Test Loss: 1.212 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 31014146
model size : 132.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.758622646331787
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.682 Vali Acc: 0.561 Test Loss: 0.682 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 1.5454819202423096
Epoch: 2, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.732 Vali Acc: 0.494 Test Loss: 0.732 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4525766372680664
Epoch: 3, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.689 Vali Acc: 0.578 Test Loss: 0.689 Test Acc: 0.578
Validation loss decreased (-0.561104 --> -0.577771).  Saving model ...
Epoch: 4 cost time: 1.1962931156158447
Epoch: 4, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.703 Vali Acc: 0.528 Test Loss: 0.703 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0314035415649414
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.725 Vali Acc: 0.478 Test Loss: 0.725 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3987107276916504
Epoch: 6, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.719 Vali Acc: 0.511 Test Loss: 0.719 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6848468780517578
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.727 Vali Acc: 0.539 Test Loss: 0.727 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5847511291503906
Epoch: 8, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.777 Vali Acc: 0.517 Test Loss: 0.777 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6873629093170166
Epoch: 9, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.963 Vali Acc: 0.522 Test Loss: 0.963 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1002535820007324
Epoch: 10, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.912 Vali Acc: 0.506 Test Loss: 0.912 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.385716438293457
Epoch: 11, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.892 Vali Acc: 0.533 Test Loss: 0.892 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9641046524047852
Epoch: 12, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.113 Vali Acc: 0.517 Test Loss: 1.113 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6280341148376465
Epoch: 13, Steps: 13 | Train Loss: 0.459 Vali Loss: 1.010 Vali Acc: 0.567 Test Loss: 1.010 Test Acc: 0.567
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 30955778
model size : 132.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3656413555145264
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.700 Vali Acc: 0.494 Test Loss: 0.700 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.7124001979827881
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.683 Vali Acc: 0.539 Test Loss: 0.683 Test Acc: 0.539
Validation loss decreased (-0.494437 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 0.7417843341827393
Epoch: 3, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.704 Vali Acc: 0.517 Test Loss: 0.704 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8137013912200928
Epoch: 4, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.703 Vali Acc: 0.522 Test Loss: 0.703 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6383302211761475
Epoch: 5, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.697 Vali Acc: 0.522 Test Loss: 0.697 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.365267276763916
Epoch: 6, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.773 Vali Acc: 0.522 Test Loss: 0.773 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1217875480651855
Epoch: 7, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.775 Vali Acc: 0.528 Test Loss: 0.775 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2556257247924805
Epoch: 8, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.780 Vali Acc: 0.528 Test Loss: 0.780 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9815535545349121
Epoch: 9, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.833 Vali Acc: 0.539 Test Loss: 0.833 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0689499378204346
Epoch: 10, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.903 Vali Acc: 0.522 Test Loss: 0.903 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3376762866973877
Epoch: 11, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.949 Vali Acc: 0.506 Test Loss: 0.949 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.332793951034546
Epoch: 12, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 30925058
model size : 132.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps116_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.879155158996582
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.9982259273529053
Epoch: 2, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.727 Vali Acc: 0.517 Test Loss: 0.727 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4241724014282227
Epoch: 3, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.833 Vali Acc: 0.494 Test Loss: 0.833 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8983020782470703
Epoch: 4, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.730 Vali Acc: 0.506 Test Loss: 0.730 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.034360647201538
Epoch: 5, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.808 Vali Acc: 0.494 Test Loss: 0.808 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5970001220703125
Epoch: 6, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.919 Vali Acc: 0.489 Test Loss: 0.919 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3032140731811523
Epoch: 7, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.998 Vali Acc: 0.444 Test Loss: 0.998 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2281169891357422
Epoch: 8, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.126 Vali Acc: 0.439 Test Loss: 1.126 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7985429763793945
Epoch: 9, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.034 Vali Acc: 0.472 Test Loss: 1.034 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.541487216949463
Epoch: 10, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.199 Vali Acc: 0.517 Test Loss: 1.199 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3755543231964111
Epoch: 11, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.399 Vali Acc: 0.528 Test Loss: 1.399 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps116_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 31182338
model size : 133.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6868972778320312
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.711 Vali Acc: 0.522 Test Loss: 0.711 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.6547610759735107
Epoch: 2, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.674 Vali Acc: 0.539 Test Loss: 0.674 Test Acc: 0.539
Validation loss decreased (-0.522215 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.1683759689331055
Epoch: 3, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.682 Vali Acc: 0.567 Test Loss: 0.682 Test Acc: 0.567
Validation loss decreased (-0.538882 --> -0.566660).  Saving model ...
Epoch: 4 cost time: 1.69767427444458
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.705 Vali Acc: 0.506 Test Loss: 0.705 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.099905014038086
Epoch: 5, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.748 Vali Acc: 0.500 Test Loss: 0.748 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7723498344421387
Epoch: 6, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.751 Vali Acc: 0.517 Test Loss: 0.751 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6104764938354492
Epoch: 7, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.759 Vali Acc: 0.483 Test Loss: 0.759 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.42464017868042
Epoch: 8, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.868 Vali Acc: 0.528 Test Loss: 0.868 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7804670333862305
Epoch: 9, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.890 Vali Acc: 0.483 Test Loss: 0.890 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2785136699676514
Epoch: 10, Steps: 13 | Train Loss: 0.469 Vali Loss: 1.140 Vali Acc: 0.450 Test Loss: 1.140 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.677126407623291
Epoch: 11, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.922 Vali Acc: 0.539 Test Loss: 0.922 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.747699499130249
Epoch: 12, Steps: 13 | Train Loss: 0.369 Vali Loss: 1.007 Vali Acc: 0.494 Test Loss: 1.007 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1900572776794434
Epoch: 13, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.098 Vali Acc: 0.472 Test Loss: 1.098 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 31127042
model size : 133.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps116_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4698421955108643
Epoch: 1, Steps: 13 | Train Loss: 0.829 Vali Loss: 0.726 Vali Acc: 0.517 Test Loss: 0.726 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 0.8819022178649902
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.694 Vali Acc: 0.528 Test Loss: 0.694 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.7904701232910156
Epoch: 3, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.707 Vali Acc: 0.489 Test Loss: 0.707 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9671709537506104
Epoch: 4, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.742 Vali Acc: 0.467 Test Loss: 0.742 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.030125379562378
Epoch: 5, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.730 Vali Acc: 0.544 Test Loss: 0.730 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544437).  Saving model ...
Epoch: 6 cost time: 0.8741300106048584
Epoch: 6, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.793 Vali Acc: 0.489 Test Loss: 0.793 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9943456649780273
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.812 Vali Acc: 0.489 Test Loss: 0.812 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9484059810638428
Epoch: 8, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.908 Vali Acc: 0.467 Test Loss: 0.908 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9357485771179199
Epoch: 9, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.888 Vali Acc: 0.500 Test Loss: 0.888 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.911421537399292
Epoch: 10, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.891 Vali Acc: 0.494 Test Loss: 0.891 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1925299167633057
Epoch: 11, Steps: 13 | Train Loss: 0.443 Vali Loss: 1.021 Vali Acc: 0.478 Test Loss: 1.021 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9533665180206299
Epoch: 12, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.080 Vali Acc: 0.522 Test Loss: 1.080 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.849745512008667
Epoch: 13, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.113 Vali Acc: 0.489 Test Loss: 1.113 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1446175575256348
Epoch: 14, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0436296463012695
Epoch: 15, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.411 Vali Acc: 0.489 Test Loss: 1.411 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps116_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 31099394
model size : 133.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.238746166229248
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.714 Vali Acc: 0.444 Test Loss: 0.714 Test Acc: 0.444
Validation loss decreased (inf --> -0.444437).  Saving model ...
Epoch: 2 cost time: 1.901186466217041
Epoch: 2, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.799 Vali Acc: 0.500 Test Loss: 0.799 Test Acc: 0.500
Validation loss decreased (-0.444437 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 1.5093762874603271
Epoch: 3, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.717 Vali Acc: 0.544 Test Loss: 0.717 Test Acc: 0.544
Validation loss decreased (-0.499992 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.6424171924591064
Epoch: 4, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.911 Vali Acc: 0.494 Test Loss: 0.911 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3104267120361328
Epoch: 5, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.738 Vali Acc: 0.489 Test Loss: 0.738 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.10335373878479
Epoch: 6, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.780 Vali Acc: 0.478 Test Loss: 0.780 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0467698574066162
Epoch: 7, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.843 Vali Acc: 0.478 Test Loss: 0.843 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0087120532989502
Epoch: 8, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.824 Vali Acc: 0.500 Test Loss: 0.824 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2022769451141357
Epoch: 9, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.922 Vali Acc: 0.478 Test Loss: 0.922 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5950851440429688
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.378556728363037
Epoch: 11, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.416 Vali Acc: 0.456 Test Loss: 1.416 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3034818172454834
Epoch: 12, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.203 Vali Acc: 0.489 Test Loss: 1.203 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0721194744110107
Epoch: 13, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.299 Vali Acc: 0.456 Test Loss: 1.299 Test Acc: 0.456
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 31366658
model size : 134.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.846379280090332
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.729 Vali Acc: 0.494 Test Loss: 0.729 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.767394781112671
Epoch: 2, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.699 Vali Acc: 0.494 Test Loss: 0.699 Test Acc: 0.494
Validation loss decreased (-0.494437 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.3311262130737305
Epoch: 3, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.703 Vali Acc: 0.561 Test Loss: 0.703 Test Acc: 0.561
Validation loss decreased (-0.494437 --> -0.561104).  Saving model ...
Epoch: 4 cost time: 1.0459978580474854
Epoch: 4, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.710 Vali Acc: 0.522 Test Loss: 0.710 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4047064781188965
Epoch: 5, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.733 Vali Acc: 0.467 Test Loss: 0.733 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.679020881652832
Epoch: 6, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.740 Vali Acc: 0.506 Test Loss: 0.740 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.188145399093628
Epoch: 7, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.759 Vali Acc: 0.528 Test Loss: 0.759 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0351481437683105
Epoch: 8, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.884 Vali Acc: 0.483 Test Loss: 0.884 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4741616249084473
Epoch: 9, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.923 Vali Acc: 0.556 Test Loss: 0.923 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6726386547088623
Epoch: 10, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.930 Vali Acc: 0.483 Test Loss: 0.930 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8631916046142578
Epoch: 11, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.986 Vali Acc: 0.478 Test Loss: 0.986 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1073553562164307
Epoch: 12, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.934 Vali Acc: 0.472 Test Loss: 0.934 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6673245429992676
Epoch: 13, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.988 Vali Acc: 0.483 Test Loss: 0.988 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 31317506
model size : 134.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.52785587310791
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.733 Vali Acc: 0.494 Test Loss: 0.733 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.8277091979980469
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.692 Vali Acc: 0.528 Test Loss: 0.692 Test Acc: 0.528
Validation loss decreased (-0.494437 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.9297828674316406
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.730 Vali Acc: 0.467 Test Loss: 0.730 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7348854541778564
Epoch: 4, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.690 Vali Acc: 0.556 Test Loss: 0.690 Test Acc: 0.556
Validation loss decreased (-0.527771 --> -0.555549).  Saving model ...
Epoch: 5 cost time: 0.9729511737823486
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.734 Vali Acc: 0.539 Test Loss: 0.734 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8230485916137695
Epoch: 6, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.748 Vali Acc: 0.561 Test Loss: 0.748 Test Acc: 0.561
Validation loss decreased (-0.555549 --> -0.561104).  Saving model ...
Epoch: 7 cost time: 0.8697655200958252
Epoch: 7, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.711 Vali Acc: 0.572 Test Loss: 0.711 Test Acc: 0.572
Validation loss decreased (-0.561104 --> -0.572215).  Saving model ...
Epoch: 8 cost time: 0.7869133949279785
Epoch: 8, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.014 Vali Acc: 0.433 Test Loss: 1.014 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0658042430877686
Epoch: 9, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.809 Vali Acc: 0.539 Test Loss: 0.809 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7072288990020752
Epoch: 10, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.826 Vali Acc: 0.556 Test Loss: 0.826 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9909214973449707
Epoch: 11, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.846 Vali Acc: 0.533 Test Loss: 0.846 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7522797584533691
Epoch: 12, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.938 Vali Acc: 0.500 Test Loss: 0.938 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8816990852355957
Epoch: 13, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.937 Vali Acc: 0.517 Test Loss: 0.937 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9914505481719971
Epoch: 14, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.016 Vali Acc: 0.506 Test Loss: 1.016 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.046790361404419
Epoch: 15, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.007 Vali Acc: 0.511 Test Loss: 1.007 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8940684795379639
Epoch: 16, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.013 Vali Acc: 0.522 Test Loss: 1.013 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0024867057800293
Epoch: 17, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.169 Vali Acc: 0.517 Test Loss: 1.169 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 31292930
model size : 134.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps144_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7504091262817383
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.700 Vali Acc: 0.494 Test Loss: 0.700 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.860053539276123
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.697 Vali Acc: 0.494 Test Loss: 0.697 Test Acc: 0.494
Validation loss decreased (-0.494437 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.1165943145751953
Epoch: 3, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.0376920700073242
Epoch: 4, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.724 Vali Acc: 0.483 Test Loss: 0.724 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.232978105545044
Epoch: 5, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.783 Vali Acc: 0.511 Test Loss: 0.783 Test Acc: 0.511
Validation loss decreased (-0.499993 --> -0.511103).  Saving model ...
Epoch: 6 cost time: 1.7284889221191406
Epoch: 6, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.818 Vali Acc: 0.433 Test Loss: 0.818 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4274747371673584
Epoch: 7, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.757 Vali Acc: 0.528 Test Loss: 0.757 Test Acc: 0.528
Validation loss decreased (-0.511103 --> -0.527770).  Saving model ...
Epoch: 8 cost time: 1.2764012813568115
Epoch: 8, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.820 Vali Acc: 0.533 Test Loss: 0.820 Test Acc: 0.533
Validation loss decreased (-0.527770 --> -0.533325).  Saving model ...
Epoch: 9 cost time: 1.2605571746826172
Epoch: 9, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.871 Vali Acc: 0.494 Test Loss: 0.871 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0766420364379883
Epoch: 10, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.926 Vali Acc: 0.478 Test Loss: 0.926 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5021722316741943
Epoch: 11, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.048 Vali Acc: 0.550 Test Loss: 1.048 Test Acc: 0.550
Validation loss decreased (-0.533325 --> -0.549990).  Saving model ...
Epoch: 12 cost time: 1.0993542671203613
Epoch: 12, Steps: 13 | Train Loss: 0.470 Vali Loss: 1.131 Vali Acc: 0.511 Test Loss: 1.131 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9203085899353027
Epoch: 13, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.053 Vali Acc: 0.539 Test Loss: 1.053 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1001813411712646
Epoch: 14, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.960 Vali Acc: 0.539 Test Loss: 0.960 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9325072765350342
Epoch: 15, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.308 Vali Acc: 0.578 Test Loss: 1.308 Test Acc: 0.578
Validation loss decreased (-0.549990 --> -0.577765).  Saving model ...
Epoch: 16 cost time: 0.8092811107635498
Epoch: 16, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.328 Vali Acc: 0.517 Test Loss: 1.328 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6922292709350586
Epoch: 17, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.588 Vali Acc: 0.511 Test Loss: 1.588 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0173754692077637
Epoch: 18, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.421 Vali Acc: 0.528 Test Loss: 1.421 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.99405837059021
Epoch: 19, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.596 Vali Acc: 0.528 Test Loss: 1.596 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8672473430633545
Epoch: 20, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.453 Vali Acc: 0.494 Test Loss: 1.453 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8860325813293457
Epoch: 21, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.633 Vali Acc: 0.594 Test Loss: 1.633 Test Acc: 0.594
Validation loss decreased (-0.577765 --> -0.594428).  Saving model ...
Epoch: 22 cost time: 0.7763972282409668
Epoch: 22, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.712 Vali Acc: 0.567 Test Loss: 1.712 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9461522102355957
Epoch: 23, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.983 Vali Acc: 0.511 Test Loss: 1.983 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2396998405456543
Epoch: 24, Steps: 13 | Train Loss: 0.120 Vali Loss: 2.673 Vali Acc: 0.506 Test Loss: 2.673 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9373135566711426
Epoch: 25, Steps: 13 | Train Loss: 0.137 Vali Loss: 2.410 Vali Acc: 0.511 Test Loss: 2.410 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.236631155014038
Epoch: 26, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.955 Vali Acc: 0.500 Test Loss: 1.955 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.032696008682251
Epoch: 27, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.230 Vali Acc: 0.500 Test Loss: 2.230 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4374847412109375
Epoch: 28, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.139 Vali Acc: 0.522 Test Loss: 2.139 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0662896633148193
Epoch: 29, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.142 Vali Acc: 0.550 Test Loss: 2.142 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2853419780731201
Epoch: 30, Steps: 13 | Train Loss: 0.161 Vali Loss: 2.101 Vali Acc: 0.533 Test Loss: 2.101 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.1812925338745117
Epoch: 31, Steps: 13 | Train Loss: 0.079 Vali Loss: 2.379 Vali Acc: 0.561 Test Loss: 2.379 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps144_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5944444444444444
model parameter : 31612418
model size : 135.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps144_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.45365047454834
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.692 Vali Acc: 0.544 Test Loss: 0.692 Test Acc: 0.544
Validation loss decreased (inf --> -0.544438).  Saving model ...
Epoch: 2 cost time: 0.835345983505249
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.708 Vali Acc: 0.517 Test Loss: 0.708 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9012329578399658
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.695 Vali Acc: 0.528 Test Loss: 0.695 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.223740816116333
Epoch: 4, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.742 Vali Acc: 0.456 Test Loss: 0.742 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.269984245300293
Epoch: 5, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.744 Vali Acc: 0.511 Test Loss: 0.744 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1881847381591797
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.726 Vali Acc: 0.522 Test Loss: 0.726 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7601363658905029
Epoch: 7, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.839 Vali Acc: 0.472 Test Loss: 0.839 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0462737083435059
Epoch: 8, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.896 Vali Acc: 0.472 Test Loss: 0.896 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0958971977233887
Epoch: 9, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.963 Vali Acc: 0.472 Test Loss: 0.963 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0302324295043945
Epoch: 10, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.971 Vali Acc: 0.461 Test Loss: 0.971 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9474966526031494
Epoch: 11, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.103 Vali Acc: 0.522 Test Loss: 1.103 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps144_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 31569410
model size : 135.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps144_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.1032474040985107
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.737 Vali Acc: 0.500 Test Loss: 0.737 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.0405921936035156
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.749 Vali Acc: 0.456 Test Loss: 0.749 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7366204261779785
Epoch: 3, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.704 Vali Acc: 0.533 Test Loss: 0.704 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 0.7447781562805176
Epoch: 4, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 0.8694970607757568
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.705 Vali Acc: 0.517 Test Loss: 0.705 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7973103523254395
Epoch: 6, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8298687934875488
Epoch: 7, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.725 Vali Acc: 0.511 Test Loss: 0.725 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9106850624084473
Epoch: 8, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.919 Vali Acc: 0.511 Test Loss: 0.919 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7865123748779297
Epoch: 9, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.815 Vali Acc: 0.561 Test Loss: 0.815 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561103).  Saving model ...
Epoch: 10 cost time: 0.7552034854888916
Epoch: 10, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.813 Vali Acc: 0.544 Test Loss: 0.813 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7064151763916016
Epoch: 11, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.875 Vali Acc: 0.522 Test Loss: 0.875 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8550679683685303
Epoch: 12, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.749518871307373
Epoch: 13, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.014 Vali Acc: 0.544 Test Loss: 1.014 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0251314640045166
Epoch: 14, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.974 Vali Acc: 0.561 Test Loss: 0.974 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6974406242370605
Epoch: 15, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.025 Vali Acc: 0.539 Test Loss: 1.025 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9976532459259033
Epoch: 16, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.188 Vali Acc: 0.494 Test Loss: 1.188 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8701207637786865
Epoch: 17, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.333 Vali Acc: 0.567 Test Loss: 1.333 Test Acc: 0.567
Validation loss decreased (-0.561103 --> -0.566653).  Saving model ...
Epoch: 18 cost time: 0.8895707130432129
Epoch: 18, Steps: 13 | Train Loss: 0.248 Vali Loss: 1.212 Vali Acc: 0.478 Test Loss: 1.212 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9510116577148438
Epoch: 19, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.230 Vali Acc: 0.511 Test Loss: 1.230 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8078291416168213
Epoch: 20, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.293 Vali Acc: 0.517 Test Loss: 1.293 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8851602077484131
Epoch: 21, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.219 Vali Acc: 0.522 Test Loss: 1.219 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9028098583221436
Epoch: 22, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.468 Vali Acc: 0.517 Test Loss: 1.468 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7098987102508545
Epoch: 23, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.434 Vali Acc: 0.517 Test Loss: 1.434 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8707132339477539
Epoch: 24, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.378 Vali Acc: 0.511 Test Loss: 1.378 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.797011137008667
Epoch: 25, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.661 Vali Acc: 0.528 Test Loss: 1.661 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8125605583190918
Epoch: 26, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.585 Vali Acc: 0.483 Test Loss: 1.585 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8497297763824463
Epoch: 27, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.654 Vali Acc: 0.533 Test Loss: 1.654 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps144_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 31547906
model size : 135.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps165_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.530108690261841
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.716 Vali Acc: 0.428 Test Loss: 0.716 Test Acc: 0.428
Validation loss decreased (inf --> -0.427771).  Saving model ...
Epoch: 2 cost time: 1.2468724250793457
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.718 Vali Acc: 0.483 Test Loss: 0.718 Test Acc: 0.483
Validation loss decreased (-0.427771 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 1.1189327239990234
Epoch: 3, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.807 Vali Acc: 0.506 Test Loss: 0.807 Test Acc: 0.506
Validation loss decreased (-0.483326 --> -0.505547).  Saving model ...
Epoch: 4 cost time: 1.1379244327545166
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.768 Vali Acc: 0.494 Test Loss: 0.768 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0369822978973389
Epoch: 5, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.770 Vali Acc: 0.506 Test Loss: 0.770 Test Acc: 0.506
Validation loss decreased (-0.505547 --> -0.505548).  Saving model ...
Epoch: 6 cost time: 1.326798439025879
Epoch: 6, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.768 Vali Acc: 0.450 Test Loss: 0.768 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9890329837799072
Epoch: 7, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.979 Vali Acc: 0.500 Test Loss: 0.979 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5289664268493652
Epoch: 8, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.925 Vali Acc: 0.461 Test Loss: 0.925 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1544773578643799
Epoch: 9, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.921 Vali Acc: 0.550 Test Loss: 0.921 Test Acc: 0.550
Validation loss decreased (-0.505548 --> -0.549991).  Saving model ...
Epoch: 10 cost time: 1.1054964065551758
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.067 Vali Acc: 0.489 Test Loss: 1.067 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1196808815002441
Epoch: 11, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.283 Vali Acc: 0.517 Test Loss: 1.283 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9656929969787598
Epoch: 12, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.137 Vali Acc: 0.494 Test Loss: 1.137 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1227927207946777
Epoch: 13, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.386 Vali Acc: 0.539 Test Loss: 1.386 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9571692943572998
Epoch: 14, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.478 Vali Acc: 0.456 Test Loss: 1.478 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3322205543518066
Epoch: 15, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.903 Vali Acc: 0.444 Test Loss: 1.903 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1184277534484863
Epoch: 16, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.668 Vali Acc: 0.533 Test Loss: 1.668 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1653757095336914
Epoch: 17, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.739 Vali Acc: 0.478 Test Loss: 1.739 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0893340110778809
Epoch: 18, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.837 Vali Acc: 0.561 Test Loss: 1.837 Test Acc: 0.561
Validation loss decreased (-0.549991 --> -0.561093).  Saving model ...
Epoch: 19 cost time: 1.4351963996887207
Epoch: 19, Steps: 13 | Train Loss: 0.225 Vali Loss: 2.086 Vali Acc: 0.478 Test Loss: 2.086 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1262407302856445
Epoch: 20, Steps: 13 | Train Loss: 0.154 Vali Loss: 2.113 Vali Acc: 0.500 Test Loss: 2.113 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.185213565826416
Epoch: 21, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.876 Vali Acc: 0.461 Test Loss: 1.876 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9743778705596924
Epoch: 22, Steps: 13 | Train Loss: 0.107 Vali Loss: 2.129 Vali Acc: 0.506 Test Loss: 2.129 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0853533744812012
Epoch: 23, Steps: 13 | Train Loss: 0.159 Vali Loss: 2.091 Vali Acc: 0.511 Test Loss: 2.091 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3114957809448242
Epoch: 24, Steps: 13 | Train Loss: 0.200 Vali Loss: 2.147 Vali Acc: 0.528 Test Loss: 2.147 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.201127290725708
Epoch: 25, Steps: 13 | Train Loss: 0.133 Vali Loss: 2.682 Vali Acc: 0.506 Test Loss: 2.682 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.461824655532837
Epoch: 26, Steps: 13 | Train Loss: 0.260 Vali Loss: 2.479 Vali Acc: 0.528 Test Loss: 2.479 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2755343914031982
Epoch: 27, Steps: 13 | Train Loss: 0.159 Vali Loss: 2.467 Vali Acc: 0.517 Test Loss: 2.467 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1286320686340332
Epoch: 28, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.521 Vali Acc: 0.517 Test Loss: 2.521 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps165_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 31935746
model size : 136.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps165_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.295457363128662
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.700 Vali Acc: 0.539 Test Loss: 0.700 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 0.7684340476989746
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.698 Vali Acc: 0.539 Test Loss: 0.698 Test Acc: 0.539
Validation loss decreased (-0.538882 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 0.849205732345581
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.704 Vali Acc: 0.556 Test Loss: 0.704 Test Acc: 0.556
Validation loss decreased (-0.538882 --> -0.555549).  Saving model ...
Epoch: 4 cost time: 1.0052766799926758
Epoch: 4, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.743 Vali Acc: 0.533 Test Loss: 0.743 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7167348861694336
Epoch: 5, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.733 Vali Acc: 0.506 Test Loss: 0.733 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0811502933502197
Epoch: 6, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.908 Vali Acc: 0.517 Test Loss: 0.908 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8182063102722168
Epoch: 7, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.901 Vali Acc: 0.489 Test Loss: 0.901 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7489845752716064
Epoch: 8, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.892 Vali Acc: 0.528 Test Loss: 0.892 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8986301422119141
Epoch: 9, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.994 Vali Acc: 0.500 Test Loss: 0.994 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2988085746765137
Epoch: 10, Steps: 13 | Train Loss: 0.350 Vali Loss: 1.082 Vali Acc: 0.544 Test Loss: 1.082 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.993720531463623
Epoch: 11, Steps: 13 | Train Loss: 0.414 Vali Loss: 1.065 Vali Acc: 0.522 Test Loss: 1.065 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2216227054595947
Epoch: 12, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.302 Vali Acc: 0.478 Test Loss: 1.302 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0326290130615234
Epoch: 13, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.065 Vali Acc: 0.472 Test Loss: 1.065 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps165_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 31898882
model size : 136.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps165_str165_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.283745765686035
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.718 Vali Acc: 0.428 Test Loss: 0.718 Test Acc: 0.428
Validation loss decreased (inf --> -0.427771).  Saving model ...
Epoch: 2 cost time: 1.0283150672912598
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.707 Vali Acc: 0.539 Test Loss: 0.707 Test Acc: 0.539
Validation loss decreased (-0.427771 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 0.7408363819122314
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.722 Vali Acc: 0.494 Test Loss: 0.722 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0189015865325928
Epoch: 4, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.700 Vali Acc: 0.517 Test Loss: 0.700 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9660344123840332
Epoch: 5, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7799866199493408
Epoch: 6, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.719 Vali Acc: 0.533 Test Loss: 0.719 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0966856479644775
Epoch: 7, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.814 Vali Acc: 0.467 Test Loss: 0.814 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0199408531188965
Epoch: 8, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.889 Vali Acc: 0.511 Test Loss: 0.889 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8351955413818359
Epoch: 9, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.016 Vali Acc: 0.494 Test Loss: 1.016 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2745721340179443
Epoch: 10, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.043 Vali Acc: 0.494 Test Loss: 1.043 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.949866771697998
Epoch: 11, Steps: 13 | Train Loss: 0.312 Vali Loss: 1.047 Vali Acc: 0.483 Test Loss: 1.047 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.173840045928955
Epoch: 12, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.094 Vali Acc: 0.506 Test Loss: 1.094 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps165_str165_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 31880450
model size : 136.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps192_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.175523281097412
Epoch: 1, Steps: 13 | Train Loss: 0.768 Vali Loss: 0.717 Vali Acc: 0.522 Test Loss: 0.717 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 1.245081901550293
Epoch: 2, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.732 Vali Acc: 0.506 Test Loss: 0.732 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.112882137298584
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.793 Vali Acc: 0.467 Test Loss: 0.793 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.597226858139038
Epoch: 4, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.750 Vali Acc: 0.500 Test Loss: 0.750 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1609852313995361
Epoch: 5, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.719 Vali Acc: 0.544 Test Loss: 0.719 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 6 cost time: 0.887791633605957
Epoch: 6, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.731 Vali Acc: 0.528 Test Loss: 0.731 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.521780014038086
Epoch: 7, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.820 Vali Acc: 0.556 Test Loss: 0.820 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555547).  Saving model ...
Epoch: 8 cost time: 1.1409146785736084
Epoch: 8, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.869 Vali Acc: 0.561 Test Loss: 0.869 Test Acc: 0.561
Validation loss decreased (-0.555547 --> -0.561102).  Saving model ...
Epoch: 9 cost time: 1.1295933723449707
Epoch: 9, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.958 Vali Acc: 0.517 Test Loss: 0.958 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4692044258117676
Epoch: 10, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.852 Vali Acc: 0.567 Test Loss: 0.852 Test Acc: 0.567
Validation loss decreased (-0.561102 --> -0.566658).  Saving model ...
Epoch: 11 cost time: 1.1879608631134033
Epoch: 11, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.945 Vali Acc: 0.550 Test Loss: 0.945 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2562520503997803
Epoch: 12, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.132 Vali Acc: 0.567 Test Loss: 1.132 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.375821828842163
Epoch: 13, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.566658 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 1.1358156204223633
Epoch: 14, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.001 Vali Acc: 0.606 Test Loss: 1.001 Test Acc: 0.606
Validation loss decreased (-0.599990 --> -0.605546).  Saving model ...
Epoch: 15 cost time: 1.0118353366851807
Epoch: 15, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.190 Vali Acc: 0.583 Test Loss: 1.190 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.161634922027588
Epoch: 16, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.135 Vali Acc: 0.506 Test Loss: 1.135 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6403117179870605
Epoch: 17, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.429 Vali Acc: 0.572 Test Loss: 1.429 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.290067434310913
Epoch: 18, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.303 Vali Acc: 0.539 Test Loss: 1.303 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.423874855041504
Epoch: 19, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.271 Vali Acc: 0.539 Test Loss: 1.271 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1002299785614014
Epoch: 20, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.703 Vali Acc: 0.583 Test Loss: 1.703 Test Acc: 0.583
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8788049221038818
Epoch: 21, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.670 Vali Acc: 0.550 Test Loss: 1.670 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.910830020904541
Epoch: 22, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.583 Vali Acc: 0.550 Test Loss: 1.583 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1996691226959229
Epoch: 23, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.747 Vali Acc: 0.572 Test Loss: 1.747 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9879796504974365
Epoch: 24, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.917 Vali Acc: 0.533 Test Loss: 1.917 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps192_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6055555555555555
model parameter : 32361986
model size : 138.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps192_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5916759967803955
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.705 Vali Acc: 0.461 Test Loss: 0.705 Test Acc: 0.461
Validation loss decreased (inf --> -0.461104).  Saving model ...
Epoch: 2 cost time: 0.9508848190307617
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.698 Vali Acc: 0.461 Test Loss: 0.698 Test Acc: 0.461
Validation loss decreased (-0.461104 --> -0.461104).  Saving model ...
Epoch: 3 cost time: 1.123140573501587
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.711 Vali Acc: 0.506 Test Loss: 0.711 Test Acc: 0.506
Validation loss decreased (-0.461104 --> -0.505548).  Saving model ...
Epoch: 4 cost time: 0.6904618740081787
Epoch: 4, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.717 Vali Acc: 0.489 Test Loss: 0.717 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9141473770141602
Epoch: 5, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.792 Vali Acc: 0.472 Test Loss: 0.792 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6485011577606201
Epoch: 6, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.872 Vali Acc: 0.444 Test Loss: 0.872 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7202122211456299
Epoch: 7, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.952 Vali Acc: 0.522 Test Loss: 0.952 Test Acc: 0.522
Validation loss decreased (-0.505548 --> -0.522213).  Saving model ...
Epoch: 8 cost time: 0.8232567310333252
Epoch: 8, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.842 Vali Acc: 0.550 Test Loss: 0.842 Test Acc: 0.550
Validation loss decreased (-0.522213 --> -0.549992).  Saving model ...
Epoch: 9 cost time: 0.7729761600494385
Epoch: 9, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.006 Vali Acc: 0.500 Test Loss: 1.006 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9250874519348145
Epoch: 10, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.053 Vali Acc: 0.483 Test Loss: 1.053 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9088337421417236
Epoch: 11, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.078 Vali Acc: 0.456 Test Loss: 1.078 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0638229846954346
Epoch: 12, Steps: 13 | Train Loss: 0.313 Vali Loss: 1.131 Vali Acc: 0.450 Test Loss: 1.131 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.858618974685669
Epoch: 13, Steps: 13 | Train Loss: 0.303 Vali Loss: 1.128 Vali Acc: 0.494 Test Loss: 1.128 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8529276847839355
Epoch: 14, Steps: 13 | Train Loss: 0.230 Vali Loss: 1.376 Vali Acc: 0.461 Test Loss: 1.376 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7934553623199463
Epoch: 15, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.548 Vali Acc: 0.483 Test Loss: 1.548 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8403773307800293
Epoch: 16, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.516 Vali Acc: 0.511 Test Loss: 1.516 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7399766445159912
Epoch: 17, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.693 Vali Acc: 0.500 Test Loss: 1.693 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7340054512023926
Epoch: 18, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.389 Vali Acc: 0.494 Test Loss: 1.389 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps192_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 32331266
model size : 138.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps192_str192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.50287127494812
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.722 Vali Acc: 0.483 Test Loss: 0.722 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 0.8303737640380859
Epoch: 2, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.715 Vali Acc: 0.483 Test Loss: 0.715 Test Acc: 0.483
Validation loss decreased (-0.483326 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 0.9429349899291992
Epoch: 3, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.699 Vali Acc: 0.522 Test Loss: 0.699 Test Acc: 0.522
Validation loss decreased (-0.483326 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 0.9642553329467773
Epoch: 4, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.738 Vali Acc: 0.483 Test Loss: 0.738 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9062108993530273
Epoch: 5, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.737 Vali Acc: 0.533 Test Loss: 0.737 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 0.7543060779571533
Epoch: 6, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.810 Vali Acc: 0.433 Test Loss: 0.810 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8994553089141846
Epoch: 7, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.742 Vali Acc: 0.544 Test Loss: 0.742 Test Acc: 0.544
Validation loss decreased (-0.533326 --> -0.544437).  Saving model ...
Epoch: 8 cost time: 0.8427414894104004
Epoch: 8, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.817 Vali Acc: 0.556 Test Loss: 0.817 Test Acc: 0.556
Validation loss decreased (-0.544437 --> -0.555547).  Saving model ...
Epoch: 9 cost time: 0.8069195747375488
Epoch: 9, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.865 Vali Acc: 0.528 Test Loss: 0.865 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9285891056060791
Epoch: 10, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.916 Vali Acc: 0.539 Test Loss: 0.916 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7763059139251709
Epoch: 11, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.037 Vali Acc: 0.539 Test Loss: 1.037 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7768635749816895
Epoch: 12, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.916 Vali Acc: 0.483 Test Loss: 0.916 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7458713054656982
Epoch: 13, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.050 Vali Acc: 0.539 Test Loss: 1.050 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8062763214111328
Epoch: 14, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7631163597106934
Epoch: 15, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.380 Vali Acc: 0.517 Test Loss: 1.380 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7948710918426514
Epoch: 16, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.225 Vali Acc: 0.522 Test Loss: 1.225 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9120233058929443
Epoch: 17, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8528599739074707
Epoch: 18, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.264 Vali Acc: 0.539 Test Loss: 1.264 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps192_str192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 32315906
model size : 137.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8536136150360107
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.715 Vali Acc: 0.500 Test Loss: 0.715 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.990908145904541
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.681 Vali Acc: 0.572 Test Loss: 0.681 Test Acc: 0.572
Validation loss decreased (-0.499993 --> -0.572215).  Saving model ...
Epoch: 3 cost time: 0.9261980056762695
Epoch: 3, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.702 Vali Acc: 0.544 Test Loss: 0.702 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5665090084075928
Epoch: 4, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.713 Vali Acc: 0.511 Test Loss: 0.713 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2312116622924805
Epoch: 5, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.814 Vali Acc: 0.483 Test Loss: 0.814 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9985816478729248
Epoch: 6, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.754 Vali Acc: 0.478 Test Loss: 0.754 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.171363115310669
Epoch: 7, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.862 Vali Acc: 0.517 Test Loss: 0.862 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1546883583068848
Epoch: 8, Steps: 13 | Train Loss: 0.509 Vali Loss: 1.053 Vali Acc: 0.489 Test Loss: 1.053 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1728594303131104
Epoch: 9, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.936 Vali Acc: 0.489 Test Loss: 0.936 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9552569389343262
Epoch: 10, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.949 Vali Acc: 0.522 Test Loss: 0.949 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7721548080444336
Epoch: 11, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.142 Vali Acc: 0.522 Test Loss: 1.142 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1761865615844727
Epoch: 12, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 32975618
model size : 140.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.670319080352783
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.689 Vali Acc: 0.522 Test Loss: 0.689 Test Acc: 0.522
Validation loss decreased (inf --> -0.522215).  Saving model ...
Epoch: 2 cost time: 0.7146668434143066
Epoch: 2, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.694 Vali Acc: 0.506 Test Loss: 0.694 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.722121000289917
Epoch: 3, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.731 Vali Acc: 0.489 Test Loss: 0.731 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.668057918548584
Epoch: 4, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.758 Vali Acc: 0.483 Test Loss: 0.758 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6375439167022705
Epoch: 5, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.753 Vali Acc: 0.500 Test Loss: 0.753 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7295494079589844
Epoch: 6, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.786 Vali Acc: 0.461 Test Loss: 0.786 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.833113431930542
Epoch: 7, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.827 Vali Acc: 0.528 Test Loss: 0.827 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527770).  Saving model ...
Epoch: 8 cost time: 0.7009303569793701
Epoch: 8, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.903 Vali Acc: 0.478 Test Loss: 0.903 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8116340637207031
Epoch: 9, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.984 Vali Acc: 0.506 Test Loss: 0.984 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0036084651947021
Epoch: 10, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.946 Vali Acc: 0.517 Test Loss: 0.946 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9203970432281494
Epoch: 11, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.052 Vali Acc: 0.478 Test Loss: 1.052 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7950470447540283
Epoch: 12, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.159 Vali Acc: 0.506 Test Loss: 1.159 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0883991718292236
Epoch: 13, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.096 Vali Acc: 0.528 Test Loss: 1.096 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7480564117431641
Epoch: 14, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.100 Vali Acc: 0.478 Test Loss: 1.100 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.023806095123291
Epoch: 15, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.392 Vali Acc: 0.506 Test Loss: 1.392 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7888576984405518
Epoch: 16, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.350 Vali Acc: 0.506 Test Loss: 1.350 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9565718173980713
Epoch: 17, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.278 Vali Acc: 0.461 Test Loss: 1.278 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 32951042
model size : 140.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.422715663909912
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.685 Vali Acc: 0.561 Test Loss: 0.685 Test Acc: 0.561
Validation loss decreased (inf --> -0.561104).  Saving model ...
Epoch: 2 cost time: 0.9763102531433105
Epoch: 2, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.681 Vali Acc: 0.567 Test Loss: 0.681 Test Acc: 0.567
Validation loss decreased (-0.561104 --> -0.566660).  Saving model ...
Epoch: 3 cost time: 0.7164833545684814
Epoch: 3, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.711 Vali Acc: 0.483 Test Loss: 0.711 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8145492076873779
Epoch: 4, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.712 Vali Acc: 0.522 Test Loss: 0.712 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.749932050704956
Epoch: 5, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.837 Vali Acc: 0.456 Test Loss: 0.837 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8135228157043457
Epoch: 6, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.740 Vali Acc: 0.528 Test Loss: 0.740 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7181875705718994
Epoch: 7, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.796 Vali Acc: 0.517 Test Loss: 0.796 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9092016220092773
Epoch: 8, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.830 Vali Acc: 0.533 Test Loss: 0.830 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8733048439025879
Epoch: 9, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.984 Vali Acc: 0.483 Test Loss: 0.984 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1117305755615234
Epoch: 10, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.967 Vali Acc: 0.517 Test Loss: 0.967 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0105082988739014
Epoch: 11, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.028 Vali Acc: 0.483 Test Loss: 1.028 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8769204616546631
Epoch: 12, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.948 Vali Acc: 0.539 Test Loss: 0.948 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el4_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 32938754
model size : 140.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps47_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8337645530700684
Epoch: 1, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.735 Vali Acc: 0.500 Test Loss: 0.735 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.342076063156128
Epoch: 2, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.751 Vali Acc: 0.494 Test Loss: 0.751 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3390791416168213
Epoch: 3, Steps: 13 | Train Loss: 0.851 Vali Loss: 0.750 Vali Acc: 0.506 Test Loss: 0.750 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505548).  Saving model ...
Epoch: 4 cost time: 1.3684091567993164
Epoch: 4, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.718 Vali Acc: 0.567 Test Loss: 0.718 Test Acc: 0.567
Validation loss decreased (-0.505548 --> -0.566659).  Saving model ...
Epoch: 5 cost time: 1.3603413105010986
Epoch: 5, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.720 Vali Acc: 0.528 Test Loss: 0.720 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2362499237060547
Epoch: 6, Steps: 13 | Train Loss: 0.781 Vali Loss: 0.826 Vali Acc: 0.506 Test Loss: 0.826 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1478681564331055
Epoch: 7, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.928 Vali Acc: 0.472 Test Loss: 0.928 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3021636009216309
Epoch: 8, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.898 Vali Acc: 0.511 Test Loss: 0.898 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.250791072845459
Epoch: 9, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.828 Vali Acc: 0.483 Test Loss: 0.828 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.315983772277832
Epoch: 10, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.869 Vali Acc: 0.500 Test Loss: 0.869 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1783068180084229
Epoch: 11, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.938 Vali Acc: 0.467 Test Loss: 0.938 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9552509784698486
Epoch: 12, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.980 Vali Acc: 0.550 Test Loss: 0.980 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.158808946609497
Epoch: 13, Steps: 13 | Train Loss: 1.025 Vali Loss: 1.532 Vali Acc: 0.472 Test Loss: 1.532 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.195112705230713
Epoch: 14, Steps: 13 | Train Loss: 0.622 Vali Loss: 1.221 Vali Acc: 0.478 Test Loss: 1.221 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps47_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 23156738
model size : 103.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps47_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.639157772064209
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.773 Vali Acc: 0.500 Test Loss: 0.773 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.3130972385406494
Epoch: 2, Steps: 13 | Train Loss: 0.778 Vali Loss: 0.785 Vali Acc: 0.500 Test Loss: 0.785 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.255993366241455
Epoch: 3, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.696 Vali Acc: 0.506 Test Loss: 0.696 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505549).  Saving model ...
Epoch: 4 cost time: 1.424412727355957
Epoch: 4, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.736 Vali Acc: 0.483 Test Loss: 0.736 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3829376697540283
Epoch: 5, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.750 Vali Acc: 0.539 Test Loss: 0.750 Test Acc: 0.539
Validation loss decreased (-0.505549 --> -0.538881).  Saving model ...
Epoch: 6 cost time: 0.8708012104034424
Epoch: 6, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.855 Vali Acc: 0.478 Test Loss: 0.855 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4738411903381348
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.920 Vali Acc: 0.444 Test Loss: 0.920 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3078961372375488
Epoch: 8, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.875 Vali Acc: 0.494 Test Loss: 0.875 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9596226215362549
Epoch: 9, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.925 Vali Acc: 0.539 Test Loss: 0.925 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8647122383117676
Epoch: 10, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.012 Vali Acc: 0.533 Test Loss: 1.012 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1789319515228271
Epoch: 11, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.991 Vali Acc: 0.517 Test Loss: 0.991 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1147043704986572
Epoch: 12, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.945 Vali Acc: 0.528 Test Loss: 0.945 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0364675521850586
Epoch: 13, Steps: 13 | Train Loss: 0.463 Vali Loss: 1.262 Vali Acc: 0.517 Test Loss: 1.262 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2692389488220215
Epoch: 14, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.216 Vali Acc: 0.544 Test Loss: 1.216 Test Acc: 0.544
Validation loss decreased (-0.538881 --> -0.544432).  Saving model ...
Epoch: 15 cost time: 0.9960839748382568
Epoch: 15, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.211 Vali Acc: 0.572 Test Loss: 1.211 Test Acc: 0.572
Validation loss decreased (-0.544432 --> -0.572210).  Saving model ...
Epoch: 16 cost time: 0.8300139904022217
Epoch: 16, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.279 Vali Acc: 0.528 Test Loss: 1.279 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.476630687713623
Epoch: 17, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.713 Vali Acc: 0.506 Test Loss: 1.713 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0930495262145996
Epoch: 18, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.336 Vali Acc: 0.511 Test Loss: 1.336 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.444007396697998
Epoch: 19, Steps: 13 | Train Loss: 0.234 Vali Loss: 1.404 Vali Acc: 0.506 Test Loss: 1.404 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.074878215789795
Epoch: 20, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.712 Vali Acc: 0.578 Test Loss: 1.712 Test Acc: 0.578
Validation loss decreased (-0.572210 --> -0.577761).  Saving model ...
Epoch: 21 cost time: 1.1534335613250732
Epoch: 21, Steps: 13 | Train Loss: 0.263 Vali Loss: 2.122 Vali Acc: 0.478 Test Loss: 2.122 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8038790225982666
Epoch: 22, Steps: 13 | Train Loss: 0.239 Vali Loss: 1.970 Vali Acc: 0.567 Test Loss: 1.970 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1694393157958984
Epoch: 23, Steps: 13 | Train Loss: 0.131 Vali Loss: 2.179 Vali Acc: 0.556 Test Loss: 2.179 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.810471773147583
Epoch: 24, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.238 Vali Acc: 0.528 Test Loss: 2.238 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7654447555541992
Epoch: 25, Steps: 13 | Train Loss: 0.166 Vali Loss: 2.365 Vali Acc: 0.561 Test Loss: 2.365 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8022310733795166
Epoch: 26, Steps: 13 | Train Loss: 0.186 Vali Loss: 2.583 Vali Acc: 0.556 Test Loss: 2.583 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9459254741668701
Epoch: 27, Steps: 13 | Train Loss: 0.195 Vali Loss: 2.878 Vali Acc: 0.561 Test Loss: 2.878 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2765350341796875
Epoch: 28, Steps: 13 | Train Loss: 0.162 Vali Loss: 2.572 Vali Acc: 0.544 Test Loss: 2.572 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8976390361785889
Epoch: 29, Steps: 13 | Train Loss: 0.186 Vali Loss: 2.734 Vali Acc: 0.483 Test Loss: 2.734 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0308215618133545
Epoch: 30, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.470 Vali Acc: 0.517 Test Loss: 2.470 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps47_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 23015426
model size : 102.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps47_str47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.485351800918579
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.7351183891296387
Epoch: 2, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.690 Vali Acc: 0.500 Test Loss: 0.690 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 0.776893138885498
Epoch: 3, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.705 Vali Acc: 0.517 Test Loss: 0.705 Test Acc: 0.517
Validation loss decreased (-0.499993 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 1.20615816116333
Epoch: 4, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.697 Vali Acc: 0.472 Test Loss: 0.697 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9119517803192139
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.714 Vali Acc: 0.511 Test Loss: 0.714 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8779282569885254
Epoch: 6, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.733 Vali Acc: 0.517 Test Loss: 0.733 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6738300323486328
Epoch: 7, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.741 Vali Acc: 0.517 Test Loss: 0.741 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0617868900299072
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.776 Vali Acc: 0.522 Test Loss: 0.776 Test Acc: 0.522
Validation loss decreased (-0.516660 --> -0.522214).  Saving model ...
Epoch: 9 cost time: 0.8334641456604004
Epoch: 9, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.795 Vali Acc: 0.561 Test Loss: 0.795 Test Acc: 0.561
Validation loss decreased (-0.522214 --> -0.561103).  Saving model ...
Epoch: 10 cost time: 0.8590850830078125
Epoch: 10, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.906 Vali Acc: 0.500 Test Loss: 0.906 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2066400051116943
Epoch: 11, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.844 Vali Acc: 0.550 Test Loss: 0.844 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0441226959228516
Epoch: 12, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.976 Vali Acc: 0.544 Test Loss: 0.976 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1231505870819092
Epoch: 13, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.966 Vali Acc: 0.539 Test Loss: 0.966 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9681148529052734
Epoch: 14, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.105 Vali Acc: 0.544 Test Loss: 1.105 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.069572925567627
Epoch: 15, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.062 Vali Acc: 0.528 Test Loss: 1.062 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.108879804611206
Epoch: 16, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.231 Vali Acc: 0.494 Test Loss: 1.231 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0056920051574707
Epoch: 17, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.431 Vali Acc: 0.522 Test Loss: 1.431 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8583095073699951
Epoch: 18, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.562 Vali Acc: 0.467 Test Loss: 1.562 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8305838108062744
Epoch: 19, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.466 Vali Acc: 0.506 Test Loss: 1.466 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps47_str47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 22944770
model size : 102.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps48_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.862786293029785
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.691 Vali Acc: 0.539 Test Loss: 0.691 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.2007381916046143
Epoch: 2, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.822 Vali Acc: 0.500 Test Loss: 0.822 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9471690654754639
Epoch: 3, Steps: 13 | Train Loss: 0.763 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1882851123809814
Epoch: 4, Steps: 13 | Train Loss: 0.906 Vali Loss: 0.762 Vali Acc: 0.550 Test Loss: 0.762 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549992).  Saving model ...
Epoch: 5 cost time: 1.4982333183288574
Epoch: 5, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.760 Vali Acc: 0.533 Test Loss: 0.760 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5498363971710205
Epoch: 6, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.733 Vali Acc: 0.489 Test Loss: 0.733 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.339606523513794
Epoch: 7, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.970 Vali Acc: 0.472 Test Loss: 0.970 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3654379844665527
Epoch: 8, Steps: 13 | Train Loss: 0.670 Vali Loss: 1.008 Vali Acc: 0.506 Test Loss: 1.008 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.488842487335205
Epoch: 9, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3184664249420166
Epoch: 10, Steps: 13 | Train Loss: 0.475 Vali Loss: 1.042 Vali Acc: 0.461 Test Loss: 1.042 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.291611909866333
Epoch: 11, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.391 Vali Acc: 0.511 Test Loss: 1.391 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1402649879455566
Epoch: 12, Steps: 13 | Train Loss: 0.564 Vali Loss: 1.163 Vali Acc: 0.522 Test Loss: 1.163 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1829209327697754
Epoch: 13, Steps: 13 | Train Loss: 0.502 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1442906856536865
Epoch: 14, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.623 Vali Acc: 0.511 Test Loss: 1.623 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps48_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23172866
model size : 103.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps48_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8698344230651855
Epoch: 1, Steps: 13 | Train Loss: 0.821 Vali Loss: 0.757 Vali Acc: 0.517 Test Loss: 0.757 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.079484462738037
Epoch: 2, Steps: 13 | Train Loss: 0.798 Vali Loss: 0.900 Vali Acc: 0.500 Test Loss: 0.900 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0874927043914795
Epoch: 3, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.738 Vali Acc: 0.494 Test Loss: 0.738 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1269092559814453
Epoch: 4, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.695 Vali Acc: 0.544 Test Loss: 0.695 Test Acc: 0.544
Validation loss decreased (-0.516659 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.2197294235229492
Epoch: 5, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.780 Vali Acc: 0.500 Test Loss: 0.780 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.788254976272583
Epoch: 6, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.698 Vali Acc: 0.517 Test Loss: 0.698 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.044886827468872
Epoch: 7, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.715 Vali Acc: 0.533 Test Loss: 0.715 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9200916290283203
Epoch: 8, Steps: 13 | Train Loss: 0.797 Vali Loss: 0.980 Vali Acc: 0.506 Test Loss: 0.980 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1632845401763916
Epoch: 9, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.731 Vali Acc: 0.511 Test Loss: 0.731 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.065302848815918
Epoch: 10, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.766 Vali Acc: 0.567 Test Loss: 0.766 Test Acc: 0.567
Validation loss decreased (-0.544437 --> -0.566659).  Saving model ...
Epoch: 11 cost time: 0.9320049285888672
Epoch: 11, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.824 Vali Acc: 0.489 Test Loss: 0.824 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.826383113861084
Epoch: 12, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.894 Vali Acc: 0.500 Test Loss: 0.894 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.314021348953247
Epoch: 13, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.991 Vali Acc: 0.506 Test Loss: 0.991 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2976288795471191
Epoch: 14, Steps: 13 | Train Loss: 0.407 Vali Loss: 1.074 Vali Acc: 0.472 Test Loss: 1.074 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3611299991607666
Epoch: 15, Steps: 13 | Train Loss: 0.311 Vali Loss: 1.360 Vali Acc: 0.544 Test Loss: 1.360 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.335021734237671
Epoch: 16, Steps: 13 | Train Loss: 0.442 Vali Loss: 1.930 Vali Acc: 0.533 Test Loss: 1.930 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2722346782684326
Epoch: 17, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.375 Vali Acc: 0.528 Test Loss: 1.375 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3092374801635742
Epoch: 18, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.717 Vali Acc: 0.500 Test Loss: 1.717 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4668622016906738
Epoch: 19, Steps: 13 | Train Loss: 0.296 Vali Loss: 2.018 Vali Acc: 0.494 Test Loss: 2.018 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5424821376800537
Epoch: 20, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.775 Vali Acc: 0.506 Test Loss: 1.775 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps48_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 23031554
model size : 102.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps48_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.103572368621826
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.705 Vali Acc: 0.472 Test Loss: 0.705 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 0.9476783275604248
Epoch: 2, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.690 Vali Acc: 0.533 Test Loss: 0.690 Test Acc: 0.533
Validation loss decreased (-0.472215 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 0.7708277702331543
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.716 Vali Acc: 0.500 Test Loss: 0.716 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8808329105377197
Epoch: 4, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.721 Vali Acc: 0.506 Test Loss: 0.721 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7313034534454346
Epoch: 5, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.851 Vali Acc: 0.500 Test Loss: 0.851 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6223127841949463
Epoch: 6, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.749 Vali Acc: 0.461 Test Loss: 0.749 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6174130439758301
Epoch: 7, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.786 Vali Acc: 0.528 Test Loss: 0.786 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9810566902160645
Epoch: 8, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.727 Vali Acc: 0.506 Test Loss: 0.727 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6665167808532715
Epoch: 9, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.776 Vali Acc: 0.517 Test Loss: 0.776 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7795255184173584
Epoch: 10, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.961 Vali Acc: 0.528 Test Loss: 0.961 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6931495666503906
Epoch: 11, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.813 Vali Acc: 0.506 Test Loss: 0.813 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7691614627838135
Epoch: 12, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.945 Vali Acc: 0.494 Test Loss: 0.945 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps48_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 22960898
model size : 102.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps51_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.147465467453003
Epoch: 1, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.772 Vali Acc: 0.500 Test Loss: 0.772 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4613981246948242
Epoch: 2, Steps: 13 | Train Loss: 0.770 Vali Loss: 0.854 Vali Acc: 0.522 Test Loss: 0.854 Test Acc: 0.522
Validation loss decreased (-0.499992 --> -0.522214).  Saving model ...
Epoch: 3 cost time: 1.5490806102752686
Epoch: 3, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.732 Vali Acc: 0.528 Test Loss: 0.732 Test Acc: 0.528
Validation loss decreased (-0.522214 --> -0.527770).  Saving model ...
Epoch: 4 cost time: 1.5859322547912598
Epoch: 4, Steps: 13 | Train Loss: 0.854 Vali Loss: 0.784 Vali Acc: 0.500 Test Loss: 0.784 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6774697303771973
Epoch: 5, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5412447452545166
Epoch: 6, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.764 Vali Acc: 0.522 Test Loss: 0.764 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3136379718780518
Epoch: 7, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.795 Vali Acc: 0.500 Test Loss: 0.795 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5851011276245117
Epoch: 8, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.863 Vali Acc: 0.483 Test Loss: 0.863 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4329946041107178
Epoch: 9, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.891 Vali Acc: 0.506 Test Loss: 0.891 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2420434951782227
Epoch: 10, Steps: 13 | Train Loss: 0.474 Vali Loss: 1.005 Vali Acc: 0.494 Test Loss: 1.005 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5507924556732178
Epoch: 11, Steps: 13 | Train Loss: 0.478 Vali Loss: 1.208 Vali Acc: 0.528 Test Loss: 1.208 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4724454879760742
Epoch: 12, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.209 Vali Acc: 0.522 Test Loss: 1.209 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5928492546081543
Epoch: 13, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.576 Vali Acc: 0.439 Test Loss: 1.576 Test Acc: 0.439
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps51_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 23196674
model size : 103.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps51_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3329520225524902
Epoch: 1, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 0.8479115962982178
Epoch: 2, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.0868940353393555
Epoch: 3, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.756 Vali Acc: 0.500 Test Loss: 0.756 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.082568645477295
Epoch: 4, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.705 Vali Acc: 0.533 Test Loss: 0.705 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8446521759033203
Epoch: 5, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.741 Vali Acc: 0.494 Test Loss: 0.741 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9886212348937988
Epoch: 6, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.776 Vali Acc: 0.483 Test Loss: 0.776 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2788469791412354
Epoch: 7, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.775 Vali Acc: 0.494 Test Loss: 0.775 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0859038829803467
Epoch: 8, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.736 Vali Acc: 0.567 Test Loss: 0.736 Test Acc: 0.567
Validation loss decreased (-0.549993 --> -0.566659).  Saving model ...
Epoch: 9 cost time: 0.9268710613250732
Epoch: 9, Steps: 13 | Train Loss: 0.567 Vali Loss: 1.023 Vali Acc: 0.483 Test Loss: 1.023 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2697312831878662
Epoch: 10, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.877 Vali Acc: 0.489 Test Loss: 0.877 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7239832878112793
Epoch: 11, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.901 Vali Acc: 0.511 Test Loss: 0.901 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0477023124694824
Epoch: 12, Steps: 13 | Train Loss: 0.503 Vali Loss: 1.037 Vali Acc: 0.511 Test Loss: 1.037 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8429670333862305
Epoch: 13, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.518 Vali Acc: 0.450 Test Loss: 1.518 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9999797344207764
Epoch: 14, Steps: 13 | Train Loss: 0.405 Vali Loss: 1.242 Vali Acc: 0.522 Test Loss: 1.242 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7633335590362549
Epoch: 15, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.445 Vali Acc: 0.517 Test Loss: 1.445 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8039183616638184
Epoch: 16, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.564 Vali Acc: 0.506 Test Loss: 1.564 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8076162338256836
Epoch: 17, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.916 Vali Acc: 0.500 Test Loss: 1.916 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8900208473205566
Epoch: 18, Steps: 13 | Train Loss: 0.320 Vali Loss: 2.113 Vali Acc: 0.522 Test Loss: 2.113 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps51_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 23067650
model size : 102.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps51_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.065493106842041
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.715 Vali Acc: 0.483 Test Loss: 0.715 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 0.9200975894927979
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.728 Vali Acc: 0.472 Test Loss: 0.728 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9142591953277588
Epoch: 3, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.758 Vali Acc: 0.494 Test Loss: 0.758 Test Acc: 0.494
Validation loss decreased (-0.483326 --> -0.494437).  Saving model ...
Epoch: 4 cost time: 0.7935464382171631
Epoch: 4, Steps: 13 | Train Loss: 0.767 Vali Loss: 0.734 Vali Acc: 0.467 Test Loss: 0.734 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8297879695892334
Epoch: 5, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.709 Vali Acc: 0.506 Test Loss: 0.709 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505548).  Saving model ...
Epoch: 6 cost time: 0.8597795963287354
Epoch: 6, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.746 Vali Acc: 0.489 Test Loss: 0.746 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8135876655578613
Epoch: 7, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.876 Vali Acc: 0.500 Test Loss: 0.876 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.84771728515625
Epoch: 8, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.715 Vali Acc: 0.544 Test Loss: 0.715 Test Acc: 0.544
Validation loss decreased (-0.505548 --> -0.544437).  Saving model ...
Epoch: 9 cost time: 1.1710479259490967
Epoch: 9, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.715 Vali Acc: 0.494 Test Loss: 0.715 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9486608505249023
Epoch: 10, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.747 Vali Acc: 0.506 Test Loss: 0.747 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1309261322021484
Epoch: 11, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.887 Vali Acc: 0.489 Test Loss: 0.887 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8491106033325195
Epoch: 12, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.921 Vali Acc: 0.550 Test Loss: 0.921 Test Acc: 0.550
Validation loss decreased (-0.544437 --> -0.549991).  Saving model ...
Epoch: 13 cost time: 0.7250270843505859
Epoch: 13, Steps: 13 | Train Loss: 0.448 Vali Loss: 1.073 Vali Acc: 0.544 Test Loss: 1.073 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8118839263916016
Epoch: 14, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.210 Vali Acc: 0.483 Test Loss: 1.210 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7295794486999512
Epoch: 15, Steps: 13 | Train Loss: 0.452 Vali Loss: 1.235 Vali Acc: 0.494 Test Loss: 1.235 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7028038501739502
Epoch: 16, Steps: 13 | Train Loss: 0.345 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9545290470123291
Epoch: 17, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.211 Vali Acc: 0.506 Test Loss: 1.211 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0341012477874756
Epoch: 18, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.405 Vali Acc: 0.506 Test Loss: 1.405 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3401787281036377
Epoch: 19, Steps: 13 | Train Loss: 0.271 Vali Loss: 1.500 Vali Acc: 0.483 Test Loss: 1.500 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3056650161743164
Epoch: 20, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.513 Vali Acc: 0.489 Test Loss: 1.513 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2351913452148438
Epoch: 21, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.483 Vali Acc: 0.517 Test Loss: 1.483 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0314640998840332
Epoch: 22, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.630 Vali Acc: 0.511 Test Loss: 1.630 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps51_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23003138
model size : 102.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.1115541458129883
Epoch: 1, Steps: 13 | Train Loss: 0.782 Vali Loss: 0.693 Vali Acc: 0.544 Test Loss: 0.693 Test Acc: 0.544
Validation loss decreased (inf --> -0.544438).  Saving model ...
Epoch: 2 cost time: 1.3223283290863037
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.778 Vali Acc: 0.500 Test Loss: 0.778 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7821133136749268
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.847 Vali Acc: 0.489 Test Loss: 0.847 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6410417556762695
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.718 Vali Acc: 0.528 Test Loss: 0.718 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.74299955368042
Epoch: 5, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.756 Vali Acc: 0.506 Test Loss: 0.756 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3409013748168945
Epoch: 6, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.772 Vali Acc: 0.522 Test Loss: 0.772 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.882173776626587
Epoch: 7, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.847 Vali Acc: 0.533 Test Loss: 0.847 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4261448383331299
Epoch: 8, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.776 Vali Acc: 0.511 Test Loss: 0.776 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8675875663757324
Epoch: 9, Steps: 13 | Train Loss: 0.614 Vali Loss: 1.211 Vali Acc: 0.489 Test Loss: 1.211 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6664354801177979
Epoch: 10, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.019 Vali Acc: 0.511 Test Loss: 1.019 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5871856212615967
Epoch: 11, Steps: 13 | Train Loss: 0.566 Vali Loss: 1.142 Vali Acc: 0.472 Test Loss: 1.142 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps53_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 23210498
model size : 103.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0518600940704346
Epoch: 1, Steps: 13 | Train Loss: 0.746 Vali Loss: 0.745 Vali Acc: 0.494 Test Loss: 0.745 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.2247703075408936
Epoch: 2, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.684 Vali Acc: 0.539 Test Loss: 0.684 Test Acc: 0.539
Validation loss decreased (-0.494437 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.4570093154907227
Epoch: 3, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.699 Vali Acc: 0.522 Test Loss: 0.699 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.521850824356079
Epoch: 4, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.695 Vali Acc: 0.506 Test Loss: 0.695 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.209606647491455
Epoch: 5, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.690 Vali Acc: 0.561 Test Loss: 0.690 Test Acc: 0.561
Validation loss decreased (-0.538882 --> -0.561104).  Saving model ...
Epoch: 6 cost time: 1.320237636566162
Epoch: 6, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.737 Vali Acc: 0.506 Test Loss: 0.737 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4184777736663818
Epoch: 7, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.719 Vali Acc: 0.517 Test Loss: 0.719 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0985691547393799
Epoch: 8, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.751 Vali Acc: 0.494 Test Loss: 0.751 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2531092166900635
Epoch: 9, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.763 Vali Acc: 0.511 Test Loss: 0.763 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9773218631744385
Epoch: 10, Steps: 13 | Train Loss: 0.562 Vali Loss: 0.774 Vali Acc: 0.533 Test Loss: 0.774 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2377893924713135
Epoch: 11, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.898 Vali Acc: 0.489 Test Loss: 0.898 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9117345809936523
Epoch: 12, Steps: 13 | Train Loss: 0.652 Vali Loss: 1.007 Vali Acc: 0.517 Test Loss: 1.007 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.006821632385254
Epoch: 13, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.958 Vali Acc: 0.544 Test Loss: 0.958 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0843470096588135
Epoch: 14, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.985 Vali Acc: 0.478 Test Loss: 0.985 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1695764064788818
Epoch: 15, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.162 Vali Acc: 0.528 Test Loss: 1.162 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps53_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 23093762
model size : 102.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.1287012100219727
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.707 Vali Acc: 0.450 Test Loss: 0.707 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 0.7833013534545898
Epoch: 2, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.732 Vali Acc: 0.472 Test Loss: 0.732 Test Acc: 0.472
Validation loss decreased (-0.449993 --> -0.472215).  Saving model ...
Epoch: 3 cost time: 0.8290092945098877
Epoch: 3, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.746 Vali Acc: 0.511 Test Loss: 0.746 Test Acc: 0.511
Validation loss decreased (-0.472215 --> -0.511104).  Saving model ...
Epoch: 4 cost time: 0.8866045475006104
Epoch: 4, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7877910137176514
Epoch: 5, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.732 Vali Acc: 0.450 Test Loss: 0.732 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7929515838623047
Epoch: 6, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.703 Vali Acc: 0.572 Test Loss: 0.703 Test Acc: 0.572
Validation loss decreased (-0.511104 --> -0.572215).  Saving model ...
Epoch: 7 cost time: 0.8987455368041992
Epoch: 7, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.820 Vali Acc: 0.489 Test Loss: 0.820 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.946413516998291
Epoch: 8, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.800 Vali Acc: 0.533 Test Loss: 0.800 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0149824619293213
Epoch: 9, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.782 Vali Acc: 0.511 Test Loss: 0.782 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9737422466278076
Epoch: 10, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.964 Vali Acc: 0.544 Test Loss: 0.964 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.799501895904541
Epoch: 11, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.902 Vali Acc: 0.511 Test Loss: 0.902 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8087337017059326
Epoch: 12, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.904 Vali Acc: 0.528 Test Loss: 0.904 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7817423343658447
Epoch: 13, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.919 Vali Acc: 0.506 Test Loss: 0.919 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.182403326034546
Epoch: 14, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.173 Vali Acc: 0.489 Test Loss: 1.173 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9986813068389893
Epoch: 15, Steps: 13 | Train Loss: 0.443 Vali Loss: 1.224 Vali Acc: 0.539 Test Loss: 1.224 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9215688705444336
Epoch: 16, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.162 Vali Acc: 0.450 Test Loss: 1.162 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps53_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 23032322
model size : 102.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps55_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.8090503215789795
Epoch: 1, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.725 Vali Acc: 0.517 Test Loss: 0.725 Test Acc: 0.517
Validation loss decreased (inf --> -0.516659).  Saving model ...
Epoch: 2 cost time: 1.2310962677001953
Epoch: 2, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.748 Vali Acc: 0.506 Test Loss: 0.748 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4772188663482666
Epoch: 3, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.758 Vali Acc: 0.489 Test Loss: 0.758 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3260657787322998
Epoch: 4, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.814 Vali Acc: 0.500 Test Loss: 0.814 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.373375654220581
Epoch: 5, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.802 Vali Acc: 0.483 Test Loss: 0.802 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.266402006149292
Epoch: 6, Steps: 13 | Train Loss: 0.851 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527771).  Saving model ...
Epoch: 7 cost time: 1.5898396968841553
Epoch: 7, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.928 Vali Acc: 0.511 Test Loss: 0.928 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4229044914245605
Epoch: 8, Steps: 13 | Train Loss: 0.590 Vali Loss: 1.014 Vali Acc: 0.511 Test Loss: 1.014 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4239685535430908
Epoch: 9, Steps: 13 | Train Loss: 0.631 Vali Loss: 1.600 Vali Acc: 0.500 Test Loss: 1.600 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3934988975524902
Epoch: 10, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.901 Vali Acc: 0.550 Test Loss: 0.901 Test Acc: 0.550
Validation loss decreased (-0.527771 --> -0.549991).  Saving model ...
Epoch: 11 cost time: 1.316518783569336
Epoch: 11, Steps: 13 | Train Loss: 0.626 Vali Loss: 1.053 Vali Acc: 0.500 Test Loss: 1.053 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2355999946594238
Epoch: 12, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.262 Vali Acc: 0.511 Test Loss: 1.262 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6289780139923096
Epoch: 13, Steps: 13 | Train Loss: 0.557 Vali Loss: 1.136 Vali Acc: 0.461 Test Loss: 1.136 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.421083688735962
Epoch: 14, Steps: 13 | Train Loss: 0.336 Vali Loss: 1.451 Vali Acc: 0.517 Test Loss: 1.451 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5994224548339844
Epoch: 15, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.587 Vali Acc: 0.417 Test Loss: 1.587 Test Acc: 0.417
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4769947528839111
Epoch: 16, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.657 Vali Acc: 0.522 Test Loss: 1.657 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6515944004058838
Epoch: 17, Steps: 13 | Train Loss: 0.277 Vali Loss: 3.249 Vali Acc: 0.494 Test Loss: 3.249 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4417393207550049
Epoch: 18, Steps: 13 | Train Loss: 0.920 Vali Loss: 1.857 Vali Acc: 0.483 Test Loss: 1.857 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4528334140777588
Epoch: 19, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3306679725646973
Epoch: 20, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.746 Vali Acc: 0.556 Test Loss: 1.746 Test Acc: 0.556
Validation loss decreased (-0.549991 --> -0.555538).  Saving model ...
Epoch: 21 cost time: 1.1368598937988281
Epoch: 21, Steps: 13 | Train Loss: 0.218 Vali Loss: 2.203 Vali Acc: 0.539 Test Loss: 2.203 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6527183055877686
Epoch: 22, Steps: 13 | Train Loss: 0.216 Vali Loss: 3.450 Vali Acc: 0.517 Test Loss: 3.450 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4194815158843994
Epoch: 23, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.847 Vali Acc: 0.556 Test Loss: 1.847 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3840749263763428
Epoch: 24, Steps: 13 | Train Loss: 0.276 Vali Loss: 2.101 Vali Acc: 0.522 Test Loss: 2.101 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5785458087921143
Epoch: 25, Steps: 13 | Train Loss: 0.207 Vali Loss: 2.177 Vali Acc: 0.533 Test Loss: 2.177 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2642412185668945
Epoch: 26, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.615 Vali Acc: 0.522 Test Loss: 2.615 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5792722702026367
Epoch: 27, Steps: 13 | Train Loss: 0.104 Vali Loss: 2.727 Vali Acc: 0.517 Test Loss: 2.727 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.435617208480835
Epoch: 28, Steps: 13 | Train Loss: 0.052 Vali Loss: 3.218 Vali Acc: 0.511 Test Loss: 3.218 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5091919898986816
Epoch: 29, Steps: 13 | Train Loss: 0.059 Vali Loss: 2.988 Vali Acc: 0.500 Test Loss: 2.988 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5401344299316406
Epoch: 30, Steps: 13 | Train Loss: 0.123 Vali Loss: 3.249 Vali Acc: 0.522 Test Loss: 3.249 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps55_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 23242754
model size : 103.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps55_str28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0843381881713867
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.852 Vali Acc: 0.494 Test Loss: 0.852 Test Acc: 0.494
Validation loss decreased (inf --> -0.494436).  Saving model ...
Epoch: 2 cost time: 0.9710698127746582
Epoch: 2, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.752 Vali Acc: 0.511 Test Loss: 0.752 Test Acc: 0.511
Validation loss decreased (-0.494436 --> -0.511104).  Saving model ...
Epoch: 3 cost time: 0.9713335037231445
Epoch: 3, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.738 Vali Acc: 0.494 Test Loss: 0.738 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6242661476135254
Epoch: 4, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.763 Vali Acc: 0.506 Test Loss: 0.763 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4430797100067139
Epoch: 5, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.733 Vali Acc: 0.500 Test Loss: 0.733 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6072072982788086
Epoch: 6, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.789 Vali Acc: 0.483 Test Loss: 0.789 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4394302368164062
Epoch: 7, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.871 Vali Acc: 0.511 Test Loss: 0.871 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4236626625061035
Epoch: 8, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.883 Vali Acc: 0.494 Test Loss: 0.883 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2278943061828613
Epoch: 9, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.919 Vali Acc: 0.483 Test Loss: 0.919 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.415092945098877
Epoch: 10, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.919 Vali Acc: 0.556 Test Loss: 0.919 Test Acc: 0.556
Validation loss decreased (-0.511104 --> -0.555546).  Saving model ...
Epoch: 11 cost time: 0.9988229274749756
Epoch: 11, Steps: 13 | Train Loss: 0.485 Vali Loss: 1.047 Vali Acc: 0.456 Test Loss: 1.047 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1579506397247314
Epoch: 12, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.182 Vali Acc: 0.494 Test Loss: 1.182 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6237726211547852
Epoch: 13, Steps: 13 | Train Loss: 0.514 Vali Loss: 1.042 Vali Acc: 0.550 Test Loss: 1.042 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6283659934997559
Epoch: 14, Steps: 13 | Train Loss: 0.445 Vali Loss: 1.480 Vali Acc: 0.483 Test Loss: 1.480 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.837435007095337
Epoch: 15, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.093 Vali Acc: 0.522 Test Loss: 1.093 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.015683889389038
Epoch: 16, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.227 Vali Acc: 0.539 Test Loss: 1.227 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1626646518707275
Epoch: 17, Steps: 13 | Train Loss: 0.232 Vali Loss: 1.964 Vali Acc: 0.489 Test Loss: 1.964 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1979756355285645
Epoch: 18, Steps: 13 | Train Loss: 0.478 Vali Loss: 2.083 Vali Acc: 0.506 Test Loss: 2.083 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1065433025360107
Epoch: 19, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.484 Vali Acc: 0.550 Test Loss: 1.484 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3729138374328613
Epoch: 20, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.723 Vali Acc: 0.528 Test Loss: 1.723 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps55_str28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 23122946
model size : 102.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps55_str55_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.0896573066711426
Epoch: 1, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.717 Vali Acc: 0.478 Test Loss: 0.717 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 1.1343090534210205
Epoch: 2, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.705 Vali Acc: 0.500 Test Loss: 0.705 Test Acc: 0.500
Validation loss decreased (-0.477771 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 0.7858161926269531
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.713 Vali Acc: 0.522 Test Loss: 0.713 Test Acc: 0.522
Validation loss decreased (-0.499993 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 1.2222561836242676
Epoch: 4, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.707 Vali Acc: 0.461 Test Loss: 0.707 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6329786777496338
Epoch: 5, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.743 Vali Acc: 0.500 Test Loss: 0.743 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1386950016021729
Epoch: 6, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.699 Vali Acc: 0.544 Test Loss: 0.699 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 7 cost time: 0.8819079399108887
Epoch: 7, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.725 Vali Acc: 0.517 Test Loss: 0.725 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1923093795776367
Epoch: 8, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.733 Vali Acc: 0.489 Test Loss: 0.733 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.015270471572876
Epoch: 9, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.789 Vali Acc: 0.456 Test Loss: 0.789 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9521365165710449
Epoch: 10, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.805 Vali Acc: 0.483 Test Loss: 0.805 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.30092453956604
Epoch: 11, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.823 Vali Acc: 0.500 Test Loss: 0.823 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9396193027496338
Epoch: 12, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.835 Vali Acc: 0.494 Test Loss: 0.835 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2180895805358887
Epoch: 13, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.968 Vali Acc: 0.494 Test Loss: 0.968 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7112290859222412
Epoch: 14, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.358 Vali Acc: 0.478 Test Loss: 1.358 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9793241024017334
Epoch: 15, Steps: 13 | Train Loss: 0.465 Vali Loss: 1.086 Vali Acc: 0.522 Test Loss: 1.086 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1363005638122559
Epoch: 16, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.216 Vali Acc: 0.494 Test Loss: 1.216 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps55_str55_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 23061506
model size : 102.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps58_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.0120317935943604
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.686 Vali Acc: 0.528 Test Loss: 0.686 Test Acc: 0.528
Validation loss decreased (inf --> -0.527771).  Saving model ...
Epoch: 2 cost time: 1.2965006828308105
Epoch: 2, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.741 Vali Acc: 0.506 Test Loss: 0.741 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.420100450515747
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.694 Vali Acc: 0.550 Test Loss: 0.694 Test Acc: 0.550
Validation loss decreased (-0.527771 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.1822950839996338
Epoch: 4, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.735 Vali Acc: 0.506 Test Loss: 0.735 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.171020746231079
Epoch: 5, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.903 Vali Acc: 0.489 Test Loss: 0.903 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.185420274734497
Epoch: 6, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.776 Vali Acc: 0.533 Test Loss: 0.776 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2368130683898926
Epoch: 7, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.997 Vali Acc: 0.511 Test Loss: 0.997 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2636325359344482
Epoch: 8, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.871 Vali Acc: 0.517 Test Loss: 0.871 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0706326961517334
Epoch: 9, Steps: 13 | Train Loss: 0.556 Vali Loss: 1.317 Vali Acc: 0.472 Test Loss: 1.317 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2995197772979736
Epoch: 10, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.595 Vali Acc: 0.522 Test Loss: 1.595 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3766076564788818
Epoch: 11, Steps: 13 | Train Loss: 0.460 Vali Loss: 1.499 Vali Acc: 0.472 Test Loss: 1.499 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2015881538391113
Epoch: 12, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.568 Vali Acc: 0.539 Test Loss: 1.568 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3944146633148193
Epoch: 13, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.814 Vali Acc: 0.500 Test Loss: 1.814 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps58_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23272706
model size : 103.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps58_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.767874002456665
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.720 Vali Acc: 0.511 Test Loss: 0.720 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 1.1965103149414062
Epoch: 2, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.706 Vali Acc: 0.478 Test Loss: 0.706 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4564177989959717
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.702 Vali Acc: 0.517 Test Loss: 0.702 Test Acc: 0.517
Validation loss decreased (-0.511104 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 0.9846682548522949
Epoch: 4, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.837 Vali Acc: 0.500 Test Loss: 0.837 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9991960525512695
Epoch: 5, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
Validation loss decreased (-0.516660 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 1.4208247661590576
Epoch: 6, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.761 Vali Acc: 0.506 Test Loss: 0.761 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2371327877044678
Epoch: 7, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.847 Vali Acc: 0.494 Test Loss: 0.847 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4475679397583008
Epoch: 8, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.790 Vali Acc: 0.500 Test Loss: 0.790 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0055689811706543
Epoch: 9, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.788 Vali Acc: 0.489 Test Loss: 0.788 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1286401748657227
Epoch: 10, Steps: 13 | Train Loss: 0.539 Vali Loss: 1.118 Vali Acc: 0.528 Test Loss: 1.118 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1210260391235352
Epoch: 11, Steps: 13 | Train Loss: 0.481 Vali Loss: 1.121 Vali Acc: 0.450 Test Loss: 1.121 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0127513408660889
Epoch: 12, Steps: 13 | Train Loss: 0.468 Vali Loss: 1.217 Vali Acc: 0.522 Test Loss: 1.217 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2687718868255615
Epoch: 13, Steps: 13 | Train Loss: 0.451 Vali Loss: 1.525 Vali Acc: 0.550 Test Loss: 1.525 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1092140674591064
Epoch: 14, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.352 Vali Acc: 0.506 Test Loss: 1.352 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.441326379776001
Epoch: 15, Steps: 13 | Train Loss: 0.289 Vali Loss: 1.454 Vali Acc: 0.511 Test Loss: 1.454 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps58_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23165186
model size : 103.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps58_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6237916946411133
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.712 Vali Acc: 0.517 Test Loss: 0.712 Test Acc: 0.517
Validation loss decreased (inf --> -0.516660).  Saving model ...
Epoch: 2 cost time: 1.0579991340637207
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.741 Vali Acc: 0.511 Test Loss: 0.741 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9777600765228271
Epoch: 3, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.700 Vali Acc: 0.506 Test Loss: 0.700 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.218109130859375
Epoch: 4, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.690 Vali Acc: 0.544 Test Loss: 0.690 Test Acc: 0.544
Validation loss decreased (-0.516660 --> -0.544438).  Saving model ...
Epoch: 5 cost time: 0.8437485694885254
Epoch: 5, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.708 Vali Acc: 0.533 Test Loss: 0.708 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.774730920791626
Epoch: 6, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.765 Vali Acc: 0.500 Test Loss: 0.765 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.879310131072998
Epoch: 7, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.825 Vali Acc: 0.500 Test Loss: 0.825 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6029653549194336
Epoch: 8, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.769 Vali Acc: 0.500 Test Loss: 0.769 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5677063465118408
Epoch: 9, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.750 Vali Acc: 0.517 Test Loss: 0.750 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8615727424621582
Epoch: 10, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.833 Vali Acc: 0.567 Test Loss: 0.833 Test Acc: 0.567
Validation loss decreased (-0.544438 --> -0.566658).  Saving model ...
Epoch: 11 cost time: 0.9751276969909668
Epoch: 11, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.820 Vali Acc: 0.478 Test Loss: 0.820 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9599456787109375
Epoch: 12, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.872 Vali Acc: 0.472 Test Loss: 0.872 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.280125617980957
Epoch: 13, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.149 Vali Acc: 0.522 Test Loss: 1.149 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.03733491897583
Epoch: 14, Steps: 13 | Train Loss: 0.494 Vali Loss: 1.069 Vali Acc: 0.494 Test Loss: 1.069 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.005173921585083
Epoch: 15, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.012 Vali Acc: 0.494 Test Loss: 1.012 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8221101760864258
Epoch: 16, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.209 Vali Acc: 0.533 Test Loss: 1.209 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8940365314483643
Epoch: 17, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.305 Vali Acc: 0.533 Test Loss: 1.305 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0058767795562744
Epoch: 18, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.223 Vali Acc: 0.539 Test Loss: 1.223 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.923048734664917
Epoch: 19, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.345 Vali Acc: 0.539 Test Loss: 1.345 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1716361045837402
Epoch: 20, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.544 Vali Acc: 0.522 Test Loss: 1.544 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps58_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 23106818
model size : 102.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps61_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.860419750213623
Epoch: 1, Steps: 13 | Train Loss: 0.826 Vali Loss: 0.680 Vali Acc: 0.589 Test Loss: 0.680 Test Acc: 0.589
Validation loss decreased (inf --> -0.588882).  Saving model ...
Epoch: 2 cost time: 1.3746860027313232
Epoch: 2, Steps: 13 | Train Loss: 0.844 Vali Loss: 0.715 Vali Acc: 0.467 Test Loss: 0.715 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4006624221801758
Epoch: 3, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.793 Vali Acc: 0.500 Test Loss: 0.793 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2785844802856445
Epoch: 4, Steps: 13 | Train Loss: 0.783 Vali Loss: 0.794 Vali Acc: 0.500 Test Loss: 0.794 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.143876552581787
Epoch: 5, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.793 Vali Acc: 0.528 Test Loss: 0.793 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.52703857421875
Epoch: 6, Steps: 13 | Train Loss: 0.809 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3853275775909424
Epoch: 7, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.721 Vali Acc: 0.533 Test Loss: 0.721 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.274937391281128
Epoch: 8, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.794 Vali Acc: 0.522 Test Loss: 0.794 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3126192092895508
Epoch: 9, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.772 Vali Acc: 0.467 Test Loss: 0.772 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0656864643096924
Epoch: 10, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.881 Vali Acc: 0.494 Test Loss: 0.881 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9845433235168457
Epoch: 11, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.955 Vali Acc: 0.533 Test Loss: 0.955 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps61_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 23308802
model size : 103.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7804298400878906
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.699 Vali Acc: 0.489 Test Loss: 0.699 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.1788125038146973
Epoch: 2, Steps: 13 | Train Loss: 0.748 Vali Loss: 0.724 Vali Acc: 0.489 Test Loss: 0.724 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0909645557403564
Epoch: 3, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.732 Vali Acc: 0.500 Test Loss: 0.732 Test Acc: 0.500
Validation loss decreased (-0.488882 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 1.4592370986938477
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.703 Vali Acc: 0.528 Test Loss: 0.703 Test Acc: 0.528
Validation loss decreased (-0.499993 --> -0.527771).  Saving model ...
Epoch: 5 cost time: 1.140763521194458
Epoch: 5, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.693 Vali Acc: 0.528 Test Loss: 0.693 Test Acc: 0.528
Validation loss decreased (-0.527771 --> -0.527771).  Saving model ...
Epoch: 6 cost time: 1.153930902481079
Epoch: 6, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.835 Vali Acc: 0.522 Test Loss: 0.835 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.239509105682373
Epoch: 7, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.984 Vali Acc: 0.500 Test Loss: 0.984 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9884498119354248
Epoch: 8, Steps: 13 | Train Loss: 0.756 Vali Loss: 0.780 Vali Acc: 0.506 Test Loss: 0.780 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0905907154083252
Epoch: 9, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.728 Vali Acc: 0.489 Test Loss: 0.728 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9979434013366699
Epoch: 10, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.797 Vali Acc: 0.472 Test Loss: 0.797 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9245350360870361
Epoch: 11, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
Validation loss decreased (-0.527771 --> -0.549992).  Saving model ...
Epoch: 12 cost time: 1.1021711826324463
Epoch: 12, Steps: 13 | Train Loss: 0.499 Vali Loss: 1.141 Vali Acc: 0.517 Test Loss: 1.141 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9721598625183105
Epoch: 13, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.852 Vali Acc: 0.511 Test Loss: 0.852 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4058153629302979
Epoch: 14, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.020 Vali Acc: 0.489 Test Loss: 1.020 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.166731595993042
Epoch: 15, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.461 Vali Acc: 0.494 Test Loss: 1.461 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2657594680786133
Epoch: 16, Steps: 13 | Train Loss: 0.554 Vali Loss: 1.305 Vali Acc: 0.494 Test Loss: 1.305 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.274111270904541
Epoch: 17, Steps: 13 | Train Loss: 0.263 Vali Loss: 1.200 Vali Acc: 0.522 Test Loss: 1.200 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.481872320175171
Epoch: 18, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.426 Vali Acc: 0.483 Test Loss: 1.426 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3255705833435059
Epoch: 19, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.406 Vali Acc: 0.456 Test Loss: 1.406 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.036067008972168
Epoch: 20, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.673 Vali Acc: 0.456 Test Loss: 1.673 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9755368232727051
Epoch: 21, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.643 Vali Acc: 0.489 Test Loss: 1.643 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23207426
model size : 103.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps61_str61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3017096519470215
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.701 Vali Acc: 0.483 Test Loss: 0.701 Test Acc: 0.483
Validation loss decreased (inf --> -0.483326).  Saving model ...
Epoch: 2 cost time: 1.3386690616607666
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.705 Vali Acc: 0.539 Test Loss: 0.705 Test Acc: 0.539
Validation loss decreased (-0.483326 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 0.8635926246643066
Epoch: 3, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.697 Vali Acc: 0.478 Test Loss: 0.697 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1874432563781738
Epoch: 4, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.703 Vali Acc: 0.544 Test Loss: 0.703 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.0258541107177734
Epoch: 5, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.694 Vali Acc: 0.489 Test Loss: 0.694 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0147533416748047
Epoch: 6, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.834 Vali Acc: 0.511 Test Loss: 0.834 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7577266693115234
Epoch: 7, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.716 Vali Acc: 0.539 Test Loss: 0.716 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1247613430023193
Epoch: 8, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.781 Vali Acc: 0.483 Test Loss: 0.781 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9438402652740479
Epoch: 9, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.727 Vali Acc: 0.528 Test Loss: 0.727 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1966135501861572
Epoch: 10, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.743 Vali Acc: 0.544 Test Loss: 0.743 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2630510330200195
Epoch: 11, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.861 Vali Acc: 0.461 Test Loss: 0.861 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2607576847076416
Epoch: 12, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.878 Vali Acc: 0.506 Test Loss: 0.878 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9609103202819824
Epoch: 13, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.908 Vali Acc: 0.489 Test Loss: 0.908 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.996823787689209
Epoch: 14, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.938 Vali Acc: 0.489 Test Loss: 0.938 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps61_str61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 23152130
model size : 102.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps64_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.374864339828491
Epoch: 1, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.779 Vali Acc: 0.500 Test Loss: 0.779 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4039502143859863
Epoch: 2, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.705 Vali Acc: 0.494 Test Loss: 0.705 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4787354469299316
Epoch: 3, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.843 Vali Acc: 0.506 Test Loss: 0.843 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505547).  Saving model ...
Epoch: 4 cost time: 1.7618637084960938
Epoch: 4, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.716 Vali Acc: 0.489 Test Loss: 0.716 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4024553298950195
Epoch: 5, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.701 Vali Acc: 0.572 Test Loss: 0.701 Test Acc: 0.572
Validation loss decreased (-0.505547 --> -0.572215).  Saving model ...
Epoch: 6 cost time: 1.6528377532958984
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.717 Vali Acc: 0.556 Test Loss: 0.717 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.23392653465271
Epoch: 7, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.730 Vali Acc: 0.572 Test Loss: 0.730 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.648893117904663
Epoch: 8, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.776 Vali Acc: 0.528 Test Loss: 0.776 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1463074684143066
Epoch: 9, Steps: 13 | Train Loss: 0.483 Vali Loss: 1.034 Vali Acc: 0.506 Test Loss: 1.034 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5449554920196533
Epoch: 10, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.959 Vali Acc: 0.517 Test Loss: 0.959 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3321309089660645
Epoch: 11, Steps: 13 | Train Loss: 0.491 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6419355869293213
Epoch: 12, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.148 Vali Acc: 0.478 Test Loss: 1.148 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.145442247390747
Epoch: 13, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.101 Vali Acc: 0.522 Test Loss: 1.101 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4629812240600586
Epoch: 14, Steps: 13 | Train Loss: 0.295 Vali Loss: 1.300 Vali Acc: 0.556 Test Loss: 1.300 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1024508476257324
Epoch: 15, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.576 Vali Acc: 0.522 Test Loss: 1.576 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps64_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 23357186
model size : 103.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps64_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4915549755096436
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.700 Vali Acc: 0.567 Test Loss: 0.700 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 0.8692705631256104
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.704 Vali Acc: 0.494 Test Loss: 0.704 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8766236305236816
Epoch: 3, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.741 Vali Acc: 0.517 Test Loss: 0.741 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7623016834259033
Epoch: 4, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.879 Vali Acc: 0.506 Test Loss: 0.879 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9549064636230469
Epoch: 5, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.689 Vali Acc: 0.511 Test Loss: 0.689 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7670645713806152
Epoch: 6, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.687 Vali Acc: 0.550 Test Loss: 0.687 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0171387195587158
Epoch: 7, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.735 Vali Acc: 0.594 Test Loss: 0.735 Test Acc: 0.594
Validation loss decreased (-0.566660 --> -0.594437).  Saving model ...
Epoch: 8 cost time: 0.9511799812316895
Epoch: 8, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.829 Vali Acc: 0.533 Test Loss: 0.829 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.038299798965454
Epoch: 9, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.861 Vali Acc: 0.506 Test Loss: 0.861 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3332340717315674
Epoch: 10, Steps: 13 | Train Loss: 0.517 Vali Loss: 1.154 Vali Acc: 0.511 Test Loss: 1.154 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1944382190704346
Epoch: 11, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.990 Vali Acc: 0.450 Test Loss: 0.990 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3897364139556885
Epoch: 12, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.435 Vali Acc: 0.489 Test Loss: 1.435 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1509499549865723
Epoch: 13, Steps: 13 | Train Loss: 0.462 Vali Loss: 1.408 Vali Acc: 0.478 Test Loss: 1.408 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0062177181243896
Epoch: 14, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.196 Vali Acc: 0.467 Test Loss: 1.196 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.346421480178833
Epoch: 15, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.335 Vali Acc: 0.511 Test Loss: 1.335 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.202559232711792
Epoch: 16, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.344 Vali Acc: 0.533 Test Loss: 1.344 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8412504196166992
Epoch: 17, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.442 Vali Acc: 0.489 Test Loss: 1.442 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps64_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5944444444444444
model parameter : 23252738
model size : 103.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps64_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6688108444213867
Epoch: 1, Steps: 13 | Train Loss: 0.755 Vali Loss: 0.677 Vali Acc: 0.567 Test Loss: 0.677 Test Acc: 0.567
Validation loss decreased (inf --> -0.566660).  Saving model ...
Epoch: 2 cost time: 0.8473687171936035
Epoch: 2, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.700 Vali Acc: 0.522 Test Loss: 0.700 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1971800327301025
Epoch: 3, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.685 Vali Acc: 0.539 Test Loss: 0.685 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0143182277679443
Epoch: 4, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.686 Vali Acc: 0.533 Test Loss: 0.686 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.870246171951294
Epoch: 5, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.734 Vali Acc: 0.506 Test Loss: 0.734 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1838140487670898
Epoch: 6, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8016104698181152
Epoch: 7, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.727 Vali Acc: 0.556 Test Loss: 0.727 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1838209629058838
Epoch: 8, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.694 Vali Acc: 0.539 Test Loss: 0.694 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9751636981964111
Epoch: 9, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.942 Vali Acc: 0.511 Test Loss: 0.942 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9975094795227051
Epoch: 10, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.709 Vali Acc: 0.544 Test Loss: 0.709 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1740868091583252
Epoch: 11, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.870 Vali Acc: 0.517 Test Loss: 0.870 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps64_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 23200514
model size : 103.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps68_str17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.2372612953186035
Epoch: 1, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.774 Vali Acc: 0.500 Test Loss: 0.774 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.4367637634277344
Epoch: 2, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.681 Vali Acc: 0.561 Test Loss: 0.681 Test Acc: 0.561
Validation loss decreased (-0.499992 --> -0.561104).  Saving model ...
Epoch: 3 cost time: 1.8368780612945557
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.719 Vali Acc: 0.511 Test Loss: 0.719 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3791682720184326
Epoch: 4, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3445312976837158
Epoch: 5, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.725 Vali Acc: 0.556 Test Loss: 0.725 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9304733276367188
Epoch: 6, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.865 Vali Acc: 0.494 Test Loss: 0.865 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2355420589447021
Epoch: 7, Steps: 13 | Train Loss: 0.720 Vali Loss: 1.082 Vali Acc: 0.506 Test Loss: 1.082 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2531309127807617
Epoch: 8, Steps: 13 | Train Loss: 0.632 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2004053592681885
Epoch: 9, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.884 Vali Acc: 0.556 Test Loss: 0.884 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7214901447296143
Epoch: 10, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.807 Vali Acc: 0.511 Test Loss: 0.807 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5579917430877686
Epoch: 11, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.877 Vali Acc: 0.506 Test Loss: 0.877 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4563982486724854
Epoch: 12, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.835 Vali Acc: 0.517 Test Loss: 0.835 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps68_str17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 23406338
model size : 103.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5057427883148193
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 0.710 Vali Acc: 0.467 Test Loss: 0.710 Test Acc: 0.467
Validation loss decreased (inf --> -0.466660).  Saving model ...
Epoch: 2 cost time: 1.392643928527832
Epoch: 2, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.724 Vali Acc: 0.483 Test Loss: 0.724 Test Acc: 0.483
Validation loss decreased (-0.466660 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 1.2495439052581787
Epoch: 3, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.708 Vali Acc: 0.494 Test Loss: 0.708 Test Acc: 0.494
Validation loss decreased (-0.483326 --> -0.494437).  Saving model ...
Epoch: 4 cost time: 1.3895916938781738
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.707 Vali Acc: 0.533 Test Loss: 0.707 Test Acc: 0.533
Validation loss decreased (-0.494437 --> -0.533326).  Saving model ...
Epoch: 5 cost time: 1.3806917667388916
Epoch: 5, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.802 Vali Acc: 0.494 Test Loss: 0.802 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.356748342514038
Epoch: 6, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.723 Vali Acc: 0.539 Test Loss: 0.723 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 7 cost time: 1.2876148223876953
Epoch: 7, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.742 Vali Acc: 0.511 Test Loss: 0.742 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5666022300720215
Epoch: 8, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.753 Vali Acc: 0.517 Test Loss: 0.753 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8841772079467773
Epoch: 9, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.793 Vali Acc: 0.533 Test Loss: 0.793 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.466968059539795
Epoch: 10, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.821 Vali Acc: 0.517 Test Loss: 0.821 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.11781644821167
Epoch: 11, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.893 Vali Acc: 0.517 Test Loss: 0.893 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8946866989135742
Epoch: 12, Steps: 13 | Train Loss: 0.423 Vali Loss: 1.052 Vali Acc: 0.544 Test Loss: 1.052 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544434).  Saving model ...
Epoch: 13 cost time: 0.9655661582946777
Epoch: 13, Steps: 13 | Train Loss: 0.458 Vali Loss: 1.053 Vali Acc: 0.506 Test Loss: 1.053 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1081602573394775
Epoch: 14, Steps: 13 | Train Loss: 0.393 Vali Loss: 1.207 Vali Acc: 0.533 Test Loss: 1.207 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.013932704925537
Epoch: 15, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.277 Vali Acc: 0.539 Test Loss: 1.277 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8978819847106934
Epoch: 16, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.282 Vali Acc: 0.533 Test Loss: 1.282 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0581321716308594
Epoch: 17, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.575 Vali Acc: 0.500 Test Loss: 1.575 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9680352210998535
Epoch: 18, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.657 Vali Acc: 0.528 Test Loss: 1.657 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1501126289367676
Epoch: 19, Steps: 13 | Train Loss: 0.225 Vali Loss: 1.992 Vali Acc: 0.539 Test Loss: 1.992 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0328912734985352
Epoch: 20, Steps: 13 | Train Loss: 0.176 Vali Loss: 1.804 Vali Acc: 0.489 Test Loss: 1.804 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.251105546951294
Epoch: 21, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.846 Vali Acc: 0.550 Test Loss: 1.846 Test Acc: 0.550
Validation loss decreased (-0.544434 --> -0.549982).  Saving model ...
Epoch: 22 cost time: 0.9331376552581787
Epoch: 22, Steps: 13 | Train Loss: 0.181 Vali Loss: 2.049 Vali Acc: 0.522 Test Loss: 2.049 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0008091926574707
Epoch: 23, Steps: 13 | Train Loss: 0.170 Vali Loss: 2.253 Vali Acc: 0.506 Test Loss: 2.253 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8170127868652344
Epoch: 24, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.754 Vali Acc: 0.522 Test Loss: 1.754 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.996953010559082
Epoch: 25, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.971 Vali Acc: 0.511 Test Loss: 1.971 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.038450002670288
Epoch: 26, Steps: 13 | Train Loss: 0.104 Vali Loss: 2.275 Vali Acc: 0.494 Test Loss: 2.275 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8835840225219727
Epoch: 27, Steps: 13 | Train Loss: 0.217 Vali Loss: 2.393 Vali Acc: 0.494 Test Loss: 2.393 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0511186122894287
Epoch: 28, Steps: 13 | Train Loss: 0.075 Vali Loss: 2.309 Vali Acc: 0.517 Test Loss: 2.309 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1282737255096436
Epoch: 29, Steps: 13 | Train Loss: 0.101 Vali Loss: 2.445 Vali Acc: 0.500 Test Loss: 2.445 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8682544231414795
Epoch: 30, Steps: 13 | Train Loss: 0.046 Vali Loss: 2.535 Vali Acc: 0.544 Test Loss: 2.535 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0826072692871094
Epoch: 31, Steps: 13 | Train Loss: 0.097 Vali Loss: 2.415 Vali Acc: 0.539 Test Loss: 2.415 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23308034
model size : 103.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps68_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.418672561645508
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.1842117309570312
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.694 Vali Acc: 0.506 Test Loss: 0.694 Test Acc: 0.506
Validation loss decreased (-0.499993 --> -0.505549).  Saving model ...
Epoch: 3 cost time: 0.9374654293060303
Epoch: 3, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.690 Vali Acc: 0.550 Test Loss: 0.690 Test Acc: 0.550
Validation loss decreased (-0.505549 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 1.0936853885650635
Epoch: 4, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.718 Vali Acc: 0.511 Test Loss: 0.718 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8762798309326172
Epoch: 5, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.744 Vali Acc: 0.494 Test Loss: 0.744 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5744335651397705
Epoch: 6, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.794 Vali Acc: 0.489 Test Loss: 0.794 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1743955612182617
Epoch: 7, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.741 Vali Acc: 0.489 Test Loss: 0.741 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0355839729309082
Epoch: 8, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.750 Vali Acc: 0.506 Test Loss: 0.750 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9596812725067139
Epoch: 9, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.855 Vali Acc: 0.461 Test Loss: 0.855 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7728221416473389
Epoch: 10, Steps: 13 | Train Loss: 0.608 Vali Loss: 1.098 Vali Acc: 0.528 Test Loss: 1.098 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2117412090301514
Epoch: 11, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.833 Vali Acc: 0.472 Test Loss: 0.833 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8672997951507568
Epoch: 12, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.871 Vali Acc: 0.489 Test Loss: 0.871 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7437765598297119
Epoch: 13, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.944 Vali Acc: 0.489 Test Loss: 0.944 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps68_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23258882
model size : 103.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps72_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.085954189300537
Epoch: 1, Steps: 13 | Train Loss: 0.805 Vali Loss: 0.757 Vali Acc: 0.500 Test Loss: 0.757 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.1110002994537354
Epoch: 2, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (-0.499992 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.5188918113708496
Epoch: 3, Steps: 13 | Train Loss: 0.771 Vali Loss: 0.967 Vali Acc: 0.500 Test Loss: 0.967 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9612078666687012
Epoch: 4, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.729 Vali Acc: 0.494 Test Loss: 0.729 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5678033828735352
Epoch: 5, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.693 Vali Acc: 0.561 Test Loss: 0.693 Test Acc: 0.561
Validation loss decreased (-0.499993 --> -0.561104).  Saving model ...
Epoch: 6 cost time: 1.178661823272705
Epoch: 6, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.756 Vali Acc: 0.517 Test Loss: 0.756 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8422048091888428
Epoch: 7, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.845 Vali Acc: 0.494 Test Loss: 0.845 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.224367380142212
Epoch: 8, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.992 Vali Acc: 0.472 Test Loss: 0.992 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1844792366027832
Epoch: 9, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.884 Vali Acc: 0.533 Test Loss: 0.884 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1351392269134521
Epoch: 10, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.873 Vali Acc: 0.489 Test Loss: 0.873 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.216088056564331
Epoch: 11, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.017 Vali Acc: 0.472 Test Loss: 1.017 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1726984977722168
Epoch: 12, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.932 Vali Acc: 0.517 Test Loss: 0.932 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2633402347564697
Epoch: 13, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.185 Vali Acc: 0.517 Test Loss: 1.185 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.342341423034668
Epoch: 14, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.343 Vali Acc: 0.489 Test Loss: 1.343 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1712841987609863
Epoch: 15, Steps: 13 | Train Loss: 0.352 Vali Loss: 1.198 Vali Acc: 0.544 Test Loss: 1.198 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps72_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 23461634
model size : 104.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps72_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.867784261703491
Epoch: 1, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.739 Vali Acc: 0.500 Test Loss: 0.739 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.8349366188049316
Epoch: 2, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.727 Vali Acc: 0.478 Test Loss: 0.727 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3984253406524658
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (-0.499993 --> -0.499993).  Saving model ...
Epoch: 4 cost time: 0.9370789527893066
Epoch: 4, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.683 Vali Acc: 0.550 Test Loss: 0.683 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.3249032497406006
Epoch: 5, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.699 Vali Acc: 0.517 Test Loss: 0.699 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1052453517913818
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.715 Vali Acc: 0.506 Test Loss: 0.715 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4327116012573242
Epoch: 7, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.734 Vali Acc: 0.528 Test Loss: 0.734 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0312881469726562
Epoch: 8, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.772 Vali Acc: 0.494 Test Loss: 0.772 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4116718769073486
Epoch: 9, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.794 Vali Acc: 0.522 Test Loss: 0.794 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.243898868560791
Epoch: 10, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.932 Vali Acc: 0.528 Test Loss: 0.932 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9590373039245605
Epoch: 11, Steps: 13 | Train Loss: 0.600 Vali Loss: 1.260 Vali Acc: 0.494 Test Loss: 1.260 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.283301830291748
Epoch: 12, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.918 Vali Acc: 0.478 Test Loss: 0.918 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0041587352752686
Epoch: 13, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.070 Vali Acc: 0.483 Test Loss: 1.070 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9652631282806396
Epoch: 14, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps72_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23369474
model size : 103.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps72_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.71244215965271
Epoch: 1, Steps: 13 | Train Loss: 0.745 Vali Loss: 0.708 Vali Acc: 0.506 Test Loss: 0.708 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.992499589920044
Epoch: 2, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.693 Vali Acc: 0.494 Test Loss: 0.693 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8169958591461182
Epoch: 3, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.681 Vali Acc: 0.600 Test Loss: 0.681 Test Acc: 0.600
Validation loss decreased (-0.505548 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 0.9654054641723633
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.700 Vali Acc: 0.544 Test Loss: 0.700 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7081217765808105
Epoch: 5, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.697 Vali Acc: 0.528 Test Loss: 0.697 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0574686527252197
Epoch: 6, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.707 Vali Acc: 0.528 Test Loss: 0.707 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7123012542724609
Epoch: 7, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.697 Vali Acc: 0.494 Test Loss: 0.697 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0660147666931152
Epoch: 8, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9446208477020264
Epoch: 9, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.749 Vali Acc: 0.489 Test Loss: 0.749 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6671090126037598
Epoch: 10, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.875 Vali Acc: 0.544 Test Loss: 0.875 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8966741561889648
Epoch: 11, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.824 Vali Acc: 0.494 Test Loss: 0.824 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8632917404174805
Epoch: 12, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.973 Vali Acc: 0.506 Test Loss: 0.973 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9269757270812988
Epoch: 13, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.908 Vali Acc: 0.522 Test Loss: 0.908 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps72_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6
model parameter : 23323394
model size : 103.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps77_str20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.704946756362915
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.758 Vali Acc: 0.500 Test Loss: 0.758 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.1821064949035645
Epoch: 2, Steps: 13 | Train Loss: 0.800 Vali Loss: 0.706 Vali Acc: 0.494 Test Loss: 0.706 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1187779903411865
Epoch: 3, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.975 Vali Acc: 0.500 Test Loss: 0.975 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8210301399230957
Epoch: 4, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.730 Vali Acc: 0.506 Test Loss: 0.730 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505548).  Saving model ...
Epoch: 5 cost time: 0.9294538497924805
Epoch: 5, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.682 Vali Acc: 0.550 Test Loss: 0.682 Test Acc: 0.550
Validation loss decreased (-0.505548 --> -0.549993).  Saving model ...
Epoch: 6 cost time: 0.9669198989868164
Epoch: 6, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.805 Vali Acc: 0.511 Test Loss: 0.805 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9426465034484863
Epoch: 7, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.952 Vali Acc: 0.494 Test Loss: 0.952 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9361793994903564
Epoch: 8, Steps: 13 | Train Loss: 0.593 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0451881885528564
Epoch: 9, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.852 Vali Acc: 0.500 Test Loss: 0.852 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0369720458984375
Epoch: 10, Steps: 13 | Train Loss: 0.538 Vali Loss: 1.207 Vali Acc: 0.506 Test Loss: 1.207 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.58842134475708
Epoch: 11, Steps: 13 | Train Loss: 0.571 Vali Loss: 1.169 Vali Acc: 0.461 Test Loss: 1.169 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7470505237579346
Epoch: 12, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.051 Vali Acc: 0.472 Test Loss: 1.051 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2707693576812744
Epoch: 13, Steps: 13 | Train Loss: 0.431 Vali Loss: 1.186 Vali Acc: 0.494 Test Loss: 1.186 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9154727458953857
Epoch: 14, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.082 Vali Acc: 0.522 Test Loss: 1.082 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8886082172393799
Epoch: 15, Steps: 13 | Train Loss: 0.417 Vali Loss: 1.297 Vali Acc: 0.478 Test Loss: 1.297 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps77_str20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23520770
model size : 104.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps77_str39_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4097979068756104
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.708 Vali Acc: 0.450 Test Loss: 0.708 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 1.2124409675598145
Epoch: 2, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.732 Vali Acc: 0.494 Test Loss: 0.732 Test Acc: 0.494
Validation loss decreased (-0.449993 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 0.8549759387969971
Epoch: 3, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.693 Vali Acc: 0.544 Test Loss: 0.693 Test Acc: 0.544
Validation loss decreased (-0.494437 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 0.9932422637939453
Epoch: 4, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.708 Vali Acc: 0.517 Test Loss: 0.708 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8883066177368164
Epoch: 5, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.782 Vali Acc: 0.472 Test Loss: 0.782 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8224637508392334
Epoch: 6, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.736 Vali Acc: 0.506 Test Loss: 0.736 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8010149002075195
Epoch: 7, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.773 Vali Acc: 0.506 Test Loss: 0.773 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8930518627166748
Epoch: 8, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.727 Vali Acc: 0.494 Test Loss: 0.727 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9816389083862305
Epoch: 9, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.769 Vali Acc: 0.528 Test Loss: 0.769 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7794573307037354
Epoch: 10, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.801 Vali Acc: 0.550 Test Loss: 0.801 Test Acc: 0.550
Validation loss decreased (-0.544438 --> -0.549992).  Saving model ...
Epoch: 11 cost time: 0.6745970249176025
Epoch: 11, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.840 Vali Acc: 0.522 Test Loss: 0.840 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8480360507965088
Epoch: 12, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.211 Vali Acc: 0.478 Test Loss: 1.211 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8004546165466309
Epoch: 13, Steps: 13 | Train Loss: 0.425 Vali Loss: 1.147 Vali Acc: 0.522 Test Loss: 1.147 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7647831439971924
Epoch: 14, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.143 Vali Acc: 0.556 Test Loss: 1.143 Test Acc: 0.556
Validation loss decreased (-0.549992 --> -0.555544).  Saving model ...
Epoch: 15 cost time: 1.216702938079834
Epoch: 15, Steps: 13 | Train Loss: 0.424 Vali Loss: 1.390 Vali Acc: 0.489 Test Loss: 1.390 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9812288284301758
Epoch: 16, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.381 Vali Acc: 0.456 Test Loss: 1.381 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9450328350067139
Epoch: 17, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.472 Vali Acc: 0.483 Test Loss: 1.472 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.178384780883789
Epoch: 18, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.683 Vali Acc: 0.528 Test Loss: 1.683 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.931950569152832
Epoch: 19, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.824 Vali Acc: 0.461 Test Loss: 1.824 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2151453495025635
Epoch: 20, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.883 Vali Acc: 0.472 Test Loss: 1.883 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8368794918060303
Epoch: 21, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.890 Vali Acc: 0.550 Test Loss: 1.890 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2137253284454346
Epoch: 22, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.998 Vali Acc: 0.544 Test Loss: 1.998 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9817249774932861
Epoch: 23, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.894 Vali Acc: 0.500 Test Loss: 1.894 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2274131774902344
Epoch: 24, Steps: 13 | Train Loss: 0.092 Vali Loss: 2.150 Vali Acc: 0.517 Test Loss: 2.150 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps77_str39_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 23440898
model size : 104.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps77_str77_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3172342777252197
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.697 Vali Acc: 0.511 Test Loss: 0.697 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.7076306343078613
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.684 Vali Acc: 0.544 Test Loss: 0.684 Test Acc: 0.544
Validation loss decreased (-0.511104 --> -0.544438).  Saving model ...
Epoch: 3 cost time: 0.8048813343048096
Epoch: 3, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.697 Vali Acc: 0.556 Test Loss: 0.697 Test Acc: 0.556
Validation loss decreased (-0.544438 --> -0.555549).  Saving model ...
Epoch: 4 cost time: 0.9257357120513916
Epoch: 4, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.678 Vali Acc: 0.550 Test Loss: 0.678 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8052380084991455
Epoch: 5, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.692 Vali Acc: 0.528 Test Loss: 0.692 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7118363380432129
Epoch: 6, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.733 Vali Acc: 0.511 Test Loss: 0.733 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.743809700012207
Epoch: 7, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.731 Vali Acc: 0.506 Test Loss: 0.731 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8138034343719482
Epoch: 8, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.785 Vali Acc: 0.517 Test Loss: 0.785 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8232645988464355
Epoch: 9, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.866 Vali Acc: 0.511 Test Loss: 0.866 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7121219635009766
Epoch: 10, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.820 Vali Acc: 0.533 Test Loss: 0.820 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5391249656677246
Epoch: 11, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.914 Vali Acc: 0.472 Test Loss: 0.914 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6447985172271729
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.250 Vali Acc: 0.489 Test Loss: 1.250 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6848173141479492
Epoch: 13, Steps: 13 | Train Loss: 0.446 Vali Loss: 1.079 Vali Acc: 0.472 Test Loss: 1.079 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps77_str77_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 23397890
model size : 103.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps83_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.783137798309326
Epoch: 1, Steps: 13 | Train Loss: 0.833 Vali Loss: 0.740 Vali Acc: 0.478 Test Loss: 0.740 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 1.1046910285949707
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.796 Vali Acc: 0.489 Test Loss: 0.796 Test Acc: 0.489
Validation loss decreased (-0.477770 --> -0.488881).  Saving model ...
Epoch: 3 cost time: 1.071901798248291
Epoch: 3, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.715 Vali Acc: 0.461 Test Loss: 0.715 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2111587524414062
Epoch: 4, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.768 Vali Acc: 0.500 Test Loss: 0.768 Test Acc: 0.500
Validation loss decreased (-0.488881 --> -0.499992).  Saving model ...
Epoch: 5 cost time: 1.541672706604004
Epoch: 5, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.800 Vali Acc: 0.489 Test Loss: 0.800 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1581852436065674
Epoch: 6, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.747 Vali Acc: 0.528 Test Loss: 0.747 Test Acc: 0.528
Validation loss decreased (-0.499992 --> -0.527770).  Saving model ...
Epoch: 7 cost time: 1.3364462852478027
Epoch: 7, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.727 Vali Acc: 0.556 Test Loss: 0.727 Test Acc: 0.556
Validation loss decreased (-0.527770 --> -0.555548).  Saving model ...
Epoch: 8 cost time: 1.0310859680175781
Epoch: 8, Steps: 13 | Train Loss: 0.668 Vali Loss: 1.013 Vali Acc: 0.489 Test Loss: 1.013 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9795563220977783
Epoch: 9, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.813 Vali Acc: 0.522 Test Loss: 0.813 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2121648788452148
Epoch: 10, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.849 Vali Acc: 0.494 Test Loss: 0.849 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2176282405853271
Epoch: 11, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.877 Vali Acc: 0.517 Test Loss: 0.877 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9851467609405518
Epoch: 12, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.935 Vali Acc: 0.494 Test Loss: 0.935 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4507598876953125
Epoch: 13, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.039 Vali Acc: 0.561 Test Loss: 1.039 Test Acc: 0.561
Validation loss decreased (-0.555548 --> -0.561101).  Saving model ...
Epoch: 14 cost time: 1.1055474281311035
Epoch: 14, Steps: 13 | Train Loss: 0.461 Vali Loss: 1.471 Vali Acc: 0.506 Test Loss: 1.471 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5312752723693848
Epoch: 15, Steps: 13 | Train Loss: 0.397 Vali Loss: 1.267 Vali Acc: 0.506 Test Loss: 1.267 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3525776863098145
Epoch: 16, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.403 Vali Acc: 0.494 Test Loss: 1.403 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9163913726806641
Epoch: 17, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.545 Vali Acc: 0.494 Test Loss: 1.545 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0539934635162354
Epoch: 18, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.911 Vali Acc: 0.500 Test Loss: 1.911 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.054858922958374
Epoch: 19, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.971 Vali Acc: 0.478 Test Loss: 1.971 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8600373268127441
Epoch: 20, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.731 Vali Acc: 0.528 Test Loss: 1.731 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2589318752288818
Epoch: 21, Steps: 13 | Train Loss: 0.312 Vali Loss: 2.402 Vali Acc: 0.506 Test Loss: 2.402 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3251242637634277
Epoch: 22, Steps: 13 | Train Loss: 0.549 Vali Loss: 1.804 Vali Acc: 0.522 Test Loss: 1.804 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4879133701324463
Epoch: 23, Steps: 13 | Train Loss: 0.205 Vali Loss: 1.932 Vali Acc: 0.522 Test Loss: 1.932 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps83_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5611111111111111
model parameter : 23608322
model size : 104.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps83_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4693195819854736
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.723 Vali Acc: 0.478 Test Loss: 0.723 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 0.7918472290039062
Epoch: 2, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.735 Vali Acc: 0.456 Test Loss: 0.735 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9576842784881592
Epoch: 3, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.710 Vali Acc: 0.517 Test Loss: 0.710 Test Acc: 0.517
Validation loss decreased (-0.477771 --> -0.516660).  Saving model ...
Epoch: 4 cost time: 0.715106725692749
Epoch: 4, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.712 Vali Acc: 0.511 Test Loss: 0.712 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0120885372161865
Epoch: 5, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.747 Vali Acc: 0.467 Test Loss: 0.747 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6729145050048828
Epoch: 6, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.712 Vali Acc: 0.533 Test Loss: 0.712 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 7 cost time: 1.0132062435150146
Epoch: 7, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.793 Vali Acc: 0.489 Test Loss: 0.793 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.106743574142456
Epoch: 8, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.751 Vali Acc: 0.506 Test Loss: 0.751 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7956349849700928
Epoch: 9, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.724 Vali Acc: 0.550 Test Loss: 0.724 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549993).  Saving model ...
Epoch: 10 cost time: 1.2771592140197754
Epoch: 10, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.746 Vali Acc: 0.461 Test Loss: 0.746 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0013220310211182
Epoch: 11, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.823 Vali Acc: 0.528 Test Loss: 0.823 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1402945518493652
Epoch: 12, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.869 Vali Acc: 0.483 Test Loss: 0.869 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9709599018096924
Epoch: 13, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.858 Vali Acc: 0.506 Test Loss: 0.858 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0928657054901123
Epoch: 14, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.975 Vali Acc: 0.472 Test Loss: 0.975 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2149884700775146
Epoch: 15, Steps: 13 | Train Loss: 0.379 Vali Loss: 1.049 Vali Acc: 0.461 Test Loss: 1.049 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0803239345550537
Epoch: 16, Steps: 13 | Train Loss: 0.316 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2732839584350586
Epoch: 17, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.580 Vali Acc: 0.478 Test Loss: 1.580 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9254324436187744
Epoch: 18, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.279 Vali Acc: 0.506 Test Loss: 1.279 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9374611377716064
Epoch: 19, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.366 Vali Acc: 0.511 Test Loss: 1.366 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps83_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 23531522
model size : 104.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps83_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.278942346572876
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.682 Vali Acc: 0.550 Test Loss: 0.682 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 0.7153623104095459
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.681 Vali Acc: 0.544 Test Loss: 0.681 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8949847221374512
Epoch: 3, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.684 Vali Acc: 0.572 Test Loss: 0.684 Test Acc: 0.572
Validation loss decreased (-0.549993 --> -0.572215).  Saving model ...
Epoch: 4 cost time: 0.6962845325469971
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.682 Vali Acc: 0.528 Test Loss: 0.682 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.600421667098999
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.704 Vali Acc: 0.550 Test Loss: 0.704 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7907655239105225
Epoch: 6, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.697 Vali Acc: 0.506 Test Loss: 0.697 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6171896457672119
Epoch: 7, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.839 Vali Acc: 0.478 Test Loss: 0.839 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5908610820770264
Epoch: 8, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.865 Vali Acc: 0.528 Test Loss: 0.865 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7981865406036377
Epoch: 9, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.851 Vali Acc: 0.517 Test Loss: 0.851 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6721811294555664
Epoch: 10, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.978 Vali Acc: 0.472 Test Loss: 0.978 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8997209072113037
Epoch: 11, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.056 Vali Acc: 0.489 Test Loss: 1.056 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8502674102783203
Epoch: 12, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.951 Vali Acc: 0.489 Test Loss: 0.951 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6256430149078369
Epoch: 13, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps83_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 23491586
model size : 104.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps89_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3940436840057373
Epoch: 1, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.752 Vali Acc: 0.500 Test Loss: 0.752 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 1.3143515586853027
Epoch: 2, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.716 Vali Acc: 0.472 Test Loss: 0.716 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.225557804107666
Epoch: 3, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.733 Vali Acc: 0.506 Test Loss: 0.733 Test Acc: 0.506
Validation loss decreased (-0.499992 --> -0.505548).  Saving model ...
Epoch: 4 cost time: 1.3827497959136963
Epoch: 4, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.740 Vali Acc: 0.528 Test Loss: 0.740 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527770).  Saving model ...
Epoch: 5 cost time: 1.1281890869140625
Epoch: 5, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.815 Vali Acc: 0.506 Test Loss: 0.815 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3024721145629883
Epoch: 6, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.762 Vali Acc: 0.517 Test Loss: 0.762 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1852736473083496
Epoch: 7, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.771 Vali Acc: 0.511 Test Loss: 0.771 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3851194381713867
Epoch: 8, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.987 Vali Acc: 0.472 Test Loss: 0.987 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.03153657913208
Epoch: 9, Steps: 13 | Train Loss: 0.552 Vali Loss: 1.036 Vali Acc: 0.506 Test Loss: 1.036 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4950976371765137
Epoch: 10, Steps: 13 | Train Loss: 0.552 Vali Loss: 1.146 Vali Acc: 0.494 Test Loss: 1.146 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.092618703842163
Epoch: 11, Steps: 13 | Train Loss: 0.477 Vali Loss: 1.029 Vali Acc: 0.456 Test Loss: 1.029 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9666867256164551
Epoch: 12, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.235 Vali Acc: 0.461 Test Loss: 1.235 Test Acc: 0.461
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3940048217773438
Epoch: 13, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.504 Vali Acc: 0.483 Test Loss: 1.504 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7959475517272949
Epoch: 14, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.237 Vali Acc: 0.489 Test Loss: 1.237 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps89_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5277777777777778
model parameter : 23692802
model size : 105.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps89_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 1.8985819816589355
Epoch: 1, Steps: 13 | Train Loss: 0.774 Vali Loss: 0.706 Vali Acc: 0.511 Test Loss: 0.706 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.7668418884277344
Epoch: 2, Steps: 13 | Train Loss: 0.739 Vali Loss: 0.702 Vali Acc: 0.528 Test Loss: 0.702 Test Acc: 0.528
Validation loss decreased (-0.511104 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.817119836807251
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.680 Vali Acc: 0.567 Test Loss: 0.680 Test Acc: 0.567
Validation loss decreased (-0.527771 --> -0.566660).  Saving model ...
Epoch: 4 cost time: 0.7381856441497803
Epoch: 4, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.754 Vali Acc: 0.500 Test Loss: 0.754 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8357625007629395
Epoch: 5, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.792 Vali Acc: 0.500 Test Loss: 0.792 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7985119819641113
Epoch: 6, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.780 Vali Acc: 0.522 Test Loss: 0.780 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8150482177734375
Epoch: 7, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.771 Vali Acc: 0.494 Test Loss: 0.771 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8519644737243652
Epoch: 8, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.775 Vali Acc: 0.489 Test Loss: 0.775 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9236836433410645
Epoch: 9, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.876 Vali Acc: 0.533 Test Loss: 0.876 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8247115612030029
Epoch: 10, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.929 Vali Acc: 0.489 Test Loss: 0.929 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.189887285232544
Epoch: 11, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.822 Vali Acc: 0.539 Test Loss: 0.822 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0373256206512451
Epoch: 12, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.985 Vali Acc: 0.533 Test Loss: 0.985 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7423324584960938
Epoch: 13, Steps: 13 | Train Loss: 0.409 Vali Loss: 1.108 Vali Acc: 0.528 Test Loss: 1.108 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps89_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 23622146
model size : 104.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps89_str89_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.172299861907959
Epoch: 1, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.724 Vali Acc: 0.500 Test Loss: 0.724 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 0.8386542797088623
Epoch: 2, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.714 Vali Acc: 0.533 Test Loss: 0.714 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 3 cost time: 0.8107454776763916
Epoch: 3, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.698 Vali Acc: 0.583 Test Loss: 0.698 Test Acc: 0.583
Validation loss decreased (-0.533326 --> -0.583326).  Saving model ...
Epoch: 4 cost time: 0.7317776679992676
Epoch: 4, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.709 Vali Acc: 0.472 Test Loss: 0.709 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9495892524719238
Epoch: 5, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.678 Vali Acc: 0.544 Test Loss: 0.678 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8604629039764404
Epoch: 6, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.715 Vali Acc: 0.528 Test Loss: 0.715 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6471436023712158
Epoch: 7, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.730 Vali Acc: 0.517 Test Loss: 0.730 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.683281660079956
Epoch: 8, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.808 Vali Acc: 0.506 Test Loss: 0.808 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7387566566467285
Epoch: 9, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.920 Vali Acc: 0.478 Test Loss: 0.920 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8639345169067383
Epoch: 10, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.818 Vali Acc: 0.539 Test Loss: 0.818 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8607563972473145
Epoch: 11, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.947 Vali Acc: 0.494 Test Loss: 0.947 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0496327877044678
Epoch: 12, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.880 Vali Acc: 0.517 Test Loss: 0.880 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8073058128356934
Epoch: 13, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.988 Vali Acc: 0.522 Test Loss: 0.988 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps89_str89_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 23585282
model size : 104.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps96_str24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 3.3249847888946533
Epoch: 1, Steps: 13 | Train Loss: 0.719 Vali Loss: 0.733 Vali Acc: 0.478 Test Loss: 0.733 Test Acc: 0.478
Validation loss decreased (inf --> -0.477770).  Saving model ...
Epoch: 2 cost time: 0.8629021644592285
Epoch: 2, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.682 Vali Acc: 0.522 Test Loss: 0.682 Test Acc: 0.522
Validation loss decreased (-0.477770 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 0.934755802154541
Epoch: 3, Steps: 13 | Train Loss: 0.776 Vali Loss: 1.031 Vali Acc: 0.500 Test Loss: 1.031 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8735637664794922
Epoch: 4, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.701 Vali Acc: 0.544 Test Loss: 0.701 Test Acc: 0.544
Validation loss decreased (-0.522215 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.0342552661895752
Epoch: 5, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.739 Vali Acc: 0.528 Test Loss: 0.739 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1034538745880127
Epoch: 6, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.780 Vali Acc: 0.450 Test Loss: 0.780 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8535478115081787
Epoch: 7, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.731 Vali Acc: 0.489 Test Loss: 0.731 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2342760562896729
Epoch: 8, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.825 Vali Acc: 0.511 Test Loss: 0.825 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8333530426025391
Epoch: 9, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.794 Vali Acc: 0.489 Test Loss: 0.794 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2562057971954346
Epoch: 10, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.915 Vali Acc: 0.511 Test Loss: 0.915 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1482102870941162
Epoch: 11, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.864 Vali Acc: 0.522 Test Loss: 0.864 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0262956619262695
Epoch: 12, Steps: 13 | Train Loss: 0.521 Vali Loss: 1.213 Vali Acc: 0.511 Test Loss: 1.213 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0625088214874268
Epoch: 13, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.021 Vali Acc: 0.456 Test Loss: 1.021 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1838099956512451
Epoch: 14, Steps: 13 | Train Loss: 0.401 Vali Loss: 1.219 Vali Acc: 0.472 Test Loss: 1.219 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps96_str24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 23799554
model size : 105.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps96_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.1523733139038086
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.705 Vali Acc: 0.494 Test Loss: 0.705 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.6176202297210693
Epoch: 2, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.686 Vali Acc: 0.506 Test Loss: 0.686 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505549).  Saving model ...
Epoch: 3 cost time: 0.8081231117248535
Epoch: 3, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.702 Vali Acc: 0.522 Test Loss: 0.702 Test Acc: 0.522
Validation loss decreased (-0.505549 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 0.6553373336791992
Epoch: 4, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.687 Vali Acc: 0.528 Test Loss: 0.687 Test Acc: 0.528
Validation loss decreased (-0.522215 --> -0.527771).  Saving model ...
Epoch: 5 cost time: 0.7939107418060303
Epoch: 5, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.687 Vali Acc: 0.533 Test Loss: 0.687 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 1.3585906028747559
Epoch: 6, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.691 Vali Acc: 0.572 Test Loss: 0.691 Test Acc: 0.572
Validation loss decreased (-0.533326 --> -0.572215).  Saving model ...
Epoch: 7 cost time: 1.0020980834960938
Epoch: 7, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.048 Vali Acc: 0.511 Test Loss: 1.048 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0898690223693848
Epoch: 8, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.812 Vali Acc: 0.533 Test Loss: 0.812 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7647473812103271
Epoch: 9, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.960 Vali Acc: 0.489 Test Loss: 0.960 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9583125114440918
Epoch: 10, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.809 Vali Acc: 0.522 Test Loss: 0.809 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8140463829040527
Epoch: 11, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.931 Vali Acc: 0.528 Test Loss: 0.931 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8083682060241699
Epoch: 12, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.011 Vali Acc: 0.489 Test Loss: 1.011 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8606915473937988
Epoch: 13, Steps: 13 | Train Loss: 0.394 Vali Loss: 1.125 Vali Acc: 0.517 Test Loss: 1.125 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7996103763580322
Epoch: 14, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.146 Vali Acc: 0.528 Test Loss: 1.146 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6857573986053467
Epoch: 15, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.177 Vali Acc: 0.550 Test Loss: 1.177 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8472027778625488
Epoch: 16, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.161 Vali Acc: 0.483 Test Loss: 1.161 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps96_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 23731970
model size : 105.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps96_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.1482882499694824
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.686 Vali Acc: 0.539 Test Loss: 0.686 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 0.6690616607666016
Epoch: 2, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.673 Vali Acc: 0.550 Test Loss: 0.673 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 0.9623763561248779
Epoch: 3, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.755 Vali Acc: 0.528 Test Loss: 0.755 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7470047473907471
Epoch: 4, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.699 Vali Acc: 0.561 Test Loss: 0.699 Test Acc: 0.561
Validation loss decreased (-0.549993 --> -0.561104).  Saving model ...
Epoch: 5 cost time: 0.6370220184326172
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.720 Vali Acc: 0.506 Test Loss: 0.720 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8637499809265137
Epoch: 6, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.681 Vali Acc: 0.600 Test Loss: 0.681 Test Acc: 0.600
Validation loss decreased (-0.561104 --> -0.599993).  Saving model ...
Epoch: 7 cost time: 0.8506653308868408
Epoch: 7, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6628439426422119
Epoch: 8, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.863 Vali Acc: 0.489 Test Loss: 0.863 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7661480903625488
Epoch: 9, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.837 Vali Acc: 0.489 Test Loss: 0.837 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6454496383666992
Epoch: 10, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.777 Vali Acc: 0.500 Test Loss: 0.777 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7176940441131592
Epoch: 11, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.829 Vali Acc: 0.506 Test Loss: 0.829 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7999463081359863
Epoch: 12, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.876 Vali Acc: 0.494 Test Loss: 0.876 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5660018920898438
Epoch: 13, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.895 Vali Acc: 0.522 Test Loss: 0.895 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9542813301086426
Epoch: 14, Steps: 13 | Train Loss: 0.331 Vali Loss: 1.035 Vali Acc: 0.494 Test Loss: 1.035 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6163415908813477
Epoch: 15, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.170 Vali Acc: 0.483 Test Loss: 1.170 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8105931282043457
Epoch: 16, Steps: 13 | Train Loss: 0.344 Vali Loss: 1.040 Vali Acc: 0.494 Test Loss: 1.040 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps96_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6
model parameter : 23698178
model size : 105.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps105_str27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5202369689941406
Epoch: 1, Steps: 13 | Train Loss: 0.752 Vali Loss: 0.730 Vali Acc: 0.494 Test Loss: 0.730 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 1.2955801486968994
Epoch: 2, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.707 Vali Acc: 0.517 Test Loss: 0.707 Test Acc: 0.517
Validation loss decreased (-0.494437 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 0.8441064357757568
Epoch: 3, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.694 Vali Acc: 0.533 Test Loss: 0.694 Test Acc: 0.533
Validation loss decreased (-0.516660 --> -0.533326).  Saving model ...
Epoch: 4 cost time: 0.6542243957519531
Epoch: 4, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.707 Vali Acc: 0.494 Test Loss: 0.707 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6720445156097412
Epoch: 5, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.692 Vali Acc: 0.539 Test Loss: 0.692 Test Acc: 0.539
Validation loss decreased (-0.533326 --> -0.538882).  Saving model ...
Epoch: 6 cost time: 0.8103373050689697
Epoch: 6, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.699 Vali Acc: 0.572 Test Loss: 0.699 Test Acc: 0.572
Validation loss decreased (-0.538882 --> -0.572215).  Saving model ...
Epoch: 7 cost time: 0.7460839748382568
Epoch: 7, Steps: 13 | Train Loss: 0.566 Vali Loss: 0.762 Vali Acc: 0.533 Test Loss: 0.762 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7861826419830322
Epoch: 8, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.833 Vali Acc: 0.550 Test Loss: 0.833 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.012024164199829
Epoch: 9, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.815 Vali Acc: 0.483 Test Loss: 0.815 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9074430465698242
Epoch: 10, Steps: 13 | Train Loss: 0.482 Vali Loss: 1.118 Vali Acc: 0.494 Test Loss: 1.118 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8204441070556641
Epoch: 11, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.783 Vali Acc: 0.533 Test Loss: 0.783 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8956785202026367
Epoch: 12, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.974 Vali Acc: 0.472 Test Loss: 0.974 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2688705921173096
Epoch: 13, Steps: 13 | Train Loss: 0.338 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8237643241882324
Epoch: 14, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.235 Vali Acc: 0.467 Test Loss: 1.235 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5103929042816162
Epoch: 15, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.374 Vali Acc: 0.456 Test Loss: 1.374 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0056400299072266
Epoch: 16, Steps: 13 | Train Loss: 0.238 Vali Loss: 1.317 Vali Acc: 0.517 Test Loss: 1.317 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps105_str27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5722222222222222
model parameter : 23926274
model size : 105.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps105_str53_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.115443706512451
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.692 Vali Acc: 0.511 Test Loss: 0.692 Test Acc: 0.511
Validation loss decreased (inf --> -0.511104).  Saving model ...
Epoch: 2 cost time: 0.6569821834564209
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.706 Vali Acc: 0.506 Test Loss: 0.706 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7738187313079834
Epoch: 3, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.692 Vali Acc: 0.544 Test Loss: 0.692 Test Acc: 0.544
Validation loss decreased (-0.511104 --> -0.544438).  Saving model ...
Epoch: 4 cost time: 0.9351627826690674
Epoch: 4, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.706 Vali Acc: 0.500 Test Loss: 0.706 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8174655437469482
Epoch: 5, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.774 Vali Acc: 0.450 Test Loss: 0.774 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1942853927612305
Epoch: 6, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.728 Vali Acc: 0.539 Test Loss: 0.728 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8609237670898438
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.705 Vali Acc: 0.556 Test Loss: 0.705 Test Acc: 0.556
Validation loss decreased (-0.544438 --> -0.555549).  Saving model ...
Epoch: 8 cost time: 0.7290329933166504
Epoch: 8, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.740 Vali Acc: 0.489 Test Loss: 0.740 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1002001762390137
Epoch: 9, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.857 Vali Acc: 0.511 Test Loss: 0.857 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7477095127105713
Epoch: 10, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.843 Vali Acc: 0.556 Test Loss: 0.843 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8615305423736572
Epoch: 11, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.819 Vali Acc: 0.528 Test Loss: 0.819 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8296396732330322
Epoch: 12, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.925 Vali Acc: 0.506 Test Loss: 0.925 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1929759979248047
Epoch: 13, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.947 Vali Acc: 0.522 Test Loss: 0.947 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9384922981262207
Epoch: 14, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.928 Vali Acc: 0.522 Test Loss: 0.928 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8878788948059082
Epoch: 15, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.159 Vali Acc: 0.450 Test Loss: 1.159 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7489173412322998
Epoch: 16, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.208 Vali Acc: 0.444 Test Loss: 1.208 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1403064727783203
Epoch: 17, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.270 Vali Acc: 0.544 Test Loss: 1.270 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps105_str53_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 23867906
model size : 105.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps105_str105_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 1.843137502670288
Epoch: 1, Steps: 13 | Train Loss: 0.777 Vali Loss: 0.701 Vali Acc: 0.494 Test Loss: 0.701 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.830033540725708
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.684 Vali Acc: 0.528 Test Loss: 0.684 Test Acc: 0.528
Validation loss decreased (-0.494437 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.8733420372009277
Epoch: 3, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.708 Vali Acc: 0.539 Test Loss: 0.708 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 4 cost time: 0.905510425567627
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.713 Vali Acc: 0.489 Test Loss: 0.713 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6561927795410156
Epoch: 5, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.693 Vali Acc: 0.539 Test Loss: 0.693 Test Acc: 0.539
Validation loss decreased (-0.538882 --> -0.538882).  Saving model ...
Epoch: 6 cost time: 0.5685391426086426
Epoch: 6, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.719 Vali Acc: 0.478 Test Loss: 0.719 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5806787014007568
Epoch: 7, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.749 Vali Acc: 0.528 Test Loss: 0.749 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6622958183288574
Epoch: 8, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.826 Vali Acc: 0.522 Test Loss: 0.826 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8662412166595459
Epoch: 9, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.827 Vali Acc: 0.533 Test Loss: 0.827 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6526403427124023
Epoch: 10, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.843 Vali Acc: 0.506 Test Loss: 0.843 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8724830150604248
Epoch: 11, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.896 Vali Acc: 0.489 Test Loss: 0.896 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8661246299743652
Epoch: 12, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.035 Vali Acc: 0.450 Test Loss: 1.035 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7804641723632812
Epoch: 13, Steps: 13 | Train Loss: 0.278 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7593562602996826
Epoch: 14, Steps: 13 | Train Loss: 0.335 Vali Loss: 1.133 Vali Acc: 0.489 Test Loss: 1.133 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7733769416809082
Epoch: 15, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.510 Vali Acc: 0.511 Test Loss: 1.510 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps105_str105_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5388888888888889
model parameter : 23837186
model size : 105.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps116_str29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.530414342880249
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.675 Vali Acc: 0.606 Test Loss: 0.675 Test Acc: 0.606
Validation loss decreased (inf --> -0.605549).  Saving model ...
Epoch: 2 cost time: 0.9119584560394287
Epoch: 2, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.687 Vali Acc: 0.522 Test Loss: 0.687 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.124657392501831
Epoch: 3, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8529863357543945
Epoch: 4, Steps: 13 | Train Loss: 0.779 Vali Loss: 0.828 Vali Acc: 0.500 Test Loss: 0.828 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2004873752593994
Epoch: 5, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.721 Vali Acc: 0.544 Test Loss: 0.721 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0547559261322021
Epoch: 6, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.713 Vali Acc: 0.544 Test Loss: 0.713 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1598117351531982
Epoch: 7, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.750 Vali Acc: 0.572 Test Loss: 0.750 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0888428688049316
Epoch: 8, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.771 Vali Acc: 0.550 Test Loss: 0.771 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.233973503112793
Epoch: 9, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.798 Vali Acc: 0.511 Test Loss: 0.798 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.155717134475708
Epoch: 10, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.885 Vali Acc: 0.511 Test Loss: 0.885 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1471881866455078
Epoch: 11, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.214 Vali Acc: 0.489 Test Loss: 1.214 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps116_str29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.6055555555555555
model parameter : 24094466
model size : 106.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps116_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.716482639312744
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.709 Vali Acc: 0.506 Test Loss: 0.709 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.7866945266723633
Epoch: 2, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.674 Vali Acc: 0.578 Test Loss: 0.674 Test Acc: 0.578
Validation loss decreased (-0.505548 --> -0.577771).  Saving model ...
Epoch: 3 cost time: 0.9623503684997559
Epoch: 3, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.675 Vali Acc: 0.567 Test Loss: 0.675 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8575456142425537
Epoch: 4, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.714 Vali Acc: 0.517 Test Loss: 0.714 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8763399124145508
Epoch: 5, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.838 Vali Acc: 0.506 Test Loss: 0.838 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7690014839172363
Epoch: 6, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.713 Vali Acc: 0.528 Test Loss: 0.713 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0033833980560303
Epoch: 7, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.730 Vali Acc: 0.533 Test Loss: 0.730 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9365494251251221
Epoch: 8, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.706 Vali Acc: 0.517 Test Loss: 0.706 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0794367790222168
Epoch: 9, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.789 Vali Acc: 0.483 Test Loss: 0.789 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9340658187866211
Epoch: 10, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.931 Vali Acc: 0.533 Test Loss: 0.931 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8508446216583252
Epoch: 11, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.881 Vali Acc: 0.533 Test Loss: 0.881 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2018091678619385
Epoch: 12, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.884 Vali Acc: 0.494 Test Loss: 0.884 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps116_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 24039170
model size : 106.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps116_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.244229793548584
Epoch: 1, Steps: 13 | Train Loss: 0.827 Vali Loss: 0.743 Vali Acc: 0.506 Test Loss: 0.743 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.5702807903289795
Epoch: 2, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.691 Vali Acc: 0.528 Test Loss: 0.691 Test Acc: 0.528
Validation loss decreased (-0.505548 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.7344331741333008
Epoch: 3, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.717 Vali Acc: 0.511 Test Loss: 0.717 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6232962608337402
Epoch: 4, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.710 Vali Acc: 0.494 Test Loss: 0.710 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6691493988037109
Epoch: 5, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.708 Vali Acc: 0.489 Test Loss: 0.708 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6618051528930664
Epoch: 6, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.711 Vali Acc: 0.511 Test Loss: 0.711 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6758456230163574
Epoch: 7, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.754 Vali Acc: 0.533 Test Loss: 0.754 Test Acc: 0.533
Validation loss decreased (-0.527771 --> -0.533326).  Saving model ...
Epoch: 8 cost time: 0.6115977764129639
Epoch: 8, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.788 Vali Acc: 0.528 Test Loss: 0.788 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6488986015319824
Epoch: 9, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.830 Vali Acc: 0.511 Test Loss: 0.830 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6739757061004639
Epoch: 10, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.841 Vali Acc: 0.528 Test Loss: 0.841 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.794867753982544
Epoch: 11, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.952 Vali Acc: 0.494 Test Loss: 0.952 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7220611572265625
Epoch: 12, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7435953617095947
Epoch: 13, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.013 Vali Acc: 0.489 Test Loss: 1.013 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8095254898071289
Epoch: 14, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.098 Vali Acc: 0.517 Test Loss: 1.098 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6675643920898438
Epoch: 15, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.185 Vali Acc: 0.506 Test Loss: 1.185 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6431090831756592
Epoch: 16, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.207 Vali Acc: 0.511 Test Loss: 1.207 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6768712997436523
Epoch: 17, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.333 Vali Acc: 0.567 Test Loss: 1.333 Test Acc: 0.567
Validation loss decreased (-0.533326 --> -0.566653).  Saving model ...
Epoch: 18 cost time: 1.330061912536621
Epoch: 18, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.284 Vali Acc: 0.544 Test Loss: 1.284 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6517937183380127
Epoch: 19, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.369 Vali Acc: 0.517 Test Loss: 1.369 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7492964267730713
Epoch: 20, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.439 Vali Acc: 0.494 Test Loss: 1.439 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6755363941192627
Epoch: 21, Steps: 13 | Train Loss: 0.178 Vali Loss: 1.359 Vali Acc: 0.506 Test Loss: 1.359 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6974120140075684
Epoch: 22, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.626 Vali Acc: 0.561 Test Loss: 1.626 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8122289180755615
Epoch: 23, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.422 Vali Acc: 0.533 Test Loss: 1.422 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7318832874298096
Epoch: 24, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.387 Vali Acc: 0.500 Test Loss: 1.387 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6290476322174072
Epoch: 25, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.622 Vali Acc: 0.511 Test Loss: 1.622 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7399852275848389
Epoch: 26, Steps: 13 | Train Loss: 0.138 Vali Loss: 2.039 Vali Acc: 0.517 Test Loss: 2.039 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.642662525177002
Epoch: 27, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.776 Vali Acc: 0.550 Test Loss: 1.776 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps116_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 24011522
model size : 106.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps128_str32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5371689796447754
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.722 Vali Acc: 0.444 Test Loss: 0.722 Test Acc: 0.444
Validation loss decreased (inf --> -0.444437).  Saving model ...
Epoch: 2 cost time: 0.8922171592712402
Epoch: 2, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.744 Vali Acc: 0.522 Test Loss: 0.744 Test Acc: 0.522
Validation loss decreased (-0.444437 --> -0.522215).  Saving model ...
Epoch: 3 cost time: 1.1091885566711426
Epoch: 3, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.703 Vali Acc: 0.522 Test Loss: 0.703 Test Acc: 0.522
Validation loss decreased (-0.522215 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 0.8794829845428467
Epoch: 4, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.874 Vali Acc: 0.500 Test Loss: 0.874 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.17061185836792
Epoch: 5, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.816 Vali Acc: 0.461 Test Loss: 0.816 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9448134899139404
Epoch: 6, Steps: 13 | Train Loss: 0.599 Vali Loss: 0.777 Vali Acc: 0.533 Test Loss: 0.777 Test Acc: 0.533
Validation loss decreased (-0.522215 --> -0.533326).  Saving model ...
Epoch: 7 cost time: 1.184591293334961
Epoch: 7, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.963 Vali Acc: 0.450 Test Loss: 0.963 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9305496215820312
Epoch: 8, Steps: 13 | Train Loss: 0.526 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0565519332885742
Epoch: 9, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.990 Vali Acc: 0.450 Test Loss: 0.990 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8544013500213623
Epoch: 10, Steps: 13 | Train Loss: 0.400 Vali Loss: 1.175 Vali Acc: 0.517 Test Loss: 1.175 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2868576049804688
Epoch: 11, Steps: 13 | Train Loss: 0.375 Vali Loss: 1.676 Vali Acc: 0.472 Test Loss: 1.676 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.122960090637207
Epoch: 12, Steps: 13 | Train Loss: 0.524 Vali Loss: 1.255 Vali Acc: 0.467 Test Loss: 1.255 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0184457302093506
Epoch: 13, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.344 Vali Acc: 0.500 Test Loss: 1.344 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0992944240570068
Epoch: 14, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.589 Vali Acc: 0.450 Test Loss: 1.589 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0491645336151123
Epoch: 15, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.674 Vali Acc: 0.439 Test Loss: 1.674 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3131608963012695
Epoch: 16, Steps: 13 | Train Loss: 0.318 Vali Loss: 1.527 Vali Acc: 0.467 Test Loss: 1.527 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps128_str32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5333333333333333
model parameter : 24278786
model size : 107.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps128_str64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.2107298374176025
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.731 Vali Acc: 0.472 Test Loss: 0.731 Test Acc: 0.472
Validation loss decreased (inf --> -0.472215).  Saving model ...
Epoch: 2 cost time: 1.1532859802246094
Epoch: 2, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.702 Vali Acc: 0.494 Test Loss: 0.702 Test Acc: 0.494
Validation loss decreased (-0.472215 --> -0.494437).  Saving model ...
Epoch: 3 cost time: 1.210784673690796
Epoch: 3, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.695 Vali Acc: 0.544 Test Loss: 0.695 Test Acc: 0.544
Validation loss decreased (-0.494437 --> -0.544437).  Saving model ...
Epoch: 4 cost time: 1.2093698978424072
Epoch: 4, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.717 Vali Acc: 0.494 Test Loss: 0.717 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8641054630279541
Epoch: 5, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.766 Vali Acc: 0.478 Test Loss: 0.766 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9098398685455322
Epoch: 6, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.761 Vali Acc: 0.494 Test Loss: 0.761 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2353079319000244
Epoch: 7, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.725 Vali Acc: 0.528 Test Loss: 0.725 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7865526676177979
Epoch: 8, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.758 Vali Acc: 0.461 Test Loss: 0.758 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2050039768218994
Epoch: 9, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.832 Vali Acc: 0.544 Test Loss: 0.832 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.905571460723877
Epoch: 10, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.812 Vali Acc: 0.478 Test Loss: 0.812 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8163950443267822
Epoch: 11, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.926 Vali Acc: 0.522 Test Loss: 0.926 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.646958589553833
Epoch: 12, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.896 Vali Acc: 0.522 Test Loss: 0.896 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6264410018920898
Epoch: 13, Steps: 13 | Train Loss: 0.449 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps128_str64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 24229634
model size : 107.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps128_str128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.187133550643921
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.717 Vali Acc: 0.489 Test Loss: 0.717 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.6278645992279053
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.693 Vali Acc: 0.528 Test Loss: 0.693 Test Acc: 0.528
Validation loss decreased (-0.488882 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 0.6404292583465576
Epoch: 3, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.712 Vali Acc: 0.506 Test Loss: 0.712 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7472636699676514
Epoch: 4, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.697 Vali Acc: 0.528 Test Loss: 0.697 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6301822662353516
Epoch: 5, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.709 Vali Acc: 0.528 Test Loss: 0.709 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6922259330749512
Epoch: 6, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.696 Vali Acc: 0.539 Test Loss: 0.696 Test Acc: 0.539
Validation loss decreased (-0.527771 --> -0.538882).  Saving model ...
Epoch: 7 cost time: 0.8453664779663086
Epoch: 7, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.736 Vali Acc: 0.567 Test Loss: 0.736 Test Acc: 0.567
Validation loss decreased (-0.538882 --> -0.566659).  Saving model ...
Epoch: 8 cost time: 0.8133151531219482
Epoch: 8, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.938 Vali Acc: 0.511 Test Loss: 0.938 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7063431739807129
Epoch: 9, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.858 Vali Acc: 0.517 Test Loss: 0.858 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6792845726013184
Epoch: 10, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.981 Vali Acc: 0.544 Test Loss: 0.981 Test Acc: 0.544
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6956636905670166
Epoch: 11, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.860 Vali Acc: 0.528 Test Loss: 0.860 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9082705974578857
Epoch: 12, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.877 Vali Acc: 0.517 Test Loss: 0.877 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7128071784973145
Epoch: 13, Steps: 13 | Train Loss: 0.340 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8069436550140381
Epoch: 14, Steps: 13 | Train Loss: 0.298 Vali Loss: 1.049 Vali Acc: 0.456 Test Loss: 1.049 Test Acc: 0.456
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7633571624755859
Epoch: 15, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.958 Vali Acc: 0.517 Test Loss: 0.958 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7459638118743896
Epoch: 16, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.136 Vali Acc: 0.478 Test Loss: 1.136 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7325642108917236
Epoch: 17, Steps: 13 | Train Loss: 0.213 Vali Loss: 1.204 Vali Acc: 0.572 Test Loss: 1.204 Test Acc: 0.572
Validation loss decreased (-0.566659 --> -0.572210).  Saving model ...
Epoch: 18 cost time: 0.8796021938323975
Epoch: 18, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.325 Vali Acc: 0.550 Test Loss: 1.325 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7259974479675293
Epoch: 19, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.496 Vali Acc: 0.578 Test Loss: 1.496 Test Acc: 0.578
Validation loss decreased (-0.572210 --> -0.577763).  Saving model ...
Epoch: 20 cost time: 0.6104874610900879
Epoch: 20, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.410 Vali Acc: 0.522 Test Loss: 1.410 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8448641300201416
Epoch: 21, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.492 Vali Acc: 0.550 Test Loss: 1.492 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6433625221252441
Epoch: 22, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.435 Vali Acc: 0.511 Test Loss: 1.435 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6831822395324707
Epoch: 23, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.496 Vali Acc: 0.522 Test Loss: 1.496 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6694278717041016
Epoch: 24, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.341 Vali Acc: 0.511 Test Loss: 1.341 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7779445648193359
Epoch: 25, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.310 Vali Acc: 0.539 Test Loss: 1.310 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7737898826599121
Epoch: 26, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.804 Vali Acc: 0.544 Test Loss: 1.804 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6300976276397705
Epoch: 27, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.751 Vali Acc: 0.517 Test Loss: 1.751 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7191979885101318
Epoch: 28, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.952 Vali Acc: 0.539 Test Loss: 1.952 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8431041240692139
Epoch: 29, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.903 Vali Acc: 0.533 Test Loss: 1.903 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps128_str128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5777777777777777
model parameter : 24205058
model size : 107.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps144_str36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.7597155570983887
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.707 Vali Acc: 0.494 Test Loss: 0.707 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.9660191535949707
Epoch: 2, Steps: 13 | Train Loss: 0.707 Vali Loss: 0.709 Vali Acc: 0.500 Test Loss: 0.709 Test Acc: 0.500
Validation loss decreased (-0.494437 --> -0.499993).  Saving model ...
Epoch: 3 cost time: 1.3734655380249023
Epoch: 3, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.710 Vali Acc: 0.478 Test Loss: 0.710 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0279994010925293
Epoch: 4, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.717 Vali Acc: 0.478 Test Loss: 0.717 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.992396354675293
Epoch: 5, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.716 Vali Acc: 0.533 Test Loss: 0.716 Test Acc: 0.533
Validation loss decreased (-0.499993 --> -0.533326).  Saving model ...
Epoch: 6 cost time: 1.4541664123535156
Epoch: 6, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.789 Vali Acc: 0.444 Test Loss: 0.789 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9619739055633545
Epoch: 7, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.804 Vali Acc: 0.550 Test Loss: 0.804 Test Acc: 0.550
Validation loss decreased (-0.533326 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 0.9193344116210938
Epoch: 8, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.918 Vali Acc: 0.489 Test Loss: 0.918 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1123671531677246
Epoch: 9, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.931 Vali Acc: 0.472 Test Loss: 0.931 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9246618747711182
Epoch: 10, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.884 Vali Acc: 0.517 Test Loss: 0.884 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0358374118804932
Epoch: 11, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.939 Vali Acc: 0.517 Test Loss: 0.939 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9694027900695801
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 1.043 Vali Acc: 0.489 Test Loss: 1.043 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8581044673919678
Epoch: 13, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.956 Vali Acc: 0.511 Test Loss: 0.956 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8097553253173828
Epoch: 14, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8722152709960938
Epoch: 15, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.228 Vali Acc: 0.522 Test Loss: 1.228 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9329133033752441
Epoch: 16, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.279 Vali Acc: 0.539 Test Loss: 1.279 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0025062561035156
Epoch: 17, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.281 Vali Acc: 0.528 Test Loss: 1.281 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps144_str36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 24524546
model size : 108.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps144_str72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.440000295639038
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.687 Vali Acc: 0.550 Test Loss: 0.687 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 0.8259553909301758
Epoch: 2, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.689 Vali Acc: 0.539 Test Loss: 0.689 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7144558429718018
Epoch: 3, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.691 Vali Acc: 0.517 Test Loss: 0.691 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7186307907104492
Epoch: 4, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.725 Vali Acc: 0.478 Test Loss: 0.725 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8888039588928223
Epoch: 5, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.701 Vali Acc: 0.528 Test Loss: 0.701 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7954270839691162
Epoch: 6, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.700 Vali Acc: 0.483 Test Loss: 0.700 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6270527839660645
Epoch: 7, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.740 Vali Acc: 0.489 Test Loss: 0.740 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7354071140289307
Epoch: 8, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.787 Vali Acc: 0.461 Test Loss: 0.787 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8241939544677734
Epoch: 9, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.912 Vali Acc: 0.522 Test Loss: 0.912 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6213235855102539
Epoch: 10, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.856 Vali Acc: 0.456 Test Loss: 0.856 Test Acc: 0.456
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9430575370788574
Epoch: 11, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.964 Vali Acc: 0.550 Test Loss: 0.964 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps144_str72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 24481538
model size : 108.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps144_str144_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.4474034309387207
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.722 Vali Acc: 0.506 Test Loss: 0.722 Test Acc: 0.506
Validation loss decreased (inf --> -0.505548).  Saving model ...
Epoch: 2 cost time: 0.6867232322692871
Epoch: 2, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.712 Vali Acc: 0.472 Test Loss: 0.712 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7087595462799072
Epoch: 3, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.690 Vali Acc: 0.506 Test Loss: 0.690 Test Acc: 0.506
Validation loss decreased (-0.505548 --> -0.505549).  Saving model ...
Epoch: 4 cost time: 0.7078912258148193
Epoch: 4, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.745 Vali Acc: 0.506 Test Loss: 0.745 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6566886901855469
Epoch: 5, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.679 Vali Acc: 0.544 Test Loss: 0.679 Test Acc: 0.544
Validation loss decreased (-0.505549 --> -0.544438).  Saving model ...
Epoch: 6 cost time: 0.6522173881530762
Epoch: 6, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.717 Vali Acc: 0.472 Test Loss: 0.717 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6919019222259521
Epoch: 7, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.700 Vali Acc: 0.533 Test Loss: 0.700 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8869764804840088
Epoch: 8, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.823 Vali Acc: 0.517 Test Loss: 0.823 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8368499279022217
Epoch: 9, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.761 Vali Acc: 0.511 Test Loss: 0.761 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9514257907867432
Epoch: 10, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.792 Vali Acc: 0.561 Test Loss: 0.792 Test Acc: 0.561
Validation loss decreased (-0.544438 --> -0.561103).  Saving model ...
Epoch: 11 cost time: 0.7563798427581787
Epoch: 11, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.893 Vali Acc: 0.517 Test Loss: 0.893 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9518792629241943
Epoch: 12, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.928 Vali Acc: 0.539 Test Loss: 0.928 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9813368320465088
Epoch: 13, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.942 Vali Acc: 0.589 Test Loss: 0.942 Test Acc: 0.589
Validation loss decreased (-0.561103 --> -0.588879).  Saving model ...
Epoch: 14 cost time: 0.8412799835205078
Epoch: 14, Steps: 13 | Train Loss: 0.348 Vali Loss: 1.108 Vali Acc: 0.539 Test Loss: 1.108 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.817439079284668
Epoch: 15, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.140 Vali Acc: 0.522 Test Loss: 1.140 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7472727298736572
Epoch: 16, Steps: 13 | Train Loss: 0.260 Vali Loss: 1.215 Vali Acc: 0.456 Test Loss: 1.215 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8700118064880371
Epoch: 17, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.228 Vali Acc: 0.567 Test Loss: 1.228 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.926335334777832
Epoch: 18, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8743422031402588
Epoch: 19, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.249 Vali Acc: 0.528 Test Loss: 1.249 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0212211608886719
Epoch: 20, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.291 Vali Acc: 0.561 Test Loss: 1.291 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9072260856628418
Epoch: 21, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.306 Vali Acc: 0.539 Test Loss: 1.306 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8375170230865479
Epoch: 22, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.280 Vali Acc: 0.544 Test Loss: 1.280 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5925548076629639
Epoch: 23, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.433 Vali Acc: 0.539 Test Loss: 1.433 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps144_str144_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5888888888888889
model parameter : 24460034
model size : 107.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps165_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.6209704875946045
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.709 Vali Acc: 0.478 Test Loss: 0.709 Test Acc: 0.478
Validation loss decreased (inf --> -0.477771).  Saving model ...
Epoch: 2 cost time: 0.8652946949005127
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.710 Vali Acc: 0.517 Test Loss: 0.710 Test Acc: 0.517
Validation loss decreased (-0.477771 --> -0.516660).  Saving model ...
Epoch: 3 cost time: 0.8449385166168213
Epoch: 3, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.732 Vali Acc: 0.522 Test Loss: 0.732 Test Acc: 0.522
Validation loss decreased (-0.516660 --> -0.522215).  Saving model ...
Epoch: 4 cost time: 0.9285295009613037
Epoch: 4, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.738 Vali Acc: 0.511 Test Loss: 0.738 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.038701057434082
Epoch: 5, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1439440250396729
Epoch: 6, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.786 Vali Acc: 0.444 Test Loss: 0.786 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3067374229431152
Epoch: 7, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.943 Vali Acc: 0.483 Test Loss: 0.943 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4763457775115967
Epoch: 8, Steps: 13 | Train Loss: 0.530 Vali Loss: 1.067 Vali Acc: 0.478 Test Loss: 1.067 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8820977210998535
Epoch: 9, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.971 Vali Acc: 0.478 Test Loss: 0.971 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1267483234405518
Epoch: 10, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.047 Vali Acc: 0.483 Test Loss: 1.047 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1606125831604004
Epoch: 11, Steps: 13 | Train Loss: 0.433 Vali Loss: 1.170 Vali Acc: 0.511 Test Loss: 1.170 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8282701969146729
Epoch: 12, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.054 Vali Acc: 0.517 Test Loss: 1.054 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7765030860900879
Epoch: 13, Steps: 13 | Train Loss: 0.305 Vali Loss: 1.123 Vali Acc: 0.556 Test Loss: 1.123 Test Acc: 0.556
Validation loss decreased (-0.522215 --> -0.555544).  Saving model ...
Epoch: 14 cost time: 1.4106411933898926
Epoch: 14, Steps: 13 | Train Loss: 0.490 Vali Loss: 1.552 Vali Acc: 0.489 Test Loss: 1.552 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1372535228729248
Epoch: 15, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.168 Vali Acc: 0.506 Test Loss: 1.168 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9509541988372803
Epoch: 16, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.302 Vali Acc: 0.511 Test Loss: 1.302 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8840181827545166
Epoch: 17, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.528 Vali Acc: 0.544 Test Loss: 1.528 Test Acc: 0.544
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1880545616149902
Epoch: 18, Steps: 13 | Train Loss: 0.224 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0628831386566162
Epoch: 19, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.608 Vali Acc: 0.561 Test Loss: 1.608 Test Acc: 0.561
Validation loss decreased (-0.555544 --> -0.561095).  Saving model ...
Epoch: 20 cost time: 0.9309563636779785
Epoch: 20, Steps: 13 | Train Loss: 0.188 Vali Loss: 1.461 Vali Acc: 0.556 Test Loss: 1.461 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2952604293823242
Epoch: 21, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.556 Vali Acc: 0.522 Test Loss: 1.556 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.059173345565796
Epoch: 22, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.847 Vali Acc: 0.567 Test Loss: 1.847 Test Acc: 0.567
Validation loss decreased (-0.561095 --> -0.566648).  Saving model ...
Epoch: 23 cost time: 1.4389865398406982
Epoch: 23, Steps: 13 | Train Loss: 0.166 Vali Loss: 1.650 Vali Acc: 0.517 Test Loss: 1.650 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0665318965911865
Epoch: 24, Steps: 13 | Train Loss: 0.087 Vali Loss: 2.140 Vali Acc: 0.489 Test Loss: 2.140 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4834485054016113
Epoch: 25, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.980 Vali Acc: 0.517 Test Loss: 1.980 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2444584369659424
Epoch: 26, Steps: 13 | Train Loss: 0.084 Vali Loss: 2.046 Vali Acc: 0.522 Test Loss: 2.046 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9186511039733887
Epoch: 27, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.050 Vali Acc: 0.550 Test Loss: 2.050 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2170331478118896
Epoch: 28, Steps: 13 | Train Loss: 0.068 Vali Loss: 2.228 Vali Acc: 0.522 Test Loss: 2.228 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.971717357635498
Epoch: 29, Steps: 13 | Train Loss: 0.034 Vali Loss: 2.587 Vali Acc: 0.483 Test Loss: 2.587 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8512206077575684
Epoch: 30, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.972 Vali Acc: 0.500 Test Loss: 1.972 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2295820713043213
Epoch: 31, Steps: 13 | Train Loss: 0.046 Vali Loss: 2.517 Vali Acc: 0.506 Test Loss: 2.517 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9592080116271973
Epoch: 32, Steps: 13 | Train Loss: 0.044 Vali Loss: 2.619 Vali Acc: 0.544 Test Loss: 2.619 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps165_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5666666666666667
model parameter : 24847874
model size : 109.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps165_str83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.386808395385742
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.714 Vali Acc: 0.489 Test Loss: 0.714 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 1.0205705165863037
Epoch: 2, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.703 Vali Acc: 0.506 Test Loss: 0.703 Test Acc: 0.506
Validation loss decreased (-0.488882 --> -0.505549).  Saving model ...
Epoch: 3 cost time: 0.8957674503326416
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.707 Vali Acc: 0.506 Test Loss: 0.707 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9655418395996094
Epoch: 4, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.705 Vali Acc: 0.544 Test Loss: 0.705 Test Acc: 0.544
Validation loss decreased (-0.505549 --> -0.544437).  Saving model ...
Epoch: 5 cost time: 1.0022571086883545
Epoch: 5, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.722 Vali Acc: 0.528 Test Loss: 0.722 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1798100471496582
Epoch: 6, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.817 Vali Acc: 0.522 Test Loss: 0.817 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1833553314208984
Epoch: 7, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.800 Vali Acc: 0.533 Test Loss: 0.800 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0215418338775635
Epoch: 8, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.793 Vali Acc: 0.528 Test Loss: 0.793 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.880685567855835
Epoch: 9, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.790 Vali Acc: 0.517 Test Loss: 0.790 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1411547660827637
Epoch: 10, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.797 Vali Acc: 0.533 Test Loss: 0.797 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9403800964355469
Epoch: 11, Steps: 13 | Train Loss: 0.406 Vali Loss: 1.092 Vali Acc: 0.483 Test Loss: 1.092 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.814033031463623
Epoch: 12, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.931 Vali Acc: 0.544 Test Loss: 0.931 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9103870391845703
Epoch: 13, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.020 Vali Acc: 0.494 Test Loss: 1.020 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.932183027267456
Epoch: 14, Steps: 13 | Train Loss: 0.299 Vali Loss: 1.039 Vali Acc: 0.528 Test Loss: 1.039 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps165_str83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 24811010
model size : 109.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps165_str165_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5085926055908203
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.721 Vali Acc: 0.411 Test Loss: 0.721 Test Acc: 0.411
Validation loss decreased (inf --> -0.411104).  Saving model ...
Epoch: 2 cost time: 1.0044219493865967
Epoch: 2, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.726 Vali Acc: 0.483 Test Loss: 0.726 Test Acc: 0.483
Validation loss decreased (-0.411104 --> -0.483326).  Saving model ...
Epoch: 3 cost time: 0.7735559940338135
Epoch: 3, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.727 Vali Acc: 0.517 Test Loss: 0.727 Test Acc: 0.517
Validation loss decreased (-0.483326 --> -0.516659).  Saving model ...
Epoch: 4 cost time: 0.9917643070220947
Epoch: 4, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.697 Vali Acc: 0.506 Test Loss: 0.697 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9783625602722168
Epoch: 5, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.726 Vali Acc: 0.528 Test Loss: 0.726 Test Acc: 0.528
Validation loss decreased (-0.516659 --> -0.527771).  Saving model ...
Epoch: 6 cost time: 0.9906024932861328
Epoch: 6, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.744 Vali Acc: 0.528 Test Loss: 0.744 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.117631435394287
Epoch: 7, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.824 Vali Acc: 0.494 Test Loss: 0.824 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9170544147491455
Epoch: 8, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.856 Vali Acc: 0.517 Test Loss: 0.856 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9299263954162598
Epoch: 9, Steps: 13 | Train Loss: 0.478 Vali Loss: 1.017 Vali Acc: 0.483 Test Loss: 1.017 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7677550315856934
Epoch: 10, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.932 Vali Acc: 0.467 Test Loss: 0.932 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7496156692504883
Epoch: 11, Steps: 13 | Train Loss: 0.372 Vali Loss: 1.052 Vali Acc: 0.544 Test Loss: 1.052 Test Acc: 0.544
Validation loss decreased (-0.527771 --> -0.544434).  Saving model ...
Epoch: 12 cost time: 1.0237071514129639
Epoch: 12, Steps: 13 | Train Loss: 0.301 Vali Loss: 1.051 Vali Acc: 0.500 Test Loss: 1.051 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8842458724975586
Epoch: 13, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.979 Vali Acc: 0.544 Test Loss: 0.979 Test Acc: 0.544
Validation loss decreased (-0.544434 --> -0.544435).  Saving model ...
Epoch: 14 cost time: 0.9001109600067139
Epoch: 14, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.981 Vali Acc: 0.517 Test Loss: 0.981 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8586013317108154
Epoch: 15, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.173 Vali Acc: 0.511 Test Loss: 1.173 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7760920524597168
Epoch: 16, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.277 Vali Acc: 0.522 Test Loss: 1.277 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6675834655761719
Epoch: 17, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.353 Vali Acc: 0.483 Test Loss: 1.353 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8240103721618652
Epoch: 18, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.468 Vali Acc: 0.517 Test Loss: 1.468 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9405770301818848
Epoch: 19, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.354 Vali Acc: 0.489 Test Loss: 1.354 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.978179931640625
Epoch: 20, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.511 Vali Acc: 0.550 Test Loss: 1.511 Test Acc: 0.550
Validation loss decreased (-0.544435 --> -0.549985).  Saving model ...
Epoch: 21 cost time: 1.0559258460998535
Epoch: 21, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.410 Vali Acc: 0.472 Test Loss: 1.410 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9617021083831787
Epoch: 22, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.367 Vali Acc: 0.511 Test Loss: 1.367 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9382748603820801
Epoch: 23, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.382 Vali Acc: 0.511 Test Loss: 1.382 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7672474384307861
Epoch: 24, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.603 Vali Acc: 0.494 Test Loss: 1.603 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.056239128112793
Epoch: 25, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.781914234161377
Epoch: 26, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.636 Vali Acc: 0.506 Test Loss: 1.636 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9210953712463379
Epoch: 27, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.437 Vali Acc: 0.506 Test Loss: 1.437 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7124607563018799
Epoch: 28, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.510 Vali Acc: 0.517 Test Loss: 1.510 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6689956188201904
Epoch: 29, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.731 Vali Acc: 0.544 Test Loss: 1.731 Test Acc: 0.544
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8896100521087646
Epoch: 30, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.808 Vali Acc: 0.539 Test Loss: 1.808 Test Acc: 0.539
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps165_str165_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 24792578
model size : 109.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps192_str48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.547816753387451
Epoch: 1, Steps: 13 | Train Loss: 0.765 Vali Loss: 0.707 Vali Acc: 0.533 Test Loss: 0.707 Test Acc: 0.533
Validation loss decreased (inf --> -0.533326).  Saving model ...
Epoch: 2 cost time: 1.359696865081787
Epoch: 2, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.740 Vali Acc: 0.506 Test Loss: 0.740 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9802634716033936
Epoch: 3, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.717 Vali Acc: 0.556 Test Loss: 0.717 Test Acc: 0.556
Validation loss decreased (-0.533326 --> -0.555548).  Saving model ...
Epoch: 4 cost time: 1.2687840461730957
Epoch: 4, Steps: 13 | Train Loss: 0.643 Vali Loss: 0.748 Vali Acc: 0.517 Test Loss: 0.748 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.805739164352417
Epoch: 5, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.703 Vali Acc: 0.511 Test Loss: 0.703 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8808383941650391
Epoch: 6, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.739 Vali Acc: 0.528 Test Loss: 0.739 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9433095455169678
Epoch: 7, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.748 Vali Acc: 0.550 Test Loss: 0.748 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1732392311096191
Epoch: 8, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8874588012695312
Epoch: 9, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.840 Vali Acc: 0.533 Test Loss: 0.840 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.930950403213501
Epoch: 10, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.851 Vali Acc: 0.494 Test Loss: 0.851 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1773910522460938
Epoch: 11, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.789 Vali Acc: 0.544 Test Loss: 0.789 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9701170921325684
Epoch: 12, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.941 Vali Acc: 0.539 Test Loss: 0.941 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8751342296600342
Epoch: 13, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.881 Vali Acc: 0.528 Test Loss: 0.881 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps192_str48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5555555555555556
model parameter : 25274114
model size : 111.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps192_str96_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5116055011749268
Epoch: 1, Steps: 13 | Train Loss: 0.747 Vali Loss: 0.691 Vali Acc: 0.506 Test Loss: 0.691 Test Acc: 0.506
Validation loss decreased (inf --> -0.505549).  Saving model ...
Epoch: 2 cost time: 0.8481495380401611
Epoch: 2, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.695 Vali Acc: 0.489 Test Loss: 0.695 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8930952548980713
Epoch: 3, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.689 Vali Acc: 0.500 Test Loss: 0.689 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8572902679443359
Epoch: 4, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.724 Vali Acc: 0.489 Test Loss: 0.724 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7110733985900879
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.740 Vali Acc: 0.494 Test Loss: 0.740 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7721896171569824
Epoch: 6, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.948 Vali Acc: 0.467 Test Loss: 0.948 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8775424957275391
Epoch: 7, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.761 Vali Acc: 0.550 Test Loss: 0.761 Test Acc: 0.550
Validation loss decreased (-0.505549 --> -0.549992).  Saving model ...
Epoch: 8 cost time: 0.8040986061096191
Epoch: 8, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.782 Vali Acc: 0.528 Test Loss: 0.782 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7198593616485596
Epoch: 9, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.872 Vali Acc: 0.478 Test Loss: 0.872 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7753705978393555
Epoch: 10, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9496805667877197
Epoch: 11, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.832 Vali Acc: 0.494 Test Loss: 0.832 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9743530750274658
Epoch: 12, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.898 Vali Acc: 0.500 Test Loss: 0.898 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9742646217346191
Epoch: 13, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.969 Vali Acc: 0.544 Test Loss: 0.969 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9185473918914795
Epoch: 14, Steps: 13 | Train Loss: 0.255 Vali Loss: 1.251 Vali Acc: 0.472 Test Loss: 1.251 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7946372032165527
Epoch: 15, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.102 Vali Acc: 0.506 Test Loss: 1.102 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9985470771789551
Epoch: 16, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.308 Vali Acc: 0.533 Test Loss: 1.308 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0565378665924072
Epoch: 17, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.500 Vali Acc: 0.450 Test Loss: 1.500 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps192_str96_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 25243394
model size : 110.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps192_str192_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.283869743347168
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.721 Vali Acc: 0.494 Test Loss: 0.721 Test Acc: 0.494
Validation loss decreased (inf --> -0.494437).  Saving model ...
Epoch: 2 cost time: 0.6844801902770996
Epoch: 2, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.730 Vali Acc: 0.450 Test Loss: 0.730 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8913640975952148
Epoch: 3, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.704 Vali Acc: 0.506 Test Loss: 0.704 Test Acc: 0.506
Validation loss decreased (-0.494437 --> -0.505549).  Saving model ...
Epoch: 4 cost time: 0.8407678604125977
Epoch: 4, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.726 Vali Acc: 0.472 Test Loss: 0.726 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7697997093200684
Epoch: 5, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.686 Vali Acc: 0.583 Test Loss: 0.686 Test Acc: 0.583
Validation loss decreased (-0.505549 --> -0.583326).  Saving model ...
Epoch: 6 cost time: 0.861875057220459
Epoch: 6, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.752 Vali Acc: 0.461 Test Loss: 0.752 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.719200849533081
Epoch: 7, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.726 Vali Acc: 0.567 Test Loss: 0.726 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7514727115631104
Epoch: 8, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.803 Vali Acc: 0.478 Test Loss: 0.803 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8378465175628662
Epoch: 9, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.952 Vali Acc: 0.528 Test Loss: 0.952 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7521700859069824
Epoch: 10, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.803 Vali Acc: 0.506 Test Loss: 0.803 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8044288158416748
Epoch: 11, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.913 Vali Acc: 0.489 Test Loss: 0.913 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7218129634857178
Epoch: 12, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.859 Vali Acc: 0.533 Test Loss: 0.859 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7732710838317871
Epoch: 13, Steps: 13 | Train Loss: 0.319 Vali Loss: 1.008 Vali Acc: 0.522 Test Loss: 1.008 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6794962882995605
Epoch: 14, Steps: 13 | Train Loss: 0.302 Vali Loss: 1.011 Vali Acc: 0.522 Test Loss: 1.011 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.767946720123291
Epoch: 15, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.932 Vali Acc: 0.517 Test Loss: 0.932 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps192_str192_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5833333333333334
model parameter : 25228034
model size : 110.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps231_str58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.5084784030914307
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.707 Vali Acc: 0.489 Test Loss: 0.707 Test Acc: 0.489
Validation loss decreased (inf --> -0.488882).  Saving model ...
Epoch: 2 cost time: 0.8078923225402832
Epoch: 2, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.688 Vali Acc: 0.528 Test Loss: 0.688 Test Acc: 0.528
Validation loss decreased (-0.488882 --> -0.527771).  Saving model ...
Epoch: 3 cost time: 1.3502724170684814
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.710 Vali Acc: 0.506 Test Loss: 0.710 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2125778198242188
Epoch: 4, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.710 Vali Acc: 0.550 Test Loss: 0.710 Test Acc: 0.550
Validation loss decreased (-0.527771 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 1.3913264274597168
Epoch: 5, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.778 Vali Acc: 0.522 Test Loss: 0.778 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1972131729125977
Epoch: 6, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.755 Vali Acc: 0.500 Test Loss: 0.755 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9862074851989746
Epoch: 7, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.823 Vali Acc: 0.461 Test Loss: 0.823 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5013353824615479
Epoch: 8, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.974 Vali Acc: 0.456 Test Loss: 0.974 Test Acc: 0.456
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2199296951293945
Epoch: 9, Steps: 13 | Train Loss: 0.492 Vali Loss: 1.211 Vali Acc: 0.528 Test Loss: 1.211 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8429470062255859
Epoch: 10, Steps: 13 | Train Loss: 0.521 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9031972885131836
Epoch: 11, Steps: 13 | Train Loss: 0.376 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6474449634552002
Epoch: 12, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.267 Vali Acc: 0.444 Test Loss: 1.267 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0603504180908203
Epoch: 13, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.245 Vali Acc: 0.517 Test Loss: 1.245 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8367733955383301
Epoch: 14, Steps: 13 | Train Loss: 0.291 Vali Loss: 1.396 Vali Acc: 0.500 Test Loss: 1.396 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps231_str58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 25887746
model size : 113.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps231_str116_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.9058971405029297
Epoch: 1, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.693 Vali Acc: 0.539 Test Loss: 0.693 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 1.0066330432891846
Epoch: 2, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.702 Vali Acc: 0.500 Test Loss: 0.702 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9204277992248535
Epoch: 3, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.713 Vali Acc: 0.467 Test Loss: 0.713 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2961697578430176
Epoch: 4, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.711 Vali Acc: 0.506 Test Loss: 0.711 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9129142761230469
Epoch: 5, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.738 Vali Acc: 0.489 Test Loss: 0.738 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0490763187408447
Epoch: 6, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.763 Vali Acc: 0.533 Test Loss: 0.763 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9250779151916504
Epoch: 7, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.800 Vali Acc: 0.506 Test Loss: 0.800 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1661419868469238
Epoch: 8, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.910 Vali Acc: 0.528 Test Loss: 0.910 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0628883838653564
Epoch: 9, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.875 Vali Acc: 0.533 Test Loss: 0.875 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9693834781646729
Epoch: 10, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.893 Vali Acc: 0.544 Test Loss: 0.893 Test Acc: 0.544
Validation loss decreased (-0.538882 --> -0.544436).  Saving model ...
Epoch: 11 cost time: 1.0646190643310547
Epoch: 11, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.955 Vali Acc: 0.489 Test Loss: 0.955 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.999788761138916
Epoch: 12, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.034 Vali Acc: 0.506 Test Loss: 1.034 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1088647842407227
Epoch: 13, Steps: 13 | Train Loss: 0.320 Vali Loss: 1.123 Vali Acc: 0.489 Test Loss: 1.123 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7840321063995361
Epoch: 14, Steps: 13 | Train Loss: 0.273 Vali Loss: 1.122 Vali Acc: 0.461 Test Loss: 1.122 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8186585903167725
Epoch: 15, Steps: 13 | Train Loss: 0.247 Vali Loss: 1.557 Vali Acc: 0.461 Test Loss: 1.557 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9985971450805664
Epoch: 16, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.140 Vali Acc: 0.517 Test Loss: 1.140 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7577955722808838
Epoch: 17, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.277 Vali Acc: 0.478 Test Loss: 1.277 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9924912452697754
Epoch: 18, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.301 Vali Acc: 0.472 Test Loss: 1.301 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8337588310241699
Epoch: 19, Steps: 13 | Train Loss: 0.210 Vali Loss: 1.387 Vali Acc: 0.522 Test Loss: 1.387 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.084404468536377
Epoch: 20, Steps: 13 | Train Loss: 0.165 Vali Loss: 1.422 Vali Acc: 0.506 Test Loss: 1.422 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps231_str116_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.5444444444444444
model parameter : 25863170
model size : 113.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP2Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP2/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             7                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

200
180
>>>>>>>start training : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps231_str231_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
200
180
180
Epoch: 1 cost time: 2.3675899505615234
Epoch: 1, Steps: 13 | Train Loss: 0.698 Vali Loss: 0.702 Vali Acc: 0.539 Test Loss: 0.702 Test Acc: 0.539
Validation loss decreased (inf --> -0.538882).  Saving model ...
Epoch: 2 cost time: 0.975292444229126
Epoch: 2, Steps: 13 | Train Loss: 0.689 Vali Loss: 0.698 Vali Acc: 0.539 Test Loss: 0.698 Test Acc: 0.539
Validation loss decreased (-0.538882 --> -0.538882).  Saving model ...
Epoch: 3 cost time: 1.1308510303497314
Epoch: 3, Steps: 13 | Train Loss: 0.642 Vali Loss: 0.706 Vali Acc: 0.506 Test Loss: 0.706 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8724408149719238
Epoch: 4, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.720 Vali Acc: 0.506 Test Loss: 0.720 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.849895715713501
Epoch: 5, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.820 Vali Acc: 0.467 Test Loss: 0.820 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0163686275482178
Epoch: 6, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.773 Vali Acc: 0.550 Test Loss: 0.773 Test Acc: 0.550
Validation loss decreased (-0.538882 --> -0.549992).  Saving model ...
Epoch: 7 cost time: 0.8916754722595215
Epoch: 7, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.837 Vali Acc: 0.522 Test Loss: 0.837 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0035758018493652
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.853 Vali Acc: 0.522 Test Loss: 0.853 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7491786479949951
Epoch: 9, Steps: 13 | Train Loss: 0.383 Vali Loss: 1.010 Vali Acc: 0.511 Test Loss: 1.010 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6910314559936523
Epoch: 10, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.901 Vali Acc: 0.522 Test Loss: 0.901 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.775864839553833
Epoch: 11, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.082 Vali Acc: 0.494 Test Loss: 1.082 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0121805667877197
Epoch: 12, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.929 Vali Acc: 0.500 Test Loss: 0.929 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8900058269500732
Epoch: 13, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.065 Vali Acc: 0.528 Test Loss: 1.065 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8920631408691406
Epoch: 14, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.059 Vali Acc: 0.539 Test Loss: 1.059 Test Acc: 0.539
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7634506225585938
Epoch: 15, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.420 Vali Acc: 0.506 Test Loss: 1.420 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7093265056610107
Epoch: 16, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.426 Vali Acc: 0.544 Test Loss: 1.426 Test Acc: 0.544
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP2_GPT4TS_UEA_ftM_sl1152_ll0_pl0_el3_dm768_df768_ps231_str231_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 2]) torch.Size([180, 1])
accuracy:0.55
model parameter : 25850882
model size : 113.28MB
