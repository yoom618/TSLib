Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.556924343109131
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.491 Vali Acc: 0.267 Test Loss: 2.491 Test Acc: 0.267
Validation loss decreased (inf --> -0.266642).  Saving model ...
Epoch: 2 cost time: 2.721245288848877
Epoch: 2, Steps: 12 | Train Loss: 2.310 Vali Loss: 1.998 Vali Acc: 0.450 Test Loss: 1.998 Test Acc: 0.450
Validation loss decreased (-0.266642 --> -0.449980).  Saving model ...
Epoch: 3 cost time: 3.443408489227295
Epoch: 3, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.602 Vali Acc: 0.561 Test Loss: 1.602 Test Acc: 0.561
Validation loss decreased (-0.449980 --> -0.561095).  Saving model ...
Epoch: 4 cost time: 3.425312042236328
Epoch: 4, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.297 Vali Acc: 0.617 Test Loss: 1.297 Test Acc: 0.617
Validation loss decreased (-0.561095 --> -0.616654).  Saving model ...
Epoch: 5 cost time: 3.226404905319214
Epoch: 5, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.158 Vali Acc: 0.622 Test Loss: 1.158 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622211).  Saving model ...
Epoch: 6 cost time: 3.098179340362549
Epoch: 6, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.149 Vali Acc: 0.650 Test Loss: 1.149 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 3.063607692718506
Epoch: 7, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.355 Vali Acc: 0.672 Test Loss: 1.355 Test Acc: 0.672
Validation loss decreased (-0.649989 --> -0.672209).  Saving model ...
Epoch: 8 cost time: 2.930919647216797
Epoch: 8, Steps: 12 | Train Loss: 0.781 Vali Loss: 1.209 Vali Acc: 0.656 Test Loss: 1.209 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.968193292617798
Epoch: 9, Steps: 12 | Train Loss: 0.582 Vali Loss: 1.211 Vali Acc: 0.672 Test Loss: 1.211 Test Acc: 0.672
Validation loss decreased (-0.672209 --> -0.672210).  Saving model ...
Epoch: 10 cost time: 2.5462894439697266
Epoch: 10, Steps: 12 | Train Loss: 0.510 Vali Loss: 1.655 Vali Acc: 0.617 Test Loss: 1.655 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.462928295135498
Epoch: 11, Steps: 12 | Train Loss: 0.635 Vali Loss: 1.589 Vali Acc: 0.611 Test Loss: 1.589 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.861616373062134
Epoch: 12, Steps: 12 | Train Loss: 0.718 Vali Loss: 1.580 Vali Acc: 0.683 Test Loss: 1.580 Test Acc: 0.683
Validation loss decreased (-0.672210 --> -0.683318).  Saving model ...
Epoch: 13 cost time: 3.0204296112060547
Epoch: 13, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.805 Vali Acc: 0.661 Test Loss: 1.805 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.234593391418457
Epoch: 14, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.812 Vali Acc: 0.689 Test Loss: 1.812 Test Acc: 0.689
Validation loss decreased (-0.683318 --> -0.688871).  Saving model ...
Epoch: 15 cost time: 2.96669602394104
Epoch: 15, Steps: 12 | Train Loss: 0.526 Vali Loss: 1.446 Vali Acc: 0.733 Test Loss: 1.446 Test Acc: 0.733
Validation loss decreased (-0.688871 --> -0.733319).  Saving model ...
Epoch: 16 cost time: 2.410039186477661
Epoch: 16, Steps: 12 | Train Loss: 0.361 Vali Loss: 1.451 Vali Acc: 0.750 Test Loss: 1.451 Test Acc: 0.750
Validation loss decreased (-0.733319 --> -0.749985).  Saving model ...
Epoch: 17 cost time: 2.716111183166504
Epoch: 17, Steps: 12 | Train Loss: 0.331 Vali Loss: 1.591 Vali Acc: 0.728 Test Loss: 1.591 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.844097375869751
Epoch: 18, Steps: 12 | Train Loss: 0.270 Vali Loss: 1.865 Vali Acc: 0.700 Test Loss: 1.865 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.576107978820801
Epoch: 19, Steps: 12 | Train Loss: 0.350 Vali Loss: 1.609 Vali Acc: 0.733 Test Loss: 1.609 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6677961349487305
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.568 Vali Acc: 0.733 Test Loss: 1.568 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.675813674926758
Epoch: 21, Steps: 12 | Train Loss: 0.426 Vali Loss: 1.958 Vali Acc: 0.700 Test Loss: 1.958 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.737189769744873
Epoch: 22, Steps: 12 | Train Loss: 0.461 Vali Loss: 1.906 Vali Acc: 0.750 Test Loss: 1.906 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.0439674854278564
Epoch: 23, Steps: 12 | Train Loss: 0.523 Vali Loss: 1.878 Vali Acc: 0.722 Test Loss: 1.878 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.656191349029541
Epoch: 24, Steps: 12 | Train Loss: 0.282 Vali Loss: 1.875 Vali Acc: 0.739 Test Loss: 1.875 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.095775842666626
Epoch: 25, Steps: 12 | Train Loss: 0.329 Vali Loss: 1.586 Vali Acc: 0.761 Test Loss: 1.586 Test Acc: 0.761
Validation loss decreased (-0.749985 --> -0.761095).  Saving model ...
Epoch: 26 cost time: 2.846435546875
Epoch: 26, Steps: 12 | Train Loss: 0.287 Vali Loss: 1.668 Vali Acc: 0.750 Test Loss: 1.668 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9274773597717285
Epoch: 27, Steps: 12 | Train Loss: 0.185 Vali Loss: 2.156 Vali Acc: 0.739 Test Loss: 2.156 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.050747871398926
Epoch: 28, Steps: 12 | Train Loss: 0.240 Vali Loss: 2.371 Vali Acc: 0.656 Test Loss: 2.371 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.001091957092285
Epoch: 29, Steps: 12 | Train Loss: 0.145 Vali Loss: 2.426 Vali Acc: 0.683 Test Loss: 2.426 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.1046531200408936
Epoch: 30, Steps: 12 | Train Loss: 0.327 Vali Loss: 2.845 Vali Acc: 0.733 Test Loss: 2.845 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.0579960346221924
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 2.987 Vali Acc: 0.700 Test Loss: 2.987 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.4730448722839355
Epoch: 32, Steps: 12 | Train Loss: 0.428 Vali Loss: 3.498 Vali Acc: 0.722 Test Loss: 3.498 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.7256011962890625
Epoch: 33, Steps: 12 | Train Loss: 0.284 Vali Loss: 3.120 Vali Acc: 0.733 Test Loss: 3.120 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.688807487487793
Epoch: 34, Steps: 12 | Train Loss: 0.302 Vali Loss: 2.606 Vali Acc: 0.728 Test Loss: 2.606 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.6937167644500732
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 2.970 Vali Acc: 0.678 Test Loss: 2.970 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 43970319
model size : 182.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2539963722229004
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.624 Vali Acc: 0.239 Test Loss: 2.624 Test Acc: 0.239
Validation loss decreased (inf --> -0.238863).  Saving model ...
Epoch: 2 cost time: 1.7155652046203613
Epoch: 2, Steps: 12 | Train Loss: 2.487 Vali Loss: 2.267 Vali Acc: 0.394 Test Loss: 2.267 Test Acc: 0.394
Validation loss decreased (-0.238863 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 2.027956008911133
Epoch: 3, Steps: 12 | Train Loss: 2.048 Vali Loss: 1.807 Vali Acc: 0.561 Test Loss: 1.807 Test Acc: 0.561
Validation loss decreased (-0.394422 --> -0.561093).  Saving model ...
Epoch: 4 cost time: 2.0715606212615967
Epoch: 4, Steps: 12 | Train Loss: 1.596 Vali Loss: 1.493 Vali Acc: 0.578 Test Loss: 1.493 Test Acc: 0.578
Validation loss decreased (-0.561093 --> -0.577763).  Saving model ...
Epoch: 5 cost time: 2.563697338104248
Epoch: 5, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.202 Vali Acc: 0.578 Test Loss: 1.202 Test Acc: 0.578
Validation loss decreased (-0.577763 --> -0.577766).  Saving model ...
Epoch: 6 cost time: 2.4671835899353027
Epoch: 6, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.079 Vali Acc: 0.622 Test Loss: 1.079 Test Acc: 0.622
Validation loss decreased (-0.577766 --> -0.622211).  Saving model ...
Epoch: 7 cost time: 2.588043212890625
Epoch: 7, Steps: 12 | Train Loss: 0.792 Vali Loss: 0.964 Vali Acc: 0.650 Test Loss: 0.964 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 2.3228325843811035
Epoch: 8, Steps: 12 | Train Loss: 0.824 Vali Loss: 1.128 Vali Acc: 0.661 Test Loss: 1.128 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661100).  Saving model ...
Epoch: 9 cost time: 2.275390625
Epoch: 9, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.996 Vali Acc: 0.711 Test Loss: 0.996 Test Acc: 0.711
Validation loss decreased (-0.661100 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 2.5757932662963867
Epoch: 10, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.932 Vali Acc: 0.717 Test Loss: 0.932 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 2.379894971847534
Epoch: 11, Steps: 12 | Train Loss: 0.414 Vali Loss: 1.307 Vali Acc: 0.672 Test Loss: 1.307 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7523396015167236
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.143 Vali Acc: 0.650 Test Loss: 1.143 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.297433853149414
Epoch: 13, Steps: 12 | Train Loss: 0.440 Vali Loss: 1.292 Vali Acc: 0.694 Test Loss: 1.292 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.701113224029541
Epoch: 14, Steps: 12 | Train Loss: 0.396 Vali Loss: 1.001 Vali Acc: 0.733 Test Loss: 1.001 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 1.5221507549285889
Epoch: 15, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.059 Vali Acc: 0.750 Test Loss: 1.059 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749989).  Saving model ...
Epoch: 16 cost time: 1.28851318359375
Epoch: 16, Steps: 12 | Train Loss: 0.520 Vali Loss: 1.294 Vali Acc: 0.706 Test Loss: 1.294 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.709857702255249
Epoch: 17, Steps: 12 | Train Loss: 0.275 Vali Loss: 1.055 Vali Acc: 0.722 Test Loss: 1.055 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5739333629608154
Epoch: 18, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.150 Vali Acc: 0.744 Test Loss: 1.150 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3453783988952637
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 1.225 Vali Acc: 0.778 Test Loss: 1.225 Test Acc: 0.778
Validation loss decreased (-0.749989 --> -0.777766).  Saving model ...
Epoch: 20 cost time: 1.9239377975463867
Epoch: 20, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.450 Vali Acc: 0.717 Test Loss: 1.450 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8285715579986572
Epoch: 21, Steps: 12 | Train Loss: 0.234 Vali Loss: 1.485 Vali Acc: 0.728 Test Loss: 1.485 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.641204595565796
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.418 Vali Acc: 0.750 Test Loss: 1.418 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.718797206878662
Epoch: 23, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.283 Vali Acc: 0.772 Test Loss: 1.283 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1801133155822754
Epoch: 24, Steps: 12 | Train Loss: 0.211 Vali Loss: 1.279 Vali Acc: 0.767 Test Loss: 1.279 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2077558040618896
Epoch: 25, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.486 Vali Acc: 0.756 Test Loss: 1.486 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0157902240753174
Epoch: 26, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.556 Vali Acc: 0.761 Test Loss: 1.556 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6860485076904297
Epoch: 27, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.267 Vali Acc: 0.811 Test Loss: 1.267 Test Acc: 0.811
Validation loss decreased (-0.777766 --> -0.811098).  Saving model ...
Epoch: 28 cost time: 2.0761196613311768
Epoch: 28, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.297 Vali Acc: 0.817 Test Loss: 1.297 Test Acc: 0.817
Validation loss decreased (-0.811098 --> -0.816654).  Saving model ...
Epoch: 29 cost time: 1.503969430923462
Epoch: 29, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.622 Vali Acc: 0.783 Test Loss: 1.622 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1844570636749268
Epoch: 30, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.425 Vali Acc: 0.794 Test Loss: 1.425 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.6317551136016846
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.391 Vali Acc: 0.800 Test Loss: 1.391 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.4483602046966553
Epoch: 32, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.385 Vali Acc: 0.767 Test Loss: 1.385 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.411234140396118
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.677 Vali Acc: 0.761 Test Loss: 1.677 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.356738567352295
Epoch: 34, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.626 Vali Acc: 0.794 Test Loss: 1.626 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.612893581390381
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.841 Vali Acc: 0.783 Test Loss: 1.841 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.2713475227355957
Epoch: 36, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.867 Vali Acc: 0.767 Test Loss: 1.867 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.8155503273010254
Epoch: 37, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.777 Vali Acc: 0.789 Test Loss: 1.777 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.6885156631469727
Epoch: 38, Steps: 12 | Train Loss: 0.123 Vali Loss: 2.178 Vali Acc: 0.744 Test Loss: 2.178 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 43683087
model size : 181.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.820816993713379
Epoch: 1, Steps: 12 | Train Loss: 2.783 Vali Loss: 2.555 Vali Acc: 0.200 Test Loss: 2.555 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 1.9707040786743164
Epoch: 2, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.074 Vali Acc: 0.489 Test Loss: 2.074 Test Acc: 0.489
Validation loss decreased (-0.199974 --> -0.488868).  Saving model ...
Epoch: 3 cost time: 1.9711482524871826
Epoch: 3, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.638 Vali Acc: 0.583 Test Loss: 1.638 Test Acc: 0.583
Validation loss decreased (-0.488868 --> -0.583317).  Saving model ...
Epoch: 4 cost time: 1.9176204204559326
Epoch: 4, Steps: 12 | Train Loss: 1.341 Vali Loss: 1.485 Vali Acc: 0.494 Test Loss: 1.485 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.213719367980957
Epoch: 5, Steps: 12 | Train Loss: 1.084 Vali Loss: 1.271 Vali Acc: 0.606 Test Loss: 1.271 Test Acc: 0.606
Validation loss decreased (-0.583317 --> -0.605543).  Saving model ...
Epoch: 6 cost time: 2.214325428009033
Epoch: 6, Steps: 12 | Train Loss: 0.951 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0324208736419678
Epoch: 7, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.983 Vali Acc: 0.667 Test Loss: 0.983 Test Acc: 0.667
Validation loss decreased (-0.605543 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 2.11700177192688
Epoch: 8, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.077 Vali Acc: 0.650 Test Loss: 1.077 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9760196208953857
Epoch: 9, Steps: 12 | Train Loss: 0.611 Vali Loss: 1.105 Vali Acc: 0.672 Test Loss: 1.105 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672211).  Saving model ...
Epoch: 10 cost time: 2.384101629257202
Epoch: 10, Steps: 12 | Train Loss: 0.448 Vali Loss: 1.212 Vali Acc: 0.683 Test Loss: 1.212 Test Acc: 0.683
Validation loss decreased (-0.672211 --> -0.683321).  Saving model ...
Epoch: 11 cost time: 2.1519174575805664
Epoch: 11, Steps: 12 | Train Loss: 0.483 Vali Loss: 1.071 Vali Acc: 0.706 Test Loss: 1.071 Test Acc: 0.706
Validation loss decreased (-0.683321 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 2.330200433731079
Epoch: 12, Steps: 12 | Train Loss: 0.353 Vali Loss: 1.021 Vali Acc: 0.750 Test Loss: 1.021 Test Acc: 0.750
Validation loss decreased (-0.705545 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 2.2442378997802734
Epoch: 13, Steps: 12 | Train Loss: 0.360 Vali Loss: 1.300 Vali Acc: 0.700 Test Loss: 1.300 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6511690616607666
Epoch: 14, Steps: 12 | Train Loss: 0.352 Vali Loss: 1.661 Vali Acc: 0.650 Test Loss: 1.661 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.651611089706421
Epoch: 15, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.703 Vali Acc: 0.683 Test Loss: 1.703 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.659012794494629
Epoch: 16, Steps: 12 | Train Loss: 0.432 Vali Loss: 1.392 Vali Acc: 0.772 Test Loss: 1.392 Test Acc: 0.772
Validation loss decreased (-0.749990 --> -0.772208).  Saving model ...
Epoch: 17 cost time: 2.4138691425323486
Epoch: 17, Steps: 12 | Train Loss: 0.403 Vali Loss: 1.406 Vali Acc: 0.744 Test Loss: 1.406 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7373015880584717
Epoch: 18, Steps: 12 | Train Loss: 0.203 Vali Loss: 1.749 Vali Acc: 0.672 Test Loss: 1.749 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0490925312042236
Epoch: 19, Steps: 12 | Train Loss: 0.554 Vali Loss: 1.780 Vali Acc: 0.700 Test Loss: 1.780 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2274928092956543
Epoch: 20, Steps: 12 | Train Loss: 0.381 Vali Loss: 1.797 Vali Acc: 0.700 Test Loss: 1.797 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8633792400360107
Epoch: 21, Steps: 12 | Train Loss: 0.304 Vali Loss: 1.758 Vali Acc: 0.694 Test Loss: 1.758 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.17439866065979
Epoch: 22, Steps: 12 | Train Loss: 0.291 Vali Loss: 1.435 Vali Acc: 0.767 Test Loss: 1.435 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9090096950531006
Epoch: 23, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.981 Vali Acc: 0.706 Test Loss: 1.981 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6515593528747559
Epoch: 24, Steps: 12 | Train Loss: 0.280 Vali Loss: 1.669 Vali Acc: 0.744 Test Loss: 1.669 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2994592189788818
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.873 Vali Acc: 0.750 Test Loss: 1.873 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8446426391601562
Epoch: 26, Steps: 12 | Train Loss: 0.155 Vali Loss: 1.679 Vali Acc: 0.783 Test Loss: 1.679 Test Acc: 0.783
Validation loss decreased (-0.772208 --> -0.783317).  Saving model ...
Epoch: 27 cost time: 1.8666114807128906
Epoch: 27, Steps: 12 | Train Loss: 0.125 Vali Loss: 2.381 Vali Acc: 0.700 Test Loss: 2.381 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.190448522567749
Epoch: 28, Steps: 12 | Train Loss: 0.100 Vali Loss: 2.263 Vali Acc: 0.717 Test Loss: 2.263 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.751725196838379
Epoch: 29, Steps: 12 | Train Loss: 0.288 Vali Loss: 2.286 Vali Acc: 0.733 Test Loss: 2.286 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9798734188079834
Epoch: 30, Steps: 12 | Train Loss: 0.137 Vali Loss: 2.195 Vali Acc: 0.739 Test Loss: 2.195 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2211225032806396
Epoch: 31, Steps: 12 | Train Loss: 0.137 Vali Loss: 2.714 Vali Acc: 0.717 Test Loss: 2.714 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8405671119689941
Epoch: 32, Steps: 12 | Train Loss: 0.276 Vali Loss: 2.735 Vali Acc: 0.739 Test Loss: 2.735 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7627689838409424
Epoch: 33, Steps: 12 | Train Loss: 0.074 Vali Loss: 3.212 Vali Acc: 0.728 Test Loss: 3.212 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9715254306793213
Epoch: 34, Steps: 12 | Train Loss: 0.168 Vali Loss: 3.254 Vali Acc: 0.750 Test Loss: 3.254 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.981266736984253
Epoch: 35, Steps: 12 | Train Loss: 0.145 Vali Loss: 2.368 Vali Acc: 0.761 Test Loss: 2.368 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.035634756088257
Epoch: 36, Steps: 12 | Train Loss: 0.180 Vali Loss: 2.454 Vali Acc: 0.750 Test Loss: 2.454 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 43961871
model size : 182.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.8419933319091797
Epoch: 1, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.582 Vali Acc: 0.233 Test Loss: 2.582 Test Acc: 0.233
Validation loss decreased (inf --> -0.233308).  Saving model ...
Epoch: 2 cost time: 2.228374481201172
Epoch: 2, Steps: 12 | Train Loss: 2.482 Vali Loss: 2.275 Vali Acc: 0.428 Test Loss: 2.275 Test Acc: 0.428
Validation loss decreased (-0.233308 --> -0.427755).  Saving model ...
Epoch: 3 cost time: 2.114870548248291
Epoch: 3, Steps: 12 | Train Loss: 2.090 Vali Loss: 1.922 Vali Acc: 0.489 Test Loss: 1.922 Test Acc: 0.489
Validation loss decreased (-0.427755 --> -0.488870).  Saving model ...
Epoch: 4 cost time: 1.5068073272705078
Epoch: 4, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.568 Vali Acc: 0.528 Test Loss: 1.568 Test Acc: 0.528
Validation loss decreased (-0.488870 --> -0.527762).  Saving model ...
Epoch: 5 cost time: 1.7780823707580566
Epoch: 5, Steps: 12 | Train Loss: 1.280 Vali Loss: 1.288 Vali Acc: 0.589 Test Loss: 1.288 Test Acc: 0.589
Validation loss decreased (-0.527762 --> -0.588876).  Saving model ...
Epoch: 6 cost time: 1.7987959384918213
Epoch: 6, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.058 Vali Acc: 0.628 Test Loss: 1.058 Test Acc: 0.628
Validation loss decreased (-0.588876 --> -0.627767).  Saving model ...
Epoch: 7 cost time: 2.246644973754883
Epoch: 7, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.106 Vali Acc: 0.617 Test Loss: 1.106 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8217904567718506
Epoch: 8, Steps: 12 | Train Loss: 0.795 Vali Loss: 1.083 Vali Acc: 0.711 Test Loss: 1.083 Test Acc: 0.711
Validation loss decreased (-0.627767 --> -0.711100).  Saving model ...
Epoch: 9 cost time: 2.334075689315796
Epoch: 9, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.991 Vali Acc: 0.711 Test Loss: 0.991 Test Acc: 0.711
Validation loss decreased (-0.711100 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 1.4928677082061768
Epoch: 10, Steps: 12 | Train Loss: 0.516 Vali Loss: 0.888 Vali Acc: 0.728 Test Loss: 0.888 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727769).  Saving model ...
Epoch: 11 cost time: 2.0015716552734375
Epoch: 11, Steps: 12 | Train Loss: 0.370 Vali Loss: 1.026 Vali Acc: 0.711 Test Loss: 1.026 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.094876766204834
Epoch: 12, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.942 Vali Acc: 0.722 Test Loss: 0.942 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.415341854095459
Epoch: 13, Steps: 12 | Train Loss: 0.333 Vali Loss: 1.080 Vali Acc: 0.722 Test Loss: 1.080 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.138960838317871
Epoch: 14, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.991 Vali Acc: 0.733 Test Loss: 0.991 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733323).  Saving model ...
Epoch: 15 cost time: 2.1366710662841797
Epoch: 15, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 1.966933012008667
Epoch: 16, Steps: 12 | Train Loss: 0.282 Vali Loss: 1.139 Vali Acc: 0.706 Test Loss: 1.139 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4174251556396484
Epoch: 17, Steps: 12 | Train Loss: 0.496 Vali Loss: 1.199 Vali Acc: 0.750 Test Loss: 1.199 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1867051124572754
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 1.511 Vali Acc: 0.739 Test Loss: 1.511 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.102959632873535
Epoch: 19, Steps: 12 | Train Loss: 0.309 Vali Loss: 1.475 Vali Acc: 0.733 Test Loss: 1.475 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.222993850708008
Epoch: 20, Steps: 12 | Train Loss: 0.295 Vali Loss: 1.270 Vali Acc: 0.722 Test Loss: 1.270 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.888702154159546
Epoch: 21, Steps: 12 | Train Loss: 0.217 Vali Loss: 1.597 Vali Acc: 0.728 Test Loss: 1.597 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4330878257751465
Epoch: 22, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.158 Vali Acc: 0.744 Test Loss: 1.158 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.630805253982544
Epoch: 23, Steps: 12 | Train Loss: 0.263 Vali Loss: 1.335 Vali Acc: 0.767 Test Loss: 1.335 Test Acc: 0.767
Validation loss decreased (-0.749991 --> -0.766653).  Saving model ...
Epoch: 24 cost time: 1.8994712829589844
Epoch: 24, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.613 Vali Acc: 0.728 Test Loss: 1.613 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2757303714752197
Epoch: 25, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.321 Vali Acc: 0.761 Test Loss: 1.321 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.111675262451172
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.678 Vali Acc: 0.772 Test Loss: 1.678 Test Acc: 0.772
Validation loss decreased (-0.766653 --> -0.772205).  Saving model ...
Epoch: 27 cost time: 1.9211623668670654
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.319 Vali Acc: 0.756 Test Loss: 1.319 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8089406490325928
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.488 Vali Acc: 0.794 Test Loss: 1.488 Test Acc: 0.794
Validation loss decreased (-0.772205 --> -0.794430).  Saving model ...
Epoch: 29 cost time: 1.9579651355743408
Epoch: 29, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.679 Vali Acc: 0.744 Test Loss: 1.679 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0018742084503174
Epoch: 30, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.753 Vali Acc: 0.733 Test Loss: 1.753 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9716861248016357
Epoch: 31, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.751 Vali Acc: 0.728 Test Loss: 1.751 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.221360683441162
Epoch: 32, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.655 Vali Acc: 0.783 Test Loss: 1.655 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0633597373962402
Epoch: 33, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.927 Vali Acc: 0.756 Test Loss: 1.927 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.1396353244781494
Epoch: 34, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.717 Vali Acc: 0.767 Test Loss: 1.717 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.0824384689331055
Epoch: 35, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.886 Vali Acc: 0.767 Test Loss: 1.886 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.153810977935791
Epoch: 36, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.667 Vali Acc: 0.772 Test Loss: 1.667 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.2869415283203125
Epoch: 37, Steps: 12 | Train Loss: 0.118 Vali Loss: 2.432 Vali Acc: 0.728 Test Loss: 2.432 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.090712547302246
Epoch: 38, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.877 Vali Acc: 0.778 Test Loss: 1.877 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 43687695
model size : 181.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7500765323638916
Epoch: 1, Steps: 12 | Train Loss: 2.790 Vali Loss: 2.604 Vali Acc: 0.178 Test Loss: 2.604 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 1.0633220672607422
Epoch: 2, Steps: 12 | Train Loss: 2.578 Vali Loss: 2.406 Vali Acc: 0.356 Test Loss: 2.406 Test Acc: 0.356
Validation loss decreased (-0.177752 --> -0.355531).  Saving model ...
Epoch: 3 cost time: 0.8975615501403809
Epoch: 3, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.097 Vali Acc: 0.522 Test Loss: 2.097 Test Acc: 0.522
Validation loss decreased (-0.355531 --> -0.522201).  Saving model ...
Epoch: 4 cost time: 1.0451114177703857
Epoch: 4, Steps: 12 | Train Loss: 1.947 Vali Loss: 1.729 Vali Acc: 0.583 Test Loss: 1.729 Test Acc: 0.583
Validation loss decreased (-0.522201 --> -0.583316).  Saving model ...
Epoch: 5 cost time: 1.2758724689483643
Epoch: 5, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.374 Vali Acc: 0.600 Test Loss: 1.374 Test Acc: 0.600
Validation loss decreased (-0.583316 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 1.2855660915374756
Epoch: 6, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.153 Vali Acc: 0.633 Test Loss: 1.153 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633322).  Saving model ...
Epoch: 7 cost time: 1.1861813068389893
Epoch: 7, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.005 Vali Acc: 0.617 Test Loss: 1.005 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0177698135375977
Epoch: 8, Steps: 12 | Train Loss: 0.730 Vali Loss: 1.025 Vali Acc: 0.656 Test Loss: 1.025 Test Acc: 0.656
Validation loss decreased (-0.633322 --> -0.655545).  Saving model ...
Epoch: 9 cost time: 1.2870121002197266
Epoch: 9, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.894 Vali Acc: 0.711 Test Loss: 0.894 Test Acc: 0.711
Validation loss decreased (-0.655545 --> -0.711102).  Saving model ...
Epoch: 10 cost time: 1.059525966644287
Epoch: 10, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.792 Vali Acc: 0.717 Test Loss: 0.792 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 1.3064429759979248
Epoch: 11, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.923 Vali Acc: 0.733 Test Loss: 0.923 Test Acc: 0.733
Validation loss decreased (-0.716659 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 1.3959760665893555
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.892 Vali Acc: 0.739 Test Loss: 0.892 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 1.5142574310302734
Epoch: 13, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.880 Vali Acc: 0.756 Test Loss: 0.880 Test Acc: 0.756
Validation loss decreased (-0.738880 --> -0.755547).  Saving model ...
Epoch: 14 cost time: 1.4043850898742676
Epoch: 14, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.090 Vali Acc: 0.728 Test Loss: 1.090 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3769121170043945
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 1.033 Vali Acc: 0.756 Test Loss: 1.033 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0529046058654785
Epoch: 16, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.952 Vali Acc: 0.761 Test Loss: 0.952 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761102).  Saving model ...
Epoch: 17 cost time: 1.0904977321624756
Epoch: 17, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.987 Vali Acc: 0.761 Test Loss: 0.987 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8606977462768555
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.853 Vali Acc: 0.789 Test Loss: 0.853 Test Acc: 0.789
Validation loss decreased (-0.761102 --> -0.788880).  Saving model ...
Epoch: 19 cost time: 0.9987308979034424
Epoch: 19, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.995 Vali Acc: 0.744 Test Loss: 0.995 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0246787071228027
Epoch: 20, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.960 Vali Acc: 0.806 Test Loss: 0.960 Test Acc: 0.806
Validation loss decreased (-0.788880 --> -0.805546).  Saving model ...
Epoch: 21 cost time: 1.0881221294403076
Epoch: 21, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.062 Vali Acc: 0.772 Test Loss: 1.062 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4029171466827393
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.962 Vali Acc: 0.794 Test Loss: 0.962 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3891301155090332
Epoch: 23, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.200 Vali Acc: 0.811 Test Loss: 1.200 Test Acc: 0.811
Validation loss decreased (-0.805546 --> -0.811099).  Saving model ...
Epoch: 24 cost time: 1.5130205154418945
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.106 Vali Acc: 0.772 Test Loss: 1.106 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1403627395629883
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.053 Vali Acc: 0.811 Test Loss: 1.053 Test Acc: 0.811
Validation loss decreased (-0.811099 --> -0.811101).  Saving model ...
Epoch: 26 cost time: 1.2112269401550293
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.982 Vali Acc: 0.800 Test Loss: 0.982 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0811972618103027
Epoch: 27, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.195 Vali Acc: 0.789 Test Loss: 1.195 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4250407218933105
Epoch: 28, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.204 Vali Acc: 0.744 Test Loss: 1.204 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9616730213165283
Epoch: 29, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.232 Vali Acc: 0.789 Test Loss: 1.232 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6003649234771729
Epoch: 30, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.268 Vali Acc: 0.789 Test Loss: 1.268 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3416290283203125
Epoch: 31, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.181 Vali Acc: 0.822 Test Loss: 1.181 Test Acc: 0.822
Validation loss decreased (-0.811101 --> -0.822210).  Saving model ...
Epoch: 32 cost time: 1.52561354637146
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.294 Vali Acc: 0.783 Test Loss: 1.294 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5652086734771729
Epoch: 33, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.174 Vali Acc: 0.811 Test Loss: 1.174 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.019484043121338
Epoch: 34, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.174 Vali Acc: 0.800 Test Loss: 1.174 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.577535629272461
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.275 Vali Acc: 0.811 Test Loss: 1.275 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.711155652999878
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.205 Vali Acc: 0.806 Test Loss: 1.205 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3761956691741943
Epoch: 37, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.241 Vali Acc: 0.844 Test Loss: 1.241 Test Acc: 0.844
Validation loss decreased (-0.822210 --> -0.844432).  Saving model ...
Epoch: 38 cost time: 1.406722068786621
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.268 Vali Acc: 0.817 Test Loss: 1.268 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5775845050811768
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.279 Vali Acc: 0.811 Test Loss: 1.279 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3901035785675049
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.305 Vali Acc: 0.806 Test Loss: 1.305 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.590458631515503
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.301 Vali Acc: 0.811 Test Loss: 1.301 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.8734734058380127
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.296 Vali Acc: 0.811 Test Loss: 1.296 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.424867868423462
Epoch: 43, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.279 Vali Acc: 0.817 Test Loss: 1.279 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.6653969287872314
Epoch: 44, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.224 Vali Acc: 0.828 Test Loss: 1.224 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4874870777130127
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.378 Vali Acc: 0.828 Test Loss: 1.378 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4322447776794434
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.232 Vali Acc: 0.833 Test Loss: 1.232 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.3977878093719482
Epoch: 47, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.305 Vali Acc: 0.839 Test Loss: 1.305 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 43596303
model size : 180.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.428255558013916
Epoch: 1, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.499 Vali Acc: 0.267 Test Loss: 2.499 Test Acc: 0.267
Validation loss decreased (inf --> -0.266642).  Saving model ...
Epoch: 2 cost time: 2.275541305541992
Epoch: 2, Steps: 12 | Train Loss: 2.316 Vali Loss: 1.937 Vali Acc: 0.478 Test Loss: 1.937 Test Acc: 0.478
Validation loss decreased (-0.266642 --> -0.477758).  Saving model ...
Epoch: 3 cost time: 2.059987783432007
Epoch: 3, Steps: 12 | Train Loss: 1.729 Vali Loss: 1.547 Vali Acc: 0.533 Test Loss: 1.547 Test Acc: 0.533
Validation loss decreased (-0.477758 --> -0.533318).  Saving model ...
Epoch: 4 cost time: 1.7133045196533203
Epoch: 4, Steps: 12 | Train Loss: 1.308 Vali Loss: 1.274 Vali Acc: 0.550 Test Loss: 1.274 Test Acc: 0.550
Validation loss decreased (-0.533318 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 2.0946435928344727
Epoch: 5, Steps: 12 | Train Loss: 1.047 Vali Loss: 1.279 Vali Acc: 0.550 Test Loss: 1.279 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.226240396499634
Epoch: 6, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.345 Vali Acc: 0.611 Test Loss: 1.345 Test Acc: 0.611
Validation loss decreased (-0.549987 --> -0.611098).  Saving model ...
Epoch: 7 cost time: 2.21128511428833
Epoch: 7, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.096 Vali Acc: 0.661 Test Loss: 1.096 Test Acc: 0.661
Validation loss decreased (-0.611098 --> -0.661100).  Saving model ...
Epoch: 8 cost time: 2.33791446685791
Epoch: 8, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.200 Vali Acc: 0.644 Test Loss: 1.200 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2294535636901855
Epoch: 9, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.200 Vali Acc: 0.678 Test Loss: 1.200 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677766).  Saving model ...
Epoch: 10 cost time: 2.468672513961792
Epoch: 10, Steps: 12 | Train Loss: 0.571 Vali Loss: 1.231 Vali Acc: 0.706 Test Loss: 1.231 Test Acc: 0.706
Validation loss decreased (-0.677766 --> -0.705543).  Saving model ...
Epoch: 11 cost time: 2.4180748462677
Epoch: 11, Steps: 12 | Train Loss: 0.423 Vali Loss: 1.202 Vali Acc: 0.700 Test Loss: 1.202 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6367502212524414
Epoch: 12, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.496 Vali Acc: 0.672 Test Loss: 1.496 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3712046146392822
Epoch: 13, Steps: 12 | Train Loss: 0.542 Vali Loss: 1.772 Vali Acc: 0.644 Test Loss: 1.772 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3478000164031982
Epoch: 14, Steps: 12 | Train Loss: 0.556 Vali Loss: 1.898 Vali Acc: 0.678 Test Loss: 1.898 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4467763900756836
Epoch: 15, Steps: 12 | Train Loss: 0.409 Vali Loss: 1.588 Vali Acc: 0.711 Test Loss: 1.588 Test Acc: 0.711
Validation loss decreased (-0.705543 --> -0.711095).  Saving model ...
Epoch: 16 cost time: 2.4788618087768555
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 1.517 Vali Acc: 0.717 Test Loss: 1.517 Test Acc: 0.717
Validation loss decreased (-0.711095 --> -0.716652).  Saving model ...
Epoch: 17 cost time: 2.1538710594177246
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 1.885 Vali Acc: 0.700 Test Loss: 1.885 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.183309316635132
Epoch: 18, Steps: 12 | Train Loss: 0.276 Vali Loss: 1.851 Vali Acc: 0.700 Test Loss: 1.851 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1984264850616455
Epoch: 19, Steps: 12 | Train Loss: 0.380 Vali Loss: 1.927 Vali Acc: 0.694 Test Loss: 1.927 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.316542148590088
Epoch: 20, Steps: 12 | Train Loss: 0.417 Vali Loss: 2.024 Vali Acc: 0.717 Test Loss: 2.024 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.297506093978882
Epoch: 21, Steps: 12 | Train Loss: 0.524 Vali Loss: 2.327 Vali Acc: 0.711 Test Loss: 2.327 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1123697757720947
Epoch: 22, Steps: 12 | Train Loss: 0.362 Vali Loss: 1.723 Vali Acc: 0.744 Test Loss: 1.723 Test Acc: 0.744
Validation loss decreased (-0.716652 --> -0.744427).  Saving model ...
Epoch: 23 cost time: 2.394901990890503
Epoch: 23, Steps: 12 | Train Loss: 0.283 Vali Loss: 1.763 Vali Acc: 0.717 Test Loss: 1.763 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1817290782928467
Epoch: 24, Steps: 12 | Train Loss: 0.335 Vali Loss: 2.268 Vali Acc: 0.717 Test Loss: 2.268 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1236746311187744
Epoch: 25, Steps: 12 | Train Loss: 0.273 Vali Loss: 1.860 Vali Acc: 0.744 Test Loss: 1.860 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.901885986328125
Epoch: 26, Steps: 12 | Train Loss: 0.387 Vali Loss: 2.110 Vali Acc: 0.739 Test Loss: 2.110 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.785999059677124
Epoch: 27, Steps: 12 | Train Loss: 0.194 Vali Loss: 2.339 Vali Acc: 0.717 Test Loss: 2.339 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8478069305419922
Epoch: 28, Steps: 12 | Train Loss: 0.296 Vali Loss: 2.231 Vali Acc: 0.744 Test Loss: 2.231 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.3203377723693848
Epoch: 29, Steps: 12 | Train Loss: 0.182 Vali Loss: 2.304 Vali Acc: 0.761 Test Loss: 2.304 Test Acc: 0.761
Validation loss decreased (-0.744427 --> -0.761088).  Saving model ...
Epoch: 30 cost time: 2.4411261081695557
Epoch: 30, Steps: 12 | Train Loss: 0.289 Vali Loss: 2.547 Vali Acc: 0.756 Test Loss: 2.547 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7124660015106201
Epoch: 31, Steps: 12 | Train Loss: 0.178 Vali Loss: 2.829 Vali Acc: 0.722 Test Loss: 2.829 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1077630519866943
Epoch: 32, Steps: 12 | Train Loss: 0.560 Vali Loss: 2.846 Vali Acc: 0.717 Test Loss: 2.846 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9819185733795166
Epoch: 33, Steps: 12 | Train Loss: 0.361 Vali Loss: 2.692 Vali Acc: 0.750 Test Loss: 2.692 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.716012954711914
Epoch: 34, Steps: 12 | Train Loss: 0.181 Vali Loss: 3.066 Vali Acc: 0.722 Test Loss: 3.066 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.758639097213745
Epoch: 35, Steps: 12 | Train Loss: 0.391 Vali Loss: 3.402 Vali Acc: 0.661 Test Loss: 3.402 Test Acc: 0.661
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.3376612663269043
Epoch: 36, Steps: 12 | Train Loss: 0.164 Vali Loss: 2.856 Vali Acc: 0.689 Test Loss: 2.856 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.8682076930999756
Epoch: 37, Steps: 12 | Train Loss: 0.112 Vali Loss: 3.097 Vali Acc: 0.700 Test Loss: 3.097 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.0250494480133057
Epoch: 38, Steps: 12 | Train Loss: 0.189 Vali Loss: 3.177 Vali Acc: 0.672 Test Loss: 3.177 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.537767171859741
Epoch: 39, Steps: 12 | Train Loss: 0.334 Vali Loss: 2.805 Vali Acc: 0.728 Test Loss: 2.805 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 43953423
model size : 182.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 4.273674964904785
Epoch: 1, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.610 Vali Acc: 0.194 Test Loss: 2.610 Test Acc: 0.194
Validation loss decreased (inf --> -0.194418).  Saving model ...
Epoch: 2 cost time: 2.477250576019287
Epoch: 2, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.282 Vali Acc: 0.383 Test Loss: 2.282 Test Acc: 0.383
Validation loss decreased (-0.194418 --> -0.383311).  Saving model ...
Epoch: 3 cost time: 2.420384407043457
Epoch: 3, Steps: 12 | Train Loss: 2.045 Vali Loss: 1.835 Vali Acc: 0.511 Test Loss: 1.835 Test Acc: 0.511
Validation loss decreased (-0.383311 --> -0.511093).  Saving model ...
Epoch: 4 cost time: 2.3695740699768066
Epoch: 4, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.459 Vali Acc: 0.539 Test Loss: 1.459 Test Acc: 0.539
Validation loss decreased (-0.511093 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 2.1895015239715576
Epoch: 5, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.212 Vali Acc: 0.567 Test Loss: 1.212 Test Acc: 0.567
Validation loss decreased (-0.538874 --> -0.566655).  Saving model ...
Epoch: 6 cost time: 2.4409406185150146
Epoch: 6, Steps: 12 | Train Loss: 0.978 Vali Loss: 1.113 Vali Acc: 0.594 Test Loss: 1.113 Test Acc: 0.594
Validation loss decreased (-0.566655 --> -0.594433).  Saving model ...
Epoch: 7 cost time: 2.435516595840454
Epoch: 7, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.979 Vali Acc: 0.672 Test Loss: 0.979 Test Acc: 0.672
Validation loss decreased (-0.594433 --> -0.672212).  Saving model ...
Epoch: 8 cost time: 2.060626745223999
Epoch: 8, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.059 Vali Acc: 0.639 Test Loss: 1.059 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.267306089401245
Epoch: 9, Steps: 12 | Train Loss: 0.657 Vali Loss: 1.140 Vali Acc: 0.633 Test Loss: 1.140 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1033437252044678
Epoch: 10, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.052 Vali Acc: 0.672 Test Loss: 1.052 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6322622299194336
Epoch: 11, Steps: 12 | Train Loss: 0.523 Vali Loss: 1.053 Vali Acc: 0.661 Test Loss: 1.053 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4579339027404785
Epoch: 12, Steps: 12 | Train Loss: 0.536 Vali Loss: 1.065 Vali Acc: 0.706 Test Loss: 1.065 Test Acc: 0.706
Validation loss decreased (-0.672212 --> -0.705545).  Saving model ...
Epoch: 13 cost time: 1.3094985485076904
Epoch: 13, Steps: 12 | Train Loss: 0.387 Vali Loss: 1.110 Vali Acc: 0.722 Test Loss: 1.110 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722211).  Saving model ...
Epoch: 14 cost time: 1.923354148864746
Epoch: 14, Steps: 12 | Train Loss: 0.401 Vali Loss: 1.247 Vali Acc: 0.672 Test Loss: 1.247 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5486564636230469
Epoch: 15, Steps: 12 | Train Loss: 0.364 Vali Loss: 1.353 Vali Acc: 0.711 Test Loss: 1.353 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8960649967193604
Epoch: 16, Steps: 12 | Train Loss: 0.472 Vali Loss: 1.520 Vali Acc: 0.689 Test Loss: 1.520 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9321653842926025
Epoch: 17, Steps: 12 | Train Loss: 0.396 Vali Loss: 1.290 Vali Acc: 0.722 Test Loss: 1.290 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.035515069961548
Epoch: 18, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.415 Vali Acc: 0.700 Test Loss: 1.415 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4746501445770264
Epoch: 19, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.215 Vali Acc: 0.717 Test Loss: 1.215 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6620783805847168
Epoch: 20, Steps: 12 | Train Loss: 0.302 Vali Loss: 1.503 Vali Acc: 0.706 Test Loss: 1.503 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9467601776123047
Epoch: 21, Steps: 12 | Train Loss: 0.420 Vali Loss: 1.494 Vali Acc: 0.711 Test Loss: 1.494 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0332422256469727
Epoch: 22, Steps: 12 | Train Loss: 0.182 Vali Loss: 1.285 Vali Acc: 0.706 Test Loss: 1.285 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9192907810211182
Epoch: 23, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.407 Vali Acc: 0.722 Test Loss: 1.407 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7222222222222222
model parameter : 43679247
model size : 181.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.212303638458252
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.671 Vali Acc: 0.156 Test Loss: 2.671 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 1.5748257637023926
Epoch: 2, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.409 Vali Acc: 0.394 Test Loss: 2.409 Test Acc: 0.394
Validation loss decreased (-0.155529 --> -0.394420).  Saving model ...
Epoch: 3 cost time: 1.5249977111816406
Epoch: 3, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.145 Vali Acc: 0.483 Test Loss: 2.145 Test Acc: 0.483
Validation loss decreased (-0.394420 --> -0.483312).  Saving model ...
Epoch: 4 cost time: 1.5137276649475098
Epoch: 4, Steps: 12 | Train Loss: 2.001 Vali Loss: 1.799 Vali Acc: 0.550 Test Loss: 1.799 Test Acc: 0.550
Validation loss decreased (-0.483312 --> -0.549982).  Saving model ...
Epoch: 5 cost time: 1.5741043090820312
Epoch: 5, Steps: 12 | Train Loss: 1.536 Vali Loss: 1.370 Vali Acc: 0.578 Test Loss: 1.370 Test Acc: 0.578
Validation loss decreased (-0.549982 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 1.5672965049743652
Epoch: 6, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.137 Vali Acc: 0.611 Test Loss: 1.137 Test Acc: 0.611
Validation loss decreased (-0.577764 --> -0.611100).  Saving model ...
Epoch: 7 cost time: 1.6405599117279053
Epoch: 7, Steps: 12 | Train Loss: 1.034 Vali Loss: 0.982 Vali Acc: 0.639 Test Loss: 0.982 Test Acc: 0.639
Validation loss decreased (-0.611100 --> -0.638879).  Saving model ...
Epoch: 8 cost time: 1.482316493988037
Epoch: 8, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.922 Vali Acc: 0.622 Test Loss: 0.922 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3216040134429932
Epoch: 9, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.791 Vali Acc: 0.706 Test Loss: 0.791 Test Acc: 0.706
Validation loss decreased (-0.638879 --> -0.705548).  Saving model ...
Epoch: 10 cost time: 1.06093168258667
Epoch: 10, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716659).  Saving model ...
Epoch: 11 cost time: 0.964881181716919
Epoch: 11, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.682 Vali Acc: 0.728 Test Loss: 0.682 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727771).  Saving model ...
Epoch: 12 cost time: 0.9828238487243652
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761104).  Saving model ...
Epoch: 13 cost time: 1.3610942363739014
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.870 Vali Acc: 0.717 Test Loss: 0.870 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9151613712310791
Epoch: 14, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.688 Vali Acc: 0.767 Test Loss: 0.688 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 0.9039976596832275
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.785 Vali Acc: 0.733 Test Loss: 0.785 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2363498210906982
Epoch: 16, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 1.287487506866455
Epoch: 17, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2720680236816406
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.930 Vali Acc: 0.767 Test Loss: 0.930 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.293058156967163
Epoch: 19, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.843 Vali Acc: 0.761 Test Loss: 0.843 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2753517627716064
Epoch: 20, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.050 Vali Acc: 0.767 Test Loss: 1.050 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.342038631439209
Epoch: 21, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.906 Vali Acc: 0.789 Test Loss: 0.906 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.436070203781128
Epoch: 22, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.979 Vali Acc: 0.783 Test Loss: 0.979 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3584935665130615
Epoch: 23, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.841 Vali Acc: 0.822 Test Loss: 0.841 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822214).  Saving model ...
Epoch: 24 cost time: 1.3019006252288818
Epoch: 24, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.990 Vali Acc: 0.789 Test Loss: 0.990 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5431854724884033
Epoch: 25, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.066 Vali Acc: 0.783 Test Loss: 1.066 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2822318077087402
Epoch: 26, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.970 Vali Acc: 0.794 Test Loss: 0.970 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5259692668914795
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.973 Vali Acc: 0.806 Test Loss: 0.973 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1991300582885742
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.977 Vali Acc: 0.817 Test Loss: 0.977 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5473222732543945
Epoch: 29, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.059 Vali Acc: 0.817 Test Loss: 1.059 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2569410800933838
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.974 Vali Acc: 0.800 Test Loss: 0.974 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5235342979431152
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.113 Vali Acc: 0.811 Test Loss: 1.113 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5654683113098145
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.067 Vali Acc: 0.806 Test Loss: 1.067 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6626579761505127
Epoch: 33, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.156 Vali Acc: 0.822 Test Loss: 1.156 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 43548687
model size : 180.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.6332833766937256
Epoch: 1, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.629 Vali Acc: 0.128 Test Loss: 2.629 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 2.082519292831421
Epoch: 2, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.320 Vali Acc: 0.417 Test Loss: 2.320 Test Acc: 0.417
Validation loss decreased (-0.127751 --> -0.416643).  Saving model ...
Epoch: 3 cost time: 2.12426495552063
Epoch: 3, Steps: 12 | Train Loss: 2.121 Vali Loss: 1.948 Vali Acc: 0.506 Test Loss: 1.948 Test Acc: 0.506
Validation loss decreased (-0.416643 --> -0.505536).  Saving model ...
Epoch: 4 cost time: 1.6443860530853271
Epoch: 4, Steps: 12 | Train Loss: 1.709 Vali Loss: 1.620 Vali Acc: 0.539 Test Loss: 1.620 Test Acc: 0.539
Validation loss decreased (-0.505536 --> -0.538873).  Saving model ...
Epoch: 5 cost time: 0.9303238391876221
Epoch: 5, Steps: 12 | Train Loss: 1.330 Vali Loss: 1.359 Vali Acc: 0.572 Test Loss: 1.359 Test Acc: 0.572
Validation loss decreased (-0.538873 --> -0.572209).  Saving model ...
Epoch: 6 cost time: 1.4769353866577148
Epoch: 6, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.370 Vali Acc: 0.561 Test Loss: 1.370 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5910868644714355
Epoch: 7, Steps: 12 | Train Loss: 0.835 Vali Loss: 1.169 Vali Acc: 0.622 Test Loss: 1.169 Test Acc: 0.622
Validation loss decreased (-0.572209 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 1.9144799709320068
Epoch: 8, Steps: 12 | Train Loss: 0.771 Vali Loss: 1.234 Vali Acc: 0.639 Test Loss: 1.234 Test Acc: 0.639
Validation loss decreased (-0.622211 --> -0.638877).  Saving model ...
Epoch: 9 cost time: 1.720982551574707
Epoch: 9, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.031 Vali Acc: 0.700 Test Loss: 1.031 Test Acc: 0.700
Validation loss decreased (-0.638877 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 1.792567253112793
Epoch: 10, Steps: 12 | Train Loss: 0.512 Vali Loss: 1.160 Vali Acc: 0.639 Test Loss: 1.160 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7049036026000977
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 1.009 Vali Acc: 0.689 Test Loss: 1.009 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.871049404144287
Epoch: 12, Steps: 12 | Train Loss: 0.450 Vali Loss: 1.199 Vali Acc: 0.667 Test Loss: 1.199 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.77138352394104
Epoch: 13, Steps: 12 | Train Loss: 0.401 Vali Loss: 1.167 Vali Acc: 0.678 Test Loss: 1.167 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6807479858398438
Epoch: 14, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.069 Vali Acc: 0.706 Test Loss: 1.069 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705545).  Saving model ...
Epoch: 15 cost time: 1.5493566989898682
Epoch: 15, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.237 Vali Acc: 0.728 Test Loss: 1.237 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727765).  Saving model ...
Epoch: 16 cost time: 1.9944379329681396
Epoch: 16, Steps: 12 | Train Loss: 0.208 Vali Loss: 1.215 Vali Acc: 0.711 Test Loss: 1.215 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5568864345550537
Epoch: 17, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.440 Vali Acc: 0.722 Test Loss: 1.440 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8535311222076416
Epoch: 18, Steps: 12 | Train Loss: 0.261 Vali Loss: 1.629 Vali Acc: 0.672 Test Loss: 1.629 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.798685073852539
Epoch: 19, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.329 Vali Acc: 0.744 Test Loss: 1.329 Test Acc: 0.744
Validation loss decreased (-0.727765 --> -0.744431).  Saving model ...
Epoch: 20 cost time: 2.0492708683013916
Epoch: 20, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.357 Vali Acc: 0.744 Test Loss: 1.357 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6501944065093994
Epoch: 21, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.690 Vali Acc: 0.706 Test Loss: 1.690 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3217816352844238
Epoch: 22, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.612 Vali Acc: 0.744 Test Loss: 1.612 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0120787620544434
Epoch: 23, Steps: 12 | Train Loss: 0.275 Vali Loss: 1.624 Vali Acc: 0.728 Test Loss: 1.624 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6794674396514893
Epoch: 24, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.459 Vali Acc: 0.744 Test Loss: 1.459 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.380519151687622
Epoch: 25, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.523 Vali Acc: 0.728 Test Loss: 1.523 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1037278175354004
Epoch: 26, Steps: 12 | Train Loss: 0.189 Vali Loss: 1.750 Vali Acc: 0.733 Test Loss: 1.750 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.355168342590332
Epoch: 27, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.638 Vali Acc: 0.722 Test Loss: 1.638 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.016345500946045
Epoch: 28, Steps: 12 | Train Loss: 0.191 Vali Loss: 2.035 Vali Acc: 0.711 Test Loss: 2.035 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6894259452819824
Epoch: 29, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.588 Vali Acc: 0.756 Test Loss: 1.588 Test Acc: 0.756
Validation loss decreased (-0.744431 --> -0.755540).  Saving model ...
Epoch: 30 cost time: 2.169403553009033
Epoch: 30, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.593 Vali Acc: 0.750 Test Loss: 1.593 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.215017318725586
Epoch: 31, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.792 Vali Acc: 0.756 Test Loss: 1.792 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8768317699432373
Epoch: 32, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.735 Vali Acc: 0.756 Test Loss: 1.735 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6500802040100098
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.662 Vali Acc: 0.767 Test Loss: 1.662 Test Acc: 0.767
Validation loss decreased (-0.755540 --> -0.766650).  Saving model ...
Epoch: 34 cost time: 1.3916044235229492
Epoch: 34, Steps: 12 | Train Loss: 0.074 Vali Loss: 2.042 Vali Acc: 0.728 Test Loss: 2.042 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4092669486999512
Epoch: 35, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.803 Vali Acc: 0.778 Test Loss: 1.803 Test Acc: 0.778
Validation loss decreased (-0.766650 --> -0.777760).  Saving model ...
Epoch: 36 cost time: 1.8259546756744385
Epoch: 36, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.843 Vali Acc: 0.739 Test Loss: 1.843 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3544979095458984
Epoch: 37, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.960 Vali Acc: 0.756 Test Loss: 1.960 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6821036338806152
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.630 Vali Acc: 0.783 Test Loss: 1.630 Test Acc: 0.783
Validation loss decreased (-0.777760 --> -0.783317).  Saving model ...
Epoch: 39 cost time: 1.2474615573883057
Epoch: 39, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.920 Vali Acc: 0.722 Test Loss: 1.920 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4023375511169434
Epoch: 40, Steps: 12 | Train Loss: 0.076 Vali Loss: 2.366 Vali Acc: 0.706 Test Loss: 2.366 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1951963901519775
Epoch: 41, Steps: 12 | Train Loss: 0.055 Vali Loss: 2.063 Vali Acc: 0.750 Test Loss: 2.063 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3361904621124268
Epoch: 42, Steps: 12 | Train Loss: 0.034 Vali Loss: 2.338 Vali Acc: 0.722 Test Loss: 2.338 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.3848459720611572
Epoch: 43, Steps: 12 | Train Loss: 0.106 Vali Loss: 2.103 Vali Acc: 0.772 Test Loss: 2.103 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.3200342655181885
Epoch: 44, Steps: 12 | Train Loss: 0.090 Vali Loss: 2.320 Vali Acc: 0.756 Test Loss: 2.320 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4598453044891357
Epoch: 45, Steps: 12 | Train Loss: 0.016 Vali Loss: 2.235 Vali Acc: 0.761 Test Loss: 2.235 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.362361192703247
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 2.186 Vali Acc: 0.744 Test Loss: 2.186 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2008779048919678
Epoch: 47, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.955 Vali Acc: 0.783 Test Loss: 1.955 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1337013244628906
Epoch: 48, Steps: 12 | Train Loss: 0.052 Vali Loss: 2.169 Vali Acc: 0.756 Test Loss: 2.169 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 43683855
model size : 181.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8347833156585693
Epoch: 1, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.613 Vali Acc: 0.089 Test Loss: 2.613 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 1.3555285930633545
Epoch: 2, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.413 Vali Acc: 0.389 Test Loss: 2.413 Test Acc: 0.389
Validation loss decreased (-0.088863 --> -0.388865).  Saving model ...
Epoch: 3 cost time: 1.3583967685699463
Epoch: 3, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.103 Vali Acc: 0.528 Test Loss: 2.103 Test Acc: 0.528
Validation loss decreased (-0.388865 --> -0.527757).  Saving model ...
Epoch: 4 cost time: 1.4238543510437012
Epoch: 4, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.766 Vali Acc: 0.550 Test Loss: 1.766 Test Acc: 0.550
Validation loss decreased (-0.527757 --> -0.549982).  Saving model ...
Epoch: 5 cost time: 1.4479506015777588
Epoch: 5, Steps: 12 | Train Loss: 1.621 Vali Loss: 1.478 Vali Acc: 0.567 Test Loss: 1.478 Test Acc: 0.567
Validation loss decreased (-0.549982 --> -0.566652).  Saving model ...
Epoch: 6 cost time: 1.2607090473175049
Epoch: 6, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.312 Vali Acc: 0.556 Test Loss: 1.312 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3746223449707031
Epoch: 7, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.179 Vali Acc: 0.622 Test Loss: 1.179 Test Acc: 0.622
Validation loss decreased (-0.566652 --> -0.622210).  Saving model ...
Epoch: 8 cost time: 1.3997306823730469
Epoch: 8, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.181 Vali Acc: 0.622 Test Loss: 1.181 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9696109294891357
Epoch: 9, Steps: 12 | Train Loss: 0.715 Vali Loss: 1.137 Vali Acc: 0.639 Test Loss: 1.137 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638878).  Saving model ...
Epoch: 10 cost time: 1.2063472270965576
Epoch: 10, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.109 Vali Acc: 0.661 Test Loss: 1.109 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661100).  Saving model ...
Epoch: 11 cost time: 1.2469375133514404
Epoch: 11, Steps: 12 | Train Loss: 0.498 Vali Loss: 1.125 Vali Acc: 0.667 Test Loss: 1.125 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 1.1322922706604004
Epoch: 12, Steps: 12 | Train Loss: 0.375 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 1.190216302871704
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.919 Vali Acc: 0.733 Test Loss: 0.919 Test Acc: 0.733
Validation loss decreased (-0.666656 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.9266607761383057
Epoch: 14, Steps: 12 | Train Loss: 0.265 Vali Loss: 1.030 Vali Acc: 0.739 Test Loss: 1.030 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.7294313907623291
Epoch: 15, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.942 Vali Acc: 0.739 Test Loss: 0.942 Test Acc: 0.739
Validation loss decreased (-0.738879 --> -0.738879).  Saving model ...
Epoch: 16 cost time: 1.0115399360656738
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.201 Vali Acc: 0.711 Test Loss: 1.201 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0236263275146484
Epoch: 17, Steps: 12 | Train Loss: 0.257 Vali Loss: 1.178 Vali Acc: 0.706 Test Loss: 1.178 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1654458045959473
Epoch: 18, Steps: 12 | Train Loss: 0.186 Vali Loss: 1.078 Vali Acc: 0.761 Test Loss: 1.078 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761100).  Saving model ...
Epoch: 19 cost time: 1.4323205947875977
Epoch: 19, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.069 Vali Acc: 0.761 Test Loss: 1.069 Test Acc: 0.761
Validation loss decreased (-0.761100 --> -0.761100).  Saving model ...
Epoch: 20 cost time: 1.2619853019714355
Epoch: 20, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.055 Vali Acc: 0.767 Test Loss: 1.055 Test Acc: 0.767
Validation loss decreased (-0.761100 --> -0.766656).  Saving model ...
Epoch: 21 cost time: 1.3762671947479248
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.163 Vali Acc: 0.733 Test Loss: 1.163 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0917487144470215
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.223 Vali Acc: 0.772 Test Loss: 1.223 Test Acc: 0.772
Validation loss decreased (-0.766656 --> -0.772210).  Saving model ...
Epoch: 23 cost time: 1.577831506729126
Epoch: 23, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.395 Vali Acc: 0.700 Test Loss: 1.395 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2699263095855713
Epoch: 24, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.196 Vali Acc: 0.761 Test Loss: 1.196 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4595911502838135
Epoch: 25, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.175 Vali Acc: 0.750 Test Loss: 1.175 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5128331184387207
Epoch: 26, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.287 Vali Acc: 0.744 Test Loss: 1.287 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3018720149993896
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.218 Vali Acc: 0.778 Test Loss: 1.218 Test Acc: 0.778
Validation loss decreased (-0.772210 --> -0.777766).  Saving model ...
Epoch: 28 cost time: 1.377906322479248
Epoch: 28, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.508 Vali Acc: 0.739 Test Loss: 1.508 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5352916717529297
Epoch: 29, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.251 Vali Acc: 0.767 Test Loss: 1.251 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3906128406524658
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 1.485 Vali Acc: 0.722 Test Loss: 1.485 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3686676025390625
Epoch: 31, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.342 Vali Acc: 0.767 Test Loss: 1.342 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.120802640914917
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.357 Vali Acc: 0.750 Test Loss: 1.357 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9019532203674316
Epoch: 33, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.419 Vali Acc: 0.750 Test Loss: 1.419 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1151785850524902
Epoch: 34, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.495 Vali Acc: 0.783 Test Loss: 1.495 Test Acc: 0.783
Validation loss decreased (-0.777766 --> -0.783318).  Saving model ...
Epoch: 35 cost time: 1.3367745876312256
Epoch: 35, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.709 Vali Acc: 0.739 Test Loss: 1.709 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2623653411865234
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.455 Vali Acc: 0.783 Test Loss: 1.455 Test Acc: 0.783
Validation loss decreased (-0.783318 --> -0.783319).  Saving model ...
Epoch: 37 cost time: 0.9733691215515137
Epoch: 37, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.634 Vali Acc: 0.750 Test Loss: 1.634 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.969141960144043
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.407 Vali Acc: 0.800 Test Loss: 1.407 Test Acc: 0.800
Validation loss decreased (-0.783319 --> -0.799986).  Saving model ...
Epoch: 39 cost time: 1.284731388092041
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.481 Vali Acc: 0.778 Test Loss: 1.481 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2746620178222656
Epoch: 40, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.565 Vali Acc: 0.761 Test Loss: 1.565 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3728554248809814
Epoch: 41, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.385 Vali Acc: 0.772 Test Loss: 1.385 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4149413108825684
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.459 Vali Acc: 0.806 Test Loss: 1.459 Test Acc: 0.806
Validation loss decreased (-0.799986 --> -0.805541).  Saving model ...
Epoch: 43 cost time: 1.3873889446258545
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.520 Vali Acc: 0.778 Test Loss: 1.520 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5029406547546387
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.494 Vali Acc: 0.822 Test Loss: 1.494 Test Acc: 0.822
Validation loss decreased (-0.805541 --> -0.822207).  Saving model ...
Epoch: 45 cost time: 1.4249346256256104
Epoch: 45, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.533 Vali Acc: 0.794 Test Loss: 1.533 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.354712724685669
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.537 Vali Acc: 0.806 Test Loss: 1.537 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.4610695838928223
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.597 Vali Acc: 0.794 Test Loss: 1.597 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.458594560623169
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.663 Vali Acc: 0.794 Test Loss: 1.663 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.508220911026001
Epoch: 49, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.535 Vali Acc: 0.806 Test Loss: 1.535 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0495946407318115
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.475 Vali Acc: 0.800 Test Loss: 1.475 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 43592463
model size : 180.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3884921073913574
Epoch: 1, Steps: 12 | Train Loss: 2.719 Vali Loss: 2.625 Vali Acc: 0.106 Test Loss: 2.625 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.2247912883758545
Epoch: 2, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.449 Vali Acc: 0.272 Test Loss: 2.449 Test Acc: 0.272
Validation loss decreased (-0.105529 --> -0.272198).  Saving model ...
Epoch: 3 cost time: 1.1071643829345703
Epoch: 3, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.241 Vali Acc: 0.444 Test Loss: 2.241 Test Acc: 0.444
Validation loss decreased (-0.272198 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 0.8295183181762695
Epoch: 4, Steps: 12 | Train Loss: 2.055 Vali Loss: 1.978 Vali Acc: 0.500 Test Loss: 1.978 Test Acc: 0.500
Validation loss decreased (-0.444422 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 0.9472737312316895
Epoch: 5, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.661 Vali Acc: 0.517 Test Loss: 1.661 Test Acc: 0.517
Validation loss decreased (-0.499980 --> -0.516650).  Saving model ...
Epoch: 6 cost time: 0.9076440334320068
Epoch: 6, Steps: 12 | Train Loss: 1.398 Vali Loss: 1.455 Vali Acc: 0.528 Test Loss: 1.455 Test Acc: 0.528
Validation loss decreased (-0.516650 --> -0.527763).  Saving model ...
Epoch: 7 cost time: 0.8766829967498779
Epoch: 7, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.237 Vali Acc: 0.583 Test Loss: 1.237 Test Acc: 0.583
Validation loss decreased (-0.527763 --> -0.583321).  Saving model ...
Epoch: 8 cost time: 0.8560726642608643
Epoch: 8, Steps: 12 | Train Loss: 0.962 Vali Loss: 1.104 Vali Acc: 0.606 Test Loss: 1.104 Test Acc: 0.606
Validation loss decreased (-0.583321 --> -0.605545).  Saving model ...
Epoch: 9 cost time: 1.103273868560791
Epoch: 9, Steps: 12 | Train Loss: 0.730 Vali Loss: 0.963 Vali Acc: 0.656 Test Loss: 0.963 Test Acc: 0.656
Validation loss decreased (-0.605545 --> -0.655546).  Saving model ...
Epoch: 10 cost time: 0.9756271839141846
Epoch: 10, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.924 Vali Acc: 0.706 Test Loss: 0.924 Test Acc: 0.706
Validation loss decreased (-0.655546 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 1.1011829376220703
Epoch: 11, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 12 cost time: 0.9595034122467041
Epoch: 12, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.902 Vali Acc: 0.722 Test Loss: 0.902 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722213).  Saving model ...
Epoch: 13 cost time: 1.1903934478759766
Epoch: 13, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.874 Vali Acc: 0.733 Test Loss: 0.874 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 1.1295762062072754
Epoch: 14, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.838 Vali Acc: 0.772 Test Loss: 0.838 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772214).  Saving model ...
Epoch: 15 cost time: 1.1833069324493408
Epoch: 15, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.844 Vali Acc: 0.789 Test Loss: 0.844 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 1.0196633338928223
Epoch: 16, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9838237762451172
Epoch: 17, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.943 Vali Acc: 0.767 Test Loss: 0.943 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9882948398590088
Epoch: 18, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.902 Vali Acc: 0.756 Test Loss: 0.902 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1048243045806885
Epoch: 19, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.056 Vali Acc: 0.744 Test Loss: 1.056 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9125552177429199
Epoch: 20, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.032 Vali Acc: 0.756 Test Loss: 1.032 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1988847255706787
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.120 Vali Acc: 0.722 Test Loss: 1.120 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0117905139923096
Epoch: 22, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.996 Vali Acc: 0.772 Test Loss: 0.996 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1723606586456299
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.937 Vali Acc: 0.800 Test Loss: 0.937 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 0.9681446552276611
Epoch: 24, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.943 Vali Acc: 0.811 Test Loss: 0.943 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811102).  Saving model ...
Epoch: 25 cost time: 1.119844675064087
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.023 Vali Acc: 0.789 Test Loss: 1.023 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0802674293518066
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.921 Vali Acc: 0.822 Test Loss: 0.921 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 27 cost time: 0.9460797309875488
Epoch: 27, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.928 Vali Acc: 0.822 Test Loss: 0.928 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9244067668914795
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.972 Vali Acc: 0.828 Test Loss: 0.972 Test Acc: 0.828
Validation loss decreased (-0.822213 --> -0.827768).  Saving model ...
Epoch: 29 cost time: 0.9960253238677979
Epoch: 29, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.999 Vali Acc: 0.789 Test Loss: 0.999 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9215779304504395
Epoch: 30, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.966 Vali Acc: 0.817 Test Loss: 0.966 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8823854923248291
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.977 Vali Acc: 0.828 Test Loss: 0.977 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9083106517791748
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.046 Vali Acc: 0.783 Test Loss: 1.046 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0296530723571777
Epoch: 33, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.103 Vali Acc: 0.817 Test Loss: 1.103 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9525015354156494
Epoch: 34, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.126 Vali Acc: 0.772 Test Loss: 1.126 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8564355373382568
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.133 Vali Acc: 0.806 Test Loss: 1.133 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8374550342559814
Epoch: 36, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.139 Vali Acc: 0.778 Test Loss: 1.139 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7209756374359131
Epoch: 37, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.114 Vali Acc: 0.806 Test Loss: 1.114 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.923344612121582
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.135 Vali Acc: 0.800 Test Loss: 1.135 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 43527183
model size : 180.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7205185890197754
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.597 Vali Acc: 0.206 Test Loss: 2.597 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 1.8163578510284424
Epoch: 2, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.307 Vali Acc: 0.417 Test Loss: 2.307 Test Acc: 0.417
Validation loss decreased (-0.205530 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 1.8443632125854492
Epoch: 3, Steps: 12 | Train Loss: 2.110 Vali Loss: 1.899 Vali Acc: 0.456 Test Loss: 1.899 Test Acc: 0.456
Validation loss decreased (-0.416644 --> -0.455537).  Saving model ...
Epoch: 4 cost time: 1.8172612190246582
Epoch: 4, Steps: 12 | Train Loss: 1.646 Vali Loss: 1.562 Vali Acc: 0.578 Test Loss: 1.562 Test Acc: 0.578
Validation loss decreased (-0.455537 --> -0.577762).  Saving model ...
Epoch: 5 cost time: 1.6970505714416504
Epoch: 5, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.288 Vali Acc: 0.606 Test Loss: 1.288 Test Acc: 0.606
Validation loss decreased (-0.577762 --> -0.605543).  Saving model ...
Epoch: 6 cost time: 1.4852831363677979
Epoch: 6, Steps: 12 | Train Loss: 1.065 Vali Loss: 1.180 Vali Acc: 0.611 Test Loss: 1.180 Test Acc: 0.611
Validation loss decreased (-0.605543 --> -0.611099).  Saving model ...
Epoch: 7 cost time: 1.5461859703063965
Epoch: 7, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.000 Vali Acc: 0.667 Test Loss: 1.000 Test Acc: 0.667
Validation loss decreased (-0.611099 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 1.820991039276123
Epoch: 8, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.972 Vali Acc: 0.672 Test Loss: 0.972 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 9 cost time: 1.7947793006896973
Epoch: 9, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.927 Vali Acc: 0.717 Test Loss: 0.927 Test Acc: 0.717
Validation loss decreased (-0.672213 --> -0.716657).  Saving model ...
Epoch: 10 cost time: 1.768944501876831
Epoch: 10, Steps: 12 | Train Loss: 0.499 Vali Loss: 1.036 Vali Acc: 0.733 Test Loss: 1.036 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 1.5339314937591553
Epoch: 11, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.929 Vali Acc: 0.744 Test Loss: 0.929 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744435).  Saving model ...
Epoch: 12 cost time: 1.1767704486846924
Epoch: 12, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.900 Vali Acc: 0.711 Test Loss: 0.900 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0865178108215332
Epoch: 13, Steps: 12 | Train Loss: 0.410 Vali Loss: 1.016 Vali Acc: 0.733 Test Loss: 1.016 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2110865116119385
Epoch: 14, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.984 Vali Acc: 0.722 Test Loss: 0.984 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9606337547302246
Epoch: 15, Steps: 12 | Train Loss: 0.427 Vali Loss: 1.179 Vali Acc: 0.722 Test Loss: 1.179 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1361541748046875
Epoch: 16, Steps: 12 | Train Loss: 0.405 Vali Loss: 1.084 Vali Acc: 0.711 Test Loss: 1.084 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.19329833984375
Epoch: 17, Steps: 12 | Train Loss: 0.355 Vali Loss: 1.109 Vali Acc: 0.728 Test Loss: 1.109 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0967433452606201
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.082 Vali Acc: 0.739 Test Loss: 1.082 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4864757061004639
Epoch: 19, Steps: 12 | Train Loss: 0.218 Vali Loss: 1.432 Vali Acc: 0.689 Test Loss: 1.432 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1064600944519043
Epoch: 20, Steps: 12 | Train Loss: 0.186 Vali Loss: 1.231 Vali Acc: 0.767 Test Loss: 1.231 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766654).  Saving model ...
Epoch: 21 cost time: 1.4157538414001465
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.247 Vali Acc: 0.744 Test Loss: 1.247 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.691425085067749
Epoch: 22, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.132 Vali Acc: 0.783 Test Loss: 1.132 Test Acc: 0.783
Validation loss decreased (-0.766654 --> -0.783322).  Saving model ...
Epoch: 23 cost time: 1.4980096817016602
Epoch: 23, Steps: 12 | Train Loss: 0.181 Vali Loss: 1.387 Vali Acc: 0.756 Test Loss: 1.387 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7009329795837402
Epoch: 24, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.214 Vali Acc: 0.761 Test Loss: 1.214 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4162302017211914
Epoch: 25, Steps: 12 | Train Loss: 0.214 Vali Loss: 1.827 Vali Acc: 0.711 Test Loss: 1.827 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4079468250274658
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.225 Vali Acc: 0.794 Test Loss: 1.225 Test Acc: 0.794
Validation loss decreased (-0.783322 --> -0.794432).  Saving model ...
Epoch: 27 cost time: 1.873046875
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.357 Vali Acc: 0.794 Test Loss: 1.357 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8517310619354248
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.422 Vali Acc: 0.778 Test Loss: 1.422 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5748062133789062
Epoch: 29, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.303 Vali Acc: 0.789 Test Loss: 1.303 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7392377853393555
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.565 Vali Acc: 0.756 Test Loss: 1.565 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6917128562927246
Epoch: 31, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.573 Vali Acc: 0.756 Test Loss: 1.573 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4298677444458008
Epoch: 32, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.802 Vali Acc: 0.728 Test Loss: 1.802 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.404578685760498
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 2.108 Vali Acc: 0.739 Test Loss: 2.108 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.605879306793213
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.806 Vali Acc: 0.728 Test Loss: 1.806 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.405792474746704
Epoch: 35, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.815 Vali Acc: 0.739 Test Loss: 1.815 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.46793794631958
Epoch: 36, Steps: 12 | Train Loss: 0.143 Vali Loss: 2.079 Vali Acc: 0.717 Test Loss: 2.079 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 43675407
model size : 181.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5018868446350098
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.645 Vali Acc: 0.150 Test Loss: 2.645 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 1.0410048961639404
Epoch: 2, Steps: 12 | Train Loss: 2.562 Vali Loss: 2.421 Vali Acc: 0.433 Test Loss: 2.421 Test Acc: 0.433
Validation loss decreased (-0.149974 --> -0.433309).  Saving model ...
Epoch: 3 cost time: 0.9107160568237305
Epoch: 3, Steps: 12 | Train Loss: 2.254 Vali Loss: 2.109 Vali Acc: 0.478 Test Loss: 2.109 Test Acc: 0.478
Validation loss decreased (-0.433309 --> -0.477757).  Saving model ...
Epoch: 4 cost time: 0.9973659515380859
Epoch: 4, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.733 Vali Acc: 0.567 Test Loss: 1.733 Test Acc: 0.567
Validation loss decreased (-0.477757 --> -0.566649).  Saving model ...
Epoch: 5 cost time: 1.1334176063537598
Epoch: 5, Steps: 12 | Train Loss: 1.492 Vali Loss: 1.397 Vali Acc: 0.567 Test Loss: 1.397 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 1.0985522270202637
Epoch: 6, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.207 Vali Acc: 0.561 Test Loss: 1.207 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1422333717346191
Epoch: 7, Steps: 12 | Train Loss: 0.999 Vali Loss: 1.037 Vali Acc: 0.611 Test Loss: 1.037 Test Acc: 0.611
Validation loss decreased (-0.566653 --> -0.611101).  Saving model ...
Epoch: 8 cost time: 0.9613118171691895
Epoch: 8, Steps: 12 | Train Loss: 0.844 Vali Loss: 0.958 Vali Acc: 0.650 Test Loss: 0.958 Test Acc: 0.650
Validation loss decreased (-0.611101 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 1.1188771724700928
Epoch: 9, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.890 Vali Acc: 0.667 Test Loss: 0.890 Test Acc: 0.667
Validation loss decreased (-0.649990 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 1.003718614578247
Epoch: 10, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.902 Vali Acc: 0.717 Test Loss: 0.902 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.716658).  Saving model ...
Epoch: 11 cost time: 1.1701807975769043
Epoch: 11, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0498087406158447
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 1.075 Vali Acc: 0.711 Test Loss: 1.075 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1474556922912598
Epoch: 13, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1468160152435303
Epoch: 14, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.887 Vali Acc: 0.772 Test Loss: 0.887 Test Acc: 0.772
Validation loss decreased (-0.716658 --> -0.772213).  Saving model ...
Epoch: 15 cost time: 1.0140705108642578
Epoch: 15, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.979 Vali Acc: 0.767 Test Loss: 0.979 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1425237655639648
Epoch: 16, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.915 Vali Acc: 0.789 Test Loss: 0.915 Test Acc: 0.789
Validation loss decreased (-0.772213 --> -0.788880).  Saving model ...
Epoch: 17 cost time: 1.0248661041259766
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.934 Vali Acc: 0.761 Test Loss: 0.934 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0006144046783447
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.956 Vali Acc: 0.794 Test Loss: 0.956 Test Acc: 0.794
Validation loss decreased (-0.788880 --> -0.794435).  Saving model ...
Epoch: 19 cost time: 1.0524027347564697
Epoch: 19, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8256740570068359
Epoch: 20, Steps: 12 | Train Loss: 0.253 Vali Loss: 1.027 Vali Acc: 0.833 Test Loss: 1.027 Test Acc: 0.833
Validation loss decreased (-0.794435 --> -0.833323).  Saving model ...
Epoch: 21 cost time: 0.947289228439331
Epoch: 21, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.915 Vali Acc: 0.800 Test Loss: 0.915 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.716867208480835
Epoch: 22, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.112 Vali Acc: 0.806 Test Loss: 1.112 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8495910167694092
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.963 Vali Acc: 0.806 Test Loss: 0.963 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0151968002319336
Epoch: 24, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.122 Vali Acc: 0.761 Test Loss: 1.122 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0284016132354736
Epoch: 25, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.106 Vali Acc: 0.772 Test Loss: 1.106 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9757578372955322
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.218 Vali Acc: 0.783 Test Loss: 1.218 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8759779930114746
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.068 Vali Acc: 0.767 Test Loss: 1.068 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0098247528076172
Epoch: 28, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.214 Vali Acc: 0.772 Test Loss: 1.214 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9531533718109131
Epoch: 29, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.144 Vali Acc: 0.839 Test Loss: 1.144 Test Acc: 0.839
Validation loss decreased (-0.833323 --> -0.838877).  Saving model ...
Epoch: 30 cost time: 0.9072117805480957
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.395 Vali Acc: 0.756 Test Loss: 1.395 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9761166572570801
Epoch: 31, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.107 Vali Acc: 0.833 Test Loss: 1.107 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.11201810836792
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.167 Vali Acc: 0.817 Test Loss: 1.167 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9349322319030762
Epoch: 33, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.140 Vali Acc: 0.828 Test Loss: 1.140 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1122958660125732
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.229 Vali Acc: 0.800 Test Loss: 1.229 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.20542573928833
Epoch: 35, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.339 Vali Acc: 0.800 Test Loss: 1.339 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1136994361877441
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.283 Vali Acc: 0.789 Test Loss: 1.283 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9352779388427734
Epoch: 37, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.208 Vali Acc: 0.789 Test Loss: 1.208 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7484169006347656
Epoch: 38, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.541 Vali Acc: 0.783 Test Loss: 1.541 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8650038242340088
Epoch: 39, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.250 Vali Acc: 0.794 Test Loss: 1.250 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 43597071
model size : 180.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4291744232177734
Epoch: 1, Steps: 12 | Train Loss: 2.850 Vali Loss: 2.700 Vali Acc: 0.156 Test Loss: 2.700 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 0.7866256237030029
Epoch: 2, Steps: 12 | Train Loss: 2.641 Vali Loss: 2.524 Vali Acc: 0.294 Test Loss: 2.524 Test Acc: 0.294
Validation loss decreased (-0.155529 --> -0.294419).  Saving model ...
Epoch: 3 cost time: 0.8570630550384521
Epoch: 3, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.313 Vali Acc: 0.456 Test Loss: 2.313 Test Acc: 0.456
Validation loss decreased (-0.294419 --> -0.455532).  Saving model ...
Epoch: 4 cost time: 0.6361868381500244
Epoch: 4, Steps: 12 | Train Loss: 2.206 Vali Loss: 2.025 Vali Acc: 0.544 Test Loss: 2.025 Test Acc: 0.544
Validation loss decreased (-0.455532 --> -0.544424).  Saving model ...
Epoch: 5 cost time: 0.7629940509796143
Epoch: 5, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.685 Vali Acc: 0.517 Test Loss: 1.685 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.00943922996521
Epoch: 6, Steps: 12 | Train Loss: 1.471 Vali Loss: 1.434 Vali Acc: 0.539 Test Loss: 1.434 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9595663547515869
Epoch: 7, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.254 Vali Acc: 0.606 Test Loss: 1.254 Test Acc: 0.606
Validation loss decreased (-0.544424 --> -0.605543).  Saving model ...
Epoch: 8 cost time: 0.7652506828308105
Epoch: 8, Steps: 12 | Train Loss: 1.027 Vali Loss: 1.095 Vali Acc: 0.633 Test Loss: 1.095 Test Acc: 0.633
Validation loss decreased (-0.605543 --> -0.633322).  Saving model ...
Epoch: 9 cost time: 0.991586446762085
Epoch: 9, Steps: 12 | Train Loss: 0.794 Vali Loss: 0.912 Vali Acc: 0.694 Test Loss: 0.912 Test Acc: 0.694
Validation loss decreased (-0.633322 --> -0.694435).  Saving model ...
Epoch: 10 cost time: 0.9623191356658936
Epoch: 10, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 11 cost time: 1.0437166690826416
Epoch: 11, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.782 Vali Acc: 0.711 Test Loss: 0.782 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6784217357635498
Epoch: 12, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.766 Vali Acc: 0.728 Test Loss: 0.766 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727770).  Saving model ...
Epoch: 13 cost time: 0.8114261627197266
Epoch: 13, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.708 Vali Acc: 0.739 Test Loss: 0.708 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 0.6832938194274902
Epoch: 14, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.672 Vali Acc: 0.750 Test Loss: 0.672 Test Acc: 0.750
Validation loss decreased (-0.738882 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 0.8957364559173584
Epoch: 15, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.742 Vali Acc: 0.761 Test Loss: 0.742 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 16 cost time: 0.9342234134674072
Epoch: 16, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 0.8051931858062744
Epoch: 17, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.795 Vali Acc: 0.772 Test Loss: 0.795 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8544552326202393
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.702 Vali Acc: 0.794 Test Loss: 0.702 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794437).  Saving model ...
Epoch: 19 cost time: 0.7841517925262451
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.705 Vali Acc: 0.800 Test Loss: 0.705 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 20 cost time: 0.7477447986602783
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 21 cost time: 0.9187686443328857
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.766 Vali Acc: 0.806 Test Loss: 0.766 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7323331832885742
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.685 Vali Acc: 0.806 Test Loss: 0.685 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805549).  Saving model ...
Epoch: 23 cost time: 0.717181921005249
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.745 Vali Acc: 0.822 Test Loss: 0.745 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 24 cost time: 0.6787264347076416
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.795 Vali Acc: 0.817 Test Loss: 0.795 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8576505184173584
Epoch: 25, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.777 Vali Acc: 0.789 Test Loss: 0.777 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8761706352233887
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.841 Vali Acc: 0.811 Test Loss: 0.841 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7926139831542969
Epoch: 27, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.796 Vali Acc: 0.794 Test Loss: 0.796 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6842119693756104
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.937 Vali Acc: 0.811 Test Loss: 0.937 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8437268733978271
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.926 Vali Acc: 0.794 Test Loss: 0.926 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8220162391662598
Epoch: 30, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.829 Vali Acc: 0.822 Test Loss: 0.829 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7970402240753174
Epoch: 31, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.826 Vali Acc: 0.822 Test Loss: 0.826 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7157206535339355
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.873 Vali Acc: 0.822 Test Loss: 0.873 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9366075992584229
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.878 Vali Acc: 0.806 Test Loss: 0.878 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 43505679
model size : 180.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8153607845306396
Epoch: 1, Steps: 12 | Train Loss: 2.784 Vali Loss: 2.616 Vali Acc: 0.233 Test Loss: 2.616 Test Acc: 0.233
Validation loss decreased (inf --> -0.233307).  Saving model ...
Epoch: 2 cost time: 1.0806429386138916
Epoch: 2, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.339 Vali Acc: 0.278 Test Loss: 2.339 Test Acc: 0.278
Validation loss decreased (-0.233307 --> -0.277754).  Saving model ...
Epoch: 3 cost time: 1.3359158039093018
Epoch: 3, Steps: 12 | Train Loss: 2.161 Vali Loss: 1.981 Vali Acc: 0.467 Test Loss: 1.981 Test Acc: 0.467
Validation loss decreased (-0.277754 --> -0.466647).  Saving model ...
Epoch: 4 cost time: 1.385133981704712
Epoch: 4, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.555 Vali Acc: 0.572 Test Loss: 1.555 Test Acc: 0.572
Validation loss decreased (-0.466647 --> -0.572207).  Saving model ...
Epoch: 5 cost time: 1.7007746696472168
Epoch: 5, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.232 Vali Acc: 0.594 Test Loss: 1.232 Test Acc: 0.594
Validation loss decreased (-0.572207 --> -0.594432).  Saving model ...
Epoch: 6 cost time: 1.295341968536377
Epoch: 6, Steps: 12 | Train Loss: 0.961 Vali Loss: 1.154 Vali Acc: 0.583 Test Loss: 1.154 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.319753646850586
Epoch: 7, Steps: 12 | Train Loss: 0.817 Vali Loss: 1.035 Vali Acc: 0.667 Test Loss: 1.035 Test Acc: 0.667
Validation loss decreased (-0.594432 --> -0.666656).  Saving model ...
Epoch: 8 cost time: 0.9643609523773193
Epoch: 8, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.071 Vali Acc: 0.661 Test Loss: 1.071 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3558669090270996
Epoch: 9, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.982 Vali Acc: 0.678 Test Loss: 0.982 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 1.2923169136047363
Epoch: 10, Steps: 12 | Train Loss: 0.544 Vali Loss: 0.986 Vali Acc: 0.717 Test Loss: 0.986 Test Acc: 0.717
Validation loss decreased (-0.677768 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 1.3035790920257568
Epoch: 11, Steps: 12 | Train Loss: 0.392 Vali Loss: 1.079 Vali Acc: 0.694 Test Loss: 1.079 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9656355381011963
Epoch: 12, Steps: 12 | Train Loss: 0.365 Vali Loss: 1.033 Vali Acc: 0.700 Test Loss: 1.033 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0903325080871582
Epoch: 13, Steps: 12 | Train Loss: 0.447 Vali Loss: 1.285 Vali Acc: 0.711 Test Loss: 1.285 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.201620101928711
Epoch: 14, Steps: 12 | Train Loss: 0.327 Vali Loss: 1.122 Vali Acc: 0.744 Test Loss: 1.122 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744433).  Saving model ...
Epoch: 15 cost time: 1.1066434383392334
Epoch: 15, Steps: 12 | Train Loss: 0.322 Vali Loss: 1.538 Vali Acc: 0.694 Test Loss: 1.538 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2028377056121826
Epoch: 16, Steps: 12 | Train Loss: 0.413 Vali Loss: 1.471 Vali Acc: 0.728 Test Loss: 1.471 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4916176795959473
Epoch: 17, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.381 Vali Acc: 0.744 Test Loss: 1.381 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1903791427612305
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 1.371 Vali Acc: 0.728 Test Loss: 1.371 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6228814125061035
Epoch: 19, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.323 Vali Acc: 0.728 Test Loss: 1.323 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1769473552703857
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 1.278 Vali Acc: 0.722 Test Loss: 1.278 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7060189247131348
Epoch: 21, Steps: 12 | Train Loss: 0.237 Vali Loss: 1.596 Vali Acc: 0.728 Test Loss: 1.596 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5636725425720215
Epoch: 22, Steps: 12 | Train Loss: 0.209 Vali Loss: 1.348 Vali Acc: 0.761 Test Loss: 1.348 Test Acc: 0.761
Validation loss decreased (-0.744433 --> -0.761098).  Saving model ...
Epoch: 23 cost time: 1.1480624675750732
Epoch: 23, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.522 Vali Acc: 0.789 Test Loss: 1.522 Test Acc: 0.789
Validation loss decreased (-0.761098 --> -0.788874).  Saving model ...
Epoch: 24 cost time: 0.9936733245849609
Epoch: 24, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.427 Vali Acc: 0.761 Test Loss: 1.427 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3791396617889404
Epoch: 25, Steps: 12 | Train Loss: 0.190 Vali Loss: 1.507 Vali Acc: 0.761 Test Loss: 1.507 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.264233112335205
Epoch: 26, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.417 Vali Acc: 0.744 Test Loss: 1.417 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.437152624130249
Epoch: 27, Steps: 12 | Train Loss: 0.094 Vali Loss: 2.006 Vali Acc: 0.722 Test Loss: 2.006 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3671767711639404
Epoch: 28, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.541 Vali Acc: 0.778 Test Loss: 1.541 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1505541801452637
Epoch: 29, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.456 Vali Acc: 0.789 Test Loss: 1.456 Test Acc: 0.789
Validation loss decreased (-0.788874 --> -0.788874).  Saving model ...
Epoch: 30 cost time: 1.022468090057373
Epoch: 30, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.653 Vali Acc: 0.778 Test Loss: 1.653 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.116572380065918
Epoch: 31, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.838 Vali Acc: 0.772 Test Loss: 1.838 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.186483383178711
Epoch: 32, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.721 Vali Acc: 0.778 Test Loss: 1.721 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5117027759552002
Epoch: 33, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.469 Vali Acc: 0.806 Test Loss: 1.469 Test Acc: 0.806
Validation loss decreased (-0.788874 --> -0.805541).  Saving model ...
Epoch: 34 cost time: 1.638033151626587
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.803 Vali Acc: 0.772 Test Loss: 1.803 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5427677631378174
Epoch: 35, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.765 Vali Acc: 0.772 Test Loss: 1.765 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3098247051239014
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.659 Vali Acc: 0.789 Test Loss: 1.659 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3589122295379639
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.888 Vali Acc: 0.778 Test Loss: 1.888 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4006214141845703
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.772 Vali Acc: 0.794 Test Loss: 1.772 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9217438697814941
Epoch: 39, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.790 Vali Acc: 0.783 Test Loss: 1.790 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1661276817321777
Epoch: 40, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.833 Vali Acc: 0.778 Test Loss: 1.833 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.3924751281738281
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.903 Vali Acc: 0.756 Test Loss: 1.903 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.638146162033081
Epoch: 42, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.606 Vali Acc: 0.806 Test Loss: 1.606 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.5665802955627441
Epoch: 43, Steps: 12 | Train Loss: 0.145 Vali Loss: 2.065 Vali Acc: 0.756 Test Loss: 2.065 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 43680015
model size : 181.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.78902006149292
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.661 Vali Acc: 0.139 Test Loss: 2.661 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.8331315517425537
Epoch: 2, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.483 Vali Acc: 0.300 Test Loss: 2.483 Test Acc: 0.300
Validation loss decreased (-0.138862 --> -0.299975).  Saving model ...
Epoch: 3 cost time: 0.9859592914581299
Epoch: 3, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.265 Vali Acc: 0.406 Test Loss: 2.265 Test Acc: 0.406
Validation loss decreased (-0.299975 --> -0.405533).  Saving model ...
Epoch: 4 cost time: 1.1326918601989746
Epoch: 4, Steps: 12 | Train Loss: 2.159 Vali Loss: 1.976 Vali Acc: 0.539 Test Loss: 1.976 Test Acc: 0.539
Validation loss decreased (-0.405533 --> -0.538869).  Saving model ...
Epoch: 5 cost time: 0.9655184745788574
Epoch: 5, Steps: 12 | Train Loss: 1.758 Vali Loss: 1.585 Vali Acc: 0.533 Test Loss: 1.585 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8431134223937988
Epoch: 6, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.242 Vali Acc: 0.561 Test Loss: 1.242 Test Acc: 0.561
Validation loss decreased (-0.538869 --> -0.561099).  Saving model ...
Epoch: 7 cost time: 0.9331493377685547
Epoch: 7, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.109 Vali Acc: 0.611 Test Loss: 1.109 Test Acc: 0.611
Validation loss decreased (-0.561099 --> -0.611100).  Saving model ...
Epoch: 8 cost time: 0.9073061943054199
Epoch: 8, Steps: 12 | Train Loss: 0.915 Vali Loss: 0.913 Vali Acc: 0.650 Test Loss: 0.913 Test Acc: 0.650
Validation loss decreased (-0.611100 --> -0.649991).  Saving model ...
Epoch: 9 cost time: 1.0899479389190674
Epoch: 9, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.942 Vali Acc: 0.672 Test Loss: 0.942 Test Acc: 0.672
Validation loss decreased (-0.649991 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 0.7417912483215332
Epoch: 10, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.864 Vali Acc: 0.683 Test Loss: 0.864 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683325).  Saving model ...
Epoch: 11 cost time: 0.8549175262451172
Epoch: 11, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.886 Vali Acc: 0.717 Test Loss: 0.886 Test Acc: 0.717
Validation loss decreased (-0.683325 --> -0.716658).  Saving model ...
Epoch: 12 cost time: 0.750356912612915
Epoch: 12, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.848 Vali Acc: 0.722 Test Loss: 0.848 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 13 cost time: 0.7408692836761475
Epoch: 13, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.932 Vali Acc: 0.744 Test Loss: 0.932 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744435).  Saving model ...
Epoch: 14 cost time: 0.6839156150817871
Epoch: 14, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 0.6879925727844238
Epoch: 15, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.862 Vali Acc: 0.744 Test Loss: 0.862 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6034500598907471
Epoch: 16, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.850 Vali Acc: 0.750 Test Loss: 0.850 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9496293067932129
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.875 Vali Acc: 0.761 Test Loss: 0.875 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6518759727478027
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.847 Vali Acc: 0.750 Test Loss: 0.847 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7620370388031006
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.861 Vali Acc: 0.772 Test Loss: 0.861 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772214).  Saving model ...
Epoch: 20 cost time: 0.7734875679016113
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.885 Vali Acc: 0.772 Test Loss: 0.885 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7590103149414062
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.960 Vali Acc: 0.789 Test Loss: 0.960 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788879).  Saving model ...
Epoch: 22 cost time: 0.7930338382720947
Epoch: 22, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.971 Vali Acc: 0.767 Test Loss: 0.971 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6902105808258057
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.962 Vali Acc: 0.767 Test Loss: 0.962 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9066205024719238
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.099 Vali Acc: 0.767 Test Loss: 1.099 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6867992877960205
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.921 Vali Acc: 0.817 Test Loss: 0.921 Test Acc: 0.817
Validation loss decreased (-0.788879 --> -0.816657).  Saving model ...
Epoch: 26 cost time: 0.8817198276519775
Epoch: 26, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.930 Vali Acc: 0.794 Test Loss: 0.930 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7715263366699219
Epoch: 27, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.048 Vali Acc: 0.794 Test Loss: 1.048 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6910176277160645
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.002 Vali Acc: 0.794 Test Loss: 1.002 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8898568153381348
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.086 Vali Acc: 0.789 Test Loss: 1.086 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7818446159362793
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.066 Vali Acc: 0.778 Test Loss: 1.066 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.211315631866455
Epoch: 31, Steps: 12 | Train Loss: 0.072 Vali Loss: 1.226 Vali Acc: 0.794 Test Loss: 1.226 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8710780143737793
Epoch: 32, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.048 Vali Acc: 0.806 Test Loss: 1.048 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.965794563293457
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.976 Vali Acc: 0.822 Test Loss: 0.976 Test Acc: 0.822
Validation loss decreased (-0.816657 --> -0.822212).  Saving model ...
Epoch: 34 cost time: 0.7385547161102295
Epoch: 34, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.332 Vali Acc: 0.778 Test Loss: 1.332 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.561638355255127
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.035 Vali Acc: 0.772 Test Loss: 1.035 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6095974445343018
Epoch: 36, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.088 Vali Acc: 0.806 Test Loss: 1.088 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.65621018409729
Epoch: 37, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.047 Vali Acc: 0.822 Test Loss: 1.047 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9437220096588135
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.080 Vali Acc: 0.800 Test Loss: 1.080 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9932022094726562
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0524113178253174
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.259 Vali Acc: 0.817 Test Loss: 1.259 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.940781831741333
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.989 Vali Acc: 0.822 Test Loss: 0.989 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7824685573577881
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.111 Vali Acc: 0.811 Test Loss: 1.111 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7524318695068359
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.091 Vali Acc: 0.778 Test Loss: 1.091 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 43549455
model size : 180.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1389756202697754
Epoch: 1, Steps: 12 | Train Loss: 2.835 Vali Loss: 2.693 Vali Acc: 0.133 Test Loss: 2.693 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.7741422653198242
Epoch: 2, Steps: 12 | Train Loss: 2.626 Vali Loss: 2.538 Vali Acc: 0.289 Test Loss: 2.538 Test Acc: 0.289
Validation loss decreased (-0.133306 --> -0.288864).  Saving model ...
Epoch: 3 cost time: 0.7671761512756348
Epoch: 3, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.360 Vali Acc: 0.389 Test Loss: 2.360 Test Acc: 0.389
Validation loss decreased (-0.288864 --> -0.388865).  Saving model ...
Epoch: 4 cost time: 0.6129207611083984
Epoch: 4, Steps: 12 | Train Loss: 2.217 Vali Loss: 2.121 Vali Acc: 0.472 Test Loss: 2.121 Test Acc: 0.472
Validation loss decreased (-0.388865 --> -0.472201).  Saving model ...
Epoch: 5 cost time: 0.6339449882507324
Epoch: 5, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.757 Vali Acc: 0.533 Test Loss: 1.757 Test Acc: 0.533
Validation loss decreased (-0.472201 --> -0.533316).  Saving model ...
Epoch: 6 cost time: 0.8265640735626221
Epoch: 6, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.402 Vali Acc: 0.556 Test Loss: 1.402 Test Acc: 0.556
Validation loss decreased (-0.533316 --> -0.555542).  Saving model ...
Epoch: 7 cost time: 0.6974835395812988
Epoch: 7, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.184 Vali Acc: 0.594 Test Loss: 1.184 Test Acc: 0.594
Validation loss decreased (-0.555542 --> -0.594433).  Saving model ...
Epoch: 8 cost time: 0.7776839733123779
Epoch: 8, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.075 Vali Acc: 0.633 Test Loss: 1.075 Test Acc: 0.633
Validation loss decreased (-0.594433 --> -0.633323).  Saving model ...
Epoch: 9 cost time: 0.6931524276733398
Epoch: 9, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.907 Vali Acc: 0.650 Test Loss: 0.907 Test Acc: 0.650
Validation loss decreased (-0.633323 --> -0.649991).  Saving model ...
Epoch: 10 cost time: 0.7470974922180176
Epoch: 10, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.849 Vali Acc: 0.711 Test Loss: 0.849 Test Acc: 0.711
Validation loss decreased (-0.649991 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 0.8167381286621094
Epoch: 11, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.762 Vali Acc: 0.744 Test Loss: 0.762 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 0.917076587677002
Epoch: 12, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.790 Vali Acc: 0.722 Test Loss: 0.790 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7226300239562988
Epoch: 13, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.689 Vali Acc: 0.756 Test Loss: 0.689 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 14 cost time: 0.8042888641357422
Epoch: 14, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.718 Vali Acc: 0.756 Test Loss: 0.718 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7916009426116943
Epoch: 15, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.711 Vali Acc: 0.772 Test Loss: 0.711 Test Acc: 0.772
Validation loss decreased (-0.755549 --> -0.772215).  Saving model ...
Epoch: 16 cost time: 0.7054438591003418
Epoch: 16, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 0.7908468246459961
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.752 Vali Acc: 0.800 Test Loss: 0.752 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.7128875255584717
Epoch: 18, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.704 Vali Acc: 0.794 Test Loss: 0.704 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7323517799377441
Epoch: 19, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7566709518432617
Epoch: 20, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.723 Vali Acc: 0.817 Test Loss: 0.723 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 21 cost time: 0.7895810604095459
Epoch: 21, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822216).  Saving model ...
Epoch: 22 cost time: 0.8577146530151367
Epoch: 22, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.704 Vali Acc: 0.828 Test Loss: 0.704 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 0.7672603130340576
Epoch: 23, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.635 Vali Acc: 0.833 Test Loss: 0.635 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 0.7868306636810303
Epoch: 24, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.628 Vali Acc: 0.839 Test Loss: 0.628 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 25 cost time: 0.7536928653717041
Epoch: 25, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.617 Vali Acc: 0.833 Test Loss: 0.617 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6618046760559082
Epoch: 26, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.725 Vali Acc: 0.828 Test Loss: 0.725 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7686357498168945
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.748 Vali Acc: 0.828 Test Loss: 0.748 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7510268688201904
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.675 Vali Acc: 0.833 Test Loss: 0.675 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.839693546295166
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7978963851928711
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
Validation loss decreased (-0.838883 --> -0.849992).  Saving model ...
Epoch: 31 cost time: 0.7048723697662354
Epoch: 31, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.744 Vali Acc: 0.856 Test Loss: 0.744 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855548).  Saving model ...
Epoch: 32 cost time: 0.7721436023712158
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8085670471191406
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.731 Vali Acc: 0.844 Test Loss: 0.731 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6347386837005615
Epoch: 34, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.789 Vali Acc: 0.844 Test Loss: 0.789 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6808576583862305
Epoch: 35, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.725 Vali Acc: 0.856 Test Loss: 0.725 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 36 cost time: 0.7705502510070801
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.815 Vali Acc: 0.856 Test Loss: 0.815 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6727492809295654
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.792 Vali Acc: 0.839 Test Loss: 0.792 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8076393604278564
Epoch: 38, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6691009998321533
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.825 Vali Acc: 0.828 Test Loss: 0.825 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6244072914123535
Epoch: 40, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.799 Vali Acc: 0.861 Test Loss: 0.799 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861103).  Saving model ...
Epoch: 41 cost time: 0.7143688201904297
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.876 Vali Acc: 0.856 Test Loss: 0.876 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.660391092300415
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.808 Vali Acc: 0.844 Test Loss: 0.808 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6969325542449951
Epoch: 43, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.908 Vali Acc: 0.850 Test Loss: 0.908 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6102867126464844
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.852 Vali Acc: 0.861 Test Loss: 0.852 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8280441761016846
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.908 Vali Acc: 0.850 Test Loss: 0.908 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7738635540008545
Epoch: 46, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.878 Vali Acc: 0.839 Test Loss: 0.878 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7066605091094971
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.888 Vali Acc: 0.872 Test Loss: 0.888 Test Acc: 0.872
Validation loss decreased (-0.861103 --> -0.872213).  Saving model ...
Epoch: 48 cost time: 0.696664571762085
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.875 Vali Acc: 0.861 Test Loss: 0.875 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9227967262268066
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.879 Vali Acc: 0.856 Test Loss: 0.879 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7864153385162354
Epoch: 50, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.850 Vali Acc: 0.861 Test Loss: 0.850 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 43497231
model size : 180.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6019158363342285
Epoch: 1, Steps: 12 | Train Loss: 2.818 Vali Loss: 2.654 Vali Acc: 0.122 Test Loss: 2.654 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 1.1051456928253174
Epoch: 2, Steps: 12 | Train Loss: 2.555 Vali Loss: 2.381 Vali Acc: 0.372 Test Loss: 2.381 Test Acc: 0.372
Validation loss decreased (-0.122196 --> -0.372198).  Saving model ...
Epoch: 3 cost time: 0.8835134506225586
Epoch: 3, Steps: 12 | Train Loss: 2.194 Vali Loss: 2.007 Vali Acc: 0.444 Test Loss: 2.007 Test Acc: 0.444
Validation loss decreased (-0.372198 --> -0.444424).  Saving model ...
Epoch: 4 cost time: 0.8890655040740967
Epoch: 4, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.637 Vali Acc: 0.489 Test Loss: 1.637 Test Acc: 0.489
Validation loss decreased (-0.444424 --> -0.488873).  Saving model ...
Epoch: 5 cost time: 0.802823543548584
Epoch: 5, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.421 Vali Acc: 0.556 Test Loss: 1.421 Test Acc: 0.556
Validation loss decreased (-0.488873 --> -0.555541).  Saving model ...
Epoch: 6 cost time: 1.1251311302185059
Epoch: 6, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.229 Vali Acc: 0.572 Test Loss: 1.229 Test Acc: 0.572
Validation loss decreased (-0.555541 --> -0.572210).  Saving model ...
Epoch: 7 cost time: 0.8402421474456787
Epoch: 7, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.090 Vali Acc: 0.628 Test Loss: 1.090 Test Acc: 0.628
Validation loss decreased (-0.572210 --> -0.627767).  Saving model ...
Epoch: 8 cost time: 1.2299604415893555
Epoch: 8, Steps: 12 | Train Loss: 0.652 Vali Loss: 1.147 Vali Acc: 0.617 Test Loss: 1.147 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0571887493133545
Epoch: 9, Steps: 12 | Train Loss: 0.595 Vali Loss: 0.946 Vali Acc: 0.667 Test Loss: 0.946 Test Acc: 0.667
Validation loss decreased (-0.627767 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 1.5741589069366455
Epoch: 10, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.095 Vali Acc: 0.672 Test Loss: 1.095 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672211).  Saving model ...
Epoch: 11 cost time: 1.6095271110534668
Epoch: 11, Steps: 12 | Train Loss: 0.446 Vali Loss: 1.061 Vali Acc: 0.711 Test Loss: 1.061 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711100).  Saving model ...
Epoch: 12 cost time: 1.291928768157959
Epoch: 12, Steps: 12 | Train Loss: 0.562 Vali Loss: 1.124 Vali Acc: 0.717 Test Loss: 1.124 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716655).  Saving model ...
Epoch: 13 cost time: 1.392218828201294
Epoch: 13, Steps: 12 | Train Loss: 0.419 Vali Loss: 1.302 Vali Acc: 0.667 Test Loss: 1.302 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.591827154159546
Epoch: 14, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.102 Vali Acc: 0.722 Test Loss: 1.102 Test Acc: 0.722
Validation loss decreased (-0.716655 --> -0.722211).  Saving model ...
Epoch: 15 cost time: 1.1223738193511963
Epoch: 15, Steps: 12 | Train Loss: 0.400 Vali Loss: 1.139 Vali Acc: 0.694 Test Loss: 1.139 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0705738067626953
Epoch: 16, Steps: 12 | Train Loss: 0.329 Vali Loss: 1.073 Vali Acc: 0.717 Test Loss: 1.073 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4059498310089111
Epoch: 17, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.119 Vali Acc: 0.739 Test Loss: 1.119 Test Acc: 0.739
Validation loss decreased (-0.722211 --> -0.738878).  Saving model ...
Epoch: 18 cost time: 1.5513768196105957
Epoch: 18, Steps: 12 | Train Loss: 0.208 Vali Loss: 1.278 Vali Acc: 0.733 Test Loss: 1.278 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3332178592681885
Epoch: 19, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.281 Vali Acc: 0.761 Test Loss: 1.281 Test Acc: 0.761
Validation loss decreased (-0.738878 --> -0.761098).  Saving model ...
Epoch: 20 cost time: 1.0216286182403564
Epoch: 20, Steps: 12 | Train Loss: 0.191 Vali Loss: 1.203 Vali Acc: 0.778 Test Loss: 1.203 Test Acc: 0.778
Validation loss decreased (-0.761098 --> -0.777766).  Saving model ...
Epoch: 21 cost time: 1.003026008605957
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.299 Vali Acc: 0.756 Test Loss: 1.299 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9154872894287109
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.238 Vali Acc: 0.744 Test Loss: 1.238 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3852174282073975
Epoch: 23, Steps: 12 | Train Loss: 0.137 Vali Loss: 1.191 Vali Acc: 0.744 Test Loss: 1.191 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3783752918243408
Epoch: 24, Steps: 12 | Train Loss: 0.114 Vali Loss: 1.225 Vali Acc: 0.756 Test Loss: 1.225 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3183798789978027
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.208 Vali Acc: 0.761 Test Loss: 1.208 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2205722332000732
Epoch: 26, Steps: 12 | Train Loss: 0.264 Vali Loss: 1.430 Vali Acc: 0.767 Test Loss: 1.430 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3750991821289062
Epoch: 27, Steps: 12 | Train Loss: 0.221 Vali Loss: 1.373 Vali Acc: 0.739 Test Loss: 1.373 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1452605724334717
Epoch: 28, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.319 Vali Acc: 0.756 Test Loss: 1.319 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8156521320343018
Epoch: 29, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.529 Vali Acc: 0.739 Test Loss: 1.529 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.09879732131958
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.474 Vali Acc: 0.767 Test Loss: 1.474 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 43671567
model size : 181.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.105339765548706
Epoch: 1, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.674 Vali Acc: 0.094 Test Loss: 2.674 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 0.9713850021362305
Epoch: 2, Steps: 12 | Train Loss: 2.603 Vali Loss: 2.513 Vali Acc: 0.356 Test Loss: 2.513 Test Acc: 0.356
Validation loss decreased (-0.094418 --> -0.355530).  Saving model ...
Epoch: 3 cost time: 0.7454631328582764
Epoch: 3, Steps: 12 | Train Loss: 2.379 Vali Loss: 2.259 Vali Acc: 0.428 Test Loss: 2.259 Test Acc: 0.428
Validation loss decreased (-0.355530 --> -0.427755).  Saving model ...
Epoch: 4 cost time: 0.6402766704559326
Epoch: 4, Steps: 12 | Train Loss: 2.058 Vali Loss: 1.955 Vali Acc: 0.511 Test Loss: 1.955 Test Acc: 0.511
Validation loss decreased (-0.427755 --> -0.511092).  Saving model ...
Epoch: 5 cost time: 1.06626296043396
Epoch: 5, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.627 Vali Acc: 0.572 Test Loss: 1.627 Test Acc: 0.572
Validation loss decreased (-0.511092 --> -0.572206).  Saving model ...
Epoch: 6 cost time: 1.0064654350280762
Epoch: 6, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.354 Vali Acc: 0.539 Test Loss: 1.354 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8011093139648438
Epoch: 7, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.171 Vali Acc: 0.633 Test Loss: 1.171 Test Acc: 0.633
Validation loss decreased (-0.572206 --> -0.633322).  Saving model ...
Epoch: 8 cost time: 0.967390775680542
Epoch: 8, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.077 Vali Acc: 0.611 Test Loss: 1.077 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8214404582977295
Epoch: 9, Steps: 12 | Train Loss: 0.693 Vali Loss: 0.981 Vali Acc: 0.667 Test Loss: 0.981 Test Acc: 0.667
Validation loss decreased (-0.633322 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 1.0319092273712158
Epoch: 10, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.945 Vali Acc: 0.722 Test Loss: 0.945 Test Acc: 0.722
Validation loss decreased (-0.666657 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 1.0329859256744385
Epoch: 11, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.894 Vali Acc: 0.683 Test Loss: 0.894 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8810102939605713
Epoch: 12, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.857 Vali Acc: 0.744 Test Loss: 0.857 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 13 cost time: 0.9135260581970215
Epoch: 13, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.807 Vali Acc: 0.739 Test Loss: 0.807 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8854916095733643
Epoch: 14, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8484346866607666
Epoch: 15, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 1.0001628398895264
Epoch: 16, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.876 Vali Acc: 0.778 Test Loss: 0.876 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 0.8362240791320801
Epoch: 17, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.877 Vali Acc: 0.772 Test Loss: 0.877 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1801459789276123
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.920 Vali Acc: 0.778 Test Loss: 0.920 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8744490146636963
Epoch: 19, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.908 Vali Acc: 0.794 Test Loss: 0.908 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794435).  Saving model ...
Epoch: 20 cost time: 0.7167139053344727
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.888 Vali Acc: 0.794 Test Loss: 0.888 Test Acc: 0.794
Validation loss decreased (-0.794435 --> -0.794436).  Saving model ...
Epoch: 21 cost time: 0.7958929538726807
Epoch: 21, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.940 Vali Acc: 0.794 Test Loss: 0.940 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8981051445007324
Epoch: 22, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.026 Vali Acc: 0.761 Test Loss: 1.026 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9023923873901367
Epoch: 23, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.094 Vali Acc: 0.778 Test Loss: 1.094 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9015464782714844
Epoch: 24, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.083 Vali Acc: 0.772 Test Loss: 1.083 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.968940019607544
Epoch: 25, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.980 Vali Acc: 0.800 Test Loss: 0.980 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799990).  Saving model ...
Epoch: 26 cost time: 0.7227489948272705
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.069 Vali Acc: 0.800 Test Loss: 1.069 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8412349224090576
Epoch: 27, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.006 Vali Acc: 0.794 Test Loss: 1.006 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7934844493865967
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.979 Vali Acc: 0.828 Test Loss: 0.979 Test Acc: 0.828
Validation loss decreased (-0.799990 --> -0.827768).  Saving model ...
Epoch: 29 cost time: 0.8505866527557373
Epoch: 29, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.988 Vali Acc: 0.833 Test Loss: 0.988 Test Acc: 0.833
Validation loss decreased (-0.827768 --> -0.833323).  Saving model ...
Epoch: 30 cost time: 0.9233393669128418
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.994 Vali Acc: 0.806 Test Loss: 0.994 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8221168518066406
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.218 Vali Acc: 0.800 Test Loss: 1.218 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7812149524688721
Epoch: 32, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.187 Vali Acc: 0.772 Test Loss: 1.187 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9917876720428467
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.250 Vali Acc: 0.794 Test Loss: 1.250 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9240117073059082
Epoch: 34, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.219 Vali Acc: 0.789 Test Loss: 1.219 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0948996543884277
Epoch: 35, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.237 Vali Acc: 0.817 Test Loss: 1.237 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8622922897338867
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.223 Vali Acc: 0.789 Test Loss: 1.223 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1407854557037354
Epoch: 37, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.294 Vali Acc: 0.783 Test Loss: 1.294 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1316406726837158
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.155 Vali Acc: 0.833 Test Loss: 1.155 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7437808513641357
Epoch: 39, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.247 Vali Acc: 0.822 Test Loss: 1.247 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 43554063
model size : 180.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3838114738464355
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.699 Vali Acc: 0.072 Test Loss: 2.699 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.8699314594268799
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.579 Vali Acc: 0.206 Test Loss: 2.579 Test Acc: 0.206
Validation loss decreased (-0.072195 --> -0.205530).  Saving model ...
Epoch: 3 cost time: 0.7600452899932861
Epoch: 3, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.430 Vali Acc: 0.306 Test Loss: 2.430 Test Acc: 0.306
Validation loss decreased (-0.205530 --> -0.305531).  Saving model ...
Epoch: 4 cost time: 0.7992031574249268
Epoch: 4, Steps: 12 | Train Loss: 2.365 Vali Loss: 2.248 Vali Acc: 0.428 Test Loss: 2.248 Test Acc: 0.428
Validation loss decreased (-0.305531 --> -0.427755).  Saving model ...
Epoch: 5 cost time: 0.7567071914672852
Epoch: 5, Steps: 12 | Train Loss: 2.132 Vali Loss: 1.979 Vali Acc: 0.444 Test Loss: 1.979 Test Acc: 0.444
Validation loss decreased (-0.427755 --> -0.444425).  Saving model ...
Epoch: 6 cost time: 0.8192954063415527
Epoch: 6, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.649 Vali Acc: 0.528 Test Loss: 1.649 Test Acc: 0.528
Validation loss decreased (-0.444425 --> -0.527761).  Saving model ...
Epoch: 7 cost time: 0.8742341995239258
Epoch: 7, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.386 Vali Acc: 0.617 Test Loss: 1.386 Test Acc: 0.617
Validation loss decreased (-0.527761 --> -0.616653).  Saving model ...
Epoch: 8 cost time: 0.8640997409820557
Epoch: 8, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.201 Vali Acc: 0.633 Test Loss: 1.201 Test Acc: 0.633
Validation loss decreased (-0.616653 --> -0.633321).  Saving model ...
Epoch: 9 cost time: 0.7883272171020508
Epoch: 9, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.107 Vali Acc: 0.622 Test Loss: 1.107 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7652549743652344
Epoch: 10, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.908 Vali Acc: 0.667 Test Loss: 0.908 Test Acc: 0.667
Validation loss decreased (-0.633321 --> -0.666658).  Saving model ...
Epoch: 11 cost time: 0.7891824245452881
Epoch: 11, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.869 Vali Acc: 0.678 Test Loss: 0.869 Test Acc: 0.678
Validation loss decreased (-0.666658 --> -0.677769).  Saving model ...
Epoch: 12 cost time: 0.7578027248382568
Epoch: 12, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.770 Vali Acc: 0.722 Test Loss: 0.770 Test Acc: 0.722
Validation loss decreased (-0.677769 --> -0.722215).  Saving model ...
Epoch: 13 cost time: 0.5275399684906006
Epoch: 13, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.740 Vali Acc: 0.733 Test Loss: 0.740 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733326).  Saving model ...
Epoch: 14 cost time: 0.8586537837982178
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.745 Vali Acc: 0.739 Test Loss: 0.745 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738881).  Saving model ...
Epoch: 15 cost time: 0.834092378616333
Epoch: 15, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
Validation loss decreased (-0.738881 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 0.9602994918823242
Epoch: 16, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.729 Vali Acc: 0.767 Test Loss: 0.729 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8907132148742676
Epoch: 17, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 18 cost time: 0.907494306564331
Epoch: 18, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.8756554126739502
Epoch: 19, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 20 cost time: 0.7924613952636719
Epoch: 20, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8167159557342529
Epoch: 21, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7532985210418701
Epoch: 22, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.711 Vali Acc: 0.794 Test Loss: 0.711 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6532802581787109
Epoch: 23, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 24 cost time: 0.8162441253662109
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.690 Vali Acc: 0.822 Test Loss: 0.690 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 0.7491579055786133
Epoch: 25, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.717 Vali Acc: 0.817 Test Loss: 0.717 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7358806133270264
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.717 Vali Acc: 0.806 Test Loss: 0.717 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8069581985473633
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.780 Vali Acc: 0.811 Test Loss: 0.780 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.674757719039917
Epoch: 28, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.722 Vali Acc: 0.800 Test Loss: 0.722 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7416751384735107
Epoch: 29, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.782 Vali Acc: 0.822 Test Loss: 0.782 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7131361961364746
Epoch: 30, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.741 Vali Acc: 0.811 Test Loss: 0.741 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6314129829406738
Epoch: 31, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.786 Vali Acc: 0.833 Test Loss: 0.786 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833325).  Saving model ...
Epoch: 32 cost time: 0.7151665687561035
Epoch: 32, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.766 Vali Acc: 0.844 Test Loss: 0.766 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844437).  Saving model ...
Epoch: 33 cost time: 0.703080415725708
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.806 Vali Acc: 0.828 Test Loss: 0.806 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8370723724365234
Epoch: 34, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.824 Vali Acc: 0.839 Test Loss: 0.824 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6481060981750488
Epoch: 35, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.868 Vali Acc: 0.806 Test Loss: 0.868 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6999781131744385
Epoch: 36, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849992).  Saving model ...
Epoch: 37 cost time: 0.6356372833251953
Epoch: 37, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.863 Vali Acc: 0.828 Test Loss: 0.863 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6692802906036377
Epoch: 38, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.840 Vali Acc: 0.839 Test Loss: 0.840 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7147572040557861
Epoch: 39, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.858 Vali Acc: 0.828 Test Loss: 0.858 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8279721736907959
Epoch: 40, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.879 Vali Acc: 0.833 Test Loss: 0.879 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7725849151611328
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.961 Vali Acc: 0.800 Test Loss: 0.961 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8437559604644775
Epoch: 42, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.833 Vali Acc: 0.839 Test Loss: 0.833 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.749746561050415
Epoch: 43, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.783 Vali Acc: 0.856 Test Loss: 0.783 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855548).  Saving model ...
Epoch: 44 cost time: 0.852053165435791
Epoch: 44, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.809 Vali Acc: 0.861 Test Loss: 0.809 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861103).  Saving model ...
Epoch: 45 cost time: 0.6815674304962158
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.870 Vali Acc: 0.856 Test Loss: 0.870 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6361336708068848
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.868 Vali Acc: 0.833 Test Loss: 0.868 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9038169384002686
Epoch: 47, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.856 Vali Acc: 0.822 Test Loss: 0.856 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8360669612884521
Epoch: 48, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.851 Vali Acc: 0.850 Test Loss: 0.851 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7238552570343018
Epoch: 49, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.879 Vali Acc: 0.850 Test Loss: 0.879 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6485633850097656
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.900 Vali Acc: 0.850 Test Loss: 0.900 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 43488783
model size : 180.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.26127552986145
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.640 Vali Acc: 0.078 Test Loss: 2.640 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.6697347164154053
Epoch: 2, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.426 Vali Acc: 0.383 Test Loss: 2.426 Test Acc: 0.383
Validation loss decreased (-0.077751 --> -0.383309).  Saving model ...
Epoch: 3 cost time: 0.7292296886444092
Epoch: 3, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.167 Vali Acc: 0.444 Test Loss: 2.167 Test Acc: 0.444
Validation loss decreased (-0.383309 --> -0.444423).  Saving model ...
Epoch: 4 cost time: 0.7349758148193359
Epoch: 4, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.832 Vali Acc: 0.506 Test Loss: 1.832 Test Acc: 0.506
Validation loss decreased (-0.444423 --> -0.505537).  Saving model ...
Epoch: 5 cost time: 0.8959252834320068
Epoch: 5, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.455 Vali Acc: 0.550 Test Loss: 1.455 Test Acc: 0.550
Validation loss decreased (-0.505537 --> -0.549985).  Saving model ...
Epoch: 6 cost time: 0.738152027130127
Epoch: 6, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.216 Vali Acc: 0.594 Test Loss: 1.216 Test Acc: 0.594
Validation loss decreased (-0.549985 --> -0.594432).  Saving model ...
Epoch: 7 cost time: 0.9849321842193604
Epoch: 7, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.125 Vali Acc: 0.594 Test Loss: 1.125 Test Acc: 0.594
Validation loss decreased (-0.594432 --> -0.594433).  Saving model ...
Epoch: 8 cost time: 1.0006871223449707
Epoch: 8, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.011 Vali Acc: 0.661 Test Loss: 1.011 Test Acc: 0.661
Validation loss decreased (-0.594433 --> -0.661101).  Saving model ...
Epoch: 9 cost time: 0.7112588882446289
Epoch: 9, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.007 Vali Acc: 0.672 Test Loss: 1.007 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 0.7112476825714111
Epoch: 10, Steps: 12 | Train Loss: 0.642 Vali Loss: 0.815 Vali Acc: 0.678 Test Loss: 0.815 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677770).  Saving model ...
Epoch: 11 cost time: 0.7093508243560791
Epoch: 11, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.844 Vali Acc: 0.700 Test Loss: 0.844 Test Acc: 0.700
Validation loss decreased (-0.677770 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 0.849891185760498
Epoch: 12, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.859 Vali Acc: 0.689 Test Loss: 0.859 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9529986381530762
Epoch: 13, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.831 Vali Acc: 0.767 Test Loss: 0.831 Test Acc: 0.767
Validation loss decreased (-0.699992 --> -0.766658).  Saving model ...
Epoch: 14 cost time: 1.0050818920135498
Epoch: 14, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.892 Vali Acc: 0.756 Test Loss: 0.892 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9258041381835938
Epoch: 15, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.868 Vali Acc: 0.744 Test Loss: 0.868 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9639978408813477
Epoch: 16, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.932 Vali Acc: 0.778 Test Loss: 0.932 Test Acc: 0.778
Validation loss decreased (-0.766658 --> -0.777768).  Saving model ...
Epoch: 17 cost time: 1.1418342590332031
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.909 Vali Acc: 0.739 Test Loss: 0.909 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9043378829956055
Epoch: 18, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.933 Vali Acc: 0.772 Test Loss: 0.933 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.023542881011963
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.774 Vali Acc: 0.794 Test Loss: 0.774 Test Acc: 0.794
Validation loss decreased (-0.777768 --> -0.794437).  Saving model ...
Epoch: 20 cost time: 1.105309247970581
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.884303092956543
Epoch: 21, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.960 Vali Acc: 0.789 Test Loss: 0.960 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9703192710876465
Epoch: 22, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.929 Vali Acc: 0.794 Test Loss: 0.929 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1426618099212646
Epoch: 23, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.987 Vali Acc: 0.822 Test Loss: 0.987 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822212).  Saving model ...
Epoch: 24 cost time: 0.7394089698791504
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.925 Vali Acc: 0.794 Test Loss: 0.925 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8582110404968262
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.986 Vali Acc: 0.817 Test Loss: 0.986 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9604640007019043
Epoch: 26, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.142 Vali Acc: 0.783 Test Loss: 1.142 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7932388782501221
Epoch: 27, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.974 Vali Acc: 0.806 Test Loss: 0.974 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6251523494720459
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.026 Vali Acc: 0.828 Test Loss: 1.026 Test Acc: 0.828
Validation loss decreased (-0.822212 --> -0.827768).  Saving model ...
Epoch: 29 cost time: 0.7131390571594238
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.010 Vali Acc: 0.822 Test Loss: 1.010 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7566626071929932
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.094 Vali Acc: 0.817 Test Loss: 1.094 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.895500898361206
Epoch: 31, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.928 Vali Acc: 0.833 Test Loss: 0.928 Test Acc: 0.833
Validation loss decreased (-0.827768 --> -0.833324).  Saving model ...
Epoch: 32 cost time: 0.7198300361633301
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.034 Vali Acc: 0.817 Test Loss: 1.034 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6129364967346191
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.151 Vali Acc: 0.783 Test Loss: 1.151 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0814542770385742
Epoch: 34, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.077 Vali Acc: 0.794 Test Loss: 1.077 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.889850378036499
Epoch: 35, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.171 Vali Acc: 0.806 Test Loss: 1.171 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.899298906326294
Epoch: 36, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.109 Vali Acc: 0.833 Test Loss: 1.109 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0823683738708496
Epoch: 37, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.184 Vali Acc: 0.811 Test Loss: 1.184 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.191465139389038
Epoch: 38, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.363 Vali Acc: 0.772 Test Loss: 1.363 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8623173236846924
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.288 Vali Acc: 0.800 Test Loss: 1.288 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.922156572341919
Epoch: 40, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.389 Vali Acc: 0.789 Test Loss: 1.389 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.2684195041656494
Epoch: 41, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.434 Vali Acc: 0.806 Test Loss: 1.434 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 43597839
model size : 180.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.389472246170044
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.620 Vali Acc: 0.161 Test Loss: 2.620 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 0.8802719116210938
Epoch: 2, Steps: 12 | Train Loss: 2.575 Vali Loss: 2.462 Vali Acc: 0.356 Test Loss: 2.462 Test Acc: 0.356
Validation loss decreased (-0.161085 --> -0.355531).  Saving model ...
Epoch: 3 cost time: 0.862886905670166
Epoch: 3, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.257 Vali Acc: 0.483 Test Loss: 2.257 Test Acc: 0.483
Validation loss decreased (-0.355531 --> -0.483311).  Saving model ...
Epoch: 4 cost time: 0.8833918571472168
Epoch: 4, Steps: 12 | Train Loss: 2.139 Vali Loss: 1.979 Vali Acc: 0.494 Test Loss: 1.979 Test Acc: 0.494
Validation loss decreased (-0.483311 --> -0.494425).  Saving model ...
Epoch: 5 cost time: 0.8226938247680664
Epoch: 5, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.633 Vali Acc: 0.544 Test Loss: 1.633 Test Acc: 0.544
Validation loss decreased (-0.494425 --> -0.544428).  Saving model ...
Epoch: 6 cost time: 0.691063404083252
Epoch: 6, Steps: 12 | Train Loss: 1.463 Vali Loss: 1.289 Vali Acc: 0.572 Test Loss: 1.289 Test Acc: 0.572
Validation loss decreased (-0.544428 --> -0.572209).  Saving model ...
Epoch: 7 cost time: 0.7336540222167969
Epoch: 7, Steps: 12 | Train Loss: 1.142 Vali Loss: 1.098 Vali Acc: 0.594 Test Loss: 1.098 Test Acc: 0.594
Validation loss decreased (-0.572209 --> -0.594433).  Saving model ...
Epoch: 8 cost time: 0.8658614158630371
Epoch: 8, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.995 Vali Acc: 0.650 Test Loss: 0.995 Test Acc: 0.650
Validation loss decreased (-0.594433 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.7173571586608887
Epoch: 9, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.881 Vali Acc: 0.672 Test Loss: 0.881 Test Acc: 0.672
Validation loss decreased (-0.649990 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 0.9893782138824463
Epoch: 10, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.831 Vali Acc: 0.706 Test Loss: 0.831 Test Acc: 0.706
Validation loss decreased (-0.672213 --> -0.705547).  Saving model ...
Epoch: 11 cost time: 1.055656909942627
Epoch: 11, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.840 Vali Acc: 0.711 Test Loss: 0.840 Test Acc: 0.711
Validation loss decreased (-0.705547 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 1.0154142379760742
Epoch: 12, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.759 Vali Acc: 0.717 Test Loss: 0.759 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716659).  Saving model ...
Epoch: 13 cost time: 0.9958326816558838
Epoch: 13, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.8815410137176514
Epoch: 14, Steps: 12 | Train Loss: 0.365 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.807147741317749
Epoch: 15, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.831 Vali Acc: 0.739 Test Loss: 0.831 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8841516971588135
Epoch: 16, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.827 Vali Acc: 0.733 Test Loss: 0.827 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.792560338973999
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.793 Vali Acc: 0.783 Test Loss: 0.793 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 0.6652576923370361
Epoch: 18, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
Validation loss decreased (-0.783325 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 0.7226781845092773
Epoch: 19, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.833 Vali Acc: 0.794 Test Loss: 0.833 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794436).  Saving model ...
Epoch: 20 cost time: 0.9299881458282471
Epoch: 20, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.817 Vali Acc: 0.783 Test Loss: 0.817 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.91729736328125
Epoch: 21, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.778 Vali Acc: 0.811 Test Loss: 0.778 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 22 cost time: 0.8803126811981201
Epoch: 22, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.778 Vali Acc: 0.806 Test Loss: 0.778 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0018868446350098
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.801 Vali Acc: 0.817 Test Loss: 0.801 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816659).  Saving model ...
Epoch: 24 cost time: 1.0051295757293701
Epoch: 24, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.858 Vali Acc: 0.794 Test Loss: 0.858 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0432932376861572
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.811 Vali Acc: 0.811 Test Loss: 0.811 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9348654747009277
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.751 Vali Acc: 0.844 Test Loss: 0.751 Test Acc: 0.844
Validation loss decreased (-0.816659 --> -0.844437).  Saving model ...
Epoch: 27 cost time: 0.8735229969024658
Epoch: 27, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.871 Vali Acc: 0.817 Test Loss: 0.871 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8498897552490234
Epoch: 28, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.753 Vali Acc: 0.822 Test Loss: 0.753 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8771083354949951
Epoch: 29, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.784 Vali Acc: 0.839 Test Loss: 0.784 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0782630443572998
Epoch: 30, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.837 Vali Acc: 0.839 Test Loss: 0.837 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8702607154846191
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.753 Vali Acc: 0.861 Test Loss: 0.753 Test Acc: 0.861
Validation loss decreased (-0.844437 --> -0.861104).  Saving model ...
Epoch: 32 cost time: 0.9963791370391846
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.870 Vali Acc: 0.833 Test Loss: 0.870 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9329583644866943
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.875 Vali Acc: 0.833 Test Loss: 0.875 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8890538215637207
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9435245990753174
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.959 Vali Acc: 0.811 Test Loss: 0.959 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6736814975738525
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.878 Vali Acc: 0.833 Test Loss: 0.878 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9620904922485352
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.909 Vali Acc: 0.822 Test Loss: 0.909 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9401860237121582
Epoch: 38, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.951 Vali Acc: 0.833 Test Loss: 0.951 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7453358173370361
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.886 Vali Acc: 0.839 Test Loss: 0.886 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8569974899291992
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.874 Vali Acc: 0.839 Test Loss: 0.874 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8083300590515137
Epoch: 41, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.898 Vali Acc: 0.833 Test Loss: 0.898 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 43532559
model size : 180.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.409048318862915
Epoch: 1, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.674 Vali Acc: 0.083 Test Loss: 2.674 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.8497576713562012
Epoch: 2, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.533 Vali Acc: 0.256 Test Loss: 2.533 Test Acc: 0.256
Validation loss decreased (-0.083307 --> -0.255530).  Saving model ...
Epoch: 3 cost time: 0.9949419498443604
Epoch: 3, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.375 Vali Acc: 0.361 Test Loss: 2.375 Test Acc: 0.361
Validation loss decreased (-0.255530 --> -0.361087).  Saving model ...
Epoch: 4 cost time: 0.8678743839263916
Epoch: 4, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.153 Vali Acc: 0.456 Test Loss: 2.153 Test Acc: 0.456
Validation loss decreased (-0.361087 --> -0.455534).  Saving model ...
Epoch: 5 cost time: 0.8659384250640869
Epoch: 5, Steps: 12 | Train Loss: 2.000 Vali Loss: 1.837 Vali Acc: 0.517 Test Loss: 1.837 Test Acc: 0.517
Validation loss decreased (-0.455534 --> -0.516648).  Saving model ...
Epoch: 6 cost time: 0.9392294883728027
Epoch: 6, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.534 Vali Acc: 0.550 Test Loss: 1.534 Test Acc: 0.550
Validation loss decreased (-0.516648 --> -0.549985).  Saving model ...
Epoch: 7 cost time: 0.756340503692627
Epoch: 7, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.312 Vali Acc: 0.550 Test Loss: 1.312 Test Acc: 0.550
Validation loss decreased (-0.549985 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.7331631183624268
Epoch: 8, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.110 Vali Acc: 0.594 Test Loss: 1.110 Test Acc: 0.594
Validation loss decreased (-0.549987 --> -0.594433).  Saving model ...
Epoch: 9 cost time: 0.7550654411315918
Epoch: 9, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.941 Vali Acc: 0.678 Test Loss: 0.941 Test Acc: 0.678
Validation loss decreased (-0.594433 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 0.8155646324157715
Epoch: 10, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.878 Vali Acc: 0.706 Test Loss: 0.878 Test Acc: 0.706
Validation loss decreased (-0.677768 --> -0.705547).  Saving model ...
Epoch: 11 cost time: 0.7926619052886963
Epoch: 11, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.778 Vali Acc: 0.689 Test Loss: 0.778 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7396571636199951
Epoch: 12, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738882).  Saving model ...
Epoch: 13 cost time: 0.774918794631958
Epoch: 13, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.748 Vali Acc: 0.739 Test Loss: 0.748 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6994636058807373
Epoch: 14, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7601504325866699
Epoch: 15, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.644 Vali Acc: 0.767 Test Loss: 0.644 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766660).  Saving model ...
Epoch: 16 cost time: 0.7265763282775879
Epoch: 16, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.643 Vali Acc: 0.806 Test Loss: 0.643 Test Acc: 0.806
Validation loss decreased (-0.766660 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.835951566696167
Epoch: 17, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.660 Vali Acc: 0.806 Test Loss: 0.660 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7510919570922852
Epoch: 18, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.631 Vali Acc: 0.811 Test Loss: 0.631 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 0.8077747821807861
Epoch: 19, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.713043212890625
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8705856800079346
Epoch: 21, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0074338912963867
Epoch: 22, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.733 Vali Acc: 0.811 Test Loss: 0.733 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8546748161315918
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8146350383758545
Epoch: 24, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.748 Vali Acc: 0.800 Test Loss: 0.748 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8128073215484619
Epoch: 25, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.665 Vali Acc: 0.806 Test Loss: 0.665 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9523491859436035
Epoch: 26, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.720 Vali Acc: 0.817 Test Loss: 0.720 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816659).  Saving model ...
Epoch: 27 cost time: 0.8256375789642334
Epoch: 27, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.690 Vali Acc: 0.828 Test Loss: 0.690 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 28 cost time: 0.8392095565795898
Epoch: 28, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.785 Vali Acc: 0.817 Test Loss: 0.785 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7975971698760986
Epoch: 29, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.719 Vali Acc: 0.833 Test Loss: 0.719 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 30 cost time: 0.8491470813751221
Epoch: 30, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.775 Vali Acc: 0.828 Test Loss: 0.775 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8122463226318359
Epoch: 31, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
Validation loss decreased (-0.833326 --> -0.849992).  Saving model ...
Epoch: 32 cost time: 0.7269606590270996
Epoch: 32, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.5956530570983887
Epoch: 33, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.735 Vali Acc: 0.828 Test Loss: 0.735 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.711035966873169
Epoch: 34, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.763 Vali Acc: 0.839 Test Loss: 0.763 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7333977222442627
Epoch: 35, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.747 Vali Acc: 0.833 Test Loss: 0.747 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7208206653594971
Epoch: 36, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.799 Vali Acc: 0.844 Test Loss: 0.799 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.717907190322876
Epoch: 37, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.743 Vali Acc: 0.833 Test Loss: 0.743 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7334854602813721
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.812 Vali Acc: 0.828 Test Loss: 0.812 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7953190803527832
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.730 Vali Acc: 0.850 Test Loss: 0.730 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8292136192321777
Epoch: 40, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.819 Vali Acc: 0.822 Test Loss: 0.819 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7952330112457275
Epoch: 41, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.777 Vali Acc: 0.850 Test Loss: 0.777 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.738070011138916
Epoch: 42, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.838 Vali Acc: 0.844 Test Loss: 0.838 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 43493391
model size : 180.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.102400064468384
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.477 Vali Acc: 0.272 Test Loss: 2.477 Test Acc: 0.272
Validation loss decreased (inf --> -0.272197).  Saving model ...
Epoch: 2 cost time: 1.3257701396942139
Epoch: 2, Steps: 12 | Train Loss: 2.304 Vali Loss: 1.983 Vali Acc: 0.461 Test Loss: 1.983 Test Acc: 0.461
Validation loss decreased (-0.272197 --> -0.461091).  Saving model ...
Epoch: 3 cost time: 0.8239853382110596
Epoch: 3, Steps: 12 | Train Loss: 1.769 Vali Loss: 1.578 Vali Acc: 0.561 Test Loss: 1.578 Test Acc: 0.561
Validation loss decreased (-0.461091 --> -0.561095).  Saving model ...
Epoch: 4 cost time: 1.5734953880310059
Epoch: 4, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.282 Vali Acc: 0.606 Test Loss: 1.282 Test Acc: 0.606
Validation loss decreased (-0.561095 --> -0.605543).  Saving model ...
Epoch: 5 cost time: 1.7616398334503174
Epoch: 5, Steps: 12 | Train Loss: 1.022 Vali Loss: 1.169 Vali Acc: 0.617 Test Loss: 1.169 Test Acc: 0.617
Validation loss decreased (-0.605543 --> -0.616655).  Saving model ...
Epoch: 6 cost time: 1.4366085529327393
Epoch: 6, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.133 Vali Acc: 0.667 Test Loss: 1.133 Test Acc: 0.667
Validation loss decreased (-0.616655 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 1.4862473011016846
Epoch: 7, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.442 Vali Acc: 0.633 Test Loss: 1.442 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4234552383422852
Epoch: 8, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.364 Vali Acc: 0.622 Test Loss: 1.364 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4285542964935303
Epoch: 9, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.326 Vali Acc: 0.639 Test Loss: 1.326 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5572519302368164
Epoch: 10, Steps: 12 | Train Loss: 0.651 Vali Loss: 1.336 Vali Acc: 0.667 Test Loss: 1.336 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9139072895050049
Epoch: 11, Steps: 12 | Train Loss: 0.541 Vali Loss: 1.144 Vali Acc: 0.700 Test Loss: 1.144 Test Acc: 0.700
Validation loss decreased (-0.666655 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 1.206444263458252
Epoch: 12, Steps: 12 | Train Loss: 0.454 Vali Loss: 1.253 Vali Acc: 0.694 Test Loss: 1.253 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8558852672576904
Epoch: 13, Steps: 12 | Train Loss: 0.399 Vali Loss: 1.489 Vali Acc: 0.711 Test Loss: 1.489 Test Acc: 0.711
Validation loss decreased (-0.699989 --> -0.711096).  Saving model ...
Epoch: 14 cost time: 1.8711767196655273
Epoch: 14, Steps: 12 | Train Loss: 0.335 Vali Loss: 1.556 Vali Acc: 0.700 Test Loss: 1.556 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4718587398529053
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 1.817 Vali Acc: 0.700 Test Loss: 1.817 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4623878002166748
Epoch: 16, Steps: 12 | Train Loss: 0.629 Vali Loss: 2.185 Vali Acc: 0.700 Test Loss: 2.185 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6093127727508545
Epoch: 17, Steps: 12 | Train Loss: 0.738 Vali Loss: 1.854 Vali Acc: 0.661 Test Loss: 1.854 Test Acc: 0.661
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.640401840209961
Epoch: 18, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.887 Vali Acc: 0.700 Test Loss: 1.887 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5390326976776123
Epoch: 19, Steps: 12 | Train Loss: 0.473 Vali Loss: 1.696 Vali Acc: 0.706 Test Loss: 1.696 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6196649074554443
Epoch: 20, Steps: 12 | Train Loss: 0.248 Vali Loss: 1.556 Vali Acc: 0.711 Test Loss: 1.556 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.669112205505371
Epoch: 21, Steps: 12 | Train Loss: 0.230 Vali Loss: 1.689 Vali Acc: 0.717 Test Loss: 1.689 Test Acc: 0.717
Validation loss decreased (-0.711096 --> -0.716650).  Saving model ...
Epoch: 22 cost time: 1.8155357837677002
Epoch: 22, Steps: 12 | Train Loss: 0.269 Vali Loss: 1.850 Vali Acc: 0.722 Test Loss: 1.850 Test Acc: 0.722
Validation loss decreased (-0.716650 --> -0.722204).  Saving model ...
Epoch: 23 cost time: 1.533616065979004
Epoch: 23, Steps: 12 | Train Loss: 0.474 Vali Loss: 1.916 Vali Acc: 0.722 Test Loss: 1.916 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4644546508789062
Epoch: 24, Steps: 12 | Train Loss: 0.133 Vali Loss: 2.632 Vali Acc: 0.678 Test Loss: 2.632 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3993797302246094
Epoch: 25, Steps: 12 | Train Loss: 0.169 Vali Loss: 2.027 Vali Acc: 0.722 Test Loss: 2.027 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.101564645767212
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 2.569 Vali Acc: 0.750 Test Loss: 2.569 Test Acc: 0.750
Validation loss decreased (-0.722204 --> -0.749974).  Saving model ...
Epoch: 27 cost time: 1.441586971282959
Epoch: 27, Steps: 12 | Train Loss: 0.307 Vali Loss: 2.790 Vali Acc: 0.678 Test Loss: 2.790 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5555999279022217
Epoch: 28, Steps: 12 | Train Loss: 0.393 Vali Loss: 2.488 Vali Acc: 0.717 Test Loss: 2.488 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.348006248474121
Epoch: 29, Steps: 12 | Train Loss: 0.447 Vali Loss: 2.519 Vali Acc: 0.706 Test Loss: 2.519 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.205091953277588
Epoch: 30, Steps: 12 | Train Loss: 0.181 Vali Loss: 3.006 Vali Acc: 0.694 Test Loss: 3.006 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4896252155303955
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 3.237 Vali Acc: 0.739 Test Loss: 3.237 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.84763503074646
Epoch: 32, Steps: 12 | Train Loss: 0.266 Vali Loss: 3.297 Vali Acc: 0.711 Test Loss: 3.297 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3102667331695557
Epoch: 33, Steps: 12 | Train Loss: 0.295 Vali Loss: 3.583 Vali Acc: 0.711 Test Loss: 3.583 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6913063526153564
Epoch: 34, Steps: 12 | Train Loss: 0.237 Vali Loss: 4.099 Vali Acc: 0.656 Test Loss: 4.099 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.3593952655792236
Epoch: 35, Steps: 12 | Train Loss: 0.351 Vali Loss: 3.543 Vali Acc: 0.711 Test Loss: 3.543 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6326780319213867
Epoch: 36, Steps: 12 | Train Loss: 0.128 Vali Loss: 3.804 Vali Acc: 0.711 Test Loss: 3.804 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 36882447
model size : 155.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8808836936950684
Epoch: 1, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.618 Vali Acc: 0.239 Test Loss: 2.618 Test Acc: 0.239
Validation loss decreased (inf --> -0.238863).  Saving model ...
Epoch: 2 cost time: 1.2592604160308838
Epoch: 2, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.245 Vali Acc: 0.383 Test Loss: 2.245 Test Acc: 0.383
Validation loss decreased (-0.238863 --> -0.383311).  Saving model ...
Epoch: 3 cost time: 1.3025298118591309
Epoch: 3, Steps: 12 | Train Loss: 2.026 Vali Loss: 1.782 Vali Acc: 0.550 Test Loss: 1.782 Test Acc: 0.550
Validation loss decreased (-0.383311 --> -0.549982).  Saving model ...
Epoch: 4 cost time: 1.2340302467346191
Epoch: 4, Steps: 12 | Train Loss: 1.597 Vali Loss: 1.486 Vali Acc: 0.567 Test Loss: 1.486 Test Acc: 0.567
Validation loss decreased (-0.549982 --> -0.566652).  Saving model ...
Epoch: 5 cost time: 0.9654734134674072
Epoch: 5, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.181 Vali Acc: 0.567 Test Loss: 1.181 Test Acc: 0.567
Validation loss decreased (-0.566652 --> -0.566655).  Saving model ...
Epoch: 6 cost time: 1.271679401397705
Epoch: 6, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.090 Vali Acc: 0.622 Test Loss: 1.090 Test Acc: 0.622
Validation loss decreased (-0.566655 --> -0.622211).  Saving model ...
Epoch: 7 cost time: 0.6725564002990723
Epoch: 7, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.002 Vali Acc: 0.639 Test Loss: 1.002 Test Acc: 0.639
Validation loss decreased (-0.622211 --> -0.638879).  Saving model ...
Epoch: 8 cost time: 1.0371606349945068
Epoch: 8, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.061 Vali Acc: 0.656 Test Loss: 1.061 Test Acc: 0.656
Validation loss decreased (-0.638879 --> -0.655545).  Saving model ...
Epoch: 9 cost time: 1.2951748371124268
Epoch: 9, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.192 Vali Acc: 0.661 Test Loss: 1.192 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661099).  Saving model ...
Epoch: 10 cost time: 0.7481446266174316
Epoch: 10, Steps: 12 | Train Loss: 0.630 Vali Loss: 1.077 Vali Acc: 0.683 Test Loss: 1.077 Test Acc: 0.683
Validation loss decreased (-0.661099 --> -0.683323).  Saving model ...
Epoch: 11 cost time: 1.328993320465088
Epoch: 11, Steps: 12 | Train Loss: 0.428 Vali Loss: 1.095 Vali Acc: 0.694 Test Loss: 1.095 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 1.1094908714294434
Epoch: 12, Steps: 12 | Train Loss: 0.375 Vali Loss: 1.165 Vali Acc: 0.667 Test Loss: 1.165 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3115479946136475
Epoch: 13, Steps: 12 | Train Loss: 0.595 Vali Loss: 1.067 Vali Acc: 0.706 Test Loss: 1.067 Test Acc: 0.706
Validation loss decreased (-0.694433 --> -0.705545).  Saving model ...
Epoch: 14 cost time: 1.2814812660217285
Epoch: 14, Steps: 12 | Train Loss: 0.490 Vali Loss: 1.017 Vali Acc: 0.756 Test Loss: 1.017 Test Acc: 0.756
Validation loss decreased (-0.705545 --> -0.755545).  Saving model ...
Epoch: 15 cost time: 1.4853858947753906
Epoch: 15, Steps: 12 | Train Loss: 0.258 Vali Loss: 1.275 Vali Acc: 0.683 Test Loss: 1.275 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1637420654296875
Epoch: 16, Steps: 12 | Train Loss: 0.373 Vali Loss: 1.266 Vali Acc: 0.717 Test Loss: 1.266 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5089428424835205
Epoch: 17, Steps: 12 | Train Loss: 0.326 Vali Loss: 1.234 Vali Acc: 0.706 Test Loss: 1.234 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4073102474212646
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.281 Vali Acc: 0.711 Test Loss: 1.281 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4486587047576904
Epoch: 19, Steps: 12 | Train Loss: 0.253 Vali Loss: 1.298 Vali Acc: 0.733 Test Loss: 1.298 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9801180362701416
Epoch: 20, Steps: 12 | Train Loss: 0.252 Vali Loss: 1.326 Vali Acc: 0.778 Test Loss: 1.326 Test Acc: 0.778
Validation loss decreased (-0.755545 --> -0.777765).  Saving model ...
Epoch: 21 cost time: 1.3746180534362793
Epoch: 21, Steps: 12 | Train Loss: 0.151 Vali Loss: 1.263 Vali Acc: 0.733 Test Loss: 1.263 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.22914719581604
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.401 Vali Acc: 0.722 Test Loss: 1.401 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9085757732391357
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 1.253 Vali Acc: 0.789 Test Loss: 1.253 Test Acc: 0.789
Validation loss decreased (-0.777765 --> -0.788876).  Saving model ...
Epoch: 24 cost time: 1.3072643280029297
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.415 Vali Acc: 0.728 Test Loss: 1.415 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2901630401611328
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.646 Vali Acc: 0.739 Test Loss: 1.646 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9871518611907959
Epoch: 26, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.706 Vali Acc: 0.733 Test Loss: 1.706 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5680689811706543
Epoch: 27, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.679 Vali Acc: 0.750 Test Loss: 1.679 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2923412322998047
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.619 Vali Acc: 0.750 Test Loss: 1.619 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5332555770874023
Epoch: 29, Steps: 12 | Train Loss: 0.133 Vali Loss: 2.140 Vali Acc: 0.750 Test Loss: 2.140 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.027165412902832
Epoch: 30, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.809 Vali Acc: 0.778 Test Loss: 1.809 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2735798358917236
Epoch: 31, Steps: 12 | Train Loss: 0.228 Vali Loss: 1.701 Vali Acc: 0.767 Test Loss: 1.701 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1222171783447266
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.726 Vali Acc: 0.767 Test Loss: 1.726 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0648736953735352
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.966 Vali Acc: 0.761 Test Loss: 1.966 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 36595215
model size : 154.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.51381254196167
Epoch: 1, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.547 Vali Acc: 0.217 Test Loss: 2.547 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 1.3772656917572021
Epoch: 2, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.055 Vali Acc: 0.489 Test Loss: 2.055 Test Acc: 0.489
Validation loss decreased (-0.216641 --> -0.488868).  Saving model ...
Epoch: 3 cost time: 1.7931764125823975
Epoch: 3, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.614 Vali Acc: 0.594 Test Loss: 1.614 Test Acc: 0.594
Validation loss decreased (-0.488868 --> -0.594428).  Saving model ...
Epoch: 4 cost time: 1.9386048316955566
Epoch: 4, Steps: 12 | Train Loss: 1.339 Vali Loss: 1.487 Vali Acc: 0.511 Test Loss: 1.487 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8490402698516846
Epoch: 5, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
Validation loss decreased (-0.594428 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 1.8153746128082275
Epoch: 6, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.025 Vali Acc: 0.611 Test Loss: 1.025 Test Acc: 0.611
Validation loss decreased (-0.599987 --> -0.611101).  Saving model ...
Epoch: 7 cost time: 1.5291857719421387
Epoch: 7, Steps: 12 | Train Loss: 0.801 Vali Loss: 0.965 Vali Acc: 0.644 Test Loss: 0.965 Test Acc: 0.644
Validation loss decreased (-0.611101 --> -0.644435).  Saving model ...
Epoch: 8 cost time: 1.746138095855713
Epoch: 8, Steps: 12 | Train Loss: 0.627 Vali Loss: 0.972 Vali Acc: 0.717 Test Loss: 0.972 Test Acc: 0.717
Validation loss decreased (-0.644435 --> -0.716657).  Saving model ...
Epoch: 9 cost time: 1.7307889461517334
Epoch: 9, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.134 Vali Acc: 0.678 Test Loss: 1.134 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6049771308898926
Epoch: 10, Steps: 12 | Train Loss: 0.491 Vali Loss: 1.205 Vali Acc: 0.694 Test Loss: 1.205 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7045140266418457
Epoch: 11, Steps: 12 | Train Loss: 0.525 Vali Loss: 1.045 Vali Acc: 0.706 Test Loss: 1.045 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8826687335968018
Epoch: 12, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.929 Vali Acc: 0.761 Test Loss: 0.929 Test Acc: 0.761
Validation loss decreased (-0.716657 --> -0.761102).  Saving model ...
Epoch: 13 cost time: 1.4796156883239746
Epoch: 13, Steps: 12 | Train Loss: 0.415 Vali Loss: 1.589 Vali Acc: 0.689 Test Loss: 1.589 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6202080249786377
Epoch: 14, Steps: 12 | Train Loss: 0.388 Vali Loss: 1.261 Vali Acc: 0.739 Test Loss: 1.261 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6475300788879395
Epoch: 15, Steps: 12 | Train Loss: 0.315 Vali Loss: 1.673 Vali Acc: 0.689 Test Loss: 1.673 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6561720371246338
Epoch: 16, Steps: 12 | Train Loss: 0.371 Vali Loss: 1.693 Vali Acc: 0.711 Test Loss: 1.693 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.752091646194458
Epoch: 17, Steps: 12 | Train Loss: 0.412 Vali Loss: 1.614 Vali Acc: 0.744 Test Loss: 1.614 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8611793518066406
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 1.697 Vali Acc: 0.706 Test Loss: 1.697 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9442131519317627
Epoch: 19, Steps: 12 | Train Loss: 0.333 Vali Loss: 2.286 Vali Acc: 0.694 Test Loss: 2.286 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8724699020385742
Epoch: 20, Steps: 12 | Train Loss: 0.257 Vali Loss: 2.350 Vali Acc: 0.683 Test Loss: 2.350 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0603277683258057
Epoch: 21, Steps: 12 | Train Loss: 0.424 Vali Loss: 1.845 Vali Acc: 0.728 Test Loss: 1.845 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.037588119506836
Epoch: 22, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.907 Vali Acc: 0.700 Test Loss: 1.907 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 36873999
model size : 155.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3849685192108154
Epoch: 1, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.578 Vali Acc: 0.244 Test Loss: 2.578 Test Acc: 0.244
Validation loss decreased (inf --> -0.244419).  Saving model ...
Epoch: 2 cost time: 1.1852173805236816
Epoch: 2, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.262 Vali Acc: 0.433 Test Loss: 2.262 Test Acc: 0.433
Validation loss decreased (-0.244419 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 1.2746081352233887
Epoch: 3, Steps: 12 | Train Loss: 2.056 Vali Loss: 1.901 Vali Acc: 0.500 Test Loss: 1.901 Test Acc: 0.500
Validation loss decreased (-0.433311 --> -0.499981).  Saving model ...
Epoch: 4 cost time: 1.404132604598999
Epoch: 4, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.556 Vali Acc: 0.528 Test Loss: 1.556 Test Acc: 0.528
Validation loss decreased (-0.499981 --> -0.527762).  Saving model ...
Epoch: 5 cost time: 1.241004228591919
Epoch: 5, Steps: 12 | Train Loss: 1.268 Vali Loss: 1.301 Vali Acc: 0.578 Test Loss: 1.301 Test Acc: 0.578
Validation loss decreased (-0.527762 --> -0.577765).  Saving model ...
Epoch: 6 cost time: 1.491215467453003
Epoch: 6, Steps: 12 | Train Loss: 1.042 Vali Loss: 1.040 Vali Acc: 0.661 Test Loss: 1.040 Test Acc: 0.661
Validation loss decreased (-0.577765 --> -0.661101).  Saving model ...
Epoch: 7 cost time: 1.5888936519622803
Epoch: 7, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.094 Vali Acc: 0.639 Test Loss: 1.094 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5680131912231445
Epoch: 8, Steps: 12 | Train Loss: 0.770 Vali Loss: 1.051 Vali Acc: 0.672 Test Loss: 1.051 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672212).  Saving model ...
Epoch: 9 cost time: 1.020442008972168
Epoch: 9, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.962 Vali Acc: 0.711 Test Loss: 0.962 Test Acc: 0.711
Validation loss decreased (-0.672212 --> -0.711101).  Saving model ...
Epoch: 10 cost time: 1.0204792022705078
Epoch: 10, Steps: 12 | Train Loss: 0.588 Vali Loss: 0.937 Vali Acc: 0.661 Test Loss: 0.937 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9348127841949463
Epoch: 11, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.905 Vali Acc: 0.739 Test Loss: 0.905 Test Acc: 0.739
Validation loss decreased (-0.711101 --> -0.738880).  Saving model ...
Epoch: 12 cost time: 0.8026444911956787
Epoch: 12, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.088 Vali Acc: 0.700 Test Loss: 1.088 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1376450061798096
Epoch: 13, Steps: 12 | Train Loss: 0.412 Vali Loss: 1.238 Vali Acc: 0.694 Test Loss: 1.238 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1176831722259521
Epoch: 14, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.982 Vali Acc: 0.772 Test Loss: 0.982 Test Acc: 0.772
Validation loss decreased (-0.738880 --> -0.772212).  Saving model ...
Epoch: 15 cost time: 1.305546522140503
Epoch: 15, Steps: 12 | Train Loss: 0.286 Vali Loss: 1.238 Vali Acc: 0.728 Test Loss: 1.238 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3261992931365967
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 1.069 Vali Acc: 0.717 Test Loss: 1.069 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5702354907989502
Epoch: 17, Steps: 12 | Train Loss: 0.288 Vali Loss: 1.058 Vali Acc: 0.778 Test Loss: 1.058 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777767).  Saving model ...
Epoch: 18 cost time: 1.599867343902588
Epoch: 18, Steps: 12 | Train Loss: 0.250 Vali Loss: 1.496 Vali Acc: 0.728 Test Loss: 1.496 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5872838497161865
Epoch: 19, Steps: 12 | Train Loss: 0.276 Vali Loss: 1.328 Vali Acc: 0.744 Test Loss: 1.328 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.555126428604126
Epoch: 20, Steps: 12 | Train Loss: 0.235 Vali Loss: 1.219 Vali Acc: 0.756 Test Loss: 1.219 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4222140312194824
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.405 Vali Acc: 0.767 Test Loss: 1.405 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.049759864807129
Epoch: 22, Steps: 12 | Train Loss: 0.228 Vali Loss: 1.289 Vali Acc: 0.750 Test Loss: 1.289 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5928864479064941
Epoch: 23, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.107 Vali Acc: 0.778 Test Loss: 1.107 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6029338836669922
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.296 Vali Acc: 0.761 Test Loss: 1.296 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5952706336975098
Epoch: 25, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.405 Vali Acc: 0.756 Test Loss: 1.405 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1439547538757324
Epoch: 26, Steps: 12 | Train Loss: 0.164 Vali Loss: 1.369 Vali Acc: 0.761 Test Loss: 1.369 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.23335599899292
Epoch: 27, Steps: 12 | Train Loss: 0.178 Vali Loss: 1.439 Vali Acc: 0.767 Test Loss: 1.439 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 36599823
model size : 154.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.283466100692749
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.599 Vali Acc: 0.156 Test Loss: 2.599 Test Acc: 0.156
Validation loss decreased (inf --> -0.155530).  Saving model ...
Epoch: 2 cost time: 0.7931206226348877
Epoch: 2, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.393 Vali Acc: 0.372 Test Loss: 2.393 Test Acc: 0.372
Validation loss decreased (-0.155530 --> -0.372198).  Saving model ...
Epoch: 3 cost time: 0.8066575527191162
Epoch: 3, Steps: 12 | Train Loss: 2.298 Vali Loss: 2.082 Vali Acc: 0.533 Test Loss: 2.082 Test Acc: 0.533
Validation loss decreased (-0.372198 --> -0.533313).  Saving model ...
Epoch: 4 cost time: 0.9747259616851807
Epoch: 4, Steps: 12 | Train Loss: 1.921 Vali Loss: 1.718 Vali Acc: 0.606 Test Loss: 1.718 Test Acc: 0.606
Validation loss decreased (-0.533313 --> -0.605538).  Saving model ...
Epoch: 5 cost time: 1.0458157062530518
Epoch: 5, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.373 Vali Acc: 0.611 Test Loss: 1.373 Test Acc: 0.611
Validation loss decreased (-0.605538 --> -0.611097).  Saving model ...
Epoch: 6 cost time: 0.9940400123596191
Epoch: 6, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.144 Vali Acc: 0.617 Test Loss: 1.144 Test Acc: 0.617
Validation loss decreased (-0.611097 --> -0.616655).  Saving model ...
Epoch: 7 cost time: 1.195692539215088
Epoch: 7, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.001 Vali Acc: 0.594 Test Loss: 1.001 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8787841796875
Epoch: 8, Steps: 12 | Train Loss: 0.770 Vali Loss: 0.913 Vali Acc: 0.672 Test Loss: 0.913 Test Acc: 0.672
Validation loss decreased (-0.616655 --> -0.672213).  Saving model ...
Epoch: 9 cost time: 1.00020432472229
Epoch: 9, Steps: 12 | Train Loss: 0.599 Vali Loss: 0.994 Vali Acc: 0.661 Test Loss: 0.994 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.063051700592041
Epoch: 10, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.912 Vali Acc: 0.722 Test Loss: 0.912 Test Acc: 0.722
Validation loss decreased (-0.672213 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 1.027193307876587
Epoch: 11, Steps: 12 | Train Loss: 0.519 Vali Loss: 1.031 Vali Acc: 0.733 Test Loss: 1.031 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733323).  Saving model ...
Epoch: 12 cost time: 0.8745801448822021
Epoch: 12, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.893 Vali Acc: 0.739 Test Loss: 0.893 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738880).  Saving model ...
Epoch: 13 cost time: 0.8302032947540283
Epoch: 13, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.874 Vali Acc: 0.778 Test Loss: 0.874 Test Acc: 0.778
Validation loss decreased (-0.738880 --> -0.777769).  Saving model ...
Epoch: 14 cost time: 0.962456226348877
Epoch: 14, Steps: 12 | Train Loss: 0.265 Vali Loss: 1.014 Vali Acc: 0.728 Test Loss: 1.014 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9122862815856934
Epoch: 15, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.070 Vali Acc: 0.750 Test Loss: 1.070 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6819057464599609
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.977 Vali Acc: 0.761 Test Loss: 0.977 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8058567047119141
Epoch: 17, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.031 Vali Acc: 0.767 Test Loss: 1.031 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9706563949584961
Epoch: 18, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.990 Vali Acc: 0.761 Test Loss: 0.990 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0409913063049316
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.956 Vali Acc: 0.794 Test Loss: 0.956 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794435).  Saving model ...
Epoch: 20 cost time: 0.7522060871124268
Epoch: 20, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.961 Vali Acc: 0.761 Test Loss: 0.961 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8872053623199463
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.140 Vali Acc: 0.744 Test Loss: 1.140 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.927868127822876
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.005 Vali Acc: 0.778 Test Loss: 1.005 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7093207836151123
Epoch: 23, Steps: 12 | Train Loss: 0.164 Vali Loss: 1.306 Vali Acc: 0.778 Test Loss: 1.306 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5707216262817383
Epoch: 24, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.122 Vali Acc: 0.789 Test Loss: 1.122 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7108526229858398
Epoch: 25, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.209 Vali Acc: 0.789 Test Loss: 1.209 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6792449951171875
Epoch: 26, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.119 Vali Acc: 0.783 Test Loss: 1.119 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7841005325317383
Epoch: 27, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.426 Vali Acc: 0.750 Test Loss: 1.426 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8680071830749512
Epoch: 28, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.076 Vali Acc: 0.789 Test Loss: 1.076 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9463093280792236
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.266 Vali Acc: 0.789 Test Loss: 1.266 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 36508431
model size : 153.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1901535987854004
Epoch: 1, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.486 Vali Acc: 0.261 Test Loss: 2.486 Test Acc: 0.261
Validation loss decreased (inf --> -0.261086).  Saving model ...
Epoch: 2 cost time: 1.2057139873504639
Epoch: 2, Steps: 12 | Train Loss: 2.319 Vali Loss: 1.908 Vali Acc: 0.461 Test Loss: 1.908 Test Acc: 0.461
Validation loss decreased (-0.261086 --> -0.461092).  Saving model ...
Epoch: 3 cost time: 1.1618571281433105
Epoch: 3, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.521 Vali Acc: 0.539 Test Loss: 1.521 Test Acc: 0.539
Validation loss decreased (-0.461092 --> -0.538874).  Saving model ...
Epoch: 4 cost time: 1.411694049835205
Epoch: 4, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.258 Vali Acc: 0.556 Test Loss: 1.258 Test Acc: 0.556
Validation loss decreased (-0.538874 --> -0.555543).  Saving model ...
Epoch: 5 cost time: 1.6872994899749756
Epoch: 5, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.321 Vali Acc: 0.556 Test Loss: 1.321 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.363213062286377
Epoch: 6, Steps: 12 | Train Loss: 0.929 Vali Loss: 1.228 Vali Acc: 0.628 Test Loss: 1.228 Test Acc: 0.628
Validation loss decreased (-0.555543 --> -0.627765).  Saving model ...
Epoch: 7 cost time: 1.4682323932647705
Epoch: 7, Steps: 12 | Train Loss: 0.712 Vali Loss: 1.142 Vali Acc: 0.639 Test Loss: 1.142 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 8 cost time: 1.459073543548584
Epoch: 8, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.276 Vali Acc: 0.678 Test Loss: 1.276 Test Acc: 0.678
Validation loss decreased (-0.638877 --> -0.677765).  Saving model ...
Epoch: 9 cost time: 1.360776424407959
Epoch: 9, Steps: 12 | Train Loss: 0.650 Vali Loss: 1.190 Vali Acc: 0.706 Test Loss: 1.190 Test Acc: 0.706
Validation loss decreased (-0.677765 --> -0.705544).  Saving model ...
Epoch: 10 cost time: 1.4338037967681885
Epoch: 10, Steps: 12 | Train Loss: 0.527 Vali Loss: 1.150 Vali Acc: 0.717 Test Loss: 1.150 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716655).  Saving model ...
Epoch: 11 cost time: 1.3124175071716309
Epoch: 11, Steps: 12 | Train Loss: 0.395 Vali Loss: 1.147 Vali Acc: 0.711 Test Loss: 1.147 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2611870765686035
Epoch: 12, Steps: 12 | Train Loss: 0.455 Vali Loss: 1.317 Vali Acc: 0.717 Test Loss: 1.317 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3402221202850342
Epoch: 13, Steps: 12 | Train Loss: 0.418 Vali Loss: 1.843 Vali Acc: 0.644 Test Loss: 1.843 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5965230464935303
Epoch: 14, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.705 Vali Acc: 0.700 Test Loss: 1.705 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5977778434753418
Epoch: 15, Steps: 12 | Train Loss: 0.450 Vali Loss: 1.417 Vali Acc: 0.728 Test Loss: 1.417 Test Acc: 0.728
Validation loss decreased (-0.716655 --> -0.727764).  Saving model ...
Epoch: 16 cost time: 1.4368054866790771
Epoch: 16, Steps: 12 | Train Loss: 0.534 Vali Loss: 1.880 Vali Acc: 0.644 Test Loss: 1.880 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6339030265808105
Epoch: 17, Steps: 12 | Train Loss: 0.310 Vali Loss: 1.725 Vali Acc: 0.678 Test Loss: 1.725 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2230944633483887
Epoch: 18, Steps: 12 | Train Loss: 0.400 Vali Loss: 2.027 Vali Acc: 0.700 Test Loss: 2.027 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8524281978607178
Epoch: 19, Steps: 12 | Train Loss: 0.395 Vali Loss: 1.759 Vali Acc: 0.700 Test Loss: 1.759 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4046542644500732
Epoch: 20, Steps: 12 | Train Loss: 0.425 Vali Loss: 1.990 Vali Acc: 0.711 Test Loss: 1.990 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2590408325195312
Epoch: 21, Steps: 12 | Train Loss: 0.440 Vali Loss: 2.311 Vali Acc: 0.717 Test Loss: 2.311 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3136873245239258
Epoch: 22, Steps: 12 | Train Loss: 0.544 Vali Loss: 2.027 Vali Acc: 0.761 Test Loss: 2.027 Test Acc: 0.761
Validation loss decreased (-0.727764 --> -0.761091).  Saving model ...
Epoch: 23 cost time: 1.423473596572876
Epoch: 23, Steps: 12 | Train Loss: 0.512 Vali Loss: 2.501 Vali Acc: 0.672 Test Loss: 2.501 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1401314735412598
Epoch: 24, Steps: 12 | Train Loss: 0.493 Vali Loss: 1.954 Vali Acc: 0.756 Test Loss: 1.954 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4514873027801514
Epoch: 25, Steps: 12 | Train Loss: 0.179 Vali Loss: 2.275 Vali Acc: 0.739 Test Loss: 2.275 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3783111572265625
Epoch: 26, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.951 Vali Acc: 0.711 Test Loss: 1.951 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.492917776107788
Epoch: 27, Steps: 12 | Train Loss: 0.156 Vali Loss: 2.058 Vali Acc: 0.722 Test Loss: 2.058 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2474713325500488
Epoch: 28, Steps: 12 | Train Loss: 0.228 Vali Loss: 2.089 Vali Acc: 0.761 Test Loss: 2.089 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1866767406463623
Epoch: 29, Steps: 12 | Train Loss: 0.110 Vali Loss: 2.008 Vali Acc: 0.767 Test Loss: 2.008 Test Acc: 0.767
Validation loss decreased (-0.761091 --> -0.766647).  Saving model ...
Epoch: 30 cost time: 1.24623703956604
Epoch: 30, Steps: 12 | Train Loss: 0.127 Vali Loss: 2.491 Vali Acc: 0.744 Test Loss: 2.491 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4301376342773438
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 2.524 Vali Acc: 0.689 Test Loss: 2.524 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3219661712646484
Epoch: 32, Steps: 12 | Train Loss: 0.221 Vali Loss: 2.921 Vali Acc: 0.733 Test Loss: 2.921 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.316772699356079
Epoch: 33, Steps: 12 | Train Loss: 0.178 Vali Loss: 2.616 Vali Acc: 0.694 Test Loss: 2.616 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0286483764648438
Epoch: 34, Steps: 12 | Train Loss: 0.330 Vali Loss: 3.104 Vali Acc: 0.700 Test Loss: 3.104 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.281073808670044
Epoch: 35, Steps: 12 | Train Loss: 0.145 Vali Loss: 3.181 Vali Acc: 0.717 Test Loss: 3.181 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1434528827667236
Epoch: 36, Steps: 12 | Train Loss: 0.292 Vali Loss: 3.380 Vali Acc: 0.700 Test Loss: 3.380 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3196532726287842
Epoch: 37, Steps: 12 | Train Loss: 0.162 Vali Loss: 3.459 Vali Acc: 0.733 Test Loss: 3.459 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9748680591583252
Epoch: 38, Steps: 12 | Train Loss: 0.167 Vali Loss: 3.770 Vali Acc: 0.700 Test Loss: 3.770 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.215872049331665
Epoch: 39, Steps: 12 | Train Loss: 0.140 Vali Loss: 3.443 Vali Acc: 0.722 Test Loss: 3.443 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 36865551
model size : 155.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.9738540649414062
Epoch: 1, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.606 Vali Acc: 0.211 Test Loss: 2.606 Test Acc: 0.211
Validation loss decreased (inf --> -0.211085).  Saving model ...
Epoch: 2 cost time: 0.9976506233215332
Epoch: 2, Steps: 12 | Train Loss: 2.473 Vali Loss: 2.262 Vali Acc: 0.372 Test Loss: 2.262 Test Acc: 0.372
Validation loss decreased (-0.211085 --> -0.372200).  Saving model ...
Epoch: 3 cost time: 1.0071978569030762
Epoch: 3, Steps: 12 | Train Loss: 1.996 Vali Loss: 1.806 Vali Acc: 0.517 Test Loss: 1.806 Test Acc: 0.517
Validation loss decreased (-0.372200 --> -0.516649).  Saving model ...
Epoch: 4 cost time: 0.9831058979034424
Epoch: 4, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.443 Vali Acc: 0.539 Test Loss: 1.443 Test Acc: 0.539
Validation loss decreased (-0.516649 --> -0.538874).  Saving model ...
Epoch: 5 cost time: 1.0463249683380127
Epoch: 5, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.213 Vali Acc: 0.544 Test Loss: 1.213 Test Acc: 0.544
Validation loss decreased (-0.538874 --> -0.544432).  Saving model ...
Epoch: 6 cost time: 1.0639820098876953
Epoch: 6, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.072 Vali Acc: 0.583 Test Loss: 1.072 Test Acc: 0.583
Validation loss decreased (-0.544432 --> -0.583323).  Saving model ...
Epoch: 7 cost time: 0.6613106727600098
Epoch: 7, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.976 Vali Acc: 0.661 Test Loss: 0.976 Test Acc: 0.661
Validation loss decreased (-0.583323 --> -0.661101).  Saving model ...
Epoch: 8 cost time: 0.9030978679656982
Epoch: 8, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.993 Vali Acc: 0.656 Test Loss: 0.993 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8490602970123291
Epoch: 9, Steps: 12 | Train Loss: 0.592 Vali Loss: 1.114 Vali Acc: 0.661 Test Loss: 1.114 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9780807495117188
Epoch: 10, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.965 Vali Acc: 0.689 Test Loss: 0.965 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688879).  Saving model ...
Epoch: 11 cost time: 1.1728620529174805
Epoch: 11, Steps: 12 | Train Loss: 0.467 Vali Loss: 1.141 Vali Acc: 0.672 Test Loss: 1.141 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9800584316253662
Epoch: 12, Steps: 12 | Train Loss: 0.465 Vali Loss: 1.035 Vali Acc: 0.733 Test Loss: 1.035 Test Acc: 0.733
Validation loss decreased (-0.688879 --> -0.733323).  Saving model ...
Epoch: 13 cost time: 1.1564500331878662
Epoch: 13, Steps: 12 | Train Loss: 0.341 Vali Loss: 1.167 Vali Acc: 0.744 Test Loss: 1.167 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744433).  Saving model ...
Epoch: 14 cost time: 1.132713794708252
Epoch: 14, Steps: 12 | Train Loss: 0.330 Vali Loss: 1.026 Vali Acc: 0.772 Test Loss: 1.026 Test Acc: 0.772
Validation loss decreased (-0.744433 --> -0.772212).  Saving model ...
Epoch: 15 cost time: 1.1950719356536865
Epoch: 15, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.970 Vali Acc: 0.800 Test Loss: 0.970 Test Acc: 0.800
Validation loss decreased (-0.772212 --> -0.799990).  Saving model ...
Epoch: 16 cost time: 1.1827528476715088
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.086 Vali Acc: 0.750 Test Loss: 1.086 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0558876991271973
Epoch: 17, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.272 Vali Acc: 0.750 Test Loss: 1.272 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1121714115142822
Epoch: 18, Steps: 12 | Train Loss: 0.278 Vali Loss: 1.373 Vali Acc: 0.750 Test Loss: 1.373 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.963935136795044
Epoch: 19, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.250 Vali Acc: 0.722 Test Loss: 1.250 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0366532802581787
Epoch: 20, Steps: 12 | Train Loss: 0.370 Vali Loss: 1.342 Vali Acc: 0.728 Test Loss: 1.342 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1031851768493652
Epoch: 21, Steps: 12 | Train Loss: 0.287 Vali Loss: 1.342 Vali Acc: 0.744 Test Loss: 1.342 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.037743091583252
Epoch: 22, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.204 Vali Acc: 0.800 Test Loss: 1.204 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1341698169708252
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.315 Vali Acc: 0.761 Test Loss: 1.315 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.146178960800171
Epoch: 24, Steps: 12 | Train Loss: 0.130 Vali Loss: 1.184 Vali Acc: 0.789 Test Loss: 1.184 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.192897081375122
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.561 Vali Acc: 0.733 Test Loss: 1.561 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 36591375
model size : 154.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.232313632965088
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.667 Vali Acc: 0.139 Test Loss: 2.667 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.9097254276275635
Epoch: 2, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.399 Vali Acc: 0.406 Test Loss: 2.399 Test Acc: 0.406
Validation loss decreased (-0.138862 --> -0.405532).  Saving model ...
Epoch: 3 cost time: 0.7853362560272217
Epoch: 3, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.126 Vali Acc: 0.500 Test Loss: 2.126 Test Acc: 0.500
Validation loss decreased (-0.405532 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 0.9404020309448242
Epoch: 4, Steps: 12 | Train Loss: 1.971 Vali Loss: 1.786 Vali Acc: 0.544 Test Loss: 1.786 Test Acc: 0.544
Validation loss decreased (-0.499979 --> -0.544427).  Saving model ...
Epoch: 5 cost time: 0.7701973915100098
Epoch: 5, Steps: 12 | Train Loss: 1.538 Vali Loss: 1.371 Vali Acc: 0.567 Test Loss: 1.371 Test Acc: 0.567
Validation loss decreased (-0.544427 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 1.1009032726287842
Epoch: 6, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.145 Vali Acc: 0.628 Test Loss: 1.145 Test Acc: 0.628
Validation loss decreased (-0.566653 --> -0.627766).  Saving model ...
Epoch: 7 cost time: 1.021470546722412
Epoch: 7, Steps: 12 | Train Loss: 1.052 Vali Loss: 1.006 Vali Acc: 0.644 Test Loss: 1.006 Test Acc: 0.644
Validation loss decreased (-0.627766 --> -0.644434).  Saving model ...
Epoch: 8 cost time: 0.9310810565948486
Epoch: 8, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.899 Vali Acc: 0.617 Test Loss: 0.899 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9002203941345215
Epoch: 9, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.885 Vali Acc: 0.700 Test Loss: 0.885 Test Acc: 0.700
Validation loss decreased (-0.644434 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.8124752044677734
Epoch: 10, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.844 Vali Acc: 0.711 Test Loss: 0.844 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 1.0355312824249268
Epoch: 11, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
Validation loss decreased (-0.711103 --> -0.755548).  Saving model ...
Epoch: 12 cost time: 0.9064345359802246
Epoch: 12, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.803 Vali Acc: 0.756 Test Loss: 0.803 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7490444183349609
Epoch: 13, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.881 Vali Acc: 0.728 Test Loss: 0.881 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8151366710662842
Epoch: 14, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.816 Vali Acc: 0.767 Test Loss: 0.816 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.9539713859558105
Epoch: 15, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.843 Vali Acc: 0.767 Test Loss: 0.843 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7998194694519043
Epoch: 16, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.839 Vali Acc: 0.761 Test Loss: 0.839 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8917720317840576
Epoch: 17, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.817 Vali Acc: 0.778 Test Loss: 0.817 Test Acc: 0.778
Validation loss decreased (-0.766659 --> -0.777770).  Saving model ...
Epoch: 18 cost time: 0.9560000896453857
Epoch: 18, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.916 Vali Acc: 0.772 Test Loss: 0.916 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7294306755065918
Epoch: 19, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.869 Vali Acc: 0.772 Test Loss: 0.869 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7071666717529297
Epoch: 20, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.068 Vali Acc: 0.761 Test Loss: 1.068 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.900341272354126
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.877 Vali Acc: 0.806 Test Loss: 0.877 Test Acc: 0.806
Validation loss decreased (-0.777770 --> -0.805547).  Saving model ...
Epoch: 22 cost time: 0.9362154006958008
Epoch: 22, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.900 Vali Acc: 0.794 Test Loss: 0.900 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0702776908874512
Epoch: 23, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.940 Vali Acc: 0.783 Test Loss: 0.940 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8140358924865723
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.953 Vali Acc: 0.789 Test Loss: 0.953 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9059083461761475
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.047 Vali Acc: 0.789 Test Loss: 1.047 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7286701202392578
Epoch: 26, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.017 Vali Acc: 0.817 Test Loss: 1.017 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816656).  Saving model ...
Epoch: 27 cost time: 0.9992129802703857
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.170 Vali Acc: 0.772 Test Loss: 1.170 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7685208320617676
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.061 Vali Acc: 0.806 Test Loss: 1.061 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7000017166137695
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.061 Vali Acc: 0.778 Test Loss: 1.061 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5855011940002441
Epoch: 30, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.079 Vali Acc: 0.800 Test Loss: 1.079 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5522854328155518
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.036 Vali Acc: 0.833 Test Loss: 1.036 Test Acc: 0.833
Validation loss decreased (-0.816656 --> -0.833323).  Saving model ...
Epoch: 32 cost time: 1.1530728340148926
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.022 Vali Acc: 0.800 Test Loss: 1.022 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.126387357711792
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.154 Vali Acc: 0.794 Test Loss: 1.154 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9551243782043457
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.085 Vali Acc: 0.794 Test Loss: 1.085 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8384466171264648
Epoch: 35, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.043 Vali Acc: 0.828 Test Loss: 1.043 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0440747737884521
Epoch: 36, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.045 Vali Acc: 0.817 Test Loss: 1.045 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9569249153137207
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.203 Vali Acc: 0.800 Test Loss: 1.203 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0620980262756348
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.092 Vali Acc: 0.800 Test Loss: 1.092 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8871932029724121
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.241 Vali Acc: 0.794 Test Loss: 1.241 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.154787540435791
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.146 Vali Acc: 0.806 Test Loss: 1.146 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9552505016326904
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.102 Vali Acc: 0.833 Test Loss: 1.102 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 36460815
model size : 153.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8669075965881348
Epoch: 1, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.622 Vali Acc: 0.150 Test Loss: 2.622 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 1.0415887832641602
Epoch: 2, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.299 Vali Acc: 0.411 Test Loss: 2.299 Test Acc: 0.411
Validation loss decreased (-0.149974 --> -0.411088).  Saving model ...
Epoch: 3 cost time: 1.4352154731750488
Epoch: 3, Steps: 12 | Train Loss: 2.110 Vali Loss: 1.913 Vali Acc: 0.517 Test Loss: 1.913 Test Acc: 0.517
Validation loss decreased (-0.411088 --> -0.516648).  Saving model ...
Epoch: 4 cost time: 1.5927903652191162
Epoch: 4, Steps: 12 | Train Loss: 1.691 Vali Loss: 1.590 Vali Acc: 0.556 Test Loss: 1.590 Test Acc: 0.556
Validation loss decreased (-0.516648 --> -0.555540).  Saving model ...
Epoch: 5 cost time: 1.1985998153686523
Epoch: 5, Steps: 12 | Train Loss: 1.260 Vali Loss: 1.321 Vali Acc: 0.583 Test Loss: 1.321 Test Acc: 0.583
Validation loss decreased (-0.555540 --> -0.583320).  Saving model ...
Epoch: 6 cost time: 0.9829909801483154
Epoch: 6, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.264 Vali Acc: 0.594 Test Loss: 1.264 Test Acc: 0.594
Validation loss decreased (-0.583320 --> -0.594432).  Saving model ...
Epoch: 7 cost time: 1.5238285064697266
Epoch: 7, Steps: 12 | Train Loss: 0.796 Vali Loss: 1.096 Vali Acc: 0.650 Test Loss: 1.096 Test Acc: 0.650
Validation loss decreased (-0.594432 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 1.5338711738586426
Epoch: 8, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.163 Vali Acc: 0.678 Test Loss: 1.163 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677766).  Saving model ...
Epoch: 9 cost time: 1.1992926597595215
Epoch: 9, Steps: 12 | Train Loss: 0.621 Vali Loss: 1.163 Vali Acc: 0.683 Test Loss: 1.163 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 10 cost time: 1.4420335292816162
Epoch: 10, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.093 Vali Acc: 0.706 Test Loss: 1.093 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705545).  Saving model ...
Epoch: 11 cost time: 1.2371695041656494
Epoch: 11, Steps: 12 | Train Loss: 0.461 Vali Loss: 1.049 Vali Acc: 0.683 Test Loss: 1.049 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2489242553710938
Epoch: 12, Steps: 12 | Train Loss: 0.447 Vali Loss: 1.194 Vali Acc: 0.672 Test Loss: 1.194 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3009378910064697
Epoch: 13, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.281 Vali Acc: 0.683 Test Loss: 1.281 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9072446823120117
Epoch: 14, Steps: 12 | Train Loss: 0.312 Vali Loss: 1.121 Vali Acc: 0.706 Test Loss: 1.121 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.184624195098877
Epoch: 15, Steps: 12 | Train Loss: 0.365 Vali Loss: 1.332 Vali Acc: 0.694 Test Loss: 1.332 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0245351791381836
Epoch: 16, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.237 Vali Acc: 0.722 Test Loss: 1.237 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722210).  Saving model ...
Epoch: 17 cost time: 1.106663465499878
Epoch: 17, Steps: 12 | Train Loss: 0.340 Vali Loss: 1.270 Vali Acc: 0.722 Test Loss: 1.270 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0140247344970703
Epoch: 18, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.328 Vali Acc: 0.689 Test Loss: 1.328 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.346484661102295
Epoch: 19, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.395 Vali Acc: 0.728 Test Loss: 1.395 Test Acc: 0.728
Validation loss decreased (-0.722210 --> -0.727764).  Saving model ...
Epoch: 20 cost time: 1.5065116882324219
Epoch: 20, Steps: 12 | Train Loss: 0.298 Vali Loss: 1.532 Vali Acc: 0.711 Test Loss: 1.532 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3503201007843018
Epoch: 21, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.496 Vali Acc: 0.756 Test Loss: 1.496 Test Acc: 0.756
Validation loss decreased (-0.727764 --> -0.755541).  Saving model ...
Epoch: 22 cost time: 1.4738502502441406
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.646 Vali Acc: 0.711 Test Loss: 1.646 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6089296340942383
Epoch: 23, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.572 Vali Acc: 0.694 Test Loss: 1.572 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4302895069122314
Epoch: 24, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.610 Vali Acc: 0.772 Test Loss: 1.610 Test Acc: 0.772
Validation loss decreased (-0.755541 --> -0.772206).  Saving model ...
Epoch: 25 cost time: 1.684854507446289
Epoch: 25, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.369 Vali Acc: 0.772 Test Loss: 1.369 Test Acc: 0.772
Validation loss decreased (-0.772206 --> -0.772209).  Saving model ...
Epoch: 26 cost time: 1.7110438346862793
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.842 Vali Acc: 0.733 Test Loss: 1.842 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1854972839355469
Epoch: 27, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.547 Vali Acc: 0.750 Test Loss: 1.547 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0813069343566895
Epoch: 28, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.867 Vali Acc: 0.761 Test Loss: 1.867 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3250758647918701
Epoch: 29, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.621 Vali Acc: 0.772 Test Loss: 1.621 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.083418607711792
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.722 Vali Acc: 0.767 Test Loss: 1.722 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9997801780700684
Epoch: 31, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.839 Vali Acc: 0.689 Test Loss: 1.839 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2401962280273438
Epoch: 32, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.721 Vali Acc: 0.783 Test Loss: 1.721 Test Acc: 0.783
Validation loss decreased (-0.772209 --> -0.783316).  Saving model ...
Epoch: 33 cost time: 1.5601282119750977
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.816 Vali Acc: 0.744 Test Loss: 1.816 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.601306438446045
Epoch: 34, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.850 Vali Acc: 0.767 Test Loss: 1.850 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1666383743286133
Epoch: 35, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.832 Vali Acc: 0.778 Test Loss: 1.832 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0380010604858398
Epoch: 36, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.728 Vali Acc: 0.778 Test Loss: 1.728 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1386253833770752
Epoch: 37, Steps: 12 | Train Loss: 0.074 Vali Loss: 2.295 Vali Acc: 0.750 Test Loss: 2.295 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9207189083099365
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.759 Vali Acc: 0.750 Test Loss: 1.759 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.09543776512146
Epoch: 39, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.941 Vali Acc: 0.761 Test Loss: 1.941 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1628391742706299
Epoch: 40, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.840 Vali Acc: 0.772 Test Loss: 1.840 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8643672466278076
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 2.121 Vali Acc: 0.744 Test Loss: 2.121 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8776288032531738
Epoch: 42, Steps: 12 | Train Loss: 0.011 Vali Loss: 2.031 Vali Acc: 0.756 Test Loss: 2.031 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 36595983
model size : 154.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4261317253112793
Epoch: 1, Steps: 12 | Train Loss: 2.816 Vali Loss: 2.611 Vali Acc: 0.094 Test Loss: 2.611 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 0.8413987159729004
Epoch: 2, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.404 Vali Acc: 0.361 Test Loss: 2.404 Test Acc: 0.361
Validation loss decreased (-0.094418 --> -0.361087).  Saving model ...
Epoch: 3 cost time: 1.0614087581634521
Epoch: 3, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.092 Vali Acc: 0.550 Test Loss: 2.092 Test Acc: 0.550
Validation loss decreased (-0.361087 --> -0.549979).  Saving model ...
Epoch: 4 cost time: 0.8700873851776123
Epoch: 4, Steps: 12 | Train Loss: 1.926 Vali Loss: 1.759 Vali Acc: 0.556 Test Loss: 1.759 Test Acc: 0.556
Validation loss decreased (-0.549979 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 0.9756793975830078
Epoch: 5, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.484 Vali Acc: 0.561 Test Loss: 1.484 Test Acc: 0.561
Validation loss decreased (-0.555538 --> -0.561096).  Saving model ...
Epoch: 6 cost time: 0.9069914817810059
Epoch: 6, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.317 Vali Acc: 0.561 Test Loss: 1.317 Test Acc: 0.561
Validation loss decreased (-0.561096 --> -0.561098).  Saving model ...
Epoch: 7 cost time: 0.6482298374176025
Epoch: 7, Steps: 12 | Train Loss: 1.029 Vali Loss: 1.160 Vali Acc: 0.589 Test Loss: 1.160 Test Acc: 0.589
Validation loss decreased (-0.561098 --> -0.588877).  Saving model ...
Epoch: 8 cost time: 0.838388204574585
Epoch: 8, Steps: 12 | Train Loss: 0.777 Vali Loss: 1.101 Vali Acc: 0.644 Test Loss: 1.101 Test Acc: 0.644
Validation loss decreased (-0.588877 --> -0.644433).  Saving model ...
Epoch: 9 cost time: 0.8575742244720459
Epoch: 9, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.106 Vali Acc: 0.611 Test Loss: 1.106 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8371045589447021
Epoch: 10, Steps: 12 | Train Loss: 0.517 Vali Loss: 1.092 Vali Acc: 0.639 Test Loss: 1.092 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9153714179992676
Epoch: 11, Steps: 12 | Train Loss: 0.465 Vali Loss: 1.039 Vali Acc: 0.617 Test Loss: 1.039 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7224917411804199
Epoch: 12, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.987 Vali Acc: 0.678 Test Loss: 0.987 Test Acc: 0.678
Validation loss decreased (-0.644433 --> -0.677768).  Saving model ...
Epoch: 13 cost time: 0.9908576011657715
Epoch: 13, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.966 Vali Acc: 0.717 Test Loss: 0.966 Test Acc: 0.717
Validation loss decreased (-0.677768 --> -0.716657).  Saving model ...
Epoch: 14 cost time: 0.8515615463256836
Epoch: 14, Steps: 12 | Train Loss: 0.286 Vali Loss: 1.092 Vali Acc: 0.694 Test Loss: 1.092 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6616041660308838
Epoch: 15, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.934 Vali Acc: 0.744 Test Loss: 0.934 Test Acc: 0.744
Validation loss decreased (-0.716657 --> -0.744435).  Saving model ...
Epoch: 16 cost time: 0.9617962837219238
Epoch: 16, Steps: 12 | Train Loss: 0.277 Vali Loss: 1.053 Vali Acc: 0.761 Test Loss: 1.053 Test Acc: 0.761
Validation loss decreased (-0.744435 --> -0.761101).  Saving model ...
Epoch: 17 cost time: 0.9037771224975586
Epoch: 17, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.111 Vali Acc: 0.700 Test Loss: 1.111 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0238170623779297
Epoch: 18, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.042 Vali Acc: 0.772 Test Loss: 1.042 Test Acc: 0.772
Validation loss decreased (-0.761101 --> -0.772212).  Saving model ...
Epoch: 19 cost time: 0.8399021625518799
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.073 Vali Acc: 0.728 Test Loss: 1.073 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.985236406326294
Epoch: 20, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.243 Vali Acc: 0.694 Test Loss: 1.243 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9980959892272949
Epoch: 21, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.102 Vali Acc: 0.761 Test Loss: 1.102 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8008811473846436
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.163 Vali Acc: 0.772 Test Loss: 1.163 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9596140384674072
Epoch: 23, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.310 Vali Acc: 0.722 Test Loss: 1.310 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.024726390838623
Epoch: 24, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.144 Vali Acc: 0.767 Test Loss: 1.144 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0704381465911865
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.279 Vali Acc: 0.744 Test Loss: 1.279 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.977931022644043
Epoch: 26, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.237 Vali Acc: 0.778 Test Loss: 1.237 Test Acc: 0.778
Validation loss decreased (-0.772212 --> -0.777765).  Saving model ...
Epoch: 27 cost time: 0.8373987674713135
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.389 Vali Acc: 0.750 Test Loss: 1.389 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7298591136932373
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.382 Vali Acc: 0.750 Test Loss: 1.382 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9774346351623535
Epoch: 29, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.486 Vali Acc: 0.733 Test Loss: 1.486 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9485948085784912
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.596 Vali Acc: 0.722 Test Loss: 1.596 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7900142669677734
Epoch: 31, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.328 Vali Acc: 0.761 Test Loss: 1.328 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7506194114685059
Epoch: 32, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.522 Vali Acc: 0.783 Test Loss: 1.522 Test Acc: 0.783
Validation loss decreased (-0.777765 --> -0.783318).  Saving model ...
Epoch: 33 cost time: 0.6476120948791504
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.356 Vali Acc: 0.778 Test Loss: 1.356 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6510095596313477
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.366 Vali Acc: 0.783 Test Loss: 1.366 Test Acc: 0.783
Validation loss decreased (-0.783318 --> -0.783320).  Saving model ...
Epoch: 35 cost time: 1.061004400253296
Epoch: 35, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.444 Vali Acc: 0.778 Test Loss: 1.444 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0004050731658936
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.545 Vali Acc: 0.761 Test Loss: 1.545 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6852424144744873
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.424 Vali Acc: 0.761 Test Loss: 1.424 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.939279317855835
Epoch: 38, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.692 Vali Acc: 0.772 Test Loss: 1.692 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7334091663360596
Epoch: 39, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.637 Vali Acc: 0.783 Test Loss: 1.637 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7425127029418945
Epoch: 40, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.487 Vali Acc: 0.778 Test Loss: 1.487 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8517673015594482
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.450 Vali Acc: 0.794 Test Loss: 1.450 Test Acc: 0.794
Validation loss decreased (-0.783320 --> -0.794430).  Saving model ...
Epoch: 42 cost time: 1.0054969787597656
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.536 Vali Acc: 0.789 Test Loss: 1.536 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8227787017822266
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.566 Vali Acc: 0.778 Test Loss: 1.566 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0011541843414307
Epoch: 44, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.503 Vali Acc: 0.778 Test Loss: 1.503 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8181462287902832
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.508 Vali Acc: 0.800 Test Loss: 1.508 Test Acc: 0.800
Validation loss decreased (-0.794430 --> -0.799985).  Saving model ...
Epoch: 46 cost time: 0.9993917942047119
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.501 Vali Acc: 0.783 Test Loss: 1.501 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.924375057220459
Epoch: 47, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.576 Vali Acc: 0.789 Test Loss: 1.576 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9412417411804199
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.551 Vali Acc: 0.794 Test Loss: 1.551 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6950314044952393
Epoch: 49, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.548 Vali Acc: 0.806 Test Loss: 1.548 Test Acc: 0.806
Validation loss decreased (-0.799985 --> -0.805540).  Saving model ...
Epoch: 50 cost time: 0.9913763999938965
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.386 Vali Acc: 0.828 Test Loss: 1.386 Test Acc: 0.828
Validation loss decreased (-0.805540 --> -0.827764).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 36504591
model size : 153.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1958768367767334
Epoch: 1, Steps: 12 | Train Loss: 2.734 Vali Loss: 2.619 Vali Acc: 0.100 Test Loss: 2.619 Test Acc: 0.100
Validation loss decreased (inf --> -0.099974).  Saving model ...
Epoch: 2 cost time: 0.6735296249389648
Epoch: 2, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.435 Vali Acc: 0.289 Test Loss: 2.435 Test Acc: 0.289
Validation loss decreased (-0.099974 --> -0.288865).  Saving model ...
Epoch: 3 cost time: 0.7585446834564209
Epoch: 3, Steps: 12 | Train Loss: 2.333 Vali Loss: 2.218 Vali Acc: 0.472 Test Loss: 2.218 Test Acc: 0.472
Validation loss decreased (-0.288865 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 0.6793866157531738
Epoch: 4, Steps: 12 | Train Loss: 2.057 Vali Loss: 1.953 Vali Acc: 0.489 Test Loss: 1.953 Test Acc: 0.489
Validation loss decreased (-0.472200 --> -0.488869).  Saving model ...
Epoch: 5 cost time: 0.8604669570922852
Epoch: 5, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.647 Vali Acc: 0.511 Test Loss: 1.647 Test Acc: 0.511
Validation loss decreased (-0.488869 --> -0.511095).  Saving model ...
Epoch: 6 cost time: 0.7817440032958984
Epoch: 6, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.428 Vali Acc: 0.533 Test Loss: 1.428 Test Acc: 0.533
Validation loss decreased (-0.511095 --> -0.533319).  Saving model ...
Epoch: 7 cost time: 0.7265939712524414
Epoch: 7, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.208 Vali Acc: 0.567 Test Loss: 1.208 Test Acc: 0.567
Validation loss decreased (-0.533319 --> -0.566655).  Saving model ...
Epoch: 8 cost time: 0.7667140960693359
Epoch: 8, Steps: 12 | Train Loss: 0.944 Vali Loss: 1.061 Vali Acc: 0.617 Test Loss: 1.061 Test Acc: 0.617
Validation loss decreased (-0.566655 --> -0.616656).  Saving model ...
Epoch: 9 cost time: 0.8194994926452637
Epoch: 9, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.970 Vali Acc: 0.656 Test Loss: 0.970 Test Acc: 0.656
Validation loss decreased (-0.616656 --> -0.655546).  Saving model ...
Epoch: 10 cost time: 0.6829085350036621
Epoch: 10, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.934 Vali Acc: 0.694 Test Loss: 0.934 Test Acc: 0.694
Validation loss decreased (-0.655546 --> -0.694435).  Saving model ...
Epoch: 11 cost time: 0.6586520671844482
Epoch: 11, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.919 Vali Acc: 0.711 Test Loss: 0.919 Test Acc: 0.711
Validation loss decreased (-0.694435 --> -0.711102).  Saving model ...
Epoch: 12 cost time: 0.610004186630249
Epoch: 12, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.884 Vali Acc: 0.733 Test Loss: 0.884 Test Acc: 0.733
Validation loss decreased (-0.711102 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 0.7382256984710693
Epoch: 13, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.847 Vali Acc: 0.761 Test Loss: 0.847 Test Acc: 0.761
Validation loss decreased (-0.733324 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.7849364280700684
Epoch: 14, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.835 Vali Acc: 0.761 Test Loss: 0.835 Test Acc: 0.761
Validation loss decreased (-0.761103 --> -0.761103).  Saving model ...
Epoch: 15 cost time: 0.7433979511260986
Epoch: 15, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.791 Vali Acc: 0.794 Test Loss: 0.791 Test Acc: 0.794
Validation loss decreased (-0.761103 --> -0.794437).  Saving model ...
Epoch: 16 cost time: 0.8174512386322021
Epoch: 16, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.808 Vali Acc: 0.794 Test Loss: 0.808 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7009463310241699
Epoch: 17, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.934 Vali Acc: 0.789 Test Loss: 0.934 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6603665351867676
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6028444766998291
Epoch: 19, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.014 Vali Acc: 0.772 Test Loss: 1.014 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6599242687225342
Epoch: 20, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.7844550609588623
Epoch: 21, Steps: 12 | Train Loss: 0.131 Vali Loss: 1.034 Vali Acc: 0.778 Test Loss: 1.034 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7308578491210938
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.877 Vali Acc: 0.811 Test Loss: 0.877 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811102).  Saving model ...
Epoch: 23 cost time: 0.7069954872131348
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.950 Vali Acc: 0.817 Test Loss: 0.950 Test Acc: 0.817
Validation loss decreased (-0.811102 --> -0.816657).  Saving model ...
Epoch: 24 cost time: 0.6313157081604004
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.934 Vali Acc: 0.794 Test Loss: 0.934 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5689084529876709
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.002 Vali Acc: 0.817 Test Loss: 1.002 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.543459415435791
Epoch: 26, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.850 Vali Acc: 0.828 Test Loss: 0.850 Test Acc: 0.828
Validation loss decreased (-0.816657 --> -0.827769).  Saving model ...
Epoch: 27 cost time: 0.6467311382293701
Epoch: 27, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.960 Vali Acc: 0.856 Test Loss: 0.960 Test Acc: 0.856
Validation loss decreased (-0.827769 --> -0.855546).  Saving model ...
Epoch: 28 cost time: 0.6444563865661621
Epoch: 28, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.036 Vali Acc: 0.844 Test Loss: 1.036 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5826129913330078
Epoch: 29, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.011 Vali Acc: 0.850 Test Loss: 1.011 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6939873695373535
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.051 Vali Acc: 0.794 Test Loss: 1.051 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7169055938720703
Epoch: 31, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.034 Vali Acc: 0.850 Test Loss: 1.034 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7763500213623047
Epoch: 32, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.046 Vali Acc: 0.806 Test Loss: 1.046 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7067890167236328
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.999 Vali Acc: 0.839 Test Loss: 0.999 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.618044376373291
Epoch: 34, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.013 Vali Acc: 0.817 Test Loss: 1.013 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6545124053955078
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.034 Vali Acc: 0.839 Test Loss: 1.034 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7701926231384277
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.021 Vali Acc: 0.833 Test Loss: 1.021 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7464573383331299
Epoch: 37, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.082 Vali Acc: 0.850 Test Loss: 1.082 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 36439311
model size : 153.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1860108375549316
Epoch: 1, Steps: 12 | Train Loss: 2.803 Vali Loss: 2.592 Vali Acc: 0.222 Test Loss: 2.592 Test Acc: 0.222
Validation loss decreased (inf --> -0.222196).  Saving model ...
Epoch: 2 cost time: 0.9977245330810547
Epoch: 2, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.285 Vali Acc: 0.417 Test Loss: 2.285 Test Acc: 0.417
Validation loss decreased (-0.222196 --> -0.416644).  Saving model ...
Epoch: 3 cost time: 0.6766314506530762
Epoch: 3, Steps: 12 | Train Loss: 2.092 Vali Loss: 1.872 Vali Acc: 0.472 Test Loss: 1.872 Test Acc: 0.472
Validation loss decreased (-0.416644 --> -0.472204).  Saving model ...
Epoch: 4 cost time: 1.1153783798217773
Epoch: 4, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.538 Vali Acc: 0.578 Test Loss: 1.538 Test Acc: 0.578
Validation loss decreased (-0.472204 --> -0.577762).  Saving model ...
Epoch: 5 cost time: 0.868211030960083
Epoch: 5, Steps: 12 | Train Loss: 1.264 Vali Loss: 1.255 Vali Acc: 0.589 Test Loss: 1.255 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588876).  Saving model ...
Epoch: 6 cost time: 0.8661332130432129
Epoch: 6, Steps: 12 | Train Loss: 1.068 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.588876 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 1.3010523319244385
Epoch: 7, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.035 Vali Acc: 0.678 Test Loss: 1.035 Test Acc: 0.678
Validation loss decreased (-0.599988 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 1.0630218982696533
Epoch: 8, Steps: 12 | Train Loss: 0.638 Vali Loss: 1.044 Vali Acc: 0.644 Test Loss: 1.044 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1834251880645752
Epoch: 9, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.972 Vali Acc: 0.683 Test Loss: 0.972 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 1.1956231594085693
Epoch: 10, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.946 Vali Acc: 0.739 Test Loss: 0.946 Test Acc: 0.739
Validation loss decreased (-0.683324 --> -0.738879).  Saving model ...
Epoch: 11 cost time: 1.5934743881225586
Epoch: 11, Steps: 12 | Train Loss: 0.449 Vali Loss: 1.031 Vali Acc: 0.672 Test Loss: 1.031 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1315836906433105
Epoch: 12, Steps: 12 | Train Loss: 0.453 Vali Loss: 1.081 Vali Acc: 0.672 Test Loss: 1.081 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.320490837097168
Epoch: 13, Steps: 12 | Train Loss: 0.381 Vali Loss: 1.350 Vali Acc: 0.661 Test Loss: 1.350 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5532941818237305
Epoch: 14, Steps: 12 | Train Loss: 0.402 Vali Loss: 1.041 Vali Acc: 0.706 Test Loss: 1.041 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2615456581115723
Epoch: 15, Steps: 12 | Train Loss: 0.439 Vali Loss: 1.168 Vali Acc: 0.739 Test Loss: 1.168 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3071136474609375
Epoch: 16, Steps: 12 | Train Loss: 0.356 Vali Loss: 1.041 Vali Acc: 0.744 Test Loss: 1.041 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744434).  Saving model ...
Epoch: 17 cost time: 0.9361400604248047
Epoch: 17, Steps: 12 | Train Loss: 0.245 Vali Loss: 1.233 Vali Acc: 0.722 Test Loss: 1.233 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9672174453735352
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 1.107 Vali Acc: 0.783 Test Loss: 1.107 Test Acc: 0.783
Validation loss decreased (-0.744434 --> -0.783322).  Saving model ...
Epoch: 19 cost time: 0.9798381328582764
Epoch: 19, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.111 Vali Acc: 0.756 Test Loss: 1.111 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9402592182159424
Epoch: 20, Steps: 12 | Train Loss: 0.209 Vali Loss: 1.247 Vali Acc: 0.756 Test Loss: 1.247 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6954965591430664
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.159 Vali Acc: 0.756 Test Loss: 1.159 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0602293014526367
Epoch: 22, Steps: 12 | Train Loss: 0.273 Vali Loss: 1.354 Vali Acc: 0.778 Test Loss: 1.354 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9108572006225586
Epoch: 23, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.200 Vali Acc: 0.750 Test Loss: 1.200 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1023519039154053
Epoch: 24, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.640 Vali Acc: 0.722 Test Loss: 1.640 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.916452169418335
Epoch: 25, Steps: 12 | Train Loss: 0.210 Vali Loss: 1.434 Vali Acc: 0.767 Test Loss: 1.434 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7742748260498047
Epoch: 26, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.546 Vali Acc: 0.756 Test Loss: 1.546 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9395394325256348
Epoch: 27, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.694 Vali Acc: 0.761 Test Loss: 1.694 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8976640701293945
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.625 Vali Acc: 0.722 Test Loss: 1.625 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7833333333333333
model parameter : 36587535
model size : 154.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.308185338973999
Epoch: 1, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.641 Vali Acc: 0.139 Test Loss: 2.641 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.6434628963470459
Epoch: 2, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.407 Vali Acc: 0.422 Test Loss: 2.407 Test Acc: 0.422
Validation loss decreased (-0.138862 --> -0.422198).  Saving model ...
Epoch: 3 cost time: 0.8466241359710693
Epoch: 3, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.080 Vali Acc: 0.511 Test Loss: 2.080 Test Acc: 0.511
Validation loss decreased (-0.422198 --> -0.511090).  Saving model ...
Epoch: 4 cost time: 0.768695592880249
Epoch: 4, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.703 Vali Acc: 0.578 Test Loss: 1.703 Test Acc: 0.578
Validation loss decreased (-0.511090 --> -0.577761).  Saving model ...
Epoch: 5 cost time: 0.8417034149169922
Epoch: 5, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.396 Vali Acc: 0.561 Test Loss: 1.396 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7802033424377441
Epoch: 6, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.217 Vali Acc: 0.561 Test Loss: 1.217 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6508004665374756
Epoch: 7, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.577761 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.7723565101623535
Epoch: 8, Steps: 12 | Train Loss: 0.814 Vali Loss: 0.920 Vali Acc: 0.667 Test Loss: 0.920 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 0.7632966041564941
Epoch: 9, Steps: 12 | Train Loss: 0.553 Vali Loss: 0.929 Vali Acc: 0.683 Test Loss: 0.929 Test Acc: 0.683
Validation loss decreased (-0.666657 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 0.8134021759033203
Epoch: 10, Steps: 12 | Train Loss: 0.675 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
Validation loss decreased (-0.683324 --> -0.716657).  Saving model ...
Epoch: 11 cost time: 0.802215576171875
Epoch: 11, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.888 Vali Acc: 0.700 Test Loss: 0.888 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7595713138580322
Epoch: 12, Steps: 12 | Train Loss: 0.434 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7140800952911377
Epoch: 13, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.928 Vali Acc: 0.711 Test Loss: 0.928 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8295490741729736
Epoch: 14, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.949 Vali Acc: 0.761 Test Loss: 0.949 Test Acc: 0.761
Validation loss decreased (-0.716657 --> -0.761102).  Saving model ...
Epoch: 15 cost time: 0.7407739162445068
Epoch: 15, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.943 Vali Acc: 0.772 Test Loss: 0.943 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 16 cost time: 0.7384493350982666
Epoch: 16, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.883 Vali Acc: 0.756 Test Loss: 0.883 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8727695941925049
Epoch: 17, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.772213 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.6354119777679443
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.002 Vali Acc: 0.761 Test Loss: 1.002 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6365292072296143
Epoch: 19, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.860 Vali Acc: 0.822 Test Loss: 0.860 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 0.8530690670013428
Epoch: 20, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.934 Vali Acc: 0.850 Test Loss: 0.934 Test Acc: 0.850
Validation loss decreased (-0.822214 --> -0.849991).  Saving model ...
Epoch: 21 cost time: 0.7192115783691406
Epoch: 21, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.989 Vali Acc: 0.794 Test Loss: 0.989 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6787738800048828
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.966 Vali Acc: 0.811 Test Loss: 0.966 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.053729772567749
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.089 Vali Acc: 0.789 Test Loss: 1.089 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9458191394805908
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.022 Vali Acc: 0.844 Test Loss: 1.022 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8071227073669434
Epoch: 25, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.035 Vali Acc: 0.806 Test Loss: 1.035 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.701383113861084
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.059 Vali Acc: 0.811 Test Loss: 1.059 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8343632221221924
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.104 Vali Acc: 0.772 Test Loss: 1.104 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0390043258666992
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.284 Vali Acc: 0.767 Test Loss: 1.284 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.016934871673584
Epoch: 29, Steps: 12 | Train Loss: 0.096 Vali Loss: 1.100 Vali Acc: 0.817 Test Loss: 1.100 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8021562099456787
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.258 Vali Acc: 0.772 Test Loss: 1.258 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 36509199
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0185000896453857
Epoch: 1, Steps: 12 | Train Loss: 2.881 Vali Loss: 2.698 Vali Acc: 0.161 Test Loss: 2.698 Test Acc: 0.161
Validation loss decreased (inf --> -0.161084).  Saving model ...
Epoch: 2 cost time: 0.5814027786254883
Epoch: 2, Steps: 12 | Train Loss: 2.656 Vali Loss: 2.516 Vali Acc: 0.317 Test Loss: 2.516 Test Acc: 0.317
Validation loss decreased (-0.161084 --> -0.316642).  Saving model ...
Epoch: 3 cost time: 0.7272894382476807
Epoch: 3, Steps: 12 | Train Loss: 2.459 Vali Loss: 2.303 Vali Acc: 0.450 Test Loss: 2.303 Test Acc: 0.450
Validation loss decreased (-0.316642 --> -0.449977).  Saving model ...
Epoch: 4 cost time: 0.7412869930267334
Epoch: 4, Steps: 12 | Train Loss: 2.189 Vali Loss: 2.022 Vali Acc: 0.550 Test Loss: 2.022 Test Acc: 0.550
Validation loss decreased (-0.449977 --> -0.549980).  Saving model ...
Epoch: 5 cost time: 0.8201243877410889
Epoch: 5, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.679 Vali Acc: 0.522 Test Loss: 1.679 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9515707492828369
Epoch: 6, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.414 Vali Acc: 0.561 Test Loss: 1.414 Test Acc: 0.561
Validation loss decreased (-0.549980 --> -0.561097).  Saving model ...
Epoch: 7 cost time: 0.6455605030059814
Epoch: 7, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.196 Vali Acc: 0.606 Test Loss: 1.196 Test Acc: 0.606
Validation loss decreased (-0.561097 --> -0.605544).  Saving model ...
Epoch: 8 cost time: 0.8406989574432373
Epoch: 8, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.042 Vali Acc: 0.617 Test Loss: 1.042 Test Acc: 0.617
Validation loss decreased (-0.605544 --> -0.616656).  Saving model ...
Epoch: 9 cost time: 0.6958861351013184
Epoch: 9, Steps: 12 | Train Loss: 0.808 Vali Loss: 0.889 Vali Acc: 0.661 Test Loss: 0.889 Test Acc: 0.661
Validation loss decreased (-0.616656 --> -0.661102).  Saving model ...
Epoch: 10 cost time: 0.8238706588745117
Epoch: 10, Steps: 12 | Train Loss: 0.749 Vali Loss: 0.864 Vali Acc: 0.689 Test Loss: 0.864 Test Acc: 0.689
Validation loss decreased (-0.661102 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 0.8261978626251221
Epoch: 11, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.761 Vali Acc: 0.711 Test Loss: 0.761 Test Acc: 0.711
Validation loss decreased (-0.688880 --> -0.711104).  Saving model ...
Epoch: 12 cost time: 0.9295039176940918
Epoch: 12, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.764 Vali Acc: 0.733 Test Loss: 0.764 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733326).  Saving model ...
Epoch: 13 cost time: 0.7192895412445068
Epoch: 13, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.673 Vali Acc: 0.778 Test Loss: 0.673 Test Acc: 0.778
Validation loss decreased (-0.733326 --> -0.777771).  Saving model ...
Epoch: 14 cost time: 0.7466623783111572
Epoch: 14, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.660 Vali Acc: 0.772 Test Loss: 0.660 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.595569372177124
Epoch: 15, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.715 Vali Acc: 0.756 Test Loss: 0.715 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7174677848815918
Epoch: 16, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.624 Vali Acc: 0.817 Test Loss: 0.624 Test Acc: 0.817
Validation loss decreased (-0.777771 --> -0.816660).  Saving model ...
Epoch: 17 cost time: 0.9795279502868652
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.727 Vali Acc: 0.778 Test Loss: 0.727 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.800872802734375
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.670 Vali Acc: 0.811 Test Loss: 0.670 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9503617286682129
Epoch: 19, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.706 Vali Acc: 0.833 Test Loss: 0.706 Test Acc: 0.833
Validation loss decreased (-0.816660 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 0.9860014915466309
Epoch: 20, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.632 Vali Acc: 0.817 Test Loss: 0.632 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8715810775756836
Epoch: 21, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.715 Vali Acc: 0.833 Test Loss: 0.715 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7404496669769287
Epoch: 22, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.671 Vali Acc: 0.828 Test Loss: 0.671 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6825559139251709
Epoch: 23, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.790 Vali Acc: 0.817 Test Loss: 0.790 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6318891048431396
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.719 Vali Acc: 0.817 Test Loss: 0.719 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6929371356964111
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7209734916687012
Epoch: 26, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.788 Vali Acc: 0.844 Test Loss: 0.788 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 27 cost time: 0.6795761585235596
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.764 Vali Acc: 0.806 Test Loss: 0.764 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7267045974731445
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.934 Vali Acc: 0.822 Test Loss: 0.934 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8108689785003662
Epoch: 29, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.978 Vali Acc: 0.778 Test Loss: 0.978 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6589608192443848
Epoch: 30, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.783 Vali Acc: 0.822 Test Loss: 0.783 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7072393894195557
Epoch: 31, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.844 Vali Acc: 0.822 Test Loss: 0.844 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8763432502746582
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7342302799224854
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.880 Vali Acc: 0.806 Test Loss: 0.880 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7008876800537109
Epoch: 34, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.841 Vali Acc: 0.839 Test Loss: 0.841 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8456213474273682
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7357332706451416
Epoch: 36, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.893 Vali Acc: 0.844 Test Loss: 0.893 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 36417807
model size : 153.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5788679122924805
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.608 Vali Acc: 0.228 Test Loss: 2.608 Test Acc: 0.228
Validation loss decreased (inf --> -0.227752).  Saving model ...
Epoch: 2 cost time: 1.1601033210754395
Epoch: 2, Steps: 12 | Train Loss: 2.525 Vali Loss: 2.325 Vali Acc: 0.294 Test Loss: 2.325 Test Acc: 0.294
Validation loss decreased (-0.227752 --> -0.294421).  Saving model ...
Epoch: 3 cost time: 1.0619983673095703
Epoch: 3, Steps: 12 | Train Loss: 2.128 Vali Loss: 1.966 Vali Acc: 0.472 Test Loss: 1.966 Test Acc: 0.472
Validation loss decreased (-0.294421 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 1.1302707195281982
Epoch: 4, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.564 Vali Acc: 0.544 Test Loss: 1.564 Test Acc: 0.544
Validation loss decreased (-0.472203 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 1.1701061725616455
Epoch: 5, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.245 Vali Acc: 0.606 Test Loss: 1.245 Test Acc: 0.606
Validation loss decreased (-0.544429 --> -0.605543).  Saving model ...
Epoch: 6 cost time: 1.120096206665039
Epoch: 6, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.141 Vali Acc: 0.561 Test Loss: 1.141 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0648198127746582
Epoch: 7, Steps: 12 | Train Loss: 0.865 Vali Loss: 1.103 Vali Acc: 0.650 Test Loss: 1.103 Test Acc: 0.650
Validation loss decreased (-0.605543 --> -0.649989).  Saving model ...
Epoch: 8 cost time: 1.1737377643585205
Epoch: 8, Steps: 12 | Train Loss: 0.727 Vali Loss: 1.025 Vali Acc: 0.650 Test Loss: 1.025 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 1.0989952087402344
Epoch: 9, Steps: 12 | Train Loss: 0.612 Vali Loss: 1.020 Vali Acc: 0.683 Test Loss: 1.020 Test Acc: 0.683
Validation loss decreased (-0.649990 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 1.0204226970672607
Epoch: 10, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.918 Vali Acc: 0.700 Test Loss: 0.918 Test Acc: 0.700
Validation loss decreased (-0.683323 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 1.0840263366699219
Epoch: 11, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.989 Vali Acc: 0.700 Test Loss: 0.989 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1681585311889648
Epoch: 12, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.957 Vali Acc: 0.750 Test Loss: 0.957 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.8511619567871094
Epoch: 13, Steps: 12 | Train Loss: 0.390 Vali Loss: 1.219 Vali Acc: 0.706 Test Loss: 1.219 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9586238861083984
Epoch: 14, Steps: 12 | Train Loss: 0.307 Vali Loss: 1.134 Vali Acc: 0.750 Test Loss: 1.134 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0288820266723633
Epoch: 15, Steps: 12 | Train Loss: 0.320 Vali Loss: 1.308 Vali Acc: 0.728 Test Loss: 1.308 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.680656909942627
Epoch: 16, Steps: 12 | Train Loss: 0.378 Vali Loss: 1.186 Vali Acc: 0.750 Test Loss: 1.186 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8113877773284912
Epoch: 17, Steps: 12 | Train Loss: 0.237 Vali Loss: 1.312 Vali Acc: 0.761 Test Loss: 1.312 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761098).  Saving model ...
Epoch: 18 cost time: 0.8816752433776855
Epoch: 18, Steps: 12 | Train Loss: 0.291 Vali Loss: 1.374 Vali Acc: 0.733 Test Loss: 1.374 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8223187923431396
Epoch: 19, Steps: 12 | Train Loss: 0.312 Vali Loss: 1.466 Vali Acc: 0.739 Test Loss: 1.466 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.906696081161499
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.602 Vali Acc: 0.728 Test Loss: 1.602 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7755758762359619
Epoch: 21, Steps: 12 | Train Loss: 0.361 Vali Loss: 1.408 Vali Acc: 0.717 Test Loss: 1.408 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8636970520019531
Epoch: 22, Steps: 12 | Train Loss: 0.224 Vali Loss: 1.484 Vali Acc: 0.744 Test Loss: 1.484 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8380498886108398
Epoch: 23, Steps: 12 | Train Loss: 0.211 Vali Loss: 1.474 Vali Acc: 0.756 Test Loss: 1.474 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.018958330154419
Epoch: 24, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.474 Vali Acc: 0.733 Test Loss: 1.474 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8022220134735107
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.568 Vali Acc: 0.789 Test Loss: 1.568 Test Acc: 0.789
Validation loss decreased (-0.761098 --> -0.788873).  Saving model ...
Epoch: 26 cost time: 1.0155673027038574
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.459 Vali Acc: 0.783 Test Loss: 1.459 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.162917137145996
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 1.588 Vali Acc: 0.783 Test Loss: 1.588 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9328908920288086
Epoch: 28, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.574 Vali Acc: 0.778 Test Loss: 1.574 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.940654993057251
Epoch: 29, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.425 Vali Acc: 0.806 Test Loss: 1.425 Test Acc: 0.806
Validation loss decreased (-0.788873 --> -0.805541).  Saving model ...
Epoch: 30 cost time: 0.702559232711792
Epoch: 30, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.626 Vali Acc: 0.794 Test Loss: 1.626 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.796485185623169
Epoch: 31, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.663 Vali Acc: 0.761 Test Loss: 1.663 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7407007217407227
Epoch: 32, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.649 Vali Acc: 0.789 Test Loss: 1.649 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8193359375
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.811 Vali Acc: 0.761 Test Loss: 1.811 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6493642330169678
Epoch: 34, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.536 Vali Acc: 0.783 Test Loss: 1.536 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.027482271194458
Epoch: 35, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.691 Vali Acc: 0.778 Test Loss: 1.691 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9705319404602051
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.498 Vali Acc: 0.811 Test Loss: 1.498 Test Acc: 0.811
Validation loss decreased (-0.805541 --> -0.811096).  Saving model ...
Epoch: 37 cost time: 1.4878332614898682
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.688 Vali Acc: 0.794 Test Loss: 1.688 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.253993272781372
Epoch: 38, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.576 Vali Acc: 0.772 Test Loss: 1.576 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7451884746551514
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.852 Vali Acc: 0.817 Test Loss: 1.852 Test Acc: 0.817
Validation loss decreased (-0.811096 --> -0.816648).  Saving model ...
Epoch: 40 cost time: 1.0681350231170654
Epoch: 40, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.749 Vali Acc: 0.806 Test Loss: 1.749 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8006765842437744
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.737 Vali Acc: 0.800 Test Loss: 1.737 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.106689453125
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.797 Vali Acc: 0.811 Test Loss: 1.797 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.287376880645752
Epoch: 43, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.667 Vali Acc: 0.789 Test Loss: 1.667 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8333237171173096
Epoch: 44, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.906 Vali Acc: 0.783 Test Loss: 1.906 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9975402355194092
Epoch: 45, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.774 Vali Acc: 0.800 Test Loss: 1.774 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0396881103515625
Epoch: 46, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.909 Vali Acc: 0.794 Test Loss: 1.909 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.4617958068847656
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.809 Vali Acc: 0.794 Test Loss: 1.809 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0610177516937256
Epoch: 48, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.766 Vali Acc: 0.817 Test Loss: 1.766 Test Acc: 0.817
Validation loss decreased (-0.816648 --> -0.816649).  Saving model ...
Epoch: 49 cost time: 1.1119825839996338
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.904 Vali Acc: 0.794 Test Loss: 1.904 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0534532070159912
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.686 Vali Acc: 0.811 Test Loss: 1.686 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 36592143
model size : 154.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4124503135681152
Epoch: 1, Steps: 12 | Train Loss: 2.792 Vali Loss: 2.659 Vali Acc: 0.139 Test Loss: 2.659 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.7455739974975586
Epoch: 2, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.471 Vali Acc: 0.306 Test Loss: 2.471 Test Acc: 0.306
Validation loss decreased (-0.138862 --> -0.305531).  Saving model ...
Epoch: 3 cost time: 0.863121747970581
Epoch: 3, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.243 Vali Acc: 0.439 Test Loss: 2.243 Test Acc: 0.439
Validation loss decreased (-0.305531 --> -0.438866).  Saving model ...
Epoch: 4 cost time: 0.6991405487060547
Epoch: 4, Steps: 12 | Train Loss: 2.079 Vali Loss: 1.935 Vali Acc: 0.539 Test Loss: 1.935 Test Acc: 0.539
Validation loss decreased (-0.438866 --> -0.538870).  Saving model ...
Epoch: 5 cost time: 0.7335588932037354
Epoch: 5, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.533 Vali Acc: 0.511 Test Loss: 1.533 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7792022228240967
Epoch: 6, Steps: 12 | Train Loss: 1.281 Vali Loss: 1.222 Vali Acc: 0.567 Test Loss: 1.222 Test Acc: 0.567
Validation loss decreased (-0.538870 --> -0.566654).  Saving model ...
Epoch: 7 cost time: 0.796320915222168
Epoch: 7, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.108 Vali Acc: 0.594 Test Loss: 1.108 Test Acc: 0.594
Validation loss decreased (-0.566654 --> -0.594433).  Saving model ...
Epoch: 8 cost time: 0.6611058712005615
Epoch: 8, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.940 Vali Acc: 0.656 Test Loss: 0.940 Test Acc: 0.656
Validation loss decreased (-0.594433 --> -0.655546).  Saving model ...
Epoch: 9 cost time: 0.6183748245239258
Epoch: 9, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.914 Vali Acc: 0.672 Test Loss: 0.914 Test Acc: 0.672
Validation loss decreased (-0.655546 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 0.6300618648529053
Epoch: 10, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.835 Vali Acc: 0.683 Test Loss: 0.835 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683325).  Saving model ...
Epoch: 11 cost time: 0.6409177780151367
Epoch: 11, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.790 Vali Acc: 0.728 Test Loss: 0.790 Test Acc: 0.728
Validation loss decreased (-0.683325 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 0.8469092845916748
Epoch: 12, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.821 Vali Acc: 0.722 Test Loss: 0.821 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8085813522338867
Epoch: 13, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 1.0187201499938965
Epoch: 14, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.755 Vali Acc: 0.750 Test Loss: 0.755 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 15 cost time: 0.9291496276855469
Epoch: 15, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.828 Vali Acc: 0.728 Test Loss: 0.828 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0466539859771729
Epoch: 16, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.870 Vali Acc: 0.744 Test Loss: 0.870 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8631160259246826
Epoch: 17, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.789 Vali Acc: 0.783 Test Loss: 0.789 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783325).  Saving model ...
Epoch: 18 cost time: 0.9876611232757568
Epoch: 18, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.714 Vali Acc: 0.806 Test Loss: 0.714 Test Acc: 0.806
Validation loss decreased (-0.783325 --> -0.805548).  Saving model ...
Epoch: 19 cost time: 1.0226500034332275
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.929 Vali Acc: 0.800 Test Loss: 0.929 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8828518390655518
Epoch: 20, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8706643581390381
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.193 Vali Acc: 0.756 Test Loss: 1.193 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0208477973937988
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.070 Vali Acc: 0.778 Test Loss: 1.070 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9948322772979736
Epoch: 23, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.955 Vali Acc: 0.761 Test Loss: 0.955 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9278602600097656
Epoch: 24, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.896 Vali Acc: 0.783 Test Loss: 0.896 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.800837516784668
Epoch: 25, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.958 Vali Acc: 0.789 Test Loss: 0.958 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.791893482208252
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.996 Vali Acc: 0.778 Test Loss: 0.996 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8017594814300537
Epoch: 27, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.912 Vali Acc: 0.800 Test Loss: 0.912 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7726929187774658
Epoch: 28, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.891 Vali Acc: 0.794 Test Loss: 0.891 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 36461583
model size : 153.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1658029556274414
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.689 Vali Acc: 0.133 Test Loss: 2.689 Test Acc: 0.133
Validation loss decreased (inf --> -0.133306).  Saving model ...
Epoch: 2 cost time: 0.6988816261291504
Epoch: 2, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.527 Vali Acc: 0.289 Test Loss: 2.527 Test Acc: 0.289
Validation loss decreased (-0.133306 --> -0.288864).  Saving model ...
Epoch: 3 cost time: 0.782752275466919
Epoch: 3, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.342 Vali Acc: 0.400 Test Loss: 2.342 Test Acc: 0.400
Validation loss decreased (-0.288864 --> -0.399977).  Saving model ...
Epoch: 4 cost time: 0.6465475559234619
Epoch: 4, Steps: 12 | Train Loss: 2.207 Vali Loss: 2.101 Vali Acc: 0.472 Test Loss: 2.101 Test Acc: 0.472
Validation loss decreased (-0.399977 --> -0.472201).  Saving model ...
Epoch: 5 cost time: 0.7324926853179932
Epoch: 5, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.744 Vali Acc: 0.528 Test Loss: 1.744 Test Acc: 0.528
Validation loss decreased (-0.472201 --> -0.527760).  Saving model ...
Epoch: 6 cost time: 0.5692076683044434
Epoch: 6, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.404 Vali Acc: 0.578 Test Loss: 1.404 Test Acc: 0.578
Validation loss decreased (-0.527760 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.60471510887146
Epoch: 7, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.195 Vali Acc: 0.617 Test Loss: 1.195 Test Acc: 0.617
Validation loss decreased (-0.577764 --> -0.616655).  Saving model ...
Epoch: 8 cost time: 0.6492569446563721
Epoch: 8, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.088 Vali Acc: 0.622 Test Loss: 1.088 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622211).  Saving model ...
Epoch: 9 cost time: 0.7593021392822266
Epoch: 9, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.921 Vali Acc: 0.622 Test Loss: 0.921 Test Acc: 0.622
Validation loss decreased (-0.622211 --> -0.622213).  Saving model ...
Epoch: 10 cost time: 0.5821001529693604
Epoch: 10, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.897 Vali Acc: 0.694 Test Loss: 0.897 Test Acc: 0.694
Validation loss decreased (-0.622213 --> -0.694435).  Saving model ...
Epoch: 11 cost time: 0.6666712760925293
Epoch: 11, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.789 Vali Acc: 0.744 Test Loss: 0.789 Test Acc: 0.744
Validation loss decreased (-0.694435 --> -0.744437).  Saving model ...
Epoch: 12 cost time: 0.6620602607727051
Epoch: 12, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.750 Vali Acc: 0.750 Test Loss: 0.750 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.609982967376709
Epoch: 13, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.717 Vali Acc: 0.733 Test Loss: 0.717 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.658989429473877
Epoch: 14, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.692 Vali Acc: 0.761 Test Loss: 0.692 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 0.7106595039367676
Epoch: 15, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 0.7274022102355957
Epoch: 16, Steps: 12 | Train Loss: 0.336 Vali Loss: 0.651 Vali Acc: 0.794 Test Loss: 0.651 Test Acc: 0.794
Validation loss decreased (-0.788882 --> -0.794438).  Saving model ...
Epoch: 17 cost time: 0.7971954345703125
Epoch: 17, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.725 Vali Acc: 0.806 Test Loss: 0.725 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805548).  Saving model ...
Epoch: 18 cost time: 0.6402006149291992
Epoch: 18, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.679 Vali Acc: 0.811 Test Loss: 0.679 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 0.8664417266845703
Epoch: 19, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.680 Vali Acc: 0.778 Test Loss: 0.680 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8614299297332764
Epoch: 20, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.718 Vali Acc: 0.800 Test Loss: 0.718 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7895262241363525
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.894317626953125
Epoch: 22, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.795 Vali Acc: 0.778 Test Loss: 0.795 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6291649341583252
Epoch: 23, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.764 Vali Acc: 0.817 Test Loss: 0.764 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 24 cost time: 0.7339417934417725
Epoch: 24, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 0.7705268859863281
Epoch: 25, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.679 Vali Acc: 0.839 Test Loss: 0.679 Test Acc: 0.839
Validation loss decreased (-0.822215 --> -0.838882).  Saving model ...
Epoch: 26 cost time: 0.7868502140045166
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.773 Vali Acc: 0.839 Test Loss: 0.773 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8024072647094727
Epoch: 27, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.729 Vali Acc: 0.817 Test Loss: 0.729 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8256897926330566
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.753 Vali Acc: 0.850 Test Loss: 0.753 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849992).  Saving model ...
Epoch: 29 cost time: 0.7205507755279541
Epoch: 29, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.773 Vali Acc: 0.811 Test Loss: 0.773 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7557196617126465
Epoch: 30, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.811 Vali Acc: 0.844 Test Loss: 0.811 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7272489070892334
Epoch: 31, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.801 Vali Acc: 0.806 Test Loss: 0.801 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.62888503074646
Epoch: 32, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.810 Vali Acc: 0.822 Test Loss: 0.810 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.720348596572876
Epoch: 33, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.774 Vali Acc: 0.817 Test Loss: 0.774 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.683239221572876
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.766 Vali Acc: 0.828 Test Loss: 0.766 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6951844692230225
Epoch: 35, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.823 Vali Acc: 0.817 Test Loss: 0.823 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.775503396987915
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.795 Vali Acc: 0.828 Test Loss: 0.795 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6784844398498535
Epoch: 37, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855548).  Saving model ...
Epoch: 38 cost time: 0.6053268909454346
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.807 Vali Acc: 0.839 Test Loss: 0.807 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6404681205749512
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.850 Vali Acc: 0.828 Test Loss: 0.850 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5882472991943359
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.813 Vali Acc: 0.850 Test Loss: 0.813 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8316771984100342
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.810 Vali Acc: 0.850 Test Loss: 0.810 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7020413875579834
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.821 Vali Acc: 0.844 Test Loss: 0.821 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7362260818481445
Epoch: 43, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.826 Vali Acc: 0.844 Test Loss: 0.826 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7903702259063721
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.884 Vali Acc: 0.844 Test Loss: 0.884 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6502268314361572
Epoch: 45, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.774 Vali Acc: 0.856 Test Loss: 0.774 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6795670986175537
Epoch: 46, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.863 Vali Acc: 0.861 Test Loss: 0.863 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861102).  Saving model ...
Epoch: 47 cost time: 0.7258498668670654
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.808 Vali Acc: 0.867 Test Loss: 0.808 Test Acc: 0.867
Validation loss decreased (-0.861102 --> -0.866659).  Saving model ...
Epoch: 48 cost time: 0.8189165592193604
Epoch: 48, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.896 Vali Acc: 0.861 Test Loss: 0.896 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7836871147155762
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.897 Vali Acc: 0.861 Test Loss: 0.897 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8413560390472412
Epoch: 50, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.890 Vali Acc: 0.822 Test Loss: 0.890 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 36409359
model size : 153.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5629045963287354
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.655 Vali Acc: 0.133 Test Loss: 2.655 Test Acc: 0.133
Validation loss decreased (inf --> -0.133307).  Saving model ...
Epoch: 2 cost time: 1.08042573928833
Epoch: 2, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.372 Vali Acc: 0.367 Test Loss: 2.372 Test Acc: 0.367
Validation loss decreased (-0.133307 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 1.0225019454956055
Epoch: 3, Steps: 12 | Train Loss: 2.179 Vali Loss: 1.989 Vali Acc: 0.422 Test Loss: 1.989 Test Acc: 0.422
Validation loss decreased (-0.366643 --> -0.422202).  Saving model ...
Epoch: 4 cost time: 0.947667121887207
Epoch: 4, Steps: 12 | Train Loss: 1.715 Vali Loss: 1.616 Vali Acc: 0.511 Test Loss: 1.616 Test Acc: 0.511
Validation loss decreased (-0.422202 --> -0.511095).  Saving model ...
Epoch: 5 cost time: 0.9632127285003662
Epoch: 5, Steps: 12 | Train Loss: 1.411 Vali Loss: 1.414 Vali Acc: 0.556 Test Loss: 1.414 Test Acc: 0.556
Validation loss decreased (-0.511095 --> -0.555541).  Saving model ...
Epoch: 6 cost time: 1.1961913108825684
Epoch: 6, Steps: 12 | Train Loss: 1.126 Vali Loss: 1.236 Vali Acc: 0.561 Test Loss: 1.236 Test Acc: 0.561
Validation loss decreased (-0.555541 --> -0.561099).  Saving model ...
Epoch: 7 cost time: 0.9318459033966064
Epoch: 7, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.063 Vali Acc: 0.617 Test Loss: 1.063 Test Acc: 0.617
Validation loss decreased (-0.561099 --> -0.616656).  Saving model ...
Epoch: 8 cost time: 0.9890546798706055
Epoch: 8, Steps: 12 | Train Loss: 0.678 Vali Loss: 1.109 Vali Acc: 0.622 Test Loss: 1.109 Test Acc: 0.622
Validation loss decreased (-0.616656 --> -0.622211).  Saving model ...
Epoch: 9 cost time: 0.7264652252197266
Epoch: 9, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.960 Vali Acc: 0.650 Test Loss: 0.960 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 1.1094708442687988
Epoch: 10, Steps: 12 | Train Loss: 0.441 Vali Loss: 1.072 Vali Acc: 0.694 Test Loss: 1.072 Test Acc: 0.694
Validation loss decreased (-0.649990 --> -0.694434).  Saving model ...
Epoch: 11 cost time: 1.275183916091919
Epoch: 11, Steps: 12 | Train Loss: 0.509 Vali Loss: 1.018 Vali Acc: 0.689 Test Loss: 1.018 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9964196681976318
Epoch: 12, Steps: 12 | Train Loss: 0.428 Vali Loss: 1.033 Vali Acc: 0.672 Test Loss: 1.033 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1187052726745605
Epoch: 13, Steps: 12 | Train Loss: 0.344 Vali Loss: 1.319 Vali Acc: 0.672 Test Loss: 1.319 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1629738807678223
Epoch: 14, Steps: 12 | Train Loss: 0.491 Vali Loss: 1.208 Vali Acc: 0.728 Test Loss: 1.208 Test Acc: 0.728
Validation loss decreased (-0.694434 --> -0.727766).  Saving model ...
Epoch: 15 cost time: 0.8401880264282227
Epoch: 15, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.944 Vali Acc: 0.756 Test Loss: 0.944 Test Acc: 0.756
Validation loss decreased (-0.727766 --> -0.755546).  Saving model ...
Epoch: 16 cost time: 1.267136573791504
Epoch: 16, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.958 Vali Acc: 0.744 Test Loss: 0.958 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2947163581848145
Epoch: 17, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.950 Vali Acc: 0.767 Test Loss: 0.950 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766657).  Saving model ...
Epoch: 18 cost time: 1.3177697658538818
Epoch: 18, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.940 Vali Acc: 0.767 Test Loss: 0.940 Test Acc: 0.767
Validation loss decreased (-0.766657 --> -0.766657).  Saving model ...
Epoch: 19 cost time: 1.2675096988677979
Epoch: 19, Steps: 12 | Train Loss: 0.222 Vali Loss: 1.239 Vali Acc: 0.744 Test Loss: 1.239 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6283223628997803
Epoch: 20, Steps: 12 | Train Loss: 0.197 Vali Loss: 1.104 Vali Acc: 0.767 Test Loss: 1.104 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6789400577545166
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.150 Vali Acc: 0.761 Test Loss: 1.150 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0566132068634033
Epoch: 22, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.990 Vali Acc: 0.756 Test Loss: 0.990 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9543766975402832
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.339 Vali Acc: 0.739 Test Loss: 1.339 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8953523635864258
Epoch: 24, Steps: 12 | Train Loss: 0.182 Vali Loss: 1.138 Vali Acc: 0.794 Test Loss: 1.138 Test Acc: 0.794
Validation loss decreased (-0.766657 --> -0.794433).  Saving model ...
Epoch: 25 cost time: 1.4352214336395264
Epoch: 25, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.293 Vali Acc: 0.783 Test Loss: 1.293 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9405646324157715
Epoch: 26, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.406 Vali Acc: 0.750 Test Loss: 1.406 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8997600078582764
Epoch: 27, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.418 Vali Acc: 0.733 Test Loss: 1.418 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4584934711456299
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 1.163 Vali Acc: 0.789 Test Loss: 1.163 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2033686637878418
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.352 Vali Acc: 0.767 Test Loss: 1.352 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8647124767303467
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.364 Vali Acc: 0.750 Test Loss: 1.364 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0058846473693848
Epoch: 31, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.594 Vali Acc: 0.772 Test Loss: 1.594 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1145706176757812
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.456 Vali Acc: 0.772 Test Loss: 1.456 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3227944374084473
Epoch: 33, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.822 Vali Acc: 0.744 Test Loss: 1.822 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5242576599121094
Epoch: 34, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.454 Vali Acc: 0.772 Test Loss: 1.454 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 36583695
model size : 154.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4908719062805176
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.673 Vali Acc: 0.106 Test Loss: 2.673 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 1.0123229026794434
Epoch: 2, Steps: 12 | Train Loss: 2.571 Vali Loss: 2.504 Vali Acc: 0.367 Test Loss: 2.504 Test Acc: 0.367
Validation loss decreased (-0.105529 --> -0.366642).  Saving model ...
Epoch: 3 cost time: 0.9882297515869141
Epoch: 3, Steps: 12 | Train Loss: 2.356 Vali Loss: 2.234 Vali Acc: 0.444 Test Loss: 2.234 Test Acc: 0.444
Validation loss decreased (-0.366642 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 0.8913698196411133
Epoch: 4, Steps: 12 | Train Loss: 2.017 Vali Loss: 1.933 Vali Acc: 0.517 Test Loss: 1.933 Test Acc: 0.517
Validation loss decreased (-0.444422 --> -0.516647).  Saving model ...
Epoch: 5 cost time: 1.0559682846069336
Epoch: 5, Steps: 12 | Train Loss: 1.693 Vali Loss: 1.621 Vali Acc: 0.556 Test Loss: 1.621 Test Acc: 0.556
Validation loss decreased (-0.516647 --> -0.555539).  Saving model ...
Epoch: 6 cost time: 0.9564454555511475
Epoch: 6, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.355 Vali Acc: 0.533 Test Loss: 1.355 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9793791770935059
Epoch: 7, Steps: 12 | Train Loss: 1.080 Vali Loss: 1.204 Vali Acc: 0.606 Test Loss: 1.204 Test Acc: 0.606
Validation loss decreased (-0.555539 --> -0.605544).  Saving model ...
Epoch: 8 cost time: 1.1312577724456787
Epoch: 8, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.156 Vali Acc: 0.611 Test Loss: 1.156 Test Acc: 0.611
Validation loss decreased (-0.605544 --> -0.611100).  Saving model ...
Epoch: 9 cost time: 0.9779727458953857
Epoch: 9, Steps: 12 | Train Loss: 0.735 Vali Loss: 1.038 Vali Acc: 0.639 Test Loss: 1.038 Test Acc: 0.639
Validation loss decreased (-0.611100 --> -0.638879).  Saving model ...
Epoch: 10 cost time: 1.0333504676818848
Epoch: 10, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.986 Vali Acc: 0.694 Test Loss: 0.986 Test Acc: 0.694
Validation loss decreased (-0.638879 --> -0.694435).  Saving model ...
Epoch: 11 cost time: 0.9406852722167969
Epoch: 11, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.975 Vali Acc: 0.678 Test Loss: 0.975 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7611212730407715
Epoch: 12, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.999 Vali Acc: 0.717 Test Loss: 0.999 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716657).  Saving model ...
Epoch: 13 cost time: 0.9657027721405029
Epoch: 13, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.913 Vali Acc: 0.733 Test Loss: 0.913 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 14 cost time: 0.9504742622375488
Epoch: 14, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.915 Vali Acc: 0.744 Test Loss: 0.915 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 15 cost time: 1.0968003273010254
Epoch: 15, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.895 Vali Acc: 0.739 Test Loss: 0.895 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.127190113067627
Epoch: 16, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.857 Vali Acc: 0.767 Test Loss: 0.857 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766658).  Saving model ...
Epoch: 17 cost time: 0.9054336547851562
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.866 Vali Acc: 0.772 Test Loss: 0.866 Test Acc: 0.772
Validation loss decreased (-0.766658 --> -0.772214).  Saving model ...
Epoch: 18 cost time: 1.0789611339569092
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
Validation loss decreased (-0.772214 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 1.0395822525024414
Epoch: 19, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.819 Vali Acc: 0.783 Test Loss: 0.819 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9981811046600342
Epoch: 20, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.828 Vali Acc: 0.811 Test Loss: 0.828 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811103).  Saving model ...
Epoch: 21 cost time: 0.9770517349243164
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.851 Vali Acc: 0.817 Test Loss: 0.851 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816658).  Saving model ...
Epoch: 22 cost time: 1.0794572830200195
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.869 Vali Acc: 0.783 Test Loss: 0.869 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7786459922790527
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.921 Vali Acc: 0.783 Test Loss: 0.921 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7256157398223877
Epoch: 24, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.901 Vali Acc: 0.822 Test Loss: 0.901 Test Acc: 0.822
Validation loss decreased (-0.816658 --> -0.822213).  Saving model ...
Epoch: 25 cost time: 0.9564428329467773
Epoch: 25, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7663829326629639
Epoch: 26, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.032 Vali Acc: 0.806 Test Loss: 1.032 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7493550777435303
Epoch: 27, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.994 Vali Acc: 0.783 Test Loss: 0.994 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.084836721420288
Epoch: 28, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.925 Vali Acc: 0.833 Test Loss: 0.925 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833324).  Saving model ...
Epoch: 29 cost time: 0.9518108367919922
Epoch: 29, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.987 Vali Acc: 0.822 Test Loss: 0.987 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0334703922271729
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.976 Vali Acc: 0.828 Test Loss: 0.976 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0335910320281982
Epoch: 31, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.969 Vali Acc: 0.806 Test Loss: 0.969 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9552593231201172
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.925 Vali Acc: 0.817 Test Loss: 0.925 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9488325119018555
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.093 Vali Acc: 0.817 Test Loss: 1.093 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.682121753692627
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.104 Vali Acc: 0.806 Test Loss: 1.104 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7204480171203613
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.114 Vali Acc: 0.817 Test Loss: 1.114 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7520468235015869
Epoch: 36, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.067 Vali Acc: 0.839 Test Loss: 1.067 Test Acc: 0.839
Validation loss decreased (-0.833324 --> -0.838878).  Saving model ...
Epoch: 37 cost time: 0.8759346008300781
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.994 Vali Acc: 0.828 Test Loss: 0.994 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9103879928588867
Epoch: 38, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.169 Vali Acc: 0.811 Test Loss: 1.169 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9095728397369385
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.102 Vali Acc: 0.839 Test Loss: 1.102 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8812816143035889
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.161 Vali Acc: 0.811 Test Loss: 1.161 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8122844696044922
Epoch: 41, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.039 Vali Acc: 0.817 Test Loss: 1.039 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8396530151367188
Epoch: 42, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.098 Vali Acc: 0.833 Test Loss: 1.098 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8761494159698486
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.358 Vali Acc: 0.817 Test Loss: 1.358 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8649752140045166
Epoch: 44, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.240 Vali Acc: 0.811 Test Loss: 1.240 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9137778282165527
Epoch: 45, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.165 Vali Acc: 0.856 Test Loss: 1.165 Test Acc: 0.856
Validation loss decreased (-0.838878 --> -0.855544).  Saving model ...
Epoch: 46 cost time: 0.9649405479431152
Epoch: 46, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.187 Vali Acc: 0.833 Test Loss: 1.187 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9360799789428711
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.347 Vali Acc: 0.822 Test Loss: 1.347 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8947954177856445
Epoch: 48, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.143 Vali Acc: 0.817 Test Loss: 1.143 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9339179992675781
Epoch: 49, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.334 Vali Acc: 0.822 Test Loss: 1.334 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6937577724456787
Epoch: 50, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.160 Vali Acc: 0.828 Test Loss: 1.160 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 36466191
model size : 153.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4291958808898926
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.698 Vali Acc: 0.067 Test Loss: 2.698 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.6377670764923096
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.572 Vali Acc: 0.233 Test Loss: 2.572 Test Acc: 0.233
Validation loss decreased (-0.066640 --> -0.233308).  Saving model ...
Epoch: 3 cost time: 0.6738336086273193
Epoch: 3, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.418 Vali Acc: 0.311 Test Loss: 2.418 Test Acc: 0.311
Validation loss decreased (-0.233308 --> -0.311087).  Saving model ...
Epoch: 4 cost time: 0.6435415744781494
Epoch: 4, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.235 Vali Acc: 0.411 Test Loss: 2.235 Test Acc: 0.411
Validation loss decreased (-0.311087 --> -0.411089).  Saving model ...
Epoch: 5 cost time: 0.6180181503295898
Epoch: 5, Steps: 12 | Train Loss: 2.140 Vali Loss: 1.973 Vali Acc: 0.467 Test Loss: 1.973 Test Acc: 0.467
Validation loss decreased (-0.411089 --> -0.466647).  Saving model ...
Epoch: 6 cost time: 0.6474335193634033
Epoch: 6, Steps: 12 | Train Loss: 1.810 Vali Loss: 1.647 Vali Acc: 0.556 Test Loss: 1.647 Test Acc: 0.556
Validation loss decreased (-0.466647 --> -0.555539).  Saving model ...
Epoch: 7 cost time: 0.7391853332519531
Epoch: 7, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.341 Vali Acc: 0.589 Test Loss: 1.341 Test Acc: 0.589
Validation loss decreased (-0.555539 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 0.6404578685760498
Epoch: 8, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.151 Vali Acc: 0.633 Test Loss: 1.151 Test Acc: 0.633
Validation loss decreased (-0.588875 --> -0.633322).  Saving model ...
Epoch: 9 cost time: 0.7278063297271729
Epoch: 9, Steps: 12 | Train Loss: 0.918 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
Validation loss decreased (-0.633322 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 0.6923098564147949
Epoch: 10, Steps: 12 | Train Loss: 0.775 Vali Loss: 0.871 Vali Acc: 0.700 Test Loss: 0.871 Test Acc: 0.700
Validation loss decreased (-0.666656 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.6629359722137451
Epoch: 11, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.816 Vali Acc: 0.700 Test Loss: 0.816 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 0.7782342433929443
Epoch: 12, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.749 Vali Acc: 0.717 Test Loss: 0.749 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716659).  Saving model ...
Epoch: 13 cost time: 0.7811844348907471
Epoch: 13, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.726 Vali Acc: 0.744 Test Loss: 0.726 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 0.7111787796020508
Epoch: 14, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 0.7159774303436279
Epoch: 15, Steps: 12 | Train Loss: 0.319 Vali Loss: 0.679 Vali Acc: 0.772 Test Loss: 0.679 Test Acc: 0.772
Validation loss decreased (-0.749993 --> -0.772215).  Saving model ...
Epoch: 16 cost time: 0.8314709663391113
Epoch: 16, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.693 Vali Acc: 0.767 Test Loss: 0.693 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7332572937011719
Epoch: 17, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.657 Vali Acc: 0.794 Test Loss: 0.657 Test Acc: 0.794
Validation loss decreased (-0.772215 --> -0.794438).  Saving model ...
Epoch: 18 cost time: 0.7510809898376465
Epoch: 18, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.619 Vali Acc: 0.811 Test Loss: 0.619 Test Acc: 0.811
Validation loss decreased (-0.794438 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 0.8194518089294434
Epoch: 19, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.687 Vali Acc: 0.806 Test Loss: 0.687 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6312878131866455
Epoch: 20, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822215).  Saving model ...
Epoch: 21 cost time: 0.825753927230835
Epoch: 21, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.681 Vali Acc: 0.817 Test Loss: 0.681 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7101812362670898
Epoch: 22, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.679 Vali Acc: 0.811 Test Loss: 0.679 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6013665199279785
Epoch: 23, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.682 Vali Acc: 0.817 Test Loss: 0.682 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.584364652633667
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.758 Vali Acc: 0.828 Test Loss: 0.758 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827770).  Saving model ...
Epoch: 25 cost time: 0.7302186489105225
Epoch: 25, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.734 Vali Acc: 0.833 Test Loss: 0.734 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 26 cost time: 0.746692419052124
Epoch: 26, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.735 Vali Acc: 0.839 Test Loss: 0.735 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 0.7624146938323975
Epoch: 27, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8763382434844971
Epoch: 28, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.762 Vali Acc: 0.828 Test Loss: 0.762 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8171870708465576
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.831 Vali Acc: 0.817 Test Loss: 0.831 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8804566860198975
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.727 Vali Acc: 0.828 Test Loss: 0.727 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8515973091125488
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.757 Vali Acc: 0.839 Test Loss: 0.757 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.711050271987915
Epoch: 32, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.786 Vali Acc: 0.844 Test Loss: 0.786 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844437).  Saving model ...
Epoch: 33 cost time: 0.8372776508331299
Epoch: 33, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.825 Vali Acc: 0.828 Test Loss: 0.825 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8028213977813721
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.794 Vali Acc: 0.833 Test Loss: 0.794 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.666534423828125
Epoch: 35, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.809 Vali Acc: 0.828 Test Loss: 0.809 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8126897811889648
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.778 Vali Acc: 0.850 Test Loss: 0.778 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849992).  Saving model ...
Epoch: 37 cost time: 0.7504439353942871
Epoch: 37, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.831 Vali Acc: 0.833 Test Loss: 0.831 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7003879547119141
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.812 Vali Acc: 0.850 Test Loss: 0.812 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7623047828674316
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.837 Vali Acc: 0.833 Test Loss: 0.837 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8232197761535645
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.834 Vali Acc: 0.850 Test Loss: 0.834 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7342615127563477
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.869 Vali Acc: 0.811 Test Loss: 0.869 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6994075775146484
Epoch: 42, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.859 Vali Acc: 0.844 Test Loss: 0.859 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7189755439758301
Epoch: 43, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.828 Vali Acc: 0.839 Test Loss: 0.828 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.679410457611084
Epoch: 44, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.916 Vali Acc: 0.856 Test Loss: 0.916 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855546).  Saving model ...
Epoch: 45 cost time: 0.7386236190795898
Epoch: 45, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.891 Vali Acc: 0.861 Test Loss: 0.891 Test Acc: 0.861
Validation loss decreased (-0.855546 --> -0.861102).  Saving model ...
Epoch: 46 cost time: 0.7999444007873535
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.920 Vali Acc: 0.856 Test Loss: 0.920 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7274410724639893
Epoch: 47, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.876 Vali Acc: 0.850 Test Loss: 0.876 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7135839462280273
Epoch: 48, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.867 Vali Acc: 0.861 Test Loss: 0.867 Test Acc: 0.861
Validation loss decreased (-0.861102 --> -0.861102).  Saving model ...
Epoch: 49 cost time: 0.7613742351531982
Epoch: 49, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.926 Vali Acc: 0.828 Test Loss: 0.926 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7584800720214844
Epoch: 50, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.894 Vali Acc: 0.850 Test Loss: 0.894 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 36400911
model size : 153.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.336974859237671
Epoch: 1, Steps: 12 | Train Loss: 2.804 Vali Loss: 2.634 Vali Acc: 0.083 Test Loss: 2.634 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.9536948204040527
Epoch: 2, Steps: 12 | Train Loss: 2.522 Vali Loss: 2.410 Vali Acc: 0.361 Test Loss: 2.410 Test Acc: 0.361
Validation loss decreased (-0.083307 --> -0.361087).  Saving model ...
Epoch: 3 cost time: 0.8879966735839844
Epoch: 3, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.134 Vali Acc: 0.450 Test Loss: 2.134 Test Acc: 0.450
Validation loss decreased (-0.361087 --> -0.449979).  Saving model ...
Epoch: 4 cost time: 1.0318069458007812
Epoch: 4, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.784 Vali Acc: 0.528 Test Loss: 1.784 Test Acc: 0.528
Validation loss decreased (-0.449979 --> -0.527760).  Saving model ...
Epoch: 5 cost time: 0.8899929523468018
Epoch: 5, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.425 Vali Acc: 0.544 Test Loss: 1.425 Test Acc: 0.544
Validation loss decreased (-0.527760 --> -0.544430).  Saving model ...
Epoch: 6 cost time: 0.8808901309967041
Epoch: 6, Steps: 12 | Train Loss: 1.153 Vali Loss: 1.198 Vali Acc: 0.589 Test Loss: 1.198 Test Acc: 0.589
Validation loss decreased (-0.544430 --> -0.588877).  Saving model ...
Epoch: 7 cost time: 0.8582463264465332
Epoch: 7, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.167 Vali Acc: 0.600 Test Loss: 1.167 Test Acc: 0.600
Validation loss decreased (-0.588877 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.966066837310791
Epoch: 8, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.012 Vali Acc: 0.656 Test Loss: 1.012 Test Acc: 0.656
Validation loss decreased (-0.599988 --> -0.655545).  Saving model ...
Epoch: 9 cost time: 0.758716344833374
Epoch: 9, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.915 Vali Acc: 0.706 Test Loss: 0.915 Test Acc: 0.706
Validation loss decreased (-0.655545 --> -0.705546).  Saving model ...
Epoch: 10 cost time: 0.7920255661010742
Epoch: 10, Steps: 12 | Train Loss: 0.602 Vali Loss: 0.846 Vali Acc: 0.672 Test Loss: 0.846 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8304464817047119
Epoch: 11, Steps: 12 | Train Loss: 0.520 Vali Loss: 0.817 Vali Acc: 0.711 Test Loss: 0.817 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.7860743999481201
Epoch: 12, Steps: 12 | Train Loss: 0.455 Vali Loss: 0.793 Vali Acc: 0.717 Test Loss: 0.793 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716659).  Saving model ...
Epoch: 13 cost time: 0.7460293769836426
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.778 Vali Acc: 0.739 Test Loss: 0.778 Test Acc: 0.739
Validation loss decreased (-0.716659 --> -0.738881).  Saving model ...
Epoch: 14 cost time: 0.9213895797729492
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.844 Vali Acc: 0.772 Test Loss: 0.844 Test Acc: 0.772
Validation loss decreased (-0.738881 --> -0.772214).  Saving model ...
Epoch: 15 cost time: 0.8534631729125977
Epoch: 15, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.838 Vali Acc: 0.761 Test Loss: 0.838 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8664202690124512
Epoch: 16, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.807 Vali Acc: 0.761 Test Loss: 0.807 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.797112226486206
Epoch: 17, Steps: 12 | Train Loss: 0.220 Vali Loss: 1.130 Vali Acc: 0.761 Test Loss: 1.130 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9517996311187744
Epoch: 18, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.958 Vali Acc: 0.772 Test Loss: 0.958 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9906463623046875
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.977 Vali Acc: 0.756 Test Loss: 0.977 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8661789894104004
Epoch: 20, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.005 Vali Acc: 0.783 Test Loss: 1.005 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783323).  Saving model ...
Epoch: 21 cost time: 0.8801519870758057
Epoch: 21, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.964 Vali Acc: 0.778 Test Loss: 0.964 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8027322292327881
Epoch: 22, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.960 Vali Acc: 0.772 Test Loss: 0.960 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9373891353607178
Epoch: 23, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.007 Vali Acc: 0.789 Test Loss: 1.007 Test Acc: 0.789
Validation loss decreased (-0.783323 --> -0.788879).  Saving model ...
Epoch: 24 cost time: 0.8223812580108643
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.898 Vali Acc: 0.794 Test Loss: 0.898 Test Acc: 0.794
Validation loss decreased (-0.788879 --> -0.794435).  Saving model ...
Epoch: 25 cost time: 0.8279132843017578
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.984 Vali Acc: 0.794 Test Loss: 0.984 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7818732261657715
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.054 Vali Acc: 0.789 Test Loss: 1.054 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7395656108856201
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.950 Vali Acc: 0.783 Test Loss: 0.950 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7234811782836914
Epoch: 28, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.217 Vali Acc: 0.789 Test Loss: 1.217 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8203232288360596
Epoch: 29, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.898 Vali Acc: 0.822 Test Loss: 0.898 Test Acc: 0.822
Validation loss decreased (-0.794435 --> -0.822213).  Saving model ...
Epoch: 30 cost time: 0.6151330471038818
Epoch: 30, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.061 Vali Acc: 0.800 Test Loss: 1.061 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5757341384887695
Epoch: 31, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.001 Vali Acc: 0.811 Test Loss: 1.001 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8551836013793945
Epoch: 32, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.036 Vali Acc: 0.794 Test Loss: 1.036 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7838287353515625
Epoch: 33, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.200 Vali Acc: 0.778 Test Loss: 1.200 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8344738483428955
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.142 Vali Acc: 0.778 Test Loss: 1.142 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0101327896118164
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.236 Vali Acc: 0.783 Test Loss: 1.236 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7138147354125977
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.194 Vali Acc: 0.789 Test Loss: 1.194 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9864540100097656
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.093 Vali Acc: 0.778 Test Loss: 1.093 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0265235900878906
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.226 Vali Acc: 0.778 Test Loss: 1.226 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9723825454711914
Epoch: 39, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.136 Vali Acc: 0.811 Test Loss: 1.136 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 36509967
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.369319438934326
Epoch: 1, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.615 Vali Acc: 0.178 Test Loss: 2.615 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 0.8391637802124023
Epoch: 2, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.452 Vali Acc: 0.361 Test Loss: 2.452 Test Acc: 0.361
Validation loss decreased (-0.177752 --> -0.361087).  Saving model ...
Epoch: 3 cost time: 0.8811969757080078
Epoch: 3, Steps: 12 | Train Loss: 2.413 Vali Loss: 2.244 Vali Acc: 0.478 Test Loss: 2.244 Test Acc: 0.478
Validation loss decreased (-0.361087 --> -0.477755).  Saving model ...
Epoch: 4 cost time: 0.7084028720855713
Epoch: 4, Steps: 12 | Train Loss: 2.120 Vali Loss: 1.965 Vali Acc: 0.478 Test Loss: 1.965 Test Acc: 0.478
Validation loss decreased (-0.477755 --> -0.477758).  Saving model ...
Epoch: 5 cost time: 0.8875205516815186
Epoch: 5, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.631 Vali Acc: 0.544 Test Loss: 1.631 Test Acc: 0.544
Validation loss decreased (-0.477758 --> -0.544428).  Saving model ...
Epoch: 6 cost time: 0.9091429710388184
Epoch: 6, Steps: 12 | Train Loss: 1.468 Vali Loss: 1.296 Vali Acc: 0.583 Test Loss: 1.296 Test Acc: 0.583
Validation loss decreased (-0.544428 --> -0.583320).  Saving model ...
Epoch: 7 cost time: 0.8234260082244873
Epoch: 7, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.099 Vali Acc: 0.622 Test Loss: 1.099 Test Acc: 0.622
Validation loss decreased (-0.583320 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 0.7235004901885986
Epoch: 8, Steps: 12 | Train Loss: 0.900 Vali Loss: 1.005 Vali Acc: 0.656 Test Loss: 1.005 Test Acc: 0.656
Validation loss decreased (-0.622211 --> -0.655546).  Saving model ...
Epoch: 9 cost time: 0.6869070529937744
Epoch: 9, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.906 Vali Acc: 0.667 Test Loss: 0.906 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 0.6832411289215088
Epoch: 10, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.805 Vali Acc: 0.711 Test Loss: 0.805 Test Acc: 0.711
Validation loss decreased (-0.666658 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 0.7204041481018066
Epoch: 11, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.773 Vali Acc: 0.728 Test Loss: 0.773 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 12 cost time: 0.6556422710418701
Epoch: 12, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.725 Vali Acc: 0.722 Test Loss: 0.725 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6755695343017578
Epoch: 13, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.818 Vali Acc: 0.739 Test Loss: 0.818 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 14 cost time: 0.7206189632415771
Epoch: 14, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.775 Vali Acc: 0.744 Test Loss: 0.775 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 15 cost time: 0.8733096122741699
Epoch: 15, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.721 Vali Acc: 0.767 Test Loss: 0.721 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.7061886787414551
Epoch: 16, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.863 Vali Acc: 0.744 Test Loss: 0.863 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7366292476654053
Epoch: 17, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.762 Vali Acc: 0.811 Test Loss: 0.762 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 0.8620660305023193
Epoch: 18, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.724 Vali Acc: 0.772 Test Loss: 0.724 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.816483736038208
Epoch: 19, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.833 Vali Acc: 0.772 Test Loss: 0.833 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7855939865112305
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7610263824462891
Epoch: 21, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.770 Vali Acc: 0.806 Test Loss: 0.770 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6885926723480225
Epoch: 22, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.773 Vali Acc: 0.778 Test Loss: 0.773 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8121733665466309
Epoch: 23, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.769 Vali Acc: 0.806 Test Loss: 0.769 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7957618236541748
Epoch: 24, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 25 cost time: 0.7783949375152588
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.830 Vali Acc: 0.800 Test Loss: 0.830 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8117129802703857
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.828 Vali Acc: 0.817 Test Loss: 0.828 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6570761203765869
Epoch: 27, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.918 Vali Acc: 0.811 Test Loss: 0.918 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7553515434265137
Epoch: 28, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.870 Vali Acc: 0.806 Test Loss: 0.870 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7462732791900635
Epoch: 29, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.874 Vali Acc: 0.828 Test Loss: 0.874 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827769).  Saving model ...
Epoch: 30 cost time: 0.7855815887451172
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.792 Vali Acc: 0.844 Test Loss: 0.792 Test Acc: 0.844
Validation loss decreased (-0.827769 --> -0.844437).  Saving model ...
Epoch: 31 cost time: 0.7393295764923096
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.897 Vali Acc: 0.822 Test Loss: 0.897 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.808387279510498
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.846 Vali Acc: 0.839 Test Loss: 0.846 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.708287239074707
Epoch: 33, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849992).  Saving model ...
Epoch: 34 cost time: 0.7541158199310303
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.844 Vali Acc: 0.839 Test Loss: 0.844 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6613061428070068
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.867 Vali Acc: 0.833 Test Loss: 0.867 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7077145576477051
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.858 Vali Acc: 0.822 Test Loss: 0.858 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7447080612182617
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.912 Vali Acc: 0.828 Test Loss: 0.912 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6863107681274414
Epoch: 38, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.902 Vali Acc: 0.839 Test Loss: 0.902 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8131115436553955
Epoch: 39, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.884 Vali Acc: 0.856 Test Loss: 0.884 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855547).  Saving model ...
Epoch: 40 cost time: 0.720430850982666
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.921 Vali Acc: 0.850 Test Loss: 0.921 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7518374919891357
Epoch: 41, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.886 Vali Acc: 0.850 Test Loss: 0.886 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7043159008026123
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.997 Vali Acc: 0.839 Test Loss: 0.997 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7267651557922363
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.963 Vali Acc: 0.833 Test Loss: 0.963 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8239505290985107
Epoch: 44, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.902 Vali Acc: 0.856 Test Loss: 0.902 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.717024564743042
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.876 Vali Acc: 0.856 Test Loss: 0.876 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 46 cost time: 0.7911450862884521
Epoch: 46, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7488992214202881
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.946 Vali Acc: 0.833 Test Loss: 0.946 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8015899658203125
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.956 Vali Acc: 0.833 Test Loss: 0.956 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7026705741882324
Epoch: 49, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.946 Vali Acc: 0.828 Test Loss: 0.946 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6735622882843018
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.905 Vali Acc: 0.833 Test Loss: 0.905 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 36444687
model size : 153.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2716939449310303
Epoch: 1, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.671 Vali Acc: 0.106 Test Loss: 2.671 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.740971565246582
Epoch: 2, Steps: 12 | Train Loss: 2.638 Vali Loss: 2.525 Vali Acc: 0.267 Test Loss: 2.525 Test Acc: 0.267
Validation loss decreased (-0.105529 --> -0.266641).  Saving model ...
Epoch: 3 cost time: 0.6998262405395508
Epoch: 3, Steps: 12 | Train Loss: 2.460 Vali Loss: 2.363 Vali Acc: 0.361 Test Loss: 2.363 Test Acc: 0.361
Validation loss decreased (-0.266641 --> -0.361087).  Saving model ...
Epoch: 4 cost time: 0.6272151470184326
Epoch: 4, Steps: 12 | Train Loss: 2.255 Vali Loss: 2.138 Vali Acc: 0.483 Test Loss: 2.138 Test Acc: 0.483
Validation loss decreased (-0.361087 --> -0.483312).  Saving model ...
Epoch: 5 cost time: 0.6714425086975098
Epoch: 5, Steps: 12 | Train Loss: 1.972 Vali Loss: 1.818 Vali Acc: 0.544 Test Loss: 1.818 Test Acc: 0.544
Validation loss decreased (-0.483312 --> -0.544426).  Saving model ...
Epoch: 6 cost time: 0.6509134769439697
Epoch: 6, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.497 Vali Acc: 0.550 Test Loss: 1.497 Test Acc: 0.550
Validation loss decreased (-0.544426 --> -0.549985).  Saving model ...
Epoch: 7 cost time: 0.6528606414794922
Epoch: 7, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.261 Vali Acc: 0.556 Test Loss: 1.261 Test Acc: 0.556
Validation loss decreased (-0.549985 --> -0.555543).  Saving model ...
Epoch: 8 cost time: 0.7413742542266846
Epoch: 8, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.555543 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.6693305969238281
Epoch: 9, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.928 Vali Acc: 0.672 Test Loss: 0.928 Test Acc: 0.672
Validation loss decreased (-0.599989 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 0.7378208637237549
Epoch: 10, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.850 Vali Acc: 0.711 Test Loss: 0.850 Test Acc: 0.711
Validation loss decreased (-0.672213 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 0.8671875
Epoch: 11, Steps: 12 | Train Loss: 0.755 Vali Loss: 0.765 Vali Acc: 0.711 Test Loss: 0.765 Test Acc: 0.711
Validation loss decreased (-0.711103 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.9163374900817871
Epoch: 12, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.737 Vali Acc: 0.706 Test Loss: 0.737 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8276052474975586
Epoch: 13, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.678 Vali Acc: 0.750 Test Loss: 0.678 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 0.8102779388427734
Epoch: 14, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.783327).  Saving model ...
Epoch: 15 cost time: 0.8682684898376465
Epoch: 15, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8394031524658203
Epoch: 16, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.642 Vali Acc: 0.806 Test Loss: 0.642 Test Acc: 0.806
Validation loss decreased (-0.783327 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.752030611038208
Epoch: 17, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8228275775909424
Epoch: 18, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.653 Vali Acc: 0.811 Test Loss: 0.653 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 19 cost time: 0.870175838470459
Epoch: 19, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.638 Vali Acc: 0.817 Test Loss: 0.638 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 0.8540167808532715
Epoch: 20, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.644 Vali Acc: 0.817 Test Loss: 0.644 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8258576393127441
Epoch: 21, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.823415994644165
Epoch: 22, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8072969913482666
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 24 cost time: 0.775853157043457
Epoch: 24, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.759 Vali Acc: 0.817 Test Loss: 0.759 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8005177974700928
Epoch: 25, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.701 Vali Acc: 0.806 Test Loss: 0.701 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7718439102172852
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6726794242858887
Epoch: 27, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.763 Vali Acc: 0.806 Test Loss: 0.763 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.698225736618042
Epoch: 28, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.775 Vali Acc: 0.806 Test Loss: 0.775 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7360198497772217
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.778 Vali Acc: 0.822 Test Loss: 0.778 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8039236068725586
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.823 Vali Acc: 0.811 Test Loss: 0.823 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7383027076721191
Epoch: 31, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.747 Vali Acc: 0.839 Test Loss: 0.747 Test Acc: 0.839
Validation loss decreased (-0.822216 --> -0.838881).  Saving model ...
Epoch: 32 cost time: 0.7111403942108154
Epoch: 32, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.831 Vali Acc: 0.828 Test Loss: 0.831 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7374589443206787
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.785 Vali Acc: 0.828 Test Loss: 0.785 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7478740215301514
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.836 Vali Acc: 0.817 Test Loss: 0.836 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6749441623687744
Epoch: 35, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.782 Vali Acc: 0.839 Test Loss: 0.782 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.74080491065979
Epoch: 36, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.873 Vali Acc: 0.833 Test Loss: 0.873 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7503194808959961
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.762 Vali Acc: 0.822 Test Loss: 0.762 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.783484935760498
Epoch: 38, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.815 Vali Acc: 0.828 Test Loss: 0.815 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7407238483428955
Epoch: 39, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.811 Vali Acc: 0.828 Test Loss: 0.811 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6756033897399902
Epoch: 40, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.886 Vali Acc: 0.850 Test Loss: 0.886 Test Acc: 0.850
Validation loss decreased (-0.838881 --> -0.849991).  Saving model ...
Epoch: 41 cost time: 0.7301597595214844
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.839 Vali Acc: 0.828 Test Loss: 0.839 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.689145565032959
Epoch: 42, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.828 Vali Acc: 0.839 Test Loss: 0.828 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8090803623199463
Epoch: 43, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.829 Vali Acc: 0.844 Test Loss: 0.829 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7842271327972412
Epoch: 44, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.814 Vali Acc: 0.850 Test Loss: 0.814 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 45 cost time: 0.6578004360198975
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.880 Vali Acc: 0.828 Test Loss: 0.880 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8638112545013428
Epoch: 46, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.932 Vali Acc: 0.839 Test Loss: 0.932 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7900915145874023
Epoch: 47, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.930 Vali Acc: 0.817 Test Loss: 0.930 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7579605579376221
Epoch: 48, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.951 Vali Acc: 0.850 Test Loss: 0.951 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8465893268585205
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.928 Vali Acc: 0.850 Test Loss: 0.928 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8785793781280518
Epoch: 50, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.958 Vali Acc: 0.856 Test Loss: 0.958 Test Acc: 0.856
Validation loss decreased (-0.849992 --> -0.855546).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 36405519
model size : 153.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6845791339874268
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.475 Vali Acc: 0.278 Test Loss: 2.475 Test Acc: 0.278
Validation loss decreased (inf --> -0.277753).  Saving model ...
Epoch: 2 cost time: 1.1473314762115479
Epoch: 2, Steps: 12 | Train Loss: 2.285 Vali Loss: 1.953 Vali Acc: 0.467 Test Loss: 1.953 Test Acc: 0.467
Validation loss decreased (-0.277753 --> -0.466647).  Saving model ...
Epoch: 3 cost time: 1.348661184310913
Epoch: 3, Steps: 12 | Train Loss: 1.762 Vali Loss: 1.554 Vali Acc: 0.556 Test Loss: 1.554 Test Acc: 0.556
Validation loss decreased (-0.466647 --> -0.555540).  Saving model ...
Epoch: 4 cost time: 0.9541218280792236
Epoch: 4, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.271 Vali Acc: 0.606 Test Loss: 1.271 Test Acc: 0.606
Validation loss decreased (-0.555540 --> -0.605543).  Saving model ...
Epoch: 5 cost time: 1.2742526531219482
Epoch: 5, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.144 Vali Acc: 0.639 Test Loss: 1.144 Test Acc: 0.639
Validation loss decreased (-0.605543 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 0.9587793350219727
Epoch: 6, Steps: 12 | Train Loss: 0.843 Vali Loss: 1.089 Vali Acc: 0.650 Test Loss: 1.089 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 1.2471587657928467
Epoch: 7, Steps: 12 | Train Loss: 0.792 Vali Loss: 1.243 Vali Acc: 0.678 Test Loss: 1.243 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677765).  Saving model ...
Epoch: 8 cost time: 1.1350476741790771
Epoch: 8, Steps: 12 | Train Loss: 0.705 Vali Loss: 1.210 Vali Acc: 0.661 Test Loss: 1.210 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9844586849212646
Epoch: 9, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.467 Vali Acc: 0.600 Test Loss: 1.467 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.839895486831665
Epoch: 10, Steps: 12 | Train Loss: 0.587 Vali Loss: 1.273 Vali Acc: 0.639 Test Loss: 1.273 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3364675045013428
Epoch: 11, Steps: 12 | Train Loss: 0.539 Vali Loss: 1.201 Vali Acc: 0.711 Test Loss: 1.201 Test Acc: 0.711
Validation loss decreased (-0.677765 --> -0.711099).  Saving model ...
Epoch: 12 cost time: 1.4971916675567627
Epoch: 12, Steps: 12 | Train Loss: 0.430 Vali Loss: 1.303 Vali Acc: 0.683 Test Loss: 1.303 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3655683994293213
Epoch: 13, Steps: 12 | Train Loss: 0.431 Vali Loss: 1.601 Vali Acc: 0.706 Test Loss: 1.601 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.409830093383789
Epoch: 14, Steps: 12 | Train Loss: 0.359 Vali Loss: 1.211 Vali Acc: 0.739 Test Loss: 1.211 Test Acc: 0.739
Validation loss decreased (-0.711099 --> -0.738877).  Saving model ...
Epoch: 15 cost time: 1.427933692932129
Epoch: 15, Steps: 12 | Train Loss: 0.332 Vali Loss: 1.436 Vali Acc: 0.728 Test Loss: 1.436 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.154341697692871
Epoch: 16, Steps: 12 | Train Loss: 0.430 Vali Loss: 1.789 Vali Acc: 0.706 Test Loss: 1.789 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2644011974334717
Epoch: 17, Steps: 12 | Train Loss: 0.411 Vali Loss: 1.585 Vali Acc: 0.711 Test Loss: 1.585 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2838866710662842
Epoch: 18, Steps: 12 | Train Loss: 0.358 Vali Loss: 2.100 Vali Acc: 0.700 Test Loss: 2.100 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3414793014526367
Epoch: 19, Steps: 12 | Train Loss: 0.505 Vali Loss: 1.477 Vali Acc: 0.733 Test Loss: 1.477 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2359349727630615
Epoch: 20, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.913 Vali Acc: 0.689 Test Loss: 1.913 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1657228469848633
Epoch: 21, Steps: 12 | Train Loss: 0.440 Vali Loss: 2.429 Vali Acc: 0.733 Test Loss: 2.429 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9418902397155762
Epoch: 22, Steps: 12 | Train Loss: 0.304 Vali Loss: 2.310 Vali Acc: 0.717 Test Loss: 2.310 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9331028461456299
Epoch: 23, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.928 Vali Acc: 0.733 Test Loss: 1.928 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9749569892883301
Epoch: 24, Steps: 12 | Train Loss: 0.188 Vali Loss: 2.786 Vali Acc: 0.683 Test Loss: 2.786 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7388888888888889
model parameter : 29794575
model size : 128.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8167767524719238
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.611 Vali Acc: 0.244 Test Loss: 2.611 Test Acc: 0.244
Validation loss decreased (inf --> -0.244418).  Saving model ...
Epoch: 2 cost time: 1.140641212463379
Epoch: 2, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.225 Vali Acc: 0.389 Test Loss: 2.225 Test Acc: 0.389
Validation loss decreased (-0.244418 --> -0.388867).  Saving model ...
Epoch: 3 cost time: 1.0879583358764648
Epoch: 3, Steps: 12 | Train Loss: 2.010 Vali Loss: 1.766 Vali Acc: 0.556 Test Loss: 1.766 Test Acc: 0.556
Validation loss decreased (-0.388867 --> -0.555538).  Saving model ...
Epoch: 4 cost time: 0.9890296459197998
Epoch: 4, Steps: 12 | Train Loss: 1.567 Vali Loss: 1.480 Vali Acc: 0.561 Test Loss: 1.480 Test Acc: 0.561
Validation loss decreased (-0.555538 --> -0.561096).  Saving model ...
Epoch: 5 cost time: 1.2076516151428223
Epoch: 5, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.239 Vali Acc: 0.578 Test Loss: 1.239 Test Acc: 0.578
Validation loss decreased (-0.561096 --> -0.577765).  Saving model ...
Epoch: 6 cost time: 1.2951457500457764
Epoch: 6, Steps: 12 | Train Loss: 0.957 Vali Loss: 1.109 Vali Acc: 0.606 Test Loss: 1.109 Test Acc: 0.606
Validation loss decreased (-0.577765 --> -0.605544).  Saving model ...
Epoch: 7 cost time: 1.2158610820770264
Epoch: 7, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.965 Vali Acc: 0.628 Test Loss: 0.965 Test Acc: 0.628
Validation loss decreased (-0.605544 --> -0.627768).  Saving model ...
Epoch: 8 cost time: 1.274869680404663
Epoch: 8, Steps: 12 | Train Loss: 0.866 Vali Loss: 1.020 Vali Acc: 0.633 Test Loss: 1.020 Test Acc: 0.633
Validation loss decreased (-0.627768 --> -0.633323).  Saving model ...
Epoch: 9 cost time: 1.2791931629180908
Epoch: 9, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.950 Vali Acc: 0.689 Test Loss: 0.950 Test Acc: 0.689
Validation loss decreased (-0.633323 --> -0.688879).  Saving model ...
Epoch: 10 cost time: 1.2039380073547363
Epoch: 10, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.861 Vali Acc: 0.750 Test Loss: 0.861 Test Acc: 0.750
Validation loss decreased (-0.688879 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 1.0742783546447754
Epoch: 11, Steps: 12 | Train Loss: 0.372 Vali Loss: 1.012 Vali Acc: 0.706 Test Loss: 1.012 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.865647554397583
Epoch: 12, Steps: 12 | Train Loss: 0.391 Vali Loss: 1.100 Vali Acc: 0.711 Test Loss: 1.100 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.060166597366333
Epoch: 13, Steps: 12 | Train Loss: 0.463 Vali Loss: 1.069 Vali Acc: 0.750 Test Loss: 1.069 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2206447124481201
Epoch: 14, Steps: 12 | Train Loss: 0.410 Vali Loss: 1.175 Vali Acc: 0.700 Test Loss: 1.175 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8149664402008057
Epoch: 15, Steps: 12 | Train Loss: 0.246 Vali Loss: 1.004 Vali Acc: 0.772 Test Loss: 1.004 Test Acc: 0.772
Validation loss decreased (-0.749991 --> -0.772212).  Saving model ...
Epoch: 16 cost time: 0.918900728225708
Epoch: 16, Steps: 12 | Train Loss: 0.420 Vali Loss: 1.326 Vali Acc: 0.694 Test Loss: 1.326 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7814795970916748
Epoch: 17, Steps: 12 | Train Loss: 0.259 Vali Loss: 1.105 Vali Acc: 0.733 Test Loss: 1.105 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8481466770172119
Epoch: 18, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.126 Vali Acc: 0.728 Test Loss: 1.126 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9892539978027344
Epoch: 19, Steps: 12 | Train Loss: 0.227 Vali Loss: 1.047 Vali Acc: 0.789 Test Loss: 1.047 Test Acc: 0.789
Validation loss decreased (-0.772212 --> -0.788878).  Saving model ...
Epoch: 20 cost time: 0.8260655403137207
Epoch: 20, Steps: 12 | Train Loss: 0.235 Vali Loss: 1.314 Vali Acc: 0.767 Test Loss: 1.314 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0251100063323975
Epoch: 21, Steps: 12 | Train Loss: 0.123 Vali Loss: 1.348 Vali Acc: 0.761 Test Loss: 1.348 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9055988788604736
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.293 Vali Acc: 0.739 Test Loss: 1.293 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8594543933868408
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.707 Vali Acc: 0.744 Test Loss: 1.707 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7244057655334473
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.552 Vali Acc: 0.744 Test Loss: 1.552 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9803550243377686
Epoch: 25, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.383 Vali Acc: 0.761 Test Loss: 1.383 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.175020694732666
Epoch: 26, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.434 Vali Acc: 0.767 Test Loss: 1.434 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9095983505249023
Epoch: 27, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.640 Vali Acc: 0.756 Test Loss: 1.640 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9324584007263184
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.578 Vali Acc: 0.778 Test Loss: 1.578 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9827322959899902
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.527 Vali Acc: 0.778 Test Loss: 1.527 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 29507343
model size : 127.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.552834987640381
Epoch: 1, Steps: 12 | Train Loss: 2.794 Vali Loss: 2.539 Vali Acc: 0.222 Test Loss: 2.539 Test Acc: 0.222
Validation loss decreased (inf --> -0.222197).  Saving model ...
Epoch: 2 cost time: 1.3217878341674805
Epoch: 2, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.035 Vali Acc: 0.483 Test Loss: 2.035 Test Acc: 0.483
Validation loss decreased (-0.222197 --> -0.483313).  Saving model ...
Epoch: 3 cost time: 1.0164387226104736
Epoch: 3, Steps: 12 | Train Loss: 1.735 Vali Loss: 1.607 Vali Acc: 0.589 Test Loss: 1.607 Test Acc: 0.589
Validation loss decreased (-0.483313 --> -0.588873).  Saving model ...
Epoch: 4 cost time: 1.0318207740783691
Epoch: 4, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.462 Vali Acc: 0.528 Test Loss: 1.462 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.138798713684082
Epoch: 5, Steps: 12 | Train Loss: 1.113 Vali Loss: 1.229 Vali Acc: 0.617 Test Loss: 1.229 Test Acc: 0.617
Validation loss decreased (-0.588873 --> -0.616654).  Saving model ...
Epoch: 6 cost time: 1.181037187576294
Epoch: 6, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.090 Vali Acc: 0.622 Test Loss: 1.090 Test Acc: 0.622
Validation loss decreased (-0.616654 --> -0.622211).  Saving model ...
Epoch: 7 cost time: 1.159273624420166
Epoch: 7, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.969 Vali Acc: 0.667 Test Loss: 0.969 Test Acc: 0.667
Validation loss decreased (-0.622211 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 1.2073864936828613
Epoch: 8, Steps: 12 | Train Loss: 0.607 Vali Loss: 1.060 Vali Acc: 0.706 Test Loss: 1.060 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705545).  Saving model ...
Epoch: 9 cost time: 1.1666207313537598
Epoch: 9, Steps: 12 | Train Loss: 0.708 Vali Loss: 1.403 Vali Acc: 0.678 Test Loss: 1.403 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0725624561309814
Epoch: 10, Steps: 12 | Train Loss: 0.586 Vali Loss: 1.308 Vali Acc: 0.700 Test Loss: 1.308 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.03511643409729
Epoch: 11, Steps: 12 | Train Loss: 0.500 Vali Loss: 1.266 Vali Acc: 0.694 Test Loss: 1.266 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3487286567687988
Epoch: 12, Steps: 12 | Train Loss: 0.430 Vali Loss: 1.401 Vali Acc: 0.711 Test Loss: 1.401 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711097).  Saving model ...
Epoch: 13 cost time: 1.4379370212554932
Epoch: 13, Steps: 12 | Train Loss: 0.576 Vali Loss: 1.430 Vali Acc: 0.711 Test Loss: 1.430 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0927340984344482
Epoch: 14, Steps: 12 | Train Loss: 0.396 Vali Loss: 1.412 Vali Acc: 0.700 Test Loss: 1.412 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.065227746963501
Epoch: 15, Steps: 12 | Train Loss: 0.338 Vali Loss: 1.532 Vali Acc: 0.678 Test Loss: 1.532 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1425213813781738
Epoch: 16, Steps: 12 | Train Loss: 0.416 Vali Loss: 1.720 Vali Acc: 0.689 Test Loss: 1.720 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2207350730895996
Epoch: 17, Steps: 12 | Train Loss: 0.552 Vali Loss: 1.556 Vali Acc: 0.711 Test Loss: 1.556 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2160673141479492
Epoch: 18, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.787 Vali Acc: 0.683 Test Loss: 1.787 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2541370391845703
Epoch: 19, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.795 Vali Acc: 0.706 Test Loss: 1.795 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.149357557296753
Epoch: 20, Steps: 12 | Train Loss: 0.316 Vali Loss: 2.555 Vali Acc: 0.667 Test Loss: 2.555 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4537014961242676
Epoch: 21, Steps: 12 | Train Loss: 0.603 Vali Loss: 1.820 Vali Acc: 0.739 Test Loss: 1.820 Test Acc: 0.739
Validation loss decreased (-0.711097 --> -0.738871).  Saving model ...
Epoch: 22 cost time: 1.2833261489868164
Epoch: 22, Steps: 12 | Train Loss: 0.292 Vali Loss: 1.799 Vali Acc: 0.733 Test Loss: 1.799 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2230613231658936
Epoch: 23, Steps: 12 | Train Loss: 0.323 Vali Loss: 2.049 Vali Acc: 0.678 Test Loss: 2.049 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.269754409790039
Epoch: 24, Steps: 12 | Train Loss: 0.284 Vali Loss: 2.170 Vali Acc: 0.744 Test Loss: 2.170 Test Acc: 0.744
Validation loss decreased (-0.738871 --> -0.744423).  Saving model ...
Epoch: 25 cost time: 1.1109285354614258
Epoch: 25, Steps: 12 | Train Loss: 0.154 Vali Loss: 2.333 Vali Acc: 0.678 Test Loss: 2.333 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2231431007385254
Epoch: 26, Steps: 12 | Train Loss: 0.195 Vali Loss: 2.233 Vali Acc: 0.711 Test Loss: 2.233 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1693315505981445
Epoch: 27, Steps: 12 | Train Loss: 0.165 Vali Loss: 2.438 Vali Acc: 0.689 Test Loss: 2.438 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2263948917388916
Epoch: 28, Steps: 12 | Train Loss: 0.198 Vali Loss: 2.299 Vali Acc: 0.689 Test Loss: 2.299 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0533125400543213
Epoch: 29, Steps: 12 | Train Loss: 0.220 Vali Loss: 2.898 Vali Acc: 0.694 Test Loss: 2.898 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.208556890487671
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 2.475 Vali Acc: 0.733 Test Loss: 2.475 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1078150272369385
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 2.337 Vali Acc: 0.717 Test Loss: 2.337 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2348055839538574
Epoch: 32, Steps: 12 | Train Loss: 0.330 Vali Loss: 2.931 Vali Acc: 0.711 Test Loss: 2.931 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1884572505950928
Epoch: 33, Steps: 12 | Train Loss: 0.118 Vali Loss: 2.595 Vali Acc: 0.711 Test Loss: 2.595 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2718358039855957
Epoch: 34, Steps: 12 | Train Loss: 0.224 Vali Loss: 3.321 Vali Acc: 0.700 Test Loss: 3.321 Test Acc: 0.700
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 29786127
model size : 128.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.442124605178833
Epoch: 1, Steps: 12 | Train Loss: 2.751 Vali Loss: 2.570 Vali Acc: 0.239 Test Loss: 2.570 Test Acc: 0.239
Validation loss decreased (inf --> -0.238863).  Saving model ...
Epoch: 2 cost time: 0.997645378112793
Epoch: 2, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.244 Vali Acc: 0.433 Test Loss: 2.244 Test Acc: 0.433
Validation loss decreased (-0.238863 --> -0.433311).  Saving model ...
Epoch: 3 cost time: 0.992450475692749
Epoch: 3, Steps: 12 | Train Loss: 2.047 Vali Loss: 1.884 Vali Acc: 0.478 Test Loss: 1.884 Test Acc: 0.478
Validation loss decreased (-0.433311 --> -0.477759).  Saving model ...
Epoch: 4 cost time: 1.0003983974456787
Epoch: 4, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.558 Vali Acc: 0.550 Test Loss: 1.558 Test Acc: 0.550
Validation loss decreased (-0.477759 --> -0.549984).  Saving model ...
Epoch: 5 cost time: 0.959542989730835
Epoch: 5, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.298 Vali Acc: 0.572 Test Loss: 1.298 Test Acc: 0.572
Validation loss decreased (-0.549984 --> -0.572209).  Saving model ...
Epoch: 6 cost time: 0.994699239730835
Epoch: 6, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.069 Vali Acc: 0.628 Test Loss: 1.069 Test Acc: 0.628
Validation loss decreased (-0.572209 --> -0.627767).  Saving model ...
Epoch: 7 cost time: 1.0458154678344727
Epoch: 7, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.627767 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.8072831630706787
Epoch: 8, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.053 Vali Acc: 0.661 Test Loss: 1.053 Test Acc: 0.661
Validation loss decreased (-0.649990 --> -0.661101).  Saving model ...
Epoch: 9 cost time: 0.7576596736907959
Epoch: 9, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.900 Vali Acc: 0.700 Test Loss: 0.900 Test Acc: 0.700
Validation loss decreased (-0.661101 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.8402137756347656
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.880 Vali Acc: 0.711 Test Loss: 0.880 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711102).  Saving model ...
Epoch: 11 cost time: 1.0813627243041992
Epoch: 11, Steps: 12 | Train Loss: 0.435 Vali Loss: 1.007 Vali Acc: 0.706 Test Loss: 1.007 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1619973182678223
Epoch: 12, Steps: 12 | Train Loss: 0.390 Vali Loss: 1.009 Vali Acc: 0.722 Test Loss: 1.009 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722212).  Saving model ...
Epoch: 13 cost time: 1.0170328617095947
Epoch: 13, Steps: 12 | Train Loss: 0.309 Vali Loss: 1.040 Vali Acc: 0.722 Test Loss: 1.040 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1267874240875244
Epoch: 14, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.993 Vali Acc: 0.750 Test Loss: 0.993 Test Acc: 0.750
Validation loss decreased (-0.722212 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 1.1106846332550049
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 1.044 Vali Acc: 0.761 Test Loss: 1.044 Test Acc: 0.761
Validation loss decreased (-0.749990 --> -0.761101).  Saving model ...
Epoch: 16 cost time: 0.9837520122528076
Epoch: 16, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.998 Vali Acc: 0.739 Test Loss: 0.998 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8620738983154297
Epoch: 17, Steps: 12 | Train Loss: 0.280 Vali Loss: 1.301 Vali Acc: 0.728 Test Loss: 1.301 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8909757137298584
Epoch: 18, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.446 Vali Acc: 0.722 Test Loss: 1.446 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1019625663757324
Epoch: 19, Steps: 12 | Train Loss: 0.295 Vali Loss: 1.160 Vali Acc: 0.778 Test Loss: 1.160 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777766).  Saving model ...
Epoch: 20 cost time: 1.2866733074188232
Epoch: 20, Steps: 12 | Train Loss: 0.268 Vali Loss: 1.059 Vali Acc: 0.761 Test Loss: 1.059 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2043836116790771
Epoch: 21, Steps: 12 | Train Loss: 0.254 Vali Loss: 1.136 Vali Acc: 0.750 Test Loss: 1.136 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0817828178405762
Epoch: 22, Steps: 12 | Train Loss: 0.216 Vali Loss: 1.256 Vali Acc: 0.739 Test Loss: 1.256 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.901986837387085
Epoch: 23, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.309 Vali Acc: 0.756 Test Loss: 1.309 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6618080139160156
Epoch: 24, Steps: 12 | Train Loss: 0.181 Vali Loss: 1.572 Vali Acc: 0.706 Test Loss: 1.572 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7738313674926758
Epoch: 25, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.532 Vali Acc: 0.756 Test Loss: 1.532 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6980247497558594
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.773 Vali Acc: 0.733 Test Loss: 1.773 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6089153289794922
Epoch: 27, Steps: 12 | Train Loss: 0.152 Vali Loss: 1.334 Vali Acc: 0.761 Test Loss: 1.334 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9189052581787109
Epoch: 28, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.496 Vali Acc: 0.739 Test Loss: 1.496 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7626867294311523
Epoch: 29, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.552 Vali Acc: 0.750 Test Loss: 1.552 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 29511951
model size : 127.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1894800662994385
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.595 Vali Acc: 0.178 Test Loss: 2.595 Test Acc: 0.178
Validation loss decreased (inf --> -0.177752).  Saving model ...
Epoch: 2 cost time: 0.6425223350524902
Epoch: 2, Steps: 12 | Train Loss: 2.547 Vali Loss: 2.378 Vali Acc: 0.367 Test Loss: 2.378 Test Acc: 0.367
Validation loss decreased (-0.177752 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 0.5612010955810547
Epoch: 3, Steps: 12 | Train Loss: 2.267 Vali Loss: 2.056 Vali Acc: 0.539 Test Loss: 2.056 Test Acc: 0.539
Validation loss decreased (-0.366643 --> -0.538868).  Saving model ...
Epoch: 4 cost time: 0.618741512298584
Epoch: 4, Steps: 12 | Train Loss: 1.949 Vali Loss: 1.710 Vali Acc: 0.561 Test Loss: 1.710 Test Acc: 0.561
Validation loss decreased (-0.538868 --> -0.561094).  Saving model ...
Epoch: 5 cost time: 0.7781059741973877
Epoch: 5, Steps: 12 | Train Loss: 1.546 Vali Loss: 1.373 Vali Acc: 0.622 Test Loss: 1.373 Test Acc: 0.622
Validation loss decreased (-0.561094 --> -0.622208).  Saving model ...
Epoch: 6 cost time: 0.7782559394836426
Epoch: 6, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.144 Vali Acc: 0.633 Test Loss: 1.144 Test Acc: 0.633
Validation loss decreased (-0.622208 --> -0.633322).  Saving model ...
Epoch: 7 cost time: 0.8252592086791992
Epoch: 7, Steps: 12 | Train Loss: 0.993 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.643578290939331
Epoch: 8, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.939 Vali Acc: 0.661 Test Loss: 0.939 Test Acc: 0.661
Validation loss decreased (-0.633322 --> -0.661102).  Saving model ...
Epoch: 9 cost time: 0.7208642959594727
Epoch: 9, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.905 Vali Acc: 0.650 Test Loss: 0.905 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8751192092895508
Epoch: 10, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
Validation loss decreased (-0.661102 --> -0.744436).  Saving model ...
Epoch: 11 cost time: 0.7519357204437256
Epoch: 11, Steps: 12 | Train Loss: 0.465 Vali Loss: 0.972 Vali Acc: 0.717 Test Loss: 0.972 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6514716148376465
Epoch: 12, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.827 Vali Acc: 0.744 Test Loss: 0.827 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6176900863647461
Epoch: 13, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.802 Vali Acc: 0.772 Test Loss: 0.802 Test Acc: 0.772
Validation loss decreased (-0.744436 --> -0.772214).  Saving model ...
Epoch: 14 cost time: 0.7354080677032471
Epoch: 14, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.942 Vali Acc: 0.733 Test Loss: 0.942 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7205994129180908
Epoch: 15, Steps: 12 | Train Loss: 0.255 Vali Loss: 1.007 Vali Acc: 0.756 Test Loss: 1.007 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7081699371337891
Epoch: 16, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.917 Vali Acc: 0.756 Test Loss: 0.917 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6707096099853516
Epoch: 17, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.934 Vali Acc: 0.783 Test Loss: 0.934 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783324).  Saving model ...
Epoch: 18 cost time: 0.683455228805542
Epoch: 18, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.900 Vali Acc: 0.783 Test Loss: 0.900 Test Acc: 0.783
Validation loss decreased (-0.783324 --> -0.783324).  Saving model ...
Epoch: 19 cost time: 0.6658897399902344
Epoch: 19, Steps: 12 | Train Loss: 0.143 Vali Loss: 1.024 Vali Acc: 0.767 Test Loss: 1.024 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6175055503845215
Epoch: 20, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.953 Vali Acc: 0.789 Test Loss: 0.953 Test Acc: 0.789
Validation loss decreased (-0.783324 --> -0.788879).  Saving model ...
Epoch: 21 cost time: 0.7340705394744873
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.059 Vali Acc: 0.756 Test Loss: 1.059 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6928539276123047
Epoch: 22, Steps: 12 | Train Loss: 0.172 Vali Loss: 1.099 Vali Acc: 0.767 Test Loss: 1.099 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7654225826263428
Epoch: 23, Steps: 12 | Train Loss: 0.158 Vali Loss: 1.087 Vali Acc: 0.772 Test Loss: 1.087 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7664883136749268
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.045 Vali Acc: 0.756 Test Loss: 1.045 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5840647220611572
Epoch: 25, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.044 Vali Acc: 0.767 Test Loss: 1.044 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5895123481750488
Epoch: 26, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.968 Vali Acc: 0.789 Test Loss: 0.968 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7940669059753418
Epoch: 27, Steps: 12 | Train Loss: 0.246 Vali Loss: 1.159 Vali Acc: 0.789 Test Loss: 1.159 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7206811904907227
Epoch: 28, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.091 Vali Acc: 0.778 Test Loss: 1.091 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.783693790435791
Epoch: 29, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.245 Vali Acc: 0.783 Test Loss: 1.245 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6665732860565186
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.063 Vali Acc: 0.800 Test Loss: 1.063 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799989).  Saving model ...
Epoch: 31 cost time: 0.9126286506652832
Epoch: 31, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.223 Vali Acc: 0.783 Test Loss: 1.223 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7762086391448975
Epoch: 32, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.151 Vali Acc: 0.772 Test Loss: 1.151 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7989654541015625
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.167 Vali Acc: 0.806 Test Loss: 1.167 Test Acc: 0.806
Validation loss decreased (-0.799989 --> -0.805544).  Saving model ...
Epoch: 34 cost time: 0.7806413173675537
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.999 Vali Acc: 0.839 Test Loss: 0.999 Test Acc: 0.839
Validation loss decreased (-0.805544 --> -0.838879).  Saving model ...
Epoch: 35 cost time: 0.6353530883789062
Epoch: 35, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.295 Vali Acc: 0.789 Test Loss: 1.295 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7821927070617676
Epoch: 36, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.160 Vali Acc: 0.789 Test Loss: 1.160 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7440629005432129
Epoch: 37, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.342 Vali Acc: 0.789 Test Loss: 1.342 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8710155487060547
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.202 Vali Acc: 0.789 Test Loss: 1.202 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7972395420074463
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.259 Vali Acc: 0.794 Test Loss: 1.259 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7637712955474854
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.180 Vali Acc: 0.789 Test Loss: 1.180 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8124980926513672
Epoch: 41, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.329 Vali Acc: 0.794 Test Loss: 1.329 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6929311752319336
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.211 Vali Acc: 0.783 Test Loss: 1.211 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5482587814331055
Epoch: 43, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.283 Vali Acc: 0.817 Test Loss: 1.283 Test Acc: 0.817
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7682230472564697
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.281 Vali Acc: 0.789 Test Loss: 1.281 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 29420559
model size : 126.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.7418694496154785
Epoch: 1, Steps: 12 | Train Loss: 2.755 Vali Loss: 2.475 Vali Acc: 0.261 Test Loss: 2.475 Test Acc: 0.261
Validation loss decreased (inf --> -0.261086).  Saving model ...
Epoch: 2 cost time: 1.1821489334106445
Epoch: 2, Steps: 12 | Train Loss: 2.320 Vali Loss: 1.893 Vali Acc: 0.472 Test Loss: 1.893 Test Acc: 0.472
Validation loss decreased (-0.261086 --> -0.472203).  Saving model ...
Epoch: 3 cost time: 0.669069766998291
Epoch: 3, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.515 Vali Acc: 0.533 Test Loss: 1.515 Test Acc: 0.533
Validation loss decreased (-0.472203 --> -0.533318).  Saving model ...
Epoch: 4 cost time: 1.0667545795440674
Epoch: 4, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.266 Vali Acc: 0.567 Test Loss: 1.266 Test Acc: 0.567
Validation loss decreased (-0.533318 --> -0.566654).  Saving model ...
Epoch: 5 cost time: 0.9788062572479248
Epoch: 5, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.303 Vali Acc: 0.550 Test Loss: 1.303 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.96209716796875
Epoch: 6, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.180 Vali Acc: 0.611 Test Loss: 1.180 Test Acc: 0.611
Validation loss decreased (-0.566654 --> -0.611099).  Saving model ...
Epoch: 7 cost time: 0.9498789310455322
Epoch: 7, Steps: 12 | Train Loss: 0.691 Vali Loss: 1.040 Vali Acc: 0.678 Test Loss: 1.040 Test Acc: 0.678
Validation loss decreased (-0.611099 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 1.2282416820526123
Epoch: 8, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.192 Vali Acc: 0.706 Test Loss: 1.192 Test Acc: 0.706
Validation loss decreased (-0.677767 --> -0.705544).  Saving model ...
Epoch: 9 cost time: 1.3848481178283691
Epoch: 9, Steps: 12 | Train Loss: 0.553 Vali Loss: 1.162 Vali Acc: 0.717 Test Loss: 1.162 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716655).  Saving model ...
Epoch: 10 cost time: 1.343404769897461
Epoch: 10, Steps: 12 | Train Loss: 0.540 Vali Loss: 1.042 Vali Acc: 0.733 Test Loss: 1.042 Test Acc: 0.733
Validation loss decreased (-0.716655 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 0.9925580024719238
Epoch: 11, Steps: 12 | Train Loss: 0.411 Vali Loss: 1.141 Vali Acc: 0.733 Test Loss: 1.141 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2476398944854736
Epoch: 12, Steps: 12 | Train Loss: 0.450 Vali Loss: 1.370 Vali Acc: 0.694 Test Loss: 1.370 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.317436933517456
Epoch: 13, Steps: 12 | Train Loss: 0.373 Vali Loss: 1.882 Vali Acc: 0.689 Test Loss: 1.882 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0758557319641113
Epoch: 14, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.480 Vali Acc: 0.717 Test Loss: 1.480 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0576088428497314
Epoch: 15, Steps: 12 | Train Loss: 0.303 Vali Loss: 1.902 Vali Acc: 0.700 Test Loss: 1.902 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8363325595855713
Epoch: 16, Steps: 12 | Train Loss: 0.530 Vali Loss: 1.412 Vali Acc: 0.706 Test Loss: 1.412 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0366969108581543
Epoch: 17, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.599 Vali Acc: 0.717 Test Loss: 1.599 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1107139587402344
Epoch: 18, Steps: 12 | Train Loss: 0.349 Vali Loss: 1.509 Vali Acc: 0.750 Test Loss: 1.509 Test Acc: 0.750
Validation loss decreased (-0.733323 --> -0.749985).  Saving model ...
Epoch: 19 cost time: 0.923027753829956
Epoch: 19, Steps: 12 | Train Loss: 0.360 Vali Loss: 1.526 Vali Acc: 0.717 Test Loss: 1.526 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0029914379119873
Epoch: 20, Steps: 12 | Train Loss: 0.343 Vali Loss: 1.881 Vali Acc: 0.733 Test Loss: 1.881 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.15982985496521
Epoch: 21, Steps: 12 | Train Loss: 0.512 Vali Loss: 1.881 Vali Acc: 0.683 Test Loss: 1.881 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8573315143585205
Epoch: 22, Steps: 12 | Train Loss: 0.333 Vali Loss: 1.988 Vali Acc: 0.722 Test Loss: 1.988 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.035585641860962
Epoch: 23, Steps: 12 | Train Loss: 0.343 Vali Loss: 1.798 Vali Acc: 0.744 Test Loss: 1.798 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2086360454559326
Epoch: 24, Steps: 12 | Train Loss: 0.293 Vali Loss: 1.777 Vali Acc: 0.750 Test Loss: 1.777 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9442040920257568
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 2.135 Vali Acc: 0.728 Test Loss: 2.135 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8932318687438965
Epoch: 26, Steps: 12 | Train Loss: 0.250 Vali Loss: 2.168 Vali Acc: 0.761 Test Loss: 2.168 Test Acc: 0.761
Validation loss decreased (-0.749985 --> -0.761089).  Saving model ...
Epoch: 27 cost time: 1.0862505435943604
Epoch: 27, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.965 Vali Acc: 0.750 Test Loss: 1.965 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7491862773895264
Epoch: 28, Steps: 12 | Train Loss: 0.121 Vali Loss: 2.050 Vali Acc: 0.750 Test Loss: 2.050 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7363684177398682
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 2.172 Vali Acc: 0.761 Test Loss: 2.172 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6513016223907471
Epoch: 30, Steps: 12 | Train Loss: 0.084 Vali Loss: 2.294 Vali Acc: 0.728 Test Loss: 2.294 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2772483825683594
Epoch: 31, Steps: 12 | Train Loss: 0.093 Vali Loss: 2.777 Vali Acc: 0.711 Test Loss: 2.777 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2940449714660645
Epoch: 32, Steps: 12 | Train Loss: 0.252 Vali Loss: 2.759 Vali Acc: 0.733 Test Loss: 2.759 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1195313930511475
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 2.732 Vali Acc: 0.733 Test Loss: 2.732 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2293314933776855
Epoch: 34, Steps: 12 | Train Loss: 0.114 Vali Loss: 2.928 Vali Acc: 0.706 Test Loss: 2.928 Test Acc: 0.706
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1566193103790283
Epoch: 35, Steps: 12 | Train Loss: 0.138 Vali Loss: 2.975 Vali Acc: 0.728 Test Loss: 2.975 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8044109344482422
Epoch: 36, Steps: 12 | Train Loss: 0.141 Vali Loss: 3.065 Vali Acc: 0.711 Test Loss: 3.065 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 29777679
model size : 128.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.979463815689087
Epoch: 1, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.597 Vali Acc: 0.200 Test Loss: 2.597 Test Acc: 0.200
Validation loss decreased (inf --> -0.199974).  Saving model ...
Epoch: 2 cost time: 1.1097478866577148
Epoch: 2, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.242 Vali Acc: 0.411 Test Loss: 2.242 Test Acc: 0.411
Validation loss decreased (-0.199974 --> -0.411089).  Saving model ...
Epoch: 3 cost time: 0.7658646106719971
Epoch: 3, Steps: 12 | Train Loss: 1.963 Vali Loss: 1.795 Vali Acc: 0.494 Test Loss: 1.795 Test Acc: 0.494
Validation loss decreased (-0.411089 --> -0.494426).  Saving model ...
Epoch: 4 cost time: 0.7639284133911133
Epoch: 4, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.444 Vali Acc: 0.544 Test Loss: 1.444 Test Acc: 0.544
Validation loss decreased (-0.494426 --> -0.544430).  Saving model ...
Epoch: 5 cost time: 0.878366231918335
Epoch: 5, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.199 Vali Acc: 0.561 Test Loss: 1.199 Test Acc: 0.561
Validation loss decreased (-0.544430 --> -0.561099).  Saving model ...
Epoch: 6 cost time: 0.9414057731628418
Epoch: 6, Steps: 12 | Train Loss: 1.055 Vali Loss: 1.074 Vali Acc: 0.611 Test Loss: 1.074 Test Acc: 0.611
Validation loss decreased (-0.561099 --> -0.611100).  Saving model ...
Epoch: 7 cost time: 0.7437117099761963
Epoch: 7, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.987 Vali Acc: 0.678 Test Loss: 0.987 Test Acc: 0.678
Validation loss decreased (-0.611100 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 1.1586041450500488
Epoch: 8, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.972 Vali Acc: 0.628 Test Loss: 0.972 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1283388137817383
Epoch: 9, Steps: 12 | Train Loss: 0.655 Vali Loss: 1.116 Vali Acc: 0.650 Test Loss: 1.116 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0384821891784668
Epoch: 10, Steps: 12 | Train Loss: 0.584 Vali Loss: 1.141 Vali Acc: 0.678 Test Loss: 1.141 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9783668518066406
Epoch: 11, Steps: 12 | Train Loss: 0.554 Vali Loss: 1.116 Vali Acc: 0.633 Test Loss: 1.116 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7649273872375488
Epoch: 12, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
Validation loss decreased (-0.677768 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 0.816920280456543
Epoch: 13, Steps: 12 | Train Loss: 0.322 Vali Loss: 1.173 Vali Acc: 0.717 Test Loss: 1.173 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9017775058746338
Epoch: 14, Steps: 12 | Train Loss: 0.284 Vali Loss: 1.183 Vali Acc: 0.717 Test Loss: 1.183 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9427454471588135
Epoch: 15, Steps: 12 | Train Loss: 0.344 Vali Loss: 1.425 Vali Acc: 0.683 Test Loss: 1.425 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8891274929046631
Epoch: 16, Steps: 12 | Train Loss: 0.355 Vali Loss: 1.146 Vali Acc: 0.739 Test Loss: 1.146 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738877).  Saving model ...
Epoch: 17 cost time: 0.8490455150604248
Epoch: 17, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.218 Vali Acc: 0.756 Test Loss: 1.218 Test Acc: 0.756
Validation loss decreased (-0.738877 --> -0.755543).  Saving model ...
Epoch: 18 cost time: 0.6620151996612549
Epoch: 18, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.455 Vali Acc: 0.722 Test Loss: 1.455 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6889054775238037
Epoch: 19, Steps: 12 | Train Loss: 0.231 Vali Loss: 1.248 Vali Acc: 0.761 Test Loss: 1.248 Test Acc: 0.761
Validation loss decreased (-0.755543 --> -0.761099).  Saving model ...
Epoch: 20 cost time: 0.7950270175933838
Epoch: 20, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.430 Vali Acc: 0.717 Test Loss: 1.430 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9804589748382568
Epoch: 21, Steps: 12 | Train Loss: 0.219 Vali Loss: 1.266 Vali Acc: 0.761 Test Loss: 1.266 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1154701709747314
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.384 Vali Acc: 0.750 Test Loss: 1.384 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1320552825927734
Epoch: 23, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.478 Vali Acc: 0.744 Test Loss: 1.478 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9973227977752686
Epoch: 24, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.570 Vali Acc: 0.722 Test Loss: 1.570 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0570766925811768
Epoch: 25, Steps: 12 | Train Loss: 0.174 Vali Loss: 1.642 Vali Acc: 0.706 Test Loss: 1.642 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8178389072418213
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.565 Vali Acc: 0.739 Test Loss: 1.565 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.269968032836914
Epoch: 27, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.387 Vali Acc: 0.744 Test Loss: 1.387 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1305582523345947
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.590 Vali Acc: 0.744 Test Loss: 1.590 Test Acc: 0.744
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6826260089874268
Epoch: 29, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.500 Vali Acc: 0.767 Test Loss: 1.500 Test Acc: 0.767
Validation loss decreased (-0.761099 --> -0.766652).  Saving model ...
Epoch: 30 cost time: 0.955169677734375
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.379 Vali Acc: 0.739 Test Loss: 1.379 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9094524383544922
Epoch: 31, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.691 Vali Acc: 0.744 Test Loss: 1.691 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1071977615356445
Epoch: 32, Steps: 12 | Train Loss: 0.086 Vali Loss: 2.040 Vali Acc: 0.739 Test Loss: 2.040 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2796902656555176
Epoch: 33, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.608 Vali Acc: 0.750 Test Loss: 1.608 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9663207530975342
Epoch: 34, Steps: 12 | Train Loss: 0.131 Vali Loss: 2.133 Vali Acc: 0.767 Test Loss: 2.133 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1650199890136719
Epoch: 35, Steps: 12 | Train Loss: 0.171 Vali Loss: 1.837 Vali Acc: 0.739 Test Loss: 1.837 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1156251430511475
Epoch: 36, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.790 Vali Acc: 0.739 Test Loss: 1.790 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0865848064422607
Epoch: 37, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.818 Vali Acc: 0.750 Test Loss: 1.818 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.052258014678955
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.865 Vali Acc: 0.750 Test Loss: 1.865 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.261707067489624
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.823 Vali Acc: 0.739 Test Loss: 1.823 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 29503503
model size : 127.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.12667179107666
Epoch: 1, Steps: 12 | Train Loss: 2.824 Vali Loss: 2.664 Vali Acc: 0.156 Test Loss: 2.664 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 0.6953048706054688
Epoch: 2, Steps: 12 | Train Loss: 2.507 Vali Loss: 2.383 Vali Acc: 0.383 Test Loss: 2.383 Test Acc: 0.383
Validation loss decreased (-0.155529 --> -0.383310).  Saving model ...
Epoch: 3 cost time: 0.7526564598083496
Epoch: 3, Steps: 12 | Train Loss: 2.257 Vali Loss: 2.106 Vali Acc: 0.483 Test Loss: 2.106 Test Acc: 0.483
Validation loss decreased (-0.383310 --> -0.483312).  Saving model ...
Epoch: 4 cost time: 0.671562910079956
Epoch: 4, Steps: 12 | Train Loss: 1.961 Vali Loss: 1.783 Vali Acc: 0.556 Test Loss: 1.783 Test Acc: 0.556
Validation loss decreased (-0.483312 --> -0.555538).  Saving model ...
Epoch: 5 cost time: 0.7088415622711182
Epoch: 5, Steps: 12 | Train Loss: 1.521 Vali Loss: 1.380 Vali Acc: 0.611 Test Loss: 1.380 Test Acc: 0.611
Validation loss decreased (-0.555538 --> -0.611097).  Saving model ...
Epoch: 6 cost time: 0.7271096706390381
Epoch: 6, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.160 Vali Acc: 0.628 Test Loss: 1.160 Test Acc: 0.628
Validation loss decreased (-0.611097 --> -0.627766).  Saving model ...
Epoch: 7 cost time: 0.7623887062072754
Epoch: 7, Steps: 12 | Train Loss: 1.067 Vali Loss: 0.992 Vali Acc: 0.633 Test Loss: 0.992 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633323).  Saving model ...
Epoch: 8 cost time: 0.7211368083953857
Epoch: 8, Steps: 12 | Train Loss: 0.831 Vali Loss: 0.916 Vali Acc: 0.639 Test Loss: 0.916 Test Acc: 0.639
Validation loss decreased (-0.633323 --> -0.638880).  Saving model ...
Epoch: 9 cost time: 0.6892707347869873
Epoch: 9, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.854 Vali Acc: 0.728 Test Loss: 0.854 Test Acc: 0.728
Validation loss decreased (-0.638880 --> -0.727769).  Saving model ...
Epoch: 10 cost time: 0.841759443283081
Epoch: 10, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.815 Vali Acc: 0.683 Test Loss: 0.815 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7416529655456543
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.7690200805664062
Epoch: 12, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.802 Vali Acc: 0.739 Test Loss: 0.802 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7020254135131836
Epoch: 13, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.906 Vali Acc: 0.728 Test Loss: 0.906 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9435131549835205
Epoch: 14, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.783325).  Saving model ...
Epoch: 15 cost time: 0.6563975811004639
Epoch: 15, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.820 Vali Acc: 0.756 Test Loss: 0.820 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8038265705108643
Epoch: 16, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8240880966186523
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.809 Vali Acc: 0.772 Test Loss: 0.809 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6429753303527832
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.824 Vali Acc: 0.828 Test Loss: 0.824 Test Acc: 0.828
Validation loss decreased (-0.783325 --> -0.827770).  Saving model ...
Epoch: 19 cost time: 0.6661543846130371
Epoch: 19, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7965836524963379
Epoch: 20, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.936 Vali Acc: 0.806 Test Loss: 0.936 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.619067907333374
Epoch: 21, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.822 Vali Acc: 0.828 Test Loss: 0.822 Test Acc: 0.828
Validation loss decreased (-0.827770 --> -0.827770).  Saving model ...
Epoch: 22 cost time: 0.864823579788208
Epoch: 22, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.975 Vali Acc: 0.789 Test Loss: 0.975 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7885980606079102
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.975 Vali Acc: 0.789 Test Loss: 0.975 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7545409202575684
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.969 Vali Acc: 0.778 Test Loss: 0.969 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6725118160247803
Epoch: 25, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.969 Vali Acc: 0.822 Test Loss: 0.969 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7572102546691895
Epoch: 26, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.006 Vali Acc: 0.800 Test Loss: 1.006 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6910278797149658
Epoch: 27, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.907 Vali Acc: 0.817 Test Loss: 0.907 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6655492782592773
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.963 Vali Acc: 0.783 Test Loss: 0.963 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6436982154846191
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.095 Vali Acc: 0.794 Test Loss: 1.095 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6052122116088867
Epoch: 30, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.024 Vali Acc: 0.783 Test Loss: 1.024 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6767611503601074
Epoch: 31, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.130 Vali Acc: 0.811 Test Loss: 1.130 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 29372943
model size : 126.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.182708501815796
Epoch: 1, Steps: 12 | Train Loss: 2.792 Vali Loss: 2.618 Vali Acc: 0.161 Test Loss: 2.618 Test Acc: 0.161
Validation loss decreased (inf --> -0.161085).  Saving model ...
Epoch: 2 cost time: 0.9509856700897217
Epoch: 2, Steps: 12 | Train Loss: 2.496 Vali Loss: 2.279 Vali Acc: 0.439 Test Loss: 2.279 Test Acc: 0.439
Validation loss decreased (-0.161085 --> -0.438866).  Saving model ...
Epoch: 3 cost time: 0.739368200302124
Epoch: 3, Steps: 12 | Train Loss: 2.079 Vali Loss: 1.894 Vali Acc: 0.517 Test Loss: 1.894 Test Acc: 0.517
Validation loss decreased (-0.438866 --> -0.516648).  Saving model ...
Epoch: 4 cost time: 0.8490519523620605
Epoch: 4, Steps: 12 | Train Loss: 1.625 Vali Loss: 1.576 Vali Acc: 0.544 Test Loss: 1.576 Test Acc: 0.544
Validation loss decreased (-0.516648 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 0.8508880138397217
Epoch: 5, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.357 Vali Acc: 0.561 Test Loss: 1.357 Test Acc: 0.561
Validation loss decreased (-0.544429 --> -0.561098).  Saving model ...
Epoch: 6 cost time: 0.8776183128356934
Epoch: 6, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.251 Vali Acc: 0.572 Test Loss: 1.251 Test Acc: 0.572
Validation loss decreased (-0.561098 --> -0.572210).  Saving model ...
Epoch: 7 cost time: 1.0353703498840332
Epoch: 7, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.108 Vali Acc: 0.622 Test Loss: 1.108 Test Acc: 0.622
Validation loss decreased (-0.572210 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 0.9492433071136475
Epoch: 8, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.137 Vali Acc: 0.639 Test Loss: 1.137 Test Acc: 0.639
Validation loss decreased (-0.622211 --> -0.638878).  Saving model ...
Epoch: 9 cost time: 0.953547477722168
Epoch: 9, Steps: 12 | Train Loss: 0.616 Vali Loss: 1.123 Vali Acc: 0.683 Test Loss: 1.123 Test Acc: 0.683
Validation loss decreased (-0.638878 --> -0.683322).  Saving model ...
Epoch: 10 cost time: 1.1003024578094482
Epoch: 10, Steps: 12 | Train Loss: 0.607 Vali Loss: 1.088 Vali Acc: 0.672 Test Loss: 1.088 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7387957572937012
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 1.120 Vali Acc: 0.678 Test Loss: 1.120 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7652890682220459
Epoch: 12, Steps: 12 | Train Loss: 0.492 Vali Loss: 1.345 Vali Acc: 0.678 Test Loss: 1.345 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9174809455871582
Epoch: 13, Steps: 12 | Train Loss: 0.512 Vali Loss: 1.157 Vali Acc: 0.706 Test Loss: 1.157 Test Acc: 0.706
Validation loss decreased (-0.683322 --> -0.705544).  Saving model ...
Epoch: 14 cost time: 0.7776343822479248
Epoch: 14, Steps: 12 | Train Loss: 0.258 Vali Loss: 1.118 Vali Acc: 0.694 Test Loss: 1.118 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.73008131980896
Epoch: 15, Steps: 12 | Train Loss: 0.301 Vali Loss: 1.158 Vali Acc: 0.717 Test Loss: 1.158 Test Acc: 0.717
Validation loss decreased (-0.705544 --> -0.716655).  Saving model ...
Epoch: 16 cost time: 0.7972614765167236
Epoch: 16, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.174 Vali Acc: 0.717 Test Loss: 1.174 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9174339771270752
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.314 Vali Acc: 0.694 Test Loss: 1.314 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6924774646759033
Epoch: 18, Steps: 12 | Train Loss: 0.204 Vali Loss: 1.486 Vali Acc: 0.700 Test Loss: 1.486 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6183197498321533
Epoch: 19, Steps: 12 | Train Loss: 0.255 Vali Loss: 1.497 Vali Acc: 0.717 Test Loss: 1.497 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6885471343994141
Epoch: 20, Steps: 12 | Train Loss: 0.271 Vali Loss: 1.374 Vali Acc: 0.711 Test Loss: 1.374 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8246712684631348
Epoch: 21, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.501 Vali Acc: 0.700 Test Loss: 1.501 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6129906177520752
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.329 Vali Acc: 0.744 Test Loss: 1.329 Test Acc: 0.744
Validation loss decreased (-0.716655 --> -0.744431).  Saving model ...
Epoch: 23 cost time: 0.8462009429931641
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.275 Vali Acc: 0.756 Test Loss: 1.275 Test Acc: 0.756
Validation loss decreased (-0.744431 --> -0.755543).  Saving model ...
Epoch: 24 cost time: 0.578035831451416
Epoch: 24, Steps: 12 | Train Loss: 0.138 Vali Loss: 1.436 Vali Acc: 0.789 Test Loss: 1.436 Test Acc: 0.789
Validation loss decreased (-0.755543 --> -0.788875).  Saving model ...
Epoch: 25 cost time: 0.515394926071167
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.636 Vali Acc: 0.767 Test Loss: 1.636 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5627412796020508
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.961 Vali Acc: 0.778 Test Loss: 1.961 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5717816352844238
Epoch: 27, Steps: 12 | Train Loss: 0.208 Vali Loss: 1.448 Vali Acc: 0.783 Test Loss: 1.448 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5397858619689941
Epoch: 28, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.842 Vali Acc: 0.728 Test Loss: 1.842 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7701034545898438
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.793 Vali Acc: 0.750 Test Loss: 1.793 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0132598876953125
Epoch: 30, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.736 Vali Acc: 0.772 Test Loss: 1.736 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.86012864112854
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.802 Vali Acc: 0.778 Test Loss: 1.802 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8450708389282227
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.846 Vali Acc: 0.750 Test Loss: 1.846 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.761937141418457
Epoch: 33, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.706 Vali Acc: 0.778 Test Loss: 1.706 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7745821475982666
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.759 Vali Acc: 0.761 Test Loss: 1.759 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 29508111
model size : 127.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0502405166625977
Epoch: 1, Steps: 12 | Train Loss: 2.781 Vali Loss: 2.606 Vali Acc: 0.089 Test Loss: 2.606 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 0.6516678333282471
Epoch: 2, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.389 Vali Acc: 0.383 Test Loss: 2.389 Test Acc: 0.383
Validation loss decreased (-0.088863 --> -0.383309).  Saving model ...
Epoch: 3 cost time: 0.6834192276000977
Epoch: 3, Steps: 12 | Train Loss: 2.285 Vali Loss: 2.082 Vali Acc: 0.533 Test Loss: 2.082 Test Acc: 0.533
Validation loss decreased (-0.383309 --> -0.533313).  Saving model ...
Epoch: 4 cost time: 0.6204462051391602
Epoch: 4, Steps: 12 | Train Loss: 1.907 Vali Loss: 1.763 Vali Acc: 0.550 Test Loss: 1.763 Test Acc: 0.550
Validation loss decreased (-0.533313 --> -0.549982).  Saving model ...
Epoch: 5 cost time: 0.54205322265625
Epoch: 5, Steps: 12 | Train Loss: 1.659 Vali Loss: 1.484 Vali Acc: 0.572 Test Loss: 1.484 Test Acc: 0.572
Validation loss decreased (-0.549982 --> -0.572207).  Saving model ...
Epoch: 6 cost time: 0.6599082946777344
Epoch: 6, Steps: 12 | Train Loss: 1.321 Vali Loss: 1.265 Vali Acc: 0.583 Test Loss: 1.265 Test Acc: 0.583
Validation loss decreased (-0.572207 --> -0.583321).  Saving model ...
Epoch: 7 cost time: 0.6028594970703125
Epoch: 7, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.166 Vali Acc: 0.622 Test Loss: 1.166 Test Acc: 0.622
Validation loss decreased (-0.583321 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 0.5295720100402832
Epoch: 8, Steps: 12 | Train Loss: 0.793 Vali Loss: 1.116 Vali Acc: 0.650 Test Loss: 1.116 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.6305513381958008
Epoch: 9, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.138 Vali Acc: 0.639 Test Loss: 1.138 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6492941379547119
Epoch: 10, Steps: 12 | Train Loss: 0.576 Vali Loss: 1.250 Vali Acc: 0.644 Test Loss: 1.250 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.672006368637085
Epoch: 11, Steps: 12 | Train Loss: 0.501 Vali Loss: 1.104 Vali Acc: 0.672 Test Loss: 1.104 Test Acc: 0.672
Validation loss decreased (-0.649989 --> -0.672211).  Saving model ...
Epoch: 12 cost time: 0.721297025680542
Epoch: 12, Steps: 12 | Train Loss: 0.399 Vali Loss: 1.028 Vali Acc: 0.694 Test Loss: 1.028 Test Acc: 0.694
Validation loss decreased (-0.672211 --> -0.694434).  Saving model ...
Epoch: 13 cost time: 0.5823731422424316
Epoch: 13, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.981 Vali Acc: 0.717 Test Loss: 0.981 Test Acc: 0.717
Validation loss decreased (-0.694434 --> -0.716657).  Saving model ...
Epoch: 14 cost time: 0.6712687015533447
Epoch: 14, Steps: 12 | Train Loss: 0.292 Vali Loss: 1.144 Vali Acc: 0.689 Test Loss: 1.144 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6625170707702637
Epoch: 15, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.910 Vali Acc: 0.739 Test Loss: 0.910 Test Acc: 0.739
Validation loss decreased (-0.716657 --> -0.738880).  Saving model ...
Epoch: 16 cost time: 0.6949920654296875
Epoch: 16, Steps: 12 | Train Loss: 0.321 Vali Loss: 1.196 Vali Acc: 0.728 Test Loss: 1.196 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6034755706787109
Epoch: 17, Steps: 12 | Train Loss: 0.267 Vali Loss: 1.133 Vali Acc: 0.728 Test Loss: 1.133 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.613044261932373
Epoch: 18, Steps: 12 | Train Loss: 0.166 Vali Loss: 1.134 Vali Acc: 0.717 Test Loss: 1.134 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6495761871337891
Epoch: 19, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.075 Vali Acc: 0.750 Test Loss: 1.075 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749989).  Saving model ...
Epoch: 20 cost time: 0.7051403522491455
Epoch: 20, Steps: 12 | Train Loss: 0.161 Vali Loss: 1.071 Vali Acc: 0.750 Test Loss: 1.071 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 21 cost time: 0.6120691299438477
Epoch: 21, Steps: 12 | Train Loss: 0.098 Vali Loss: 1.196 Vali Acc: 0.739 Test Loss: 1.196 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6417081356048584
Epoch: 22, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.204 Vali Acc: 0.767 Test Loss: 1.204 Test Acc: 0.767
Validation loss decreased (-0.749989 --> -0.766655).  Saving model ...
Epoch: 23 cost time: 0.6822710037231445
Epoch: 23, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.171 Vali Acc: 0.789 Test Loss: 1.171 Test Acc: 0.789
Validation loss decreased (-0.766655 --> -0.788877).  Saving model ...
Epoch: 24 cost time: 0.7104082107543945
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.191 Vali Acc: 0.733 Test Loss: 1.191 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6211423873901367
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.224 Vali Acc: 0.794 Test Loss: 1.224 Test Acc: 0.794
Validation loss decreased (-0.788877 --> -0.794432).  Saving model ...
Epoch: 26 cost time: 0.7085831165313721
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.240 Vali Acc: 0.767 Test Loss: 1.240 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.620067834854126
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.210 Vali Acc: 0.811 Test Loss: 1.210 Test Acc: 0.811
Validation loss decreased (-0.794432 --> -0.811099).  Saving model ...
Epoch: 28 cost time: 0.7668361663818359
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.455 Vali Acc: 0.783 Test Loss: 1.455 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7362046241760254
Epoch: 29, Steps: 12 | Train Loss: 0.081 Vali Loss: 1.528 Vali Acc: 0.722 Test Loss: 1.528 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6570332050323486
Epoch: 30, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.586 Vali Acc: 0.778 Test Loss: 1.586 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7272112369537354
Epoch: 31, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.287 Vali Acc: 0.772 Test Loss: 1.287 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6896927356719971
Epoch: 32, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.273 Vali Acc: 0.800 Test Loss: 1.273 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5909183025360107
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.449 Vali Acc: 0.794 Test Loss: 1.449 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6667666435241699
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.341 Vali Acc: 0.778 Test Loss: 1.341 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.644223690032959
Epoch: 35, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.310 Vali Acc: 0.811 Test Loss: 1.310 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6244165897369385
Epoch: 36, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.349 Vali Acc: 0.806 Test Loss: 1.349 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6070461273193359
Epoch: 37, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.342 Vali Acc: 0.806 Test Loss: 1.342 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 29416719
model size : 126.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.053109645843506
Epoch: 1, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.614 Vali Acc: 0.128 Test Loss: 2.614 Test Acc: 0.128
Validation loss decreased (inf --> -0.127752).  Saving model ...
Epoch: 2 cost time: 0.7128758430480957
Epoch: 2, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.425 Vali Acc: 0.283 Test Loss: 2.425 Test Acc: 0.283
Validation loss decreased (-0.127752 --> -0.283309).  Saving model ...
Epoch: 3 cost time: 0.5964558124542236
Epoch: 3, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.205 Vali Acc: 0.472 Test Loss: 2.205 Test Acc: 0.472
Validation loss decreased (-0.283309 --> -0.472200).  Saving model ...
Epoch: 4 cost time: 0.5791902542114258
Epoch: 4, Steps: 12 | Train Loss: 2.043 Vali Loss: 1.942 Vali Acc: 0.506 Test Loss: 1.942 Test Acc: 0.506
Validation loss decreased (-0.472200 --> -0.505536).  Saving model ...
Epoch: 5 cost time: 0.636559247970581
Epoch: 5, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.643 Vali Acc: 0.539 Test Loss: 1.643 Test Acc: 0.539
Validation loss decreased (-0.505536 --> -0.538872).  Saving model ...
Epoch: 6 cost time: 0.7001934051513672
Epoch: 6, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.429 Vali Acc: 0.528 Test Loss: 1.429 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6630501747131348
Epoch: 7, Steps: 12 | Train Loss: 1.132 Vali Loss: 1.208 Vali Acc: 0.578 Test Loss: 1.208 Test Acc: 0.578
Validation loss decreased (-0.538872 --> -0.577766).  Saving model ...
Epoch: 8 cost time: 0.6133749485015869
Epoch: 8, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.077 Vali Acc: 0.628 Test Loss: 1.077 Test Acc: 0.628
Validation loss decreased (-0.577766 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 0.6229488849639893
Epoch: 9, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.951 Vali Acc: 0.644 Test Loss: 0.951 Test Acc: 0.644
Validation loss decreased (-0.627767 --> -0.644435).  Saving model ...
Epoch: 10 cost time: 0.6481907367706299
Epoch: 10, Steps: 12 | Train Loss: 0.636 Vali Loss: 0.926 Vali Acc: 0.706 Test Loss: 0.926 Test Acc: 0.706
Validation loss decreased (-0.644435 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 0.6490700244903564
Epoch: 11, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.898 Vali Acc: 0.728 Test Loss: 0.898 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727769).  Saving model ...
Epoch: 12 cost time: 0.5211548805236816
Epoch: 12, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.884 Vali Acc: 0.744 Test Loss: 0.884 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 13 cost time: 0.630652666091919
Epoch: 13, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 14 cost time: 0.5575380325317383
Epoch: 14, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.848 Vali Acc: 0.756 Test Loss: 0.848 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.535236120223999
Epoch: 15, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.790 Vali Acc: 0.789 Test Loss: 0.790 Test Acc: 0.789
Validation loss decreased (-0.761103 --> -0.788881).  Saving model ...
Epoch: 16 cost time: 0.5845072269439697
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7118842601776123
Epoch: 17, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.904 Vali Acc: 0.744 Test Loss: 0.904 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7529690265655518
Epoch: 18, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.851 Vali Acc: 0.772 Test Loss: 0.851 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.689669132232666
Epoch: 19, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.996 Vali Acc: 0.750 Test Loss: 0.996 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6795072555541992
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.870 Vali Acc: 0.772 Test Loss: 0.870 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6605000495910645
Epoch: 21, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.035 Vali Acc: 0.767 Test Loss: 1.035 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.612619161605835
Epoch: 22, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.891 Vali Acc: 0.794 Test Loss: 0.891 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794436).  Saving model ...
Epoch: 23 cost time: 0.6184372901916504
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.040 Vali Acc: 0.772 Test Loss: 1.040 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7438774108886719
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.964 Vali Acc: 0.800 Test Loss: 0.964 Test Acc: 0.800
Validation loss decreased (-0.794436 --> -0.799990).  Saving model ...
Epoch: 25 cost time: 0.719862699508667
Epoch: 25, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.934 Vali Acc: 0.817 Test Loss: 0.934 Test Acc: 0.817
Validation loss decreased (-0.799990 --> -0.816657).  Saving model ...
Epoch: 26 cost time: 0.6807835102081299
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.912 Vali Acc: 0.833 Test Loss: 0.912 Test Acc: 0.833
Validation loss decreased (-0.816657 --> -0.833324).  Saving model ...
Epoch: 27 cost time: 0.5750017166137695
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.893 Vali Acc: 0.811 Test Loss: 0.893 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6512038707733154
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.079 Vali Acc: 0.811 Test Loss: 1.079 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.587871789932251
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.027 Vali Acc: 0.789 Test Loss: 1.027 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6550462245941162
Epoch: 30, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.965 Vali Acc: 0.828 Test Loss: 0.965 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.629492998123169
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.980 Vali Acc: 0.822 Test Loss: 0.980 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6899929046630859
Epoch: 32, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.022 Vali Acc: 0.794 Test Loss: 1.022 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.639068603515625
Epoch: 33, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.988 Vali Acc: 0.850 Test Loss: 0.988 Test Acc: 0.850
Validation loss decreased (-0.833324 --> -0.849990).  Saving model ...
Epoch: 34 cost time: 0.6536405086517334
Epoch: 34, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.976 Vali Acc: 0.822 Test Loss: 0.976 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7114574909210205
Epoch: 35, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.078 Vali Acc: 0.822 Test Loss: 1.078 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6028821468353271
Epoch: 36, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.127 Vali Acc: 0.806 Test Loss: 1.127 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.626115083694458
Epoch: 37, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.049 Vali Acc: 0.828 Test Loss: 1.049 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6330103874206543
Epoch: 38, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.082 Vali Acc: 0.806 Test Loss: 1.082 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5962529182434082
Epoch: 39, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.035 Vali Acc: 0.833 Test Loss: 1.035 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7391171455383301
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.092 Vali Acc: 0.822 Test Loss: 1.092 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6851058006286621
Epoch: 41, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.054 Vali Acc: 0.856 Test Loss: 1.054 Test Acc: 0.856
Validation loss decreased (-0.849990 --> -0.855545).  Saving model ...
Epoch: 42 cost time: 0.6442415714263916
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.118 Vali Acc: 0.833 Test Loss: 1.118 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5138516426086426
Epoch: 43, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.063 Vali Acc: 0.828 Test Loss: 1.063 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.519801139831543
Epoch: 44, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.133 Vali Acc: 0.844 Test Loss: 1.133 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6556558609008789
Epoch: 45, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.130 Vali Acc: 0.811 Test Loss: 1.130 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6557698249816895
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.180 Vali Acc: 0.828 Test Loss: 1.180 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5866587162017822
Epoch: 47, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.150 Vali Acc: 0.811 Test Loss: 1.150 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5996217727661133
Epoch: 48, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.227 Vali Acc: 0.800 Test Loss: 1.227 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7879860401153564
Epoch: 49, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.161 Vali Acc: 0.822 Test Loss: 1.161 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7330460548400879
Epoch: 50, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.297 Vali Acc: 0.789 Test Loss: 1.297 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 29351439
model size : 126.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8163015842437744
Epoch: 1, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.584 Vali Acc: 0.233 Test Loss: 2.584 Test Acc: 0.233
Validation loss decreased (inf --> -0.233307).  Saving model ...
Epoch: 2 cost time: 1.039517879486084
Epoch: 2, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.258 Vali Acc: 0.444 Test Loss: 2.258 Test Acc: 0.444
Validation loss decreased (-0.233307 --> -0.444422).  Saving model ...
Epoch: 3 cost time: 0.6861627101898193
Epoch: 3, Steps: 12 | Train Loss: 2.071 Vali Loss: 1.837 Vali Acc: 0.478 Test Loss: 1.837 Test Acc: 0.478
Validation loss decreased (-0.444422 --> -0.477759).  Saving model ...
Epoch: 4 cost time: 0.8603389263153076
Epoch: 4, Steps: 12 | Train Loss: 1.603 Vali Loss: 1.510 Vali Acc: 0.572 Test Loss: 1.510 Test Acc: 0.572
Validation loss decreased (-0.477759 --> -0.572207).  Saving model ...
Epoch: 5 cost time: 0.7385873794555664
Epoch: 5, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.243 Vali Acc: 0.611 Test Loss: 1.243 Test Acc: 0.611
Validation loss decreased (-0.572207 --> -0.611099).  Saving model ...
Epoch: 6 cost time: 0.5712258815765381
Epoch: 6, Steps: 12 | Train Loss: 1.109 Vali Loss: 1.123 Vali Acc: 0.617 Test Loss: 1.123 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 7 cost time: 1.0124595165252686
Epoch: 7, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.004 Vali Acc: 0.672 Test Loss: 1.004 Test Acc: 0.672
Validation loss decreased (-0.616655 --> -0.672212).  Saving model ...
Epoch: 8 cost time: 0.8509137630462646
Epoch: 8, Steps: 12 | Train Loss: 0.668 Vali Loss: 1.012 Vali Acc: 0.656 Test Loss: 1.012 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7128217220306396
Epoch: 9, Steps: 12 | Train Loss: 0.671 Vali Loss: 1.021 Vali Acc: 0.678 Test Loss: 1.021 Test Acc: 0.678
Validation loss decreased (-0.672212 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 0.8927083015441895
Epoch: 10, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.981 Vali Acc: 0.706 Test Loss: 0.981 Test Acc: 0.706
Validation loss decreased (-0.677768 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 0.6857304573059082
Epoch: 11, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.943 Vali Acc: 0.722 Test Loss: 0.943 Test Acc: 0.722
Validation loss decreased (-0.705546 --> -0.722213).  Saving model ...
Epoch: 12 cost time: 1.1371147632598877
Epoch: 12, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.937 Vali Acc: 0.706 Test Loss: 0.937 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8077926635742188
Epoch: 13, Steps: 12 | Train Loss: 0.367 Vali Loss: 1.120 Vali Acc: 0.672 Test Loss: 1.120 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7363710403442383
Epoch: 14, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.981 Vali Acc: 0.739 Test Loss: 0.981 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738879).  Saving model ...
Epoch: 15 cost time: 0.6205127239227295
Epoch: 15, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.983 Vali Acc: 0.761 Test Loss: 0.983 Test Acc: 0.761
Validation loss decreased (-0.738879 --> -0.761101).  Saving model ...
Epoch: 16 cost time: 0.6166157722473145
Epoch: 16, Steps: 12 | Train Loss: 0.356 Vali Loss: 1.046 Vali Acc: 0.733 Test Loss: 1.046 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6242711544036865
Epoch: 17, Steps: 12 | Train Loss: 0.213 Vali Loss: 1.106 Vali Acc: 0.739 Test Loss: 1.106 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7516765594482422
Epoch: 18, Steps: 12 | Train Loss: 0.230 Vali Loss: 1.173 Vali Acc: 0.728 Test Loss: 1.173 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7914257049560547
Epoch: 19, Steps: 12 | Train Loss: 0.238 Vali Loss: 1.428 Vali Acc: 0.722 Test Loss: 1.428 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7829549312591553
Epoch: 20, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.116 Vali Acc: 0.800 Test Loss: 1.116 Test Acc: 0.800
Validation loss decreased (-0.761101 --> -0.799989).  Saving model ...
Epoch: 21 cost time: 0.7686374187469482
Epoch: 21, Steps: 12 | Train Loss: 0.145 Vali Loss: 1.170 Vali Acc: 0.794 Test Loss: 1.170 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7947978973388672
Epoch: 22, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.253 Vali Acc: 0.767 Test Loss: 1.253 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8063929080963135
Epoch: 23, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.464 Vali Acc: 0.728 Test Loss: 1.464 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1392238140106201
Epoch: 24, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.503 Vali Acc: 0.750 Test Loss: 1.503 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9185938835144043
Epoch: 25, Steps: 12 | Train Loss: 0.272 Vali Loss: 1.637 Vali Acc: 0.772 Test Loss: 1.637 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9396135807037354
Epoch: 26, Steps: 12 | Train Loss: 0.116 Vali Loss: 1.279 Vali Acc: 0.778 Test Loss: 1.279 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8480660915374756
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 1.774 Vali Acc: 0.750 Test Loss: 1.774 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7173824310302734
Epoch: 28, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.536 Vali Acc: 0.756 Test Loss: 1.536 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7367687225341797
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.452 Vali Acc: 0.772 Test Loss: 1.452 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0137546062469482
Epoch: 30, Steps: 12 | Train Loss: 0.057 Vali Loss: 1.591 Vali Acc: 0.756 Test Loss: 1.591 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 29499663
model size : 127.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.364464521408081
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.637 Vali Acc: 0.150 Test Loss: 2.637 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 0.6787817478179932
Epoch: 2, Steps: 12 | Train Loss: 2.572 Vali Loss: 2.392 Vali Acc: 0.433 Test Loss: 2.392 Test Acc: 0.433
Validation loss decreased (-0.149974 --> -0.433309).  Saving model ...
Epoch: 3 cost time: 0.7655360698699951
Epoch: 3, Steps: 12 | Train Loss: 2.236 Vali Loss: 2.063 Vali Acc: 0.489 Test Loss: 2.063 Test Acc: 0.489
Validation loss decreased (-0.433309 --> -0.488868).  Saving model ...
Epoch: 4 cost time: 0.7313346862792969
Epoch: 4, Steps: 12 | Train Loss: 1.887 Vali Loss: 1.703 Vali Acc: 0.589 Test Loss: 1.703 Test Acc: 0.589
Validation loss decreased (-0.488868 --> -0.588872).  Saving model ...
Epoch: 5 cost time: 0.7057385444641113
Epoch: 5, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.386 Vali Acc: 0.589 Test Loss: 1.386 Test Acc: 0.589
Validation loss decreased (-0.588872 --> -0.588875).  Saving model ...
Epoch: 6 cost time: 0.6670303344726562
Epoch: 6, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.170 Vali Acc: 0.589 Test Loss: 1.170 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588877).  Saving model ...
Epoch: 7 cost time: 0.6995642185211182
Epoch: 7, Steps: 12 | Train Loss: 1.018 Vali Loss: 0.996 Vali Acc: 0.606 Test Loss: 0.996 Test Acc: 0.606
Validation loss decreased (-0.588877 --> -0.605546).  Saving model ...
Epoch: 8 cost time: 0.6414322853088379
Epoch: 8, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.941 Vali Acc: 0.683 Test Loss: 0.941 Test Acc: 0.683
Validation loss decreased (-0.605546 --> -0.683324).  Saving model ...
Epoch: 9 cost time: 0.6944394111633301
Epoch: 9, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.940 Vali Acc: 0.678 Test Loss: 0.940 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.679314136505127
Epoch: 10, Steps: 12 | Train Loss: 0.753 Vali Loss: 0.900 Vali Acc: 0.722 Test Loss: 0.900 Test Acc: 0.722
Validation loss decreased (-0.683324 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 0.7197062969207764
Epoch: 11, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.877 Vali Acc: 0.733 Test Loss: 0.877 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 12 cost time: 0.7941782474517822
Epoch: 12, Steps: 12 | Train Loss: 0.404 Vali Loss: 1.029 Vali Acc: 0.744 Test Loss: 1.029 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744434).  Saving model ...
Epoch: 13 cost time: 0.6646959781646729
Epoch: 13, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.923 Vali Acc: 0.739 Test Loss: 0.923 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6018884181976318
Epoch: 14, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.906 Vali Acc: 0.756 Test Loss: 0.906 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 15 cost time: 0.8278310298919678
Epoch: 15, Steps: 12 | Train Loss: 0.274 Vali Loss: 1.025 Vali Acc: 0.750 Test Loss: 1.025 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7104027271270752
Epoch: 16, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.913 Vali Acc: 0.800 Test Loss: 0.913 Test Acc: 0.800
Validation loss decreased (-0.755546 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.7943110466003418
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.878 Vali Acc: 0.794 Test Loss: 0.878 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8412132263183594
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.067 Vali Acc: 0.767 Test Loss: 1.067 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7447454929351807
Epoch: 19, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.964 Vali Acc: 0.767 Test Loss: 0.964 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7089080810546875
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.978 Vali Acc: 0.822 Test Loss: 0.978 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822212).  Saving model ...
Epoch: 21 cost time: 0.8797996044158936
Epoch: 21, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.889 Vali Acc: 0.800 Test Loss: 0.889 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7032551765441895
Epoch: 22, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.088 Vali Acc: 0.783 Test Loss: 1.088 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6091341972351074
Epoch: 23, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.013 Vali Acc: 0.817 Test Loss: 1.013 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.623319149017334
Epoch: 24, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.941 Vali Acc: 0.811 Test Loss: 0.941 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.825049877166748
Epoch: 25, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.042 Vali Acc: 0.783 Test Loss: 1.042 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6792385578155518
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 1.052 Vali Acc: 0.778 Test Loss: 1.052 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6088905334472656
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.226 Vali Acc: 0.783 Test Loss: 1.226 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5406966209411621
Epoch: 28, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.042 Vali Acc: 0.794 Test Loss: 1.042 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6067714691162109
Epoch: 29, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.155 Vali Acc: 0.811 Test Loss: 1.155 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6764204502105713
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.134 Vali Acc: 0.783 Test Loss: 1.134 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 29421327
model size : 126.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9039576053619385
Epoch: 1, Steps: 12 | Train Loss: 2.855 Vali Loss: 2.697 Vali Acc: 0.150 Test Loss: 2.697 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 0.5500104427337646
Epoch: 2, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.510 Vali Acc: 0.300 Test Loss: 2.510 Test Acc: 0.300
Validation loss decreased (-0.149973 --> -0.299975).  Saving model ...
Epoch: 3 cost time: 0.6316306591033936
Epoch: 3, Steps: 12 | Train Loss: 2.397 Vali Loss: 2.284 Vali Acc: 0.500 Test Loss: 2.284 Test Acc: 0.500
Validation loss decreased (-0.299975 --> -0.499977).  Saving model ...
Epoch: 4 cost time: 0.7228007316589355
Epoch: 4, Steps: 12 | Train Loss: 2.156 Vali Loss: 2.007 Vali Acc: 0.550 Test Loss: 2.007 Test Acc: 0.550
Validation loss decreased (-0.499977 --> -0.549980).  Saving model ...
Epoch: 5 cost time: 0.6541550159454346
Epoch: 5, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.679 Vali Acc: 0.544 Test Loss: 1.679 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8405733108520508
Epoch: 6, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.411 Vali Acc: 0.561 Test Loss: 1.411 Test Acc: 0.561
Validation loss decreased (-0.549980 --> -0.561097).  Saving model ...
Epoch: 7 cost time: 0.6980862617492676
Epoch: 7, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.216 Vali Acc: 0.617 Test Loss: 1.216 Test Acc: 0.617
Validation loss decreased (-0.561097 --> -0.616655).  Saving model ...
Epoch: 8 cost time: 0.7258510589599609
Epoch: 8, Steps: 12 | Train Loss: 1.057 Vali Loss: 1.098 Vali Acc: 0.606 Test Loss: 1.098 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7007575035095215
Epoch: 9, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.905 Vali Acc: 0.683 Test Loss: 0.905 Test Acc: 0.683
Validation loss decreased (-0.616655 --> -0.683324).  Saving model ...
Epoch: 10 cost time: 0.8171138763427734
Epoch: 10, Steps: 12 | Train Loss: 0.776 Vali Loss: 0.836 Vali Acc: 0.706 Test Loss: 0.836 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705547).  Saving model ...
Epoch: 11 cost time: 0.7001442909240723
Epoch: 11, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.743 Vali Acc: 0.722 Test Loss: 0.743 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722215).  Saving model ...
Epoch: 12 cost time: 0.6201856136322021
Epoch: 12, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.764 Vali Acc: 0.761 Test Loss: 0.764 Test Acc: 0.761
Validation loss decreased (-0.722215 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 0.6742351055145264
Epoch: 13, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.683751106262207
Epoch: 14, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.625 Vali Acc: 0.778 Test Loss: 0.625 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777772).  Saving model ...
Epoch: 15 cost time: 0.5796520709991455
Epoch: 15, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.754 Vali Acc: 0.772 Test Loss: 0.754 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4837379455566406
Epoch: 16, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.6331546306610107
Epoch: 17, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.808 Vali Acc: 0.761 Test Loss: 0.808 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6025819778442383
Epoch: 18, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6547598838806152
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.647 Vali Acc: 0.839 Test Loss: 0.647 Test Acc: 0.839
Validation loss decreased (-0.805549 --> -0.838882).  Saving model ...
Epoch: 20 cost time: 0.6769616603851318
Epoch: 20, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.656 Vali Acc: 0.828 Test Loss: 0.656 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.604804515838623
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.693 Vali Acc: 0.839 Test Loss: 0.693 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.621845006942749
Epoch: 22, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.698 Vali Acc: 0.828 Test Loss: 0.698 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6792364120483398
Epoch: 23, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.756 Vali Acc: 0.833 Test Loss: 0.756 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6391313076019287
Epoch: 24, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.697 Vali Acc: 0.833 Test Loss: 0.697 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6897063255310059
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6659440994262695
Epoch: 26, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.703 Vali Acc: 0.844 Test Loss: 0.703 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844437).  Saving model ...
Epoch: 27 cost time: 0.625110387802124
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.693 Vali Acc: 0.844 Test Loss: 0.693 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 0.643641471862793
Epoch: 28, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.780 Vali Acc: 0.856 Test Loss: 0.780 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855548).  Saving model ...
Epoch: 29 cost time: 0.5392274856567383
Epoch: 29, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.813 Vali Acc: 0.817 Test Loss: 0.813 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5094256401062012
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.755 Vali Acc: 0.839 Test Loss: 0.755 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.717339038848877
Epoch: 31, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.761 Vali Acc: 0.839 Test Loss: 0.761 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6063940525054932
Epoch: 32, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7620491981506348
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.795 Vali Acc: 0.839 Test Loss: 0.795 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7289543151855469
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.772 Vali Acc: 0.856 Test Loss: 0.772 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855548).  Saving model ...
Epoch: 35 cost time: 0.668121337890625
Epoch: 35, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.763 Vali Acc: 0.861 Test Loss: 0.763 Test Acc: 0.861
Validation loss decreased (-0.855548 --> -0.861103).  Saving model ...
Epoch: 36 cost time: 0.778393030166626
Epoch: 36, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.810 Vali Acc: 0.861 Test Loss: 0.810 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6177182197570801
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.814 Vali Acc: 0.856 Test Loss: 0.814 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6145427227020264
Epoch: 38, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.844 Vali Acc: 0.867 Test Loss: 0.844 Test Acc: 0.867
Validation loss decreased (-0.861103 --> -0.866658).  Saving model ...
Epoch: 39 cost time: 0.7617456912994385
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.825 Vali Acc: 0.839 Test Loss: 0.825 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6864356994628906
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.822 Vali Acc: 0.856 Test Loss: 0.822 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5648937225341797
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.790 Vali Acc: 0.828 Test Loss: 0.790 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6610841751098633
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.865 Vali Acc: 0.844 Test Loss: 0.865 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.665313720703125
Epoch: 43, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.854 Vali Acc: 0.833 Test Loss: 0.854 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7854933738708496
Epoch: 44, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.885 Vali Acc: 0.844 Test Loss: 0.885 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6063954830169678
Epoch: 45, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.880 Vali Acc: 0.839 Test Loss: 0.880 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6981027126312256
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.907 Vali Acc: 0.844 Test Loss: 0.907 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6624345779418945
Epoch: 47, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.895 Vali Acc: 0.833 Test Loss: 0.895 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5917661190032959
Epoch: 48, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.855 Vali Acc: 0.839 Test Loss: 0.855 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 29329935
model size : 126.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.105008840560913
Epoch: 1, Steps: 12 | Train Loss: 2.773 Vali Loss: 2.604 Vali Acc: 0.233 Test Loss: 2.604 Test Acc: 0.233
Validation loss decreased (inf --> -0.233307).  Saving model ...
Epoch: 2 cost time: 0.8730032444000244
Epoch: 2, Steps: 12 | Train Loss: 2.509 Vali Loss: 2.308 Vali Acc: 0.300 Test Loss: 2.308 Test Acc: 0.300
Validation loss decreased (-0.233307 --> -0.299977).  Saving model ...
Epoch: 3 cost time: 0.7691080570220947
Epoch: 3, Steps: 12 | Train Loss: 2.117 Vali Loss: 1.956 Vali Acc: 0.450 Test Loss: 1.956 Test Acc: 0.450
Validation loss decreased (-0.299977 --> -0.449980).  Saving model ...
Epoch: 4 cost time: 0.7778151035308838
Epoch: 4, Steps: 12 | Train Loss: 1.692 Vali Loss: 1.570 Vali Acc: 0.583 Test Loss: 1.570 Test Acc: 0.583
Validation loss decreased (-0.449980 --> -0.583318).  Saving model ...
Epoch: 5 cost time: 0.743370532989502
Epoch: 5, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.260 Vali Acc: 0.583 Test Loss: 1.260 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583321).  Saving model ...
Epoch: 6 cost time: 0.838003396987915
Epoch: 6, Steps: 12 | Train Loss: 0.969 Vali Loss: 1.097 Vali Acc: 0.589 Test Loss: 1.097 Test Acc: 0.589
Validation loss decreased (-0.583321 --> -0.588878).  Saving model ...
Epoch: 7 cost time: 0.5424833297729492
Epoch: 7, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.107 Vali Acc: 0.639 Test Loss: 1.107 Test Acc: 0.639
Validation loss decreased (-0.588878 --> -0.638878).  Saving model ...
Epoch: 8 cost time: 0.8140990734100342
Epoch: 8, Steps: 12 | Train Loss: 0.749 Vali Loss: 1.049 Vali Acc: 0.650 Test Loss: 1.049 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.9571435451507568
Epoch: 9, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.021 Vali Acc: 0.683 Test Loss: 1.021 Test Acc: 0.683
Validation loss decreased (-0.649990 --> -0.683323).  Saving model ...
Epoch: 10 cost time: 1.125715970993042
Epoch: 10, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.996 Vali Acc: 0.706 Test Loss: 0.996 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 0.8758199214935303
Epoch: 11, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.164 Vali Acc: 0.700 Test Loss: 1.164 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8558342456817627
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744435).  Saving model ...
Epoch: 13 cost time: 0.8268671035766602
Epoch: 13, Steps: 12 | Train Loss: 0.326 Vali Loss: 1.220 Vali Acc: 0.739 Test Loss: 1.220 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7639191150665283
Epoch: 14, Steps: 12 | Train Loss: 0.324 Vali Loss: 1.118 Vali Acc: 0.722 Test Loss: 1.118 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8739185333251953
Epoch: 15, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.986 Vali Acc: 0.767 Test Loss: 0.986 Test Acc: 0.767
Validation loss decreased (-0.744435 --> -0.766657).  Saving model ...
Epoch: 16 cost time: 0.9840033054351807
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.237 Vali Acc: 0.761 Test Loss: 1.237 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7148549556732178
Epoch: 17, Steps: 12 | Train Loss: 0.211 Vali Loss: 1.249 Vali Acc: 0.750 Test Loss: 1.249 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.921684741973877
Epoch: 18, Steps: 12 | Train Loss: 0.195 Vali Loss: 1.276 Vali Acc: 0.739 Test Loss: 1.276 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1462388038635254
Epoch: 19, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.603 Vali Acc: 0.739 Test Loss: 1.603 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0060644149780273
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.372 Vali Acc: 0.739 Test Loss: 1.372 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8091762065887451
Epoch: 21, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.774 Vali Acc: 0.733 Test Loss: 1.774 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8572609424591064
Epoch: 22, Steps: 12 | Train Loss: 0.215 Vali Loss: 1.342 Vali Acc: 0.744 Test Loss: 1.342 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8602702617645264
Epoch: 23, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.649 Vali Acc: 0.772 Test Loss: 1.649 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772206).  Saving model ...
Epoch: 24 cost time: 0.9484965801239014
Epoch: 24, Steps: 12 | Train Loss: 0.124 Vali Loss: 1.685 Vali Acc: 0.778 Test Loss: 1.685 Test Acc: 0.778
Validation loss decreased (-0.772206 --> -0.777761).  Saving model ...
Epoch: 25 cost time: 0.5321111679077148
Epoch: 25, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.691 Vali Acc: 0.744 Test Loss: 1.691 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7887213230133057
Epoch: 26, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.728 Vali Acc: 0.739 Test Loss: 1.728 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8231034278869629
Epoch: 27, Steps: 12 | Train Loss: 0.304 Vali Loss: 1.914 Vali Acc: 0.761 Test Loss: 1.914 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1142535209655762
Epoch: 28, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.541 Vali Acc: 0.761 Test Loss: 1.541 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7269346714019775
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.615 Vali Acc: 0.756 Test Loss: 1.615 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7531478404998779
Epoch: 30, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.821 Vali Acc: 0.756 Test Loss: 1.821 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8853795528411865
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.612 Vali Acc: 0.761 Test Loss: 1.612 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8908634185791016
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.817 Vali Acc: 0.761 Test Loss: 1.817 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8258185386657715
Epoch: 33, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.676 Vali Acc: 0.778 Test Loss: 1.676 Test Acc: 0.778
Validation loss decreased (-0.777761 --> -0.777761).  Saving model ...
Epoch: 34 cost time: 0.9361972808837891
Epoch: 34, Steps: 12 | Train Loss: 0.061 Vali Loss: 2.061 Vali Acc: 0.744 Test Loss: 2.061 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.017155408859253
Epoch: 35, Steps: 12 | Train Loss: 0.067 Vali Loss: 2.221 Vali Acc: 0.750 Test Loss: 2.221 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0151290893554688
Epoch: 36, Steps: 12 | Train Loss: 0.102 Vali Loss: 2.072 Vali Acc: 0.739 Test Loss: 2.072 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9987196922302246
Epoch: 37, Steps: 12 | Train Loss: 0.035 Vali Loss: 2.217 Vali Acc: 0.761 Test Loss: 2.217 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0062592029571533
Epoch: 38, Steps: 12 | Train Loss: 0.054 Vali Loss: 2.031 Vali Acc: 0.778 Test Loss: 2.031 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9099321365356445
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 2.355 Vali Acc: 0.772 Test Loss: 2.355 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8952598571777344
Epoch: 40, Steps: 12 | Train Loss: 0.006 Vali Loss: 2.321 Vali Acc: 0.772 Test Loss: 2.321 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9460811614990234
Epoch: 41, Steps: 12 | Train Loss: 0.036 Vali Loss: 2.184 Vali Acc: 0.778 Test Loss: 2.184 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9211676120758057
Epoch: 42, Steps: 12 | Train Loss: 0.037 Vali Loss: 2.472 Vali Acc: 0.767 Test Loss: 2.472 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7601089477539062
Epoch: 43, Steps: 12 | Train Loss: 0.048 Vali Loss: 2.407 Vali Acc: 0.767 Test Loss: 2.407 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 29504271
model size : 127.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2246828079223633
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.657 Vali Acc: 0.144 Test Loss: 2.657 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 0.7918100357055664
Epoch: 2, Steps: 12 | Train Loss: 2.602 Vali Loss: 2.466 Vali Acc: 0.294 Test Loss: 2.466 Test Acc: 0.294
Validation loss decreased (-0.144418 --> -0.294420).  Saving model ...
Epoch: 3 cost time: 0.7452077865600586
Epoch: 3, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.237 Vali Acc: 0.428 Test Loss: 2.237 Test Acc: 0.428
Validation loss decreased (-0.294420 --> -0.427755).  Saving model ...
Epoch: 4 cost time: 0.6692197322845459
Epoch: 4, Steps: 12 | Train Loss: 2.130 Vali Loss: 1.958 Vali Acc: 0.572 Test Loss: 1.958 Test Acc: 0.572
Validation loss decreased (-0.427755 --> -0.572203).  Saving model ...
Epoch: 5 cost time: 0.7300891876220703
Epoch: 5, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.605 Vali Acc: 0.533 Test Loss: 1.605 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7348268032073975
Epoch: 6, Steps: 12 | Train Loss: 1.338 Vali Loss: 1.257 Vali Acc: 0.561 Test Loss: 1.257 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6780397891998291
Epoch: 7, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.103 Vali Acc: 0.611 Test Loss: 1.103 Test Acc: 0.611
Validation loss decreased (-0.572203 --> -0.611100).  Saving model ...
Epoch: 8 cost time: 0.7286608219146729
Epoch: 8, Steps: 12 | Train Loss: 0.908 Vali Loss: 0.993 Vali Acc: 0.633 Test Loss: 0.993 Test Acc: 0.633
Validation loss decreased (-0.611100 --> -0.633323).  Saving model ...
Epoch: 9 cost time: 0.8939087390899658
Epoch: 9, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.936 Vali Acc: 0.672 Test Loss: 0.936 Test Acc: 0.672
Validation loss decreased (-0.633323 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 0.8884210586547852
Epoch: 10, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.882 Vali Acc: 0.667 Test Loss: 0.882 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7900409698486328
Epoch: 11, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.811 Vali Acc: 0.711 Test Loss: 0.811 Test Acc: 0.711
Validation loss decreased (-0.672213 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.837583065032959
Epoch: 12, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
Validation loss decreased (-0.711103 --> -0.716658).  Saving model ...
Epoch: 13 cost time: 0.6673235893249512
Epoch: 13, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.883 Vali Acc: 0.733 Test Loss: 0.883 Test Acc: 0.733
Validation loss decreased (-0.716658 --> -0.733325).  Saving model ...
Epoch: 14 cost time: 0.7404558658599854
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.709 Vali Acc: 0.767 Test Loss: 0.709 Test Acc: 0.767
Validation loss decreased (-0.733325 --> -0.766660).  Saving model ...
Epoch: 15 cost time: 0.8117268085479736
Epoch: 15, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.889 Vali Acc: 0.756 Test Loss: 0.889 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7350971698760986
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783325).  Saving model ...
Epoch: 17 cost time: 0.7128200531005859
Epoch: 17, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.858 Vali Acc: 0.761 Test Loss: 0.858 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8372306823730469
Epoch: 18, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.781 Vali Acc: 0.778 Test Loss: 0.781 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8292262554168701
Epoch: 19, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.914 Vali Acc: 0.794 Test Loss: 0.914 Test Acc: 0.794
Validation loss decreased (-0.783325 --> -0.794435).  Saving model ...
Epoch: 20 cost time: 0.8101532459259033
Epoch: 20, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.851 Vali Acc: 0.783 Test Loss: 0.851 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7247560024261475
Epoch: 21, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.972 Vali Acc: 0.806 Test Loss: 0.972 Test Acc: 0.806
Validation loss decreased (-0.794435 --> -0.805546).  Saving model ...
Epoch: 22 cost time: 0.8152580261230469
Epoch: 22, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.933 Vali Acc: 0.789 Test Loss: 0.933 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8103506565093994
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.023 Vali Acc: 0.800 Test Loss: 1.023 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6515061855316162
Epoch: 24, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.951 Vali Acc: 0.794 Test Loss: 0.951 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.635190486907959
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.956 Vali Acc: 0.800 Test Loss: 0.956 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5729238986968994
Epoch: 26, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.009 Vali Acc: 0.772 Test Loss: 1.009 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6986620426177979
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.954 Vali Acc: 0.800 Test Loss: 0.954 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7085368633270264
Epoch: 28, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.023 Vali Acc: 0.783 Test Loss: 1.023 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6735203266143799
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.090 Vali Acc: 0.811 Test Loss: 1.090 Test Acc: 0.811
Validation loss decreased (-0.805546 --> -0.811100).  Saving model ...
Epoch: 30 cost time: 0.7540826797485352
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.040 Vali Acc: 0.794 Test Loss: 1.040 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7775866985321045
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.152 Vali Acc: 0.806 Test Loss: 1.152 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6687493324279785
Epoch: 32, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.022 Vali Acc: 0.800 Test Loss: 1.022 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6651785373687744
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.087 Vali Acc: 0.817 Test Loss: 1.087 Test Acc: 0.817
Validation loss decreased (-0.811100 --> -0.816656).  Saving model ...
Epoch: 34 cost time: 0.7434344291687012
Epoch: 34, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.024 Vali Acc: 0.800 Test Loss: 1.024 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.630744218826294
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.089 Vali Acc: 0.806 Test Loss: 1.089 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7666590213775635
Epoch: 36, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.122 Vali Acc: 0.811 Test Loss: 1.122 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7666854858398438
Epoch: 37, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.115 Vali Acc: 0.778 Test Loss: 1.115 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7706007957458496
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.131 Vali Acc: 0.789 Test Loss: 1.131 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8035712242126465
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.113 Vali Acc: 0.817 Test Loss: 1.113 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7362868785858154
Epoch: 40, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.101 Vali Acc: 0.794 Test Loss: 1.101 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6468961238861084
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.162 Vali Acc: 0.811 Test Loss: 1.162 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8064823150634766
Epoch: 42, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.140 Vali Acc: 0.789 Test Loss: 1.140 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7421526908874512
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.091 Vali Acc: 0.822 Test Loss: 1.091 Test Acc: 0.822
Validation loss decreased (-0.816656 --> -0.822211).  Saving model ...
Epoch: 44 cost time: 0.7034704685211182
Epoch: 44, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.164 Vali Acc: 0.822 Test Loss: 1.164 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8011658191680908
Epoch: 45, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.148 Vali Acc: 0.794 Test Loss: 1.148 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7146844863891602
Epoch: 46, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.270 Vali Acc: 0.817 Test Loss: 1.270 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6593961715698242
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.278 Vali Acc: 0.789 Test Loss: 1.278 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8807456493377686
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.146 Vali Acc: 0.800 Test Loss: 1.146 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7827346324920654
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.323 Vali Acc: 0.811 Test Loss: 1.323 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6788454055786133
Epoch: 50, Steps: 12 | Train Loss: 0.109 Vali Loss: 1.138 Vali Acc: 0.811 Test Loss: 1.138 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 29373711
model size : 126.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0231785774230957
Epoch: 1, Steps: 12 | Train Loss: 2.804 Vali Loss: 2.690 Vali Acc: 0.139 Test Loss: 2.690 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.709475040435791
Epoch: 2, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.524 Vali Acc: 0.278 Test Loss: 2.524 Test Acc: 0.278
Validation loss decreased (-0.138862 --> -0.277753).  Saving model ...
Epoch: 3 cost time: 0.7244608402252197
Epoch: 3, Steps: 12 | Train Loss: 2.423 Vali Loss: 2.331 Vali Acc: 0.383 Test Loss: 2.331 Test Acc: 0.383
Validation loss decreased (-0.277753 --> -0.383310).  Saving model ...
Epoch: 4 cost time: 0.7223937511444092
Epoch: 4, Steps: 12 | Train Loss: 2.154 Vali Loss: 2.086 Vali Acc: 0.478 Test Loss: 2.086 Test Acc: 0.478
Validation loss decreased (-0.383310 --> -0.477757).  Saving model ...
Epoch: 5 cost time: 0.5953483581542969
Epoch: 5, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.751 Vali Acc: 0.522 Test Loss: 1.751 Test Acc: 0.522
Validation loss decreased (-0.477757 --> -0.522205).  Saving model ...
Epoch: 6 cost time: 0.685100793838501
Epoch: 6, Steps: 12 | Train Loss: 1.579 Vali Loss: 1.432 Vali Acc: 0.539 Test Loss: 1.432 Test Acc: 0.539
Validation loss decreased (-0.522205 --> -0.538875).  Saving model ...
Epoch: 7 cost time: 0.7003781795501709
Epoch: 7, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.206 Vali Acc: 0.611 Test Loss: 1.206 Test Acc: 0.611
Validation loss decreased (-0.538875 --> -0.611099).  Saving model ...
Epoch: 8 cost time: 0.6339538097381592
Epoch: 8, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.080 Vali Acc: 0.633 Test Loss: 1.080 Test Acc: 0.633
Validation loss decreased (-0.611099 --> -0.633323).  Saving model ...
Epoch: 9 cost time: 0.6101553440093994
Epoch: 9, Steps: 12 | Train Loss: 0.839 Vali Loss: 0.920 Vali Acc: 0.628 Test Loss: 0.920 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6756129264831543
Epoch: 10, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.853 Vali Acc: 0.689 Test Loss: 0.853 Test Acc: 0.689
Validation loss decreased (-0.633323 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 0.612311840057373
Epoch: 11, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.767 Vali Acc: 0.733 Test Loss: 0.767 Test Acc: 0.733
Validation loss decreased (-0.688880 --> -0.733326).  Saving model ...
Epoch: 12 cost time: 0.6386723518371582
Epoch: 12, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755548).  Saving model ...
Epoch: 13 cost time: 0.7440869808197021
Epoch: 13, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.731 Vali Acc: 0.739 Test Loss: 0.731 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.60927414894104
Epoch: 14, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.685 Vali Acc: 0.756 Test Loss: 0.685 Test Acc: 0.756
Validation loss decreased (-0.755548 --> -0.755549).  Saving model ...
Epoch: 15 cost time: 0.6304712295532227
Epoch: 15, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
Validation loss decreased (-0.755549 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 0.6923730373382568
Epoch: 16, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.687 Vali Acc: 0.778 Test Loss: 0.687 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7548654079437256
Epoch: 17, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.763 Vali Acc: 0.789 Test Loss: 0.763 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7939856052398682
Epoch: 18, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.657 Vali Acc: 0.828 Test Loss: 0.657 Test Acc: 0.828
Validation loss decreased (-0.788882 --> -0.827771).  Saving model ...
Epoch: 19 cost time: 0.635040283203125
Epoch: 19, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 0.5536506175994873
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.771 Vali Acc: 0.817 Test Loss: 0.771 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6221323013305664
Epoch: 21, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.723 Vali Acc: 0.794 Test Loss: 0.723 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6664695739746094
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8520364761352539
Epoch: 23, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6683375835418701
Epoch: 24, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.711 Vali Acc: 0.822 Test Loss: 0.711 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7094330787658691
Epoch: 25, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.689 Vali Acc: 0.817 Test Loss: 0.689 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6182363033294678
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.733 Vali Acc: 0.839 Test Loss: 0.733 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 27 cost time: 0.7232375144958496
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.726 Vali Acc: 0.850 Test Loss: 0.726 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 0.7341680526733398
Epoch: 28, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.622807502746582
Epoch: 29, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.6909313201904297
Epoch: 30, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.799 Vali Acc: 0.811 Test Loss: 0.799 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7087798118591309
Epoch: 31, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.793 Vali Acc: 0.828 Test Loss: 0.793 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6872646808624268
Epoch: 32, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.789 Vali Acc: 0.828 Test Loss: 0.789 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8041093349456787
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.755 Vali Acc: 0.839 Test Loss: 0.755 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8082890510559082
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.733 Vali Acc: 0.867 Test Loss: 0.733 Test Acc: 0.867
Validation loss decreased (-0.849993 --> -0.866659).  Saving model ...
Epoch: 35 cost time: 0.5923593044281006
Epoch: 35, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.836 Vali Acc: 0.856 Test Loss: 0.836 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5846176147460938
Epoch: 36, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.847 Vali Acc: 0.822 Test Loss: 0.847 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6174805164337158
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.849 Vali Acc: 0.850 Test Loss: 0.849 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6792256832122803
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.780 Vali Acc: 0.828 Test Loss: 0.780 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6288738250732422
Epoch: 39, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.837 Vali Acc: 0.839 Test Loss: 0.837 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7460494041442871
Epoch: 40, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6820812225341797
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.796 Vali Acc: 0.861 Test Loss: 0.796 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7678864002227783
Epoch: 42, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.877 Vali Acc: 0.833 Test Loss: 0.877 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7225809097290039
Epoch: 43, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.847 Vali Acc: 0.839 Test Loss: 0.847 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7205665111541748
Epoch: 44, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.915 Vali Acc: 0.850 Test Loss: 0.915 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 29321487
model size : 126.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.247490882873535
Epoch: 1, Steps: 12 | Train Loss: 2.831 Vali Loss: 2.650 Vali Acc: 0.128 Test Loss: 2.650 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.959247350692749
Epoch: 2, Steps: 12 | Train Loss: 2.511 Vali Loss: 2.348 Vali Acc: 0.367 Test Loss: 2.348 Test Acc: 0.367
Validation loss decreased (-0.127751 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 0.9280097484588623
Epoch: 3, Steps: 12 | Train Loss: 2.189 Vali Loss: 1.964 Vali Acc: 0.467 Test Loss: 1.964 Test Acc: 0.467
Validation loss decreased (-0.366643 --> -0.466647).  Saving model ...
Epoch: 4 cost time: 0.991987943649292
Epoch: 4, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.613 Vali Acc: 0.500 Test Loss: 1.613 Test Acc: 0.500
Validation loss decreased (-0.466647 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 1.0275177955627441
Epoch: 5, Steps: 12 | Train Loss: 1.381 Vali Loss: 1.381 Vali Acc: 0.578 Test Loss: 1.381 Test Acc: 0.578
Validation loss decreased (-0.499984 --> -0.577764).  Saving model ...
Epoch: 6 cost time: 1.0253441333770752
Epoch: 6, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.216 Vali Acc: 0.561 Test Loss: 1.216 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.793694257736206
Epoch: 7, Steps: 12 | Train Loss: 0.854 Vali Loss: 1.094 Vali Acc: 0.611 Test Loss: 1.094 Test Acc: 0.611
Validation loss decreased (-0.577764 --> -0.611100).  Saving model ...
Epoch: 8 cost time: 0.736945390701294
Epoch: 8, Steps: 12 | Train Loss: 0.696 Vali Loss: 1.116 Vali Acc: 0.628 Test Loss: 1.116 Test Acc: 0.628
Validation loss decreased (-0.611100 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 0.8228967189788818
Epoch: 9, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.973 Vali Acc: 0.661 Test Loss: 0.973 Test Acc: 0.661
Validation loss decreased (-0.627767 --> -0.661101).  Saving model ...
Epoch: 10 cost time: 0.9139266014099121
Epoch: 10, Steps: 12 | Train Loss: 0.511 Vali Loss: 1.160 Vali Acc: 0.678 Test Loss: 1.160 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677766).  Saving model ...
Epoch: 11 cost time: 1.0478382110595703
Epoch: 11, Steps: 12 | Train Loss: 0.557 Vali Loss: 1.116 Vali Acc: 0.694 Test Loss: 1.116 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 0.8440313339233398
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 1.177 Vali Acc: 0.689 Test Loss: 1.177 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9847536087036133
Epoch: 13, Steps: 12 | Train Loss: 0.447 Vali Loss: 1.140 Vali Acc: 0.672 Test Loss: 1.140 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1040141582489014
Epoch: 14, Steps: 12 | Train Loss: 0.579 Vali Loss: 1.111 Vali Acc: 0.717 Test Loss: 1.111 Test Acc: 0.717
Validation loss decreased (-0.694433 --> -0.716656).  Saving model ...
Epoch: 15 cost time: 0.9609391689300537
Epoch: 15, Steps: 12 | Train Loss: 0.515 Vali Loss: 1.070 Vali Acc: 0.728 Test Loss: 1.070 Test Acc: 0.728
Validation loss decreased (-0.716656 --> -0.727767).  Saving model ...
Epoch: 16 cost time: 1.064345359802246
Epoch: 16, Steps: 12 | Train Loss: 0.343 Vali Loss: 1.039 Vali Acc: 0.722 Test Loss: 1.039 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0506250858306885
Epoch: 17, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.145 Vali Acc: 0.700 Test Loss: 1.145 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.925346851348877
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 1.209 Vali Acc: 0.700 Test Loss: 1.209 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9463839530944824
Epoch: 19, Steps: 12 | Train Loss: 0.313 Vali Loss: 1.333 Vali Acc: 0.744 Test Loss: 1.333 Test Acc: 0.744
Validation loss decreased (-0.727767 --> -0.744431).  Saving model ...
Epoch: 20 cost time: 1.031752586364746
Epoch: 20, Steps: 12 | Train Loss: 0.245 Vali Loss: 1.336 Vali Acc: 0.733 Test Loss: 1.336 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8582980632781982
Epoch: 21, Steps: 12 | Train Loss: 0.187 Vali Loss: 1.425 Vali Acc: 0.744 Test Loss: 1.425 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8820846080780029
Epoch: 22, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.386 Vali Acc: 0.728 Test Loss: 1.386 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0011358261108398
Epoch: 23, Steps: 12 | Train Loss: 0.127 Vali Loss: 1.521 Vali Acc: 0.733 Test Loss: 1.521 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2806284427642822
Epoch: 24, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.522 Vali Acc: 0.717 Test Loss: 1.522 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9489479064941406
Epoch: 25, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.485 Vali Acc: 0.728 Test Loss: 1.485 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0748696327209473
Epoch: 26, Steps: 12 | Train Loss: 0.140 Vali Loss: 1.346 Vali Acc: 0.772 Test Loss: 1.346 Test Acc: 0.772
Validation loss decreased (-0.744431 --> -0.772209).  Saving model ...
Epoch: 27 cost time: 1.2691762447357178
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.411 Vali Acc: 0.783 Test Loss: 1.411 Test Acc: 0.783
Validation loss decreased (-0.772209 --> -0.783319).  Saving model ...
Epoch: 28 cost time: 1.0112650394439697
Epoch: 28, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.411 Vali Acc: 0.800 Test Loss: 1.411 Test Acc: 0.800
Validation loss decreased (-0.783319 --> -0.799986).  Saving model ...
Epoch: 29 cost time: 1.2750976085662842
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 1.615 Vali Acc: 0.728 Test Loss: 1.615 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0509412288665771
Epoch: 30, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.498 Vali Acc: 0.800 Test Loss: 1.498 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.064429521560669
Epoch: 31, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.629 Vali Acc: 0.761 Test Loss: 1.629 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0331270694732666
Epoch: 32, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.439 Vali Acc: 0.783 Test Loss: 1.439 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8784799575805664
Epoch: 33, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.732 Vali Acc: 0.733 Test Loss: 1.732 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0023465156555176
Epoch: 34, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.545 Vali Acc: 0.800 Test Loss: 1.545 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9586310386657715
Epoch: 35, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.575 Vali Acc: 0.783 Test Loss: 1.575 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.886925458908081
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 1.692 Vali Acc: 0.733 Test Loss: 1.692 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9260880947113037
Epoch: 37, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.687 Vali Acc: 0.772 Test Loss: 1.687 Test Acc: 0.772
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7357990741729736
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.485 Vali Acc: 0.783 Test Loss: 1.485 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8
model parameter : 29495823
model size : 127.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2108967304229736
Epoch: 1, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.670 Vali Acc: 0.111 Test Loss: 2.670 Test Acc: 0.111
Validation loss decreased (inf --> -0.111084).  Saving model ...
Epoch: 2 cost time: 0.8255071640014648
Epoch: 2, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.492 Vali Acc: 0.378 Test Loss: 2.492 Test Acc: 0.378
Validation loss decreased (-0.111084 --> -0.377753).  Saving model ...
Epoch: 3 cost time: 0.8105614185333252
Epoch: 3, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.214 Vali Acc: 0.444 Test Loss: 2.214 Test Acc: 0.444
Validation loss decreased (-0.377753 --> -0.444422).  Saving model ...
Epoch: 4 cost time: 0.7676208019256592
Epoch: 4, Steps: 12 | Train Loss: 1.987 Vali Loss: 1.914 Vali Acc: 0.544 Test Loss: 1.914 Test Acc: 0.544
Validation loss decreased (-0.444422 --> -0.544425).  Saving model ...
Epoch: 5 cost time: 0.9013869762420654
Epoch: 5, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.605 Vali Acc: 0.561 Test Loss: 1.605 Test Acc: 0.561
Validation loss decreased (-0.544425 --> -0.561095).  Saving model ...
Epoch: 6 cost time: 0.7586462497711182
Epoch: 6, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.328 Vali Acc: 0.539 Test Loss: 1.328 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6489815711975098
Epoch: 7, Steps: 12 | Train Loss: 1.101 Vali Loss: 1.185 Vali Acc: 0.611 Test Loss: 1.185 Test Acc: 0.611
Validation loss decreased (-0.561095 --> -0.611099).  Saving model ...
Epoch: 8 cost time: 0.9200060367584229
Epoch: 8, Steps: 12 | Train Loss: 0.937 Vali Loss: 1.134 Vali Acc: 0.606 Test Loss: 1.134 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7631411552429199
Epoch: 9, Steps: 12 | Train Loss: 0.723 Vali Loss: 1.056 Vali Acc: 0.650 Test Loss: 1.056 Test Acc: 0.650
Validation loss decreased (-0.611099 --> -0.649989).  Saving model ...
Epoch: 10 cost time: 0.9346597194671631
Epoch: 10, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.966 Vali Acc: 0.683 Test Loss: 0.966 Test Acc: 0.683
Validation loss decreased (-0.649989 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 0.7507424354553223
Epoch: 11, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.900 Vali Acc: 0.683 Test Loss: 0.900 Test Acc: 0.683
Validation loss decreased (-0.683324 --> -0.683324).  Saving model ...
Epoch: 12 cost time: 0.7598402500152588
Epoch: 12, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.683324 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.8011643886566162
Epoch: 13, Steps: 12 | Train Loss: 0.374 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7774887084960938
Epoch: 14, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.824 Vali Acc: 0.733 Test Loss: 0.824 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0077149868011475
Epoch: 15, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.835 Vali Acc: 0.761 Test Loss: 0.835 Test Acc: 0.761
Validation loss decreased (-0.749991 --> -0.761103).  Saving model ...
Epoch: 16 cost time: 0.9199221134185791
Epoch: 16, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 17 cost time: 0.8072757720947266
Epoch: 17, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.702 Vali Acc: 0.794 Test Loss: 0.702 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 18 cost time: 0.7960901260375977
Epoch: 18, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.808 Vali Acc: 0.778 Test Loss: 0.808 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7680854797363281
Epoch: 19, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.788 Vali Acc: 0.756 Test Loss: 0.788 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6121761798858643
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.942 Vali Acc: 0.800 Test Loss: 0.942 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.7191674709320068
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.868 Vali Acc: 0.822 Test Loss: 0.868 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822214).  Saving model ...
Epoch: 22 cost time: 0.7341220378875732
Epoch: 22, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.822 Vali Acc: 0.828 Test Loss: 0.822 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827770).  Saving model ...
Epoch: 23 cost time: 0.7664270401000977
Epoch: 23, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.973 Vali Acc: 0.800 Test Loss: 0.973 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7329034805297852
Epoch: 24, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.790 Vali Acc: 0.817 Test Loss: 0.790 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7148780822753906
Epoch: 25, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.958 Vali Acc: 0.811 Test Loss: 0.958 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8155488967895508
Epoch: 26, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.942 Vali Acc: 0.811 Test Loss: 0.942 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7403964996337891
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.000 Vali Acc: 0.806 Test Loss: 1.000 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7697536945343018
Epoch: 28, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833324).  Saving model ...
Epoch: 29 cost time: 0.7016808986663818
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.935 Vali Acc: 0.794 Test Loss: 0.935 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6615943908691406
Epoch: 30, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.910 Vali Acc: 0.856 Test Loss: 0.910 Test Acc: 0.856
Validation loss decreased (-0.833324 --> -0.855546).  Saving model ...
Epoch: 31 cost time: 0.6428253650665283
Epoch: 31, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.034 Vali Acc: 0.794 Test Loss: 1.034 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6524291038513184
Epoch: 32, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.982 Vali Acc: 0.822 Test Loss: 0.982 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6785008907318115
Epoch: 33, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.934 Vali Acc: 0.833 Test Loss: 0.934 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.677595853805542
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.996 Vali Acc: 0.833 Test Loss: 0.996 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7518925666809082
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.961 Vali Acc: 0.844 Test Loss: 0.961 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7366824150085449
Epoch: 36, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.024 Vali Acc: 0.833 Test Loss: 1.024 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6252708435058594
Epoch: 37, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.102 Vali Acc: 0.806 Test Loss: 1.102 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8665063381195068
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.007 Vali Acc: 0.839 Test Loss: 1.007 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9719665050506592
Epoch: 39, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.011 Vali Acc: 0.833 Test Loss: 1.011 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8740859031677246
Epoch: 40, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.038 Vali Acc: 0.833 Test Loss: 1.038 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 29378319
model size : 126.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.299903392791748
Epoch: 1, Steps: 12 | Train Loss: 2.771 Vali Loss: 2.695 Vali Acc: 0.050 Test Loss: 2.695 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 0.955803394317627
Epoch: 2, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.564 Vali Acc: 0.211 Test Loss: 2.564 Test Acc: 0.211
Validation loss decreased (-0.049973 --> -0.211085).  Saving model ...
Epoch: 3 cost time: 0.7316656112670898
Epoch: 3, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.407 Vali Acc: 0.333 Test Loss: 2.407 Test Acc: 0.333
Validation loss decreased (-0.211085 --> -0.333309).  Saving model ...
Epoch: 4 cost time: 0.8510360717773438
Epoch: 4, Steps: 12 | Train Loss: 2.329 Vali Loss: 2.226 Vali Acc: 0.422 Test Loss: 2.226 Test Acc: 0.422
Validation loss decreased (-0.333309 --> -0.422200).  Saving model ...
Epoch: 5 cost time: 0.7558705806732178
Epoch: 5, Steps: 12 | Train Loss: 2.129 Vali Loss: 1.984 Vali Acc: 0.439 Test Loss: 1.984 Test Acc: 0.439
Validation loss decreased (-0.422200 --> -0.438869).  Saving model ...
Epoch: 6 cost time: 0.7136328220367432
Epoch: 6, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.692 Vali Acc: 0.544 Test Loss: 1.692 Test Acc: 0.544
Validation loss decreased (-0.438869 --> -0.544428).  Saving model ...
Epoch: 7 cost time: 0.6860108375549316
Epoch: 7, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.399 Vali Acc: 0.611 Test Loss: 1.399 Test Acc: 0.611
Validation loss decreased (-0.544428 --> -0.611097).  Saving model ...
Epoch: 8 cost time: 0.8450002670288086
Epoch: 8, Steps: 12 | Train Loss: 1.243 Vali Loss: 1.198 Vali Acc: 0.633 Test Loss: 1.198 Test Acc: 0.633
Validation loss decreased (-0.611097 --> -0.633321).  Saving model ...
Epoch: 9 cost time: 0.7429502010345459
Epoch: 9, Steps: 12 | Train Loss: 1.015 Vali Loss: 1.075 Vali Acc: 0.633 Test Loss: 1.075 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633323).  Saving model ...
Epoch: 10 cost time: 0.6824188232421875
Epoch: 10, Steps: 12 | Train Loss: 0.761 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
Validation loss decreased (-0.633323 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.5972702503204346
Epoch: 11, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.820 Vali Acc: 0.722 Test Loss: 0.820 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 12 cost time: 0.6494488716125488
Epoch: 12, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 13 cost time: 0.6145069599151611
Epoch: 13, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.749 Vali Acc: 0.739 Test Loss: 0.749 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 14 cost time: 0.6687359809875488
Epoch: 14, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.704 Vali Acc: 0.756 Test Loss: 0.704 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755549).  Saving model ...
Epoch: 15 cost time: 0.6535661220550537
Epoch: 15, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
Validation loss decreased (-0.755549 --> -0.805549).  Saving model ...
Epoch: 16 cost time: 0.654818058013916
Epoch: 16, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.690 Vali Acc: 0.794 Test Loss: 0.690 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6038048267364502
Epoch: 17, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.667 Vali Acc: 0.800 Test Loss: 0.667 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7060112953186035
Epoch: 18, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.612 Vali Acc: 0.794 Test Loss: 0.612 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6997621059417725
Epoch: 19, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.697 Vali Acc: 0.800 Test Loss: 0.697 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6163995265960693
Epoch: 20, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 21 cost time: 0.7048244476318359
Epoch: 21, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
Validation loss decreased (-0.811105 --> -0.822215).  Saving model ...
Epoch: 22 cost time: 0.744187593460083
Epoch: 22, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 23 cost time: 0.6885318756103516
Epoch: 23, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.669 Vali Acc: 0.822 Test Loss: 0.669 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.773550271987915
Epoch: 24, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.724 Vali Acc: 0.833 Test Loss: 0.724 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6376368999481201
Epoch: 25, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6966598033905029
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.699 Vali Acc: 0.833 Test Loss: 0.699 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.776949405670166
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.715 Vali Acc: 0.839 Test Loss: 0.715 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7274515628814697
Epoch: 28, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.712 Vali Acc: 0.828 Test Loss: 0.712 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8074243068695068
Epoch: 29, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.759 Vali Acc: 0.839 Test Loss: 0.759 Test Acc: 0.839
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5786952972412109
Epoch: 30, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.727 Vali Acc: 0.839 Test Loss: 0.727 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7645523548126221
Epoch: 31, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.755 Vali Acc: 0.861 Test Loss: 0.755 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861104).  Saving model ...
Epoch: 32 cost time: 0.7148933410644531
Epoch: 32, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.759 Vali Acc: 0.839 Test Loss: 0.759 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.704758882522583
Epoch: 33, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.826 Vali Acc: 0.844 Test Loss: 0.826 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6750500202178955
Epoch: 34, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.827 Vali Acc: 0.839 Test Loss: 0.827 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5349855422973633
Epoch: 35, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.793 Vali Acc: 0.839 Test Loss: 0.793 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5666160583496094
Epoch: 36, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.847 Vali Acc: 0.839 Test Loss: 0.847 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5555059909820557
Epoch: 37, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.858 Vali Acc: 0.844 Test Loss: 0.858 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5467593669891357
Epoch: 38, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.511021614074707
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.918 Vali Acc: 0.839 Test Loss: 0.918 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5417270660400391
Epoch: 40, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.880 Vali Acc: 0.833 Test Loss: 0.880 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5345463752746582
Epoch: 41, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.933 Vali Acc: 0.828 Test Loss: 0.933 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 29313039
model size : 126.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0048975944519043
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.631 Vali Acc: 0.094 Test Loss: 2.631 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 0.6530089378356934
Epoch: 2, Steps: 12 | Train Loss: 2.517 Vali Loss: 2.402 Vali Acc: 0.394 Test Loss: 2.402 Test Acc: 0.394
Validation loss decreased (-0.094418 --> -0.394420).  Saving model ...
Epoch: 3 cost time: 0.5979945659637451
Epoch: 3, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.124 Vali Acc: 0.456 Test Loss: 2.124 Test Acc: 0.456
Validation loss decreased (-0.394420 --> -0.455534).  Saving model ...
Epoch: 4 cost time: 0.6041896343231201
Epoch: 4, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.788 Vali Acc: 0.533 Test Loss: 1.788 Test Acc: 0.533
Validation loss decreased (-0.455534 --> -0.533315).  Saving model ...
Epoch: 5 cost time: 0.6879127025604248
Epoch: 5, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.439 Vali Acc: 0.539 Test Loss: 1.439 Test Acc: 0.539
Validation loss decreased (-0.533315 --> -0.538875).  Saving model ...
Epoch: 6 cost time: 0.6421718597412109
Epoch: 6, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.200 Vali Acc: 0.583 Test Loss: 1.200 Test Acc: 0.583
Validation loss decreased (-0.538875 --> -0.583321).  Saving model ...
Epoch: 7 cost time: 0.7661709785461426
Epoch: 7, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.137 Vali Acc: 0.578 Test Loss: 1.137 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7305738925933838
Epoch: 8, Steps: 12 | Train Loss: 0.850 Vali Loss: 0.960 Vali Acc: 0.650 Test Loss: 0.960 Test Acc: 0.650
Validation loss decreased (-0.583321 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.6291265487670898
Epoch: 9, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.972 Vali Acc: 0.672 Test Loss: 0.972 Test Acc: 0.672
Validation loss decreased (-0.649990 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 0.7700381278991699
Epoch: 10, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.877 Vali Acc: 0.672 Test Loss: 0.877 Test Acc: 0.672
Validation loss decreased (-0.672213 --> -0.672213).  Saving model ...
Epoch: 11 cost time: 0.6676716804504395
Epoch: 11, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.883 Vali Acc: 0.739 Test Loss: 0.883 Test Acc: 0.739
Validation loss decreased (-0.672213 --> -0.738880).  Saving model ...
Epoch: 12 cost time: 0.582230806350708
Epoch: 12, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.882 Vali Acc: 0.694 Test Loss: 0.882 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5619289875030518
Epoch: 13, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
Validation loss decreased (-0.738880 --> -0.783326).  Saving model ...
Epoch: 14 cost time: 0.6319272518157959
Epoch: 14, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.869 Vali Acc: 0.744 Test Loss: 0.869 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6724958419799805
Epoch: 15, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.714674711227417
Epoch: 16, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.821 Vali Acc: 0.772 Test Loss: 0.821 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6171524524688721
Epoch: 17, Steps: 12 | Train Loss: 0.207 Vali Loss: 1.022 Vali Acc: 0.789 Test Loss: 1.022 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788879).  Saving model ...
Epoch: 18 cost time: 0.8882150650024414
Epoch: 18, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.923 Vali Acc: 0.761 Test Loss: 0.923 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7692408561706543
Epoch: 19, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.785 Vali Acc: 0.806 Test Loss: 0.785 Test Acc: 0.806
Validation loss decreased (-0.788879 --> -0.805548).  Saving model ...
Epoch: 20 cost time: 0.8106422424316406
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.959 Vali Acc: 0.778 Test Loss: 0.959 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7766759395599365
Epoch: 21, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.903 Vali Acc: 0.772 Test Loss: 0.903 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6059658527374268
Epoch: 22, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.949 Vali Acc: 0.761 Test Loss: 0.949 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6619472503662109
Epoch: 23, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.945 Vali Acc: 0.794 Test Loss: 0.945 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4499626159667969
Epoch: 24, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.948 Vali Acc: 0.806 Test Loss: 0.948 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8876590728759766
Epoch: 25, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.910 Vali Acc: 0.800 Test Loss: 0.910 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8186771869659424
Epoch: 26, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.948 Vali Acc: 0.822 Test Loss: 0.948 Test Acc: 0.822
Validation loss decreased (-0.805548 --> -0.822213).  Saving model ...
Epoch: 27 cost time: 0.8375198841094971
Epoch: 27, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.971 Vali Acc: 0.811 Test Loss: 0.971 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5988686084747314
Epoch: 28, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.129 Vali Acc: 0.767 Test Loss: 1.129 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7562751770019531
Epoch: 29, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.124 Vali Acc: 0.806 Test Loss: 1.124 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8036584854125977
Epoch: 30, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.126 Vali Acc: 0.800 Test Loss: 1.126 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7376675605773926
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.061 Vali Acc: 0.822 Test Loss: 1.061 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7137386798858643
Epoch: 32, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.147 Vali Acc: 0.822 Test Loss: 1.147 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7632172107696533
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.352 Vali Acc: 0.800 Test Loss: 1.352 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6769659519195557
Epoch: 34, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.219 Vali Acc: 0.806 Test Loss: 1.219 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7318711280822754
Epoch: 35, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.492 Vali Acc: 0.789 Test Loss: 1.492 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.969872236251831
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.183 Vali Acc: 0.817 Test Loss: 1.183 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 29422095
model size : 126.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9657158851623535
Epoch: 1, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.612 Vali Acc: 0.156 Test Loss: 2.612 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 0.612708568572998
Epoch: 2, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.442 Vali Acc: 0.378 Test Loss: 2.442 Test Acc: 0.378
Validation loss decreased (-0.155529 --> -0.377753).  Saving model ...
Epoch: 3 cost time: 0.5479755401611328
Epoch: 3, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.232 Vali Acc: 0.494 Test Loss: 2.232 Test Acc: 0.494
Validation loss decreased (-0.377753 --> -0.494422).  Saving model ...
Epoch: 4 cost time: 0.6086761951446533
Epoch: 4, Steps: 12 | Train Loss: 2.135 Vali Loss: 1.960 Vali Acc: 0.500 Test Loss: 1.960 Test Acc: 0.500
Validation loss decreased (-0.494422 --> -0.499980).  Saving model ...
Epoch: 5 cost time: 0.619905948638916
Epoch: 5, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.644 Vali Acc: 0.544 Test Loss: 1.644 Test Acc: 0.544
Validation loss decreased (-0.499980 --> -0.544428).  Saving model ...
Epoch: 6 cost time: 0.7507996559143066
Epoch: 6, Steps: 12 | Train Loss: 1.505 Vali Loss: 1.337 Vali Acc: 0.578 Test Loss: 1.337 Test Acc: 0.578
Validation loss decreased (-0.544428 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.6756093502044678
Epoch: 7, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.111 Vali Acc: 0.622 Test Loss: 1.111 Test Acc: 0.622
Validation loss decreased (-0.577764 --> -0.622211).  Saving model ...
Epoch: 8 cost time: 0.5612421035766602
Epoch: 8, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.002 Vali Acc: 0.639 Test Loss: 1.002 Test Acc: 0.639
Validation loss decreased (-0.622211 --> -0.638879).  Saving model ...
Epoch: 9 cost time: 0.695775032043457
Epoch: 9, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.873 Vali Acc: 0.683 Test Loss: 0.873 Test Acc: 0.683
Validation loss decreased (-0.638879 --> -0.683325).  Saving model ...
Epoch: 10 cost time: 0.6265840530395508
Epoch: 10, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.838 Vali Acc: 0.694 Test Loss: 0.838 Test Acc: 0.694
Validation loss decreased (-0.683325 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 0.6387362480163574
Epoch: 11, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.764 Vali Acc: 0.711 Test Loss: 0.764 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.6611905097961426
Epoch: 12, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
Validation loss decreased (-0.711103 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 0.676260232925415
Epoch: 13, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.761 Vali Acc: 0.739 Test Loss: 0.761 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6234667301177979
Epoch: 14, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.744 Vali Acc: 0.744 Test Loss: 0.744 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6045939922332764
Epoch: 15, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.718 Vali Acc: 0.767 Test Loss: 0.718 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.6001079082489014
Epoch: 16, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.790 Vali Acc: 0.728 Test Loss: 0.790 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5592958927154541
Epoch: 17, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.733 Vali Acc: 0.811 Test Loss: 0.733 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811104).  Saving model ...
Epoch: 18 cost time: 0.7164859771728516
Epoch: 18, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.727 Vali Acc: 0.811 Test Loss: 0.727 Test Acc: 0.811
Validation loss decreased (-0.811104 --> -0.811104).  Saving model ...
Epoch: 19 cost time: 0.6364328861236572
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.847 Vali Acc: 0.822 Test Loss: 0.847 Test Acc: 0.822
Validation loss decreased (-0.811104 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 0.6044051647186279
Epoch: 20, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.836 Vali Acc: 0.767 Test Loss: 0.836 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.656468391418457
Epoch: 21, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.704 Vali Acc: 0.811 Test Loss: 0.704 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6602132320404053
Epoch: 22, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.800 Vali Acc: 0.789 Test Loss: 0.800 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5124557018280029
Epoch: 23, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.780 Vali Acc: 0.806 Test Loss: 0.780 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5293700695037842
Epoch: 24, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.848 Vali Acc: 0.794 Test Loss: 0.848 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5797288417816162
Epoch: 25, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.790 Vali Acc: 0.828 Test Loss: 0.790 Test Acc: 0.828
Validation loss decreased (-0.822214 --> -0.827770).  Saving model ...
Epoch: 26 cost time: 0.6772556304931641
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.849 Vali Acc: 0.828 Test Loss: 0.849 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6640701293945312
Epoch: 27, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.813 Vali Acc: 0.833 Test Loss: 0.813 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833325).  Saving model ...
Epoch: 28 cost time: 0.6686053276062012
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.884 Vali Acc: 0.800 Test Loss: 0.884 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6056187152862549
Epoch: 29, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.864 Vali Acc: 0.817 Test Loss: 0.864 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6746244430541992
Epoch: 30, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.834 Vali Acc: 0.850 Test Loss: 0.834 Test Acc: 0.850
Validation loss decreased (-0.833325 --> -0.849992).  Saving model ...
Epoch: 31 cost time: 0.7699122428894043
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.897 Vali Acc: 0.806 Test Loss: 0.897 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6548571586608887
Epoch: 32, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.006 Vali Acc: 0.822 Test Loss: 1.006 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6542818546295166
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.864 Vali Acc: 0.828 Test Loss: 0.864 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6663143634796143
Epoch: 34, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.953 Vali Acc: 0.822 Test Loss: 0.953 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6844415664672852
Epoch: 35, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.902 Vali Acc: 0.839 Test Loss: 0.902 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6966269016265869
Epoch: 36, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.008 Vali Acc: 0.822 Test Loss: 1.008 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6487915515899658
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.980 Vali Acc: 0.828 Test Loss: 0.980 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6651544570922852
Epoch: 38, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.926 Vali Acc: 0.833 Test Loss: 0.926 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6926357746124268
Epoch: 39, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.007 Vali Acc: 0.811 Test Loss: 1.007 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7041454315185547
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.915 Vali Acc: 0.822 Test Loss: 0.915 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 29356815
model size : 126.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0828819274902344
Epoch: 1, Steps: 12 | Train Loss: 2.791 Vali Loss: 2.672 Vali Acc: 0.094 Test Loss: 2.672 Test Acc: 0.094
Validation loss decreased (inf --> -0.094418).  Saving model ...
Epoch: 2 cost time: 0.6089818477630615
Epoch: 2, Steps: 12 | Train Loss: 2.640 Vali Loss: 2.523 Vali Acc: 0.267 Test Loss: 2.523 Test Acc: 0.267
Validation loss decreased (-0.094418 --> -0.266641).  Saving model ...
Epoch: 3 cost time: 0.6479129791259766
Epoch: 3, Steps: 12 | Train Loss: 2.464 Vali Loss: 2.360 Vali Acc: 0.361 Test Loss: 2.360 Test Acc: 0.361
Validation loss decreased (-0.266641 --> -0.361088).  Saving model ...
Epoch: 4 cost time: 0.6199777126312256
Epoch: 4, Steps: 12 | Train Loss: 2.249 Vali Loss: 2.147 Vali Acc: 0.467 Test Loss: 2.147 Test Acc: 0.467
Validation loss decreased (-0.361088 --> -0.466645).  Saving model ...
Epoch: 5 cost time: 0.6627471446990967
Epoch: 5, Steps: 12 | Train Loss: 1.970 Vali Loss: 1.860 Vali Acc: 0.511 Test Loss: 1.860 Test Acc: 0.511
Validation loss decreased (-0.466645 --> -0.511093).  Saving model ...
Epoch: 6 cost time: 0.8055801391601562
Epoch: 6, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.571 Vali Acc: 0.539 Test Loss: 1.571 Test Acc: 0.539
Validation loss decreased (-0.511093 --> -0.538873).  Saving model ...
Epoch: 7 cost time: 0.8386294841766357
Epoch: 7, Steps: 12 | Train Loss: 1.357 Vali Loss: 1.327 Vali Acc: 0.561 Test Loss: 1.327 Test Acc: 0.561
Validation loss decreased (-0.538873 --> -0.561098).  Saving model ...
Epoch: 8 cost time: 0.732154130935669
Epoch: 8, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.149 Vali Acc: 0.578 Test Loss: 1.149 Test Acc: 0.578
Validation loss decreased (-0.561098 --> -0.577766).  Saving model ...
Epoch: 9 cost time: 0.8126413822174072
Epoch: 9, Steps: 12 | Train Loss: 0.909 Vali Loss: 0.982 Vali Acc: 0.672 Test Loss: 0.982 Test Acc: 0.672
Validation loss decreased (-0.577766 --> -0.672212).  Saving model ...
Epoch: 10 cost time: 0.6178250312805176
Epoch: 10, Steps: 12 | Train Loss: 0.832 Vali Loss: 0.881 Vali Acc: 0.694 Test Loss: 0.881 Test Acc: 0.694
Validation loss decreased (-0.672212 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 0.6451461315155029
Epoch: 11, Steps: 12 | Train Loss: 0.759 Vali Loss: 0.813 Vali Acc: 0.683 Test Loss: 0.813 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7880640029907227
Epoch: 12, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.753 Vali Acc: 0.722 Test Loss: 0.753 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722215).  Saving model ...
Epoch: 13 cost time: 0.7554337978363037
Epoch: 13, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.728 Vali Acc: 0.739 Test Loss: 0.728 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 0.5969681739807129
Epoch: 14, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.682 Vali Acc: 0.761 Test Loss: 0.682 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761104).  Saving model ...
Epoch: 15 cost time: 0.5745694637298584
Epoch: 15, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.667 Vali Acc: 0.767 Test Loss: 0.667 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 16 cost time: 0.5953373908996582
Epoch: 16, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.659 Vali Acc: 0.800 Test Loss: 0.659 Test Acc: 0.800
Validation loss decreased (-0.766660 --> -0.799993).  Saving model ...
Epoch: 17 cost time: 0.606722354888916
Epoch: 17, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5911436080932617
Epoch: 18, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.622 Vali Acc: 0.800 Test Loss: 0.622 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799994).  Saving model ...
Epoch: 19 cost time: 0.5831811428070068
Epoch: 19, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.689 Vali Acc: 0.817 Test Loss: 0.689 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816660).  Saving model ...
Epoch: 20 cost time: 0.5877017974853516
Epoch: 20, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.662 Vali Acc: 0.800 Test Loss: 0.662 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.590252161026001
Epoch: 21, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.634 Vali Acc: 0.811 Test Loss: 0.634 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5771634578704834
Epoch: 22, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.666 Vali Acc: 0.817 Test Loss: 0.666 Test Acc: 0.817
Validation loss decreased (-0.816660 --> -0.816660).  Saving model ...
Epoch: 23 cost time: 0.6612935066223145
Epoch: 23, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.643 Vali Acc: 0.828 Test Loss: 0.643 Test Acc: 0.828
Validation loss decreased (-0.816660 --> -0.827771).  Saving model ...
Epoch: 24 cost time: 0.5861279964447021
Epoch: 24, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.659 Vali Acc: 0.828 Test Loss: 0.659 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6138906478881836
Epoch: 25, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 26 cost time: 0.6364097595214844
Epoch: 26, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 27 cost time: 0.6486907005310059
Epoch: 27, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.587418794631958
Epoch: 28, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7090322971343994
Epoch: 29, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.671 Vali Acc: 0.828 Test Loss: 0.671 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7424042224884033
Epoch: 30, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.707 Vali Acc: 0.839 Test Loss: 0.707 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 31 cost time: 0.6545641422271729
Epoch: 31, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.737 Vali Acc: 0.822 Test Loss: 0.737 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7491962909698486
Epoch: 32, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.772 Vali Acc: 0.828 Test Loss: 0.772 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6341030597686768
Epoch: 33, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.740 Vali Acc: 0.828 Test Loss: 0.740 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6431887149810791
Epoch: 34, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.784 Vali Acc: 0.833 Test Loss: 0.784 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.58217453956604
Epoch: 35, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.731 Vali Acc: 0.828 Test Loss: 0.731 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6476750373840332
Epoch: 36, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.820 Vali Acc: 0.833 Test Loss: 0.820 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7118594646453857
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.723 Vali Acc: 0.844 Test Loss: 0.723 Test Acc: 0.844
Validation loss decreased (-0.838882 --> -0.844437).  Saving model ...
Epoch: 38 cost time: 0.593803882598877
Epoch: 38, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.810 Vali Acc: 0.839 Test Loss: 0.810 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.563162088394165
Epoch: 39, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.799 Vali Acc: 0.833 Test Loss: 0.799 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6268045902252197
Epoch: 40, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.804 Vali Acc: 0.850 Test Loss: 0.804 Test Acc: 0.850
Validation loss decreased (-0.844437 --> -0.849992).  Saving model ...
Epoch: 41 cost time: 0.5824851989746094
Epoch: 41, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.866 Vali Acc: 0.828 Test Loss: 0.866 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5942749977111816
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.894 Vali Acc: 0.844 Test Loss: 0.894 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6010375022888184
Epoch: 43, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.872 Vali Acc: 0.839 Test Loss: 0.872 Test Acc: 0.839
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6169490814208984
Epoch: 44, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.875 Vali Acc: 0.844 Test Loss: 0.875 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5911948680877686
Epoch: 45, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6043024063110352
Epoch: 46, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.956 Vali Acc: 0.844 Test Loss: 0.956 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6548590660095215
Epoch: 47, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.930 Vali Acc: 0.817 Test Loss: 0.930 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6743981838226318
Epoch: 48, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.883 Vali Acc: 0.850 Test Loss: 0.883 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5626542568206787
Epoch: 49, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.887 Vali Acc: 0.828 Test Loss: 0.887 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.527165412902832
Epoch: 50, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.879 Vali Acc: 0.850 Test Loss: 0.879 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.85
model parameter : 29317647
model size : 126.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9939723014831543
Epoch: 1, Steps: 12 | Train Loss: 2.756 Vali Loss: 2.479 Vali Acc: 0.300 Test Loss: 2.479 Test Acc: 0.300
Validation loss decreased (inf --> -0.299975).  Saving model ...
Epoch: 2 cost time: 1.0436124801635742
Epoch: 2, Steps: 12 | Train Loss: 2.262 Vali Loss: 1.970 Vali Acc: 0.456 Test Loss: 1.970 Test Acc: 0.456
Validation loss decreased (-0.299975 --> -0.455536).  Saving model ...
Epoch: 3 cost time: 1.119401454925537
Epoch: 3, Steps: 12 | Train Loss: 1.801 Vali Loss: 1.602 Vali Acc: 0.544 Test Loss: 1.602 Test Acc: 0.544
Validation loss decreased (-0.455536 --> -0.544428).  Saving model ...
Epoch: 4 cost time: 1.0237512588500977
Epoch: 4, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.344 Vali Acc: 0.578 Test Loss: 1.344 Test Acc: 0.578
Validation loss decreased (-0.544428 --> -0.577764).  Saving model ...
Epoch: 5 cost time: 1.1435692310333252
Epoch: 5, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.172 Vali Acc: 0.639 Test Loss: 1.172 Test Acc: 0.639
Validation loss decreased (-0.577764 --> -0.638877).  Saving model ...
Epoch: 6 cost time: 1.1146032810211182
Epoch: 6, Steps: 12 | Train Loss: 0.920 Vali Loss: 1.135 Vali Acc: 0.667 Test Loss: 1.135 Test Acc: 0.667
Validation loss decreased (-0.638877 --> -0.666655).  Saving model ...
Epoch: 7 cost time: 1.0910625457763672
Epoch: 7, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.252 Vali Acc: 0.639 Test Loss: 1.252 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9985690116882324
Epoch: 8, Steps: 12 | Train Loss: 0.886 Vali Loss: 1.267 Vali Acc: 0.667 Test Loss: 1.267 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9256856441497803
Epoch: 9, Steps: 12 | Train Loss: 0.729 Vali Loss: 1.644 Vali Acc: 0.622 Test Loss: 1.644 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7793502807617188
Epoch: 10, Steps: 12 | Train Loss: 0.846 Vali Loss: 1.481 Vali Acc: 0.622 Test Loss: 1.481 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8682754039764404
Epoch: 11, Steps: 12 | Train Loss: 0.641 Vali Loss: 1.158 Vali Acc: 0.694 Test Loss: 1.158 Test Acc: 0.694
Validation loss decreased (-0.666655 --> -0.694433).  Saving model ...
Epoch: 12 cost time: 0.6977033615112305
Epoch: 12, Steps: 12 | Train Loss: 0.530 Vali Loss: 1.257 Vali Acc: 0.700 Test Loss: 1.257 Test Acc: 0.700
Validation loss decreased (-0.694433 --> -0.699987).  Saving model ...
Epoch: 13 cost time: 1.0158135890960693
Epoch: 13, Steps: 12 | Train Loss: 0.456 Vali Loss: 1.584 Vali Acc: 0.700 Test Loss: 1.584 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7029526233673096
Epoch: 14, Steps: 12 | Train Loss: 0.497 Vali Loss: 1.932 Vali Acc: 0.672 Test Loss: 1.932 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8560285568237305
Epoch: 15, Steps: 12 | Train Loss: 0.618 Vali Loss: 1.550 Vali Acc: 0.711 Test Loss: 1.550 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711096).  Saving model ...
Epoch: 16 cost time: 1.198559045791626
Epoch: 16, Steps: 12 | Train Loss: 0.463 Vali Loss: 1.409 Vali Acc: 0.739 Test Loss: 1.409 Test Acc: 0.739
Validation loss decreased (-0.711096 --> -0.738875).  Saving model ...
Epoch: 17 cost time: 1.2308003902435303
Epoch: 17, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.899 Vali Acc: 0.678 Test Loss: 1.899 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9604113101959229
Epoch: 18, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.992 Vali Acc: 0.694 Test Loss: 1.992 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8398027420043945
Epoch: 19, Steps: 12 | Train Loss: 0.343 Vali Loss: 1.727 Vali Acc: 0.706 Test Loss: 1.727 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.059485912322998
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 1.746 Vali Acc: 0.733 Test Loss: 1.746 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7921571731567383
Epoch: 21, Steps: 12 | Train Loss: 0.150 Vali Loss: 2.302 Vali Acc: 0.694 Test Loss: 2.302 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1431519985198975
Epoch: 22, Steps: 12 | Train Loss: 0.334 Vali Loss: 2.304 Vali Acc: 0.706 Test Loss: 2.304 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.263193130493164
Epoch: 23, Steps: 12 | Train Loss: 0.346 Vali Loss: 1.950 Vali Acc: 0.767 Test Loss: 1.950 Test Acc: 0.767
Validation loss decreased (-0.738875 --> -0.766647).  Saving model ...
Epoch: 24 cost time: 1.1218023300170898
Epoch: 24, Steps: 12 | Train Loss: 0.290 Vali Loss: 2.297 Vali Acc: 0.733 Test Loss: 2.297 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4061987400054932
Epoch: 25, Steps: 12 | Train Loss: 0.248 Vali Loss: 1.923 Vali Acc: 0.767 Test Loss: 1.923 Test Acc: 0.767
Validation loss decreased (-0.766647 --> -0.766647).  Saving model ...
Epoch: 26 cost time: 0.886570930480957
Epoch: 26, Steps: 12 | Train Loss: 0.159 Vali Loss: 2.444 Vali Acc: 0.700 Test Loss: 2.444 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.151052713394165
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 2.509 Vali Acc: 0.728 Test Loss: 2.509 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.123131275177002
Epoch: 28, Steps: 12 | Train Loss: 0.088 Vali Loss: 2.480 Vali Acc: 0.744 Test Loss: 2.480 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2225089073181152
Epoch: 29, Steps: 12 | Train Loss: 0.252 Vali Loss: 2.127 Vali Acc: 0.728 Test Loss: 2.127 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2447516918182373
Epoch: 30, Steps: 12 | Train Loss: 0.140 Vali Loss: 2.834 Vali Acc: 0.700 Test Loss: 2.834 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1467065811157227
Epoch: 31, Steps: 12 | Train Loss: 0.135 Vali Loss: 2.342 Vali Acc: 0.722 Test Loss: 2.342 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1162340641021729
Epoch: 32, Steps: 12 | Train Loss: 0.198 Vali Loss: 2.898 Vali Acc: 0.761 Test Loss: 2.898 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.424264669418335
Epoch: 33, Steps: 12 | Train Loss: 0.124 Vali Loss: 2.381 Vali Acc: 0.733 Test Loss: 2.381 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.196385383605957
Epoch: 34, Steps: 12 | Train Loss: 0.144 Vali Loss: 3.172 Vali Acc: 0.706 Test Loss: 3.172 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0754094123840332
Epoch: 35, Steps: 12 | Train Loss: 0.424 Vali Loss: 2.691 Vali Acc: 0.772 Test Loss: 2.691 Test Acc: 0.772
Validation loss decreased (-0.766647 --> -0.772195).  Saving model ...
Epoch: 36 cost time: 1.1099843978881836
Epoch: 36, Steps: 12 | Train Loss: 0.053 Vali Loss: 2.953 Vali Acc: 0.756 Test Loss: 2.953 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0821952819824219
Epoch: 37, Steps: 12 | Train Loss: 0.033 Vali Loss: 2.841 Vali Acc: 0.733 Test Loss: 2.841 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3907172679901123
Epoch: 38, Steps: 12 | Train Loss: 0.035 Vali Loss: 2.955 Vali Acc: 0.750 Test Loss: 2.955 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.074434518814087
Epoch: 39, Steps: 12 | Train Loss: 0.031 Vali Loss: 2.974 Vali Acc: 0.733 Test Loss: 2.974 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8595967292785645
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 3.142 Vali Acc: 0.706 Test Loss: 3.142 Test Acc: 0.706
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.787459135055542
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 2.959 Vali Acc: 0.750 Test Loss: 2.959 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9845654964447021
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 3.722 Vali Acc: 0.706 Test Loss: 3.722 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0308985710144043
Epoch: 43, Steps: 12 | Train Loss: 0.105 Vali Loss: 3.043 Vali Acc: 0.761 Test Loss: 3.043 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8547449111938477
Epoch: 44, Steps: 12 | Train Loss: 0.000 Vali Loss: 2.906 Vali Acc: 0.778 Test Loss: 2.906 Test Acc: 0.778
Validation loss decreased (-0.772195 --> -0.777749).  Saving model ...
Epoch: 45 cost time: 0.7930314540863037
Epoch: 45, Steps: 12 | Train Loss: 0.010 Vali Loss: 3.212 Vali Acc: 0.767 Test Loss: 3.212 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8209364414215088
Epoch: 46, Steps: 12 | Train Loss: 0.095 Vali Loss: 3.519 Vali Acc: 0.706 Test Loss: 3.519 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8565442562103271
Epoch: 47, Steps: 12 | Train Loss: 0.112 Vali Loss: 2.845 Vali Acc: 0.711 Test Loss: 2.845 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8941059112548828
Epoch: 48, Steps: 12 | Train Loss: 0.151 Vali Loss: 3.667 Vali Acc: 0.706 Test Loss: 3.667 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9729912281036377
Epoch: 49, Steps: 12 | Train Loss: 0.172 Vali Loss: 3.313 Vali Acc: 0.722 Test Loss: 3.313 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9795022010803223
Epoch: 50, Steps: 12 | Train Loss: 0.129 Vali Loss: 3.355 Vali Acc: 0.767 Test Loss: 3.355 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 22706703
model size : 101.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.043393135070801
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.620 Vali Acc: 0.250 Test Loss: 2.620 Test Acc: 0.250
Validation loss decreased (inf --> -0.249974).  Saving model ...
Epoch: 2 cost time: 0.8892135620117188
Epoch: 2, Steps: 12 | Train Loss: 2.468 Vali Loss: 2.244 Vali Acc: 0.394 Test Loss: 2.244 Test Acc: 0.394
Validation loss decreased (-0.249974 --> -0.394422).  Saving model ...
Epoch: 3 cost time: 0.6812241077423096
Epoch: 3, Steps: 12 | Train Loss: 2.015 Vali Loss: 1.811 Vali Acc: 0.561 Test Loss: 1.811 Test Acc: 0.561
Validation loss decreased (-0.394422 --> -0.561093).  Saving model ...
Epoch: 4 cost time: 0.8644742965698242
Epoch: 4, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.556 Vali Acc: 0.561 Test Loss: 1.556 Test Acc: 0.561
Validation loss decreased (-0.561093 --> -0.561096).  Saving model ...
Epoch: 5 cost time: 0.7205710411071777
Epoch: 5, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.282 Vali Acc: 0.594 Test Loss: 1.282 Test Acc: 0.594
Validation loss decreased (-0.561096 --> -0.594432).  Saving model ...
Epoch: 6 cost time: 0.9632828235626221
Epoch: 6, Steps: 12 | Train Loss: 1.026 Vali Loss: 1.158 Vali Acc: 0.606 Test Loss: 1.158 Test Acc: 0.606
Validation loss decreased (-0.594432 --> -0.605544).  Saving model ...
Epoch: 7 cost time: 0.917400598526001
Epoch: 7, Steps: 12 | Train Loss: 0.907 Vali Loss: 0.943 Vali Acc: 0.656 Test Loss: 0.943 Test Acc: 0.656
Validation loss decreased (-0.605544 --> -0.655546).  Saving model ...
Epoch: 8 cost time: 0.902381420135498
Epoch: 8, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.077 Vali Acc: 0.617 Test Loss: 1.077 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.790755033493042
Epoch: 9, Steps: 12 | Train Loss: 0.634 Vali Loss: 1.132 Vali Acc: 0.650 Test Loss: 1.132 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6015925407409668
Epoch: 10, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.944 Vali Acc: 0.706 Test Loss: 0.944 Test Acc: 0.706
Validation loss decreased (-0.655546 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 0.6927170753479004
Epoch: 11, Steps: 12 | Train Loss: 0.432 Vali Loss: 1.182 Vali Acc: 0.683 Test Loss: 1.182 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5342130661010742
Epoch: 12, Steps: 12 | Train Loss: 0.466 Vali Loss: 1.194 Vali Acc: 0.683 Test Loss: 1.194 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8109383583068848
Epoch: 13, Steps: 12 | Train Loss: 0.490 Vali Loss: 1.025 Vali Acc: 0.733 Test Loss: 1.025 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 0.6119251251220703
Epoch: 14, Steps: 12 | Train Loss: 0.370 Vali Loss: 1.162 Vali Acc: 0.728 Test Loss: 1.162 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5944955348968506
Epoch: 15, Steps: 12 | Train Loss: 0.258 Vali Loss: 1.003 Vali Acc: 0.761 Test Loss: 1.003 Test Acc: 0.761
Validation loss decreased (-0.733323 --> -0.761101).  Saving model ...
Epoch: 16 cost time: 0.560175895690918
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 1.266 Vali Acc: 0.711 Test Loss: 1.266 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5456931591033936
Epoch: 17, Steps: 12 | Train Loss: 0.159 Vali Loss: 1.084 Vali Acc: 0.778 Test Loss: 1.084 Test Acc: 0.778
Validation loss decreased (-0.761101 --> -0.777767).  Saving model ...
Epoch: 18 cost time: 0.49956631660461426
Epoch: 18, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.251 Vali Acc: 0.744 Test Loss: 1.251 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5061495304107666
Epoch: 19, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.017 Vali Acc: 0.778 Test Loss: 1.017 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777768).  Saving model ...
Epoch: 20 cost time: 0.7097413539886475
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.160 Vali Acc: 0.728 Test Loss: 1.160 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7368795871734619
Epoch: 21, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.230 Vali Acc: 0.783 Test Loss: 1.230 Test Acc: 0.783
Validation loss decreased (-0.777768 --> -0.783321).  Saving model ...
Epoch: 22 cost time: 0.7577950954437256
Epoch: 22, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.109 Vali Acc: 0.806 Test Loss: 1.109 Test Acc: 0.806
Validation loss decreased (-0.783321 --> -0.805544).  Saving model ...
Epoch: 23 cost time: 0.7387645244598389
Epoch: 23, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.390 Vali Acc: 0.772 Test Loss: 1.390 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.665353536605835
Epoch: 24, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.365 Vali Acc: 0.794 Test Loss: 1.365 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8297104835510254
Epoch: 25, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.431 Vali Acc: 0.778 Test Loss: 1.431 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7174880504608154
Epoch: 26, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.361 Vali Acc: 0.783 Test Loss: 1.361 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6152207851409912
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.353 Vali Acc: 0.778 Test Loss: 1.353 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5492119789123535
Epoch: 28, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.332 Vali Acc: 0.778 Test Loss: 1.332 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.654573917388916
Epoch: 29, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.320 Vali Acc: 0.789 Test Loss: 1.320 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7472438812255859
Epoch: 30, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.361 Vali Acc: 0.811 Test Loss: 1.361 Test Acc: 0.811
Validation loss decreased (-0.805544 --> -0.811097).  Saving model ...
Epoch: 31 cost time: 0.8169710636138916
Epoch: 31, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.490 Vali Acc: 0.783 Test Loss: 1.490 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7121505737304688
Epoch: 32, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.438 Vali Acc: 0.817 Test Loss: 1.438 Test Acc: 0.817
Validation loss decreased (-0.811097 --> -0.816652).  Saving model ...
Epoch: 33 cost time: 0.7845063209533691
Epoch: 33, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.623 Vali Acc: 0.783 Test Loss: 1.623 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7227799892425537
Epoch: 34, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.431 Vali Acc: 0.806 Test Loss: 1.431 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8466818332672119
Epoch: 35, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.717 Vali Acc: 0.750 Test Loss: 1.717 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5392022132873535
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.659 Vali Acc: 0.783 Test Loss: 1.659 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4769418239593506
Epoch: 37, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.756 Vali Acc: 0.800 Test Loss: 1.756 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5298221111297607
Epoch: 38, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.638 Vali Acc: 0.789 Test Loss: 1.638 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6970183849334717
Epoch: 39, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.572 Vali Acc: 0.789 Test Loss: 1.572 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.687537670135498
Epoch: 40, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.728 Vali Acc: 0.767 Test Loss: 1.728 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5980746746063232
Epoch: 41, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.596 Vali Acc: 0.806 Test Loss: 1.596 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5835132598876953
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.610 Vali Acc: 0.794 Test Loss: 1.610 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 22419471
model size : 100.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.333902597427368
Epoch: 1, Steps: 12 | Train Loss: 2.779 Vali Loss: 2.543 Vali Acc: 0.206 Test Loss: 2.543 Test Acc: 0.206
Validation loss decreased (inf --> -0.205530).  Saving model ...
Epoch: 2 cost time: 0.7208545207977295
Epoch: 2, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.060 Vali Acc: 0.472 Test Loss: 2.060 Test Acc: 0.472
Validation loss decreased (-0.205530 --> -0.472202).  Saving model ...
Epoch: 3 cost time: 0.782994270324707
Epoch: 3, Steps: 12 | Train Loss: 1.737 Vali Loss: 1.633 Vali Acc: 0.578 Test Loss: 1.633 Test Acc: 0.578
Validation loss decreased (-0.472202 --> -0.577761).  Saving model ...
Epoch: 4 cost time: 0.8437588214874268
Epoch: 4, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.472 Vali Acc: 0.517 Test Loss: 1.472 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8486206531524658
Epoch: 5, Steps: 12 | Train Loss: 1.164 Vali Loss: 1.268 Vali Acc: 0.622 Test Loss: 1.268 Test Acc: 0.622
Validation loss decreased (-0.577761 --> -0.622210).  Saving model ...
Epoch: 6 cost time: 1.0130574703216553
Epoch: 6, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.250 Vali Acc: 0.567 Test Loss: 1.250 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9334547519683838
Epoch: 7, Steps: 12 | Train Loss: 0.876 Vali Loss: 1.022 Vali Acc: 0.661 Test Loss: 1.022 Test Acc: 0.661
Validation loss decreased (-0.622210 --> -0.661101).  Saving model ...
Epoch: 8 cost time: 1.0035738945007324
Epoch: 8, Steps: 12 | Train Loss: 0.683 Vali Loss: 1.068 Vali Acc: 0.639 Test Loss: 1.068 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9223484992980957
Epoch: 9, Steps: 12 | Train Loss: 0.843 Vali Loss: 1.268 Vali Acc: 0.661 Test Loss: 1.268 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.88234543800354
Epoch: 10, Steps: 12 | Train Loss: 0.572 Vali Loss: 1.287 Vali Acc: 0.689 Test Loss: 1.287 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 0.6321589946746826
Epoch: 11, Steps: 12 | Train Loss: 0.544 Vali Loss: 1.316 Vali Acc: 0.656 Test Loss: 1.316 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6591050624847412
Epoch: 12, Steps: 12 | Train Loss: 0.526 Vali Loss: 1.415 Vali Acc: 0.689 Test Loss: 1.415 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6785080432891846
Epoch: 13, Steps: 12 | Train Loss: 0.312 Vali Loss: 1.325 Vali Acc: 0.706 Test Loss: 1.325 Test Acc: 0.706
Validation loss decreased (-0.688876 --> -0.705542).  Saving model ...
Epoch: 14 cost time: 0.5780739784240723
Epoch: 14, Steps: 12 | Train Loss: 0.288 Vali Loss: 1.600 Vali Acc: 0.711 Test Loss: 1.600 Test Acc: 0.711
Validation loss decreased (-0.705542 --> -0.711095).  Saving model ...
Epoch: 15 cost time: 0.6699209213256836
Epoch: 15, Steps: 12 | Train Loss: 0.411 Vali Loss: 1.588 Vali Acc: 0.689 Test Loss: 1.588 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6720180511474609
Epoch: 16, Steps: 12 | Train Loss: 0.464 Vali Loss: 1.718 Vali Acc: 0.722 Test Loss: 1.718 Test Acc: 0.722
Validation loss decreased (-0.711095 --> -0.722205).  Saving model ...
Epoch: 17 cost time: 0.6911351680755615
Epoch: 17, Steps: 12 | Train Loss: 0.390 Vali Loss: 1.664 Vali Acc: 0.689 Test Loss: 1.664 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6653356552124023
Epoch: 18, Steps: 12 | Train Loss: 0.201 Vali Loss: 1.980 Vali Acc: 0.644 Test Loss: 1.980 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6105222702026367
Epoch: 19, Steps: 12 | Train Loss: 0.354 Vali Loss: 2.204 Vali Acc: 0.689 Test Loss: 2.204 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7654561996459961
Epoch: 20, Steps: 12 | Train Loss: 0.465 Vali Loss: 2.280 Vali Acc: 0.683 Test Loss: 2.280 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8346719741821289
Epoch: 21, Steps: 12 | Train Loss: 0.448 Vali Loss: 1.943 Vali Acc: 0.711 Test Loss: 1.943 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7456765174865723
Epoch: 22, Steps: 12 | Train Loss: 0.228 Vali Loss: 2.040 Vali Acc: 0.728 Test Loss: 2.040 Test Acc: 0.728
Validation loss decreased (-0.722205 --> -0.727757).  Saving model ...
Epoch: 23 cost time: 0.8025355339050293
Epoch: 23, Steps: 12 | Train Loss: 0.240 Vali Loss: 1.905 Vali Acc: 0.750 Test Loss: 1.905 Test Acc: 0.750
Validation loss decreased (-0.727757 --> -0.749981).  Saving model ...
Epoch: 24 cost time: 0.7936000823974609
Epoch: 24, Steps: 12 | Train Loss: 0.215 Vali Loss: 2.037 Vali Acc: 0.767 Test Loss: 2.037 Test Acc: 0.767
Validation loss decreased (-0.749981 --> -0.766646).  Saving model ...
Epoch: 25 cost time: 0.7399144172668457
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 2.042 Vali Acc: 0.756 Test Loss: 2.042 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9962260723114014
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 2.061 Vali Acc: 0.772 Test Loss: 2.061 Test Acc: 0.772
Validation loss decreased (-0.766646 --> -0.772202).  Saving model ...
Epoch: 27 cost time: 0.9003543853759766
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 2.369 Vali Acc: 0.750 Test Loss: 2.369 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8728237152099609
Epoch: 28, Steps: 12 | Train Loss: 0.064 Vali Loss: 2.404 Vali Acc: 0.733 Test Loss: 2.404 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8270385265350342
Epoch: 29, Steps: 12 | Train Loss: 0.053 Vali Loss: 2.250 Vali Acc: 0.783 Test Loss: 2.250 Test Acc: 0.783
Validation loss decreased (-0.772202 --> -0.783311).  Saving model ...
Epoch: 30 cost time: 0.8283913135528564
Epoch: 30, Steps: 12 | Train Loss: 0.171 Vali Loss: 2.287 Vali Acc: 0.761 Test Loss: 2.287 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7338569164276123
Epoch: 31, Steps: 12 | Train Loss: 0.045 Vali Loss: 2.453 Vali Acc: 0.750 Test Loss: 2.453 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8387155532836914
Epoch: 32, Steps: 12 | Train Loss: 0.062 Vali Loss: 2.356 Vali Acc: 0.761 Test Loss: 2.356 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6679136753082275
Epoch: 33, Steps: 12 | Train Loss: 0.082 Vali Loss: 2.323 Vali Acc: 0.806 Test Loss: 2.323 Test Acc: 0.806
Validation loss decreased (-0.783311 --> -0.805532).  Saving model ...
Epoch: 34 cost time: 0.6773860454559326
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 2.580 Vali Acc: 0.756 Test Loss: 2.580 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7139885425567627
Epoch: 35, Steps: 12 | Train Loss: 0.097 Vali Loss: 2.195 Vali Acc: 0.789 Test Loss: 2.195 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7084922790527344
Epoch: 36, Steps: 12 | Train Loss: 0.067 Vali Loss: 2.573 Vali Acc: 0.750 Test Loss: 2.573 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7880535125732422
Epoch: 37, Steps: 12 | Train Loss: 0.135 Vali Loss: 3.941 Vali Acc: 0.739 Test Loss: 3.941 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6651546955108643
Epoch: 38, Steps: 12 | Train Loss: 0.313 Vali Loss: 3.724 Vali Acc: 0.694 Test Loss: 3.724 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6227328777313232
Epoch: 39, Steps: 12 | Train Loss: 0.216 Vali Loss: 3.164 Vali Acc: 0.728 Test Loss: 3.164 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8630471229553223
Epoch: 40, Steps: 12 | Train Loss: 0.249 Vali Loss: 3.367 Vali Acc: 0.706 Test Loss: 3.367 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5541720390319824
Epoch: 41, Steps: 12 | Train Loss: 0.285 Vali Loss: 3.323 Vali Acc: 0.722 Test Loss: 3.323 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7654092311859131
Epoch: 42, Steps: 12 | Train Loss: 0.062 Vali Loss: 4.035 Vali Acc: 0.706 Test Loss: 4.035 Test Acc: 0.706
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.791520357131958
Epoch: 43, Steps: 12 | Train Loss: 0.251 Vali Loss: 2.771 Vali Acc: 0.750 Test Loss: 2.771 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8055555555555556
model parameter : 22698255
model size : 101.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.748267412185669
Epoch: 1, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.573 Vali Acc: 0.244 Test Loss: 2.573 Test Acc: 0.244
Validation loss decreased (inf --> -0.244419).  Saving model ...
Epoch: 2 cost time: 0.6024377346038818
Epoch: 2, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.266 Vali Acc: 0.483 Test Loss: 2.266 Test Acc: 0.483
Validation loss decreased (-0.244419 --> -0.483311).  Saving model ...
Epoch: 3 cost time: 0.7302842140197754
Epoch: 3, Steps: 12 | Train Loss: 2.047 Vali Loss: 1.937 Vali Acc: 0.478 Test Loss: 1.937 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6392195224761963
Epoch: 4, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.641 Vali Acc: 0.528 Test Loss: 1.641 Test Acc: 0.528
Validation loss decreased (-0.483311 --> -0.527761).  Saving model ...
Epoch: 5 cost time: 0.7717251777648926
Epoch: 5, Steps: 12 | Train Loss: 1.359 Vali Loss: 1.342 Vali Acc: 0.556 Test Loss: 1.342 Test Acc: 0.556
Validation loss decreased (-0.527761 --> -0.555542).  Saving model ...
Epoch: 6 cost time: 0.7210779190063477
Epoch: 6, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.086 Vali Acc: 0.639 Test Loss: 1.086 Test Acc: 0.639
Validation loss decreased (-0.555542 --> -0.638878).  Saving model ...
Epoch: 7 cost time: 0.5903677940368652
Epoch: 7, Steps: 12 | Train Loss: 0.986 Vali Loss: 1.032 Vali Acc: 0.656 Test Loss: 1.032 Test Acc: 0.656
Validation loss decreased (-0.638878 --> -0.655545).  Saving model ...
Epoch: 8 cost time: 0.6554813385009766
Epoch: 8, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.115 Vali Acc: 0.650 Test Loss: 1.115 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6606309413909912
Epoch: 9, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.996 Vali Acc: 0.678 Test Loss: 0.996 Test Acc: 0.678
Validation loss decreased (-0.655545 --> -0.677768).  Saving model ...
Epoch: 10 cost time: 0.6529097557067871
Epoch: 10, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.818 Vali Acc: 0.717 Test Loss: 0.818 Test Acc: 0.717
Validation loss decreased (-0.677768 --> -0.716658).  Saving model ...
Epoch: 11 cost time: 0.6876676082611084
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6889083385467529
Epoch: 12, Steps: 12 | Train Loss: 0.368 Vali Loss: 1.223 Vali Acc: 0.661 Test Loss: 1.223 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6843287944793701
Epoch: 13, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.972 Vali Acc: 0.728 Test Loss: 0.972 Test Acc: 0.728
Validation loss decreased (-0.716658 --> -0.727768).  Saving model ...
Epoch: 14 cost time: 0.9568309783935547
Epoch: 14, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.891 Vali Acc: 0.778 Test Loss: 0.891 Test Acc: 0.778
Validation loss decreased (-0.727768 --> -0.777769).  Saving model ...
Epoch: 15 cost time: 0.6317729949951172
Epoch: 15, Steps: 12 | Train Loss: 0.261 Vali Loss: 1.020 Vali Acc: 0.756 Test Loss: 1.020 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8781147003173828
Epoch: 16, Steps: 12 | Train Loss: 0.173 Vali Loss: 1.065 Vali Acc: 0.772 Test Loss: 1.065 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7414782047271729
Epoch: 17, Steps: 12 | Train Loss: 0.260 Vali Loss: 1.069 Vali Acc: 0.767 Test Loss: 1.069 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5840091705322266
Epoch: 18, Steps: 12 | Train Loss: 0.276 Vali Loss: 1.525 Vali Acc: 0.728 Test Loss: 1.525 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8848350048065186
Epoch: 19, Steps: 12 | Train Loss: 0.303 Vali Loss: 1.049 Vali Acc: 0.778 Test Loss: 1.049 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8536157608032227
Epoch: 20, Steps: 12 | Train Loss: 0.274 Vali Loss: 1.207 Vali Acc: 0.761 Test Loss: 1.207 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8927693367004395
Epoch: 21, Steps: 12 | Train Loss: 0.141 Vali Loss: 1.142 Vali Acc: 0.783 Test Loss: 1.142 Test Acc: 0.783
Validation loss decreased (-0.777769 --> -0.783322).  Saving model ...
Epoch: 22 cost time: 0.807725191116333
Epoch: 22, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.379 Vali Acc: 0.756 Test Loss: 1.379 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7140343189239502
Epoch: 23, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.130 Vali Acc: 0.767 Test Loss: 1.130 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7270832061767578
Epoch: 24, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.323 Vali Acc: 0.794 Test Loss: 1.323 Test Acc: 0.794
Validation loss decreased (-0.783322 --> -0.794431).  Saving model ...
Epoch: 25 cost time: 0.7738528251647949
Epoch: 25, Steps: 12 | Train Loss: 0.094 Vali Loss: 1.350 Vali Acc: 0.794 Test Loss: 1.350 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7174801826477051
Epoch: 26, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.478 Vali Acc: 0.750 Test Loss: 1.478 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8473875522613525
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.333 Vali Acc: 0.761 Test Loss: 1.333 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7566313743591309
Epoch: 28, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.287 Vali Acc: 0.794 Test Loss: 1.287 Test Acc: 0.794
Validation loss decreased (-0.794431 --> -0.794432).  Saving model ...
Epoch: 29 cost time: 0.8453891277313232
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.331 Vali Acc: 0.789 Test Loss: 1.331 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9142720699310303
Epoch: 30, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.788 Vali Acc: 0.744 Test Loss: 1.788 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.945181131362915
Epoch: 31, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.620 Vali Acc: 0.794 Test Loss: 1.620 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8592219352722168
Epoch: 32, Steps: 12 | Train Loss: 0.069 Vali Loss: 1.540 Vali Acc: 0.772 Test Loss: 1.540 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8527050018310547
Epoch: 33, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.533 Vali Acc: 0.772 Test Loss: 1.533 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8311059474945068
Epoch: 34, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.329 Vali Acc: 0.811 Test Loss: 1.329 Test Acc: 0.811
Validation loss decreased (-0.794432 --> -0.811098).  Saving model ...
Epoch: 35 cost time: 0.7153375148773193
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.353 Vali Acc: 0.806 Test Loss: 1.353 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8884103298187256
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.474 Vali Acc: 0.806 Test Loss: 1.474 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8664019107818604
Epoch: 37, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.429 Vali Acc: 0.811 Test Loss: 1.429 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6128647327423096
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.568 Vali Acc: 0.794 Test Loss: 1.568 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8596134185791016
Epoch: 39, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.635 Vali Acc: 0.767 Test Loss: 1.635 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9311449527740479
Epoch: 40, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.507 Vali Acc: 0.806 Test Loss: 1.507 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7496380805969238
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.695 Vali Acc: 0.817 Test Loss: 1.695 Test Acc: 0.817
Validation loss decreased (-0.811098 --> -0.816650).  Saving model ...
Epoch: 42 cost time: 0.6842238903045654
Epoch: 42, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.775 Vali Acc: 0.778 Test Loss: 1.775 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6416308879852295
Epoch: 43, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.995 Vali Acc: 0.778 Test Loss: 1.995 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6448416709899902
Epoch: 44, Steps: 12 | Train Loss: 0.047 Vali Loss: 1.708 Vali Acc: 0.794 Test Loss: 1.708 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6416416168212891
Epoch: 45, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.867 Vali Acc: 0.811 Test Loss: 1.867 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.674811601638794
Epoch: 46, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.677 Vali Acc: 0.811 Test Loss: 1.677 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7034022808074951
Epoch: 47, Steps: 12 | Train Loss: 0.203 Vali Loss: 1.803 Vali Acc: 0.817 Test Loss: 1.803 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6428391933441162
Epoch: 48, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.825 Vali Acc: 0.800 Test Loss: 1.825 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7496170997619629
Epoch: 49, Steps: 12 | Train Loss: 0.009 Vali Loss: 2.221 Vali Acc: 0.783 Test Loss: 2.221 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7045166492462158
Epoch: 50, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.693 Vali Acc: 0.817 Test Loss: 1.693 Test Acc: 0.817
Validation loss decreased (-0.816650 --> -0.816650).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 22424079
model size : 100.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.796485424041748
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.589 Vali Acc: 0.139 Test Loss: 2.589 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.7169489860534668
Epoch: 2, Steps: 12 | Train Loss: 2.565 Vali Loss: 2.373 Vali Acc: 0.417 Test Loss: 2.373 Test Acc: 0.417
Validation loss decreased (-0.138863 --> -0.416643).  Saving model ...
Epoch: 3 cost time: 0.5771069526672363
Epoch: 3, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.090 Vali Acc: 0.572 Test Loss: 2.090 Test Acc: 0.572
Validation loss decreased (-0.416643 --> -0.572201).  Saving model ...
Epoch: 4 cost time: 0.758575439453125
Epoch: 4, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.785 Vali Acc: 0.572 Test Loss: 1.785 Test Acc: 0.572
Validation loss decreased (-0.572201 --> -0.572204).  Saving model ...
Epoch: 5 cost time: 0.5708625316619873
Epoch: 5, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.488 Vali Acc: 0.589 Test Loss: 1.488 Test Acc: 0.589
Validation loss decreased (-0.572204 --> -0.588874).  Saving model ...
Epoch: 6 cost time: 0.5748424530029297
Epoch: 6, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.217 Vali Acc: 0.644 Test Loss: 1.217 Test Acc: 0.644
Validation loss decreased (-0.588874 --> -0.644432).  Saving model ...
Epoch: 7 cost time: 0.5346775054931641
Epoch: 7, Steps: 12 | Train Loss: 1.087 Vali Loss: 0.993 Vali Acc: 0.622 Test Loss: 0.993 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5484089851379395
Epoch: 8, Steps: 12 | Train Loss: 0.897 Vali Loss: 0.970 Vali Acc: 0.672 Test Loss: 0.970 Test Acc: 0.672
Validation loss decreased (-0.644432 --> -0.672213).  Saving model ...
Epoch: 9 cost time: 0.6182103157043457
Epoch: 9, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.880 Vali Acc: 0.661 Test Loss: 0.880 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.521068811416626
Epoch: 10, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.833 Vali Acc: 0.711 Test Loss: 0.833 Test Acc: 0.711
Validation loss decreased (-0.672213 --> -0.711103).  Saving model ...
Epoch: 11 cost time: 0.5509493350982666
Epoch: 11, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.932 Vali Acc: 0.733 Test Loss: 0.932 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733324).  Saving model ...
Epoch: 12 cost time: 0.5696580410003662
Epoch: 12, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.767 Vali Acc: 0.733 Test Loss: 0.767 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733326).  Saving model ...
Epoch: 13 cost time: 0.5928699970245361
Epoch: 13, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
Validation loss decreased (-0.733326 --> -0.788881).  Saving model ...
Epoch: 14 cost time: 0.6072447299957275
Epoch: 14, Steps: 12 | Train Loss: 0.305 Vali Loss: 1.028 Vali Acc: 0.728 Test Loss: 1.028 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5683112144470215
Epoch: 15, Steps: 12 | Train Loss: 0.220 Vali Loss: 1.055 Vali Acc: 0.744 Test Loss: 1.055 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5248813629150391
Epoch: 16, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.965 Vali Acc: 0.739 Test Loss: 0.965 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5222342014312744
Epoch: 17, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.865 Vali Acc: 0.806 Test Loss: 0.865 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805547).  Saving model ...
Epoch: 18 cost time: 0.4528203010559082
Epoch: 18, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.967 Vali Acc: 0.778 Test Loss: 0.967 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5600347518920898
Epoch: 19, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.971 Vali Acc: 0.817 Test Loss: 0.971 Test Acc: 0.817
Validation loss decreased (-0.805547 --> -0.816657).  Saving model ...
Epoch: 20 cost time: 0.5531303882598877
Epoch: 20, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.969 Vali Acc: 0.817 Test Loss: 0.969 Test Acc: 0.817
Validation loss decreased (-0.816657 --> -0.816657).  Saving model ...
Epoch: 21 cost time: 0.5193743705749512
Epoch: 21, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.084 Vali Acc: 0.778 Test Loss: 1.084 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4482393264770508
Epoch: 22, Steps: 12 | Train Loss: 0.103 Vali Loss: 1.063 Vali Acc: 0.783 Test Loss: 1.063 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.519092321395874
Epoch: 23, Steps: 12 | Train Loss: 0.113 Vali Loss: 1.140 Vali Acc: 0.806 Test Loss: 1.140 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.47390222549438477
Epoch: 24, Steps: 12 | Train Loss: 0.100 Vali Loss: 1.096 Vali Acc: 0.789 Test Loss: 1.096 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.49131059646606445
Epoch: 25, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.023 Vali Acc: 0.822 Test Loss: 1.023 Test Acc: 0.822
Validation loss decreased (-0.816657 --> -0.822212).  Saving model ...
Epoch: 26 cost time: 0.7493023872375488
Epoch: 26, Steps: 12 | Train Loss: 0.036 Vali Loss: 1.004 Vali Acc: 0.794 Test Loss: 1.004 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6840405464172363
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.040 Vali Acc: 0.800 Test Loss: 1.040 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7265503406524658
Epoch: 28, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.183 Vali Acc: 0.783 Test Loss: 1.183 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5661699771881104
Epoch: 29, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.278 Vali Acc: 0.806 Test Loss: 1.278 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6573319435119629
Epoch: 30, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.079 Vali Acc: 0.800 Test Loss: 1.079 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7478294372558594
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.182 Vali Acc: 0.817 Test Loss: 1.182 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6305408477783203
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.036 Vali Acc: 0.822 Test Loss: 1.036 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7608780860900879
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.169 Vali Acc: 0.822 Test Loss: 1.169 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.730018138885498
Epoch: 34, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.105 Vali Acc: 0.828 Test Loss: 1.105 Test Acc: 0.828
Validation loss decreased (-0.822212 --> -0.827767).  Saving model ...
Epoch: 35 cost time: 0.6509308815002441
Epoch: 35, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.209 Vali Acc: 0.839 Test Loss: 1.209 Test Acc: 0.839
Validation loss decreased (-0.827767 --> -0.838877).  Saving model ...
Epoch: 36 cost time: 0.5962085723876953
Epoch: 36, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.190 Vali Acc: 0.811 Test Loss: 1.190 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6810860633850098
Epoch: 37, Steps: 12 | Train Loss: 0.090 Vali Loss: 1.416 Vali Acc: 0.800 Test Loss: 1.416 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8540511131286621
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.223 Vali Acc: 0.822 Test Loss: 1.223 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7029547691345215
Epoch: 39, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.274 Vali Acc: 0.817 Test Loss: 1.274 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.677882194519043
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.207 Vali Acc: 0.822 Test Loss: 1.207 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5823848247528076
Epoch: 41, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.191 Vali Acc: 0.833 Test Loss: 1.191 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5047667026519775
Epoch: 42, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.175 Vali Acc: 0.856 Test Loss: 1.175 Test Acc: 0.856
Validation loss decreased (-0.838877 --> -0.855544).  Saving model ...
Epoch: 43 cost time: 0.775841236114502
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.149 Vali Acc: 0.844 Test Loss: 1.149 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7327926158905029
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.212 Vali Acc: 0.844 Test Loss: 1.212 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8094296455383301
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.186 Vali Acc: 0.850 Test Loss: 1.186 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6738681793212891
Epoch: 46, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.187 Vali Acc: 0.850 Test Loss: 1.187 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8563473224639893
Epoch: 47, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.290 Vali Acc: 0.833 Test Loss: 1.290 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7217974662780762
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.205 Vali Acc: 0.822 Test Loss: 1.205 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8046572208404541
Epoch: 49, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.196 Vali Acc: 0.850 Test Loss: 1.196 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8244237899780273
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.209 Vali Acc: 0.850 Test Loss: 1.209 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 22332687
model size : 99.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1573586463928223
Epoch: 1, Steps: 12 | Train Loss: 2.762 Vali Loss: 2.484 Vali Acc: 0.289 Test Loss: 2.484 Test Acc: 0.289
Validation loss decreased (inf --> -0.288864).  Saving model ...
Epoch: 2 cost time: 0.9471173286437988
Epoch: 2, Steps: 12 | Train Loss: 2.281 Vali Loss: 1.923 Vali Acc: 0.478 Test Loss: 1.923 Test Acc: 0.478
Validation loss decreased (-0.288864 --> -0.477759).  Saving model ...
Epoch: 3 cost time: 1.0407676696777344
Epoch: 3, Steps: 12 | Train Loss: 1.712 Vali Loss: 1.580 Vali Acc: 0.517 Test Loss: 1.580 Test Acc: 0.517
Validation loss decreased (-0.477759 --> -0.516651).  Saving model ...
Epoch: 4 cost time: 0.867121696472168
Epoch: 4, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.303 Vali Acc: 0.556 Test Loss: 1.303 Test Acc: 0.556
Validation loss decreased (-0.516651 --> -0.555543).  Saving model ...
Epoch: 5 cost time: 0.9427962303161621
Epoch: 5, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.262 Vali Acc: 0.561 Test Loss: 1.262 Test Acc: 0.561
Validation loss decreased (-0.555543 --> -0.561098).  Saving model ...
Epoch: 6 cost time: 0.856548547744751
Epoch: 6, Steps: 12 | Train Loss: 0.933 Vali Loss: 1.126 Vali Acc: 0.622 Test Loss: 1.126 Test Acc: 0.622
Validation loss decreased (-0.561098 --> -0.622211).  Saving model ...
Epoch: 7 cost time: 1.0284090042114258
Epoch: 7, Steps: 12 | Train Loss: 0.732 Vali Loss: 1.064 Vali Acc: 0.672 Test Loss: 1.064 Test Acc: 0.672
Validation loss decreased (-0.622211 --> -0.672212).  Saving model ...
Epoch: 8 cost time: 1.0592644214630127
Epoch: 8, Steps: 12 | Train Loss: 0.662 Vali Loss: 1.255 Vali Acc: 0.656 Test Loss: 1.255 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0171360969543457
Epoch: 9, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.497 Vali Acc: 0.683 Test Loss: 1.497 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683318).  Saving model ...
Epoch: 10 cost time: 0.8308994770050049
Epoch: 10, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.414 Vali Acc: 0.617 Test Loss: 1.414 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9145255088806152
Epoch: 11, Steps: 12 | Train Loss: 0.664 Vali Loss: 1.282 Vali Acc: 0.706 Test Loss: 1.282 Test Acc: 0.706
Validation loss decreased (-0.683318 --> -0.705543).  Saving model ...
Epoch: 12 cost time: 1.185579776763916
Epoch: 12, Steps: 12 | Train Loss: 0.624 Vali Loss: 1.771 Vali Acc: 0.650 Test Loss: 1.771 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0927345752716064
Epoch: 13, Steps: 12 | Train Loss: 0.513 Vali Loss: 1.694 Vali Acc: 0.650 Test Loss: 1.694 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0683834552764893
Epoch: 14, Steps: 12 | Train Loss: 0.563 Vali Loss: 1.577 Vali Acc: 0.650 Test Loss: 1.577 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9728717803955078
Epoch: 15, Steps: 12 | Train Loss: 0.388 Vali Loss: 1.514 Vali Acc: 0.722 Test Loss: 1.514 Test Acc: 0.722
Validation loss decreased (-0.705543 --> -0.722207).  Saving model ...
Epoch: 16 cost time: 1.0865933895111084
Epoch: 16, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.651 Vali Acc: 0.672 Test Loss: 1.651 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0737330913543701
Epoch: 17, Steps: 12 | Train Loss: 0.292 Vali Loss: 1.880 Vali Acc: 0.667 Test Loss: 1.880 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.051356554031372
Epoch: 18, Steps: 12 | Train Loss: 0.391 Vali Loss: 1.859 Vali Acc: 0.678 Test Loss: 1.859 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1499340534210205
Epoch: 19, Steps: 12 | Train Loss: 0.214 Vali Loss: 2.344 Vali Acc: 0.633 Test Loss: 2.344 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9751307964324951
Epoch: 20, Steps: 12 | Train Loss: 0.452 Vali Loss: 2.394 Vali Acc: 0.739 Test Loss: 2.394 Test Acc: 0.739
Validation loss decreased (-0.722207 --> -0.738865).  Saving model ...
Epoch: 21 cost time: 1.1550791263580322
Epoch: 21, Steps: 12 | Train Loss: 0.294 Vali Loss: 2.169 Vali Acc: 0.683 Test Loss: 2.169 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.137380838394165
Epoch: 22, Steps: 12 | Train Loss: 0.402 Vali Loss: 2.305 Vali Acc: 0.722 Test Loss: 2.305 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8763587474822998
Epoch: 23, Steps: 12 | Train Loss: 0.286 Vali Loss: 2.711 Vali Acc: 0.667 Test Loss: 2.711 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.96079421043396
Epoch: 24, Steps: 12 | Train Loss: 0.295 Vali Loss: 1.782 Vali Acc: 0.750 Test Loss: 1.782 Test Acc: 0.750
Validation loss decreased (-0.738865 --> -0.749982).  Saving model ...
Epoch: 25 cost time: 1.1401827335357666
Epoch: 25, Steps: 12 | Train Loss: 0.208 Vali Loss: 2.508 Vali Acc: 0.689 Test Loss: 2.508 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.017198085784912
Epoch: 26, Steps: 12 | Train Loss: 0.227 Vali Loss: 2.541 Vali Acc: 0.728 Test Loss: 2.541 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8698275089263916
Epoch: 27, Steps: 12 | Train Loss: 0.299 Vali Loss: 2.369 Vali Acc: 0.683 Test Loss: 2.369 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9627375602722168
Epoch: 28, Steps: 12 | Train Loss: 0.238 Vali Loss: 2.877 Vali Acc: 0.706 Test Loss: 2.877 Test Acc: 0.706
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8776021003723145
Epoch: 29, Steps: 12 | Train Loss: 0.226 Vali Loss: 2.549 Vali Acc: 0.733 Test Loss: 2.549 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9813566207885742
Epoch: 30, Steps: 12 | Train Loss: 0.154 Vali Loss: 3.204 Vali Acc: 0.667 Test Loss: 3.204 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.863112211227417
Epoch: 31, Steps: 12 | Train Loss: 0.232 Vali Loss: 2.481 Vali Acc: 0.739 Test Loss: 2.481 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9667940139770508
Epoch: 32, Steps: 12 | Train Loss: 0.066 Vali Loss: 3.291 Vali Acc: 0.739 Test Loss: 3.291 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0225887298583984
Epoch: 33, Steps: 12 | Train Loss: 0.200 Vali Loss: 2.402 Vali Acc: 0.750 Test Loss: 2.402 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8237149715423584
Epoch: 34, Steps: 12 | Train Loss: 0.017 Vali Loss: 2.635 Vali Acc: 0.733 Test Loss: 2.635 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 22689807
model size : 101.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.352041006088257
Epoch: 1, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.606 Vali Acc: 0.189 Test Loss: 2.606 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 0.892725944519043
Epoch: 2, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.258 Vali Acc: 0.411 Test Loss: 2.258 Test Acc: 0.411
Validation loss decreased (-0.188863 --> -0.411089).  Saving model ...
Epoch: 3 cost time: 0.867504358291626
Epoch: 3, Steps: 12 | Train Loss: 2.005 Vali Loss: 1.841 Vali Acc: 0.450 Test Loss: 1.841 Test Acc: 0.450
Validation loss decreased (-0.411089 --> -0.449982).  Saving model ...
Epoch: 4 cost time: 0.8856062889099121
Epoch: 4, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.511 Vali Acc: 0.544 Test Loss: 1.511 Test Acc: 0.544
Validation loss decreased (-0.449982 --> -0.544429).  Saving model ...
Epoch: 5 cost time: 0.8517475128173828
Epoch: 5, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.266 Vali Acc: 0.556 Test Loss: 1.266 Test Acc: 0.556
Validation loss decreased (-0.544429 --> -0.555543).  Saving model ...
Epoch: 6 cost time: 0.9013514518737793
Epoch: 6, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.113 Vali Acc: 0.611 Test Loss: 1.113 Test Acc: 0.611
Validation loss decreased (-0.555543 --> -0.611100).  Saving model ...
Epoch: 7 cost time: 0.8288013935089111
Epoch: 7, Steps: 12 | Train Loss: 0.872 Vali Loss: 0.948 Vali Acc: 0.656 Test Loss: 0.948 Test Acc: 0.656
Validation loss decreased (-0.611100 --> -0.655546).  Saving model ...
Epoch: 8 cost time: 0.8169982433319092
Epoch: 8, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.046 Vali Acc: 0.639 Test Loss: 1.046 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.820286750793457
Epoch: 9, Steps: 12 | Train Loss: 0.675 Vali Loss: 1.149 Vali Acc: 0.644 Test Loss: 1.149 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8307456970214844
Epoch: 10, Steps: 12 | Train Loss: 0.659 Vali Loss: 1.005 Vali Acc: 0.706 Test Loss: 1.005 Test Acc: 0.706
Validation loss decreased (-0.655546 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 0.7822630405426025
Epoch: 11, Steps: 12 | Train Loss: 0.499 Vali Loss: 1.121 Vali Acc: 0.667 Test Loss: 1.121 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7721152305603027
Epoch: 12, Steps: 12 | Train Loss: 0.493 Vali Loss: 1.071 Vali Acc: 0.717 Test Loss: 1.071 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716656).  Saving model ...
Epoch: 13 cost time: 0.7111721038818359
Epoch: 13, Steps: 12 | Train Loss: 0.376 Vali Loss: 1.226 Vali Acc: 0.706 Test Loss: 1.226 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.804455041885376
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 1.164 Vali Acc: 0.706 Test Loss: 1.164 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7601559162139893
Epoch: 15, Steps: 12 | Train Loss: 0.273 Vali Loss: 1.137 Vali Acc: 0.717 Test Loss: 1.137 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8444263935089111
Epoch: 16, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.036 Vali Acc: 0.750 Test Loss: 1.036 Test Acc: 0.750
Validation loss decreased (-0.716656 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.7009015083312988
Epoch: 17, Steps: 12 | Train Loss: 0.179 Vali Loss: 1.121 Vali Acc: 0.739 Test Loss: 1.121 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0534172058105469
Epoch: 18, Steps: 12 | Train Loss: 0.231 Vali Loss: 1.549 Vali Acc: 0.722 Test Loss: 1.549 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8140623569488525
Epoch: 19, Steps: 12 | Train Loss: 0.225 Vali Loss: 1.246 Vali Acc: 0.744 Test Loss: 1.246 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.783010721206665
Epoch: 20, Steps: 12 | Train Loss: 0.146 Vali Loss: 1.542 Vali Acc: 0.733 Test Loss: 1.542 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6235888004302979
Epoch: 21, Steps: 12 | Train Loss: 0.253 Vali Loss: 1.328 Vali Acc: 0.733 Test Loss: 1.328 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6361069679260254
Epoch: 22, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.473 Vali Acc: 0.733 Test Loss: 1.473 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5865578651428223
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.744 Vali Acc: 0.694 Test Loss: 1.744 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6279621124267578
Epoch: 24, Steps: 12 | Train Loss: 0.236 Vali Loss: 1.700 Vali Acc: 0.756 Test Loss: 1.700 Test Acc: 0.756
Validation loss decreased (-0.749990 --> -0.755539).  Saving model ...
Epoch: 25 cost time: 0.7076177597045898
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 1.643 Vali Acc: 0.744 Test Loss: 1.643 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9372062683105469
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.869 Vali Acc: 0.739 Test Loss: 1.869 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8839645385742188
Epoch: 27, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.627 Vali Acc: 0.761 Test Loss: 1.627 Test Acc: 0.761
Validation loss decreased (-0.755539 --> -0.761095).  Saving model ...
Epoch: 28 cost time: 0.854414701461792
Epoch: 28, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.700 Vali Acc: 0.761 Test Loss: 1.700 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.942279577255249
Epoch: 29, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.611 Vali Acc: 0.767 Test Loss: 1.611 Test Acc: 0.767
Validation loss decreased (-0.761095 --> -0.766651).  Saving model ...
Epoch: 30 cost time: 0.9378538131713867
Epoch: 30, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.602 Vali Acc: 0.789 Test Loss: 1.602 Test Acc: 0.789
Validation loss decreased (-0.766651 --> -0.788873).  Saving model ...
Epoch: 31 cost time: 1.0334177017211914
Epoch: 31, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.646 Vali Acc: 0.756 Test Loss: 1.646 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0030789375305176
Epoch: 32, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.846 Vali Acc: 0.767 Test Loss: 1.846 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8305497169494629
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.768 Vali Acc: 0.767 Test Loss: 1.768 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9679794311523438
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.505 Vali Acc: 0.761 Test Loss: 1.505 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0150253772735596
Epoch: 35, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.681 Vali Acc: 0.772 Test Loss: 1.681 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8903069496154785
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.695 Vali Acc: 0.772 Test Loss: 1.695 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0272352695465088
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.650 Vali Acc: 0.778 Test Loss: 1.650 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.935753583908081
Epoch: 38, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.816 Vali Acc: 0.744 Test Loss: 1.816 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7720992565155029
Epoch: 39, Steps: 12 | Train Loss: 0.039 Vali Loss: 2.099 Vali Acc: 0.767 Test Loss: 2.099 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8934497833251953
Epoch: 40, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.860 Vali Acc: 0.756 Test Loss: 1.860 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 22415631
model size : 100.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9937622547149658
Epoch: 1, Steps: 12 | Train Loss: 2.870 Vali Loss: 2.674 Vali Acc: 0.156 Test Loss: 2.674 Test Acc: 0.156
Validation loss decreased (inf --> -0.155529).  Saving model ...
Epoch: 2 cost time: 0.5377895832061768
Epoch: 2, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.400 Vali Acc: 0.394 Test Loss: 2.400 Test Acc: 0.394
Validation loss decreased (-0.155529 --> -0.394420).  Saving model ...
Epoch: 3 cost time: 0.6285922527313232
Epoch: 3, Steps: 12 | Train Loss: 2.251 Vali Loss: 2.135 Vali Acc: 0.500 Test Loss: 2.135 Test Acc: 0.500
Validation loss decreased (-0.394420 --> -0.499979).  Saving model ...
Epoch: 4 cost time: 0.606961727142334
Epoch: 4, Steps: 12 | Train Loss: 1.966 Vali Loss: 1.849 Vali Acc: 0.550 Test Loss: 1.849 Test Acc: 0.550
Validation loss decreased (-0.499979 --> -0.549982).  Saving model ...
Epoch: 5 cost time: 0.6025311946868896
Epoch: 5, Steps: 12 | Train Loss: 1.649 Vali Loss: 1.480 Vali Acc: 0.578 Test Loss: 1.480 Test Acc: 0.578
Validation loss decreased (-0.549982 --> -0.577763).  Saving model ...
Epoch: 6 cost time: 0.6664817333221436
Epoch: 6, Steps: 12 | Train Loss: 1.410 Vali Loss: 1.242 Vali Acc: 0.622 Test Loss: 1.242 Test Acc: 0.622
Validation loss decreased (-0.577763 --> -0.622210).  Saving model ...
Epoch: 7 cost time: 0.6717572212219238
Epoch: 7, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.046 Vali Acc: 0.639 Test Loss: 1.046 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638878).  Saving model ...
Epoch: 8 cost time: 0.6858513355255127
Epoch: 8, Steps: 12 | Train Loss: 0.916 Vali Loss: 0.931 Vali Acc: 0.639 Test Loss: 0.931 Test Acc: 0.639
Validation loss decreased (-0.638878 --> -0.638880).  Saving model ...
Epoch: 9 cost time: 0.7136852741241455
Epoch: 9, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.867 Vali Acc: 0.700 Test Loss: 0.867 Test Acc: 0.700
Validation loss decreased (-0.638880 --> -0.699991).  Saving model ...
Epoch: 10 cost time: 0.7872662544250488
Epoch: 10, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.784 Vali Acc: 0.706 Test Loss: 0.784 Test Acc: 0.706
Validation loss decreased (-0.699991 --> -0.705548).  Saving model ...
Epoch: 11 cost time: 0.7337310314178467
Epoch: 11, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.814 Vali Acc: 0.711 Test Loss: 0.814 Test Acc: 0.711
Validation loss decreased (-0.705548 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.7535042762756348
Epoch: 12, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.767 Vali Acc: 0.761 Test Loss: 0.767 Test Acc: 0.761
Validation loss decreased (-0.711103 --> -0.761103).  Saving model ...
Epoch: 13 cost time: 0.6621770858764648
Epoch: 13, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.975 Vali Acc: 0.711 Test Loss: 0.975 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5877320766448975
Epoch: 14, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.823 Vali Acc: 0.756 Test Loss: 0.823 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6987061500549316
Epoch: 15, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.886 Vali Acc: 0.722 Test Loss: 0.886 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6409173011779785
Epoch: 16, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.775 Vali Acc: 0.778 Test Loss: 0.775 Test Acc: 0.778
Validation loss decreased (-0.761103 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 0.6881828308105469
Epoch: 17, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.818 Vali Acc: 0.767 Test Loss: 0.818 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7183666229248047
Epoch: 18, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.831 Vali Acc: 0.789 Test Loss: 0.831 Test Acc: 0.789
Validation loss decreased (-0.777770 --> -0.788881).  Saving model ...
Epoch: 19 cost time: 0.7904155254364014
Epoch: 19, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.817 Vali Acc: 0.767 Test Loss: 0.817 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7108497619628906
Epoch: 20, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.971 Vali Acc: 0.794 Test Loss: 0.971 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794435).  Saving model ...
Epoch: 21 cost time: 0.7430956363677979
Epoch: 21, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
Validation loss decreased (-0.794435 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.7091889381408691
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.863 Vali Acc: 0.800 Test Loss: 0.863 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6399083137512207
Epoch: 23, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.859 Vali Acc: 0.806 Test Loss: 0.859 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805547).  Saving model ...
Epoch: 24 cost time: 0.6614599227905273
Epoch: 24, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.897 Vali Acc: 0.822 Test Loss: 0.897 Test Acc: 0.822
Validation loss decreased (-0.805547 --> -0.822213).  Saving model ...
Epoch: 25 cost time: 0.7012662887573242
Epoch: 25, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.984 Vali Acc: 0.822 Test Loss: 0.984 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7455532550811768
Epoch: 26, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.924 Vali Acc: 0.817 Test Loss: 0.924 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6962800025939941
Epoch: 27, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.935 Vali Acc: 0.811 Test Loss: 0.935 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6952612400054932
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.924 Vali Acc: 0.828 Test Loss: 0.924 Test Acc: 0.828
Validation loss decreased (-0.822213 --> -0.827769).  Saving model ...
Epoch: 29 cost time: 0.6971092224121094
Epoch: 29, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.970 Vali Acc: 0.817 Test Loss: 0.970 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6867799758911133
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.953 Vali Acc: 0.822 Test Loss: 0.953 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6090977191925049
Epoch: 31, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.151 Vali Acc: 0.783 Test Loss: 1.151 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6151461601257324
Epoch: 32, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.038 Vali Acc: 0.772 Test Loss: 1.038 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6502156257629395
Epoch: 33, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.264 Vali Acc: 0.761 Test Loss: 1.264 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5978024005889893
Epoch: 34, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.056 Vali Acc: 0.772 Test Loss: 1.056 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.565687894821167
Epoch: 35, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.084 Vali Acc: 0.811 Test Loss: 1.084 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5926988124847412
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 1.029 Vali Acc: 0.800 Test Loss: 1.029 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6484115123748779
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.122 Vali Acc: 0.833 Test Loss: 1.122 Test Acc: 0.833
Validation loss decreased (-0.827769 --> -0.833322).  Saving model ...
Epoch: 38 cost time: 0.613318920135498
Epoch: 38, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.153 Vali Acc: 0.822 Test Loss: 1.153 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.612140417098999
Epoch: 39, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.151 Vali Acc: 0.828 Test Loss: 1.151 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6607120037078857
Epoch: 40, Steps: 12 | Train Loss: 0.025 Vali Loss: 1.165 Vali Acc: 0.822 Test Loss: 1.165 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7173972129821777
Epoch: 41, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.127 Vali Acc: 0.794 Test Loss: 1.127 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6780195236206055
Epoch: 42, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.320 Vali Acc: 0.817 Test Loss: 1.320 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6808571815490723
Epoch: 43, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.147 Vali Acc: 0.833 Test Loss: 1.147 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5711514949798584
Epoch: 44, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.292 Vali Acc: 0.839 Test Loss: 1.292 Test Acc: 0.839
Validation loss decreased (-0.833322 --> -0.838876).  Saving model ...
Epoch: 45 cost time: 0.7948455810546875
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.264 Vali Acc: 0.839 Test Loss: 1.264 Test Acc: 0.839
Validation loss decreased (-0.838876 --> -0.838876).  Saving model ...
Epoch: 46 cost time: 0.630126953125
Epoch: 46, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.202 Vali Acc: 0.828 Test Loss: 1.202 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7078752517700195
Epoch: 47, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.218 Vali Acc: 0.844 Test Loss: 1.218 Test Acc: 0.844
Validation loss decreased (-0.838876 --> -0.844432).  Saving model ...
Epoch: 48 cost time: 0.685328483581543
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.258 Vali Acc: 0.817 Test Loss: 1.258 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7256691455841064
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.210 Vali Acc: 0.833 Test Loss: 1.210 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6575312614440918
Epoch: 50, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.322 Vali Acc: 0.833 Test Loss: 1.322 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 22285071
model size : 99.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4021904468536377
Epoch: 1, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.617 Vali Acc: 0.150 Test Loss: 2.617 Test Acc: 0.150
Validation loss decreased (inf --> -0.149974).  Saving model ...
Epoch: 2 cost time: 0.6795217990875244
Epoch: 2, Steps: 12 | Train Loss: 2.501 Vali Loss: 2.293 Vali Acc: 0.489 Test Loss: 2.293 Test Acc: 0.489
Validation loss decreased (-0.149974 --> -0.488866).  Saving model ...
Epoch: 3 cost time: 0.8758552074432373
Epoch: 3, Steps: 12 | Train Loss: 2.107 Vali Loss: 1.964 Vali Acc: 0.489 Test Loss: 1.964 Test Acc: 0.489
Validation loss decreased (-0.488866 --> -0.488869).  Saving model ...
Epoch: 4 cost time: 0.8272402286529541
Epoch: 4, Steps: 12 | Train Loss: 1.679 Vali Loss: 1.652 Vali Acc: 0.544 Test Loss: 1.652 Test Acc: 0.544
Validation loss decreased (-0.488869 --> -0.544428).  Saving model ...
Epoch: 5 cost time: 1.0489842891693115
Epoch: 5, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.385 Vali Acc: 0.533 Test Loss: 1.385 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8064389228820801
Epoch: 6, Steps: 12 | Train Loss: 1.128 Vali Loss: 1.266 Vali Acc: 0.600 Test Loss: 1.266 Test Acc: 0.600
Validation loss decreased (-0.544428 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.8727858066558838
Epoch: 7, Steps: 12 | Train Loss: 0.834 Vali Loss: 1.180 Vali Acc: 0.606 Test Loss: 1.180 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605544).  Saving model ...
Epoch: 8 cost time: 0.6007871627807617
Epoch: 8, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.228 Vali Acc: 0.628 Test Loss: 1.228 Test Acc: 0.628
Validation loss decreased (-0.605544 --> -0.627765).  Saving model ...
Epoch: 9 cost time: 0.9045658111572266
Epoch: 9, Steps: 12 | Train Loss: 0.646 Vali Loss: 1.144 Vali Acc: 0.667 Test Loss: 1.144 Test Acc: 0.667
Validation loss decreased (-0.627765 --> -0.666655).  Saving model ...
Epoch: 10 cost time: 0.7656357288360596
Epoch: 10, Steps: 12 | Train Loss: 0.629 Vali Loss: 1.130 Vali Acc: 0.667 Test Loss: 1.130 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 11 cost time: 0.6616692543029785
Epoch: 11, Steps: 12 | Train Loss: 0.462 Vali Loss: 1.092 Vali Acc: 0.706 Test Loss: 1.092 Test Acc: 0.706
Validation loss decreased (-0.666655 --> -0.705545).  Saving model ...
Epoch: 12 cost time: 0.7551610469818115
Epoch: 12, Steps: 12 | Train Loss: 0.458 Vali Loss: 1.087 Vali Acc: 0.661 Test Loss: 1.087 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7881011962890625
Epoch: 13, Steps: 12 | Train Loss: 0.487 Vali Loss: 1.097 Vali Acc: 0.744 Test Loss: 1.097 Test Acc: 0.744
Validation loss decreased (-0.705545 --> -0.744433).  Saving model ...
Epoch: 14 cost time: 0.7120559215545654
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 1.000 Vali Acc: 0.711 Test Loss: 1.000 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7833151817321777
Epoch: 15, Steps: 12 | Train Loss: 0.310 Vali Loss: 1.294 Vali Acc: 0.739 Test Loss: 1.294 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7360186576843262
Epoch: 16, Steps: 12 | Train Loss: 0.268 Vali Loss: 1.296 Vali Acc: 0.700 Test Loss: 1.296 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.695875883102417
Epoch: 17, Steps: 12 | Train Loss: 0.410 Vali Loss: 1.190 Vali Acc: 0.778 Test Loss: 1.190 Test Acc: 0.778
Validation loss decreased (-0.744433 --> -0.777766).  Saving model ...
Epoch: 18 cost time: 0.7334496974945068
Epoch: 18, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.258 Vali Acc: 0.722 Test Loss: 1.258 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6985800266265869
Epoch: 19, Steps: 12 | Train Loss: 0.196 Vali Loss: 1.459 Vali Acc: 0.711 Test Loss: 1.459 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7062520980834961
Epoch: 20, Steps: 12 | Train Loss: 0.235 Vali Loss: 1.179 Vali Acc: 0.767 Test Loss: 1.179 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.709284782409668
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 1.689 Vali Acc: 0.744 Test Loss: 1.689 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9083950519561768
Epoch: 22, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.525 Vali Acc: 0.744 Test Loss: 1.525 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6814751625061035
Epoch: 23, Steps: 12 | Train Loss: 0.177 Vali Loss: 1.616 Vali Acc: 0.728 Test Loss: 1.616 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8635170459747314
Epoch: 24, Steps: 12 | Train Loss: 0.225 Vali Loss: 1.685 Vali Acc: 0.728 Test Loss: 1.685 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8185415267944336
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.561 Vali Acc: 0.767 Test Loss: 1.561 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7507450580596924
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.623 Vali Acc: 0.767 Test Loss: 1.623 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.025010347366333
Epoch: 27, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.311 Vali Acc: 0.772 Test Loss: 1.311 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 22420239
model size : 100.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2596352100372314
Epoch: 1, Steps: 12 | Train Loss: 2.815 Vali Loss: 2.612 Vali Acc: 0.089 Test Loss: 2.612 Test Acc: 0.089
Validation loss decreased (inf --> -0.088863).  Saving model ...
Epoch: 2 cost time: 0.7011890411376953
Epoch: 2, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.387 Vali Acc: 0.372 Test Loss: 2.387 Test Acc: 0.372
Validation loss decreased (-0.088863 --> -0.372198).  Saving model ...
Epoch: 3 cost time: 0.705554723739624
Epoch: 3, Steps: 12 | Train Loss: 2.278 Vali Loss: 2.102 Vali Acc: 0.528 Test Loss: 2.102 Test Acc: 0.528
Validation loss decreased (-0.372198 --> -0.527757).  Saving model ...
Epoch: 4 cost time: 0.7204980850219727
Epoch: 4, Steps: 12 | Train Loss: 1.947 Vali Loss: 1.824 Vali Acc: 0.528 Test Loss: 1.824 Test Acc: 0.528
Validation loss decreased (-0.527757 --> -0.527760).  Saving model ...
Epoch: 5 cost time: 0.7385463714599609
Epoch: 5, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.564 Vali Acc: 0.578 Test Loss: 1.564 Test Acc: 0.578
Validation loss decreased (-0.527760 --> -0.577762).  Saving model ...
Epoch: 6 cost time: 0.7596545219421387
Epoch: 6, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.345 Vali Acc: 0.583 Test Loss: 1.345 Test Acc: 0.583
Validation loss decreased (-0.577762 --> -0.583320).  Saving model ...
Epoch: 7 cost time: 0.7181799411773682
Epoch: 7, Steps: 12 | Train Loss: 1.144 Vali Loss: 1.226 Vali Acc: 0.594 Test Loss: 1.226 Test Acc: 0.594
Validation loss decreased (-0.583320 --> -0.594432).  Saving model ...
Epoch: 8 cost time: 0.7097430229187012
Epoch: 8, Steps: 12 | Train Loss: 0.836 Vali Loss: 1.145 Vali Acc: 0.594 Test Loss: 1.145 Test Acc: 0.594
Validation loss decreased (-0.594432 --> -0.594433).  Saving model ...
Epoch: 9 cost time: 0.5862717628479004
Epoch: 9, Steps: 12 | Train Loss: 0.746 Vali Loss: 1.075 Vali Acc: 0.633 Test Loss: 1.075 Test Acc: 0.633
Validation loss decreased (-0.594433 --> -0.633323).  Saving model ...
Epoch: 10 cost time: 0.6167585849761963
Epoch: 10, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.106 Vali Acc: 0.628 Test Loss: 1.106 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6240706443786621
Epoch: 11, Steps: 12 | Train Loss: 0.524 Vali Loss: 1.057 Vali Acc: 0.667 Test Loss: 1.057 Test Acc: 0.667
Validation loss decreased (-0.633323 --> -0.666656).  Saving model ...
Epoch: 12 cost time: 0.6254768371582031
Epoch: 12, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.928 Vali Acc: 0.689 Test Loss: 0.928 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688880).  Saving model ...
Epoch: 13 cost time: 0.6301248073577881
Epoch: 13, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
Validation loss decreased (-0.688880 --> -0.722213).  Saving model ...
Epoch: 14 cost time: 0.566063642501831
Epoch: 14, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.987 Vali Acc: 0.706 Test Loss: 0.987 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5339629650115967
Epoch: 15, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.829 Vali Acc: 0.778 Test Loss: 0.829 Test Acc: 0.778
Validation loss decreased (-0.722213 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 0.5750751495361328
Epoch: 16, Steps: 12 | Train Loss: 0.200 Vali Loss: 1.006 Vali Acc: 0.733 Test Loss: 1.006 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.48613405227661133
Epoch: 17, Steps: 12 | Train Loss: 0.185 Vali Loss: 1.083 Vali Acc: 0.700 Test Loss: 1.083 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5959579944610596
Epoch: 18, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.092 Vali Acc: 0.728 Test Loss: 1.092 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4773225784301758
Epoch: 19, Steps: 12 | Train Loss: 0.156 Vali Loss: 1.103 Vali Acc: 0.794 Test Loss: 1.103 Test Acc: 0.794
Validation loss decreased (-0.777769 --> -0.794433).  Saving model ...
Epoch: 20 cost time: 0.5765571594238281
Epoch: 20, Steps: 12 | Train Loss: 0.192 Vali Loss: 1.315 Vali Acc: 0.700 Test Loss: 1.315 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5365440845489502
Epoch: 21, Steps: 12 | Train Loss: 0.182 Vali Loss: 1.220 Vali Acc: 0.739 Test Loss: 1.220 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5375053882598877
Epoch: 22, Steps: 12 | Train Loss: 0.144 Vali Loss: 1.156 Vali Acc: 0.744 Test Loss: 1.156 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5061218738555908
Epoch: 23, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.169 Vali Acc: 0.750 Test Loss: 1.169 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.487870454788208
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.012 Vali Acc: 0.828 Test Loss: 1.012 Test Acc: 0.828
Validation loss decreased (-0.794433 --> -0.827768).  Saving model ...
Epoch: 25 cost time: 0.5283923149108887
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.217 Vali Acc: 0.789 Test Loss: 1.217 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5284416675567627
Epoch: 26, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.136 Vali Acc: 0.778 Test Loss: 1.136 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5985815525054932
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.162 Vali Acc: 0.783 Test Loss: 1.162 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6498403549194336
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.317 Vali Acc: 0.794 Test Loss: 1.317 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6858851909637451
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.236 Vali Acc: 0.783 Test Loss: 1.236 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6123056411743164
Epoch: 30, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.176 Vali Acc: 0.828 Test Loss: 1.176 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.637026309967041
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.214 Vali Acc: 0.839 Test Loss: 1.214 Test Acc: 0.839
Validation loss decreased (-0.827768 --> -0.838877).  Saving model ...
Epoch: 32 cost time: 0.6563394069671631
Epoch: 32, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.238 Vali Acc: 0.783 Test Loss: 1.238 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6476285457611084
Epoch: 33, Steps: 12 | Train Loss: 0.019 Vali Loss: 1.180 Vali Acc: 0.828 Test Loss: 1.180 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6000726222991943
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.214 Vali Acc: 0.817 Test Loss: 1.214 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6321215629577637
Epoch: 35, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.231 Vali Acc: 0.811 Test Loss: 1.231 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6670291423797607
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.309 Vali Acc: 0.806 Test Loss: 1.309 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.47029852867126465
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.269 Vali Acc: 0.828 Test Loss: 1.269 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.49463987350463867
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.138 Vali Acc: 0.800 Test Loss: 1.138 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5433356761932373
Epoch: 39, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.581 Vali Acc: 0.794 Test Loss: 1.581 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6486759185791016
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.300 Vali Acc: 0.800 Test Loss: 1.300 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6404874324798584
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.385 Vali Acc: 0.806 Test Loss: 1.385 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 22328847
model size : 99.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0786798000335693
Epoch: 1, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.620 Vali Acc: 0.139 Test Loss: 2.620 Test Acc: 0.139
Validation loss decreased (inf --> -0.138863).  Saving model ...
Epoch: 2 cost time: 0.6031177043914795
Epoch: 2, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.437 Vali Acc: 0.289 Test Loss: 2.437 Test Acc: 0.289
Validation loss decreased (-0.138863 --> -0.288865).  Saving model ...
Epoch: 3 cost time: 0.8094513416290283
Epoch: 3, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.235 Vali Acc: 0.456 Test Loss: 2.235 Test Acc: 0.456
Validation loss decreased (-0.288865 --> -0.455533).  Saving model ...
Epoch: 4 cost time: 0.6426775455474854
Epoch: 4, Steps: 12 | Train Loss: 2.044 Vali Loss: 2.014 Vali Acc: 0.483 Test Loss: 2.014 Test Acc: 0.483
Validation loss decreased (-0.455533 --> -0.483313).  Saving model ...
Epoch: 5 cost time: 0.8218834400177002
Epoch: 5, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.741 Vali Acc: 0.522 Test Loss: 1.741 Test Acc: 0.522
Validation loss decreased (-0.483313 --> -0.522205).  Saving model ...
Epoch: 6 cost time: 0.8030974864959717
Epoch: 6, Steps: 12 | Train Loss: 1.525 Vali Loss: 1.488 Vali Acc: 0.528 Test Loss: 1.488 Test Acc: 0.528
Validation loss decreased (-0.522205 --> -0.527763).  Saving model ...
Epoch: 7 cost time: 0.7813310623168945
Epoch: 7, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
Validation loss decreased (-0.527763 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.8610024452209473
Epoch: 8, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.141 Vali Acc: 0.606 Test Loss: 1.141 Test Acc: 0.606
Validation loss decreased (-0.549987 --> -0.605544).  Saving model ...
Epoch: 9 cost time: 0.7780890464782715
Epoch: 9, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.992 Vali Acc: 0.644 Test Loss: 0.992 Test Acc: 0.644
Validation loss decreased (-0.605544 --> -0.644435).  Saving model ...
Epoch: 10 cost time: 0.7948360443115234
Epoch: 10, Steps: 12 | Train Loss: 0.727 Vali Loss: 0.921 Vali Acc: 0.694 Test Loss: 0.921 Test Acc: 0.694
Validation loss decreased (-0.644435 --> -0.694435).  Saving model ...
Epoch: 11 cost time: 0.5670113563537598
Epoch: 11, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.847 Vali Acc: 0.722 Test Loss: 0.847 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722214).  Saving model ...
Epoch: 12 cost time: 0.6815719604492188
Epoch: 12, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.822 Vali Acc: 0.744 Test Loss: 0.822 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744436).  Saving model ...
Epoch: 13 cost time: 0.72403883934021
Epoch: 13, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.806 Vali Acc: 0.739 Test Loss: 0.806 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5374598503112793
Epoch: 14, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.801 Vali Acc: 0.767 Test Loss: 0.801 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 15 cost time: 0.73818039894104
Epoch: 15, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.798 Vali Acc: 0.794 Test Loss: 0.798 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794436).  Saving model ...
Epoch: 16 cost time: 0.6659805774688721
Epoch: 16, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.739 Vali Acc: 0.772 Test Loss: 0.739 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5433616638183594
Epoch: 17, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.872 Vali Acc: 0.789 Test Loss: 0.872 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.49235081672668457
Epoch: 18, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.787 Vali Acc: 0.811 Test Loss: 0.787 Test Acc: 0.811
Validation loss decreased (-0.794436 --> -0.811103).  Saving model ...
Epoch: 19 cost time: 0.722536563873291
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.946 Vali Acc: 0.767 Test Loss: 0.946 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5823428630828857
Epoch: 20, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.853 Vali Acc: 0.789 Test Loss: 0.853 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.49415135383605957
Epoch: 21, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5093142986297607
Epoch: 22, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.816 Vali Acc: 0.833 Test Loss: 0.816 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833325).  Saving model ...
Epoch: 23 cost time: 0.6955657005310059
Epoch: 23, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.945 Vali Acc: 0.789 Test Loss: 0.945 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7618751525878906
Epoch: 24, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.846 Vali Acc: 0.844 Test Loss: 0.846 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844436).  Saving model ...
Epoch: 25 cost time: 0.7402935028076172
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.941 Vali Acc: 0.817 Test Loss: 0.941 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7694342136383057
Epoch: 26, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.855 Vali Acc: 0.839 Test Loss: 0.855 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7123866081237793
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.905 Vali Acc: 0.822 Test Loss: 0.905 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7040219306945801
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.933 Vali Acc: 0.844 Test Loss: 0.933 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.805727481842041
Epoch: 29, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.958 Vali Acc: 0.800 Test Loss: 0.958 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6296505928039551
Epoch: 30, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.918 Vali Acc: 0.839 Test Loss: 0.918 Test Acc: 0.839
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6121246814727783
Epoch: 31, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.942 Vali Acc: 0.856 Test Loss: 0.942 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855546).  Saving model ...
Epoch: 32 cost time: 0.750206470489502
Epoch: 32, Steps: 12 | Train Loss: 0.052 Vali Loss: 1.028 Vali Acc: 0.806 Test Loss: 1.028 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7532336711883545
Epoch: 33, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.962 Vali Acc: 0.828 Test Loss: 0.962 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7928671836853027
Epoch: 34, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.993 Vali Acc: 0.833 Test Loss: 0.993 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6943585872650146
Epoch: 35, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.015 Vali Acc: 0.850 Test Loss: 1.015 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7583014965057373
Epoch: 36, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.067 Vali Acc: 0.817 Test Loss: 1.067 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5922315120697021
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.096 Vali Acc: 0.844 Test Loss: 1.096 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.49707818031311035
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.053 Vali Acc: 0.828 Test Loss: 1.053 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5386919975280762
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.088 Vali Acc: 0.828 Test Loss: 1.088 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5370297431945801
Epoch: 40, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.012 Vali Acc: 0.833 Test Loss: 1.012 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6973397731781006
Epoch: 41, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.956 Vali Acc: 0.850 Test Loss: 0.956 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8555555555555555
model parameter : 22263567
model size : 99.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.438965082168579
Epoch: 1, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.584 Vali Acc: 0.217 Test Loss: 2.584 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 1.121084451675415
Epoch: 2, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.273 Vali Acc: 0.411 Test Loss: 2.273 Test Acc: 0.411
Validation loss decreased (-0.216641 --> -0.411088).  Saving model ...
Epoch: 3 cost time: 0.650343656539917
Epoch: 3, Steps: 12 | Train Loss: 2.055 Vali Loss: 1.904 Vali Acc: 0.472 Test Loss: 1.904 Test Acc: 0.472
Validation loss decreased (-0.411088 --> -0.472203).  Saving model ...
Epoch: 4 cost time: 0.8826406002044678
Epoch: 4, Steps: 12 | Train Loss: 1.683 Vali Loss: 1.610 Vali Acc: 0.561 Test Loss: 1.610 Test Acc: 0.561
Validation loss decreased (-0.472203 --> -0.561095).  Saving model ...
Epoch: 5 cost time: 0.7444262504577637
Epoch: 5, Steps: 12 | Train Loss: 1.316 Vali Loss: 1.278 Vali Acc: 0.617 Test Loss: 1.278 Test Acc: 0.617
Validation loss decreased (-0.561095 --> -0.616654).  Saving model ...
Epoch: 6 cost time: 0.9957022666931152
Epoch: 6, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.176 Vali Acc: 0.628 Test Loss: 1.176 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627766).  Saving model ...
Epoch: 7 cost time: 1.0126919746398926
Epoch: 7, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.013 Vali Acc: 0.678 Test Loss: 1.013 Test Acc: 0.678
Validation loss decreased (-0.627766 --> -0.677768).  Saving model ...
Epoch: 8 cost time: 1.0400686264038086
Epoch: 8, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.889 Vali Acc: 0.667 Test Loss: 0.889 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9898889064788818
Epoch: 9, Steps: 12 | Train Loss: 0.642 Vali Loss: 1.011 Vali Acc: 0.722 Test Loss: 1.011 Test Acc: 0.722
Validation loss decreased (-0.677768 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 0.9325840473175049
Epoch: 10, Steps: 12 | Train Loss: 0.459 Vali Loss: 1.058 Vali Acc: 0.733 Test Loss: 1.058 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 11 cost time: 0.912562370300293
Epoch: 11, Steps: 12 | Train Loss: 0.573 Vali Loss: 1.057 Vali Acc: 0.678 Test Loss: 1.057 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8454110622406006
Epoch: 12, Steps: 12 | Train Loss: 0.416 Vali Loss: 1.165 Vali Acc: 0.694 Test Loss: 1.165 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8494548797607422
Epoch: 13, Steps: 12 | Train Loss: 0.395 Vali Loss: 1.314 Vali Acc: 0.700 Test Loss: 1.314 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8903932571411133
Epoch: 14, Steps: 12 | Train Loss: 0.369 Vali Loss: 1.069 Vali Acc: 0.717 Test Loss: 1.069 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.778728723526001
Epoch: 15, Steps: 12 | Train Loss: 0.362 Vali Loss: 1.047 Vali Acc: 0.728 Test Loss: 1.047 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.758474588394165
Epoch: 16, Steps: 12 | Train Loss: 0.307 Vali Loss: 1.375 Vali Acc: 0.722 Test Loss: 1.375 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.169400930404663
Epoch: 17, Steps: 12 | Train Loss: 0.180 Vali Loss: 1.206 Vali Acc: 0.706 Test Loss: 1.206 Test Acc: 0.706
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9929032325744629
Epoch: 18, Steps: 12 | Train Loss: 0.263 Vali Loss: 1.421 Vali Acc: 0.739 Test Loss: 1.421 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738875).  Saving model ...
Epoch: 19 cost time: 1.1971993446350098
Epoch: 19, Steps: 12 | Train Loss: 0.154 Vali Loss: 1.088 Vali Acc: 0.772 Test Loss: 1.088 Test Acc: 0.772
Validation loss decreased (-0.738875 --> -0.772211).  Saving model ...
Epoch: 20 cost time: 0.7560830116271973
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 1.268 Vali Acc: 0.739 Test Loss: 1.268 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8308565616607666
Epoch: 21, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.163 Vali Acc: 0.794 Test Loss: 1.163 Test Acc: 0.794
Validation loss decreased (-0.772211 --> -0.794433).  Saving model ...
Epoch: 22 cost time: 0.6460034847259521
Epoch: 22, Steps: 12 | Train Loss: 0.122 Vali Loss: 1.372 Vali Acc: 0.744 Test Loss: 1.372 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.894662618637085
Epoch: 23, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.468 Vali Acc: 0.761 Test Loss: 1.468 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7281603813171387
Epoch: 24, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.211 Vali Acc: 0.772 Test Loss: 1.211 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9225361347198486
Epoch: 25, Steps: 12 | Train Loss: 0.106 Vali Loss: 1.536 Vali Acc: 0.756 Test Loss: 1.536 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9357647895812988
Epoch: 26, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.319 Vali Acc: 0.789 Test Loss: 1.319 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7855467796325684
Epoch: 27, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.543 Vali Acc: 0.744 Test Loss: 1.543 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8920114040374756
Epoch: 28, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.727 Vali Acc: 0.728 Test Loss: 1.727 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9274716377258301
Epoch: 29, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.626 Vali Acc: 0.750 Test Loss: 1.626 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.889190673828125
Epoch: 30, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.717 Vali Acc: 0.761 Test Loss: 1.717 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9205315113067627
Epoch: 31, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.500 Vali Acc: 0.789 Test Loss: 1.500 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 22411791
model size : 100.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2138023376464844
Epoch: 1, Steps: 12 | Train Loss: 2.797 Vali Loss: 2.633 Vali Acc: 0.144 Test Loss: 2.633 Test Acc: 0.144
Validation loss decreased (inf --> -0.144418).  Saving model ...
Epoch: 2 cost time: 0.7236926555633545
Epoch: 2, Steps: 12 | Train Loss: 2.551 Vali Loss: 2.398 Vali Acc: 0.444 Test Loss: 2.398 Test Acc: 0.444
Validation loss decreased (-0.144418 --> -0.444420).  Saving model ...
Epoch: 3 cost time: 0.6929171085357666
Epoch: 3, Steps: 12 | Train Loss: 2.225 Vali Loss: 2.087 Vali Acc: 0.494 Test Loss: 2.087 Test Acc: 0.494
Validation loss decreased (-0.444420 --> -0.494424).  Saving model ...
Epoch: 4 cost time: 0.8499822616577148
Epoch: 4, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.757 Vali Acc: 0.578 Test Loss: 1.757 Test Acc: 0.578
Validation loss decreased (-0.494424 --> -0.577760).  Saving model ...
Epoch: 5 cost time: 0.7296829223632812
Epoch: 5, Steps: 12 | Train Loss: 1.570 Vali Loss: 1.461 Vali Acc: 0.572 Test Loss: 1.461 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7347002029418945
Epoch: 6, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.243 Vali Acc: 0.583 Test Loss: 1.243 Test Acc: 0.583
Validation loss decreased (-0.577760 --> -0.583321).  Saving model ...
Epoch: 7 cost time: 0.7322731018066406
Epoch: 7, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.067 Vali Acc: 0.611 Test Loss: 1.067 Test Acc: 0.611
Validation loss decreased (-0.583321 --> -0.611100).  Saving model ...
Epoch: 8 cost time: 0.6697211265563965
Epoch: 8, Steps: 12 | Train Loss: 0.880 Vali Loss: 1.020 Vali Acc: 0.656 Test Loss: 1.020 Test Acc: 0.656
Validation loss decreased (-0.611100 --> -0.655545).  Saving model ...
Epoch: 9 cost time: 0.6981418132781982
Epoch: 9, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.943 Vali Acc: 0.672 Test Loss: 0.943 Test Acc: 0.672
Validation loss decreased (-0.655545 --> -0.672213).  Saving model ...
Epoch: 10 cost time: 0.7278966903686523
Epoch: 10, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.907 Vali Acc: 0.706 Test Loss: 0.907 Test Acc: 0.706
Validation loss decreased (-0.672213 --> -0.705546).  Saving model ...
Epoch: 11 cost time: 0.8221025466918945
Epoch: 11, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.956 Vali Acc: 0.700 Test Loss: 0.956 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7443854808807373
Epoch: 12, Steps: 12 | Train Loss: 0.406 Vali Loss: 1.060 Vali Acc: 0.694 Test Loss: 1.060 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7847795486450195
Epoch: 13, Steps: 12 | Train Loss: 0.404 Vali Loss: 1.020 Vali Acc: 0.711 Test Loss: 1.020 Test Acc: 0.711
Validation loss decreased (-0.705546 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 0.8256676197052002
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 1.004 Vali Acc: 0.767 Test Loss: 1.004 Test Acc: 0.767
Validation loss decreased (-0.711101 --> -0.766657).  Saving model ...
Epoch: 15 cost time: 0.6417336463928223
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.980 Vali Acc: 0.750 Test Loss: 0.980 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6735942363739014
Epoch: 16, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.931 Vali Acc: 0.772 Test Loss: 0.931 Test Acc: 0.772
Validation loss decreased (-0.766657 --> -0.772213).  Saving model ...
Epoch: 17 cost time: 0.7535128593444824
Epoch: 17, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.827 Vali Acc: 0.794 Test Loss: 0.827 Test Acc: 0.794
Validation loss decreased (-0.772213 --> -0.794436).  Saving model ...
Epoch: 18 cost time: 0.6245102882385254
Epoch: 18, Steps: 12 | Train Loss: 0.212 Vali Loss: 1.004 Vali Acc: 0.744 Test Loss: 1.004 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7135703563690186
Epoch: 19, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.946 Vali Acc: 0.822 Test Loss: 0.946 Test Acc: 0.822
Validation loss decreased (-0.794436 --> -0.822213).  Saving model ...
Epoch: 20 cost time: 0.6369001865386963
Epoch: 20, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.893 Vali Acc: 0.822 Test Loss: 0.893 Test Acc: 0.822
Validation loss decreased (-0.822213 --> -0.822213).  Saving model ...
Epoch: 21 cost time: 0.7143220901489258
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.936 Vali Acc: 0.811 Test Loss: 0.936 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6937744617462158
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.150 Vali Acc: 0.778 Test Loss: 1.150 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7576236724853516
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.941 Vali Acc: 0.828 Test Loss: 0.941 Test Acc: 0.828
Validation loss decreased (-0.822213 --> -0.827768).  Saving model ...
Epoch: 24 cost time: 0.6875035762786865
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.978 Vali Acc: 0.811 Test Loss: 0.978 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6077356338500977
Epoch: 25, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.986 Vali Acc: 0.794 Test Loss: 0.986 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7877788543701172
Epoch: 26, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.047 Vali Acc: 0.817 Test Loss: 1.047 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7767789363861084
Epoch: 27, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.197 Vali Acc: 0.778 Test Loss: 1.197 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6328496932983398
Epoch: 28, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.108 Vali Acc: 0.794 Test Loss: 1.108 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7278673648834229
Epoch: 29, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.188 Vali Acc: 0.822 Test Loss: 1.188 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7105505466461182
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.094 Vali Acc: 0.806 Test Loss: 1.094 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7735331058502197
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.160 Vali Acc: 0.811 Test Loss: 1.160 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.815136194229126
Epoch: 32, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.157 Vali Acc: 0.800 Test Loss: 1.157 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6803967952728271
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.284 Vali Acc: 0.800 Test Loss: 1.284 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 22333455
model size : 99.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.7917091846466064
Epoch: 1, Steps: 12 | Train Loss: 2.883 Vali Loss: 2.712 Vali Acc: 0.150 Test Loss: 2.712 Test Acc: 0.150
Validation loss decreased (inf --> -0.149973).  Saving model ...
Epoch: 2 cost time: 0.639456033706665
Epoch: 2, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.525 Vali Acc: 0.250 Test Loss: 2.525 Test Acc: 0.250
Validation loss decreased (-0.149973 --> -0.249975).  Saving model ...
Epoch: 3 cost time: 0.5277752876281738
Epoch: 3, Steps: 12 | Train Loss: 2.414 Vali Loss: 2.315 Vali Acc: 0.483 Test Loss: 2.315 Test Acc: 0.483
Validation loss decreased (-0.249975 --> -0.483310).  Saving model ...
Epoch: 4 cost time: 0.5006289482116699
Epoch: 4, Steps: 12 | Train Loss: 2.187 Vali Loss: 2.082 Vali Acc: 0.489 Test Loss: 2.082 Test Acc: 0.489
Validation loss decreased (-0.483310 --> -0.488868).  Saving model ...
Epoch: 5 cost time: 0.536268949508667
Epoch: 5, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.800 Vali Acc: 0.544 Test Loss: 1.800 Test Acc: 0.544
Validation loss decreased (-0.488868 --> -0.544426).  Saving model ...
Epoch: 6 cost time: 0.5850038528442383
Epoch: 6, Steps: 12 | Train Loss: 1.577 Vali Loss: 1.519 Vali Acc: 0.550 Test Loss: 1.519 Test Acc: 0.550
Validation loss decreased (-0.544426 --> -0.549985).  Saving model ...
Epoch: 7 cost time: 0.5572488307952881
Epoch: 7, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.284 Vali Acc: 0.611 Test Loss: 1.284 Test Acc: 0.611
Validation loss decreased (-0.549985 --> -0.611098).  Saving model ...
Epoch: 8 cost time: 0.5894594192504883
Epoch: 8, Steps: 12 | Train Loss: 1.148 Vali Loss: 1.123 Vali Acc: 0.611 Test Loss: 1.123 Test Acc: 0.611
Validation loss decreased (-0.611098 --> -0.611100).  Saving model ...
Epoch: 9 cost time: 0.49819135665893555
Epoch: 9, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.988 Vali Acc: 0.633 Test Loss: 0.988 Test Acc: 0.633
Validation loss decreased (-0.611100 --> -0.633323).  Saving model ...
Epoch: 10 cost time: 0.5288138389587402
Epoch: 10, Steps: 12 | Train Loss: 0.780 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
Validation loss decreased (-0.633323 --> -0.683324).  Saving model ...
Epoch: 11 cost time: 0.5521407127380371
Epoch: 11, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.797 Vali Acc: 0.700 Test Loss: 0.797 Test Acc: 0.700
Validation loss decreased (-0.683324 --> -0.699992).  Saving model ...
Epoch: 12 cost time: 0.6577398777008057
Epoch: 12, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.830 Vali Acc: 0.706 Test Loss: 0.830 Test Acc: 0.706
Validation loss decreased (-0.699992 --> -0.705547).  Saving model ...
Epoch: 13 cost time: 0.5711944103240967
Epoch: 13, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.706 Vali Acc: 0.733 Test Loss: 0.706 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733326).  Saving model ...
Epoch: 14 cost time: 0.5673134326934814
Epoch: 14, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.638 Vali Acc: 0.772 Test Loss: 0.638 Test Acc: 0.772
Validation loss decreased (-0.733326 --> -0.772216).  Saving model ...
Epoch: 15 cost time: 0.7328183650970459
Epoch: 15, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.728 Vali Acc: 0.772 Test Loss: 0.728 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5061969757080078
Epoch: 16, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.618 Vali Acc: 0.806 Test Loss: 0.618 Test Acc: 0.806
Validation loss decreased (-0.772216 --> -0.805549).  Saving model ...
Epoch: 17 cost time: 0.5714912414550781
Epoch: 17, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.709 Vali Acc: 0.822 Test Loss: 0.709 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 18 cost time: 0.6806550025939941
Epoch: 18, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.677 Vali Acc: 0.817 Test Loss: 0.677 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6648960113525391
Epoch: 19, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.676 Vali Acc: 0.817 Test Loss: 0.676 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5402872562408447
Epoch: 20, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 21 cost time: 0.6462152004241943
Epoch: 21, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.681 Vali Acc: 0.811 Test Loss: 0.681 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7117526531219482
Epoch: 22, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.691 Vali Acc: 0.828 Test Loss: 0.691 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.704505205154419
Epoch: 23, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.692 Vali Acc: 0.822 Test Loss: 0.692 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6169304847717285
Epoch: 24, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.681 Vali Acc: 0.844 Test Loss: 0.681 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 0.5622246265411377
Epoch: 25, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.776 Vali Acc: 0.861 Test Loss: 0.776 Test Acc: 0.861
Validation loss decreased (-0.844438 --> -0.861103).  Saving model ...
Epoch: 26 cost time: 0.7108290195465088
Epoch: 26, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.755 Vali Acc: 0.828 Test Loss: 0.755 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6921768188476562
Epoch: 27, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.761 Vali Acc: 0.822 Test Loss: 0.761 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5871679782867432
Epoch: 28, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.780 Vali Acc: 0.828 Test Loss: 0.780 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7398004531860352
Epoch: 29, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.834 Vali Acc: 0.811 Test Loss: 0.834 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7382001876831055
Epoch: 30, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.836 Vali Acc: 0.817 Test Loss: 0.836 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6362946033477783
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.812 Vali Acc: 0.817 Test Loss: 0.812 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.701179027557373
Epoch: 32, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.766 Vali Acc: 0.828 Test Loss: 0.766 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6987085342407227
Epoch: 33, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.847 Vali Acc: 0.828 Test Loss: 0.847 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6121118068695068
Epoch: 34, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6387419700622559
Epoch: 35, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.771 Vali Acc: 0.856 Test Loss: 0.771 Test Acc: 0.856
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 22242063
model size : 99.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0303635597229004
Epoch: 1, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.609 Vali Acc: 0.217 Test Loss: 2.609 Test Acc: 0.217
Validation loss decreased (inf --> -0.216641).  Saving model ...
Epoch: 2 cost time: 0.8312432765960693
Epoch: 2, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.316 Vali Acc: 0.344 Test Loss: 2.316 Test Acc: 0.344
Validation loss decreased (-0.216641 --> -0.344421).  Saving model ...
Epoch: 3 cost time: 0.6408722400665283
Epoch: 3, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.001 Vali Acc: 0.472 Test Loss: 2.001 Test Acc: 0.472
Validation loss decreased (-0.344421 --> -0.472202).  Saving model ...
Epoch: 4 cost time: 0.657576322555542
Epoch: 4, Steps: 12 | Train Loss: 1.724 Vali Loss: 1.658 Vali Acc: 0.539 Test Loss: 1.658 Test Acc: 0.539
Validation loss decreased (-0.472202 --> -0.538872).  Saving model ...
Epoch: 5 cost time: 0.6663026809692383
Epoch: 5, Steps: 12 | Train Loss: 1.417 Vali Loss: 1.354 Vali Acc: 0.567 Test Loss: 1.354 Test Acc: 0.567
Validation loss decreased (-0.538872 --> -0.566653).  Saving model ...
Epoch: 6 cost time: 0.6645505428314209
Epoch: 6, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.154 Vali Acc: 0.578 Test Loss: 1.154 Test Acc: 0.578
Validation loss decreased (-0.566653 --> -0.577766).  Saving model ...
Epoch: 7 cost time: 0.7457427978515625
Epoch: 7, Steps: 12 | Train Loss: 0.932 Vali Loss: 1.082 Vali Acc: 0.656 Test Loss: 1.082 Test Acc: 0.656
Validation loss decreased (-0.577766 --> -0.655545).  Saving model ...
Epoch: 8 cost time: 0.7728588581085205
Epoch: 8, Steps: 12 | Train Loss: 0.817 Vali Loss: 0.963 Vali Acc: 0.661 Test Loss: 0.963 Test Acc: 0.661
Validation loss decreased (-0.655545 --> -0.661101).  Saving model ...
Epoch: 9 cost time: 0.6762843132019043
Epoch: 9, Steps: 12 | Train Loss: 0.609 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7623071670532227
Epoch: 10, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.866 Vali Acc: 0.689 Test Loss: 0.866 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688880).  Saving model ...
Epoch: 11 cost time: 0.5997612476348877
Epoch: 11, Steps: 12 | Train Loss: 0.437 Vali Loss: 1.090 Vali Acc: 0.694 Test Loss: 1.090 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 0.574897050857544
Epoch: 12, Steps: 12 | Train Loss: 0.355 Vali Loss: 1.025 Vali Acc: 0.706 Test Loss: 1.025 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705545).  Saving model ...
Epoch: 13 cost time: 0.6472721099853516
Epoch: 13, Steps: 12 | Train Loss: 0.352 Vali Loss: 1.204 Vali Acc: 0.711 Test Loss: 1.204 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711099).  Saving model ...
Epoch: 14 cost time: 0.5584404468536377
Epoch: 14, Steps: 12 | Train Loss: 0.319 Vali Loss: 1.011 Vali Acc: 0.772 Test Loss: 1.011 Test Acc: 0.772
Validation loss decreased (-0.711099 --> -0.772212).  Saving model ...
Epoch: 15 cost time: 0.661545991897583
Epoch: 15, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.060 Vali Acc: 0.761 Test Loss: 1.060 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6449787616729736
Epoch: 16, Steps: 12 | Train Loss: 0.168 Vali Loss: 1.198 Vali Acc: 0.733 Test Loss: 1.198 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6299364566802979
Epoch: 17, Steps: 12 | Train Loss: 0.223 Vali Loss: 1.208 Vali Acc: 0.739 Test Loss: 1.208 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5922811031341553
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 1.226 Vali Acc: 0.728 Test Loss: 1.226 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6001958847045898
Epoch: 19, Steps: 12 | Train Loss: 0.199 Vali Loss: 1.169 Vali Acc: 0.767 Test Loss: 1.169 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5387811660766602
Epoch: 20, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.287 Vali Acc: 0.783 Test Loss: 1.287 Test Acc: 0.783
Validation loss decreased (-0.772212 --> -0.783320).  Saving model ...
Epoch: 21 cost time: 0.5874450206756592
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.394 Vali Acc: 0.744 Test Loss: 1.394 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5894627571105957
Epoch: 22, Steps: 12 | Train Loss: 0.128 Vali Loss: 1.261 Vali Acc: 0.756 Test Loss: 1.261 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6620244979858398
Epoch: 23, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.241 Vali Acc: 0.794 Test Loss: 1.241 Test Acc: 0.794
Validation loss decreased (-0.783320 --> -0.794432).  Saving model ...
Epoch: 24 cost time: 0.6569507122039795
Epoch: 24, Steps: 12 | Train Loss: 0.086 Vali Loss: 1.714 Vali Acc: 0.761 Test Loss: 1.714 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8747982978820801
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.600 Vali Acc: 0.756 Test Loss: 1.600 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6899945735931396
Epoch: 26, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.596 Vali Acc: 0.739 Test Loss: 1.596 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6446082592010498
Epoch: 27, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.594 Vali Acc: 0.778 Test Loss: 1.594 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.817591667175293
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.557 Vali Acc: 0.789 Test Loss: 1.557 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7464370727539062
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.572 Vali Acc: 0.761 Test Loss: 1.572 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6589138507843018
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.591 Vali Acc: 0.783 Test Loss: 1.591 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6652672290802002
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.572 Vali Acc: 0.794 Test Loss: 1.572 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6947007179260254
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.733 Vali Acc: 0.789 Test Loss: 1.733 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.583815336227417
Epoch: 33, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.386 Vali Acc: 0.817 Test Loss: 1.386 Test Acc: 0.817
Validation loss decreased (-0.794432 --> -0.816653).  Saving model ...
Epoch: 34 cost time: 0.6596043109893799
Epoch: 34, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.529 Vali Acc: 0.778 Test Loss: 1.529 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8289525508880615
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.455 Vali Acc: 0.794 Test Loss: 1.455 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7042882442474365
Epoch: 36, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.574 Vali Acc: 0.789 Test Loss: 1.574 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8447539806365967
Epoch: 37, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.440 Vali Acc: 0.811 Test Loss: 1.440 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7779154777526855
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.638 Vali Acc: 0.778 Test Loss: 1.638 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6578552722930908
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.740 Vali Acc: 0.789 Test Loss: 1.740 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6469979286193848
Epoch: 40, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.657 Vali Acc: 0.794 Test Loss: 1.657 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8190977573394775
Epoch: 41, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.557 Vali Acc: 0.800 Test Loss: 1.557 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8211214542388916
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.705 Vali Acc: 0.800 Test Loss: 1.705 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8443541526794434
Epoch: 43, Steps: 12 | Train Loss: 0.015 Vali Loss: 1.656 Vali Acc: 0.767 Test Loss: 1.656 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps7_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 22416399
model size : 100.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9991517066955566
Epoch: 1, Steps: 12 | Train Loss: 2.807 Vali Loss: 2.665 Vali Acc: 0.122 Test Loss: 2.665 Test Acc: 0.122
Validation loss decreased (inf --> -0.122196).  Saving model ...
Epoch: 2 cost time: 0.5591986179351807
Epoch: 2, Steps: 12 | Train Loss: 2.611 Vali Loss: 2.471 Vali Acc: 0.339 Test Loss: 2.471 Test Acc: 0.339
Validation loss decreased (-0.122196 --> -0.338864).  Saving model ...
Epoch: 3 cost time: 0.7113006114959717
Epoch: 3, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.259 Vali Acc: 0.456 Test Loss: 2.259 Test Acc: 0.456
Validation loss decreased (-0.338864 --> -0.455533).  Saving model ...
Epoch: 4 cost time: 0.5742385387420654
Epoch: 4, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.009 Vali Acc: 0.539 Test Loss: 2.009 Test Acc: 0.539
Validation loss decreased (-0.455533 --> -0.538869).  Saving model ...
Epoch: 5 cost time: 0.6284873485565186
Epoch: 5, Steps: 12 | Train Loss: 1.775 Vali Loss: 1.691 Vali Acc: 0.528 Test Loss: 1.691 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6574125289916992
Epoch: 6, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.339 Vali Acc: 0.561 Test Loss: 1.339 Test Acc: 0.561
Validation loss decreased (-0.538869 --> -0.561098).  Saving model ...
Epoch: 7 cost time: 0.7920386791229248
Epoch: 7, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.129 Vali Acc: 0.567 Test Loss: 1.129 Test Acc: 0.567
Validation loss decreased (-0.561098 --> -0.566655).  Saving model ...
Epoch: 8 cost time: 0.6001114845275879
Epoch: 8, Steps: 12 | Train Loss: 0.911 Vali Loss: 0.973 Vali Acc: 0.656 Test Loss: 0.973 Test Acc: 0.656
Validation loss decreased (-0.566655 --> -0.655546).  Saving model ...
Epoch: 9 cost time: 0.701331377029419
Epoch: 9, Steps: 12 | Train Loss: 0.804 Vali Loss: 0.951 Vali Acc: 0.656 Test Loss: 0.951 Test Acc: 0.656
Validation loss decreased (-0.655546 --> -0.655546).  Saving model ...
Epoch: 10 cost time: 0.6759517192840576
Epoch: 10, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.882 Vali Acc: 0.678 Test Loss: 0.882 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677769).  Saving model ...
Epoch: 11 cost time: 0.7321817874908447
Epoch: 11, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.816 Vali Acc: 0.706 Test Loss: 0.816 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705547).  Saving model ...
Epoch: 12 cost time: 0.6995325088500977
Epoch: 12, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.816 Vali Acc: 0.733 Test Loss: 0.816 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 0.5233168601989746
Epoch: 13, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.846 Vali Acc: 0.733 Test Loss: 0.846 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6555516719818115
Epoch: 14, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.721 Vali Acc: 0.744 Test Loss: 0.721 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 15 cost time: 0.7386472225189209
Epoch: 15, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.792 Vali Acc: 0.767 Test Loss: 0.792 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766659).  Saving model ...
Epoch: 16 cost time: 0.5570724010467529
Epoch: 16, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.774 Vali Acc: 0.794 Test Loss: 0.774 Test Acc: 0.794
Validation loss decreased (-0.766659 --> -0.794437).  Saving model ...
Epoch: 17 cost time: 0.5709550380706787
Epoch: 17, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.786 Vali Acc: 0.789 Test Loss: 0.786 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.518794059753418
Epoch: 18, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.709 Vali Acc: 0.794 Test Loss: 0.709 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 19 cost time: 0.6447892189025879
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.831 Vali Acc: 0.767 Test Loss: 0.831 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6230080127716064
Epoch: 20, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.826 Vali Acc: 0.800 Test Loss: 0.826 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.5970616340637207
Epoch: 21, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.902 Vali Acc: 0.822 Test Loss: 0.902 Test Acc: 0.822
Validation loss decreased (-0.799992 --> -0.822213).  Saving model ...
Epoch: 22 cost time: 0.5318374633789062
Epoch: 22, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.931 Vali Acc: 0.778 Test Loss: 0.931 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5665061473846436
Epoch: 23, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.940 Vali Acc: 0.794 Test Loss: 0.940 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.630850076675415
Epoch: 24, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.929 Vali Acc: 0.778 Test Loss: 0.929 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6602256298065186
Epoch: 25, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.897 Vali Acc: 0.833 Test Loss: 0.897 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833324).  Saving model ...
Epoch: 26 cost time: 0.6911702156066895
Epoch: 26, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.898 Vali Acc: 0.811 Test Loss: 0.898 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6152458190917969
Epoch: 27, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.920 Vali Acc: 0.806 Test Loss: 0.920 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5268731117248535
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.862 Vali Acc: 0.828 Test Loss: 0.862 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5810146331787109
Epoch: 29, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.963 Vali Acc: 0.828 Test Loss: 0.963 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6085872650146484
Epoch: 30, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.943 Vali Acc: 0.800 Test Loss: 0.943 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6958534717559814
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.020 Vali Acc: 0.811 Test Loss: 1.020 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5765578746795654
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.949 Vali Acc: 0.817 Test Loss: 0.949 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6287870407104492
Epoch: 33, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.004 Vali Acc: 0.817 Test Loss: 1.004 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5926222801208496
Epoch: 34, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.990 Vali Acc: 0.828 Test Loss: 0.990 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5573573112487793
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 1.022 Vali Acc: 0.789 Test Loss: 1.022 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps7_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 22285839
model size : 99.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0125324726104736
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.692 Vali Acc: 0.139 Test Loss: 2.692 Test Acc: 0.139
Validation loss decreased (inf --> -0.138862).  Saving model ...
Epoch: 2 cost time: 0.5676500797271729
Epoch: 2, Steps: 12 | Train Loss: 2.600 Vali Loss: 2.530 Vali Acc: 0.244 Test Loss: 2.530 Test Acc: 0.244
Validation loss decreased (-0.138862 --> -0.244419).  Saving model ...
Epoch: 3 cost time: 0.5886709690093994
Epoch: 3, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.351 Vali Acc: 0.389 Test Loss: 2.351 Test Acc: 0.389
Validation loss decreased (-0.244419 --> -0.388865).  Saving model ...
Epoch: 4 cost time: 0.7076618671417236
Epoch: 4, Steps: 12 | Train Loss: 2.243 Vali Loss: 2.139 Vali Acc: 0.472 Test Loss: 2.139 Test Acc: 0.472
Validation loss decreased (-0.388865 --> -0.472201).  Saving model ...
Epoch: 5 cost time: 0.5642580986022949
Epoch: 5, Steps: 12 | Train Loss: 1.994 Vali Loss: 1.862 Vali Acc: 0.533 Test Loss: 1.862 Test Acc: 0.533
Validation loss decreased (-0.472201 --> -0.533315).  Saving model ...
Epoch: 6 cost time: 0.7269086837768555
Epoch: 6, Steps: 12 | Train Loss: 1.678 Vali Loss: 1.534 Vali Acc: 0.550 Test Loss: 1.534 Test Acc: 0.550
Validation loss decreased (-0.533315 --> -0.549985).  Saving model ...
Epoch: 7 cost time: 0.5335350036621094
Epoch: 7, Steps: 12 | Train Loss: 1.361 Vali Loss: 1.246 Vali Acc: 0.583 Test Loss: 1.246 Test Acc: 0.583
Validation loss decreased (-0.549985 --> -0.583321).  Saving model ...
Epoch: 8 cost time: 0.5259678363800049
Epoch: 8, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.104 Vali Acc: 0.617 Test Loss: 1.104 Test Acc: 0.617
Validation loss decreased (-0.583321 --> -0.616656).  Saving model ...
Epoch: 9 cost time: 0.6965246200561523
Epoch: 9, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.924 Vali Acc: 0.628 Test Loss: 0.924 Test Acc: 0.628
Validation loss decreased (-0.616656 --> -0.627769).  Saving model ...
Epoch: 10 cost time: 0.6450233459472656
Epoch: 10, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.854 Vali Acc: 0.694 Test Loss: 0.854 Test Acc: 0.694
Validation loss decreased (-0.627769 --> -0.694436).  Saving model ...
Epoch: 11 cost time: 0.6435034275054932
Epoch: 11, Steps: 12 | Train Loss: 0.619 Vali Loss: 0.789 Vali Acc: 0.711 Test Loss: 0.789 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.6773748397827148
Epoch: 12, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.779 Vali Acc: 0.739 Test Loss: 0.779 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738881).  Saving model ...
Epoch: 13 cost time: 0.5781328678131104
Epoch: 13, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.690 Vali Acc: 0.739 Test Loss: 0.690 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 0.6184749603271484
Epoch: 14, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.684 Vali Acc: 0.772 Test Loss: 0.684 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772215).  Saving model ...
Epoch: 15 cost time: 0.5124027729034424
Epoch: 15, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.571120023727417
Epoch: 16, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
Validation loss decreased (-0.772215 --> -0.783327).  Saving model ...
Epoch: 17 cost time: 0.7206835746765137
Epoch: 17, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
Validation loss decreased (-0.783327 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.5403738021850586
Epoch: 18, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.674 Vali Acc: 0.822 Test Loss: 0.674 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 0.5330934524536133
Epoch: 19, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.637 Vali Acc: 0.794 Test Loss: 0.637 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5735034942626953
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.761 Vali Acc: 0.828 Test Loss: 0.761 Test Acc: 0.828
Validation loss decreased (-0.822215 --> -0.827770).  Saving model ...
Epoch: 21 cost time: 0.5522739887237549
Epoch: 21, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.670 Vali Acc: 0.800 Test Loss: 0.670 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5368342399597168
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.722 Vali Acc: 0.822 Test Loss: 0.722 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5240256786346436
Epoch: 23, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.723 Vali Acc: 0.833 Test Loss: 0.723 Test Acc: 0.833
Validation loss decreased (-0.827770 --> -0.833326).  Saving model ...
Epoch: 24 cost time: 0.6136982440948486
Epoch: 24, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.669 Vali Acc: 0.839 Test Loss: 0.669 Test Acc: 0.839
Validation loss decreased (-0.833326 --> -0.838882).  Saving model ...
Epoch: 25 cost time: 0.548102617263794
Epoch: 25, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6344923973083496
Epoch: 26, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
Validation loss decreased (-0.838882 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 0.6949155330657959
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.743 Vali Acc: 0.822 Test Loss: 0.743 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6265406608581543
Epoch: 28, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.664 Vali Acc: 0.872 Test Loss: 0.664 Test Acc: 0.872
Validation loss decreased (-0.849993 --> -0.872216).  Saving model ...
Epoch: 29 cost time: 0.7341206073760986
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.728 Vali Acc: 0.861 Test Loss: 0.728 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5864145755767822
Epoch: 30, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.764 Vali Acc: 0.867 Test Loss: 0.764 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6758699417114258
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6226708889007568
Epoch: 32, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.800 Vali Acc: 0.839 Test Loss: 0.800 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6302883625030518
Epoch: 33, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.703 Vali Acc: 0.844 Test Loss: 0.703 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6807661056518555
Epoch: 34, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.796 Vali Acc: 0.867 Test Loss: 0.796 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6675782203674316
Epoch: 35, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.782 Vali Acc: 0.856 Test Loss: 0.782 Test Acc: 0.856
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6681606769561768
Epoch: 36, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6801366806030273
Epoch: 37, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.798 Vali Acc: 0.861 Test Loss: 0.798 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.568824052810669
Epoch: 38, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.769 Vali Acc: 0.861 Test Loss: 0.769 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps7_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8722222222222222
model parameter : 22233615
model size : 99.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2119686603546143
Epoch: 1, Steps: 12 | Train Loss: 2.824 Vali Loss: 2.653 Vali Acc: 0.117 Test Loss: 2.653 Test Acc: 0.117
Validation loss decreased (inf --> -0.116640).  Saving model ...
Epoch: 2 cost time: 0.6506185531616211
Epoch: 2, Steps: 12 | Train Loss: 2.500 Vali Loss: 2.360 Vali Acc: 0.361 Test Loss: 2.360 Test Acc: 0.361
Validation loss decreased (-0.116640 --> -0.361088).  Saving model ...
Epoch: 3 cost time: 0.9173316955566406
Epoch: 3, Steps: 12 | Train Loss: 2.181 Vali Loss: 2.006 Vali Acc: 0.428 Test Loss: 2.006 Test Acc: 0.428
Validation loss decreased (-0.361088 --> -0.427758).  Saving model ...
Epoch: 4 cost time: 1.0225129127502441
Epoch: 4, Steps: 12 | Train Loss: 1.774 Vali Loss: 1.669 Vali Acc: 0.556 Test Loss: 1.669 Test Acc: 0.556
Validation loss decreased (-0.427758 --> -0.555539).  Saving model ...
Epoch: 5 cost time: 0.9926316738128662
Epoch: 5, Steps: 12 | Train Loss: 1.448 Vali Loss: 1.448 Vali Acc: 0.561 Test Loss: 1.448 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561097).  Saving model ...
Epoch: 6 cost time: 0.9871683120727539
Epoch: 6, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.241 Vali Acc: 0.561 Test Loss: 1.241 Test Acc: 0.561
Validation loss decreased (-0.561097 --> -0.561099).  Saving model ...
Epoch: 7 cost time: 0.8141615390777588
Epoch: 7, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.090 Vali Acc: 0.639 Test Loss: 1.090 Test Acc: 0.639
Validation loss decreased (-0.561099 --> -0.638878).  Saving model ...
Epoch: 8 cost time: 0.9558429718017578
Epoch: 8, Steps: 12 | Train Loss: 0.685 Vali Loss: 1.111 Vali Acc: 0.639 Test Loss: 1.111 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7529337406158447
Epoch: 9, Steps: 12 | Train Loss: 0.611 Vali Loss: 1.081 Vali Acc: 0.617 Test Loss: 1.081 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9704828262329102
Epoch: 10, Steps: 12 | Train Loss: 0.566 Vali Loss: 1.121 Vali Acc: 0.689 Test Loss: 1.121 Test Acc: 0.689
Validation loss decreased (-0.638878 --> -0.688878).  Saving model ...
Epoch: 11 cost time: 0.7897610664367676
Epoch: 11, Steps: 12 | Train Loss: 0.601 Vali Loss: 1.052 Vali Acc: 0.694 Test Loss: 1.052 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694434).  Saving model ...
Epoch: 12 cost time: 0.7007279396057129
Epoch: 12, Steps: 12 | Train Loss: 0.455 Vali Loss: 1.157 Vali Acc: 0.722 Test Loss: 1.157 Test Acc: 0.722
Validation loss decreased (-0.694434 --> -0.722211).  Saving model ...
Epoch: 13 cost time: 0.8835303783416748
Epoch: 13, Steps: 12 | Train Loss: 0.367 Vali Loss: 1.105 Vali Acc: 0.711 Test Loss: 1.105 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8130946159362793
Epoch: 14, Steps: 12 | Train Loss: 0.422 Vali Loss: 1.138 Vali Acc: 0.733 Test Loss: 1.138 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733322).  Saving model ...
Epoch: 15 cost time: 0.6238875389099121
Epoch: 15, Steps: 12 | Train Loss: 0.457 Vali Loss: 1.041 Vali Acc: 0.739 Test Loss: 1.041 Test Acc: 0.739
Validation loss decreased (-0.733322 --> -0.738878).  Saving model ...
Epoch: 16 cost time: 0.8223683834075928
Epoch: 16, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.883 Vali Acc: 0.778 Test Loss: 0.883 Test Acc: 0.778
Validation loss decreased (-0.738878 --> -0.777769).  Saving model ...
Epoch: 17 cost time: 0.7398581504821777
Epoch: 17, Steps: 12 | Train Loss: 0.133 Vali Loss: 1.081 Vali Acc: 0.733 Test Loss: 1.081 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8595221042633057
Epoch: 18, Steps: 12 | Train Loss: 0.150 Vali Loss: 1.019 Vali Acc: 0.789 Test Loss: 1.019 Test Acc: 0.789
Validation loss decreased (-0.777769 --> -0.788879).  Saving model ...
Epoch: 19 cost time: 0.8846778869628906
Epoch: 19, Steps: 12 | Train Loss: 0.163 Vali Loss: 1.245 Vali Acc: 0.761 Test Loss: 1.245 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7562251091003418
Epoch: 20, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.149 Vali Acc: 0.772 Test Loss: 1.149 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8826439380645752
Epoch: 21, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.173 Vali Acc: 0.761 Test Loss: 1.173 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8261053562164307
Epoch: 22, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.025 Vali Acc: 0.783 Test Loss: 1.025 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9163718223571777
Epoch: 23, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.284 Vali Acc: 0.789 Test Loss: 1.284 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8531067371368408
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.116 Vali Acc: 0.817 Test Loss: 1.116 Test Acc: 0.817
Validation loss decreased (-0.788879 --> -0.816656).  Saving model ...
Epoch: 25 cost time: 0.7285516262054443
Epoch: 25, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.402 Vali Acc: 0.783 Test Loss: 1.402 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8648865222930908
Epoch: 26, Steps: 12 | Train Loss: 0.142 Vali Loss: 1.190 Vali Acc: 0.800 Test Loss: 1.190 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8951799869537354
Epoch: 27, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.481 Vali Acc: 0.800 Test Loss: 1.481 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6237831115722656
Epoch: 28, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.424 Vali Acc: 0.733 Test Loss: 1.424 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8573143482208252
Epoch: 29, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.347 Vali Acc: 0.789 Test Loss: 1.347 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5863323211669922
Epoch: 30, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.263 Vali Acc: 0.767 Test Loss: 1.263 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6045236587524414
Epoch: 31, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.426 Vali Acc: 0.794 Test Loss: 1.426 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8675577640533447
Epoch: 32, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.331 Vali Acc: 0.772 Test Loss: 1.331 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7871847152709961
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.411 Vali Acc: 0.806 Test Loss: 1.411 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6755733489990234
Epoch: 34, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.295 Vali Acc: 0.794 Test Loss: 1.295 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 22407951
model size : 100.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0766379833221436
Epoch: 1, Steps: 12 | Train Loss: 2.777 Vali Loss: 2.672 Vali Acc: 0.106 Test Loss: 2.672 Test Acc: 0.106
Validation loss decreased (inf --> -0.105529).  Saving model ...
Epoch: 2 cost time: 0.536041259765625
Epoch: 2, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.498 Vali Acc: 0.333 Test Loss: 2.498 Test Acc: 0.333
Validation loss decreased (-0.105529 --> -0.333308).  Saving model ...
Epoch: 3 cost time: 0.5223667621612549
Epoch: 3, Steps: 12 | Train Loss: 2.351 Vali Loss: 2.249 Vali Acc: 0.411 Test Loss: 2.249 Test Acc: 0.411
Validation loss decreased (-0.333308 --> -0.411089).  Saving model ...
Epoch: 4 cost time: 0.661494255065918
Epoch: 4, Steps: 12 | Train Loss: 2.012 Vali Loss: 1.989 Vali Acc: 0.517 Test Loss: 1.989 Test Acc: 0.517
Validation loss decreased (-0.411089 --> -0.516647).  Saving model ...
Epoch: 5 cost time: 0.5183210372924805
Epoch: 5, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.721 Vali Acc: 0.561 Test Loss: 1.721 Test Acc: 0.561
Validation loss decreased (-0.516647 --> -0.561094).  Saving model ...
Epoch: 6 cost time: 0.6735255718231201
Epoch: 6, Steps: 12 | Train Loss: 1.432 Vali Loss: 1.441 Vali Acc: 0.517 Test Loss: 1.441 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6679515838623047
Epoch: 7, Steps: 12 | Train Loss: 1.179 Vali Loss: 1.225 Vali Acc: 0.600 Test Loss: 1.225 Test Acc: 0.600
Validation loss decreased (-0.561094 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.6426115036010742
Epoch: 8, Steps: 12 | Train Loss: 0.977 Vali Loss: 1.121 Vali Acc: 0.589 Test Loss: 1.121 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7175323963165283
Epoch: 9, Steps: 12 | Train Loss: 0.737 Vali Loss: 1.013 Vali Acc: 0.622 Test Loss: 1.013 Test Acc: 0.622
Validation loss decreased (-0.599988 --> -0.622212).  Saving model ...
Epoch: 10 cost time: 0.5712530612945557
Epoch: 10, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.957 Vali Acc: 0.650 Test Loss: 0.957 Test Acc: 0.650
Validation loss decreased (-0.622212 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.6464083194732666
Epoch: 11, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.822 Vali Acc: 0.711 Test Loss: 0.822 Test Acc: 0.711
Validation loss decreased (-0.649990 --> -0.711103).  Saving model ...
Epoch: 12 cost time: 0.7702255249023438
Epoch: 12, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.893 Vali Acc: 0.733 Test Loss: 0.893 Test Acc: 0.733
Validation loss decreased (-0.711103 --> -0.733324).  Saving model ...
Epoch: 13 cost time: 0.6993770599365234
Epoch: 13, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.769 Vali Acc: 0.772 Test Loss: 0.769 Test Acc: 0.772
Validation loss decreased (-0.733324 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 0.6708428859710693
Epoch: 14, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.825 Vali Acc: 0.733 Test Loss: 0.825 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.620434045791626
Epoch: 15, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.786 Vali Acc: 0.772 Test Loss: 0.786 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7338480949401855
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.767 Vali Acc: 0.778 Test Loss: 0.767 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 17 cost time: 0.6936805248260498
Epoch: 17, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.721 Vali Acc: 0.828 Test Loss: 0.721 Test Acc: 0.828
Validation loss decreased (-0.777770 --> -0.827771).  Saving model ...
Epoch: 18 cost time: 0.6674213409423828
Epoch: 18, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.743 Vali Acc: 0.800 Test Loss: 0.743 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7393362522125244
Epoch: 19, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.895 Vali Acc: 0.756 Test Loss: 0.895 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.645216703414917
Epoch: 20, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.772 Vali Acc: 0.811 Test Loss: 0.772 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5599851608276367
Epoch: 21, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.892 Vali Acc: 0.806 Test Loss: 0.892 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5572023391723633
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.798 Vali Acc: 0.811 Test Loss: 0.798 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6872503757476807
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.935 Vali Acc: 0.778 Test Loss: 0.935 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.47910022735595703
Epoch: 24, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5112099647521973
Epoch: 25, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.985 Vali Acc: 0.800 Test Loss: 0.985 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6272225379943848
Epoch: 26, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.877 Vali Acc: 0.822 Test Loss: 0.877 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6169066429138184
Epoch: 27, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.832 Vali Acc: 0.800 Test Loss: 0.832 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 22290447
model size : 99.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.721059799194336
Epoch: 1, Steps: 12 | Train Loss: 2.813 Vali Loss: 2.698 Vali Acc: 0.050 Test Loss: 2.698 Test Acc: 0.050
Validation loss decreased (inf --> -0.049973).  Saving model ...
Epoch: 2 cost time: 0.513688325881958
Epoch: 2, Steps: 12 | Train Loss: 2.633 Vali Loss: 2.573 Vali Acc: 0.200 Test Loss: 2.573 Test Acc: 0.200
Validation loss decreased (-0.049973 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 0.622215747833252
Epoch: 3, Steps: 12 | Train Loss: 2.510 Vali Loss: 2.421 Vali Acc: 0.294 Test Loss: 2.421 Test Acc: 0.294
Validation loss decreased (-0.199974 --> -0.294420).  Saving model ...
Epoch: 4 cost time: 0.61454176902771
Epoch: 4, Steps: 12 | Train Loss: 2.312 Vali Loss: 2.258 Vali Acc: 0.372 Test Loss: 2.258 Test Acc: 0.372
Validation loss decreased (-0.294420 --> -0.372200).  Saving model ...
Epoch: 5 cost time: 0.49031662940979004
Epoch: 5, Steps: 12 | Train Loss: 2.128 Vali Loss: 2.055 Vali Acc: 0.433 Test Loss: 2.055 Test Acc: 0.433
Validation loss decreased (-0.372200 --> -0.433313).  Saving model ...
Epoch: 6 cost time: 0.5840334892272949
Epoch: 6, Steps: 12 | Train Loss: 1.912 Vali Loss: 1.801 Vali Acc: 0.494 Test Loss: 1.801 Test Acc: 0.494
Validation loss decreased (-0.433313 --> -0.494426).  Saving model ...
Epoch: 7 cost time: 0.5406224727630615
Epoch: 7, Steps: 12 | Train Loss: 1.594 Vali Loss: 1.517 Vali Acc: 0.594 Test Loss: 1.517 Test Acc: 0.594
Validation loss decreased (-0.494426 --> -0.594429).  Saving model ...
Epoch: 8 cost time: 0.576542854309082
Epoch: 8, Steps: 12 | Train Loss: 1.354 Vali Loss: 1.270 Vali Acc: 0.622 Test Loss: 1.270 Test Acc: 0.622
Validation loss decreased (-0.594429 --> -0.622210).  Saving model ...
Epoch: 9 cost time: 0.6300413608551025
Epoch: 9, Steps: 12 | Train Loss: 1.031 Vali Loss: 1.139 Vali Acc: 0.611 Test Loss: 1.139 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6215429306030273
Epoch: 10, Steps: 12 | Train Loss: 0.861 Vali Loss: 0.944 Vali Acc: 0.661 Test Loss: 0.944 Test Acc: 0.661
Validation loss decreased (-0.622210 --> -0.661102).  Saving model ...
Epoch: 11 cost time: 0.5441441535949707
Epoch: 11, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.883 Vali Acc: 0.678 Test Loss: 0.883 Test Acc: 0.678
Validation loss decreased (-0.661102 --> -0.677769).  Saving model ...
Epoch: 12 cost time: 0.5306339263916016
Epoch: 12, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.794 Vali Acc: 0.711 Test Loss: 0.794 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711103).  Saving model ...
Epoch: 13 cost time: 0.5303668975830078
Epoch: 13, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.738 Vali Acc: 0.744 Test Loss: 0.738 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744437).  Saving model ...
Epoch: 14 cost time: 0.5310258865356445
Epoch: 14, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.742 Vali Acc: 0.744 Test Loss: 0.742 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5183162689208984
Epoch: 15, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
Validation loss decreased (-0.744437 --> -0.788882).  Saving model ...
Epoch: 16 cost time: 0.6229560375213623
Epoch: 16, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.733 Vali Acc: 0.767 Test Loss: 0.733 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6432349681854248
Epoch: 17, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.653 Vali Acc: 0.800 Test Loss: 0.653 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 18 cost time: 0.6118226051330566
Epoch: 18, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6180143356323242
Epoch: 19, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.679 Vali Acc: 0.822 Test Loss: 0.679 Test Acc: 0.822
Validation loss decreased (-0.799993 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 0.5456862449645996
Epoch: 20, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.642 Vali Acc: 0.811 Test Loss: 0.642 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5902588367462158
Epoch: 21, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.665 Vali Acc: 0.817 Test Loss: 0.665 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.672313928604126
Epoch: 22, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.682 Vali Acc: 0.811 Test Loss: 0.682 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6235232353210449
Epoch: 23, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 24 cost time: 0.6239795684814453
Epoch: 24, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.710 Vali Acc: 0.817 Test Loss: 0.710 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6426513195037842
Epoch: 25, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844438).  Saving model ...
Epoch: 26 cost time: 0.6043434143066406
Epoch: 26, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.700 Vali Acc: 0.839 Test Loss: 0.700 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5897471904754639
Epoch: 27, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.697 Vali Acc: 0.833 Test Loss: 0.697 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7088220119476318
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5356099605560303
Epoch: 29, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.731 Vali Acc: 0.839 Test Loss: 0.731 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6026880741119385
Epoch: 30, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.710 Vali Acc: 0.839 Test Loss: 0.710 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5679354667663574
Epoch: 31, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.761 Vali Acc: 0.844 Test Loss: 0.761 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5941083431243896
Epoch: 32, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.796 Vali Acc: 0.844 Test Loss: 0.796 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6481468677520752
Epoch: 33, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.789 Vali Acc: 0.844 Test Loss: 0.789 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5944347381591797
Epoch: 34, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.769 Vali Acc: 0.867 Test Loss: 0.769 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866659).  Saving model ...
Epoch: 35 cost time: 0.7180747985839844
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.777 Vali Acc: 0.872 Test Loss: 0.777 Test Acc: 0.872
Validation loss decreased (-0.866659 --> -0.872214).  Saving model ...
Epoch: 36 cost time: 0.6598334312438965
Epoch: 36, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.819 Vali Acc: 0.867 Test Loss: 0.819 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5586948394775391
Epoch: 37, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.820 Vali Acc: 0.844 Test Loss: 0.820 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5840210914611816
Epoch: 38, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.841 Vali Acc: 0.861 Test Loss: 0.841 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.549346923828125
Epoch: 39, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.812 Vali Acc: 0.839 Test Loss: 0.812 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6157922744750977
Epoch: 40, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.817 Vali Acc: 0.878 Test Loss: 0.817 Test Acc: 0.878
Validation loss decreased (-0.872214 --> -0.877770).  Saving model ...
Epoch: 41 cost time: 0.658837080001831
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.858 Vali Acc: 0.844 Test Loss: 0.858 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6065757274627686
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.814 Vali Acc: 0.867 Test Loss: 0.814 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.589792013168335
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.842 Vali Acc: 0.850 Test Loss: 0.842 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6921746730804443
Epoch: 44, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.858 Vali Acc: 0.850 Test Loss: 0.858 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6408345699310303
Epoch: 45, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.854 Vali Acc: 0.867 Test Loss: 0.854 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5576214790344238
Epoch: 46, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.886 Vali Acc: 0.844 Test Loss: 0.886 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6047263145446777
Epoch: 47, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.943 Vali Acc: 0.828 Test Loss: 0.943 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5708463191986084
Epoch: 48, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.968 Vali Acc: 0.856 Test Loss: 0.968 Test Acc: 0.856
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5463805198669434
Epoch: 49, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.926 Vali Acc: 0.856 Test Loss: 0.926 Test Acc: 0.856
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5918309688568115
Epoch: 50, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.908 Vali Acc: 0.833 Test Loss: 0.908 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8777777777777778
model parameter : 22225167
model size : 99.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8525974750518799
Epoch: 1, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.638 Vali Acc: 0.078 Test Loss: 2.638 Test Acc: 0.078
Validation loss decreased (inf --> -0.077751).  Saving model ...
Epoch: 2 cost time: 0.7166247367858887
Epoch: 2, Steps: 12 | Train Loss: 2.533 Vali Loss: 2.407 Vali Acc: 0.367 Test Loss: 2.407 Test Acc: 0.367
Validation loss decreased (-0.077751 --> -0.366643).  Saving model ...
Epoch: 3 cost time: 0.7415058612823486
Epoch: 3, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.161 Vali Acc: 0.422 Test Loss: 2.161 Test Acc: 0.422
Validation loss decreased (-0.366643 --> -0.422201).  Saving model ...
Epoch: 4 cost time: 0.7677202224731445
Epoch: 4, Steps: 12 | Train Loss: 1.912 Vali Loss: 1.869 Vali Acc: 0.494 Test Loss: 1.869 Test Acc: 0.494
Validation loss decreased (-0.422201 --> -0.494426).  Saving model ...
Epoch: 5 cost time: 0.5889923572540283
Epoch: 5, Steps: 12 | Train Loss: 1.642 Vali Loss: 1.558 Vali Acc: 0.522 Test Loss: 1.558 Test Acc: 0.522
Validation loss decreased (-0.494426 --> -0.522207).  Saving model ...
Epoch: 6 cost time: 0.6828739643096924
Epoch: 6, Steps: 12 | Train Loss: 1.314 Vali Loss: 1.280 Vali Acc: 0.600 Test Loss: 1.280 Test Acc: 0.600
Validation loss decreased (-0.522207 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.7059602737426758
Epoch: 7, Steps: 12 | Train Loss: 1.155 Vali Loss: 1.182 Vali Acc: 0.567 Test Loss: 1.182 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7173728942871094
Epoch: 8, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.037 Vali Acc: 0.628 Test Loss: 1.037 Test Acc: 0.628
Validation loss decreased (-0.599987 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 0.6569192409515381
Epoch: 9, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.930 Vali Acc: 0.722 Test Loss: 0.930 Test Acc: 0.722
Validation loss decreased (-0.627767 --> -0.722213).  Saving model ...
Epoch: 10 cost time: 0.6575357913970947
Epoch: 10, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.769 Vali Acc: 0.711 Test Loss: 0.769 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.649803638458252
Epoch: 11, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.907 Vali Acc: 0.739 Test Loss: 0.907 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738880).  Saving model ...
Epoch: 12 cost time: 0.5250699520111084
Epoch: 12, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.775 Vali Acc: 0.750 Test Loss: 0.775 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.6077108383178711
Epoch: 13, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.771 Vali Acc: 0.772 Test Loss: 0.771 Test Acc: 0.772
Validation loss decreased (-0.749992 --> -0.772215).  Saving model ...
Epoch: 14 cost time: 0.6479747295379639
Epoch: 14, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.797 Vali Acc: 0.789 Test Loss: 0.797 Test Acc: 0.789
Validation loss decreased (-0.772215 --> -0.788881).  Saving model ...
Epoch: 15 cost time: 0.5734078884124756
Epoch: 15, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6998448371887207
Epoch: 16, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5567431449890137
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 1.013 Vali Acc: 0.783 Test Loss: 1.013 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5675814151763916
Epoch: 18, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.953 Vali Acc: 0.778 Test Loss: 0.953 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6663563251495361
Epoch: 19, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.942 Vali Acc: 0.783 Test Loss: 0.942 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6181981563568115
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.904 Vali Acc: 0.811 Test Loss: 0.904 Test Acc: 0.811
Validation loss decreased (-0.788881 --> -0.811102).  Saving model ...
Epoch: 21 cost time: 0.6134881973266602
Epoch: 21, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.008 Vali Acc: 0.778 Test Loss: 1.008 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5944747924804688
Epoch: 22, Steps: 12 | Train Loss: 0.095 Vali Loss: 1.093 Vali Acc: 0.800 Test Loss: 1.093 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.582103967666626
Epoch: 23, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.979 Vali Acc: 0.800 Test Loss: 0.979 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7044293880462646
Epoch: 24, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.953 Vali Acc: 0.817 Test Loss: 0.953 Test Acc: 0.817
Validation loss decreased (-0.811102 --> -0.816657).  Saving model ...
Epoch: 25 cost time: 0.5825669765472412
Epoch: 25, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.987 Vali Acc: 0.806 Test Loss: 0.987 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5089097023010254
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.927 Vali Acc: 0.822 Test Loss: 0.927 Test Acc: 0.822
Validation loss decreased (-0.816657 --> -0.822213).  Saving model ...
Epoch: 27 cost time: 0.6386191844940186
Epoch: 27, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.996 Vali Acc: 0.833 Test Loss: 0.996 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833323).  Saving model ...
Epoch: 28 cost time: 0.8143167495727539
Epoch: 28, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.036 Vali Acc: 0.822 Test Loss: 1.036 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7163147926330566
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.034 Vali Acc: 0.833 Test Loss: 1.034 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6541593074798584
Epoch: 30, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.024 Vali Acc: 0.833 Test Loss: 1.024 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6464335918426514
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 1.070 Vali Acc: 0.833 Test Loss: 1.070 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6106662750244141
Epoch: 32, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.058 Vali Acc: 0.833 Test Loss: 1.058 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6881670951843262
Epoch: 33, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.030 Vali Acc: 0.822 Test Loss: 1.030 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6402146816253662
Epoch: 34, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.034 Vali Acc: 0.828 Test Loss: 1.034 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5918993949890137
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.109 Vali Acc: 0.828 Test Loss: 1.109 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7242684364318848
Epoch: 36, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.005 Vali Acc: 0.828 Test Loss: 1.005 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6292567253112793
Epoch: 37, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.033 Vali Acc: 0.822 Test Loss: 1.033 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 22334223
model size : 99.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.01849627494812
Epoch: 1, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.616 Vali Acc: 0.172 Test Loss: 2.616 Test Acc: 0.172
Validation loss decreased (inf --> -0.172196).  Saving model ...
Epoch: 2 cost time: 0.451369047164917
Epoch: 2, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.444 Vali Acc: 0.356 Test Loss: 2.444 Test Acc: 0.356
Validation loss decreased (-0.172196 --> -0.355531).  Saving model ...
Epoch: 3 cost time: 0.5241549015045166
Epoch: 3, Steps: 12 | Train Loss: 2.363 Vali Loss: 2.245 Vali Acc: 0.483 Test Loss: 2.245 Test Acc: 0.483
Validation loss decreased (-0.355531 --> -0.483311).  Saving model ...
Epoch: 4 cost time: 0.5517585277557373
Epoch: 4, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.006 Vali Acc: 0.483 Test Loss: 2.006 Test Acc: 0.483
Validation loss decreased (-0.483311 --> -0.483313).  Saving model ...
Epoch: 5 cost time: 0.5667555332183838
Epoch: 5, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.724 Vali Acc: 0.544 Test Loss: 1.724 Test Acc: 0.544
Validation loss decreased (-0.483313 --> -0.544427).  Saving model ...
Epoch: 6 cost time: 0.5406894683837891
Epoch: 6, Steps: 12 | Train Loss: 1.600 Vali Loss: 1.421 Vali Acc: 0.567 Test Loss: 1.421 Test Acc: 0.567
Validation loss decreased (-0.544427 --> -0.566652).  Saving model ...
Epoch: 7 cost time: 0.6075079441070557
Epoch: 7, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.165 Vali Acc: 0.611 Test Loss: 1.165 Test Acc: 0.611
Validation loss decreased (-0.566652 --> -0.611099).  Saving model ...
Epoch: 8 cost time: 0.6307694911956787
Epoch: 8, Steps: 12 | Train Loss: 0.985 Vali Loss: 1.061 Vali Acc: 0.628 Test Loss: 1.061 Test Acc: 0.628
Validation loss decreased (-0.611099 --> -0.627767).  Saving model ...
Epoch: 9 cost time: 0.48275327682495117
Epoch: 9, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.907 Vali Acc: 0.667 Test Loss: 0.907 Test Acc: 0.667
Validation loss decreased (-0.627767 --> -0.666658).  Saving model ...
Epoch: 10 cost time: 0.5004141330718994
Epoch: 10, Steps: 12 | Train Loss: 0.665 Vali Loss: 0.814 Vali Acc: 0.689 Test Loss: 0.814 Test Acc: 0.689
Validation loss decreased (-0.666658 --> -0.688881).  Saving model ...
Epoch: 11 cost time: 0.5381474494934082
Epoch: 11, Steps: 12 | Train Loss: 0.586 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
Validation loss decreased (-0.688881 --> -0.716659).  Saving model ...
Epoch: 12 cost time: 0.6950249671936035
Epoch: 12, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.732 Vali Acc: 0.744 Test Loss: 0.732 Test Acc: 0.744
Validation loss decreased (-0.716659 --> -0.744437).  Saving model ...
Epoch: 13 cost time: 0.6459970474243164
Epoch: 13, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.645117998123169
Epoch: 14, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.745 Vali Acc: 0.739 Test Loss: 0.745 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5158929824829102
Epoch: 15, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
Validation loss decreased (-0.744437 --> -0.783326).  Saving model ...
Epoch: 16 cost time: 0.530872106552124
Epoch: 16, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.919 Vali Acc: 0.717 Test Loss: 0.919 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5323312282562256
Epoch: 17, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.822 Vali Acc: 0.800 Test Loss: 0.822 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.6311953067779541
Epoch: 18, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.746 Vali Acc: 0.794 Test Loss: 0.746 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5455036163330078
Epoch: 19, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.796 Vali Acc: 0.789 Test Loss: 0.796 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6001670360565186
Epoch: 20, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.780 Vali Acc: 0.817 Test Loss: 0.780 Test Acc: 0.817
Validation loss decreased (-0.799992 --> -0.816659).  Saving model ...
Epoch: 21 cost time: 0.6840333938598633
Epoch: 21, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
Validation loss decreased (-0.816659 --> -0.833326).  Saving model ...
Epoch: 22 cost time: 0.6163983345031738
Epoch: 22, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.791 Vali Acc: 0.817 Test Loss: 0.791 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6328837871551514
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6522178649902344
Epoch: 24, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5817770957946777
Epoch: 25, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.813 Vali Acc: 0.828 Test Loss: 0.813 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5794003009796143
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5713722705841064
Epoch: 27, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.860 Vali Acc: 0.833 Test Loss: 0.860 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5930728912353516
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.811 Vali Acc: 0.822 Test Loss: 0.811 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5315327644348145
Epoch: 29, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.819 Vali Acc: 0.833 Test Loss: 0.819 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5290348529815674
Epoch: 30, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.862 Vali Acc: 0.828 Test Loss: 0.862 Test Acc: 0.828
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5824463367462158
Epoch: 31, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.892 Vali Acc: 0.822 Test Loss: 0.892 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 22268943
model size : 99.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0046286582946777
Epoch: 1, Steps: 12 | Train Loss: 2.801 Vali Loss: 2.678 Vali Acc: 0.100 Test Loss: 2.678 Test Acc: 0.100
Validation loss decreased (inf --> -0.099973).  Saving model ...
Epoch: 2 cost time: 0.5529108047485352
Epoch: 2, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.529 Vali Acc: 0.239 Test Loss: 2.529 Test Acc: 0.239
Validation loss decreased (-0.099973 --> -0.238864).  Saving model ...
Epoch: 3 cost time: 0.7086944580078125
Epoch: 3, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.375 Vali Acc: 0.367 Test Loss: 2.375 Test Acc: 0.367
Validation loss decreased (-0.238864 --> -0.366643).  Saving model ...
Epoch: 4 cost time: 0.6273167133331299
Epoch: 4, Steps: 12 | Train Loss: 2.248 Vali Loss: 2.188 Vali Acc: 0.494 Test Loss: 2.188 Test Acc: 0.494
Validation loss decreased (-0.366643 --> -0.494423).  Saving model ...
Epoch: 5 cost time: 0.638761043548584
Epoch: 5, Steps: 12 | Train Loss: 2.026 Vali Loss: 1.945 Vali Acc: 0.533 Test Loss: 1.945 Test Acc: 0.533
Validation loss decreased (-0.494423 --> -0.533314).  Saving model ...
Epoch: 6 cost time: 0.6773157119750977
Epoch: 6, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.682 Vali Acc: 0.550 Test Loss: 1.682 Test Acc: 0.550
Validation loss decreased (-0.533314 --> -0.549983).  Saving model ...
Epoch: 7 cost time: 0.643822431564331
Epoch: 7, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.418 Vali Acc: 0.567 Test Loss: 1.418 Test Acc: 0.567
Validation loss decreased (-0.549983 --> -0.566652).  Saving model ...
Epoch: 8 cost time: 0.5873167514801025
Epoch: 8, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.211 Vali Acc: 0.578 Test Loss: 1.211 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577766).  Saving model ...
Epoch: 9 cost time: 0.5227859020233154
Epoch: 9, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.036 Vali Acc: 0.633 Test Loss: 1.036 Test Acc: 0.633
Validation loss decreased (-0.577766 --> -0.633323).  Saving model ...
Epoch: 10 cost time: 0.6519966125488281
Epoch: 10, Steps: 12 | Train Loss: 0.898 Vali Loss: 0.926 Vali Acc: 0.667 Test Loss: 0.926 Test Acc: 0.667
Validation loss decreased (-0.633323 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.5947127342224121
Epoch: 11, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.839 Vali Acc: 0.689 Test Loss: 0.839 Test Acc: 0.689
Validation loss decreased (-0.666657 --> -0.688881).  Saving model ...
Epoch: 12 cost time: 0.5506305694580078
Epoch: 12, Steps: 12 | Train Loss: 0.681 Vali Loss: 0.771 Vali Acc: 0.694 Test Loss: 0.771 Test Acc: 0.694
Validation loss decreased (-0.688881 --> -0.694437).  Saving model ...
Epoch: 13 cost time: 0.6846296787261963
Epoch: 13, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.708 Vali Acc: 0.739 Test Loss: 0.708 Test Acc: 0.739
Validation loss decreased (-0.694437 --> -0.738882).  Saving model ...
Epoch: 14 cost time: 0.6540403366088867
Epoch: 14, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
Validation loss decreased (-0.738882 --> -0.783326).  Saving model ...
Epoch: 15 cost time: 0.6062250137329102
Epoch: 15, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.631 Vali Acc: 0.772 Test Loss: 0.631 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6625666618347168
Epoch: 16, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
Validation loss decreased (-0.783326 --> -0.822216).  Saving model ...
Epoch: 17 cost time: 0.7040674686431885
Epoch: 17, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6103665828704834
Epoch: 18, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.621 Vali Acc: 0.822 Test Loss: 0.621 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.557471752166748
Epoch: 19, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.605 Vali Acc: 0.794 Test Loss: 0.605 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6481943130493164
Epoch: 20, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.717 Vali Acc: 0.811 Test Loss: 0.717 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6179361343383789
Epoch: 21, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.647 Vali Acc: 0.800 Test Loss: 0.647 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5625259876251221
Epoch: 22, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.658 Vali Acc: 0.828 Test Loss: 0.658 Test Acc: 0.828
Validation loss decreased (-0.822216 --> -0.827771).  Saving model ...
Epoch: 23 cost time: 0.6986579895019531
Epoch: 23, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.633 Vali Acc: 0.800 Test Loss: 0.633 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6159074306488037
Epoch: 24, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.687 Vali Acc: 0.833 Test Loss: 0.687 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 0.6147289276123047
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.641 Vali Acc: 0.828 Test Loss: 0.641 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5542309284210205
Epoch: 26, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.778 Vali Acc: 0.817 Test Loss: 0.778 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5923233032226562
Epoch: 27, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.693 Vali Acc: 0.844 Test Loss: 0.693 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 28 cost time: 0.5713777542114258
Epoch: 28, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.735 Vali Acc: 0.828 Test Loss: 0.735 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6127402782440186
Epoch: 29, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.6260111331939697
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.759 Vali Acc: 0.833 Test Loss: 0.759 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5545101165771484
Epoch: 31, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.726 Vali Acc: 0.828 Test Loss: 0.726 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6133403778076172
Epoch: 32, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.754 Vali Acc: 0.850 Test Loss: 0.754 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6559271812438965
Epoch: 33, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.759 Vali Acc: 0.844 Test Loss: 0.759 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6163265705108643
Epoch: 34, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.795 Vali Acc: 0.839 Test Loss: 0.795 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6361439228057861
Epoch: 35, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.763 Vali Acc: 0.828 Test Loss: 0.763 Test Acc: 0.828
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5956757068634033
Epoch: 36, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.817 Vali Acc: 0.844 Test Loss: 0.817 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6589436531066895
Epoch: 37, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.799 Vali Acc: 0.817 Test Loss: 0.799 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6726584434509277
Epoch: 38, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.812 Vali Acc: 0.861 Test Loss: 0.812 Test Acc: 0.861
Validation loss decreased (-0.849993 --> -0.861103).  Saving model ...
Epoch: 39 cost time: 0.5959174633026123
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.801 Vali Acc: 0.856 Test Loss: 0.801 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6479647159576416
Epoch: 40, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.863 Vali Acc: 0.850 Test Loss: 0.863 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7022840976715088
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.802 Vali Acc: 0.850 Test Loss: 0.802 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6231982707977295
Epoch: 42, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.865 Vali Acc: 0.850 Test Loss: 0.865 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6250109672546387
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.855 Vali Acc: 0.828 Test Loss: 0.855 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.59505295753479
Epoch: 44, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6507368087768555
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.914 Vali Acc: 0.822 Test Loss: 0.914 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6641650199890137
Epoch: 46, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.941 Vali Acc: 0.850 Test Loss: 0.941 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5958540439605713
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.048 Vali Acc: 0.822 Test Loss: 1.048 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6248834133148193
Epoch: 48, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.954 Vali Acc: 0.850 Test Loss: 0.954 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_GPT4TS_UEA_ftM_sl45_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8611111111111112
model parameter : 22229775
model size : 99.47MB
